<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>æ•°æ®åº“ | Huang Blog</title><meta name="author" content="Huang RD"><meta name="copyright" content="Huang RD"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="æ•°æ®åº“æ€»ç»“æ•´ä½“æ¦‚è¿°  ä¸€ã€ç»ªè®ºï¼ˆIntroductionï¼‰  æ•°æ®åº“ç³»ç»Ÿ ç”± æ•°æ®åº“ã€æ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€åº”ç”¨ç³»ç»Ÿå’Œæ•°æ®åº“ç®¡ç†å‘˜ç»„æˆ æ•°æ®ç®¡ç†çš„ä¸‰ä¸ªé˜¶æ®µï¼š  äººå·¥ç®¡ç†ç³»ç»Ÿ æ–‡ä»¶ç³»ç»Ÿé˜¶æ®µ æ•°æ®åº“ç³»ç»Ÿé˜¶æ®µ  æ•°æ®åº“ç»“æ„ç‰¹ç‚¹ï¼š  æ•°æ®ç»“æ„åŒ– æ•°æ®å…±äº«æ€§é«˜ã€å†—ä½™åº¦ä½ä¸”æ˜“æ‹“å±• æ•°æ®ç‹¬ç«‹æ€§é«˜ æ•°æ®æœ‰æ•°æ®åº“ç®¡ç†ç³»ç»Ÿç»Ÿä¸€ç®¡ç†å’Œæ§åˆ¶  1ã€æ•°æ®åº“åŸºæœ¬æ¦‚å¿µæ•°æ®åº“çš„å››ä¸ªåŸºæœ¬æ¦‚å¿µï¼š   æ•°æ® data æ•°æ®åº“ DataBas">
<meta property="og:type" content="article">
<meta property="og:title" content="æ•°æ®åº“">
<meta property="og:url" content="http://www.haungrd.top/2023/02/15/%E6%95%B0%E6%8D%AE%E5%BA%93/index.html">
<meta property="og:site_name" content="Huang Blog">
<meta property="og:description" content="æ•°æ®åº“æ€»ç»“æ•´ä½“æ¦‚è¿°  ä¸€ã€ç»ªè®ºï¼ˆIntroductionï¼‰  æ•°æ®åº“ç³»ç»Ÿ ç”± æ•°æ®åº“ã€æ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€åº”ç”¨ç³»ç»Ÿå’Œæ•°æ®åº“ç®¡ç†å‘˜ç»„æˆ æ•°æ®ç®¡ç†çš„ä¸‰ä¸ªé˜¶æ®µï¼š  äººå·¥ç®¡ç†ç³»ç»Ÿ æ–‡ä»¶ç³»ç»Ÿé˜¶æ®µ æ•°æ®åº“ç³»ç»Ÿé˜¶æ®µ  æ•°æ®åº“ç»“æ„ç‰¹ç‚¹ï¼š  æ•°æ®ç»“æ„åŒ– æ•°æ®å…±äº«æ€§é«˜ã€å†—ä½™åº¦ä½ä¸”æ˜“æ‹“å±• æ•°æ®ç‹¬ç«‹æ€§é«˜ æ•°æ®æœ‰æ•°æ®åº“ç®¡ç†ç³»ç»Ÿç»Ÿä¸€ç®¡ç†å’Œæ§åˆ¶  1ã€æ•°æ®åº“åŸºæœ¬æ¦‚å¿µæ•°æ®åº“çš„å››ä¸ªåŸºæœ¬æ¦‚å¿µï¼š   æ•°æ® data æ•°æ®åº“ DataBas">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.huangrd.top/images/agentina/7.jpg">
<meta property="article:published_time" content="2023-02-15T08:12:57.000Z">
<meta property="article:modified_time" content="2023-02-20T12:07:39.145Z">
<meta property="article:author" content="Huang RD">
<meta property="article:tag" content="æ•°æ®åº“">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.huangrd.top/images/agentina/7.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://www.haungrd.top/2023/02/15/%E6%95%B0%E6%8D%AE%E5%BA%93/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç®€"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“","cht_to_chs":"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“","day_to_night":"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'æ•°æ®åº“',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-02-20 20:07:39'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://getwallpapers.com/wallpaper/full/a/1/8/1057222-free-download-cool-nature-backgrounds-1920x1200-windows-10.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">56</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">74</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">17</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><span> æ¸…å•</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> ç…§ç‰‡</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> ç”µå½±</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹æƒ…é“¾æ¥</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://www.huangrd.top/images/agentina/7.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Huang Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><span> æ¸…å•</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> éŸ³ä¹</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> ç…§ç‰‡</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> ç”µå½±</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹æƒ…é“¾æ¥</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">æ•°æ®åº“</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-02-15T08:12:57.000Z" title="å‘è¡¨äº 2023-02-15 16:12:57">2023-02-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-02-20T12:07:39.145Z" title="æ›´æ–°äº 2023-02-20 20:07:39">2023-02-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/">è®¡ç®—æœºåŸºç¡€</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">16.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>72åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="æ•°æ®åº“"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="æ•°æ®åº“æ€»ç»“"><a href="#æ•°æ®åº“æ€»ç»“" class="headerlink" title="æ•°æ®åº“æ€»ç»“"></a>æ•°æ®åº“æ€»ç»“</h1><h2 id="æ•´ä½“æ¦‚è¿°"><a href="#æ•´ä½“æ¦‚è¿°" class="headerlink" title="æ•´ä½“æ¦‚è¿°"></a>æ•´ä½“æ¦‚è¿°</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20230215182550687.png" alt="image-20230215182550687"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20230215182527425.png" alt="image-20230215182527425"></p>
<h2 id="ä¸€ã€ç»ªè®ºï¼ˆIntroductionï¼‰"><a href="#ä¸€ã€ç»ªè®ºï¼ˆIntroductionï¼‰" class="headerlink" title="ä¸€ã€ç»ªè®ºï¼ˆIntroductionï¼‰"></a>ä¸€ã€ç»ªè®ºï¼ˆIntroductionï¼‰</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/1.png" alt="img"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/%E5%A4%8D%E4%B9%A0%E8%AE%A1%E5%88%92.png" alt="å¤ä¹ è®¡åˆ’"></p>
<p>æ•°æ®åº“ç³»ç»Ÿ ç”± æ•°æ®åº“ã€æ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€åº”ç”¨ç³»ç»Ÿå’Œæ•°æ®åº“ç®¡ç†å‘˜ç»„æˆ</p>
<p>æ•°æ®ç®¡ç†çš„ä¸‰ä¸ªé˜¶æ®µï¼š</p>
<ol>
<li>äººå·¥ç®¡ç†ç³»ç»Ÿ</li>
<li>æ–‡ä»¶ç³»ç»Ÿé˜¶æ®µ</li>
<li>æ•°æ®åº“ç³»ç»Ÿé˜¶æ®µ</li>
</ol>
<p>æ•°æ®åº“ç»“æ„ç‰¹ç‚¹ï¼š</p>
<ul>
<li>æ•°æ®ç»“æ„åŒ–</li>
<li>æ•°æ®å…±äº«æ€§é«˜ã€å†—ä½™åº¦ä½ä¸”æ˜“æ‹“å±•</li>
<li>æ•°æ®ç‹¬ç«‹æ€§é«˜</li>
<li>æ•°æ®æœ‰æ•°æ®åº“ç®¡ç†ç³»ç»Ÿç»Ÿä¸€ç®¡ç†å’Œæ§åˆ¶</li>
</ul>
<h3 id="1ã€æ•°æ®åº“åŸºæœ¬æ¦‚å¿µ"><a href="#1ã€æ•°æ®åº“åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="1ã€æ•°æ®åº“åŸºæœ¬æ¦‚å¿µ"></a>1ã€æ•°æ®åº“åŸºæœ¬æ¦‚å¿µ</h3><p>æ•°æ®åº“çš„å››ä¸ªåŸºæœ¬æ¦‚å¿µï¼š</p>
<blockquote>
<ol>
<li>æ•°æ® data</li>
<li>æ•°æ®åº“ DataBase DB </li>
<li>æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ DataBase Management System DBMS</li>
<li>æ•°æ®åº“ç³»ç»Ÿ DataBase System DBS</li>
</ol>
</blockquote>
<p><strong>æ•°æ®</strong></p>
<ul>
<li>æè¿°äº‹ç‰©çš„ç¬¦å· ï¼ˆæ•°æ®çš„å®šä¹‰ï¼‰</li>
<li>æ•°æ®åº“ä¸­å­˜å‚¨çš„åŸºæœ¬å¯¹è±¡</li>
<li>æ•°å­—ã€æ–‡å­—ã€å›¾å½¢ã€å£°éŸ³ã€è¯­è¨€ç­‰å¤šç§è¡¨ç°å½¢å¼</li>
<li>æ•°æ®ç¬¦å· + è¯­ä¹‰â†’â†’æ•°æ®ã€</li>
</ul>
<p><strong>æ•°æ®åº“</strong></p>
<ul>
<li>å­˜å‚¨åœ¨è®¡ç®—æœºå†…ã€æœ‰ç»„ç»‡ã€å¯å…±äº«çš„æ•°æ®é›†åˆ </li>
<li>DBæ•°æ®ï¼ŒæŒ‰ä¸€å®šçš„æ•°æ®æ¨¡å‹ç»„ç»‡ã€æè¿°å’Œå­˜å‚¨ </li>
<li>æ•°æ®å†—ä½™åº¦å°ï¼Œæ•°æ®ç‹¬ç«‹æ€§å’Œæ‰©å±•æ€§é«˜</li>
</ul>
<p><strong>DBS</strong></p>
<p>DBS çš„ç»„æˆéƒ¨åˆ†ï¼š</p>
<ul>
<li>ç¡¬ä»¶ï¼šè®¡ç®—æœºï¼ˆç£ç›˜â†’ æ•°æ®åº“&#x2F;DB&#x2F;ç£ç›˜æ–‡ä»¶ï¼‰</li>
<li>è½¯ä»¶ï¼šæ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆDBMSï¼‰ã€æ•°æ®åº“åº”ç”¨ç³»ç»Ÿï¼ˆDBASï¼‰</li>
<li>ä¸ªäººï¼šæ•°æ®åº“ç®¡ç†å‘˜ï¼ˆDBAï¼‰ã€æ•°æ®åº“ç”¨æˆ·</li>
</ul>
<p>DBS çš„è½¯ä»¶æ¡†æ¶ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221124164403423.png" alt="image-20221124164403423"></p>
<p><strong>DBSé€»è¾‘ç»“æ„</strong>ï¼š</p>
<p><code>ä¸‰çº§æ¨¡å¼ã€ä¸¤çº§æ˜ å°„</code></p>
<p>ä¸‰çº§æ¨¡å¼ï¼šç”¨æˆ·æ¨¡å¼ï¼ˆå¤–æ¨¡å¼ è§†å›¾viewï¼‰ã€é€»è¾‘æ¨¡å¼ï¼ˆæ¨¡å¼ è¡¨tableï¼‰ã€å­˜å‚¨æ¨¡å¼ï¼ˆå†…æ¨¡å¼ ç£ç›˜æ–‡ä»¶ï¼‰ã€</p>
<ul>
<li>ç”¨æˆ·æ¨¡å¼ï¼šå¤–æ¨¡å¼ â€“&gt; view</li>
<li>é€»è¾‘æ¨¡å¼ï¼šæ¨¡å¼ â€“&gt;table</li>
<li>ç‰©ç†æ¨¡å¼ï¼šå†…æ¨¡å¼ â€“&gt;disk file</li>
</ul>
<p>æ¨¡å¼æè¿°çš„æ˜¯æ•°æ®çš„å…¨å±€é€»è¾‘ç»“æ„ï¼Œå¤–æ¨¡å¼æè¿°çš„æ˜¯æ•°æ®çš„å±€éƒ¨é€»è¾‘ç»“æ„ã€‚</p>
<p>ä¸¤çº§æ˜ å°„ä¸æ•°æ®ç‹¬ç«‹æ€§ï¼š</p>
<ul>
<li><p>å¤–æ¨¡å¼&#x2F;æ¨¡å¼æ˜ å°„ 1 ï¼šn</p>
<p>æ¨¡å¼æ”¹å˜ï¼Œç”±DBAè°ƒæ•´å„å¤–æ¨¡å¼&#x2F;æ¨¡å¼æ˜ åƒï¼Œ å¯ä½¿å¤–æ¨¡å¼ä¸å˜ï¼Œæ”¯æ’‘åº”ç”¨ç¨‹åºä¸ä¿®æ”¹ï¼Œ ä¿è¯æ•°æ®ä¸ç¨‹åºçš„é€»è¾‘ç‹¬ç«‹æ€§ã€‚</p>
</li>
<li><p>æ¨¡å¼&#x2F;å†…æ¨¡å¼æ˜ å°„ 1 ï¼š 1</p>
<p>æ•°æ®åº“çš„å­˜å‚¨ç»“æ„æ”¹å˜ï¼Œç”±DBAè°ƒæ•´æ¨¡å¼&#x2F;å†…æ¨¡å¼æ˜ åƒï¼Œå¯ä½¿æ¨¡å¼ä¸å˜ï¼Œ ä¸”æ— éœ€ä¿®æ”¹åº”ç”¨ç¨‹åºï¼Œä¿è¯æ•°æ®ä¸ç¨‹åºçš„ç‰©ç†ç‹¬ç«‹æ€§ã€‚</p>
</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221124165236961.png" alt="image-20221124165236961"></p>
<p>ç³»ç»Ÿç»“æ„ï¼š</p>
<ul>
<li><p>Centralization(é›†ä¸­å¼)ç»“æ„ </p>
<ul>
<li>DBç‰©ç†ä¸Šï¼Œåœ¨ä¸€ä¸ªå±€åŸŸç½‘ä¸­</li>
</ul>
</li>
<li><p>Distribution(åˆ†å¸ƒå¼)ç»“æ„ </p>
<ul>
<li>DBç‰©ç†ä¸Šæˆ–é€»è¾‘ä¸Šï¼Œåˆ†å¸ƒåœ¨ä¸åŒçš„ç½‘ç»œä¸­ <ul>
<li>Client&#x2F;Server ç»“æ„ </li>
<li>Browser&#x2F;Server ç»“æ„ </li>
<li>Parallel (å¹¶è¡Œ)ç»“æ„</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>å¦‚ä½•æ„å»ºæ•°æ®åº“ï¼Ÿ</strong></p>
<p>æ•°æ®æ¨¡å‹ï¼šå¯¹ç°å®ä¸–ç•Œçš„ä¸€ç§æŠ½è±¡ã€‚æ˜¯æ•°æ®åº“ç³»ç»Ÿçš„æ ¸å¿ƒå’ŒåŸºç¡€ã€‚</p>
<p>åˆ†ç±»ï¼š</p>
<ol>
<li>æ¦‚å¿µæ¨¡å‹</li>
<li>é€»è¾‘æ¨¡å‹å’Œç‰©ç†æ¨¡å‹</li>
</ol>
<p><strong>æ¦‚å¿µæ¨¡å‹åŒ…æ‹¬</strong>ï¼šå®ä½“ã€å±æ€§ã€é”®ã€å®ä½“å‹ç­‰ã€‚è¡¨ç¤ºæ–¹æ³•E-Rå›¾</p>
<p><strong>æ•°æ®æ¨¡å‹åˆ†ç±»</strong>ï¼š</p>
<p>â€¢ Network data model &#x2F; ç½‘çŠ¶æ¨¡å‹</p>
<p>â€¢ Hierarchical data model &#x2F; å±‚æ¬¡æ¨¡å‹ </p>
<p><strong>â€¢ Relational data model &#x2F; å…³ç³»æ¨¡å‹</strong> </p>
<p>â€¢ Object-Relational data model &#x2F;å¯¹è±¡å…³ç³»æ¨¡å‹</p>
<p>å…³ç³»æ•°æ®åº“ç³»ç»Ÿå¯¹å±‚æ¬¡&#x2F;ç½‘çŠ¶æ•°æ®åº“ç³»ç»Ÿçš„é‡å¤§æ”¹è¿›æ˜¯ï¼š</p>
<ul>
<li>å½¢æˆäº†è¾ƒä¸ºå®Œå–„çš„æ•°æ®åº“ç†è®º</li>
<li>å°†é€ä¸€è®°å½•çš„æ“ä½œæ”¹è¿›ä¸ºæ”¯æŒè®°å½•é›†åˆçš„æ“ä½œ</li>
<li>æ¶ˆé™¤äº†ç”±ç”¨æˆ·å»ºç«‹æŒ‡é’ˆçš„å¼Šç«¯</li>
</ul>
<p><strong>æ•°æ®æ¨¡å‹Data Model</strong></p>
<p>Network data model &#x2F; ç½‘çŠ¶æ¨¡å‹</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221124170638360.png" alt="image-20221124170638360"></p>
<p>Hierarchical data model &#x2F; å±‚æ¬¡æ¨¡å‹</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221124170722311.png" alt="image-20221124170722311"></p>
<p><strong>Relational data model &#x2F; å…³ç³»æ¨¡å‹</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221124170850121.png" alt="image-20221124170850121"></p>
<p>Object-Relational data model &#x2F;å¯¹è±¡å…³ç³»æ¨¡å‹</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221124170910372.png" alt="image-20221124170910372"></p>
<p><strong>DBMS</strong></p>
<p>æ•°æ®ç®¡ç†ç³»ç»Ÿï¼Œä½äºç”¨æˆ·ç¨‹åº ä¸ æ“ä½œç³»ç»Ÿä¹‹é—´ (ä¸“ç”¨)è½¯ä»¶ ã€‚</p>
<p>åŠŸèƒ½ï¼šï¼ˆå››å¤§ä¸»è¦æ–¹é¢ï¼‰ </p>
<ul>
<li>æ•°æ®å®šä¹‰â€”å»ºåº“ã€å»ºè¡¨ã€åˆ›å»ºç”¨æˆ·ç­‰ã€‚ç”¨ DDL è¡¨è¾¾ </li>
<li>æ•°æ®æ“çºµâ€”æ’å…¥æ•°æ®ã€ä¿®æ”¹å’Œåˆ é™¤æ•°æ®ç­‰ã€‚ç”¨ DML è¡¨è¾¾ </li>
<li>DB è¿è¡Œç®¡ç†â€”æ•°æ®ä½¿ç”¨è€…åŠå…¶ä½¿ç”¨æƒé™ç®¡ç†ç­‰ã€‚ç”¨ DCL è¡¨è¾¾ </li>
<li>DB å»ºç«‹å’Œç»´æŠ¤â€”æ•°æ®åº“å¤‡ä»½ã€å›å¤ç­‰</li>
</ul>
<p><strong>æ€»ç»“æ¦‚å¿µå’Œå±æ€§</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221124171203610.png" alt="image-20221124171203610"></p>
<blockquote>
<p>å¯¹äºä¸€ä¸ªè¡¨ï¼š</p>
<ul>
<li>æ•´ä¸ªè¡¨ç§°ä¸ºè¡¨ã€å®ä½“ã€å…³ç³»ã€‚</li>
<li>è¡¨ä¸­çš„æ¯ä¸€è¡Œè¡Œç§°ä¸ºè¡Œã€è®°å½•ã€å…ƒç»„ã€‚</li>
<li>è¡¨ä¸­çš„æ¯ä¸€åˆ—ç§°ä¸ºåˆ—ã€å­—æ®µã€å±æ€§ã€‚</li>
</ul>
</blockquote>
<p><strong>ç¬¬ä¸€èŒƒå¼</strong>ï¼š</p>
<p>åœ¨å…³ç³»æ¨¡å‹ä¸­ï¼Œè¡¨çš„åˆ—å¿…é¡»åŒ…å«</p>
<ul>
<li>å•ä¸ªå€¼</li>
<li>éç»“æ„åŒ–å€¼</li>
</ul>
<p>ä¸æ»¡è¶³ç¬¬ä¸€èŒƒå¼çš„æ¡ˆä¾‹ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221124171445138.png" alt="image-20221124171445138"></p>
<p><strong>ä¸€äº›ç»“æ„</strong></p>
<p>æ•°æ®æ¨¡å‹çš„ç»„ä»¶ï¼š</p>
<ul>
<li>æ•°æ®ç»“æ„</li>
<li>æ•°æ®æ“ä½œ</li>
<li>æ•°æ®çš„çº¦æŸæ¡ä»¶</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221124171810521.png" alt="image-20221124171810521"></p>
<h3 id="2ã€æ•°æ®åº“ç”¨æˆ·"><a href="#2ã€æ•°æ®åº“ç”¨æˆ·" class="headerlink" title="2ã€æ•°æ®åº“ç”¨æˆ·"></a>2ã€æ•°æ®åº“ç”¨æˆ·</h3><ol>
<li><p>æœ€ç»ˆç”¨æˆ·<br>â¢ Naive Users (Use Menu interface å¸¸è§„ç”¨æˆ·). </p>
<p>â¢ Casual Users (Compose SQL å¶ç„¶ç”¨æˆ·).</p>
</li>
<li><p>åº”ç”¨ç¨‹åºç¨‹åºå‘˜<br>â¢ ï¼ˆç¼–å†™èœå•å’Œåº”ç”¨ç¨‹åºï¼‰</p>
</li>
<li><p>æ•°æ®åº“ç®¡ç†å‘˜<br>â¢ ï¼ˆDBAâ€”â€”ç®¡ç†DBMSã€DBå’ŒDBASï¼‰ã€‚</p>
</li>
</ol>
<h3 id="3ã€å…³ç³»æ•°æ®åº“æ¦‚è§ˆ"><a href="#3ã€å…³ç³»æ•°æ®åº“æ¦‚è§ˆ" class="headerlink" title="3ã€å…³ç³»æ•°æ®åº“æ¦‚è§ˆ"></a>3ã€å…³ç³»æ•°æ®åº“æ¦‚è§ˆ</h3><p>CAPæ•°æ®åº“ï¼ˆå°å‹ç”µå•†æ•°æ®åº“ï¼‰</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221124172138663.png" alt="image-20221124172138663"></p>
<p>ç”¨åˆ°çš„è¡¨:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Customers (cid, cname, city, discnt)</span><br><span class="line">Agents (aid, aname, city, <span class="keyword">percent</span>)</span><br><span class="line">Products (pid, pname, city, quantity, price)</span><br><span class="line">Orders (ordno, <span class="keyword">month</span>, cid, aid, pid, qty, dollars)</span><br></pre></td></tr></table></figure>

<p>Nomenclature (terms,æœ¯è¯­): </p>
<p>â¢ Tables &#x2F; Relations è¡¨&#x2F;å…³ç³»</p>
<p>â¢ Columns &#x2F; Fields &#x2F;Attributes åˆ—&#x2F;å­—æ®µ&#x2F;å±æ€§</p>
<p>â¢ Rows &#x2F; Tuples è¡Œ&#x2F;å…ƒç»„</p>
<p>Eg. In CAP database ï¼ˆæ¡ˆä¾‹ï¼‰</p>
<p>â—† products (pid, pname, city, quantity, price) </p>
<p>â€‹	â¢ Product â€” Table &#x2F; Relation </p>
<p>â€‹	â¢ pid â€” column &#x2F; field &#x2F; attribute</p>
<p>â€‹	 â¢ (p01, pencil, Xiâ€™an, 100, 0.2) â€” rows &#x2F; records &#x2F; tuples</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221124172513928.png" alt="image-20221124172513928"></p>
<h2 id="äºŒã€å…³ç³»æ•°æ®åº“-ï¼ˆThe-Relational-Modelï¼‰"><a href="#äºŒã€å…³ç³»æ•°æ®åº“-ï¼ˆThe-Relational-Modelï¼‰" class="headerlink" title="äºŒã€å…³ç³»æ•°æ®åº“ ï¼ˆThe Relational Modelï¼‰"></a>äºŒã€å…³ç³»æ•°æ®åº“ ï¼ˆThe Relational Modelï¼‰</h2><blockquote>
<ul>
<li>å…³ç³»æ¦‚å¿µ</li>
<li>å…³ç³»æ¦‚è¿°</li>
</ul>
</blockquote>
<h3 id="1ã€-CAP-å®ä¾‹æ•°æ®åº“"><a href="#1ã€-CAP-å®ä¾‹æ•°æ®åº“" class="headerlink" title="1ã€ CAP å®ä¾‹æ•°æ®åº“"></a>1ã€ CAP å®ä¾‹æ•°æ®åº“</h3><p>ç¬›å¡å°”ç§¯ï¼š</p>
<p>â–ª Cartesian Product : è®¾S1,Â·Â·Â·,Snä¸ºé›†åˆ,å®ƒä»¬çš„ç¬›å¡å°”ç§¯ä¸º S1 Ã— S2 Ã— Â·Â·Â· Ã— Sn &#x3D; { (e1, e2 , Â·Â·Â·, en) | eiâˆˆSi, i&#x3D;1,Â·Â·Â·,n } </p>
<p>â€‹	â¢ Element (e1,e2, Â·Â·Â·,en) called a n-tuple (nå…ƒç»„) </p>
<p>â€‹	â¢ Value â€œeiâ€ in the element called a åˆ†é‡ </p>
<p>â—¼ Relation: S1Ã—S2Ã—Â·Â·Â·Ã—Snçš„å­é›†ï¼Œç§°ä¸ºå…³ç³» è®°æˆ R &#x3D; S1Ã—S2Ã—Â·Â·Â·Ã—Sn </p>
<p>â—¼ Example1: CP &#x3D; CID Ã— CNAME Ã— CITY Ã— DISCNT å…¶ä¸­æœ‰ T1&#x3D;(c003, Allied, Dallas, 8.00) T2&#x3D;(c001,Basice, Oshkosh, 18.20) </p>
<p>â—¼ Example2: Family &#x3D; women Ã— men Ã— child not all the tuples consist of a real exist family</p>
<h3 id="2ã€æ•°æ®åº“ç³»ç»Ÿç»„æˆ"><a href="#2ã€æ•°æ®åº“ç³»ç»Ÿç»„æˆ" class="headerlink" title="2ã€æ•°æ®åº“ç³»ç»Ÿç»„æˆ"></a>2ã€æ•°æ®åº“ç³»ç»Ÿç»„æˆ</h3><p>Note: R &#x3D; S1 Ã— S2 Ã—Â·Â·Â·Ã—Sn </p>
<p>â–ª Râ€”å…³ç³»å </p>
<p>â–ª nâ€”å…³ç³»çš„ç›®æˆ–åº¦(degree). n&#x3D;1 ä¸€å…ƒå…³ç³»ï¼Œn&#x3D;2 äºŒå…ƒå…³ç³» </p>
<p>â–ª æ¯åˆ—å•ç‹¬å‘½åâ€”Attribute&#x2F;Field&#x2F;Columnï¼Œnå…ƒå…³ç³»æœ‰nä¸ªåˆ— </p>
<p>â–ª è‹¥æŸå±æ€§ç»„çš„å€¼èƒ½å”¯ä¸€æ ‡è¯†å…³ç³»Rä¸­çš„ä¸€ä¸ªTuple&#x2F;Record&#x2F;Rowï¼Œåˆ™è¯¥å±æ€§ç»„ ä¸ºCandidate Keyã€‚ ä»…å½“Rä¸­æ‰€æœ‰åˆ—æ„æˆçš„å±æ€§ç»„æ‰æ˜¯å®ƒçš„å€™é€‰ç æ—¶ï¼Œç§°è¯¥ç  ä¸ºAll-Key(å…¨ç )ã€‚ </p>
<p>â–ª è‹¥Ræœ‰å¤šä¸ªCandidate Keyï¼ˆå€™é€‰é”®ï¼‰ï¼Œé€‰åŒ…å«å±æ€§è¾ƒå°‘çš„åšPrimary Key(ä¸»ç )ï¼Œå€™é€‰ç ä¸­ çš„è¯¸å±æ€§ä¸ºPrime Attribute(ä¸»å±æ€§)ã€‚Non Key Attribute(éç å±æ€§)ã€‚</p>
<p>â–ª Example : orders&#x3D;{ ordno, month, cid, aid, pid, qty, dollars }</p>
<h3 id="3ã€å…³ç³»è§„åˆ™"><a href="#3ã€å…³ç³»è§„åˆ™" class="headerlink" title="3ã€å…³ç³»è§„åˆ™"></a>3ã€å…³ç³»è§„åˆ™</h3><p>å…³ç³»æ¨¡å‹åº”è¯¥éµå¾ªæ€æ ·çš„æ ‡å‡†ï¼Ÿ</p>
<p><strong>è§„åˆ™1.ç¬¬ä¸€èŒƒå¼è§„åˆ™ã€‚</strong><br>â—† åœ¨å…³ç³»æ¨¡å‹ä¸­ï¼Œå®ƒä¸èƒ½</p>
<ol>
<li><p>å¤šå€¼å­—æ®µå’Œ </p>
</li>
<li><p>ç»“æ„åŒ–å­—æ®µ</p>
</li>
</ol>
<p>â—† ç¤ºä¾‹ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221125170859025.png" alt="image-20221125170859025"></p>
<p>âœ“ è§£å†³æ–¹æ¡ˆ1ï¼šä½¿ç”¨æ–°åˆ—æ›´æ–°è¡¨ä»¥é€‚åº”é‡å¤é¡¹åœ¨ä¸åŒçš„åˆ—ä¸Š<br>âœ“ è§£å†³æ–¹æ¡ˆ2ï¼šåˆ›å»ºä¸¤ä¸ªè¡¨å¹¶åœ¨ä»¥åçš„æŸ¥è¯¢ä¸­è¿æ¥å®ƒä»¬</p>
<p><strong>è§„åˆ™2.ä»…æŒ‰å†…å®¹è®¿é—®è¡Œã€‚</strong><br>â–ª è§£é‡Šï¼šä¸èƒ½è¯´â€œä»é¡¶éƒ¨å¾€ä¸‹ç¬¬ä¸‰æ’â€ã€‚ï¼ˆè¡Œæˆ–åˆ—æ²¡æœ‰é¡ºåºï¼‰<br>â–ª è¡Œæ ‡è¯†ï¼šä¸å…è®¸å¯¹è¡Œä½¿ç”¨â€œæŒ‡é’ˆæˆ–è¡ŒIDâ€ã€‚ï¼ˆå¤§å¤šæ•°RDBMSé€šè¿‡æŒ‰RIDè·å–è¡Œæ¥æ‰“ç ´è¿™ä¸€è§„åˆ™ï¼‰<br><strong>è§„åˆ™3.å”¯ä¸€è¡Œã€‚</strong><br>â–ª 2è¡Œä¸èƒ½åœ¨æ‰€æœ‰å±æ€§ä¸­éƒ½ç›¸åŒ</p>
<h3 id="4ã€é”®ã€è¶…é”®åŠç©ºå€¼"><a href="#4ã€é”®ã€è¶…é”®åŠç©ºå€¼" class="headerlink" title="4ã€é”®ã€è¶…é”®åŠç©ºå€¼"></a>4ã€é”®ã€è¶…é”®åŠç©ºå€¼</h3><p>[1] table key é”®<br>åˆç§°å€™é€‰å¯†é’¥å”¯ä¸€æ ‡è¯†æ‰€åœ¨è¡Œçš„å±æ€§ç»„</p>
<p>[2]super key è¶…çº§é”®<br>ç”¨äºæ ‡è¯†å”¯ä¸€å…ƒç»„çš„å­—æ®µç»„çš„å€¼ã€‚<br>å¦‚æœä¸ä¸€å®šï¼Œæœ€å°å­—æ®µç»„å°†å˜ä¸ºè¶…çº§é”®ã€‚</p>
<p>[4] æ¯ä¸ªè¡¨Tè‡³å°‘æœ‰ä¸€ä¸ªé”®ã€‚</p>
<p>[5] <strong>primary key ä¸»é”®</strong><br>è¡¨Tçš„ä¸»é”®æ˜¯ç”±DBAå”¯ä¸€æ ‡è¯†Tä¸­çš„è¡Œã€‚<br>å› æ­¤ï¼Œè¡¨å…³é”®å­—&#x3D;&#x3D;å€™é€‰å…³é”®å­—â”â” è¶…çº§å¯†é’¥&#x3D;&#x3D;ä¸»é”®</p>
<p>[6] Nullå€¼<br>å½“ç‰¹å®šçš„å€¼æœªçŸ¥æˆ–å°šæœªå®šä¹‰ã€‚</p>
<h3 id="5ã€å…³ç³»ä»£æ•°"><a href="#5ã€å…³ç³»ä»£æ•°" class="headerlink" title="5ã€å…³ç³»ä»£æ•°"></a>5ã€å…³ç³»ä»£æ•°</h3><p>Relational Algebra (å…³ç³»ä»£æ•°)</p>
<p> â¢ ç®€å†™RA. ä»»ä½• RDBMS ä¸Š, å¯¹æ•°æ®æŸ¥è¯¢çš„æ•°å­¦è¡¨è¾¾å¼ (ä¸€ç§ä»£æ•°è¯­è¨€). </p>
<p>ä¸€äº›æ¦‚å¿µï¼ˆåºŸè¯ï¼‰</p>
<p> â€¢ ç°å®ä¸–ç•Œä¸­çš„å„ç§å®ä½“ã€å®ä½“é—´çš„å„ç§è”ç³»å‡ç”¨å…³ç³»æ¨¡å‹è¡¨ç¤º</p>
<p> â€¢ å…³ç³»æ¨¡å‹ç”±â€œå…³ç³»æ•°æ®ç»“æ„ã€å…³ç³»æ“ä½œé›†åˆã€å…³ç³»å®Œæ•´æ€§çº¦æŸâ€ç»„æˆ</p>
<p> â€¢ å€ŸåŠ©äºé›†åˆä»£æ•°ç­‰æ•°å­¦æ¦‚å¿µå’Œæ–¹æ³•æ¥å¤„ç†æ•°æ®åº“ä¸­çš„æ•°æ®</p>
<p><strong>ä¸¤ç§ç±»å‹çš„RAæ“ä½œ</strong>: </p>
<p>â–ª é›†åˆè®ºï¼ˆSet Theoreticï¼‰ (depend on fact that table is a set of rows) 4ç§ </p>
<p>â€‹	â—† äº¤ã€å¹¶ã€å·®ã€ç¬›å¡å°”ç§¯ intersection, union, difference, cardinality product </p>
<p>â–ª ä¼ ç»Ÿæ“ä½œï¼ˆNative operations ï¼‰(depend on structure of tables) 4ç§ </p>
<p>â€‹	â—† é€‰æ‹©ã€æŠ•å½±ã€è¿æ¥ã€é™¤ selection, projection, join, division</p>
<h3 id="6ã€é›†åˆè®ºæ“ä½œ"><a href="#6ã€é›†åˆè®ºæ“ä½œ" class="headerlink" title="6ã€é›†åˆè®ºæ“ä½œ"></a>6ã€é›†åˆè®ºæ“ä½œ</h3><ol>
<li>Compatible Table (ç›¸å®¹è¡¨) å¦‚æœä¸¤ä¸ªè¡¨å…·æœ‰ç›¸åŒçš„æ¨¡å¼ï¼Œåˆ™ç§°å®ƒä»¬æ˜¯å…¼å®¹çš„ã€‚</li>
<li>Set Theoretic Operations: R &amp; S are two compatible tables</li>
</ol>
<p>â€‹		â¢ Intersectionï¼ˆäº¤ï¼‰ï¼šç»“æœä¸ºnå…ƒå…³ç³»ï¼Œç”±å±äºRä¹Ÿå±äºSçš„å…ƒç»„ç»„æˆ R âˆ© S&#x3D;{ t | tâˆˆR âˆ§ tâˆˆS } </p>
<p>â€‹		â¢ Unionï¼ˆå¹¶ï¼‰ï¼šç»“æœä¸ºnå…ƒå…³ç³»ï¼Œç”±å±äºRæˆ–å±äºSçš„å…ƒç»„ç»„æˆ RâˆªS&#x3D;{ t | tâˆˆR âˆ¨ tâˆˆS } </p>
<p>â€‹		â¢ Differenceï¼ˆå·®ï¼‰ï¼šç»“æœä¸ºnå…ƒå…³ç³»ï¼Œç”±å±äºRè€Œä¸å±äºSçš„å…ƒç»„ç»„æˆ R - S &#x3D; { t | tâˆˆR âˆ§ t âˆ‰ S } </p>
<p>â€‹		â¢ Extended Cartesian Product (å¹¿ä¹‰ç¬›å¡å°”ç§¯): R ä¸ S å¯ä¸ç›¸å®¹ï¼Œç»“æœä¸º m+nåˆ—å…³ç³»ï¼Œå…±æœ‰m Ã— nä¸ªå…ƒç»„ R Ã— S &#x3D; { tr~ts | trâˆˆR âˆ§ tsâˆˆS }</p>
<p>æ¡ˆä¾‹ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221125173134521.png" alt="image-20221125173134521"></p>
<p>ç¬›å¡å°”ç§¯æ˜¯é›†åˆçš„åˆå¹¶ã€‚</p>
<ol start="3">
<li>Assignmentï¼ˆèµ‹å€¼ï¼‰ &amp; Aliasï¼ˆåˆ«åï¼‰</li>
</ol>
<p>â–ª Assignment, Alias:  S(B1, . . ., Bn) :&#x3D; R(A1, . . ., An) èµ‹å€¼</p>
<p>â–ª Alias: want a different table names with same attributes S :&#x3D; R åˆ«å</p>
<p>â–ª Save intermediate resultsï¼ˆå¯ä»¥ç”¨æ¥ä¿å­˜ä¸­é—´ç»“æœï¼‰ T :&#x3D; (R âˆ© S) - (R âˆ S) or T1 :&#x3D; (R âˆ© S) T2 :&#x3D; (RâˆS) T :&#x3D; T1 - T2</p>
<h3 id="7ã€ä¼ ç»Ÿå…³ç³»æ“ä½œ"><a href="#7ã€ä¼ ç»Ÿå…³ç³»æ“ä½œ" class="headerlink" title="7ã€ä¼ ç»Ÿå…³ç³»æ“ä½œ"></a>7ã€ä¼ ç»Ÿå…³ç³»æ“ä½œ</h3><ol>
<li><strong>The Projection æŠ•å½±</strong></li>
</ol>
<p>[1]Projection: Head(R) &#x3D; A1, . . . , An 	T :&#x3D; R[Aj, . . . , Ak] </p>
<p>â–ª Tæ˜¯Rçš„å­é›†ï¼Œæ˜¯Rçš„éƒ¨åˆ†åˆ—ã€‚ã€</p>
<p>â–ª å‚è€ƒä¹¦ï¼šRä¸­é€‰å‡ºè‹¥å¹²å±æ€§ç»„æˆæ–°å…³ç³»ï¼Œä»â€œåˆ—â€è§’åº¦æ“ä½œ.</p>
<p>ğ…ğ‘¨ (ğ‘¹) &#x3D; {ğ’• [ğ‘¨] ğ’•ğğ‘¹} </p>
<p>[2]æ¡ˆä¾‹: List all customer names from the customers.</p>
<p>â€‹				CN :&#x3D; CUSTOMERS [CNAME] </p>
<ol start="2">
<li><strong>The Selection é€‰æ‹©</strong></li>
</ol>
<p>[1] Selection: Head(R) &#x3D; A1, . . . , An  	R where C 	</p>
<p>C æ˜¯ä¸€ä¸ªé€»è¾‘æ¡ä»¶ï¼Œå¯ä»¥ä»å•è¡Œ C çš„å€¼ä¸­ç¡®å®šã€‚ </p>
<ul>
<li><p>Ai a Aj : where a is a constant with â€œ &lt;, &gt;, &#x3D;, &lt;&#x3D;, &gt;&#x3D;, &lt;&gt; â€</p>
</li>
<li><p>C also can be withed form : C and Câ€™, C or Câ€™, not C </p>
</li>
<li><p>å­—ç¬¦æ•°æ®æ¯”è¾ƒï¼šå·¦è¾¹èµ·ç¬¬ä¸€ä¸ªä¸ç›¸åŒå­—ç¬¦çš„ASCIIç æ¯”è¾ƒã€‚</p>
</li>
</ul>
<p>â–ª å‚è€ƒä¹¦ï¼šä»Rä¸­é€‰æ‹©æ»¡è¶³ç»™å®šæ¡ä»¶çš„å…ƒç»„ã€‚ â€œè¡Œâ€è§’åº¦çš„è¿ç®—, Fä¸ºé€‰æ‹©æ¡ä»¶å¼. ä¹Ÿç§°é™åˆ¶(Restriction). ğˆğ‘­ (ğ‘¹) &#x3D; {ğ’•|ğ’•ğğ‘¹ â‹€ ğ‘­(ğ’•) &#x3D; ğ’•ğ’“ğ’–ğ’†}</p>
<p>[2] æ¡ˆä¾‹: Find all the products stored in Dallas that cost more than $0.50 </p>
<p>â€‹				PRODUCTS where city &#x3D; â€˜Dallasâ€™ and price &gt;&#x3D; 0.5 </p>
<p>â€‹				ğˆğ’„ğ’Šğ’•ğ’š&#x3D; â€²ğ‘«ğ’‚ğ’ğ’ğ’‚ğ’” â€² ğ’‚ğ’ğ’… ğ’‘ğ’“ğ’Šğ’„ğ’†&gt;&#x3D;ğŸ.ğŸ“ (ğ‘·ğ’“ğ’ğ’…ğ’–ğ’„ğ’•)</p>
<ol start="3">
<li><strong>The Join</strong></li>
</ol>
<p>[1]Join: RÃ—S ä¸­,ä»¥â€œ R å…³ç³»åœ¨ A å±æ€§ç»„çš„å€¼â€ä¸â€œ S åœ¨ B å±æ€§ç»„çš„å€¼â€æ¯”è¾ƒï¼ŒæŒ‘å‡ºæ»¡è¶³â€œ tr[A] Î¸ ts[B]â€çš„å…ƒç»„. </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221125180415487.png" alt="image-20221125180415487"></p>
<p>ç‰¹1: Equijoin ç­‰å€¼è¿æ¥ , é€‰Aã€Bå±æ€§ç»„ä¸­å€¼ç›¸ç­‰çš„å…ƒç»„æ„æˆæ–°å…³ç³»ã€‚ </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221125180458011.png" alt="image-20221125180458011"></p>
<p>ç‰¹2ï¼š Natural Join è‡ªç„¶è¿æ¥, ç­‰å€¼è¿æ¥çš„åŸºç¡€ä¸ŠæŠŠé‡å¤åˆ—å»æ‰ </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221125180506122.png" alt="image-20221125180506122"></p>
<p>ã€ç»¼ä¸Šæœ‰ã€‘ï¼š Cartesian Product âŠƒ Join âŠƒ Equijoin âŠƒ Natural Join</p>
<p>[2]å¦ä¸€è¯´æ³•ï¼š Cardinality Productã€Equijoinã€Natural JoinåŒºåˆ« </p>
<ol>
<li>è‡ªç„¶è¿æ¥ ä¸€å®šæ˜¯ç­‰å€¼è¿æ¥ï¼Œä½†ç­‰å€¼è¿æ¥ä¸ä¸€å®šæ˜¯è‡ªç„¶è¿æ¥ã€‚ </li>
<li>ç­‰å€¼è¿æ¥ åˆ†é‡å€¼ç›¸ç­‰ï¼Œä¸ä¸€å®šæ˜¯å…¬å…±å±æ€§ï¼›è€Œè‡ªç„¶è¿æ¥ è¦æ±‚ç›¸ç­‰çš„ åˆ†é‡é¡»æ˜¯å…¬å…±å±æ€§(ç›¸å®¹).</li>
<li>è‡ªç„¶è¿æ¥ ä¸¤ä¸ªå…³ç³»ä¸­åšæ¯”è¾ƒçš„åˆ†é‡é¡»æ˜¯ç›¸åŒçš„å±æ€§ç»„ï¼Œä¸”è¿æ¥ç»“æœ ä¸­è¦å»æ‰é‡å¤çš„å±æ€§åˆ—ã€‚</li>
</ol>
<p>[3]æ¡ˆä¾‹ï¼š</p>
<p>Joinä¸å…¶å®ƒè¿ç®—é—´çš„å…³ç³»ï¼š Rã€Sä¸¤ä¸ªè¡¨æ²¡æœ‰å…¬å…±åˆ—æ—¶ RâˆS &#x3D; RÃ—S Rã€Sä¸¤ä¸ªè¡¨çš„åˆ—å®Œå…¨ä¸€è‡´æ—¶ RâˆS &#x3D; Râˆ©S</p>
<p>[4]æ¡ˆä¾‹ï¼š We wish to find the names of customers who have ordered product p01. </p>
<p>è¿‡ç¨‹ï¼š</p>
<p>â€‹								T1:&#x3D; CUSTOMER âˆ ORDER </p>
<p>â€‹								T2:&#x3D; CUSTOMER âˆ (ORDER where pid &#x3D; â€˜p01â€™ ) </p>
<p>â€‹								CP01:&#x3D;T2[cname] </p>
<p>ç®€åŒ–ï¼š</p>
<p>â€‹								CP01 :&#x3D; ( CUSTOMER âˆ (ORDER where pid &#x3D; â€˜p01â€™) ) [cname]</p>
<ol start="5">
<li><strong>å…³ç³»è¿ç®—çš„ä¼˜å…ˆçº§</strong></li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221125181146970.png" alt="image-20221125181146970"></p>
<ol start="6">
<li><strong>The Division Operation é™¤</strong></li>
</ol>
<p>Division: </p>
<p>Consider two tables R and S<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221125181427400.png" alt="image-20221125181427400"></p>
<p>â–ª è±¡é›†WX (R)ï¼šå…³ç³»R(X, Y)ä¸­å½“tr[X] &#x3D;x1æ—¶ï¼Œx1åœ¨Rä¸­çš„è±¡é›†ä¸ºR[X]ä¸Š å€¼ä¸ºx1çš„è¯¸å…ƒç»„, åœ¨Yå±æ€§å€¼çš„å­é›†. </p>
<p>â–ª Sä¸Šçš„æŠ•å½±ï¼š ğ‘¾ğ‘¿(ğ‘¹) &#x3D; {ğ’•ğ’“ [ğ’€] |ğ’•ğ’“ âˆˆ ğ‘¹, ğ’•ğ’“ [ğ‘¿] &#x3D; ğ’™ğŸ} ğ…ğ’€(ğ‘º) &#x3D; ğ‘º[ğ’€]<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221125182046169.png" alt="image-20221125182046169"></p>
<p>[3] æ¡ˆä¾‹ï¼šWe want to extract (select) the customers who have placed orders for all products that ordered by C006. æˆ‘ä»¬å¸Œæœ›æå–ï¼ˆé€‰æ‹©ï¼‰ä¹°äº† C006 é¡¾å®¢è®¢è´­çš„æ‰€æœ‰äº§å“ä¸‹è®¢å•çš„å®¢</p>
<p>a) Products that ordered by customer C006        </p>
<p>â€‹				PC6 :&#x3D; ( ORDERS where cid &#x3D; â€˜C006â€™ ) [ pid ] (C006 ä¹°è¿‡çš„è´§ç‰©å· pid)</p>
<p>b) All Order Projection: 						      	</p>
<p>â€‹				CP :&#x3D; ORDERS [cid, pid] (æ‰€æœ‰çš„è®¢å•çš„ cidï¼Œpid)</p>
<p>c) who have placed orders for all products that ordered by C006.     </p>
<p>â€‹				T :&#x3D; CP Ã· PC6 â†’â†’ T[cid] </p>
<h3 id="8ã€å…³ç³»æ“ä½œå®ä¾‹"><a href="#8ã€å…³ç³»æ“ä½œå®ä¾‹" class="headerlink" title="8ã€å…³ç³»æ“ä½œå®ä¾‹"></a>8ã€å…³ç³»æ“ä½œå®ä¾‹</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221125183028244.png" alt="image-20221125183028244"></p>
<h2 id="ä¸‰ã€å…³ç³»æ•°æ®åº“æ ‡å‡†è¯­è¨€SQLï¼ˆBasic-SQL-Query-Languageï¼‰"><a href="#ä¸‰ã€å…³ç³»æ•°æ®åº“æ ‡å‡†è¯­è¨€SQLï¼ˆBasic-SQL-Query-Languageï¼‰" class="headerlink" title="ä¸‰ã€å…³ç³»æ•°æ®åº“æ ‡å‡†è¯­è¨€SQLï¼ˆBasic SQL Query Languageï¼‰"></a>ä¸‰ã€å…³ç³»æ•°æ®åº“æ ‡å‡†è¯­è¨€SQLï¼ˆBasic SQL Query Languageï¼‰</h2><p>CAP æ•°æ®åº“</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20230216182350175.png" alt="image-20230216182350175"></p>
<p>ä¹ é¢˜ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"># ç›¸å…³ä¹ é¢˜</span><br><span class="line"><span class="comment">-- ä¸‰è€…åŒåŸ</span></span><br><span class="line"><span class="keyword">select</span> cid,aid,pid <span class="keyword">from</span> agents a,products p,customers c <span class="keyword">where</span> a.city <span class="operator">=</span> c.city <span class="keyword">and</span> c.city <span class="operator">=</span> p.city</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä¸‰è€…ä¸åŒåŸ</span></span><br><span class="line"><span class="keyword">select</span> cid,aid,pid <span class="keyword">from</span> agents a,products p,customers <span class="keyword">where</span> (cid,aid,pid)<span class="keyword">not</span> <span class="keyword">in</span> (</span><br><span class="line">	<span class="keyword">select</span> cid,aid,pid <span class="keyword">from</span> agents a,products p,customers c <span class="keyword">where</span> a.city <span class="operator">=</span> c.city <span class="keyword">and</span> c.city <span class="operator">=</span> p.city</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ‰¾è´­ä¹°äº†å…¨éƒ¨å•†å“çš„ç”¨æˆ· é™¤æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> orders(`<span class="keyword">month</span>`,cid,aid,pid,qty,dollars)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;2&#x27;</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">70</span>),(<span class="string">&#x27;3&#x27;</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">2900</span>),(<span class="string">&#x27;4&#x27;</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">7000</span>),(<span class="string">&#x27;5&#x27;</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">7000000</span>),(<span class="string">&#x27;6&#x27;</span>,<span class="number">1</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">1000000</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> cid <span class="keyword">from</span> customers <span class="keyword">where</span> <span class="keyword">not</span> <span class="keyword">exists</span> (</span><br><span class="line">	<span class="keyword">select</span> cid,pid <span class="keyword">from</span> orders <span class="keyword">where</span> c.id<span class="operator">=</span>o.cid <span class="keyword">not</span> <span class="keyword">exists</span> (</span><br><span class="line">		<span class="keyword">select</span> pid <span class="keyword">from</span> products <span class="keyword">where</span> o.pid<span class="operator">=</span>p.pid</span><br><span class="line">	)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- a03å–è¿‡çš„äº§å“a06æ²¡å–è¿‡</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> pid <span class="keyword">from</span> orders o <span class="keyword">where</span> o.aid <span class="operator">=</span> <span class="number">3</span> <span class="keyword">and</span> o.pid <span class="keyword">not</span> <span class="keyword">in</span> (</span><br><span class="line">	<span class="keyword">select</span> pid <span class="keyword">from</span> orders o2 <span class="keyword">where</span> o2.aid <span class="operator">=</span> <span class="number">6</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å§“åä»¥Nå¼€å¤´ï¼Œæ²¡ä¹°è¿‡newyorkä¸œè¥¿çš„ c.cid like &#x27;n%&#x27; and  </span></span><br><span class="line"><span class="keyword">select</span> c.cid <span class="keyword">from</span> orders o, customers c, products p </span><br><span class="line"><span class="keyword">where</span> c.cname <span class="keyword">like</span> <span class="string">&#x27;n%&#x27;</span> <span class="keyword">and</span>   o.pid <span class="operator">=</span> p.pid <span class="keyword">and</span> o.cid <span class="operator">=</span> c.cid <span class="keyword">and</span> p.city <span class="operator">!=</span> <span class="string">&#x27;newyork&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢æœªè´­ç‰©çš„é¡¾å®¢</span></span><br><span class="line"><span class="keyword">select</span> cid <span class="keyword">from</span> customers <span class="keyword">where</span> cid <span class="keyword">not</span> <span class="keyword">in</span>(<span class="keyword">select</span> cid <span class="keyword">from</span> orders)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ç»Ÿè®¡æ¯ä¸ªé¡¾å®¢ï¼Œè´­ç‰©æœ€å¤§è®¢å•æ•°</span></span><br><span class="line"><span class="keyword">select</span> cid,<span class="built_in">max</span>(dollars) <span class="keyword">from</span> orders <span class="keyword">group</span> <span class="keyword">by</span> cid</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ç»Ÿè®¡è´­ç‰©é¡¾å®¢çš„æœ€å¤§è®¢å•é¢å‡å€¼</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(maxspent) <span class="keyword">from</span> (<span class="keyword">select</span> cid,<span class="built_in">max</span>(dollars) <span class="keyword">as</span> maxspent <span class="keyword">from</span> orders <span class="keyword">group</span> <span class="keyword">by</span> cid) <span class="keyword">as</span> a</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ç»Ÿè®¡æ¯ä¸ªaidå–çš„pidçš„æ•°é‡</span></span><br><span class="line"><span class="keyword">select</span> aid,pid,<span class="built_in">sum</span>(qty) <span class="keyword">from</span> orders <span class="keyword">group</span> <span class="keyword">by</span> aid,pid</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢cidï¼Œä»–è´­ä¹°çš„æ¯ç§pidå¹³å‡æ•°éƒ½&gt;300</span></span><br><span class="line"><span class="keyword">select</span> aid <span class="keyword">from</span> orders </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> aid</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">avg</span>(qty) <span class="operator">&gt;</span> <span class="number">300</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- ç»Ÿè®¡cid,sum(qty),åªåœ¨a04ä¹°ä¸œè¥¿</span></span><br><span class="line"><span class="keyword">select</span> cid,<span class="built_in">sum</span>(qty) <span class="keyword">from</span> orders <span class="keyword">where</span> cid <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">select</span> cid <span class="keyword">from</span> orders <span class="keyword">where</span> aid <span class="operator">!=</span> <span class="number">4</span>)</span><br></pre></td></tr></table></figure>



<p>ä¸»çº¿ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127143130651.png" alt="image-20221127143130651"></p>
<p>âš« å¦‚ä½•ä»å…³ç³»æ¨¡å‹ä¸­å®ç°å…³ç³»æ•°æ®åº“ï¼Ÿ<br>âš« å¦‚ä½•ä½¿ç”¨æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Ÿ<br>âš« å¦‚ä½•å°†å…³ç³»ä»£æ•°è½¬æ¢ä¸ºè®¡ç®—æœºå¯ä»¥æ‰§è¡Œçš„æŒ‡ä»¤ï¼Ÿ</p>
<blockquote>
<p>ä½¿ç”¨ <strong>SQL</strong> (Structured Query Language): ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€</p>
</blockquote>
<h3 id="1ã€SQL-è¯­è¨€æ¦‚è¿°"><a href="#1ã€SQL-è¯­è¨€æ¦‚è¿°" class="headerlink" title="1ã€SQL è¯­è¨€æ¦‚è¿°"></a>1ã€SQL è¯­è¨€æ¦‚è¿°</h3><h4 id="SQLçš„åˆ†ç±»å’ŒåŠŸèƒ½ï¼š"><a href="#SQLçš„åˆ†ç±»å’ŒåŠŸèƒ½ï¼š" class="headerlink" title="SQLçš„åˆ†ç±»å’ŒåŠŸèƒ½ï¼š"></a>SQLçš„åˆ†ç±»å’ŒåŠŸèƒ½ï¼š</h4><p>åˆ†ç±»ï¼š</p>
<ul>
<li>DDL: Data Define Language ï¼ˆæ•°æ®å®šä¹‰è¯­è¨€ï¼‰</li>
<li>DML: Data Manipulate Language ï¼ˆæ•°æ®æ“çºµè¯­è¨€ï¼‰</li>
<li>DCL: Data Control Language ï¼ˆæ•°æ®æ§åˆ¶è¯­è¨€ï¼‰</li>
</ul>
<p>åŠŸèƒ½ï¼š</p>
<ol>
<li>ç»¼åˆç»Ÿä¸€</li>
<li>é«˜åº¦éè¿‡ç¨‹åŒ–</li>
<li>é¢å‘é›†åˆçš„æ“ä½œæ–¹å¼</li>
<li>SQLä»¥åŒä¸€ç§è¯­æ³•æ–¹å¼æä¾›ä¸¤ç§ä½¿ç”¨æ–¹å¼</li>
<li>è¯­è¨€ç®€æ´ï¼Œæ˜“å­¦æ˜“ç”¨</li>
</ol>
<h3 id="2ã€å»ºç«‹æ•°æ®åº“"><a href="#2ã€å»ºç«‹æ•°æ®åº“" class="headerlink" title="2ã€å»ºç«‹æ•°æ®åº“"></a>2ã€å»ºç«‹æ•°æ®åº“</h3><h4 id="é¢„å…ˆçŸ¥è¯†ï¼š"><a href="#é¢„å…ˆçŸ¥è¯†ï¼š" class="headerlink" title="é¢„å…ˆçŸ¥è¯†ï¼š"></a>é¢„å…ˆçŸ¥è¯†ï¼š</h4><p>[1]äº¤äº’å¼SQLï¼šå¯åŠ¨Oracle &#x2F;SQL Plus ã€å¯åŠ¨MySQL &#x2F;Workbench æˆ–ç¬¬ä¸‰æ–¹æ•°æ®åº“ç®¡ç†å·¥å…· Navicatã€SQL developer ç™»å½•DBMS ï¼›ç•Œé¢ä¸‹å‘å‡ºSQLæŒ‡ä»¤ã€‚ </p>
<p>[2] Login with DBMS must have following things </p>
<ul>
<li>An account&#x2F;user_id on DBMS </li>
<li>A password</li>
</ul>
<p>[3] åˆ›å»ºæ•°æ®åº“ã€è¿æ¥æ•°æ®åº“ã€åˆ›å»ºæ•°æ®è¡¨ </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># åˆ›å»ºæ•°æ®åº“ï¼š</span><br><span class="line"><span class="keyword">CREATE</span> SCHEMA db_xauat ; </span><br><span class="line"># è¿æ¥æ•°æ®åº“ï¼š</span><br><span class="line"><span class="keyword">CONNECT</span> <span class="keyword">TO</span> db_xauat ; </span><br><span class="line"># åˆ›å»ºæ•°æ®è¡¨ï¼š</span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">table</span> myui (</span><br><span class="line">    uid <span class="type">char</span>(<span class="number">4</span>) <span class="keyword">not</span> <span class="keyword">null</span>, </span><br><span class="line">    pass <span class="type">char</span>(<span class="number">8</span>), </span><br><span class="line">    <span class="keyword">primary</span> key (uid) </span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p> [4] SQLè¯­å¥ (ORACLE&#x2F;MySQLä¸­çš„SQLå¥ç»“æŸç¬¦ä¸ºâ€œ;â€) </p>
<ul>
<li>DDL: eg. Create scheme, Create table</li>
<li>DCL: eg. Grant, Revoke </li>
<li>DML: eg. Select, Insert, Update, Delete</li>
</ul>
<h4 id="CREATE-TABLE-è¯­å¥"><a href="#CREATE-TABLE-è¯­å¥" class="headerlink" title="CREATE TABLE è¯­å¥"></a>CREATE TABLE è¯­å¥</h4><p>â¢ [] the optional term &#x2F; å¯é€‰ </p>
<p>â¢ | select one term from many &#x2F; å¤šé€‰ä¸€ </p>
<p>â¢ {} the optional and repeat term &#x2F;å¯é€‰ä¸”å¯å¤é€‰ </p>
<p>â¢ ALL the Default term</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> tablename (</span><br><span class="line">    colname datatype [ <span class="keyword">not</span> <span class="keyword">null</span> ]</span><br><span class="line">	&#123; , colname datatype [ <span class="keyword">not</span> <span class="keyword">null</span> ] â€¦ &#125;</span><br><span class="line">	[ , <span class="keyword">PRIMARY</span> KEY ( colname &#123; , colname â€¦ &#125; ) ]</span><br><span class="line">)</span><br><span class="line">å‚è€ƒï¼š<span class="keyword">create</span> <span class="keyword">table</span> <span class="operator">&lt;</span>è¡¨å<span class="operator">&gt;</span>(ã€</span><br><span class="line">     <span class="operator">&lt;</span>åˆ—å<span class="operator">&gt;</span><span class="operator">&lt;</span>æ•°æ®ç±»å‹<span class="operator">&gt;</span>[åˆ—çº§å®Œæ•´æ€§çº¦æŸ]</span><br><span class="line">	 &#123;ï¼Œ<span class="operator">&lt;</span>åˆ—å<span class="operator">&gt;</span><span class="operator">&lt;</span>æ•°æ®ç±»å‹<span class="operator">&gt;</span>[åˆ—çº§å®Œæ•´æ€§çº¦æŸ]â€¦&#125;</span><br><span class="line">	 [ï¼Œ<span class="operator">&lt;</span>è¡¨çº§å®Œæ•´æ€§çº¦æŸ<span class="operator">&gt;</span>]</span><br><span class="line">ï¼‰ï¼›</span><br></pre></td></tr></table></figure>

<ul>
<li>è‹¥å®Œæ•´æ€§çº¦æŸæ¡ä»¶æ¶‰åŠè¯¥è¡¨çš„å¤šåˆ—ï¼Œåˆ™é¡»å®šä¹‰ä¸ºè¡¨çº§çº¦æŸ </li>
<li>Datatype ä¸­éœ€æŒ‡æ˜â€œç±»å‹ã€é•¿åº¦â€ï¼ŒDBMS äº§å“æ”¯æŒçš„ Datatype ä¸å®Œå…¨ç›¸åŒ</li>
</ul>
<p>Example 1: Create tables of Customers, Agents, Products and Orders for CAP DB</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> customers (</span><br><span class="line">	cid <span class="type">char</span>(<span class="number">4</span>) <span class="keyword">not</span> <span class="keyword">null</span>, </span><br><span class="line">	cname <span class="type">varchar</span>(<span class="number">13</span>), </span><br><span class="line">	city <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">	discnt <span class="type">real</span>, </span><br><span class="line">	<span class="keyword">primary</span> key (cid)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> agents (</span><br><span class="line">	aid <span class="type">char</span>(<span class="number">3</span>) <span class="keyword">not</span> <span class="keyword">null</span>, </span><br><span class="line">	aname <span class="type">varchar</span>(<span class="number">13</span>), </span><br><span class="line">	city <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">	<span class="keyword">percent</span> <span class="type">smallint</span>, </span><br><span class="line">	<span class="keyword">primary</span> key (aid)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> products (</span><br><span class="line">	pid <span class="type">char</span>(<span class="number">3</span>) <span class="keyword">not</span> <span class="keyword">null</span>, </span><br><span class="line">	pname <span class="type">varchar</span>(<span class="number">13</span>), </span><br><span class="line">	city <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">	quantity <span class="type">integer</span>, </span><br><span class="line">	price <span class="type">double precision</span>, </span><br><span class="line">	<span class="keyword">primary</span> key (pid)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> orders (</span><br><span class="line">	ordno <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>, </span><br><span class="line">	<span class="keyword">month</span> <span class="type">char</span>(<span class="number">3</span>), </span><br><span class="line">	cid <span class="type">char</span>(<span class="number">4</span>),</span><br><span class="line">	aid <span class="type">char</span>(<span class="number">3</span>), </span><br><span class="line">	pid <span class="type">char</span>(<span class="number">3</span>), </span><br><span class="line">	qty <span class="type">integer</span>, </span><br><span class="line">	dollars <span class="type">double precision</span>,</span><br><span class="line">	<span class="keyword">primary</span> key (ordno), # ä¸»é”®</span><br><span class="line">	<span class="keyword">foreign</span> key(aid) <span class="keyword">references</span> agents(aid), # å¤–é”®</span><br><span class="line">	<span class="keyword">foreign</span> key(cid) <span class="keyword">references</span> customers(cid),</span><br><span class="line">	<span class="keyword">foreign</span> key(pid) <span class="keyword">references</span> products(pid) </span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="3ã€ç®€å•-Select-å¥"><a href="#3ã€ç®€å•-Select-å¥" class="headerlink" title="3ã€ç®€å• Select å¥"></a>3ã€ç®€å• Select å¥</h3><p>å¦‚ä½•æŸ¥è¯¢æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Ÿ</p>
<h4 id="SELECT-è¯­æ³•"><a href="#SELECT-è¯­æ³•" class="headerlink" title="SELECT è¯­æ³•"></a>SELECT è¯­æ³•</h4><p>[1] å¥å¼ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Select</span> [ <span class="keyword">all</span>âˆ£<span class="keyword">distinct</span> ] <span class="operator">&lt;</span>ç›®æ ‡åˆ—è¡¨è¾¾å¼<span class="operator">&gt;</span> [<span class="operator">&lt;</span>ç›®æ ‡åˆ—è¡¨è¾¾å¼<span class="operator">&gt;</span>]â€¦</span><br><span class="line"><span class="keyword">From</span> <span class="operator">&lt;</span>è¡¨åæˆ–è§†å›¾å<span class="operator">&gt;</span>[ï¼Œ<span class="operator">&lt;</span>è¡¨åæˆ–è§†å›¾å<span class="operator">&gt;</span>]â€¦</span><br><span class="line"><span class="keyword">Where</span> <span class="operator">&lt;</span>æ¡ä»¶è¡¨è¾¾å¼<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">Group</span> <span class="keyword">by</span> <span class="operator">&lt;</span>åˆ—å<span class="number">1</span><span class="operator">&gt;</span> [ <span class="keyword">Having</span><span class="operator">&lt;</span>æ¡ä»¶è¡¨è¾¾å¼<span class="operator">&gt;</span>]</span><br><span class="line"><span class="keyword">Order</span> <span class="keyword">by</span> <span class="operator">&lt;</span>åˆ—å<span class="number">2</span><span class="operator">&gt;</span> [ <span class="keyword">ASC</span>âˆ£<span class="keyword">DESC</span> ]ï¼›</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>[2] Selectå«ä¹‰(åŠŸèƒ½)ï¼š </p>
<ul>
<li>ä¾ where å­å¥çš„è¡¨è¾¾å¼ï¼Œä» from å­å¥æŒ‡å®šçš„è¡¨&#x2F;è§†å›¾ä¸­ï¼Œæ‰¾æ»¡è¶³æ¡ä»¶çš„å…ƒç»„ï¼›</li>
<li>æŒ‰ Select ç›®æ ‡åˆ—é€‰å‡ºå…ƒç»„ä¸­çš„å±æ€§ï¼Œå½¢æˆæŸ¥è¯¢ç»“æœé›†ï¼›</li>
<li>ç»“æœé›†æŒ‰ Group æŒ‡å‡ºçš„åˆ—ï¼Œç›¸åŒå€¼åˆ†ä¸ºä¸€ç»„ï¼›æ»¡è¶³ Having æ¡ä»¶çš„ç»“æœç»„è¾“å‡ºï¼›</li>
<li>è¾“å‡ºçš„ç»“æœç»„ï¼ŒæŒ‰ Order æŒ‡å®šçš„åˆ—å€¼æ’åºæ˜¾ç¤ºï¼›ASC ä¸ºå‡åºï¼ŒDESC ä¸ºé™åºã€‚</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127151431918.png" alt="image-20221127151431918"></p>
<p>[4] Selectä¸Relational Algebraï¼ˆå…³ç³»è¡¨è¾¾å¼ï¼‰çš„å…³ç³» </p>
<ul>
<li>from å­å¥ &lt;&#x3D;&#x3D;&#x3D;&gt; Rel. Alg.ä¸­çš„â€œRelationâ€ </li>
<li>where å­å¥ &lt;&#x3D;&#x3D;&#x3D;&gt; Rel. Alg.ä¸­çš„â€œSelectionâ€è¿ç®— </li>
<li>select å­å¥ &lt;&#x3D;&#x3D;&#x3D;&gt; Rel. Alg.ä¸­çš„â€œProjectionâ€è¿ç®— </li>
<li>group å­å¥ï¼šæŸ¥è¯¢ç»“æœé›†æŒ‰â€œåˆ— i â€å€¼åˆ†ç»„ï¼Œå€¼ç›¸åŒçš„å…ƒç»„æ’åœ¨ä¸€ç»„ </li>
<li>group å­å¥å¸¦havingçŸ­è¯­ï¼šæ»¡è¶³havingæ¡ä»¶çš„ç»“æœç»„æ‰è¾“å‡º. </li>
<li>order by å­å¥ï¼ŒæŸ¥è¯¢ç»“æœè¿˜åº”æŒ‰â€œåˆ— j â€å€¼æ’åº.</li>
</ul>
<h4 id="ä¾‹é¢˜ï¼š"><a href="#ä¾‹é¢˜ï¼š" class="headerlink" title="ä¾‹é¢˜ï¼š"></a>ä¾‹é¢˜ï¼š</h4><p>Example 1. We wish to find the aids and names of agents that are based in New York . ï¼ˆæ‰¾åˆ°é©»çº½çº¦çš„ä»£ç†äººçš„nameå’Œaidï¼‰</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127151827663.png" alt="image-20221127151827663"></p>
<p>Example 2. Display all values in every row of the customer.(æ˜¾ç¤ºå®¢æˆ·æ¯è¡Œä¸­çš„æ‰€æœ‰å€¼)</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127154001065.png" alt="image-20221127154001065"></p>
<p>Example 3. Select all pids for which orders are placed.(é€‰æ‹©æ‰€æœ‰è®¢å•çš„pid)</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127154140192.png" alt="image-20221127154140192"></p>
<p>Example 4. Retrieve all (cname, aname) pairs where the customer places an order through the agent.ï¼ˆæ£€ç´¢å®¢æˆ·é€šè¿‡ä»£ç†ä¸‹å•çš„æ‰€æœ‰ï¼ˆcnameã€anameï¼‰ï¼‰</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127154251379.png" alt="image-20221127154251379"></p>
<p>Example 5. Retrieve a table based on orders, with columns ordno, cid, aid, pid, and profit on order. Where the â€œprofitâ€ is calculated from â€œquantity and price of the product sold(sell) by subtracting(except) 60% for whole sale cost, the discount for the customer and the percent commission for the agent.</p>
<p>ï¼ˆæ ¹æ®è®¢å•æ£€ç´¢è¡¨ï¼Œåˆ—ä¸ºordnoã€cidã€ï¼Œaidã€pidå’Œprofit ã€‚å¦‚æœâ€œåˆ©æ¶¦â€æ˜¯æ ¹æ®â€œæ•°é‡å’Œé”€å”®äº§å“çš„ä»·æ ¼å‡å»æ•´ä¸ªé”€å”®æˆæœ¬çš„60%ï¼Œå®¢æˆ·çš„æŠ˜æ‰£å’Œä»£ç†å•†çš„ä½£é‡‘ç™¾åˆ†æ¯”ï¼‰</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127154612320.png" alt="image-20221127154612320"></p>
<p>Example 6.  List all pairs of cids based in the same city.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127154651181.png" alt="image-20221127154651181"></p>
<p>Example 7. Get cids who order a product for which an order is also placed by agent a06. (æ‰¾cidsï¼Œå®ƒä»¬è®¢è´­çš„äº§å“ï¼Œa06ä¹Ÿå–ç»™è¿‡åˆ«äºº)</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127154729994.png" alt="image-20221127154729994"></p>
<h3 id="4ã€å­æŸ¥è¯¢ã€è°“è¯"><a href="#4ã€å­æŸ¥è¯¢ã€è°“è¯" class="headerlink" title="4ã€å­æŸ¥è¯¢ã€è°“è¯"></a>4ã€å­æŸ¥è¯¢ã€è°“è¯</h3><h4 id="å­æŸ¥è¯¢"><a href="#å­æŸ¥è¯¢" class="headerlink" title="å­æŸ¥è¯¢"></a>å­æŸ¥è¯¢</h4><ul>
<li>é€‰æ‹©è¯­å¥å‡ºç°åœ¨å¦ä¸€ä¸ªé€‰æ‹©æ¡ä»¶ä¸­ã€‚</li>
<li>ä½¿ç”¨å¸¦æœ‰TRUEæˆ–FALSEçš„è°“è¯å’Œé€»è¾‘æ¡ä»¶ã€‚</li>
</ul>
<p>Example 1. Retrieve cids of customers who place orders with agents in Duluth or Dallas. ï¼ˆæ£€ç´¢å‘Duluthæˆ–Dallasä»£ç†å•†ä¸‹å•çš„å®¢æˆ·çš„cidã€‚ï¼‰</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127155233563.png" alt="image-20221127155233563"></p>
<p>Example 2. Retrieve information of agents based in Duluth or Dallasï¼ˆæ£€ç´¢Duluthæˆ–Dallasä»£ç†å•†çš„ä¿¡æ¯ï¼‰</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127155508931.png" alt="image-20221127155508931"></p>
<p>æ³¨æ„<strong>in</strong>çš„ä½¿ç”¨ï¼š</p>
<p>inç”¨æ¥æ¯”è¾ƒä¸€ä¸ªå…ƒç´ æ˜¯ä¸æ˜¯åœ¨è¿™ä¸ªé›†åˆä¸­ã€‚</p>
<hr>
<h4 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><p>[1] Uncorrelated Subqueryï¼ˆä¸ç›¸å…³å­æŸ¥è¯¢ï¼‰<br>å¯ä»¥é¢„å…ˆè®¡ç®—å†…éƒ¨SQLè¯­å¥ï¼ˆå†…éƒ¨å­æŸ¥è¯¢å®Œå…¨ç‹¬ç«‹äºå¤–éƒ¨å­æŸ¥è¯¢ï¼‰</p>
<p>[2] Correlated Subqueryï¼ˆç›¸å…³å­æŸ¥è¯¢ï¼‰<br>æ— æ³•é¢„å…ˆè®¡ç®—å†…å¾ªç¯ï¼›å› ä¸ºå­æŸ¥è¯¢ä½¿ç”¨æ¥è‡ªå¤–éƒ¨Selectçš„æ•°æ®ã€‚</p>
<p>Example 1. (Correlated Subquery) Find cnames who order product p05.ï¼ˆç›¸å…³å­æŸ¥è¯¢ï¼‰æŸ¥æ‰¾è®¢è´­äº§å“p05çš„cnamesã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127160220512.png" alt="image-20221127160220512"></p>
<p>Example 2.  (Uncorrelated Subquery) Get cnames who order product p07 from agent a03.ï¼ˆä¸ç›¸å…³å­æŸ¥è¯¢ï¼‰è·å–ä»ä»£ç†a03è®¢è´­äº§å“p07çš„cnamesã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127160402745.png" alt="image-20221127160402745"></p>
<p>Example 2.  Retrieve ordno for all orders placed by customers in Duluth through agents in New York.ï¼ˆæ£€ç´¢Duluthå®¢æˆ·é€šè¿‡çº½çº¦ä»£ç†å•†ä¸‹è¾¾çš„æ‰€æœ‰è®¢å•çš„è®¢å•å·ã€‚ï¼‰</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127160654460.png" alt="image-20221127160654460"></p>
<h4 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h4><p>[1] Select statement is nonprocedural </p>
<p>[2] in predicate: expr [NOT] in (Subquery) | expr [NOT] in (val1{ , val2â€¦})</p>
<h4 id="Quantified-Comparison-Predicate-é‡åŒ–æ¯”è¾ƒè°“è¯"><a href="#Quantified-Comparison-Predicate-é‡åŒ–æ¯”è¾ƒè°“è¯" class="headerlink" title="Quantified Comparison Predicate é‡åŒ–æ¯”è¾ƒè°“è¯"></a>Quantified Comparison Predicate é‡åŒ–æ¯”è¾ƒè°“è¯</h4><p>[1] Comparison Predicates æ¯”è¾ƒä½æ¬¡</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127161147003.png" alt="image-20221127161147003"></p>
<p>that â€œsomeâ€ and â€œanyâ€ mean same thing.</p>
<p>Example 1.  Find all customers who have the same discount as that of any of the customers in Dallas or Boston.æŸ¥æ‰¾ä¸Dallas or Bostonçš„ä»»ä½•å®¢æˆ·äº«æœ‰ç›¸åŒæŠ˜æ‰£çš„æ‰€æœ‰å®¢æˆ·ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127161734576.png" alt="image-20221127161734576"></p>
<p>Example 2. Get cid of customers with discnt smaller than discnt of any customer who lives in Duluth. è·å–æ¯”å±…ä½åœ¨Duluthçš„ä»»ä½•å®¢æˆ·çš„æŠ˜æ‰£ç‡éƒ½å°çš„é¡¾å®¢çš„cidã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127162312651.png" alt="image-20221127162312651"></p>
<h4 id="ç­‰æ•ˆå…³ç³»ï¼š"><a href="#ç­‰æ•ˆå…³ç³»ï¼š" class="headerlink" title="ç­‰æ•ˆå…³ç³»ï¼š"></a>ç­‰æ•ˆå…³ç³»ï¼š</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127162434199.png" alt="image-20221127162434199"></p>
<h4 id="EXISTS-è°“è¯"><a href="#EXISTS-è°“è¯" class="headerlink" title="EXISTS è°“è¯"></a>EXISTS è°“è¯</h4><p>[1] Exists predicate: [NOT] EXIST (Subquery) </p>
<p>EXIST(subquery) is true &lt;&#x3D;&#x3D;&gt; subquery is a non-empty set </p>
<p>NOT EXIST(subquery) is true &lt;&#x3D;&#x3D;&gt; subquery is an empty set </p>
<p>[2] Example 1. Find cnames who place an order through a05.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127162733332.png" alt="image-20221127162733332"></p>
<p>Example 2. Retrieve all customer names where the customer does not place an order through â€˜a05â€™.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127163118003.png" alt="image-20221127163118003"></p>
<h3 id="5ã€UNION-æ“ä½œåŠ-ALL-æ¡ä»¶"><a href="#5ã€UNION-æ“ä½œåŠ-ALL-æ¡ä»¶" class="headerlink" title="5ã€UNION æ“ä½œåŠ ALL æ¡ä»¶"></a>5ã€UNION æ“ä½œåŠ ALL æ¡ä»¶</h3><h4 id="UNIONè¿ç®—ç¬¦"><a href="#UNIONè¿ç®—ç¬¦" class="headerlink" title="UNIONè¿ç®—ç¬¦"></a>UNIONè¿ç®—ç¬¦</h4><p>[1] Union syntax : Subquery UNION [ALL] Subquery</p>
<p>[2]Example 1. We wish to list of cities where either a customer or an agent, or both, is based. </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127163340478.png" alt="image-20221127163340478"></p>
<h4 id="Divisioné™¤æ³•"><a href="#Divisioné™¤æ³•" class="headerlink" title="Divisioné™¤æ³•"></a>Divisioné™¤æ³•</h4><p>SQL â€œfor allâ€¦â€ Conditions(å…¨ç§°é‡è¯) </p>
<p>[1] Example 1. Find cids of customers who place orders with ALL agents based in New York. ï¼ˆæ‰¾cidsï¼Œä»–çš„è®¢å•å…¨éƒ½æ˜¯New Yorkçš„agentsé”€å”®çš„ï¼‰</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127163715452.png" alt="image-20221127163715452"></p>
<p>Example 2. Get the aids of agents in New York or Duluth who place orders for all products costing more than a dollar. (æ‰¾New Yorkæˆ–Duluthçš„aidsï¼Œä»–ä»¬é”€å”®æ‰€æœ‰å•ä»·&gt;1ç¾å…ƒçš„äº§å“) </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127163951055.png" alt="image-20221127163951055"></p>
<h3 id="6ã€SQL-é«˜çº§è¯­æ³•"><a href="#6ã€SQL-é«˜çº§è¯­æ³•" class="headerlink" title="6ã€SQL é«˜çº§è¯­æ³•"></a>6ã€SQL é«˜çº§è¯­æ³•</h3><h4 id="UNIONã€INTERSECTã€EXCEPT"><a href="#UNIONã€INTERSECTã€EXCEPT" class="headerlink" title="UNIONã€INTERSECTã€EXCEPT"></a>UNIONã€INTERSECTã€EXCEPT</h4><p>[1] form subquery {UNION [ALL] | INTERSECT [ALL] | EXCEPT [ALL] subquery} </p>
<p>[2] Example 1. Find cids who order both products p01 and p07.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127164616343.png" alt="image-20221127164616343"></p>
<p>Example 2.  Retrieve all cnames where the customer donâ€™t place any order through agent a05.ï¼ˆæœªé€šè¿‡ä»£ç†a05ä¸‹å•çš„æ‰€æœ‰cnameï¼‰</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127164707768.png" alt="image-20221127164707768"></p>
<h4 id="JOIN-IN"><a href="#JOIN-IN" class="headerlink" title="JOIN IN"></a>JOIN IN</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127165438956.png" alt="image-20221127165438956"></p>
<p>Example 1. Retrieve all cnames where the customer places at least two orders for the same product. æ£€ç´¢å®¢æˆ·è‡³å°‘ä¸ºåŒä¸€äº§å“ä¸‹ä¸¤ä¸ªè®¢å•çš„æ‰€æœ‰cnameã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127165546819.png" alt="image-20221127165546819"></p>
<p>Example1. Retrieve all customers who has buy at least one product costing less than $0.50. </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127165751321.png" alt="image-20221127165751321"></p>
<h4 id="Outer-Join"><a href="#Outer-Join" class="headerlink" title="Outer Join"></a>Outer Join</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221127165923586.png" alt="image-20221127165923586"></p>
<h3 id="7ã€é›†å‡½æ•°"><a href="#7ã€é›†å‡½æ•°" class="headerlink" title="7ã€é›†å‡½æ•°"></a>7ã€é›†å‡½æ•°</h3><p>[1] Set Functions</p>
<p> â–ª Five types : count, max, min, sum, avg</p>
<p> â–ª Operate on sets of values, return a single value	å¯¹å¤šç»„å€¼è¿›è¡Œæ“ä½œï¼Œè¿”å›å•ä¸ªå€¼</p>
<p>[2] sqlè¯­æ³•</p>
<p>Select <code>SET_functionName</code> ([ ALL | DISTINCT ] colname) fromâ€¦.. </p>
<p>Select COUNT(*) fromâ€¦â€¦</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221128183942856.png" alt="image-20221128183942856"></p>
<p>Example 1. Please to determine the total quantity of product p03 that has been ordered.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(qty) <span class="keyword">as</span> TOTAL <span class="keyword">from</span> orders <span class="keyword">where</span> pid <span class="operator">=</span> <span class="string">&#x27;p03â€˜;</span></span><br></pre></td></tr></table></figure>

<p>Example 2. Get number of cities where customers are based. select count (distinct city) from customers;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span> (<span class="keyword">distinct</span> city) <span class="keyword">from</span> customers;</span><br></pre></td></tr></table></figure>

<p>Comparing: </p>
<p>select count(* ) from customers;      &#x2F;* all the numbers of rows  *&#x2F;</p>
<p>select count(cid) from customers;    &#x2F;* null values not counted *&#x2F; </p>
<p>â€‹														  &#x2F;* cid not null in customers *&#x2F;</p>
<p>select count(city) from customers;  &#x2F;* only if no null city values*&#x2F;</p>
<p>[3]é™åˆ¶:è§„å®šé›†åˆå‡½æ•°ä¸å…è®¸å‡ºç°ä¸WHEREå­å¥ä¸å…¼å®¹çš„æƒ…å†µ</p>
<p>Example 3. List the cids who have a discount less than maximum discount.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#Invalid <span class="keyword">SQL</span>:é”™è¯¯</span><br><span class="line"><span class="keyword">select</span> cid <span class="keyword">from</span> customers <span class="keyword">where</span> discnt <span class="operator">&lt;</span> <span class="built_in">max</span>(discnt);</span><br><span class="line">#Effective <span class="keyword">SQL</span>:æ­£ç¡®</span><br><span class="line"><span class="keyword">select</span> cid <span class="keyword">from</span> customers</span><br><span class="line"><span class="keyword">where</span> discnt <span class="operator">&lt;</span> (<span class="keyword">select</span> <span class="built_in">max</span>(discnt) <span class="keyword">from</span> customers);</span><br></pre></td></tr></table></figure>

<p>Example 4. Find products ordered by at least two customers.æŸ¥æ‰¾è‡³å°‘ä¸¤ä¸ªå®¢æˆ·è®¢è´­çš„äº§å“ã€‚</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> pid <span class="keyword">from</span> products <span class="keyword">where</span> <span class="number">2</span> <span class="operator">&lt;=</span> (<span class="keyword">select</span> <span class="built_in">count</span>(<span class="keyword">distinct</span> cid)â€¦)</span><br></pre></td></tr></table></figure>

<p>[4] å¤„ç†null</p>
<p>â–ª null is a special constant(å¸¸æ•°) </p>
<p>â–ª meaningful a value that is UNKNOWN</p>
<p>Example 5.  After adding a row (c007, Windix, Dallas, null) to the customers table, Pose the query to retrieve this row.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">SQL</span> effectiveæœ‰æ•ˆ</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> customers <span class="keyword">where</span> discnt <span class="keyword">is</span> <span class="keyword">null</span>;</span><br><span class="line">#wonâ€™t be retrieveéæ³•</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> customers <span class="keyword">where</span> discnt<span class="operator">&lt;=</span><span class="number">10</span> <span class="keyword">and</span> discnt<span class="operator">&gt;</span><span class="number">10</span>;</span><br></pre></td></tr></table></figure>

<p>Example 6. After adding the row (c007,Windix,Dallas,null) to customers table. We wish to find the average discount of all customers.</p>
<p>a) the null is discardedï¼ˆæŠ›å¼ƒï¼Œæ’é™¤ï¼‰ </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(discnt) <span class="keyword">from</span> customers; </span><br></pre></td></tr></table></figure>

<p>b) A set function acting on a empty set </p>
<p>â–ª count() returns zero for a empty set. </p>
<p>â–ª sum(), avg(), max() and min() return the null value.</p>
<h3 id="8ã€åˆ†ç»„GROUP"><a href="#8ã€åˆ†ç»„GROUP" class="headerlink" title="8ã€åˆ†ç»„GROUP"></a>8ã€åˆ†ç»„GROUP</h3><p>å¦‚ä½•å°†æ•°æ®åˆ†ç±»åˆ°ä¸åŒçš„ç»„ä¸­ï¼Ÿ</p>
<h4 id="GROUPã€HAVINGè¯­æ³•"><a href="#GROUPã€HAVINGè¯­æ³•" class="headerlink" title="GROUPã€HAVINGè¯­æ³•"></a>GROUPã€HAVINGè¯­æ³•</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">ALL</span><span class="operator">|</span><span class="keyword">DISTINCT</span>] &#123;<span class="operator">*</span><span class="operator">|</span>expr [[<span class="keyword">AS</span>] c_alias]&#123;,expr [[<span class="keyword">AS</span>] c_alias]...&#125;&#125;</span><br><span class="line"><span class="keyword">FROM</span> tableref &#123;, tabletrf...&#125;</span><br><span class="line">[<span class="keyword">WHERE</span> search_condition]</span><br><span class="line">[<span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">column</span> &#123;, column...&#125; ]</span><br><span class="line">[<span class="keyword">HAVING</span> search_condition]</span><br><span class="line"><span class="operator">|</span> subquery <span class="keyword">UNION</span> [<span class="keyword">ALL</span>] <span class="operator">|</span> <span class="keyword">INTERSECT</span> [<span class="keyword">ALL</span>] <span class="operator">|</span> <span class="keyword">EXCEPT</span> [<span class="keyword">ALL</span>]</span><br><span class="line">[<span class="keyword">CORRESPONDING</span> [<span class="keyword">BY</span>] (colname &#123;, colname . . .&#125;)] subquery</span><br></pre></td></tr></table></figure>

<p>Example 1. Letâ€™s create a query to calculate the total product quantity ordered of each individual product by each individual customer. (æŸ¥è®¢å•ä¸­æ¯ä¸ª(pid, cid)å¯¹çš„è®¢è´§æ•° ).</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> pid, cid, <span class="built_in">sum</span>(qty) <span class="keyword">as</span> TOTAL <span class="keyword">from</span> orders <span class="keyword">group</span> <span class="keyword">by</span> pid, cid;</span><br></pre></td></tr></table></figure>

<p>Example 2. Print out the aname, aid, pname, pid together with the total quantity each agent supplies of that product to customers c002 and c003.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> aname, a.aid, pname, p.pid, <span class="built_in">sum</span>(qty) <span class="keyword">as</span> total_qty</span><br><span class="line"><span class="keyword">from</span> agent a, products p, orders x</span><br><span class="line"><span class="keyword">where</span> x.cid <span class="keyword">in</span> (â€˜c002â€™,â€™c003â€™) <span class="keyword">and</span> x.aid<span class="operator">=</span>a.aid <span class="keyword">and</span> x.pid<span class="operator">=</span>p.pid</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> aid, pid;</span><br></pre></td></tr></table></figure>

<p>Example 4. Provided pids purchased by (sell to) at least two customers.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> pid <span class="keyword">from</span> orders <span class="keyword">group</span> <span class="keyword">by</span> pid <span class="keyword">having</span> <span class="built_in">count</span>(<span class="keyword">distinct</span> cid) <span class="operator">&gt;=</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<p>Example 4. Pose a query to find the average, over all agents, of the maximum dollar sales made by each agent.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(t.x) <span class="keyword">from</span> (<span class="keyword">select</span> aid, <span class="built_in">max</span>(dollars) <span class="keyword">as</span> x <span class="keyword">from</span> orders <span class="keyword">group</span> <span class="keyword">by</span> aid) t;</span><br></pre></td></tr></table></figure>

<h3 id="9ã€å®Œæ•´-Select-å¥"><a href="#9ã€å®Œæ•´-Select-å¥" class="headerlink" title="9ã€å®Œæ•´ Select å¥"></a>9ã€å®Œæ•´ Select å¥</h3><ol>
<li>åšSelectè¯­å¥çš„å®éªŒ<br>aï¼‰ FROMå­å¥ä¸­æ‰€æœ‰è¡¨çš„ç¬›å¡å°”ç§¯éƒ½å·²å½¢æˆã€‚<br>bï¼‰ æ¶ˆé™¤WHEREæ¡ä»¶ä¸­ä¸æ»¡è¶³çš„è¡Œ(æ¶ˆå»&#x2F;é™åˆ¶).<br>cï¼‰ é‡æ’è¡ŒæŒ‰ç…§GROUP BYåˆ†ç»„ã€‚<br>dï¼‰ ç„¶åæ¶ˆé™¤ä¸æ»¡è¶³HAVINGå­å¥çš„ç»„ã€‚<br>eï¼‰ è®¡ç®—Select Clauseç›®æ ‡åˆ—è¡¨çš„è¡¨è¾¾å¼ã€‚<br>fï¼‰ å¦‚æœå­˜åœ¨å…³é”®å­—DISTINCTï¼Œåˆ™æ¶ˆé™¤é‡å¤çš„è¡Œã€‚è¿™ä¸ªUNIONã€INTERSECTã€EXCEPTåœ¨æ¯ä¸ªå­æŸ¥è¯¢ä¹‹åæ‰§è¡Œã€‚<br>gï¼‰ å¦‚æœå­˜åœ¨ORDER BYï¼Œåˆ™å¯¹æ‰€æœ‰é€‰å®šè¡Œçš„é›†åˆè¿›è¡Œæ’åºã€‚</li>
</ol>
<p>Example 1. List all customers, agents and the dollar sales for pairs of customers and agents, and order the result from largest to smallest sales totals. Retain only those pairs for which the dollar amount is at least 900.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> c.cname, c.cid, a.aname, a.aid, <span class="built_in">sum</span>(o.dollars) <span class="keyword">as</span> casales</span><br><span class="line"><span class="keyword">from</span> customers c, orders o, agents a</span><br><span class="line"><span class="keyword">where</span> c.cid <span class="operator">=</span> o.cid <span class="keyword">and</span> o.aid <span class="operator">=</span> a.aid</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> (c.cname,) c.cid, (a.aname,) a.aid</span><br><span class="line"><span class="keyword">having</span> <span class="built_in">sum</span>(o.dollars) <span class="operator">&gt;=</span> <span class="number">900.00</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> <span class="number">5</span> <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>Expressions, Predicates, Search_condition</li>
</ol>
<p>[1] expressions form expr &#x3D; num-expr | strv-expr | date-xpr | intv-expr | con-dexpr</p>
<p>[2] Data Types </p>
<p>â–ª numeric value expressions </p>
<p>â–ª string value expression </p>
<p>â–ª datetime expression </p>
<p>â–ª interval value expression</p>
<p> â–ª conditional expression</p>
<p>[3] Mathematical functions</p>
<p> abs(n), mod(n,b), sqrt(n). 	NOT standardized in SQL-99. </p>
<p>[4] Char &amp; string functions</p>
<ul>
<li>CHAR_LENGTH (str) </li>
<li>SUBSTRING (str FROM start [FOR length]) </li>
<li>TRIM ([[LEADING|TRAILING|BOTH] [set] FROM] str) </li>
<li>POSITION (str1 IN str2) </li>
<li>UPPER(strval), LOWER(strval)</li>
</ul>
<p>[5] TRUTH VALUES </p>
<p>â–ª TRUE, FALSE or UNKNOW (â€˜Uâ€™ is not equivalent to F)</p>
<p>[6] Predicates </p>
<p>a) Comparison predicate: expr1 { expr2 | expr1 (Subquery)} </p>
<p>b) Between predicate: c.discnt between 10 and 12 </p>
<p>c) In predicate: expr [not] in (subquery) </p>
<p>d) Quantified predicate: expr [all |any |some] (subquery) </p>
<p>e) Exists predicate: [not] exists (subquery) f) Is null predicate: columnname is [not] null </p>
<p>g) Like predicate: columnname [not] like â€˜patternâ€™</p>
<ol start="4">
<li>Summary of Predicates è°“è¯æ€»æ±‡</li>
</ol>
<p>[1]Comparison predicate æ¯”è¾ƒè°“è¯</p>
<p>expr1 | expr1 (Subquery){&#x3D;, &lt;&gt;, &gt;, &lt;,&gt;&#x3D;, &lt;&#x3D;} </p>
<hr>
<p>Example 1. Listed cids of all customers with a discount less than the maximum discount. </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> cid <span class="keyword">from</span> customers <span class="keyword">where</span> discnt <span class="operator">&lt;</span> (<span class="keyword">select</span> <span class="built_in">max</span>(discnt) <span class="keyword">from</span> customers); </span><br><span class="line"><span class="keyword">select</span> cid <span class="keyword">from</span> customers <span class="keyword">where</span> discnt <span class="operator">&lt;</span> <span class="keyword">any</span>(<span class="keyword">select</span> discnt <span class="keyword">from</span> customers); </span><br></pre></td></tr></table></figure>

<hr>
<p>Example: Retrieve orders made by customers whose city come after â€˜Mâ€™ in the alphabetic. ( é€‰ â€Mâ€ ä»¥åå­—æ¯å¼€å¤´çš„city ) </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> orders o <span class="keyword">where</span> <span class="string">&#x27;M&#x27;</span><span class="operator">&lt;</span>(<span class="keyword">select</span> city <span class="keyword">from</span> customers c <span class="keyword">where</span> c.cid<span class="operator">=</span>o.cid);</span><br></pre></td></tr></table></figure>

<p>[7] Like predicate: æ¨¡ç³ŠæŸ¥è¯¢è°“è¯</p>
<p>columnname [NOT] LIKE â€˜patternâ€™ </p>
<p>â–ª é€šé…ç¬¦ </p>
<p>Underscore (_) Any single character ä»£æ›¿ä¸€ä¸ªå­—ç¬¦</p>
<p>Percent (%) Zero or more characters of any form ä»£æ›¿ä¸€ä¸ªæˆ–è€…å¤šä¸ªå­—ç¬¦</p>
<p>Escape character (\ ï¼‰ Precedes quoted literal character åœ¨å¼•ç”¨çš„æ–‡å­—å­—ç¬¦ä¹‹å‰ï¼ŒåŠ ä¸Šè¡¨ç¤ºåŸæ„</p>
<p>All other characters  Represent themselves</p>
<p>Example 1. Retrieve all data of customers whose begins with the letter â€˜Aâ€™. </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> customers <span class="keyword">where</span> cname <span class="keyword">like</span> â€˜A<span class="operator">%</span>â€™ ;</span><br></pre></td></tr></table></figure>

<p>Example 2. Retrieve cids of customers whose cname begins â€˜Tip_â€™ and arbitary(any) number of character . </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> cid <span class="keyword">from</span> customers <span class="keyword">where</span> cname <span class="keyword">like</span> â€˜Tip\_<span class="operator">%</span>â€™ <span class="keyword">escape</span> â€˜\â€™; 	</span><br></pre></td></tr></table></figure>

<p>Example 3.9.7 Retrieve cids of customers whose cname starts with the sequence â€˜ab\â€™ . </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> cid <span class="keyword">from</span> customers <span class="keyword">where</span> cname <span class="keyword">like</span> â€˜ab\\<span class="operator">%</span>â€™ <span class="keyword">escape</span> â€˜\â€™;</span><br></pre></td></tr></table></figure>

<h3 id="10ã€Insertã€Update-å’Œ-Delete-å¥"><a href="#10ã€Insertã€Update-å’Œ-Delete-å¥" class="headerlink" title="10ã€Insertã€Update å’Œ Delete å¥"></a>10ã€Insertã€Update å’Œ Delete å¥</h3><h4 id="INSERT"><a href="#INSERT" class="headerlink" title="INSERT"></a>INSERT</h4><p>[1] Form </p>
<p>â¢ æ ‡å‡†å¼ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tablename [(<span class="keyword">column</span> &#123;, <span class="keyword">column</span>â€¦&#125;)] &#123;<span class="keyword">VALUES</span> (expr <span class="operator">|</span> <span class="keyword">null</span> &#123; , expr <span class="operator">|</span> <span class="keyword">null</span>â€¦&#125;) <span class="operator">|</span> subquery&#125;</span><br></pre></td></tr></table></figure>

<p> â¢ æ’å…¥å­æŸ¥è¯¢ç»“æœé›† :</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tablename [ colname[, colnameâ€¦]ï¼‰ Subquery</span><br></pre></td></tr></table></figure>

<p>Example 1. Add a row specified values to the orders table. (no qty or dollars, so on this new row they are null)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> orders (ordno, <span class="keyword">month</span>, cid, aid, pid) <span class="keyword">values</span>(<span class="string">&#x27;1107&#x27;</span>, <span class="string">&#x27;aug&#x27;</span>, <span class="string">&#x27;c006&#x27;</span>, <span class="string">&#x27;a04&#x27;</span>, <span class="string">&#x27;p01&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>Example 2. Create a new table Swcusts of customers, and insert into all customers from Dallas and Austin.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> swcusts (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> customers <span class="keyword">where</span> city <span class="keyword">in</span> (<span class="string">&#x27;Dallas&#x27;</span>, <span class="string">&#x27;Austin&#x27;</span>) );</span><br></pre></td></tr></table></figure>

<h4 id="UPDATE"><a href="#UPDATE" class="headerlink" title="UPDATE"></a>UPDATE</h4><p>Form: </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> tablename <span class="keyword">SET</span> colname <span class="operator">=</span> &#123;expr <span class="operator">|</span> <span class="keyword">null</span> <span class="operator">|</span> (subquery)&#125; &#123;, &#123;<span class="keyword">column</span> <span class="operator">=</span> expr <span class="operator">|</span><span class="keyword">null</span> <span class="operator">|</span>(subquery)â€¦&#125;&#125; [<span class="keyword">WHERE</span> search_condition];</span><br></pre></td></tr></table></figure>

<p> Example 1. Give All agents in New York a 10% raise in the percent commission they earn on an order. </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> agents <span class="keyword">SET</span> <span class="keyword">percent</span> <span class="operator">=</span> <span class="number">1.1</span><span class="operator">*</span><span class="keyword">percent</span> <span class="keyword">WHERE</span> city <span class="operator">=</span> <span class="string">&#x27;New York&#x27;</span>; </span><br></pre></td></tr></table></figure>

<p>Example 2. Update the discnt values in rows of the Swcusts table created in Example 2. with more up-to-date discnt values from the customers table. </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> swcusts <span class="keyword">set</span> discnt<span class="operator">=</span>(<span class="keyword">select</span> discnt <span class="keyword">from</span> customers c <span class="keyword">where</span> c.cid <span class="operator">=</span> swcusts.cid );</span><br></pre></td></tr></table></figure>

<h4 id="DELETE"><a href="#DELETE" class="headerlink" title="DELETE"></a>DELETE</h4><p>[1] Form: </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> tablename [<span class="keyword">WHERE</span> search_condition];</span><br></pre></td></tr></table></figure>

<p>Example 2. Delete all agents in New York. </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> agents <span class="keyword">where</span> city <span class="operator">=</span> <span class="string">&#x27;New York&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>Example 3. Delete agents who have total orders of less than $600. </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> agents <span class="keyword">where</span> aid <span class="keyword">in</span> ( <span class="keyword">select</span> aid <span class="keyword">from</span> orders <span class="keyword">group</span> <span class="keyword">by</span> aid <span class="keyword">having</span> <span class="built_in">sum</span>(dollars) <span class="operator">&lt;</span> <span class="number">600</span> );</span><br></pre></td></tr></table></figure>

<p>[4] Notice: Table Drop åˆ é™¤è¡¨ç»“æ„</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> agents;</span><br></pre></td></tr></table></figure>





<h2 id="å››ã€æ•°æ®åº“ç¼–ç¨‹ï¼ˆProgram-to-Access-a-Databaseï¼‰"><a href="#å››ã€æ•°æ®åº“ç¼–ç¨‹ï¼ˆProgram-to-Access-a-Databaseï¼‰" class="headerlink" title="å››ã€æ•°æ®åº“ç¼–ç¨‹ï¼ˆProgram to Access a Databaseï¼‰"></a>å››ã€æ•°æ®åº“ç¼–ç¨‹ï¼ˆProgram to Access a Databaseï¼‰</h2><h3 id="1ã€åµŒå…¥å¼-SQL-Cè¯­è¨€-Embedded-SQL"><a href="#1ã€åµŒå…¥å¼-SQL-Cè¯­è¨€-Embedded-SQL" class="headerlink" title="1ã€åµŒå…¥å¼ SQL(Cè¯­è¨€)Embedded SQL"></a>1ã€åµŒå…¥å¼ SQL(Cè¯­è¨€)Embedded SQL</h3><h4 id="å¦‚ä½•é€šè¿‡ç¨‹åºè®¿é—®æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Ÿ"><a href="#å¦‚ä½•é€šè¿‡ç¨‹åºè®¿é—®æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Ÿ" class="headerlink" title="å¦‚ä½•é€šè¿‡ç¨‹åºè®¿é—®æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Ÿ"></a>å¦‚ä½•é€šè¿‡ç¨‹åºè®¿é—®æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Ÿ</h4><ol>
<li><p>SQL ï¼šä¸¤ç§ç”¨æ³•â€œ<code>ç»ˆç«¯äº¤äº’å¼</code>ã€<code>åµŒå…¥å¼</code>â€ (SQL è¯­æ³•è¿‘ä¼¼ï¼Œç»†èŠ‚æœ‰å·®å¼‚) </p>
</li>
<li><p>åµŒå…¥å¼ SQLï¼šå°† SQL è¯­è¨€åµŒå…¥åˆ°æŸç§é«˜çº§è¯­è¨€ä¸­ï¼Œå®ç°å¯¹DBçš„æ“ä½œã€‚ ä¸»è¯­è¨€(å®¿ä¸»è¯­è¨€)å±äºé¢å‘è¿‡ç¨‹çš„è¯­è¨€ï¼Œå®ç°ç¨‹åºçš„æµç¨‹æ§åˆ¶ã€‚</p>
</li>
</ol>
<p>â¢ åµŒå…¥å¼ SQL çš„ä¸€èˆ¬å½¢å¼ï¼š </p>
<ol>
<li>åŠ å‰ç¼€ï¼š EXEC SQL</li>
<li>ç»“æŸæ ‡å¿—ï¼Œéšä¸»è¯­è¨€è¯­å¥çš„ä¸åŒè€Œä¸åŒ</li>
<li>åµŒå…¥å¼ SQL å¥åˆ†ä¸¤ç±»: <ol>
<li>Declaration Statement &#x2F;è¯´æ˜æ€§è¯­å¥ </li>
<li>Executable Statement &#x2F;å¯æ‰§è¡Œè¯­å¥(DDL, DML, DCL)</li>
</ol>
</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">exec sql begin declare section;</span><br><span class="line">	<span class="type">char</span> c_id[<span class="number">5</span>] = <span class="string">&quot;c001&quot;</span>, c_name[<span class="number">14</span>];</span><br><span class="line">exec sql end declare section;</span><br><span class="line"></span><br><span class="line">exec sql </span><br><span class="line">    select cname, discnt into :c_name, :c_discnt from customers where cid = :c_id;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221129111233373.png" alt="image-20221129111233373"></p>
<ol start="3">
<li><p>A Simple Program</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">exec sql begin declare section;</span><br><span class="line">	<span class="type">char</span> c_id[<span class="number">5</span>] = <span class="string">&quot;c001&quot;</span>, c_name[<span class="number">14</span>];</span><br><span class="line">	<span class="type">float</span> c_discnt;</span><br><span class="line">exec sql end declare section;</span><br><span class="line"></span><br><span class="line">c_id = <span class="string">&quot;c005&quot;</span>; <span class="comment">//æˆ–æç¤ºç”¨æˆ·è¾“å…¥custid</span></span><br><span class="line"></span><br><span class="line">exec sql </span><br><span class="line">    select cname, discnt into :c_name, :c_discnt from customers where cid = :c_id;</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Customer name is %s, discount is %s\n&quot;</span>, c_name, c_discnt);</span><br></pre></td></tr></table></figure>

<p>[1] åµŒå…¥å¼SQLè¯­å¥çš„ä¿¡å· : exec sql </p>
<p>å¯¹åµŒå…¥å¼ SQLå¥ï¼ŒDBMS é‡‡ç”¨ä¸¤ç§æ–¹å¼ç¼–è¯‘ï¼š </p>
<p>â‘ é¢„ç¼–è¯‘ï¼ˆPre-compiler ç›®å‰ä½¿ç”¨è¾ƒå¤šï¼‰ â‘¡ä¿®æ”¹å’Œæ‰©å……ä¸»è¯­è¨€ï¼Œä½¿ä¹‹èƒ½å¤„ç† SQL</p>
<p>[2] ä¸»æœºå˜é‡Host Variable<br>â—¼ å¿…é¡»ç”±SQLå£°æ˜éƒ¨åˆ†å£°æ˜<br>â—¼ ç”¨äºåµŒå…¥å¼SQLè¯­å¥ï¼Œæ ¼å¼ä¸º<code>ï¼šc_id</code><br>â—¼ åœ¨å®¿ä¸»è¯­è¨€ä¸­ä½¿ç”¨ï¼Œæ ¼å¼ä¸º<code>c_id</code></p>
<p>[3] æ³¨æ„ï¼šä¸èƒ½ä½¿ç”¨å­—ç¬¦ä¸²æ¥åŒ…å«è¯­å¥çš„ä¸€éƒ¨åˆ†</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># éæ³•æ“ä½œ</span><br><span class="line"><span class="type">char</span> cond[ ] = <span class="string">&quot; cid = &#x27;c003&#x27; and city = &#x27;Boston&#x27; &quot;</span>;</span><br><span class="line">exec sql </span><br><span class="line">    select cname into :custname from customers where :cond;</span><br></pre></td></tr></table></figure>

<p>[4] SQL CONNECT and DISCONNECT to DBMS</p>
<p>Connectï¼š</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">exec sql CONNECT TO target_DBname [AS connect_name] [USER username];</span><br><span class="line">exec sql CONNECT TO DEFAULT;</span><br></pre></td></tr></table></figure>

<p>Disconnectï¼š</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">exec sql DISCONNECT connect_name;</span><br><span class="line">exec sql DISCONNECT current;</span><br></pre></td></tr></table></figure>



<p>[5] COMMITæäº¤ and ROLLBACKå›æ»š statement</p>
<p>â—¼ ä½¿ç”¨COMMITè¯­å¥æäº¤æ•°æ®åˆ°æ•°æ®åº“ï¼Œåœ¨Disconnectè¯­å¥ä¹‹å‰<br>â—¼ ä½¿ç”¨ROLLBACKè¯­å¥æ’¤æ¶ˆä¸æˆåŠŸçš„ä»»åŠ¡ï¼Œåœ¨Disconnectè¯­å¥ä¹‹å‰</p>
<p>[6] Example 1. the program prompts a user repeately input a cid and replies by printing its cname and discount, halting when user input an empty string</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;prompt.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">exec sql include sqlca; <span class="comment">// å¼•å…¥ sqlca</span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> cid_prompt[]=<span class="string">&quot;Please input customer id: &quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    exec sql begin declare section; <span class="comment">// å®šä¹‰ä¸»å˜é‡</span></span><br><span class="line">    <span class="type">char</span> cust_id[<span class="number">5</span>],cust_name[<span class="number">14</span>],user_name[<span class="number">20</span>],user_pwd[<span class="number">20</span>];</span><br><span class="line">    <span class="type">float</span> cust_discnt;</span><br><span class="line">    exec sql end declare section;</span><br><span class="line"></span><br><span class="line">    exec sql whenever sqlerror <span class="keyword">goto</span> report-error; <span class="comment">// å®šä¹‰é”™è¯¯çš„è·³è½¬</span></span><br><span class="line">    exec sql whenever <span class="keyword">not</span> found <span class="keyword">goto</span> no-found;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">strcpy</span>(user_name, <span class="string">&quot;Scott&quot;</span>);</span><br><span class="line">    <span class="built_in">strcpy</span>(user_pwd, <span class="string">&quot;Tiger&quot;</span>); </span><br><span class="line"></span><br><span class="line">    exec sql content :user_name identified by :user_pwd;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">prompt</span>(cid_prompt,<span class="number">1</span>,cust_id,<span class="number">4</span>)) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        exec sql select cname,discnt into :cust_name,:cust_discnt from customers where cid=:cust_id; <span class="comment">// æ‰§è¡Œ sql</span></span><br><span class="line">        exec sql commit work ; <span class="comment">//æäº¤sqlå¹¶é‡Šæ”¾è¡Œä¸Šçš„è¯»å–é”å®š</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">&quot;Customer name is %s, discount is %f\n&quot;</span>, cust_name, cust_discnt);</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">not</span>-found: <span class="built_in">printf</span>(<span class="string">&quot;Canâ€™t find customer %s&quot;</span>, cust_id);</span><br><span class="line">    &#125;</span><br><span class="line">    exec sql commit release; <span class="comment">//å…³é—­è¿æ¥</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    report-error: <span class="built_in">print_dberror</span>();</span><br><span class="line">    exec sql rollback release; <span class="comment">//å›æ»šæ•°æ®</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;<span class="comment">//è¿”å›é”™è¯¯</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>[7] Cå’Œæ•°æ®åº“çš„å­—ç¬¦ä¸²ç±»å‹å¯èƒ½ä¸åŒ</p>
<p> char(5) in C, always contain â€˜\0â€™ as end flag. </p>
<p>in DBï¼Œåˆ† ä¸¤ç§ç±»å‹ char(5) and varchar(5)</p>
<p> æ•…: åµŒå…¥äº† SQL çš„ C ç¨‹åºé‡Œï¼Œä¸¤ç§è¯­è¨€ä¹‹é—´å­—ç¬¦èµ‹å€¼ï¼Œå¯èƒ½æœ‰å˜æ•°</p>
</li>
</ol>
<h4 id="å¦‚ä½•æŒ‰ç¨‹åºä½¿ç”¨æ•°æ®ï¼Ÿ"><a href="#å¦‚ä½•æŒ‰ç¨‹åºä½¿ç”¨æ•°æ®ï¼Ÿ" class="headerlink" title="å¦‚ä½•æŒ‰ç¨‹åºä½¿ç”¨æ•°æ®ï¼Ÿ"></a>å¦‚ä½•æŒ‰ç¨‹åºä½¿ç”¨æ•°æ®ï¼Ÿ</h4><p>ä¸»è¯­è¨€å’ŒSQLçš„å…³ç³»</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221129120401136.png" alt="image-20221129120401136"></p>
<p>â—¼ å‘ä¸»è¯­è¨€ä¼ é€’ SQL çš„æ‰§è¡ŒçŠ¶æ€ï¼Œç”¨ SQL Communication Area (SQLCA) æˆ– Indicator Variable æŒ‡ç¤ºå˜é‡</p>
<p>â—¼ ä¸»è¯­è¨€å‘ SQL æä¾›å‚æ•°ç”¨Host Variableï¼›è€ŒSQLå°† å¯¹DB çš„å¤„ç†ç»“æœäº¤ç»™ ä¸»è¯­è¨€æ—¶ç”¨ Host Variable å’Œ Cursoræ¸¸æ ‡</p>
<p>[1] SQLCAï¼šâ€œç»“æ„ç±»å‹â€ï¼Œ ORACLE ä¸­å®šä¹‰å¦‚ä¸‹</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">sqlca</span> &#123; </span><br><span class="line">    <span class="type">char</span> sqlcacaid[<span class="number">8</span>];</span><br><span class="line">    <span class="type">long</span> sqlcabc;</span><br><span class="line">    <span class="type">long</span> sqlcode; <span class="comment">//sqlæ‰§è¡Œçš„çŠ¶æ€å€¼</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">sqlerrm</span> &#123;<span class="type">unsigned</span> <span class="type">short</span> sqlerrml; <span class="type">char</span> sqlerrmc[<span class="number">70</span>];&#125;; <span class="comment">//sqlçš„é”™è¯¯ä»£ç </span></span><br><span class="line">    <span class="type">char</span> sqlerrp[<span class="number">8</span>];</span><br><span class="line">    <span class="type">long</span> sqlerrd[<span class="number">6</span>];<span class="comment">//sqlè¿›ç¨‹çš„è¡Œæ•°</span></span><br><span class="line">    <span class="type">char</span> sqlwarn[<span class="number">8</span>];</span><br><span class="line">    <span class="type">char</span> sqlext[<span class="number">8</span>]; </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>â—¼ ä½¿ç”¨å‰ï¼Œå…ˆåœ¨ä¸»ç¨‹åºä¸­å£°æ˜SQLé€šä¿¡åŒºçš„æ ‡è¯†ç¬¦ï¼š </p>
<p>â€‹	 exec sql include sqlca; (sqlca å±DBMSå·²å®šä¹‰ã€é»˜è®¤çš„ç»“æ„å) </p>
<p>â—¼ è¦æ“ä½œå¤šä¸ªDBæ—¶ï¼Œå¯å£°æ˜æ–°çš„SQLé€šä¿¡åŒºæ ‡è¯†ç¬¦ï¼š</p>
<p>â€‹	 struct sqlca sqlcb; (ç”¨sqlca è¯´æ˜åŒç»“æ„çš„å…¶å®ƒâ€œé€šè®¯åŒºæ ‡è¯†â€) exec sql include sqlcb;</p>
<p>â—¼ SQLCAç»“æ„ä¸­çš„å¸¸ç”¨åŸŸï¼š </p>
<p>(1)Sqlca.sqlcode, å­˜æ”¾å½“å‰ SQL å¥æ‰§è¡Œåçš„çŠ¶å†µï¼Œæœ‰ä¸‰ç§å¯èƒ½å€¼ï¼š </p>
<p>â€‹		â¢ &#x3D;0: ä»£è¡¨Successï¼Œå³sql å¥æ‰§è¡ŒæˆåŠŸï¼Œè¯´æ˜bufferä¸­æœ‰æ•°æ®å¯ç”¨ </p>
<p>â€‹		â¢ &gt;0: ä»£è¡¨not found ï¼Œå³sql å¥æ‰§è¡ŒæˆåŠŸï¼Œä½†ç»“æœä¸º null </p>
<p>â€‹		â¢ &lt;0: ä»£è¡¨sqlwarningæˆ–errorï¼Œå³ç¨‹åºæˆ–ç³»ç»Ÿæ•…éšœï¼Œé”™è¯¯ç çš„å«ä¹‰è§å­åŸŸ sqlca.sqlerrm. (2)Sqlca.sqlerrd[2]ï¼Œå½“å‰ DML è¯­å¥æ‰§è¡Œåï¼Œå¤„ç†çš„æ•°æ®è¡Œæ•°ã€‚</p>
<p>[3] Host variable (ä¸»å˜é‡) </p>
<p>â‘  Definition in Host Languageï¼Œthere are Three Types of Host vars. </p>
<p>â€‹		â—¼ Input host variableï¼šç”±ä¸»è¯­è¨€å¯¹å…¶èµ‹å€¼ï¼Œåœ¨ SQL å¥ä¸­å¼•ç”¨ã€‚ </p>
<p>â€‹		â—¼ Output host variableï¼šç”± SQL è¯­å¥å¯¹å…¶èµ‹å€¼ï¼Œåœ¨ä¸»è¯­è¨€ä¸­å¼•ç”¨ã€‚ </p>
<p>â€‹		â—¼ Indicator variable (æŒ‡ç¤ºå˜é‡)ï¼šæ•´å‹å˜é‡ï¼Œè·Ÿåœ¨(I&#x2F;O) Host Varä¹‹åï¼Œç”¨ æ¥â€œæŒ‡ç¤ºâ€ä¸»å˜é‡å€¼çš„å¯ç”¨æ€§ã€‚</p>
<p>â‘¡ä¸»å˜é‡ã€æŒ‡ç¤ºå˜é‡çš„è¯´æ˜ï¼š exec sql begin declare section; char cust_id; c_dis; exec sql end declare section; </p>
<p>â‘¢ä¸»å˜é‡ã€æŒ‡ç¤ºå˜é‡ç”¨æ³•ï¼š </p>
<p>â—† åœ¨SQLå¥ä¸­ä½¿ç”¨æ—¶ï¼Œå‰é¢åŠ å†’å·(:)ä½œä¸ºæ ‡å¿—ï¼Œä¸”æŒ‡ç¤ºå˜é‡åº”ç´§è·Ÿåœ¨ä¸»å˜é‡ä¹‹å </p>
<p>â—† åœ¨ Host Languageå¥ä¸­ä½¿ç”¨ï¼Œä¸å¿…åŠ å†’å·ã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">exec sql begin declare section</span><br><span class="line"><span class="type">char</span> cust_id[], c_dis[];</span><br><span class="line"><span class="type">int</span> c_ind;</span><br><span class="line">exec sql end declare section</span><br><span class="line">    </span><br><span class="line">cust_id=â€˜c002â€™;</span><br><span class="line"></span><br><span class="line">exec sql </span><br><span class="line">    select discnt into :c_dis :c_ind from customers where cid=:cust_id;</span><br><span class="line"><span class="keyword">if</span> (c_ind==<span class="number">0</span>) <span class="built_in">printf</span>(â€œThe discount of %s is %d !\nâ€, cust_id, c_dis);</span><br></pre></td></tr></table></figure>

<p>â‘¤ Indicator var è·Ÿåœ¨æŸä¸ªHost-Varibleä¹‹åï¼ŒæŒ‡ç¤º SQLæ‰§è¡Œåï¼Œæ­¤HostVaribleå€¼çš„åˆæ³•æ€§ï¼Œå…¶è‡ªèº«å€¼ä¹Ÿæœ‰ä¸‰ç§å¯èƒ½ï¼š </p>
<p>â¢ &#x3D; 0ï¼Œ not null, the value is assigned to the host-varible. </p>
<p>â¢ &gt; 0ï¼Œ a truncated value is assigned to the host-varible. </p>
<p>â¢ &#x3D; -1ï¼Œis null, the host-varible value is not a meaningful. </p>
<p>[4] Cursor(æ¸¸æ ‡) </p>
<p>â‘ Cursorï¼šDBMSä¸ºç”¨æˆ·å¼€è®¾çš„Data bufferï¼Œå­˜æ”¾ SQL çš„æ‰§è¡Œç»“æœé›†ï¼Œ bufferä¸­æœ‰ä¸€é»˜è®¤æŒ‡é’ˆï¼Œä¾›ç”¨æˆ·é€ä¸€è®¿é—® Data Recordã€‚ </p>
<p>â‘¡Functionï¼š <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221129121317645.png" alt="image-20221129121317645"></p>
<p>â‘¢Using Methodï¼šfour steps </p>
<p>â€‹	a)å®šä¹‰æ¸¸æ ‡ (declare cursor) </p>
<p>â€‹	b)æ‰“å¼€æ¸¸æ ‡ (open cursor) å¾ªç¯ä½“ä¸­â†’ </p>
<p>â€‹	c)æ¨è¿›æ¸¸æ ‡ (fetch cursor)ï¼Œå¹¶å°†å½“å‰æŒ‡å‘çš„bufferæ•°æ® æ”¾å…¥ä¸»å˜é‡ä¸­ </p>
<p>â€‹	d)å…³é—­æ¸¸æ ‡ (close cursor)</p>
<h3 id="2ã€å¸¸è§çš„åµŒå…¥å¼SQLè¯­å¥"><a href="#2ã€å¸¸è§çš„åµŒå…¥å¼SQLè¯­å¥" class="headerlink" title="2ã€å¸¸è§çš„åµŒå…¥å¼SQLè¯­å¥"></a>2ã€å¸¸è§çš„åµŒå…¥å¼SQLè¯­å¥</h3><ol>
<li><p>Declare Cursor å®šä¹‰æ¸¸æ ‡</p>
<p>exec sql declare  cursor for  [Read only | For updata of colname]; </p>
<p>Notice: </p>
<p>â€‹	â—¼ FOR UPDATE: promising to Update&#x2F;Delete rows through cursor </p>
<p>â€‹	â—¼ READ ONLY: not promising to Update&#x2F;Delete rows through cursor </p>
</li>
<li><p>Cursor Open, Fetch and Close æ‰“å¼€ã€ä½¿ç”¨ã€å…³é—­æ¸¸æ ‡</p>
<p>â€‹	[1] Cursor open: exec sql OPEN ; </p>
<p>â€‹	[2] Cursor fetch: exec sql FETCH &lt; cursor_name &gt; INTO  {,â€¦}; </p>
<p>â€‹	[3] Cursor close: exec sql CLOSE &lt; cursor_name &gt;;</p>
<p>â€‹	[4] Example 1. a GROUP BY Select statement listing agent ID values and sum of dollar orders by these agents for any customer ID provided by the user. GROUP BY Selectè¯­å¥åˆ—å‡ºäº†ä»£ç†å•†çš„IDå€¼å’Œè¿™äº›ä»£ç†å•†é’ˆå¯¹ç”¨æˆ·æä¾›çš„ä»»ä½•å®¢æˆ·IDçš„ç¾å…ƒè®¢å•æ€»å’Œã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> TRUE 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> â€œprompt.h</span></span><br><span class="line">exec sql include sqlca;</span><br><span class="line"></span><br><span class="line">exec sql begin declare section;</span><br><span class="line"><span class="type">char</span> cust_id[<span class="number">5</span>], agent_id[<span class="number">4</span>];</span><br><span class="line"><span class="type">double</span> dollar_sum;</span><br><span class="line">exec sql end declare section;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">char</span> cid_prompt[]=â€Please input customer id: â€;</span><br><span class="line">    exec sql declare agent_dollars cursor <span class="keyword">for</span> select aid,<span class="built_in">sum</span>(dollars) from orders where cid = :cust_id group by aid;<span class="comment">//å®šä¹‰æ¸¸æ ‡</span></span><br><span class="line">    exec sql whenever sqlerror <span class="keyword">goto</span> report-error; </span><br><span class="line">    exec sql whenever <span class="keyword">not</span> found <span class="keyword">goto</span> finish;</span><br><span class="line">    exec sql connect to testdb;<span class="comment">//è¿æ¥æ•°æ®åº“</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">prompt</span>(cid_prompt,<span class="number">1</span>,cust_id,<span class="number">4</span>))&gt;<span class="number">0</span>)<span class="comment">//è¾“å…¥</span></span><br><span class="line">    &#123; </span><br><span class="line">        exex sql open agent_dollars;<span class="comment">//å¼€å¯æ¸¸æ ‡</span></span><br><span class="line">        <span class="keyword">while</span> (TRUE) &#123; </span><br><span class="line">            exec sql fetch agent_dollars into :agent_id, :dollar_sum;<span class="comment">//ä½¿ç”¨æ¸¸æ ‡</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%s %11.2f\n&quot;</span>, agent_id, dollar_dum); &#125;</span><br><span class="line">            finish: exec sql close agent_dollars ;<span class="comment">//å…³é—­æ¸¸æ ‡</span></span><br><span class="line">            exec sql commit work; </span><br><span class="line">        &#125; </span><br><span class="line">    exec sql disconnect current ; </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    report-error : <span class="built_in">print_dberror</span>();</span><br><span class="line">    exec sql rollback work ;</span><br><span class="line">    exec sql disconnect current ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>[5] Cä¸åµŒå…¥å¼SQLä¹‹é—´çš„æ–¹æ³•æ¦‚è¿°</p>
<p>æ¸¸æ ‡ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221129122045375.png" alt="image-20221129122045375"></p>
<p>ä¸»å˜é‡ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221129122056720.png" alt="image-20221129122056720"></p>
<p>ä½¿ç”¨å®Œæ•°æ®åº“åï¼š</p>
<p>â—¼ RDBMSç”¨æˆ·å¹¶å‘æ•°æœ‰é™ </p>
<p>â—¼ åº”é¿å…é•¿æœŸå ç”¨</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221129122129710.png" alt="image-20221129122129710"></p>
</li>
</ol>
<h4 id="åµŒå…¥å¼æŸ¥è¯¢"><a href="#åµŒå…¥å¼æŸ¥è¯¢" class="headerlink" title="åµŒå…¥å¼æŸ¥è¯¢"></a>åµŒå…¥å¼æŸ¥è¯¢</h4><ol>
<li><p>è¯­æ³•</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">EXEC SQL SELECT [ALL|DISTINCT] expression&#123;, exprâ€¦&#125;</span><br><span class="line">INTO host_variable &#123; , host_variableâ€¦ &#125;</span><br><span class="line">FROM tableref [corr_name] &#123;, tableref[corr_name] â€¦&#125;</span><br><span class="line">[WHERE search_condition ]</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ³¨æ„ç‚¹ï¼š</p>
<p>â—¼ åµŒå…¥å¼selectåªèƒ½æ£€ç´¢ä¸€è¡Œï¼Œå› æ­¤GROUP BYã€HAVINGã€UNIONå’ŒORDER BYå­å¥ä¸åŒ…å«åœ¨å…¶ä¸­<br>â—¼ å¦‚æœå¯ä»¥åœ¨ä¸ä½¿ç”¨å…‰æ ‡çš„æƒ…å†µä¸‹åœ¨ç¨‹åºä¸­æ‰§è¡ŒSelectè¯­å¥ï¼Œä»…å½“è¦æ£€ç´¢çš„è¡Œæ•°ä¸è¶…è¿‡ä¸€è¡Œæ—¶ï¼ˆé›¶è¡Œ&#x2F;ä¸€è¡Œï¼‰ã€‚</p>
</li>
<li><p>ä¾‹é¢˜</p>
<p>å·²çŸ¥å­¦ç”Ÿä¿¡æ¯è¡¨ studentsï¼Œå…¶ç»“æ„å¦‚ä¸‹: Students(sno, sname, ssex, sage, sdepartment). ç¼–ç¨‹æŸ¥è¯¢æŸç³»å…¨ä½“å­¦ç”Ÿçš„ä¿¡æ¯ï¼Œç³»åç”±ç”¨æˆ·åœ¨ç¨‹åºè¿è¡Œæ—¶è¾“å…¥ã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> TRUE 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> â€œprompt.hâ€</span></span><br><span class="line"></span><br><span class="line">exec sql include sqlca;<span class="comment">//æ¸¸æ ‡</span></span><br><span class="line">exec sql begin declare section;<span class="comment">//ä¸»å˜é‡å£°æ˜</span></span><br><span class="line"><span class="type">char</span> hdept[<span class="number">10</span>], hsno[<span class="number">4</span>], hname[<span class="number">10</span>], hsex[<span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> hage;</span><br><span class="line">exec sql end declare section;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">char</span> msg[]=â€ Please input the department name: â€;</span><br><span class="line">    exec sql declare c_student cursor <span class="keyword">for</span> select sno, sname, ssex, sage, sdepartment from students where sdepartment = :hdept read only; <span class="comment">//å®šä¹‰æ¸¸æ ‡</span></span><br><span class="line">    exec sql whenever sqlerror <span class="keyword">goto</span> report-error; </span><br><span class="line">    exec sql whenever <span class="keyword">not</span> found <span class="keyword">goto</span> finish; </span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">prompt</span>(msg,<span class="number">1</span>, hdept,<span class="number">10</span>))&gt;<span class="number">0</span>) &#123; <span class="comment">//è¾“å…¥</span></span><br><span class="line">        exec sql connect to testdb;<span class="comment">//å»ºç«‹è¿æ¥</span></span><br><span class="line">        exec open c_student;<span class="comment">//æ‰“å¼€æ¸¸æ ‡</span></span><br><span class="line">        <span class="keyword">while</span> (TRUE) &#123; </span><br><span class="line">            exec sql fetch c_student into :hsno, :hname, :hsex, :hage;<span class="comment">//ä½¿ç”¨æ¸¸æ ‡</span></span><br><span class="line">            <span class="keyword">if</span> (sqlca.sqlcode==success)</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%s %s %s %d\n&quot;</span>, hsno, hname, hsex, hage);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">break</span>; </span><br><span class="line">        &#125; </span><br><span class="line">        finish: exec sql close c_student ;<span class="comment">//å…³é—­æ¸¸æ ‡</span></span><br><span class="line">        exec sql commit work; <span class="comment">//æäº¤äº‹åŠ¡</span></span><br><span class="line">    &#125; </span><br><span class="line">    exec sql disconnect current ; <span class="comment">//å…³é—­è¿æ¥</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">    report-error : <span class="built_in">print_dberror</span>(); </span><br><span class="line">    exec sql rollback work ;<span class="comment">//å›æ»š</span></span><br><span class="line">    exec sql disconnect current ;<span class="comment">//å…³é—­è¿æ¥</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="åµŒå…¥å¼åˆ é™¤"><a href="#åµŒå…¥å¼åˆ é™¤" class="headerlink" title="åµŒå…¥å¼åˆ é™¤"></a>åµŒå…¥å¼åˆ é™¤</h4><p>Embedded Delete </p>
<ol>
<li><p>Two forms of Delete statement </p>
<p>â— Searched Delete æœç´¢åˆ é™¤</p>
<p>â— Positioned Delete å®šä½åˆ é™¤</p>
</li>
<li><p>Embedded Delete è¯­æ³•</p>
<p>statement exec sql DELETE FROM tablename [corr_name] [WHERE search_condition | WHERE CURRENT OF cursor_name</p>
</li>
<li><p>æ³¨æ„ç‚¹</p>
<p>åœ¨Searched Deleteä¸­ï¼Œsqlcaã€‚sqlcodeå’Œsqcaã€‚sqlerrd[2]çš„å«ä¹‰<br>â¢ ç¡®å®šè¦å¤„ç†çš„è¡Œæ•°ã€‚<br>â¢ æœªæ‰¾åˆ°ï¼Œå½“ä¸è¿”å›è¡Œæ—¶ã€‚<br>â¢ å‘ç”Ÿæ‰§è¡Œé”™è¯¯æ—¶å‡ºé”™</p>
</li>
<li><p>Example 1. Delete all customers from the customers table who live in Duluth and have made no orders</p>
<p>a) In aSearched Delete</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec sql <span class="keyword">delete</span> from customers c where c.city = â€˜Duluthâ€™ <span class="keyword">and</span> <span class="keyword">not</span> <span class="built_in">exists</span> (select * from orders o where o.cid =c.cid) ;</span><br></pre></td></tr></table></figure>

<p>b) In a Positioned Delete: Declare a cursor to delete current row</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">exec sql declare delcust cursor <span class="keyword">for</span> select cid from customers c where c.city = â€˜Duluthâ€™ <span class="keyword">and</span> <span class="keyword">not</span> <span class="built_in">exists</span> (select * from orders o where o.cid = c.cid) <span class="keyword">for</span> update of cid;</span><br><span class="line">exec sql whenever <span class="keyword">not</span> found <span class="keyword">goto</span> skip;</span><br><span class="line">exec sql open delcust;</span><br><span class="line"><span class="keyword">while</span> (TRUE) &#123;</span><br><span class="line">    exec sql fetch delcust into :cust_id;</span><br><span class="line">    exec sql <span class="keyword">delete</span> from customers where current of delcust;&#125;</span><br><span class="line">skip : â€¦â€¦</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="åµŒå…¥å¼æ›´æ–°"><a href="#åµŒå…¥å¼æ›´æ–°" class="headerlink" title="åµŒå…¥å¼æ›´æ–°"></a>åµŒå…¥å¼æ›´æ–°</h4><p>[1] Two forms of Update statement </p>
<p>â— Searched Update æŸ¥è¯¢æ›´æ–°</p>
<p>â— Positioned Update â€” using a cursor ä½ç½®æ›´æ–°</p>
<p>[2] Forms of Embedded Searched Update statement </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec sql UPDATE tablename [corr_name] SET colname1 = expr &#123; , colname2 = exprâ€¦ &#125;[WHERE search_condition]; Notes: In Searched Update, sqlca.sqlcode <span class="keyword">and</span> sqlca.sqlerrd</span><br></pre></td></tr></table></figure>

<p>[2] contains information of : </p>
<p>â¢ ç¡®å®šè¦æ›´æ–°çš„è¡Œæ•°ã€‚</p>
<p>â¢ æœªæ‰¾åˆ°ï¼Œå½“ä¸è¿”å›è¡Œæ—¶ã€‚</p>
<p>â¢ å‘ç”Ÿæ‰§è¡Œé”™è¯¯æ—¶å‡ºé”™ã€‚</p>
<p>[3] åµŒå…¥å¼å®šä½æ›´æ–°è¯­å¥çš„æ ¼å¼</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec sql UPDATE tablename SET columnname=expr &#123; , column=exprâ€¦ &#125; WHERE CURRENT OF cursor_name ;</span><br></pre></td></tr></table></figure>

<p>[4] Example 1ï¼šå·²çŸ¥ studentsè¡¨ï¼Œç¼–ç¨‹æŸ¥è¯¢æŸç³»å…¨ä½“å­¦ç”Ÿçš„ä¿¡æ¯ï¼Œç³»åç”±ç”¨æˆ·åœ¨ ç¨‹åºè¿è¡Œæ—¶è¾“å…¥ï¼Œæ ¹æ®ç”¨æˆ·è¦æ±‚ä¿®æ”¹å…¶ä¸­æŸäº›å­¦ç”Ÿçš„å¹´é¾„ã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> TRUE 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> â€œprompt.hâ€</span></span><br><span class="line">exec sql include sqlca;</span><br><span class="line">exec sql begin declare section;</span><br><span class="line">	<span class="type">char</span> hdept[<span class="number">10</span>], hsno[<span class="number">4</span>], hname[<span class="number">10</span>], hsex[<span class="number">2</span>];</span><br><span class="line">	<span class="type">int</span> hage;</span><br><span class="line">exec sql end declare section;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">char</span> msg[]=â€Please input the department name: â€;</span><br><span class="line">    exec sql declare p_student cursor <span class="keyword">for</span> select sno, sname, ssex, sage, sdepartment from students where sdepartment = :hdept <span class="keyword">for</span> update of sage;</span><br><span class="line">    exec sql whenever sqlerror <span class="keyword">goto</span> report_error; </span><br><span class="line">    exec sql whenever <span class="keyword">not</span> found <span class="keyword">goto</span> finish; </span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">prompt</span>(msg,<span class="number">1</span>, hdept,<span class="number">10</span>)) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    	exec sql connect to testdb;</span><br><span class="line">    	exec sql open p_student;</span><br><span class="line">    	<span class="keyword">while</span> (TRUE) &#123;</span><br><span class="line">            exec sql fetch p_studen into :hsno, :hname, :hsex, :hage ;</span><br><span class="line">            <span class="keyword">if</span> (sqlca.sqlcode == success) &#123; </span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%s %s %s %d\n&quot;</span>, hsno, hname, hsex, hage);</span><br><span class="line">                <span class="built_in">printf</span>(â€œ Update the age of <span class="keyword">this</span> record ? â€);</span><br><span class="line">                <span class="built_in">scanf</span>(â€œ%câ€, ans);</span><br><span class="line">                <span class="keyword">if</span> (ans == â€™yâ€™) &#123; </span><br><span class="line">                    <span class="built_in">printf</span>(â€œ Input the <span class="keyword">new</span> age : â€); </span><br><span class="line">                    <span class="built_in">scanf</span>(â€œ%dâ€, hage);</span><br><span class="line">                    exec sql update student set sage = :hage where current of p_student;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">break</span>; </span><br><span class="line">        &#125; </span><br><span class="line">â€¦â€¦</span><br><span class="line">	finish: exec sql close p_student ;</span><br><span class="line">	exec sql commit work; </span><br><span class="line">    &#125; </span><br><span class="line">    exec sql disconnect current ; </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    report_error : <span class="built_in">print_dberror</span>();</span><br><span class="line">    exec sql rollback work ;</span><br><span class="line">    exec sql disconnect current ;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h4 id="åµŒå…¥å¼æ’å…¥"><a href="#åµŒå…¥å¼æ’å…¥" class="headerlink" title="åµŒå…¥å¼æ’å…¥"></a>åµŒå…¥å¼æ’å…¥</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec sql INSERT INTO tablename [ (columnname &#123; , columnnameâ€¦&#125; ) ] &#123;<span class="built_in">VALUES</span> (expr &#123; , expr &#125; ) | Subquery &#125; ;</span><br></pre></td></tr></table></figure>

<p>In Insert Statement, sqlca.sqlcode and sqlca.sqlerrd[2] contains information: </p>
<p>â¢ Success, to determine number of rows be processed. </p>
<p>â¢ Not found, If no rows insert. </p>
<p>â¢ Error, when an executed error is occurred.</p>
<h4 id="å…¶ä»–åµŒå…¥å¼sql"><a href="#å…¶ä»–åµŒå…¥å¼sql" class="headerlink" title="å…¶ä»–åµŒå…¥å¼sql"></a>å…¶ä»–åµŒå…¥å¼sql</h4><p>[1] They are: </p>
<ul>
<li>exec sql create table, </li>
<li>exec sql drop table, </li>
<li>exec sql alter table, </li>
<li>exec sql create view etc.</li>
</ul>
<p>[2] All of other Embedded SQL Statement, see in Appendix C.</p>
<h3 id="3ã€æ¡ä»¶å¤„ç†"><a href="#3ã€æ¡ä»¶å¤„ç†" class="headerlink" title="3ã€æ¡ä»¶å¤„ç†"></a>3ã€æ¡ä»¶å¤„ç†</h3><h4 id="Whenever"><a href="#Whenever" class="headerlink" title="Whenever"></a>Whenever</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec sql WHENEVER condition action ;</span><br></pre></td></tr></table></figure>

<p>[1] åŠŸèƒ½ï¼šæ— è®ºä½•æ—¶å…è®¸æˆ‘ä»¬åœ¨é‡åˆ°é”™è¯¯å’Œæƒ…å†µæ—¶æ§åˆ¶æ‰§è¡Œ</p>
<p>exec sql whenever sqlerror goto report_error ;</p>
<p>æ³¨æ„ï¼šâ€œsqlerrorâ€æ˜¯æ¡ä»¶ï¼Œâ€œgoto report_errorâ€æ˜¯æ“ä½œã€‚</p>
<p>[2]Condition:</p>
<p>â¢ SQLERROR</p>
<p>â¢ NOT FOUND</p>
<p>â¢ SQLWARNING</p>
<p>[3] Action </p>
<p>â— CONTINUE </p>
<p>â— GOTO label </p>
<p>â— STOP </p>
<p>â— DO function</p>
<p>[4]Example 1. Find the errors in following statement fragment</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Main</span>()&#123; </span><br><span class="line">	exec sql whenever sqlerror stop; <span class="comment">/* First whenever statement*/</span></span><br><span class="line">    â€¦â€¦</span><br><span class="line">    <span class="keyword">goto</span> s1;</span><br><span class="line">    â€¦â€¦</span><br><span class="line">    exec sql whenever sqlerror <span class="keyword">continue</span>; <span class="comment">/*Overrides Fisrt whenever*/</span></span><br><span class="line">    s1: exec sql update agents set percent = percent + <span class="number">1</span>;</span><br><span class="line">â€¦â€¦ &#125;</span><br></pre></td></tr></table></figure>

<p>[5] Example 2. Find errors in following sequence statement.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Main</span>()&#123; </span><br><span class="line">    exec sql whenever sqlerror <span class="keyword">goto</span> handle_error; <span class="comment">/* First whenever */</span></span><br><span class="line">    <span class="function">exec sql create table <span class="title">customers</span> <span class="params">(cid <span class="type">char</span>(<span class="number">4</span>) <span class="keyword">not</span> null, cname â€¦)</span> </span>;</span><br><span class="line">    â€¦â€¦</span><br><span class="line">    handle_error : exec sql whenever sqlerror <span class="keyword">continue</span>; <span class="comment">/*å½“Create tableå¤±è´¥è½¬å…¥*/</span></span><br><span class="line">    exec sql drop table customers; <span class="comment">/*Dropè¡¨å‡ºé”™ï¼Œè½¬å›First whenever, æ­»å¾ªç¯*/</span></span><br><span class="line">    exec sql disconnect;</span><br><span class="line">    <span class="built_in">printf</span> (â€œCould <span class="keyword">not</span> create customers table\nâ€);</span><br><span class="line">    <span class="keyword">return</span> â€“<span class="number">1</span>;</span><br><span class="line">    â€¦â€¦</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>[6]Example 1. Explicating the error processing in ORACLE.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">exec sql begin declare section;</span><br><span class="line"><span class="type">char</span> sqlstate[<span class="number">5</span>]; <span class="comment">/*Store the SQL state*/</span></span><br><span class="line">exec sql end declare section;</span><br><span class="line"></span><br><span class="line"><span class="function">exec sql create table <span class="title">custs</span> <span class="params">(cid <span class="type">char</span>(<span class="number">4</span>) <span class="keyword">not</span> null, cname varchar(<span class="number">13</span>), â€¦)</span> </span>;</span><br><span class="line">sqlstate = <span class="built_in">str</span>(sqlca.sqlcode); <span class="comment">/* æ£€æŸ¥ SQL çš„æ‰§è¡ŒçŠ¶æ€,ä½œç›¸åº”å¤„ç† */</span></span><br><span class="line"><span class="keyword">if</span> ( <span class="built_in">strcmp</span>(sqlstate,â€™<span class="number">82100</span>â€™) == <span class="number">0</span> ) <span class="comment">/* ORACLE, out of disk space? */</span></span><br><span class="line">&lt;call procedure to handle <span class="keyword">this</span> condition&gt;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">strcmp</span>(sqlstate,â€™<span class="number">00000</span>â€™ ) != <span class="number">0</span> ) &#123; <span class="comment">/* ORACLE, Another error? */</span></span><br><span class="line"><span class="keyword">goto</span> handle_error;</span><br><span class="line">exec sql whenever sqlerror <span class="keyword">goto</span> handle_error;</span><br><span class="line">â€¦â€¦ &#125;</span><br><span class="line">handle_error ï¼šâ€¦â€¦</span><br></pre></td></tr></table></figure>

<h4 id="é€šè¿‡ä¸»å˜é‡æ£€æŸ¥é”™è¯¯"><a href="#é€šè¿‡ä¸»å˜é‡æ£€æŸ¥é”™è¯¯" class="headerlink" title="é€šè¿‡ä¸»å˜é‡æ£€æŸ¥é”™è¯¯"></a>é€šè¿‡ä¸»å˜é‡æ£€æŸ¥é”™è¯¯</h4><p>[1] Example : Find discount of cid. Assume cid has been input. </p>
<p>â€‹				Host Vars â€”â€” cust_id; cust_discnt;</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">S1) exec sql select discnt into :cust_discnt from customers where cid = :cust_id;</span><br><span class="line"></span><br><span class="line">S2) exec sql begin declare section;</span><br><span class="line"><span class="type">float</span> cust_discnt; <span class="type">int</span> cd_ind;</span><br><span class="line">exec sql end declare section;</span><br><span class="line">exec sql select discnt into :cust_discnt :cd_ind</span><br><span class="line">from customers where cid = :cust_id;</span><br><span class="line"><span class="keyword">if</span> (cd_ind==<span class="number">0</span>) <span class="built_in">printf</span>(â€œThe discount of %s is %d ! \nâ€, cust_id, cust_discnt);</span><br><span class="line">â€¦â€¦</span><br></pre></td></tr></table></figure>

<p>[2] Example : Update the null discount to the specify cidâ€™s</p>
<p>Host Vars â€”â€” cust_id, cust_discnt, cd_ind</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">scanf</span>(â€œ%sâ€, cust_id);</span><br><span class="line"><span class="built_in">scanf</span>(â€œ%dâ€, cust_discnt);</span><br><span class="line">cd_ind = <span class="number">-1</span>;</span><br><span class="line">exec sql update customers</span><br><span class="line">set discnt = :cust_discnt :cd_ind where cid = :cust_id;</span><br></pre></td></tr></table></figure>



<h3 id="4ã€äº‹åŠ¡ç¼–ç¨‹Transactions"><a href="#4ã€äº‹åŠ¡ç¼–ç¨‹Transactions" class="headerlink" title="4ã€äº‹åŠ¡ç¼–ç¨‹Transactions"></a>4ã€äº‹åŠ¡ç¼–ç¨‹Transactions</h3><h4 id="äº‹åŠ¡Transaction"><a href="#äº‹åŠ¡Transaction" class="headerlink" title="äº‹åŠ¡Transaction"></a>äº‹åŠ¡Transaction</h4><p>[1] å¹¶å‘æ€§Concurrency<br>â—¼ éœ€è¦ä¸€èµ·æ‰§è¡Œä¸€ç»„SQLç¨‹åºåœ¨åŒä¸€æ—¶é—´æ‰èƒ½è®¿é—®ä¸Šçš„æ•°æ®åº“ã€‚å®ƒè¢«ç§°ä¸ºå¹¶å‘è®¿é—®æˆ–å¹¶å‘ã€‚<br>â—¼ å¿…é¡»ä½¿ç”¨<code>transaction</code>å’Œ<code>lock</code>æ¥æ§åˆ¶å¹¶å‘è®¿é—®ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221130143328906.png" alt="image-20221130143328906"></p>
<p>[2] æ•°æ®åº“äº‹åŠ¡<br>â—¼ Database Transactionâ€”â€”ç”¨æˆ·å®šä¹‰çš„ä¸€ç»„ DB æ“ä½œåºåˆ—ã€‚</p>
<ol>
<li>è¿™äº›æ“ä½œè¦ä¹ˆå…¨éƒ¨æ“ä½œæˆåŠŸï¼Œå¹¶æ°¸ä¹…æ€§æ›´æ–°dataåˆ°DBä¸­ </li>
<li>è¦ä¹ˆæ“ä½œå¤±è´¥ï¼Œæ”¾å¼ƒæœ¬æ¬¡æ‰€æœ‰æ“ä½œå¯¹DBçš„æ›´æ–°ï¼Œ DBæ¢å¤åˆ°æœªæ“ä½œå‰çŠ¶æ€</li>
</ol>
<p>â—¼ Database Transaction ä¸€ä¸ªä¸å¯åˆ†å‰²çš„æ•°æ®åº“è¿è¡Œå•ä½ (SQLæ˜¯ç¨‹åºçš„ä¹¦å†™å•ä½)</p>
<h4 id="å¦‚ä½•æŒ‡å®šäº‹åŠ¡"><a href="#å¦‚ä½•æŒ‡å®šäº‹åŠ¡" class="headerlink" title="å¦‚ä½•æŒ‡å®šäº‹åŠ¡"></a>å¦‚ä½•æŒ‡å®šäº‹åŠ¡</h4><p>[1] äº‹åŠ¡å±æ€§propertyï¼šç§°ä¸ºâ€œACIDâ€å±æ€§<br>â¢ Atomicityï¼šäº‹åŠ¡æ˜¯ æ•°æ®åº“çš„é€»è¾‘è¿è¡Œå•ä½ (åŸå­æ€§)<br>â¢ Consistencyï¼šäº‹åŠ¡æ‰§è¡Œæ•ˆæœä½¿æ•°æ®åº“ä»ä¸€è‡´æ€§ç¨³æ€A.å˜åˆ°ä¸€è‡´æ€§ç¨³æ€Bçº§(ä¸€è‡´æ€§)<br>â¢ Isolationï¼šäº‹åŠ¡å†…éƒ¨çš„æ“ä½œåŠæ‰€ç”¨æ•°æ®ï¼Œå¯¹å…¶ä»–å¹¶å‘äº‹ç‰©æ˜¯éš”ç¦»çš„, ä¸èƒ½äº’ç›¸å¹²æ‰°ã€‚ (éš”ç¦»æ€§)<br>â¢ Durabilityï¼šäº‹åŠ¡ä¸€æ—¦æäº¤ï¼Œå®ƒå¯¹æ•°æ®åº“ä¸­æ•°æ®çš„æ›´æ–°æ˜¯æ°¸ä¹…æ€§çš„ï¼Œåç»­æ“ä½œæˆ–æ•…éšœå¯¹å…¶æ‰§è¡Œç»“æœæ²¡æœ‰ä»»ä½•å½±å“ã€‚ (æŒä¹…æ€§)</p>
<p>[2] ACID ç‰¹æ€§é­ç ´åçš„å¯èƒ½å› ç´ ï¼š </p>
<p>âœ“ å¤šä¸ªTransactionå¹¶è¡Œæ—¶ï¼Œä¸åŒäº‹ç‰©äº¤å‰è®¿é—®ç›¸åŒDB Dataï¼Œéœ€æ§åˆ¶å¹¶å‘. </p>
<p>âœ“ Transaction å¦‚åœ¨è¿è¡Œæ—¶è¢«å¼ºè¡Œä¸­æ­¢ï¼Œåº”æœ‰DBæ¢å¤æœºåˆ¶.</p>
<p>[3] Declaration Database Transaction(æ˜¾å¼&#x2F;éšå¼å®šä¹‰äº‹åŠ¡ï¼‰<br>â¢ exec sql begin transactionï¼›â€“æ˜¾å¼è¯´æ˜æ•°æ®åº“äº‹åŠ¡å¼€å§‹<br>â¢ exec sql commit [work];â€“Transactionæ­£å¸¸ç»“æŸæ ‡å¿—ï¼Œæäº¤Database Transaction ä¸­å¯¹ Data çš„æ›´æ–°ï¼Œå†™å…¥DBã€‚<br>â¢ exec sql rollback [work];â€“Database Transactionå¼‚å¸¸ç»“æŸæ ‡å¿—ï¼Œå°†Undoæ‰€æœ‰å¯¹ Data å·²å®Œæˆçš„æ›´æ–°æ“ä½œï¼ŒDBå›æ»šåˆ°Transactionå¼€å§‹çš„çŠ¶æ€ã€‚å³äº‹åŠ¡è¿è¡Œè¿‡ç¨‹ä¸­ å‘ç”Ÿäº†æŸç§å¼‚å¸¸ï¼Œæ²¡æœ‰æ­£å¸¸ç»“æŸï¼Œä¸æ›´æ–°DBã€‚<br>â¢ Database Transaction å¯æ˜¾å¼å®šä¹‰ï¼Œå¦åˆ™ DBMS æŒ‰ç³»ç»Ÿçš„ç¼ºçœè§„å®šè‡ªåŠ¨åˆ’åˆ†äº‹åŠ¡ã€‚ å¦‚ï¼šä¸¤ä¸ªç›¸é‚» commitã€rollback å¥ä¹‹é—´è§†ä¸ºä¸€ä¸ª Database Transaction</p>
<p>[4] Transactionä¸programé—´çš„å…³ç³»ï¼š </p>
<p>(1) Programå«å¤šä¸ªTransactionï¼Œæ¯ä¸ªTransactionåŒ…å«å¤šæ¡SQL statementsã€‚ </p>
<p>(2) statementsæ˜¯ç¨‹åºçš„æ„æˆå•ä½ï¼ŒTransactionæ˜¯DB programçš„è¿è¡Œå•ä½</p>
<p>[5] Example 5.4.1: Inconsistent View of Data.</p>
<p>å¤„ç†è¿›ç¨‹ï¼šProcess P1 wants to move $400.00 from account A1 to A2, to even out the balance. Process P2 is running to perform a credit check on this depositor, requiring a total at least $900.00 before the depositor will be allowed to take out a credit card.<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221130144231132.png" alt="image-20221130144231132"></p>
<p>æ²¡æœ‰åŠ é”çš„æƒ…å†µä¸‹å‡ºç°é—®é¢˜<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221130144317284.png" alt="image-20221130144317284"></p>
<p>æ”¹æˆä¸²è¡ŒåŒ– Serializabilityè®©ä¸¤ä¸ªçº¿ç¨‹é¡ºåºæ‰§è¡Œã€‚</p>
<p>[6] Example 5.4.1 Transfer money between two account</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># <span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta"># <span class="keyword">include</span> â€œprompt.hâ€</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span> <span class="params">( )</span> </span>&#123; </span><br><span class="line">    exec sql begin declare section;<span class="comment">//å˜é‡å£°æ˜</span></span><br><span class="line">    	<span class="type">char</span> acc_from[<span class="number">8</span>], acc_to[<span class="number">8</span>]; </span><br><span class="line">    	<span class="type">double</span> tdollar;</span><br><span class="line">    exec sql end declare section;</span><br><span class="line">    </span><br><span class="line">    <span class="type">char</span> dollarstr[<span class="number">8</span>]; ms[<span class="number">30</span>]=â€œEnter from &amp; to accounts, dollars <span class="keyword">for</span> transferâ€;</span><br><span class="line">    </span><br><span class="line">    exec sql connect to <span class="keyword">default</span>;<span class="comment">//è¿æ¥æ•°æ®åº“</span></span><br><span class="line">    exec sql set transaction isolation level serializable;<span class="comment">//è®¾ç½®äº‹åŠ¡çº§åˆ«ä¸²è¡ŒåŒ–</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123; </span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">prompt</span>(ms, <span class="number">1</span>, acc_from, <span class="number">8</span>, acc_to, <span class="number">8</span>, dollarstr, <span class="number">6</span>)) &gt; <span class="number">0</span>)|| ( <span class="built_in">scanf</span>(dollastr, â€œ%<span class="number">1f</span>â€, &amp;tdollar) = <span class="number">1</span>) ) &#123;</span><br><span class="line">    		<span class="built_in">printf</span>(â€œInvalid input, Input example: <span class="number">345633</span>, <span class="number">445623</span>, <span class="number">100.45</span>\nâ€); </span><br><span class="line">        &#125;</span><br><span class="line">        exec sql whenever sqlerror <span class="keyword">goto</span> do_rollback;<span class="comment">//é”™è¯¯å›æ»š</span></span><br><span class="line">        <span class="comment">/* --------Transaction start here --------- */</span></span><br><span class="line">        exec sql update accounts set balance=balance - :tdollar where acct=:acc_from;</span><br><span class="line">        exec sql update accounts set balance=balance + :tdollar where acct=:acc_to;</span><br><span class="line">        exec sql commit work;<span class="comment">//æäº¤äº‹åŠ¡</span></span><br><span class="line">        <span class="comment">/* --------Transaction end here --------- */</span></span><br><span class="line">        <span class="built_in">printf</span>(â€œTransfer complete ! \nâ€);</span><br><span class="line">        loop;</span><br><span class="line">        do_rollback : exec sql rollback work ;</span><br><span class="line">        <span class="built_in">printf</span>(â€œTransfer failed ! \nâ€);</span><br><span class="line">	&#125; <span class="comment">/* end of while (1) */</span></span><br><span class="line">	exec sql disconnect current ; <span class="comment">//å…³é—­è¿æ¥</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Transaction-Isolation-and-Locking-äº‹åŠ¡éš”ç¦»å’Œé”"><a href="#Transaction-Isolation-and-Locking-äº‹åŠ¡éš”ç¦»å’Œé”" class="headerlink" title="Transaction Isolation and Locking äº‹åŠ¡éš”ç¦»å’Œé”"></a>Transaction Isolation and Locking äº‹åŠ¡éš”ç¦»å’Œé”</h4><p>[1] å¦‚ä½•ä¿è¯äº‹åŠ¡çš„éš”ç¦»<br>â¢ äº‹åŠ¡çš„è¡Œä¸ºå°±åƒå®ƒä»¬ä»¥ä¸²è¡Œé¡ºåºå‘ç”Ÿä¸€æ ·  serializability<br>â¢ ä¸ºäº†å®ç°éš”ç¦»ï¼ŒDBMSé‡‡ç”¨æ•°æ®åº“é”å®šæ¥æ§åˆ¶ä¸€è‡´æ€§<br>[2] é”çš„åˆ†ç±»<br>âœ“ è¯»å–è®¿é—®é”ï¼ˆ R lock &#x2F; share lockï¼‰ã€‚<br>âœ“ æ›´æ–°æˆ–å†™å…¥é”å®šï¼ˆW lock &#x2F; exclusive lockï¼‰ã€‚<br>[3] é”çš„æ‰§è¡Œè§„åˆ™ ï¼ˆP295ï¼Œå›¾5.14ï¼‰<br>â¢ äº‹åŠ¡è®¿é—®æ•°æ®æ—¶ï¼Œéœ€å¯¹å®ƒåŠ æ’å®ƒé”ï¼Œåªåˆ°äº‹åŠ¡ç»“æŸæ‰é‡Šæ”¾é”<br>â¢ æ•°æ®è¢«é”ä½æœŸé—´ï¼Œå…¶å®ƒäº‹åŠ¡çš„è®¿é—®è¯·æ±‚éœ€ç­‰å¾…</p>
<p>ä½¿ç”¨é”æœºåˆ¶è§£å†³è½¬è´¦é—®é¢˜</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221130145628280.png" alt="image-20221130145628280"></p>
<h4 id="æ­»é”"><a href="#æ­»é”" class="headerlink" title="æ­»é”"></a>æ­»é”</h4><p>[1] æ­»é”ï¼šä¸¤ä¸ªæˆ–å¤šä¸ªäº‹åŠ¡æ­£åœ¨ç­‰å¾…ç›¸åŒçš„èµ„æºã€‚ï¼ˆä¸¤ä¸ªçº¿ç¨‹æ‹¿äº†å¯¹æ–¹æ‰§è¡Œæ‰€éœ€è¦çš„èµ„æºï¼‰</p>
<p>[2] Example Transaction deadlock.<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221130145854190.png" alt="image-20221130145854190"></p>
<p>[4] Example 1 æ­»é”æ£€æµ‹ã€‚é€šè¿‡Searched Updateç¼–å†™ä¸€ä¸ªåŒ…å«å¤šè¡Œæ›´æ”¹çš„äº‹åŠ¡ï¼Œå¹¶åœ¨å‡ºç°æ­»é”æ—¶é‡è¯•è¯¥äº‹åŠ¡ã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> DEADABORT -60;</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    exec sql whenever sqlerror <span class="keyword">continue</span>;</span><br><span class="line">    <span class="type">int</span> count = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )&#123; </span><br><span class="line">        exec sql update customers set discnt = <span class="number">1.1</span>*discnt where city = â€˜New Yorkâ€™;</span><br><span class="line">        <span class="keyword">if</span> (sqlca.sqlcode == DEADABORT ) &#123; </span><br><span class="line">            count++; <span class="comment">/*count deadlock aborts*/</span></span><br><span class="line">            <span class="keyword">if</span> (count &lt; <span class="number">4</span>) &#123; </span><br><span class="line">                exec sql rollback work;</span><br><span class="line">                â€¦â€¦ <span class="comment">/*operating system to wait for a second*/</span></span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sqlca.sqlcode &lt;<span class="number">0</span> ) <span class="keyword">break</span>; <span class="comment">/*Error, but non-deadlock*/</span></span><br><span class="line">    &#125; <span class="comment">/* end while */</span></span><br><span class="line">    <span class="keyword">if</span> (sqlca.sqlcode &lt; <span class="number">0</span> ) &#123; <span class="comment">/*over-retried deadlock or other error */</span></span><br><span class="line">        <span class="built_in">print_dberror</span>( ); <span class="comment">/* print error message */</span></span><br><span class="line">        exec sql rollback work;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>; </span><br><span class="line">    &#125; <span class="comment">/* return error */</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">/* return success */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>[5] æ³¨æ„ï¼šå¦‚æœå‘ç”Ÿæ­»é”ï¼Œéœ€è¦è€ƒè™‘ä¸¤ä»¶äº‹ã€‚<br>â¢ ä½¿ç”¨ROLLBACKå¯¹DBæ•°æ®è¿›è¡Œæ‰€æœ‰æ›´æ”¹ï¼Œä»¥å›æ»šåˆ°ç¨‹åºé€»è¾‘é¦–æ¬¡æ‰¾åˆ°å®ƒçš„ä½ç½®ã€‚<br>â¢ å†…å­˜ä¸­çš„ç¨‹åºå˜é‡ä¸å—DBæ§åˆ¶ã€‚</p>
<h3 id="5ã€æ€»ç»“"><a href="#5ã€æ€»ç»“" class="headerlink" title="5ã€æ€»ç»“"></a>5ã€æ€»ç»“</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å£°æ˜ä¸»å˜é‡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">exec sql begin declare section;</span><br><span class="line"><span class="comment">//ä¸»å˜é‡......</span></span><br><span class="line">exec sql end declare section;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¼•å…¥sqlca</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">exec sql include sqlca;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å£°æ˜é”™è¯¯è·³è½¬</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">exec sql whenever xxx <span class="keyword">goto</span> xxx;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è¿æ¥æ•°æ®åº“</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">exec sql content :user_name indentified by password;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å…³é—­æ•°æ®åº“è¿æ¥</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">exec sql disconnect current;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æäº¤äº‹åŠ¡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">exec sql commit work;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å›æ»š</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> exec sql rollback relase;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŸ¥</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">exec sql select xxx,xxx into :xxx,:xxx from è¡¨ where xxx=:xxx;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®šä¹‰æ¸¸æ ‡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">exec sql declare æ¸¸æ ‡å cursor <span class="keyword">for</span> å¢åˆ æ”¹æŸ¥;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‰“å¼€æ¸¸æ ‡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">exec sql open æ¸¸æ ‡å;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨æ¸¸æ ‡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">exec sql fetch æ¸¸æ ‡å into å¯¹åº”æŸ¥è¯¢ç»“æœçš„ä¸»å˜é‡</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å…³é—­æ¸¸æ ‡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">exec sql close æ¸¸æ ‡å;</span><br></pre></td></tr></table></figure>

<p>ä¹ é¢˜ï¼š</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20230220105831487.png" alt="image-20230220105831487"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&quot;prompt.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">exec sql include sqlca;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> notice[]=<span class="string">&quot;please input cid and pid:&quot;</span>;</span><br><span class="line">    exec sql begin declare section; <span class="comment">// å®šä¹‰ä¸»å˜é‡</span></span><br><span class="line">        <span class="type">char</span> c_cid[<span class="number">4</span>],c_pid[<span class="number">4</span>],cc_cid[<span class="number">4</span>],cc_pid[<span class="number">4</span>],cc_aid[<span class="number">4</span>],user[<span class="number">4</span>],pwd[<span class="number">6</span>];</span><br><span class="line">        <span class="type">int</span> qty;</span><br><span class="line">    exec sql end declare section; </span><br><span class="line"></span><br><span class="line">    <span class="function">exec sql sel_cursor cursor <span class="title">for</span> <span class="params">( <span class="comment">// å®šä¹‰æ¸¸æ ‡</span></span></span></span><br><span class="line"><span class="params"><span class="function">        select cid,pid,aid,sum(qty) from order where cid=:c_cid <span class="keyword">and</span> pid=:c_pid group by cid</span></span></span><br><span class="line"><span class="params"><span class="function">    )</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">    exec sql whenever sqlerror <span class="keyword">goto</span> report-err</span>;</span><br><span class="line">    <span class="built_in">strcpy</span>(user,<span class="string">&quot;root&quot;</span>);</span><br><span class="line">    <span class="built_in">strcpy</span>(pwd,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">    exec sql connect :user indentfied by :pwd; <span class="comment">// è¿æ¥æ•°æ®åº“</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">prompt</span>(notice,<span class="number">1</span>,c_cid,<span class="number">4</span>,c_pid,<span class="number">4</span>) &gt; <span class="number">0</span>) &#123; <span class="comment">// è¾“å…¥å€¼</span></span><br><span class="line">        <span class="comment">// æŸ¥cidæ˜¯å¦å­˜åœ¨</span></span><br><span class="line">        exec select cid into:cc_id from customer where cid=:c_cid;</span><br><span class="line">        <span class="keyword">if</span>(sqlca.sqlcode==<span class="keyword">not</span> found) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%s is not exit&quot;</span>, c_cid);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æŸ¥pidæ˜¯å¦å­˜åœ¨</span></span><br><span class="line">        exec select pid into:cc_pid from product where pid=:c_pid;</span><br><span class="line">        <span class="keyword">if</span>(sqlca.sqlcode==<span class="keyword">not</span> found) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%s is not exit&quot;</span>, c_pid);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        exec sql open sel_cursor;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            exec fetch sel_cursor into :cc_cid,:cc_pid,:cc_aid,:qty;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;agent %s sale %s to % s total %d&quot;</span>, cc_aid, cc_pid, cc_aid, qty);</span><br><span class="line">        &#125;</span><br><span class="line">        exec sql close sel_cursor;</span><br><span class="line">        exec sql commit work;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    report-err:</span><br><span class="line">    <span class="built_in">print_dberror</span>();</span><br><span class="line">    exec sql rollback release;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="äº”ã€æ•°æ®åº“è®¾è®¡ï¼ˆDatabase-Designï¼‰"><a href="#äº”ã€æ•°æ®åº“è®¾è®¡ï¼ˆDatabase-Designï¼‰" class="headerlink" title="äº”ã€æ•°æ®åº“è®¾è®¡ï¼ˆDatabase Designï¼‰"></a>äº”ã€æ•°æ®åº“è®¾è®¡ï¼ˆDatabase Designï¼‰</h2><h3 id="è¡¥å……ï¼šæ•°æ®åº“è®¾è®¡çš„åŸºæœ¬æ­¥éª¤"><a href="#è¡¥å……ï¼šæ•°æ®åº“è®¾è®¡çš„åŸºæœ¬æ­¥éª¤" class="headerlink" title="è¡¥å……ï¼šæ•°æ®åº“è®¾è®¡çš„åŸºæœ¬æ­¥éª¤"></a>è¡¥å……ï¼šæ•°æ®åº“è®¾è®¡çš„åŸºæœ¬æ­¥éª¤</h3><p>[1] æ”¹è¿›çš„â€œå¥¥å°”è‰¯æ³•â€ , å°†DBè®¾è®¡åˆ†æˆå…­ä¸ªé˜¶æ®µï¼š </p>
<ul>
<li>éœ€æ±‚åˆ†æ </li>
<li>ç‰©ç†ç»“æ„è®¾è®¡ </li>
<li>æ¦‚å¿µç»“æ„è®¾è®¡ </li>
<li>æ•°æ®åº“å®æ–½ </li>
<li>é€»è¾‘ç»“æ„è®¾è®¡ </li>
<li>æ•°æ®åº“è¿è¡Œç»´æŠ¤</li>
</ul>
<p>[2] DBè®¾è®¡äººå‘˜ï¼ˆäº”ç§è§’è‰²ï¼‰ </p>
<p>ä¹™æ–¹ï¼š</p>
<p>âˆš System analyst âˆš Database Designer âˆš Programmer</p>
<p>ç”²æ–¹ï¼š</p>
<p>âˆš User âˆš Database Administrators</p>
<p>[3]è‹¥DBASè¾ƒå¤æ‚ï¼Œåº”è€ƒè™‘ä½¿ç”¨æ•°æ®åº“è¾…åŠ©è®¾è®¡å·¥å…·(CASE)ï¼Œæé«˜DBè®¾è®¡é€Ÿåº¦ã€è´¨é‡</p>
<p><code>æ•°æ®åº“åº”ç”¨ç³»ç»Ÿè®¾è®¡æµç¨‹å›¾</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221201163230672.png" alt="image-20221201163230672"></p>
<p>è®¾è®¡æ­¥éª¤ï¼š</p>
<p>[1] DBè®¾è®¡é˜¶æ®µ</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221201163329613.png" alt="image-20221201163329613"></p>
<p>[2] DBè®¾è®¡å†…å®¹</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221201163417966.png" alt="image-20221201163417966"></p>
<p>[3] DBè®¾è®¡æ—¶å„ç§æ¨¡å¼çš„äº§ç”Ÿ</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221201163546815.png" alt="image-20221201163546815"></p>
<h3 id="1ã€E-Rå›¾"><a href="#1ã€E-Rå›¾" class="headerlink" title="1ã€E-Rå›¾"></a>1ã€E-Rå›¾</h3><h4 id="å®ä½“ã€å±æ€§ã€E-Rå›¾ï¼ˆEntities-Attributes-E-R-Diagramsï¼‰"><a href="#å®ä½“ã€å±æ€§ã€E-Rå›¾ï¼ˆEntities-Attributes-E-R-Diagramsï¼‰" class="headerlink" title="å®ä½“ã€å±æ€§ã€E-Rå›¾ï¼ˆEntities,Attributes,E-R Diagramsï¼‰"></a>å®ä½“ã€å±æ€§ã€E-Rå›¾ï¼ˆEntities,Attributes,E-R Diagramsï¼‰</h4><p>[1] å®ä½“Entity<br>å®ä½“æ˜¯å¯åŒºåˆ†çš„é›†åˆ(å¯åŒºåˆ«çš„) å…·æœ‰å…±åŒç‰¹æ€§çš„çœŸå®ä¸–ç•Œå¯¹è±¡ã€‚</p>
<p>å®ä½“é—´çš„å…³ç³»ï¼š</p>
<ul>
<li>ä¸€å¯¹ä¸€</li>
<li>ä¸€å¯¹å¤š</li>
<li>å¤šå¯¹å¤š</li>
</ul>
<p>[2] å®ä½“å®ä¾‹Entity Instance<br>ä¸€ä¸ªå®ä½“ï¼ˆå¦‚â€œå®¢æˆ·â€ï¼‰é€šå¸¸æ˜ å°„åˆ°ä¸€ä¸ªå®é™…çš„è¡¨ï¼Œè¡¨çš„æ¯ä¸€è¡Œéƒ½å¯¹åº”äºä¸€ä¸ªå¯åŒºåˆ†çš„çœŸå®ä¸–ç•Œå¯¹è±¡ï¼Œè¯¥è¡Œç§°ä¸ºâ€œå®ä½“å®ä¾‹â€(å®ä½“å®ä¾‹)â€<br>ä¾‹å¦‚ï¼šå­¦ç”Ÿã€è®²å¸ˆã€è¯¾ç¨‹ã€‚<br>[3] å®ä½“é›†Entity Set </p>
<p>[4] å±æ€§Attribute<br>å±æ€§â€”â€”æè¿°å®ä½“æˆ–å…³ç³»çš„å±æ€§ã€‚<br>åœ¨å­¦ç”Ÿå®ä½“ä¸­ï¼Œï¼ˆsidï¼Œstudent_nameï¼‰</p>
<p>[5] ç‰¹æ®Šæ¦‚å¿µ</p>
<p>â¢ Candidate keyâ€”æ¯ä¸ªå®ä½“éƒ½æœ‰ä¸€ä¸ªæ ‡è¯†ç¬¦ï¼Œå®ƒæ˜¯ä¸€ç»„å”¯ä¸€çš„å±æ€§æ ‡è¯†å®ä½“å®ä¾‹ã€‚eg:å®¢æˆ·çš„â€œcidâ€ã€‚<br>â¢ A descriptorâ€”æ˜¯ä¸€ä¸ªéé”®å±æ€§ã€‚eg:è®¢å•çš„â€œqtyâ€ã€‚<br>â¢ A composite attribute eg:â€œcnameâ€å¯ä»¥æœ‰ä¸‰ä¸ªéƒ¨åˆ†ï¼Œå¦‚â€œfnameï¼Œlnameï¼Œmidnameâ€<br>â¢ A multi-valued attributeï¼šå¯ä»¥æ¥å—å®ä½“å®ä¾‹çš„å¤šä¸ªå€¼ã€‚eg:å‘˜å·¥çš„â€œçˆ±å¥½â€ã€‚<br>â¢ <code>ä¸»é”®</code>&#x2F;ä¸»æ ‡è¯†ç¬¦Primary key &#x2F; primary identifier<br>ä¸»é”®æ˜¯DBAä¸ºè¯¥è¡¨ä¸­çš„å”¯ä¸€è¡Œé€‰æ‹©çš„å€™é€‰é”®ã€‚<br>eg:â€œcidâ€ä»£è¡¨å®¢æˆ·ï¼Œâ€œpidâ€ä»£è¡¨äº§å“ï¼Œâ€œaidâ€ä»£è¡¨ä»£ç†å•†</p>
<p>[6] Entity-Relation Approach æ¦‚å¿µæ¨¡å‹è¡¨ç¤ºæ³•<br>1976å¹´P.P.S.Chen æå‡º, E-R å›¾æä¾›äº†è¡¨ç¤ºå®ä½“å‹ã€å±æ€§å’Œè”ç³»çš„æ–¹æ³•ã€‚<br>â¢ Entity ï¼š çŸ©å½¢æ¡†ï¼Œå†…å†™å®ä½“å<br>â¢ Attributeï¼š æ¤­åœ†å½¢ï¼Œå†…å†™å±æ€§å<br>â¢ Relationshipï¼š è±å½¢æ¡†ï¼Œå†…å†™è”ç³»å<br>â¢ No Direction Lineï¼šè¿æ¥å®ä½“ä¸å±æ€§ï¼Œçº¿ä¸Šæ³¨æ˜è”ç³»çš„æ¯”ä¾‹<br>æˆ– åœ¨å®ä½“ä¸å®ä½“ä¹‹é—´å»ºç«‹è¿æ¥ï¼Œçº¿ä¸Šæ³¨æ˜å®ä½“é—´è”ç³»çš„æ¯”ä¾‹å…³ç³»<br>Noticeï¼šE-R å›¾æ˜¯å„ç§æ•°æ®æ¨¡å‹çš„å…±åŒåŸºç¡€ï¼Œä¸DBMSæ”¯æŒçš„æ•°æ®æ¨¡å‹æ— å…³</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221201183743655.png" alt="image-20221201183743655"></p>
<h4 id="å°†å®ä½“å’Œå±æ€§è½¬æ¢ä¸ºå…³ç³»"><a href="#å°†å®ä½“å’Œå±æ€§è½¬æ¢ä¸ºå…³ç³»" class="headerlink" title="å°†å®ä½“å’Œå±æ€§è½¬æ¢ä¸ºå…³ç³»"></a>å°†å®ä½“å’Œå±æ€§è½¬æ¢ä¸ºå…³ç³»</h4><p>[1] è½¬æ¢è§„åˆ™1ã€‚<br>â€¢å®ä½“æ˜ å°„åˆ°å•ä¸ªè¡¨ã€‚<br>â€¢å®ä½“çš„å•å€¼å±æ€§æ˜ å°„åˆ°åˆ—ã€‚å¤åˆå±æ€§æ˜ å°„åˆ°å¤šä¸ªåˆ—ã€‚<br>â€¢å®ä½“å®ä¾‹æˆä¸ºè¡¨çš„è¡Œã€‚<br>[å‚è€ƒ] ä¸€ä¸ªå®ä½“å‹è½¬æ¢ä¸ºä¸€ä¸ªå…³ç³»æ¨¡å¼ï¼Œå®ä½“å±æ€§æ„æˆå…³ç³»å±æ€§ï¼Œå®ä½“ç æˆä¸ºå…³ç³»ç </p>
<p>[3] è½¬æ¢è§„åˆ™2ã€‚<br>â¢ åŸå§‹è¡¨å˜ä¸ºâ€œmuster tableâ€(ä¸»è¡¨).<br>â¢ è¡¨çš„å¤šå€¼å±æ€§å¿…é¡»æ˜ å°„åˆ°å…¶è‡ªå·±çš„è¡¨ï¼Œç§°ä¸ºâ€œdependent tableâ€(ä»è¡¨).</p>
<h4 id="å®ä½“ä¹‹é—´çš„å…³ç³»"><a href="#å®ä½“ä¹‹é—´çš„å…³ç³»" class="headerlink" title="å®ä½“ä¹‹é—´çš„å…³ç³»"></a>å®ä½“ä¹‹é—´çš„å…³ç³»</h4><p>[1] å®šä¹‰Relationship<br>â¢ ç»™å®šå…·æœ‰E1ã€E2ã€â€¦ã€Emçš„mä¸ªå®ä½“ï¼Œå…³ç³»Rå®šä¹‰äº†è¿™äº›å®ä½“çš„å®ä¾‹ä¹‹é—´çš„å¯¹åº”è§„åˆ™ã€‚<br>â¢ ç¤ºä¾‹ï¼š<br>è®²å¸ˆè®²æˆè¯¾ç¨‹_éƒ¨åˆ†<br>å‘˜å·¥åœ¨é¡¹ç›®ä¸Šå·¥ä½œï¼ˆå±æ€§ï¼Œç™¾åˆ†æ¯”ï¼ˆæ—¶é—´ï¼‰ï¼‰<br>å‘˜å·¥ç®¡ç†å‘˜å·¥ï¼ˆç¯å½¢&#x2F;é€’å½’å…³ç³»ï¼‰</p>
<p>â¢ E_Rè®¾è®¡è½¬æ¢ï¼šå…³ç³»æœ‰æ—¶è½¬æ¢ä¸ºè¡¨ï¼Œæœ‰æ—¶ä¸è½¬æ¢ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221201184150760.png" alt="image-20221201184150760"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221201184257272.png" alt="image-20221201184257272"></p>
<h3 id="2ã€E-Rå»ºæ¨¡çš„è¿›ä¸€æ­¥ç»†èŠ‚"><a href="#2ã€E-Rå»ºæ¨¡çš„è¿›ä¸€æ­¥ç»†èŠ‚" class="headerlink" title="2ã€E-Rå»ºæ¨¡çš„è¿›ä¸€æ­¥ç»†èŠ‚"></a>2ã€E-Rå»ºæ¨¡çš„è¿›ä¸€æ­¥ç»†èŠ‚</h3><h4 id="å®ä½“çš„åŸºæ•°-å…³ç³»çš„åŸºæ•°"><a href="#å®ä½“çš„åŸºæ•°-å…³ç³»çš„åŸºæ•°" class="headerlink" title="å®ä½“çš„åŸºæ•°(å…³ç³»çš„åŸºæ•°)"></a>å®ä½“çš„åŸºæ•°(å…³ç³»çš„åŸºæ•°)</h4><p>[1] æœ€å°å’Œæœ€å¤§åŸºæ•°<br>â¢ åœ¨E-Rå›¾ä¸­ï¼Œç‚¹è¡¨ç¤ºå®ä½“ï¼ˆEæˆ–Fï¼‰ã€‚Rä»£è¡¨å…³ç³»ï¼Œå¹¶ä¸”ä½¿ç”¨çº¿è¿æ¥ç‚¹ä¹‹é—´ã€‚<br>   è°ƒç”¨ç‚¹æ˜¯å®ä½“å®ä¾‹ï¼Œè°ƒç”¨çº¿æ˜¯å…³ç³»å®ä¾‹ã€‚<br>â¢ æœ€å¤§åŸºæ•°(æœ€å¤§åŸº) Eå’ŒRä¹‹é—´(æœ€å¤šå®ä¾‹å…³è”çº¿æ•°)<br>ï¼ˆ1ï¼‰max-card(E, R) &#x3D; 1. å¦‚æœEä¸­çš„æ‰€æœ‰ç‚¹æœ€å¤šæœ‰ä¸€è¡Œå‡ºæ¥ã€‚<br>ï¼ˆ2ï¼‰max-card(E, Rï¼‰&#x3D; Nã€‚å¦‚æœå¯èƒ½æœ‰å¤šæ¡çº¿è·¯è¾“å‡ºã€‚<br>â¢ æœ€å°åŸºæ•°(æœ€å°åŸº) Eå’ŒRä¹‹é—´(æœ€å°‘å®ä¾‹å…³è”çº¿æ•°)<br>ï¼ˆ1ï¼‰ min-card(E, R) &#x3D; 1ã€‚å¦‚æœEä¸­çš„æ‰€æœ‰ç‚¹è‡³å°‘æœ‰ä¸€æ¡çº¿å‡ºæ¥ã€‚<br>ï¼ˆ2ï¼‰ max-card(E, R) &#x3D; 0ã€‚å¦‚æœä¸€äº›ç‚¹å¯èƒ½æ²¡æœ‰ä¸€æ¡çº¿å‡ºæ¥ã€‚</p>
<p>â¢ å³ï¼šå°†Rçœ‹æˆ åŸŸEå’ŒFä¹‹é—´çš„æ˜ å°„ï¼ˆrelationshipï¼‰ï¼Œåˆ™<br>(1) max-card(E,R) ä¸º â€œå®ä½“Eç»Rå…³ç³»æ˜ å°„åˆ°å®ä½“Fâ€çš„æœ€å¤§å…³è”æ•°ã€‚<br>(2) min-card(E,R) ä¸º â€œå®ä½“Eç»Rå…³ç³»æ˜ å°„åˆ°å®ä½“Fâ€çš„æœ€å°å…³è”æ•°ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221201185421510.png" alt="image-20221201185421510"></p>
<p>[2] å®šä¹‰<br>â¢ å½“å®ä½“Eå‚ä¸å…³ç³»Ræ—¶ï¼Œ min-cardï¼ˆEï¼ŒRï¼‰&#x3D;xï¼Œmax-cardï¼ˆEã€Rï¼‰&#x3D;y<br>â¢ åœ¨E_Ræ¨¡å‹ä¸­ï¼ŒEå’ŒRä¹‹é—´çš„è¿æ¥çº¿å¯ä»¥æ ‡è®°ä¸ºâ€œï¼ˆxï¼Œyï¼‰â€</p>
<p>eg:<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221201185619037.png" alt="image-20221201185619037"></p>
<h4 id="1-1ã€N-Nã€1-N-Relationships"><a href="#1-1ã€N-Nã€1-N-Relationships" class="headerlink" title="1-1ã€N-Nã€1-N Relationships"></a>1-1ã€N-Nã€1-N Relationships</h4><p>[1] Def: single-valued&#x2F;multi-valued participation </p>
<p>â¢ If max-card(E, R)&#x3D;1, E have single-valued participation in R. </p>
<p>â¢ If max-card(E, R)&#x3D;N, E have multi-valued participation in R</p>
<p>[2] Classify of relationship å…³ç³»çš„åˆ†ç±»</p>
<p> â¢ R is <strong>N-N</strong> relationship, If entities E and F are multi-valued in the relationship R [ max-card(E, R) &#x3D; N ; max-card(F, R) &#x3D; N ]. </p>
<p>â¢ R is <strong>1-1</strong> relationship, If entities E and F are single-valued in the relationship R [ max-card(E, R) &#x3D; 1 ; max-card(F, R) &#x3D; 1 ]. </p>
<p>â¢ R is <strong>1-N</strong> relationship, If E is single-valued, and F is multi-valued</p>
<p>âœ“E [max-card(E, R)&#x3D;1] is â€œ<code>Many side</code>â€ </p>
<p>âœ“F [max-card(F, R)&#x3D;N] is â€œ<code>One side</code>â€</p>
<h4 id="å°†äºŒå…ƒå…³ç³»è½¬æ¢ä¸ºå…³ç³»-å…­æ¡è½¬æ¢è§„åˆ™"><a href="#å°†äºŒå…ƒå…³ç³»è½¬æ¢ä¸ºå…³ç³»-å…­æ¡è½¬æ¢è§„åˆ™" class="headerlink" title="å°†äºŒå…ƒå…³ç³»è½¬æ¢ä¸ºå…³ç³»(å…­æ¡è½¬æ¢è§„åˆ™)"></a>å°†äºŒå…ƒå…³ç³»è½¬æ¢ä¸ºå…³ç³»(å…­æ¡è½¬æ¢è§„åˆ™)</h4><p>[æ€»ç»“] â€œE-Ræ¨¡å‹â€å‘â€œRDBâ€ è½¬æ¢çš„è§„åˆ™ </p>
<p>(1) ä¸€ä¸ªå®ä½“Eè½¬æ¢ä¸ºä¸€ä¸ªå…³ç³» Tableï¼Œå®ä½“å±æ€§æˆä¸ºå…³ç³»å±æ€§ï¼Œå®ä½“ç å°±æ˜¯å…³ç³»çš„ç  </p>
<p>(2) ä¸€ä¸ª1-1è”ç³»å¯è½¬æ¢ä¸ºä¸€ä¸ªç‹¬ç«‹Tableï¼›ä¹Ÿå¯ä»¥ä¸ä»»ä¸€å®ä½“åˆå¹¶ã€‚ </p>
<p>(3) ä¸€ä¸ª1-nè”ç³»å¯è½¬æ¢ä¸ºä¸€ä¸ªç‹¬ç«‹Tableï¼›ä¹Ÿå¯ä¸nç«¯å¯¹åº”çš„å®ä½“åˆå¹¶ã€‚ </p>
<p>(4) ä¸€ä¸ªm-nè”ç³»å¯è½¬æ¢ä¸ºä¸€ä¸ªç‹¬ç«‹Tableï¼›ä¸è¯¥è”ç³»ç›¸è¿çš„å„å®ä½“ç ä»¥åŠè”ç³»æœ¬èº«çš„ å±æ€§å‡è½¬æ¢ä¸ºTableçš„å±æ€§ï¼›ä¸”è¯¥Tableçš„ç ä¸ºå„å®ä½“ç çš„ç»„åˆã€‚ </p>
<p>(5) ä¸‰ä¸ªæˆ–ä¸‰ä¸ªä»¥ä¸Šå®ä½“é—´çš„å¤šå…ƒè”ç³»Rï¼Œå¯ä»¥è½¬æ¢ä¸ºä¸€ä¸ªå…³ç³»Table ï¼›ä¸å¤šå…ƒè”ç³»R ç›¸è¿çš„å„å®ä½“ç ï¼Œå‡éœ€åŠ å…¥ä¸ºTableçš„å±æ€§ï¼›Tableçš„ç ä¸ºå„å®ä½“ç çš„ç»„åˆã€‚ </p>
<p>(6) å…·æœ‰ç›¸åŒç çš„å…³ç³»Tableå¯åˆå¹¶ã€‚</p>
<h3 id="3ã€èŒƒå¼"><a href="#3ã€èŒƒå¼" class="headerlink" title="3ã€èŒƒå¼"></a>3ã€èŒƒå¼</h3><p>1)å®šç†ï¼š<br>â€“ æ¯ä¸ªå‡½æ•°ä¾èµ–é›†F &lt;â€“&gt;ä¸€ä¸ªæœ€å°å‡½æ•°ä¾èµ–é›†Fmã€‚<br>â€“ æ¯ä¸ªFçš„æœ€å°å‡½æ•°ä¾èµ–é›†Fmä¸å”¯ä¸€ï¼Œå®ƒä¸å¤„ç†Fä¸­æ¯ä¸ªFDçš„é¡ºåºæœ‰å…³ã€‚</p>
<p>(2)æ¨ç†ï¼š<br>â€“ è‹¥è¦æ±‚å…³ç³»æ¨¡å¼çš„åˆ†è§£ä¿æŒå‡½æ•°ä¾èµ–ï¼Œé‚£ä¹ˆåˆ†è§£å¯ä»¥è¾¾åˆ°3NFï¼ˆéä¸»å±æ€§ä¸â€œç â€ä¸å­˜åœ¨ä¼ é€’å‡½æ•°ä¾èµ–ï¼‰ï¼Œä½†ä¸ä¸€å®šèƒ½è¾¾åˆ°BCNFï¼ˆæ¯ä¸€ä¸ªFDä¸­çš„å†³å®šå› ç´ å‡åŒ…å«äºç ï¼‰ã€‚<br>â€“ è‹¥è¦æ±‚å…³ç³»æ¨¡å¼çš„åˆ†è§£å…·æœ‰æ— æŸè¿æ¥æ€§ï¼Œé‚£ä¹ˆåˆ†è§£æ€»å¯ä»¥è¾¾åˆ°4NFã€‚</p>
<p>(3)èŒƒå¼ï¼š<br>â€“ å…±æœ‰å…­ç§ï¼ŒèŒƒå¼ä¹‹é—´çš„å…³ç³»ï¼š<br>â€“ ä¸€ä¸ªä½çº§èŒƒå¼çš„å…³ç³»æ¨¡å¼ï¼Œé€šè¿‡â€œæ¨¡å¼åˆ†è§£â€å¯ä»¥è½¬æ¢ä¸ºè‹¥å¹²ä¸ªé«˜çº§èŒƒ<br>å¼çš„å…³ç³»æ¨¡å¼é›†åˆï¼Œè¿™ç§è¿‡ç¨‹ç§°ä¸ºè§„èŒƒåŒ–ã€‚<br>5NF ïƒŒ 4NF ïƒŒ BCNF ïƒŒ 3NF ïƒŒ 2NF ïƒŒ1NF</p>
<p>(4)2NFï¼šè‹¥Râˆˆ1NFï¼Œä¸”æ¯ä¸€ä¸ªéä¸»å±æ€§å®Œå…¨å‡½æ•°ä¾èµ–äºç ï¼Œåˆ™Râˆˆ2NFã€‚ è¯¥æ¨¡å¼ä¼šäº§ç”Ÿçš„é—®é¢˜ï¼šæ’å…¥å¼‚å¸¸ã€åˆ é™¤å¼‚å¸¸ã€ä¿®æ”¹å¤æ‚ </p>
<p>(5)3NFï¼š è‹¥Râˆˆ3NFï¼Œåˆ™æ¯ä¸€ä¸ªéä¸»å±æ€§ï¼Œæ—¢ä¸éƒ¨åˆ†ä¾èµ–äºç ï¼Œä¹Ÿä¸ä¼ é€’ä¾èµ–äºç ã€‚å®ƒä¼šäº§ç”Ÿä¸2NFç±»ä¼¼çš„é—®é¢˜ï¼Œåˆ†è§£æ¨¡å¼æ¶ˆé™¤ä¼ é€’å‡½æ•°ä¾èµ–ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221201201916141.png" alt="image-20221201201916141"></p>
<h2 id="å…­ã€æ•°æ®åº“çš„å®Œæ•´æ€§ã€å®‰å…¨æ€§ã€è§†å›¾ï¼ˆIntegrity-Views-Securityï¼‰"><a href="#å…­ã€æ•°æ®åº“çš„å®Œæ•´æ€§ã€å®‰å…¨æ€§ã€è§†å›¾ï¼ˆIntegrity-Views-Securityï¼‰" class="headerlink" title="å…­ã€æ•°æ®åº“çš„å®Œæ•´æ€§ã€å®‰å…¨æ€§ã€è§†å›¾ï¼ˆIntegrity,Views, Securityï¼‰"></a>å…­ã€æ•°æ®åº“çš„å®Œæ•´æ€§ã€å®‰å…¨æ€§ã€è§†å›¾ï¼ˆIntegrity,Views, Securityï¼‰</h2><h3 id="1ã€å®Œæ•´æ€§çº¦æŸ"><a href="#1ã€å®Œæ•´æ€§çº¦æŸ" class="headerlink" title="1ã€å®Œæ•´æ€§çº¦æŸ"></a>1ã€å®Œæ•´æ€§çº¦æŸ</h3><h4 id="æ¦‚å¿µ-1"><a href="#æ¦‚å¿µ-1" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><p>[1] Definition </p>
<p>â¢è¡¨åˆ›å»ºæ—¶å®šä¹‰â€œå®Œæ•´æ€§çº¦æŸâ€ </p>
<p>â¢æŒ‰ä½œç”¨å¯¹è±¡åˆ†ï¼š è¡¨çº§å®Œæ•´æ€§ã€åˆ—çº§å®Œæ•´æ€§ </p>
<p>â¢æŒ‰ç±»å‹åˆ†ï¼š å®ä½“å®Œæ•´æ€§ã€å‚ç…§å®Œæ•´æ€§ã€ç”¨æˆ·è‡ªå®šä¹‰å®Œæ•´æ€§</p>
<p>[2] Function æ•°æ®åº“åš Updates æ“ä½œæ—¶éœ€æ£€æŸ¥ã€éµå®ˆè¿™äº›å®Œæ•´æ€§çº¦æŸã€‚</p>
<p>[3] å®æ–½æœºåˆ¶ </p>
<p>â¢<code>å®ä½“å®Œæ•´æ€§</code>â€”-å®æ–½æªæ–½ï¼š<strong>ä¸»é”®</strong>ã€å”¯ä¸€ç´¢å¼•ã€éç©º+å”¯ä¸€ </p>
<p>â¢<code>å‚ç…§å®Œæ•´æ€§</code>â€”-å®æ–½æªæ–½ï¼š<strong>å¤–é”®</strong>ã€è§¦å‘å™¨ã€å­˜å‚¨è¿‡ç¨‹ </p>
<p>â¢ç”¨æˆ·è‡ªå®šä¹‰å®Œæ•´æ€§â€“å®æ–½æªæ–½ï¼šéç©ºã€ç¼ºçœå€¼ã€å–å€¼çº¦æŸç­‰</p>
<h4 id="Create-Tableè¯­å¥ä¸­çš„å®Œæ•´æ€§çº¦æŸ"><a href="#Create-Tableè¯­å¥ä¸­çš„å®Œæ•´æ€§çº¦æŸ" class="headerlink" title="Create Tableè¯­å¥ä¸­çš„å®Œæ•´æ€§çº¦æŸ"></a>Create Tableè¯­å¥ä¸­çš„å®Œæ•´æ€§çº¦æŸ</h4><p>[1] Definition  Create Table</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> [schema.]tablename</span><br><span class="line">    ( colname datatype [<span class="keyword">DEFAULT</span> &#123;default_constant <span class="operator">|</span> <span class="keyword">NULL</span>&#125;]</span><br><span class="line">    [col_constr &#123;col_constr. . .&#125;] <span class="operator">|</span> table_constr</span><br><span class="line">    &#123; , &#123;colname datatype [<span class="keyword">DEFAULT</span> &#123;default_constant <span class="operator">|</span> <span class="keyword">NULL</span>&#125;]</span><br><span class="line">    [col_constr &#123;col_constr. . .&#125;] <span class="operator">|</span> table_constr&#125; . . . &#125; );</span><br></pre></td></tr></table></figure>

<p>â¢ æ¯åˆ—å¿…é¡»å®šä¹‰ä¸ºï¼š åˆ—å + æ•°æ®ç±»å‹</p>
<p>â¢ æ¯åˆ—è¿˜å…è®¸æœ‰ï¼šå¯é€‰çš„ DEFAULT å­å¥ ã€ ç”± col_constr è¡¨ç¤ºçš„åˆ—çº¦æŸåˆ—è¡¨</p>
<p>[2] Example: Create Table statement for â€œproductsâ€.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> products (</span><br><span class="line">    pid <span class="type">char</span>(<span class="number">3</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    pname <span class="type">varchar</span>(<span class="number">13</span>), city <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">    quantity <span class="type">integer</span> <span class="keyword">default</span> <span class="number">0</span>,</span><br><span class="line">    price <span class="type">double precision</span> <span class="keyword">default</span> <span class="number">0.0</span>,</span><br><span class="line">    <span class="keyword">primary</span> key (pid) # ä¸»é”®</span><br><span class="line">); </span><br></pre></td></tr></table></figure>

<p>[3] Example: Create Table statement for â€œcustomersâ€. </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> customers (</span><br><span class="line">    cid <span class="type">char</span>(<span class="number">4</span>) <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">unique</span>, # éç©º <span class="operator">+</span> å”¯ä¸€ <span class="operator">=</span> <span class="keyword">primary</span> key</span><br><span class="line">    cname <span class="type">varchar</span>(<span class="number">13</span>), city <span class="type">varchar</span>(<span class="number">20</span>),</span><br><span class="line">    discnt <span class="type">real</span> <span class="keyword">constraint</span> discnt_max <span class="keyword">check</span> (discnt<span class="operator">&lt;=</span><span class="number">15.0</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>[4] Column Constraints åˆ—çº§çº¦æŸ</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="operator">|</span> [<span class="keyword">CONSTRAINT</span> constraint_name]</span><br><span class="line"><span class="keyword">UNIQUE</span> <span class="operator">|</span> <span class="keyword">PRIMARY</span> KEY <span class="operator">|</span> <span class="keyword">CHECK</span> (search_cond)</span><br><span class="line"><span class="operator">|</span> <span class="keyword">REFERENCES</span> tablename [(colname) ] [<span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE]&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>CONSTRAINT æ¯ä¸ªçº¦æŸçš„åç§°</li>
<li>UNIQUE çº¦æŸè¡¨ä¸­æ‰€æœ‰éç©ºåˆ—å€¼éƒ½æ˜¯å”¯ä¸€çš„</li>
<li>PRIMARY KEYæŒ‡å®šåˆ—ä½œä¸ºä¸»é”®</li>
</ul>
<p>NOT NULL+UNIQUE &#x3D; PRIMARY KEY</p>
<p>PRIMARY KEY å’Œ NOT NULLå¯ä»¥ä¸€èµ·ä½¿ç”¨ï¼Œä½† UNIQUE å’Œ PRIMARY KEY ä¸èƒ½åŒæ—¶ç”¨äºåˆ—ã€‚</p>
<p>â¢ CHECKå…è®¸è¡Œåœ¨â€œsearch_condâ€ä¸­åŒ…å«çº¦æŸå€¼ã€‚<br>â¢ å¦‚æœä½¿ç”¨ REFERENCES tablename [columnname] å®šä¹‰çš„åˆ—</p>
<ul>
<li>åˆ—ä¸­çš„æ¯ä¸ªå€¼å¿…é¡»ä¸º null æˆ– å€¼ã€‚</li>
<li>å¼•ç”¨è¡¨çš„ä¸€åˆ—(è¢«å‚ç…§è¡¨&#x2F;ä¸»è¡¨) æ˜¯ä¸»é”®æˆ–å¯é€‰åˆ—ä¸­æŒ‡å®šçš„åˆ—ã€‚</li>
</ul>
<p>â¢ å¯é€‰çš„ON DELETE CASCADE(çº§è”åˆ é™¤)<br>å¦‚æœæ­£åœ¨åˆ é™¤å¼•ç”¨è¡¨ä¸­çš„è¡Œï¼Œé‚£ä¹ˆ(å‚ç…§è¡¨&#x2F;ä»è¡¨)çš„è¡Œä¹Ÿå·²åˆ é™¤</p>
<p>[5] Table Constraints. è¡¨çº§çº¦æŸ</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[<span class="keyword">CONSTRAINT</span> constraint_name] &#123;<span class="keyword">UNIQUE</span> (colname&#123;, colnameâ€¦&#125;)</span><br><span class="line"><span class="operator">|</span> <span class="keyword">PRIMARY</span> KEY (colname &#123;, colnameâ€¦â€¦&#125;)</span><br><span class="line"><span class="operator">|</span> <span class="keyword">CHECK</span> (search_condition)</span><br><span class="line"><span class="operator">|</span> <span class="keyword">FOREIGN</span> KEY (colname &#123;, colnameâ€¦â€¦&#125;)</span><br><span class="line"><span class="keyword">REFERENCES</span> tablename [(colname &#123;, colnameâ€¦â€¦&#125;)]</span><br><span class="line">[<span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE]&#125;</span><br></pre></td></tr></table></figure>

<p>â¢ UNIQUEæ˜¯ä¸€ç§å°†å¤šåˆ—æŒ‡å®šä¸ºè¡¨çš„å€™é€‰å…³é”®å­—çš„æ–¹æ³•ï¼Œå¦‚æœè¿™ä¸¤ä¸ªå…³é”®å­—éƒ½å£°æ˜ä¸ºNULLã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221202102248275.png" alt="image-20221202102248275"></p>
<p>â¢ FOREIGN KEYâ€¦REFERENCESâ€¦[ON DELETEâ€¦]</p>
<p>âœ“ FOREIGN KEY columnname å°†ä¸€ç»„åˆ—ä½œä¸º FK åˆ—å‡ºã€‚å®ƒä»¬è¢«çº¦æŸä¸º ç­‰äºä¸»è¡¨çš„PKã€‚<br>âœ“ å¦‚æœä¸»è¡¨ä¸­çš„è¡Œè¢«åˆ é™¤ï¼Œåˆ™ä»è¡¨ä¸­å¼•ç”¨ä¸»è¡¨çš„è¡Œä¹Ÿä¼šè¢«åˆ é™¤ã€‚</p>
<p>[6] Example Create tables of CAP DataBase.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> customer ( </span><br><span class="line">    cid <span class="type">char</span>(<span class="number">4</span>) <span class="keyword">not</span> <span class="keyword">null</span>, # ä¸»è¡¨</span><br><span class="line">    cname <span class="type">varchar</span>(<span class="number">13</span>), city <span class="type">char</span>(<span class="number">20</span>),</span><br><span class="line">    discnt <span class="type">real</span> <span class="keyword">constraint</span> discnt_max <span class="keyword">check</span> (discnt <span class="operator">&lt;=</span> <span class="number">15.0</span>),</span><br><span class="line">    <span class="keyword">primary</span> key ( cid ) </span><br><span class="line">) ;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> orders ( # ä»è¡¨</span><br><span class="line">    ordno <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span>, </span><br><span class="line">    <span class="keyword">month</span> <span class="type">char</span>(<span class="number">3</span>), </span><br><span class="line">    cid <span class="type">char</span>(<span class="number">4</span>) <span class="keyword">not</span> <span class="keyword">null</span>, </span><br><span class="line">    aid <span class="type">char</span>(<span class="number">3</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">    pid <span class="type">char</span>(<span class="number">3</span>) <span class="keyword">not</span> <span class="keyword">null</span>, </span><br><span class="line">    qty <span class="type">integer</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">check</span>(qty <span class="operator">&gt;=</span> <span class="number">0</span>) ,</span><br><span class="line">    dollars <span class="type">float</span> <span class="keyword">default</span> <span class="number">0.0</span> <span class="keyword">check</span>(dollars <span class="operator">&gt;=</span> <span class="number">0.0</span>) ,</span><br><span class="line">    <span class="keyword">primary</span> key (ordno) ,</span><br><span class="line">    <span class="keyword">foreign</span> key (cid) <span class="keyword">references</span> customers, # å¤–é”®</span><br><span class="line">    <span class="keyword">foreign</span> key (aid) <span class="keyword">references</span> agents,</span><br><span class="line">    <span class="keyword">foreign</span> key (pid) <span class="keyword">references</span> products </span><br><span class="line">) ;</span><br></pre></td></tr></table></figure>

<h4 id="Primary-Keys-Foreign-Keys-Referent"><a href="#Primary-Keys-Foreign-Keys-Referent" class="headerlink" title="Primary-Keys, Foreign-Keys, Referent"></a>Primary-Keys, Foreign-Keys, Referent</h4><p>ä¸»é”®ã€å¤–é”®å’Œå¼•ç”¨</p>
<p>[1] å®šä¹‰ï¼šå¤–é”®ã€å¼•ç”¨å®Œæ•´æ€§ã€‚<br>â¢ T1 å¼•ç”¨å¼•ç”¨è¡¨(å‚ç…§è¡¨&#x2F;ä»è¡¨), å¹¶ä¸”è¡¨ T1 ä¸­çš„ä¸€ç»„åˆ—Fè¢«å®šä¹‰ä¸ºå¤–é”®ã€‚<br>â¢ T2 å‚è€ƒå‚è€ƒè¡¨(è¢«å‚ç…§è¡¨&#x2F;ä¸»è¡¨), å¹¶ä¸”è¡¨ T2 ä¸­çš„ä¸€ç»„åˆ—Pè¢«å®šä¹‰ä¸ºä¸»é”®æˆ–å€™é€‰é”®ã€‚<br>â¢ å¦‚æœ T1 çš„ä»»ä½•è¡Œä¸­çš„Fåˆ—å¿…é¡» â‘ å…·æœ‰ç©ºå€¼ï¼ˆæˆ–åˆ—ä¸ºç©ºï¼‰ â‘¡ å…¶å€¼ç­‰äº T2 çš„æŸè¡Œä¸Šçš„ PK çš„å€¼ç›¸åŒã€‚<br>â¢ æ³¨æ„ï¼šè¡¨çš„å¤–é”®å¯èƒ½ä¼šå‡ºç°åœ¨åŒä¸€è¡¨ä¸­çš„å€™é€‰é”®æˆ–ä¸»é”®ä¸­ã€‚</p>
<p>[2] Example Use Referential Integrityï¼ˆå‚ç…§å®Œæ•´æ€§ to define an Enumerated (æšä¸¾) Domain of â€œcityâ€ in table â€œcitiesâ€.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> cities ( # ä¸»è¡¨</span><br><span class="line">    city <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="keyword">null</span>, </span><br><span class="line">    <span class="keyword">primary</span> key (city) </span><br><span class="line">);</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> customers ( # ä»è¡¨</span><br><span class="line">    cid <span class="type">char</span>(<span class="number">4</span>) <span class="keyword">not</span> <span class="keyword">null</span>, </span><br><span class="line">    cname <span class="type">varchar</span>(<span class="number">13</span>),</span><br><span class="line">    city <span class="type">varchar</span>(<span class="number">20</span>), </span><br><span class="line">    discnt <span class="type">real</span>, </span><br><span class="line">    <span class="keyword">primary</span> key (cid),</span><br><span class="line">    <span class="keyword">foreign</span> key city <span class="keyword">references</span> cities</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>[3] å®Œæ•´æ€§çº¦æŸçš„æµ‹è¯•çŸ©é˜µ</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221202110445083.png" alt="image-20221202110445083"></p>
<h4 id="Alter-Table-Statement-æ›´æ”¹è¡¨å£°æ˜"><a href="#Alter-Table-Statement-æ›´æ”¹è¡¨å£°æ˜" class="headerlink" title="Alter Table Statement æ›´æ”¹è¡¨å£°æ˜"></a>Alter Table Statement æ›´æ”¹è¡¨å£°æ˜</h4><p>[1] åŠŸèƒ½ï¼šæ›´æ”¹ç°æœ‰è¡¨çš„ç»“æ„ã€‚<br>å‰æï¼šï¼ˆ1ï¼‰è¡¨å·²ç»å­˜åœ¨ï¼ˆ2ï¼‰çš„æ‰€æœ‰è€…å…·æœ‰Alteræƒé™</p>
<p>[2] Alter Table statement </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tablename</span><br><span class="line">    [<span class="keyword">ADD</span> (&#123;colname datatype [<span class="keyword">DEFAULT</span> &#123;default_constant<span class="operator">|</span> <span class="keyword">NULL</span>&#125;]</span><br><span class="line">    [col_constr &#123;col_constr...&#125;] <span class="operator">|</span> table_constr&#125; &#123;, ...&#125;)]</span><br><span class="line">    [<span class="keyword">DROP</span> &#123;<span class="keyword">COLUMN</span> columnname <span class="operator">|</span> (columnname &#123;, columnnameâ€¦&#125;)&#125;]</span><br><span class="line">    [MODIFY (columnname data<span class="operator">-</span>type</span><br><span class="line">    [<span class="keyword">DEFAULT</span> &#123;default_const<span class="operator">|</span><span class="keyword">NULL</span>&#125;] [[<span class="keyword">NOT</span>] <span class="keyword">NULL</span>] &#123;, ...&#125;)]</span><br><span class="line">    [<span class="keyword">DROP</span> <span class="keyword">CONSTRAINT</span> constr_name]</span><br><span class="line">    [<span class="keyword">DROP</span> <span class="keyword">PRIMARY</span> KEY]</span><br><span class="line">    [ENABLE <span class="keyword">and</span> DISABLE clauses <span class="keyword">for</span> constraints];</span><br></pre></td></tr></table></figure>

<p>[3] Exampleï¼šä¿®æ”¹ordersè¡¨ä¸­çš„monthä¸ºæ—¥æœŸç±»å‹ã€å°†ordnoå­—æ®µæ”¹ä¸ºå®å‹. </p>
<p>æ€è·¯ï¼š(1) åˆ›å»ºæ—¥æœŸå‹å­—æ®µorder_date, å†å–å‡ºåŸmonthå€¼æ‹¼ä¸Šâ€œå¹´ã€æ—¥â€å›å¡«ï¼› (2) ä¿®æ”¹ordnoå­—æ®µçš„ç±»å‹</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> orders </span><br><span class="line">	<span class="keyword">DROP</span> <span class="keyword">PRIMARY</span> KEY (ordno),</span><br><span class="line">	<span class="keyword">ADD</span> order_date <span class="type">char</span>(<span class="number">10</span>) <span class="keyword">default</span> â€œ<span class="number">2018</span><span class="operator">/</span><span class="number">01</span><span class="operator">/</span><span class="number">01</span>â€,</span><br><span class="line">	MODIFY ordno <span class="type">real</span>;</span><br><span class="line">	<span class="keyword">UPDATE</span> orders <span class="keyword">set</span> order_date<span class="operator">=</span> â€¦â€¦(<span class="keyword">month</span>) ;</span><br><span class="line">	<span class="keyword">ALTER</span> <span class="keyword">TABLE</span> orders <span class="keyword">DROP</span> <span class="keyword">month</span> ;</span><br></pre></td></tr></table></figure>

<h4 id="Non-Procedural-x2F-Procedural-Integrity-Constraints-éç¨‹åº-x2F-ç¨‹åºå®Œæ•´æ€§çº¦æŸ"><a href="#Non-Procedural-x2F-Procedural-Integrity-Constraints-éç¨‹åº-x2F-ç¨‹åºå®Œæ•´æ€§çº¦æŸ" class="headerlink" title="Non-Procedural &#x2F; Procedural Integrity Constraints éç¨‹åº&#x2F;ç¨‹åºå®Œæ•´æ€§çº¦æŸ"></a>Non-Procedural &#x2F; Procedural Integrity Constraints éç¨‹åº&#x2F;ç¨‹åºå®Œæ•´æ€§çº¦æŸ</h4><p>[1] The non-procedural constraints: Using â€œforeign keyâ€ </p>
<p>Eg: Student ( sno, sname, sdept) SC (cno, sno, score) </p>
<p>å¦‚æœåˆ é™¤Studentè¡Œï¼Œåˆ™åˆ é™¤SCè¡Œå…³äºSC.sno&#x3D;Student.snoçš„è¡Œå¿…é¡»çº§è”åˆ é™¤ã€‚</p>
<p>[2] ç¨‹åºçº¦æŸï¼šTriggersï¼ˆè§¦å‘å™¨ï¼‰æˆ– Proceduresï¼ˆç¨‹åºï¼‰<br>â€¢çµæ´»æ€§<br>â€¢ç”¨æˆ·åœ¨DBMSä¸­çš„å®šä¹‰</p>
<h4 id="è§¦å‘å™¨Triggers"><a href="#è§¦å‘å™¨Triggers" class="headerlink" title="è§¦å‘å™¨Triggers"></a>è§¦å‘å™¨Triggers</h4><ul>
<li>å‘ˆç°DBMSçš„ååº”è¡Œä¸º</li>
<li>è§„åˆ™-ç±»ä¼¼äºè¿‡ç¨‹ï¼Œä½†æ‰§è¡Œæ˜¯è‡ªåŠ¨çš„</li>
<li>å¤§å¤šæ•°å•†ä¸šDBMSé€šè¿‡â€œè§¦å‘å™¨â€æä¾›æ­¤åŠŸèƒ½ï¼ˆè§¦å‘å™¨å…³è”ä¸€ä¸ªè¡¨ï¼Œç”±æ¿€æ´»è¡¨äº‹ä»¶)</li>
<li>DBMSé€šè¿‡â€œè§¦å‘å™¨â€æä¾›æ­¤åŠŸèƒ½åŸºäºäº‹ä»¶æ¡ä»¶æ“ä½œèŒƒä¾‹ï¼šEvent-Condition-Action</li>
<li>äº‹ä»¶eventï¼šé€šè¿‡SQL  insert, delete or update</li>
<li>æ¡ä»¶ Condition:SQL è°“è¯</li>
<li>æ“ä½œ Action:SQL è¯­å¥åºåˆ—ï¼ˆæˆ–æ‰©å±•SQLï¼Œå¦‚Oracleä¸­çš„PL&#x2F;SQLï¼‰</li>
<li>å…³ç³»æ¨¡å‹ä¸­çš„è§¦å‘å™¨å¯ä»¥åœ¨ä¸¤ä¸ªçº§åˆ«ä¸Šå·¥ä½œ<ul>
<li>è¡Œçº§åˆ«ï¼šé’ˆå¯¹æ“ä½œä¸­çš„æ¯ä¸ªå…ƒç»„å‘ç”Ÿ</li>
<li>è¯­å¥çº§åˆ«ï¼šæ¯ä¸ªSQLåªå‘ç”Ÿä¸€æ¬¡</li>
</ul>
</li>
<li>è§¦å‘å™¨å¯ä»¥æœ‰ä¸¤ç§ç±»å‹çš„åŠŸèƒ½<ul>
<li>ç«‹å³ï¼šåœ¨äº‹ä»¶ä¹‹å‰æˆ–ä¹‹åç«‹å³å®Œæˆ</li>
<li>å»¶è¿Ÿï¼šåœ¨æäº¤å‘½ä»¤åå®Œæˆ</li>
</ul>
</li>
</ul>
<p>[3] Create Triggerè¯­æ³•</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> trigger_name &#123; BEFORE <span class="operator">|</span> AFTER &#125;</span><br><span class="line">    &#123; <span class="keyword">INSERT</span> <span class="operator">|</span> <span class="keyword">DELETE</span> <span class="operator">|</span> <span class="keyword">UPDATE</span> [<span class="keyword">OF</span> columnname &#123;,columnnameâ€¦&#125;]&#125;</span><br><span class="line">    <span class="keyword">ON</span> tablename [<span class="keyword">REFERENCING</span> corr_name_def &#123;,corr_name<span class="operator">-</span>defâ€¦&#125;]</span><br><span class="line">    [<span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span> <span class="operator">|</span> <span class="keyword">FOR</span> <span class="keyword">EACH</span> STATEMENT]</span><br><span class="line">    [<span class="keyword">WHEN</span> (<span class="keyword">search</span><span class="operator">-</span><span class="keyword">condition</span>)]</span><br><span class="line">    statement <span class="comment">-- (single action)</span></span><br><span class="line">    <span class="operator">|</span> <span class="keyword">BEGIN</span> statement; &#123;statement;â€¦&#125; <span class="keyword">END</span> <span class="comment">-- (multiple actions)</span></span><br></pre></td></tr></table></figure>

<p>[6] Example  Use an ORACLE trigger to check the DISCNT value of a new customers does not exceed 15.0 (ä½¿ç”¨ORACLEè§¦å‘å™¨æ£€æŸ¥æ–°å®¢æˆ·çš„DISCNTå€¼æ˜¯å¦è¶…è¿‡15.0)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> discnt_max AFTER <span class="keyword">INSERT</span> <span class="keyword">ON</span> customers</span><br><span class="line">    <span class="keyword">REFERENCING</span> <span class="keyword">new</span> <span class="keyword">as</span> x <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line">    <span class="keyword">WHEN</span> (x.discnt <span class="operator">&gt;</span> <span class="number">15.0</span>)</span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">    raise_error(<span class="number">-20003</span>, â€œ invalid discount <span class="keyword">on</span> <span class="keyword">insert</span> â€ );</span><br><span class="line">    <span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

<p>[4] Drop Trigger åˆ é™¤è§¦å‘å™¨</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TRIGGER</span> trigger_name;</span><br></pre></td></tr></table></figure>

<p>[5] Trigger executed è§¦å‘å™¨çš„æ‰§è¡Œæ—¶é—´ï¼šåœ¨ä»¥ä¸‹æ“ä½œçš„ä¹‹å‰æˆ–è€…ä¹‹å</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="keyword">INSERT</span> <span class="operator">|</span> <span class="keyword">DELETE</span> <span class="operator">|</span> <span class="keyword">UPDATE</span> [<span class="keyword">of</span> colname &#123;, colname . . .&#125;]&#125; </span><br></pre></td></tr></table></figure>

<p>[7] Exampleï¼š use trigger to implement a referential integrity policy â€œon delete, set null in the customers-orders foreign keyâ€ ä½¿ç”¨è§¦å‘å™¨å®ç°å¼•ç”¨å®Œæ•´æ€§ç­–ç•¥ï¼Œåˆ é™¤æ—¶ï¼Œåœ¨å®¢æˆ·è®¢å•å¤–é”®ä¸­è®¾ç½®nullâ€</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> foreign_cid AFTER <span class="keyword">DELETE</span> <span class="keyword">on</span> customers</span><br><span class="line">    <span class="keyword">REFERENCING</span> <span class="keyword">old</span> <span class="keyword">as</span> ocust <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">update</span> orders <span class="keyword">set</span> cid <span class="operator">=</span> <span class="keyword">null</span> <span class="keyword">where</span> cid <span class="operator">=</span> ocust.cid;</span><br><span class="line">    <span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

<p>[8] Example:ï¼ˆä¿è¯äº‹åŠ¡ä¸€è‡´æ€§ï¼‰è¿™é‡Œå°†å®ç°ä¸€ä¸ªâ€œline_itemsâ€è¡¨ï¼Œé€šè¿‡è§¦å‘å™¨  å¯¹æ¯ä¸ªè®¢å•è¿›è¡Œè®¡æ•°ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221202113713851.png" alt="image-20221202113713851"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Create</span> <span class="keyword">trigger</span> incordern_items after <span class="keyword">insert</span> <span class="keyword">on</span> Orders</span><br><span class="line">    <span class="keyword">referencing</span> <span class="keyword">new</span> <span class="keyword">as</span> nil <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">update</span> Line_items <span class="keyword">set</span> lineno <span class="operator">=</span> lineno<span class="operator">+</span><span class="number">1</span></span><br><span class="line">    <span class="keyword">where</span> ordno <span class="operator">=</span> nli.ordno;</span><br><span class="line">    <span class="keyword">end</span>;</span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">trigger</span> decordern_items after <span class="keyword">delete</span> <span class="keyword">on</span> Orders</span><br><span class="line">    <span class="keyword">referencing</span> <span class="keyword">old</span> <span class="keyword">as</span> oldli <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">update</span> Line_items <span class="keyword">set</span> lineno <span class="operator">=</span> lineno<span class="number">-1</span></span><br><span class="line">    <span class="keyword">where</span> ordno <span class="operator">=</span> :ldli.ordno;</span><br><span class="line">    <span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>

<p>[8] Example: Consider two tables </p>
<p>è¡¨ Warehouse (Part, QtyAvbl, QtyLimit, QtyReOrd)äº§å“åº“å­˜(é›¶ä»¶å·ï¼Œåº“å­˜é‡ï¼Œåº“å­˜ä¸‹é™ï¼Œé‡‡è´­å•å·) </p>
<p>è¡¨ PendingOrders (Part, QtyReOrd, OrderDate) é‡‡è´­è®¢å•(é›¶ä»¶å·ï¼Œé‡‡è´­å•å·ï¼Œè®¢å•æ—¥æœŸ)</p>
<p>â—¼ event: update of QtyAvbl in Warehouse </p>
<p>â—¼ condition: new available quantity is less than the (new) quantity new.QtyAvbl &lt; old.QtyLimit (ä½äºåº“å­˜ä¸‹é™) </p>
<p>â—¼ action: if there is no pending order for the part, issue a new order </p>
<p>insert into PendingOrders values (new.part, new.QtyReOrd, sysdate) (ä¸ºè¡¥åº“å­˜ï¼Œè‡ªåŠ¨ç”Ÿæˆé‡‡è´­å•)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> replace <span class="keyword">trigger</span> Reorder</span><br><span class="line">    after <span class="keyword">update</span> <span class="keyword">of</span> QtyAvbl <span class="keyword">on</span> Warehouse <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span></span><br><span class="line">    <span class="keyword">when</span> (new.QtyAvbl <span class="operator">&lt;</span> old.QtyLimit)</span><br><span class="line">    <span class="keyword">declare</span> X <span class="type">integer</span>;</span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">    <span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">into</span> X <span class="keyword">from</span> PendingOrders <span class="keyword">where</span> Part <span class="operator">=</span> new.Part;</span><br><span class="line">    if X <span class="operator">=</span> <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">    <span class="keyword">insert</span> <span class="keyword">into</span> PendingOrders <span class="keyword">values</span> (new.Part, new.QtyReOrd, sysdate);</span><br><span class="line">    <span class="keyword">end</span> if;</span><br></pre></td></tr></table></figure>



<h4 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h4><ol>
<li><p>Three types of Integrity Constrains ä¸‰ç§å®Œæ•´æ€§</p>
<p>(1) Integrity of Entity (å®ä½“å®Œæ•´æ€§) </p>
<p>(2) Referential Integrity between Entities (å®ä½“é—´çš„å‚ç…§å®Œæ•´æ€§) </p>
<p>(3) Integrity definition by User (ç”¨æˆ·è‡ªå®šä¹‰å®Œæ•´æ€§) </p>
</li>
<li><p>Two ways to realize the Referential Integrity ä¸¤ç§æ–¹æ³•å®ç°å‚ç…§ç‰©å®Œæ•´æ€§</p>
<p>(1) Using a Foreign Key å¤–é”®</p>
<p>(2) Using a Trigger è§¦å‘å™¨</p>
</li>
<li><p>SQL Procedure â€œStorage Procedureâ€ï¼ˆå­˜å‚¨å™¨è¿‡ç¨‹ï¼‰ Can realize a PROCEDUREï¼ˆç¨‹åºï¼‰ or FUNCTIONï¼ˆåŠŸèƒ½ï¼‰</p>
</li>
</ol>
<h3 id="2ã€è§†å›¾-View"><a href="#2ã€è§†å›¾-View" class="headerlink" title="2ã€è§†å›¾ View"></a>2ã€è§†å›¾ View</h3><h4 id="æ¦‚å¿µ-2"><a href="#æ¦‚å¿µ-2" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><p>[1] åŸºæœ¬è¡¨</p>
<ol>
<li>ç”±Create Tableåˆ›å»º	</li>
<li>å­˜å‚¨åœ¨ç£ç›˜ä¸Š</li>
</ol>
<p>[2] è§†å›¾ï¼ˆè™šè¡¨ï¼‰</p>
<ol>
<li>è§†å›¾æ˜¯å­æŸ¥è¯¢çš„ç»“æœ ï¼Œå®ƒæ˜¯ä¸€ä¸ªè™šæ‹Ÿè¡¨ï¼Œå…¶ä¸­æ²¡æœ‰æ•°æ®å­˜å‚¨ã€‚</li>
<li>è§†å›¾æœ‰è‡ªå·±çš„åç§°ï¼Œå¯ä»¥å°†å…¶è§†ä¸ºåŸºè¡¨ã€‚</li>
</ol>
<p>[3] Create View è¯­æ³•</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> <span class="operator">&lt;</span>è§†å›¾å<span class="operator">&gt;</span> [(<span class="operator">&lt;</span>åˆ—å<span class="operator">&gt;</span> &#123;,<span class="operator">&lt;</span>åˆ—å<span class="operator">&gt;</span>â€¦&#125;)]</span><br><span class="line">	<span class="keyword">AS</span> <span class="operator">&lt;</span>å­æŸ¥è¯¢<span class="operator">&gt;</span> [<span class="keyword">WITH</span> <span class="keyword">CHECK</span> OPTION];</span><br></pre></td></tr></table></figure>

<p>WITH CHECK OPTIONå°†ä¸å…è®¸æŒ‰è§†å›¾è¿›è¡Œupdate or insert</p>
<p>å­æŸ¥è¯¢ is defined as Select, allow UNION, not allow ORDER BY</p>
<p>[4] Example 1. Create a view â€œagentordersâ€ that extends the rows of â€œordersâ€ table to include all information about the agent taking the order.</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../images/%E6%95%B0%E6%8D%AE%E5%BA%93/image-20221202114943580.png" alt="image-20221202114943580"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Create</span> <span class="keyword">view</span> agentorders (ordno, <span class="keyword">month</span>, cid, aid, pid, qty, charge,aname, acity, <span class="keyword">percent</span>) </span><br><span class="line">    <span class="keyword">as</span> <span class="keyword">select</span> o.ordno, o.month, o.cid, o.aid, o.pid, o.qty, o.dollars,a.aname, a.city, a.percent 	 <span class="keyword">from</span> orders o, agents a</span><br><span class="line">    <span class="keyword">where</span> o.aid <span class="operator">=</span> a.aid;</span><br></pre></td></tr></table></figure>

<p>[5] Example 2. Create a view â€œacordersâ€ that gives all order information and names of the agent and customers involved in order</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> acorders (ordno, <span class="keyword">month</span>, cid, aid, pid, qty, dollars, aname, cname)</span><br><span class="line">    <span class="keyword">as</span> <span class="keyword">select</span> ordno, <span class="keyword">month</span>, ao.cid <span class="keyword">as</span> cid, aid, pid, qty, charge, aname, cname</span><br><span class="line">    <span class="keyword">from</span> agentorders ao, customers c </span><br><span class="line">    <span class="keyword">where</span> ao.cid <span class="operator">=</span> c.cid;</span><br></pre></td></tr></table></figure>

<p>[6] Example 3. Create a view â€œcactiesâ€ that lists all pairs of cities from â€œcustomersâ€ and â€œagentsâ€ tables, where the agent places an order for the customer.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> cacties (ccity, acity) </span><br><span class="line">    <span class="keyword">as</span> <span class="keyword">select</span> c.city, a.city <span class="keyword">from</span> customer c, orders o, agents a</span><br><span class="line">    <span class="keyword">where</span> c.cid <span class="operator">=</span> o.cid <span class="keyword">and</span> o.aid <span class="operator">=</span> a.aid;</span><br></pre></td></tr></table></figure>

<p>[7] Dropping Tables and Views åˆ é™¤è¡¨å’Œè§†å›¾</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> &#123;<span class="keyword">TABLE</span> è¡¨å <span class="operator">|</span> <span class="keyword">VIEW</span> è§†å›¾å&#125; &#123;CASCADE <span class="operator">|</span> RESTRICT&#125;;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœè¯¥è§†å›¾è¿˜é“å‡ºäº†å…¶ä»–è¯•å›¾ï¼Œåˆ™ä½¿ç”¨CASCADEçº§è”åˆ é™¤æŠŠè¯¥è§†å›¾å’Œç”±ä»–å¯¼å‡ºçš„è§†å›¾ä¸€èµ·åˆ é™¤ã€‚</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> t1</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> v1 </span><br><span class="line"># å¦‚æœæœ‰ä»v1å¯¼å‡ºçš„è§†å›¾ åˆ™çº§è”åˆ é™¤</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> v1 CASCADE</span><br></pre></td></tr></table></figure>

<p>Only â€œTable or View Ownerâ€ can authorized(æœ‰æƒæˆ–æˆæƒ) to drop it </p>
<h4 id="å¯æ›´æ–°è§†å›¾å’Œåªè¯»è§†å›¾"><a href="#å¯æ›´æ–°è§†å›¾å’Œåªè¯»è§†å›¾" class="headerlink" title="å¯æ›´æ–°è§†å›¾å’Œåªè¯»è§†å›¾"></a>å¯æ›´æ–°è§†å›¾å’Œåªè¯»è§†å›¾</h4><ol>
<li><p>åŸºæœ¬è¡¨ä¸­çš„æ•°æ®éƒ½æ˜¯å¯æ›´æ–°çš„ã€‚</p>
</li>
<li><p>æŸäº›è§†å›¾ä¸­çš„æ•°æ®æ— æ³•æ›´æ–°ã€‚å› ä¸ºä¸æ¸…æ¥šå¦‚ä½•è½¬æ¢ä¸ºåŸºè¡¨çš„å”¯ä¸€æ›´æ–°ã€‚</p>
</li>
<li><p>è¦ä½¿è§†å›¾å¯æ›´æ–°ï¼Œè§†å›¾å®šä¹‰ä¸­å¿…é¡»æœ‰ä»¥ä¸‹é™åˆ¶</p>
<ol>
<li>FROMå­å¥å¿…é¡»æœ‰ä¸€ä¸ªè¡¨ï¼ˆå¦‚æœæ˜¯è§†å›¾ï¼Œåˆ™å¯æ›´æ–°ï¼‰ã€‚</li>
<li>GROUP BYæˆ–HAVINGå­å¥éƒ½ä¸å­˜åœ¨ã€‚</li>
<li>æœªæŒ‡å®šDISTINCTå…³é”®å­—ã€‚</li>
<li>WHEREå­å¥æ²¡æœ‰å¼•ç”¨FROMå­å¥ä¸­çš„è¡¨çš„å­æŸ¥è¯¢ã€‚</li>
<li>ç»“æœåˆ—å¾ˆç®€å•ï¼šæ²¡æœ‰è¡¨è¾¾å¼ï¼Œæ²¡æœ‰åˆ—åã€‚</li>
</ol>
</li>
</ol>
<p><strong>å¯¹è§†å›¾çš„æ›´æ–°æœ€ç»ˆéƒ½è¦è½¬åˆ°å¯¹åŸºæœ¬è¡¨çš„æ›´æ–°</strong></p>
<h4 id="è§†å›¾çš„åŠŸèƒ½"><a href="#è§†å›¾çš„åŠŸèƒ½" class="headerlink" title="è§†å›¾çš„åŠŸèƒ½"></a>è§†å›¾çš„åŠŸèƒ½</h4><ol>
<li>è§†å›¾ä¸ºæ™®é€šç”¨æˆ·æä¾›äº†ä¸€ç§ç®€åŒ–æŸ¥è¯¢çš„æ–¹æ³•ã€‚</li>
<li>å¯ä»¥é€šè¿‡å…¶è§†å›¾é™åˆ¶ç”¨æˆ·è®¿é—®åŸºè¡¨çš„ç‰¹å®šåˆ—ã€‚è¿™å°†ä¸ºåŸºè¡¨æ·»åŠ å®‰å…¨æ€§ã€‚</li>
<li>è§†å›¾ä¿æŒé™ˆæ—§è¿‡æ—¶(ä½œåºŸçš„) å¼•ç”¨å®ƒä»¬çš„è¡¨å’Œç¨‹åºå°†ç»§ç»­å·¥ä½œã€‚</li>
</ol>
<h3 id="3ã€å®‰å…¨æ€§"><a href="#3ã€å®‰å…¨æ€§" class="headerlink" title="3ã€å®‰å…¨æ€§"></a>3ã€å®‰å…¨æ€§</h3><h4 id="æ¦‚å¿µ-3"><a href="#æ¦‚å¿µ-3" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><ol>
<li><p>æ•°æ®åº“çš„å®‰å…¨æ€§æ˜¯ä¿æŠ¤æ•°æ®åº“é˜²æ­¢ä¸åˆæ³•ä½¿ç”¨æ‰€é€ æˆçš„æ•°æ®æ³„éœ²ã€æ›´æ”¹å’Œç ´åã€‚</p>
</li>
<li><p>æ•°æ®åº“çš„ä¸å®‰å…¨å› ç´ </p>
<ol>
<li>éæˆæƒç”¨æˆ·å¯¹æ•°æ®åº“çš„æ¶æ„å­˜å–å’Œç ´å</li>
<li>æ•°æ®åº“ä¸­é‡è¦æˆ–æ•æ„Ÿçš„æ•°æ®è¢«æ³„éœ²</li>
<li>å®‰å…¨ç¯å¢ƒçš„è„†å¼±æ€§</li>
</ol>
</li>
</ol>
<p>[3] ç”¨æˆ·èº«ä»½çš„é‰´åˆ«</p>
<ol>
<li>é™æ€å£ä»¤é‰´åˆ«ï¼ˆå¯†ç ï¼‰</li>
<li>åŠ¨æ€å£ä»¤çš„é‰´åˆ«ï¼ˆéªŒè¯ç ï¼‰</li>
<li>ç”Ÿç‰©ç‰¹å¾é‰´åˆ«</li>
<li>æ™ºèƒ½å¡é‰´åˆ«</li>
</ol>
<h4 id="æ•°æ®åº“çš„å®‰å…¨æ€§æ§åˆ¶"><a href="#æ•°æ®åº“çš„å®‰å…¨æ€§æ§åˆ¶" class="headerlink" title="æ•°æ®åº“çš„å®‰å…¨æ€§æ§åˆ¶"></a>æ•°æ®åº“çš„å®‰å…¨æ€§æ§åˆ¶</h4><p>[1] The GRANT è¯­æ³•</p>
<blockquote>
<p>ä½œç”¨ï¼šç”±è¡¨&#x2F;è§†å›¾è¡¨çš„æ‰€æœ‰è€…å‘å¸ƒï¼Œä»¥å‘å…¶ä»–ç”¨æˆ·æˆæƒå¤šç§è®¿é—®æƒé™</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> &#123; <span class="keyword">ALL</span> PRIVILEGES <span class="operator">|</span> <span class="operator">&lt;</span>æƒé™<span class="operator">&gt;</span> &#123;, <span class="operator">&lt;</span>æƒé™<span class="operator">&gt;</span>â€¦&#125;&#125;</span><br><span class="line"><span class="keyword">ON</span> [<span class="keyword">TABLE</span>] tablename <span class="operator">|</span> viewname</span><br><span class="line"><span class="keyword">TO</span> &#123;PUBLIC <span class="operator">|</span> <span class="keyword">user</span><span class="operator">-</span>name &#123;,<span class="keyword">user</span><span class="operator">-</span>nameâ€¦&#125;&#125; [<span class="keyword">WITH</span> <span class="keyword">GRANT</span> OPTION]</span><br></pre></td></tr></table></figure>

<p>â¢ WITH GRANT OPTIONâ€”â€”ç”¨æˆ·å¯ä»¥æˆäºˆå…¶ä»–ç”¨æˆ·ç›¸åŒçš„æƒé™<br>â¢ è¡¨çš„æ‰€æœ‰è€…è‡ªåŠ¨æ‹¥æœ‰æ‰€æœ‰æƒé™ï¼Œå¹¶ä¸”ä¸èƒ½è¢«æ’¤é”€</p>
<p>[2] æ‰€æœ‰ç±»å‹çš„è®¿é—®æƒé™</p>
<p>SELECT, DELETE, INSERT, UPDATE [(colname {, colname})], </p>
<p>REFERENCES [(colname {, colname})] (this privilege grants the right to reference the specified columns from a foreign key)</p>
<p>[3] Example1. Grant select, update, insert , but not to delete to â€œtomâ€ on table orders. Then give â€œtomâ€ authorization for all operations on products.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">select</span>, <span class="keyword">update</span>, <span class="keyword">insert</span> <span class="keyword">ON</span> orders <span class="keyword">to</span> tom;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">all</span> privileges <span class="keyword">ON</span> products <span class="keyword">to</span> tom;</span><br></pre></td></tr></table></figure>

<p>[4] Example2. Grant permission to user â€œtomâ€ on customers table to insert, delete any row, update only the â€œcnameâ€ and â€œcityâ€ columns, and select all columns other than the â€œdistinctâ€ column.</p>
<p>(1) The owner first creates a view. </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> cview <span class="keyword">as</span> <span class="keyword">select</span> cid, cname ,city <span class="keyword">from</span> customers;</span><br></pre></td></tr></table></figure>

<p>(2) Then the owner provides the necessary authorization:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grant</span> <span class="keyword">select</span>, <span class="keyword">delete</span>, <span class="keyword">insert</span>, <span class="keyword">update</span> (cname, city) <span class="keyword">on</span> cview <span class="keyword">to</span> tom;</span><br></pre></td></tr></table></figure>

<p>[5] Example3. Grant permission to user â€œtomâ€ to perform all accesses on agents with percent greater than 5.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Create</span> <span class="keyword">view</span> agentv <span class="keyword">as</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> agents <span class="keyword">where</span> <span class="keyword">percent</span> <span class="operator">&gt;</span> <span class="number">5</span>;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">all</span> privileges <span class="keyword">on</span> agentv <span class="keyword">to</span> tom;</span><br></pre></td></tr></table></figure>

<p>[6] REVOKE è¯­æ³•</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">REVOKE</span> &#123;<span class="keyword">ALL</span> PRIVILEGES <span class="operator">|</span> priv &#123;, privâ€¦&#125;&#125; <span class="keyword">on</span> tablename <span class="operator">|</span> viewname</span><br><span class="line"><span class="keyword">FROM</span> &#123; PUBLIC <span class="operator">|</span> <span class="keyword">user</span> &#123;, <span class="keyword">user</span>â€¦&#125; &#125; [CASCADE <span class="operator">|</span>RESTRICT];</span><br></pre></td></tr></table></figure>

<p>â¢ CASCADEâ€”â€”-ç”¨æˆ·æˆäºˆçš„ç‰¹æƒå’Œæƒé™éƒ½å°†è¢«åˆ é™¤ã€‚<br>â¢ RESTRICTâ€”â€”ç”¨æˆ·çš„ç‰¹æƒè¢«åˆ é™¤ï¼Œä»–æˆäºˆå…¶ä»–ç”¨æˆ·çš„ç‰¹æƒä¸è¢«åˆ é™¤ã€‚</p>
<p>Example:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">revoke</span> <span class="keyword">all</span> privileges <span class="keyword">on</span> agent <span class="keyword">from</span> tom restrict;</span><br></pre></td></tr></table></figure>



<h2 id="ä¸ƒã€ç´¢å¼•ï¼ˆIndexingï¼‰"><a href="#ä¸ƒã€ç´¢å¼•ï¼ˆIndexingï¼‰" class="headerlink" title="ä¸ƒã€ç´¢å¼•ï¼ˆIndexingï¼‰"></a>ä¸ƒã€ç´¢å¼•ï¼ˆIndexingï¼‰</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># åˆ›å»ºç´¢å¼•</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> testalter_tbl <span class="keyword">ADD</span> INDEX (c);</span><br><span class="line"># åˆ é™¤ç´¢å¼•</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> testalter_tbl <span class="keyword">DROP</span> INDEX (c);</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="http://www.haungrd.top">Huang RD</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://www.haungrd.top/2023/02/15/%E6%95%B0%E6%8D%AE%E5%BA%93/">http://www.haungrd.top/2023/02/15/%E6%95%B0%E6%8D%AE%E5%BA%93/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://www.haungrd.top" target="_blank">Huang Blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">æ•°æ®åº“</a></div><div class="post_share"><div class="social-share" data-image="https://www.huangrd.top/images/agentina/7.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/02/17/JUC/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://www.huangrd.top/images/agentina/8.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">JUC</div></div></a></div><div class="next-post pull-right"><a href="/2023/02/13/java%E9%9B%86%E5%90%88%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://www.huangrd.top/images/agentina/7.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">Java é›†åˆæºç åˆ†æ</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/2022/11/20/MySQL/" title="Mysql"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://www.huangrd.top/images/agentina/13.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-20</div><div class="title">Mysql</div></div></a></div><div><a href="/2023/02/06/Mysql%E5%88%B7%E9%A2%98%E6%80%BB%E7%BB%93/" title="MYSQLåˆ·é¢˜æ€»ç»“"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://www.huangrd.top/images/agentina/12.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-02-06</div><div class="title">MYSQLåˆ·é¢˜æ€»ç»“</div></div></a></div><div><a href="/2023/03/17/MySQL%E5%A4%8D%E4%B9%A0%E6%8F%90%E5%8D%87/" title="Mysql å¤ä¹ æå‡"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://www.huangrd.top/images/agentina/2.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-17</div><div class="title">Mysql å¤ä¹ æå‡</div></div></a></div><div><a href="/2023/03/03/Redis%E5%A4%8D%E4%B9%A0%E6%8F%90%E5%8D%87/" title="Redis å¤ä¹ æå‡"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://www.huangrd.top/images/agentina/5.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-03</div><div class="title">Redis å¤ä¹ æå‡</div></div></a></div><div><a href="/2023/02/11/mysql45%E8%AE%B2%E7%AC%94%E8%AE%B0/" title="Mysql 45è®²ç¬”è®°"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://www.huangrd.top/images/agentina/7.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-02-11</div><div class="title">Mysql 45è®²ç¬”è®°</div></div></a></div><div><a href="/2023/02/27/%E9%9D%A2%E8%AF%95%E9%A2%98%E6%95%B4%E7%90%86/" title="é¢è¯•é¢˜æ•´ç†"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://www.huangrd.top/images/agentina/13.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-02-27</div><div class="title">é¢è¯•é¢˜æ•´ç†</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%BB%E7%BB%93"><span class="toc-text">æ•°æ®åº“æ€»ç»“</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B4%E4%BD%93%E6%A6%82%E8%BF%B0"><span class="toc-text">æ•´ä½“æ¦‚è¿°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E7%BB%AA%E8%AE%BA%EF%BC%88Introduction%EF%BC%89"><span class="toc-text">ä¸€ã€ç»ªè®ºï¼ˆIntroductionï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-text">1ã€æ•°æ®åº“åŸºæœ¬æ¦‚å¿µ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E7%94%A8%E6%88%B7"><span class="toc-text">2ã€æ•°æ®åº“ç”¨æˆ·</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A6%82%E8%A7%88"><span class="toc-text">3ã€å…³ç³»æ•°æ®åº“æ¦‚è§ˆ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93-%EF%BC%88The-Relational-Model%EF%BC%89"><span class="toc-text">äºŒã€å…³ç³»æ•°æ®åº“ ï¼ˆThe Relational Modelï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81-CAP-%E5%AE%9E%E4%BE%8B%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">1ã€ CAP å®ä¾‹æ•°æ®åº“</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E7%BB%84%E6%88%90"><span class="toc-text">2ã€æ•°æ®åº“ç³»ç»Ÿç»„æˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%85%B3%E7%B3%BB%E8%A7%84%E5%88%99"><span class="toc-text">3ã€å…³ç³»è§„åˆ™</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E9%94%AE%E3%80%81%E8%B6%85%E9%94%AE%E5%8F%8A%E7%A9%BA%E5%80%BC"><span class="toc-text">4ã€é”®ã€è¶…é”®åŠç©ºå€¼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0"><span class="toc-text">5ã€å…³ç³»ä»£æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81%E9%9B%86%E5%90%88%E8%AE%BA%E6%93%8D%E4%BD%9C"><span class="toc-text">6ã€é›†åˆè®ºæ“ä½œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7%E3%80%81%E4%BC%A0%E7%BB%9F%E5%85%B3%E7%B3%BB%E6%93%8D%E4%BD%9C"><span class="toc-text">7ã€ä¼ ç»Ÿå…³ç³»æ“ä½œ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8%E3%80%81%E5%85%B3%E7%B3%BB%E6%93%8D%E4%BD%9C%E5%AE%9E%E4%BE%8B"><span class="toc-text">8ã€å…³ç³»æ“ä½œå®ä¾‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A0%87%E5%87%86%E8%AF%AD%E8%A8%80SQL%EF%BC%88Basic-SQL-Query-Language%EF%BC%89"><span class="toc-text">ä¸‰ã€å…³ç³»æ•°æ®åº“æ ‡å‡†è¯­è¨€SQLï¼ˆBasic SQL Query Languageï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81SQL-%E8%AF%AD%E8%A8%80%E6%A6%82%E8%BF%B0"><span class="toc-text">1ã€SQL è¯­è¨€æ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL%E7%9A%84%E5%88%86%E7%B1%BB%E5%92%8C%E5%8A%9F%E8%83%BD%EF%BC%9A"><span class="toc-text">SQLçš„åˆ†ç±»å’ŒåŠŸèƒ½ï¼š</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E5%BB%BA%E7%AB%8B%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">2ã€å»ºç«‹æ•°æ®åº“</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%84%E5%85%88%E7%9F%A5%E8%AF%86%EF%BC%9A"><span class="toc-text">é¢„å…ˆçŸ¥è¯†ï¼š</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CREATE-TABLE-%E8%AF%AD%E5%8F%A5"><span class="toc-text">CREATE TABLE è¯­å¥</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E7%AE%80%E5%8D%95-Select-%E5%8F%A5"><span class="toc-text">3ã€ç®€å• Select å¥</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#SELECT-%E8%AF%AD%E6%B3%95"><span class="toc-text">SELECT è¯­æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98%EF%BC%9A"><span class="toc-text">ä¾‹é¢˜ï¼š</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E5%AD%90%E6%9F%A5%E8%AF%A2%E3%80%81%E8%B0%93%E8%AF%8D"><span class="toc-text">4ã€å­æŸ¥è¯¢ã€è°“è¯</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-text">å­æŸ¥è¯¢</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5"><span class="toc-text">æ¦‚å¿µ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Summary"><span class="toc-text">Summary</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Quantified-Comparison-Predicate-%E9%87%8F%E5%8C%96%E6%AF%94%E8%BE%83%E8%B0%93%E8%AF%8D"><span class="toc-text">Quantified Comparison Predicate é‡åŒ–æ¯”è¾ƒè°“è¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AD%89%E6%95%88%E5%85%B3%E7%B3%BB%EF%BC%9A"><span class="toc-text">ç­‰æ•ˆå…³ç³»ï¼š</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EXISTS-%E8%B0%93%E8%AF%8D"><span class="toc-text">EXISTS è°“è¯</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81UNION-%E6%93%8D%E4%BD%9C%E5%8F%8A-ALL-%E6%9D%A1%E4%BB%B6"><span class="toc-text">5ã€UNION æ“ä½œåŠ ALL æ¡ä»¶</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#UNION%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-text">UNIONè¿ç®—ç¬¦</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Division%E9%99%A4%E6%B3%95"><span class="toc-text">Divisioné™¤æ³•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81SQL-%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95"><span class="toc-text">6ã€SQL é«˜çº§è¯­æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#UNION%E3%80%81INTERSECT%E3%80%81EXCEPT"><span class="toc-text">UNIONã€INTERSECTã€EXCEPT</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JOIN-IN"><span class="toc-text">JOIN IN</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Outer-Join"><span class="toc-text">Outer Join</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7%E3%80%81%E9%9B%86%E5%87%BD%E6%95%B0"><span class="toc-text">7ã€é›†å‡½æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8%E3%80%81%E5%88%86%E7%BB%84GROUP"><span class="toc-text">8ã€åˆ†ç»„GROUP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#GROUP%E3%80%81HAVING%E8%AF%AD%E6%B3%95"><span class="toc-text">GROUPã€HAVINGè¯­æ³•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9%E3%80%81%E5%AE%8C%E6%95%B4-Select-%E5%8F%A5"><span class="toc-text">9ã€å®Œæ•´ Select å¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10%E3%80%81Insert%E3%80%81Update-%E5%92%8C-Delete-%E5%8F%A5"><span class="toc-text">10ã€Insertã€Update å’Œ Delete å¥</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#INSERT"><span class="toc-text">INSERT</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#UPDATE"><span class="toc-text">UPDATE</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#DELETE"><span class="toc-text">DELETE</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B%EF%BC%88Program-to-Access-a-Database%EF%BC%89"><span class="toc-text">å››ã€æ•°æ®åº“ç¼–ç¨‹ï¼ˆProgram to Access a Databaseï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%B5%8C%E5%85%A5%E5%BC%8F-SQL-C%E8%AF%AD%E8%A8%80-Embedded-SQL"><span class="toc-text">1ã€åµŒå…¥å¼ SQL(Cè¯­è¨€)Embedded SQL</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87%E7%A8%8B%E5%BA%8F%E8%AE%BF%E9%97%AE%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%EF%BC%9F"><span class="toc-text">å¦‚ä½•é€šè¿‡ç¨‹åºè®¿é—®æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Ÿ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E6%8C%89%E7%A8%8B%E5%BA%8F%E4%BD%BF%E7%94%A8%E6%95%B0%E6%8D%AE%EF%BC%9F"><span class="toc-text">å¦‚ä½•æŒ‰ç¨‹åºä½¿ç”¨æ•°æ®ï¼Ÿ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E5%B8%B8%E8%A7%81%E7%9A%84%E5%B5%8C%E5%85%A5%E5%BC%8FSQL%E8%AF%AD%E5%8F%A5"><span class="toc-text">2ã€å¸¸è§çš„åµŒå…¥å¼SQLè¯­å¥</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B5%8C%E5%85%A5%E5%BC%8F%E6%9F%A5%E8%AF%A2"><span class="toc-text">åµŒå…¥å¼æŸ¥è¯¢</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%88%A0%E9%99%A4"><span class="toc-text">åµŒå…¥å¼åˆ é™¤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B5%8C%E5%85%A5%E5%BC%8F%E6%9B%B4%E6%96%B0"><span class="toc-text">åµŒå…¥å¼æ›´æ–°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B5%8C%E5%85%A5%E5%BC%8F%E6%8F%92%E5%85%A5"><span class="toc-text">åµŒå…¥å¼æ’å…¥</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E5%B5%8C%E5%85%A5%E5%BC%8Fsql"><span class="toc-text">å…¶ä»–åµŒå…¥å¼sql</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%9D%A1%E4%BB%B6%E5%A4%84%E7%90%86"><span class="toc-text">3ã€æ¡ä»¶å¤„ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Whenever"><span class="toc-text">Whenever</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E4%B8%BB%E5%8F%98%E9%87%8F%E6%A3%80%E6%9F%A5%E9%94%99%E8%AF%AF"><span class="toc-text">é€šè¿‡ä¸»å˜é‡æ£€æŸ¥é”™è¯¯</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E4%BA%8B%E5%8A%A1%E7%BC%96%E7%A8%8BTransactions"><span class="toc-text">4ã€äº‹åŠ¡ç¼–ç¨‹Transactions</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1Transaction"><span class="toc-text">äº‹åŠ¡Transaction</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E6%8C%87%E5%AE%9A%E4%BA%8B%E5%8A%A1"><span class="toc-text">å¦‚ä½•æŒ‡å®šäº‹åŠ¡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Transaction-Isolation-and-Locking-%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E5%92%8C%E9%94%81"><span class="toc-text">Transaction Isolation and Locking äº‹åŠ¡éš”ç¦»å’Œé”</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AD%BB%E9%94%81"><span class="toc-text">æ­»é”</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E6%80%BB%E7%BB%93"><span class="toc-text">5ã€æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%EF%BC%88Database-Design%EF%BC%89"><span class="toc-text">äº”ã€æ•°æ®åº“è®¾è®¡ï¼ˆDatabase Designï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A5%E5%85%85%EF%BC%9A%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%AD%A5%E9%AA%A4"><span class="toc-text">è¡¥å……ï¼šæ•°æ®åº“è®¾è®¡çš„åŸºæœ¬æ­¥éª¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81E-R%E5%9B%BE"><span class="toc-text">1ã€E-Rå›¾</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BD%93%E3%80%81%E5%B1%9E%E6%80%A7%E3%80%81E-R%E5%9B%BE%EF%BC%88Entities-Attributes-E-R-Diagrams%EF%BC%89"><span class="toc-text">å®ä½“ã€å±æ€§ã€E-Rå›¾ï¼ˆEntities,Attributes,E-R Diagramsï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%86%E5%AE%9E%E4%BD%93%E5%92%8C%E5%B1%9E%E6%80%A7%E8%BD%AC%E6%8D%A2%E4%B8%BA%E5%85%B3%E7%B3%BB"><span class="toc-text">å°†å®ä½“å’Œå±æ€§è½¬æ¢ä¸ºå…³ç³»</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BD%93%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-text">å®ä½“ä¹‹é—´çš„å…³ç³»</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81E-R%E5%BB%BA%E6%A8%A1%E7%9A%84%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%BB%86%E8%8A%82"><span class="toc-text">2ã€E-Rå»ºæ¨¡çš„è¿›ä¸€æ­¥ç»†èŠ‚</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BD%93%E7%9A%84%E5%9F%BA%E6%95%B0-%E5%85%B3%E7%B3%BB%E7%9A%84%E5%9F%BA%E6%95%B0"><span class="toc-text">å®ä½“çš„åŸºæ•°(å…³ç³»çš„åŸºæ•°)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1%E3%80%81N-N%E3%80%811-N-Relationships"><span class="toc-text">1-1ã€N-Nã€1-N Relationships</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%86%E4%BA%8C%E5%85%83%E5%85%B3%E7%B3%BB%E8%BD%AC%E6%8D%A2%E4%B8%BA%E5%85%B3%E7%B3%BB-%E5%85%AD%E6%9D%A1%E8%BD%AC%E6%8D%A2%E8%A7%84%E5%88%99"><span class="toc-text">å°†äºŒå…ƒå…³ç³»è½¬æ¢ä¸ºå…³ç³»(å…­æ¡è½¬æ¢è§„åˆ™)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E8%8C%83%E5%BC%8F"><span class="toc-text">3ã€èŒƒå¼</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%AE%8C%E6%95%B4%E6%80%A7%E3%80%81%E5%AE%89%E5%85%A8%E6%80%A7%E3%80%81%E8%A7%86%E5%9B%BE%EF%BC%88Integrity-Views-Security%EF%BC%89"><span class="toc-text">å…­ã€æ•°æ®åº“çš„å®Œæ•´æ€§ã€å®‰å…¨æ€§ã€è§†å›¾ï¼ˆIntegrity,Views, Securityï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%AE%8C%E6%95%B4%E6%80%A7%E7%BA%A6%E6%9D%9F"><span class="toc-text">1ã€å®Œæ•´æ€§çº¦æŸ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5-1"><span class="toc-text">æ¦‚å¿µ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Create-Table%E8%AF%AD%E5%8F%A5%E4%B8%AD%E7%9A%84%E5%AE%8C%E6%95%B4%E6%80%A7%E7%BA%A6%E6%9D%9F"><span class="toc-text">Create Tableè¯­å¥ä¸­çš„å®Œæ•´æ€§çº¦æŸ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Primary-Keys-Foreign-Keys-Referent"><span class="toc-text">Primary-Keys, Foreign-Keys, Referent</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Alter-Table-Statement-%E6%9B%B4%E6%94%B9%E8%A1%A8%E5%A3%B0%E6%98%8E"><span class="toc-text">Alter Table Statement æ›´æ”¹è¡¨å£°æ˜</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Non-Procedural-x2F-Procedural-Integrity-Constraints-%E9%9D%9E%E7%A8%8B%E5%BA%8F-x2F-%E7%A8%8B%E5%BA%8F%E5%AE%8C%E6%95%B4%E6%80%A7%E7%BA%A6%E6%9D%9F"><span class="toc-text">Non-Procedural &#x2F; Procedural Integrity Constraints éç¨‹åº&#x2F;ç¨‹åºå®Œæ•´æ€§çº¦æŸ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8Triggers"><span class="toc-text">è§¦å‘å™¨Triggers</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%BB%E7%BB%93%EF%BC%9A"><span class="toc-text">æ€»ç»“ï¼š</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%A7%86%E5%9B%BE-View"><span class="toc-text">2ã€è§†å›¾ View</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5-2"><span class="toc-text">æ¦‚å¿µ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%AF%E6%9B%B4%E6%96%B0%E8%A7%86%E5%9B%BE%E5%92%8C%E5%8F%AA%E8%AF%BB%E8%A7%86%E5%9B%BE"><span class="toc-text">å¯æ›´æ–°è§†å›¾å’Œåªè¯»è§†å›¾</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="toc-text">è§†å›¾çš„åŠŸèƒ½</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%AE%89%E5%85%A8%E6%80%A7"><span class="toc-text">3ã€å®‰å…¨æ€§</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5-3"><span class="toc-text">æ¦‚å¿µ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%AE%89%E5%85%A8%E6%80%A7%E6%8E%A7%E5%88%B6"><span class="toc-text">æ•°æ®åº“çš„å®‰å…¨æ€§æ§åˆ¶</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E7%B4%A2%E5%BC%95%EF%BC%88Indexing%EF%BC%89"><span class="toc-text">ä¸ƒã€ç´¢å¼•ï¼ˆIndexingï¼‰</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2023 By Huang RD</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç®€</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="30" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>