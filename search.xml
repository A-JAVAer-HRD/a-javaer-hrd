<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Nettyå…¥é—¨</title>
      <link href="/2022/11/22/Netty02-%E5%85%A5%E9%97%A8/"/>
      <url>/2022/11/22/Netty02-%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="äºŒ-Netty-å…¥é—¨"><a href="#äºŒ-Netty-å…¥é—¨" class="headerlink" title="äºŒ. Netty å…¥é—¨"></a>äºŒ. Netty å…¥é—¨</h1><h2 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1. æ¦‚è¿°"></a>1. æ¦‚è¿°</h2><h3 id="1-1-Netty-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-1-Netty-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1.1 Netty æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1.1 Netty æ˜¯ä»€ä¹ˆï¼Ÿ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Netty is an asynchronous event-driven network application framework</span><br><span class="line">for rapid development of maintainable high performance protocol servers &amp; clients.</span><br></pre></td></tr></table></figure><p>Netty æ˜¯ä¸€ä¸ªå¼‚æ­¥çš„ã€åŸºäºäº‹ä»¶é©±åŠ¨çš„ç½‘ç»œåº”ç”¨æ¡†æ¶ï¼Œç”¨äºå¿«é€Ÿå¼€å‘å¯ç»´æŠ¤ã€é«˜æ€§èƒ½çš„ç½‘ç»œæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯</p><h3 id="1-2-Netty-çš„ä½œè€…"><a href="#1-2-Netty-çš„ä½œè€…" class="headerlink" title="1.2 Netty çš„ä½œè€…"></a>1.2 Netty çš„ä½œè€…</h3><p><img src="/img/0005.png"></p><p>ä»–è¿˜æ˜¯å¦ä¸€ä¸ªè‘—åç½‘ç»œåº”ç”¨æ¡†æ¶ Mina çš„é‡è¦è´¡çŒ®è€…</p><h3 id="1-3-Netty-çš„åœ°ä½"><a href="#1-3-Netty-çš„åœ°ä½" class="headerlink" title="1.3 Netty çš„åœ°ä½"></a>1.3 Netty çš„åœ°ä½</h3><p>Netty åœ¨ Java ç½‘ç»œåº”ç”¨æ¡†æ¶ä¸­çš„åœ°ä½å°±å¥½æ¯”ï¼šSpring æ¡†æ¶åœ¨ JavaEE å¼€å‘ä¸­çš„åœ°ä½</p><p>ä»¥ä¸‹çš„æ¡†æ¶éƒ½ä½¿ç”¨äº† Nettyï¼Œå› ä¸ºå®ƒä»¬æœ‰ç½‘ç»œé€šä¿¡éœ€æ±‚ï¼</p><ul><li>Cassandra - nosql æ•°æ®åº“</li><li>Spark - å¤§æ•°æ®åˆ†å¸ƒå¼è®¡ç®—æ¡†æ¶</li><li>Hadoop - å¤§æ•°æ®åˆ†å¸ƒå¼å­˜å‚¨æ¡†æ¶</li><li>RocketMQ - ali å¼€æºçš„æ¶ˆæ¯é˜Ÿåˆ—</li><li>ElasticSearch - æœç´¢å¼•æ“</li><li>gRPC - rpc æ¡†æ¶</li><li>Dubbo - rpc æ¡†æ¶</li><li>Spring 5.x - flux api å®Œå…¨æŠ›å¼ƒäº† tomcat ï¼Œä½¿ç”¨ netty ä½œä¸ºæœåŠ¡å™¨ç«¯</li><li>Zookeeper - åˆ†å¸ƒå¼åè°ƒæ¡†æ¶</li></ul><h3 id="1-4-Netty-çš„ä¼˜åŠ¿"><a href="#1-4-Netty-çš„ä¼˜åŠ¿" class="headerlink" title="1.4 Netty çš„ä¼˜åŠ¿"></a>1.4 Netty çš„ä¼˜åŠ¿</h3><ul><li>Netty vs NIOï¼Œå·¥ä½œé‡å¤§ï¼Œbug å¤š<ul><li>éœ€è¦è‡ªå·±æ„å»ºåè®®</li><li>è§£å†³ TCP ä¼ è¾“é—®é¢˜ï¼Œå¦‚ç²˜åŒ…ã€åŠåŒ…</li><li>epoll ç©ºè½®è¯¢å¯¼è‡´ CPU 100%</li><li>å¯¹ API è¿›è¡Œå¢å¼ºï¼Œä½¿ä¹‹æ›´æ˜“ç”¨ï¼Œå¦‚ FastThreadLocal &#x3D;&gt; ThreadLocalï¼ŒByteBuf &#x3D;&gt; ByteBuffer</li></ul></li><li>Netty vs å…¶å®ƒç½‘ç»œåº”ç”¨æ¡†æ¶<ul><li>Mina ç”± apache ç»´æŠ¤ï¼Œå°†æ¥ 3.x ç‰ˆæœ¬å¯èƒ½ä¼šæœ‰è¾ƒå¤§é‡æ„ï¼Œç ´å API å‘ä¸‹å…¼å®¹æ€§ï¼ŒNetty çš„å¼€å‘è¿­ä»£æ›´è¿…é€Ÿï¼ŒAPI æ›´ç®€æ´ã€æ–‡æ¡£æ›´ä¼˜ç§€</li><li>ä¹…ç»è€ƒéªŒï¼Œ16å¹´ï¼ŒNetty ç‰ˆæœ¬<ul><li>2.x 2004</li><li>3.x 2008</li><li>4.x 2013</li><li>5.x å·²åºŸå¼ƒï¼ˆæ²¡æœ‰æ˜æ˜¾çš„æ€§èƒ½æå‡ï¼Œç»´æŠ¤æˆæœ¬é«˜ï¼‰</li></ul></li></ul></li></ul><h2 id="2-Hello-World"><a href="#2-Hello-World" class="headerlink" title="2. Hello World"></a>2. Hello World</h2><h3 id="2-1-ç›®æ ‡"><a href="#2-1-ç›®æ ‡" class="headerlink" title="2.1 ç›®æ ‡"></a>2.1 ç›®æ ‡</h3><p>å¼€å‘ä¸€ä¸ªç®€å•çš„æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯</p><ul><li>å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘é€ hello, world</li><li>æœåŠ¡å™¨ä»…æ¥æ”¶ï¼Œä¸è¿”å›</li></ul><p>åŠ å…¥ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.netty<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>netty-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.1.39.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-2-æœåŠ¡å™¨ç«¯"><a href="#2-2-æœåŠ¡å™¨ç«¯" class="headerlink" title="2.2 æœåŠ¡å™¨ç«¯"></a>2.2 æœåŠ¡å™¨ç«¯</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">ServerBootstrap</span>()</span><br><span class="line">    .group(<span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>()) <span class="comment">// 1</span></span><br><span class="line">    .channel(NioServerSocketChannel.class) <span class="comment">// 2</span></span><br><span class="line">    .childHandler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;NioSocketChannel&gt;() &#123; <span class="comment">// 3</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(NioSocketChannel ch)</span> &#123;</span><br><span class="line">            ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">StringDecoder</span>()); <span class="comment">// 5</span></span><br><span class="line">            ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">SimpleChannelInboundHandler</span>&lt;String&gt;() &#123; <span class="comment">// 6</span></span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">channelRead0</span><span class="params">(ChannelHandlerContext ctx, String msg)</span> &#123;</span><br><span class="line">                    System.out.println(msg);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .bind(<span class="number">8080</span>); <span class="comment">// 4</span></span><br></pre></td></tr></table></figure><p>ä»£ç è§£è¯»</p><ul><li><p>1 å¤„ï¼Œåˆ›å»º NioEventLoopGroupï¼Œå¯ä»¥ç®€å•ç†è§£ä¸º <code>çº¿ç¨‹æ±  + Selector</code> åé¢ä¼šè¯¦ç»†å±•å¼€</p></li><li><p>2 å¤„ï¼Œé€‰æ‹©æœåŠ¡ Scoket å®ç°ç±»ï¼Œå…¶ä¸­ NioServerSocketChannel è¡¨ç¤ºåŸºäº NIO çš„æœåŠ¡å™¨ç«¯å®ç°ï¼Œå…¶å®ƒå®ç°è¿˜æœ‰</p><p><img src="/img/0006.png"></p></li><li><p>3 å¤„ï¼Œä¸ºå•¥æ–¹æ³•å« childHandlerï¼Œæ˜¯æ¥ä¸‹æ¥æ·»åŠ çš„å¤„ç†å™¨éƒ½æ˜¯ç»™ SocketChannel ç”¨çš„ï¼Œè€Œä¸æ˜¯ç»™ ServerSocketChannelã€‚ChannelInitializer å¤„ç†å™¨ï¼ˆä»…æ‰§è¡Œä¸€æ¬¡ï¼‰ï¼Œå®ƒçš„ä½œç”¨æ˜¯å¾…å®¢æˆ·ç«¯ SocketChannel å»ºç«‹è¿æ¥åï¼Œæ‰§è¡Œ initChannel ä»¥ä¾¿æ·»åŠ æ›´å¤šçš„å¤„ç†å™¨</p></li><li><p>4 å¤„ï¼ŒServerSocketChannel ç»‘å®šçš„ç›‘å¬ç«¯å£</p></li><li><p>5 å¤„ï¼ŒSocketChannel çš„å¤„ç†å™¨ï¼Œè§£ç  ByteBuf &#x3D;&gt; String</p></li><li><p>6 å¤„ï¼ŒSocketChannel çš„ä¸šåŠ¡å¤„ç†å™¨ï¼Œä½¿ç”¨ä¸Šä¸€ä¸ªå¤„ç†å™¨çš„å¤„ç†ç»“æœ</p></li></ul><h3 id="2-3-å®¢æˆ·ç«¯"><a href="#2-3-å®¢æˆ·ç«¯" class="headerlink" title="2.3 å®¢æˆ·ç«¯"></a>2.3 å®¢æˆ·ç«¯</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Bootstrap</span>()</span><br><span class="line">    .group(<span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>()) <span class="comment">// 1</span></span><br><span class="line">    .channel(NioSocketChannel.class) <span class="comment">// 2</span></span><br><span class="line">    .handler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;Channel&gt;() &#123; <span class="comment">// 3</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(Channel ch)</span> &#123;</span><br><span class="line">            ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">StringEncoder</span>()); <span class="comment">// 8</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .connect(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">8080</span>) <span class="comment">// 4</span></span><br><span class="line">    .sync() <span class="comment">// 5</span></span><br><span class="line">    .channel() <span class="comment">// 6</span></span><br><span class="line">    .writeAndFlush(<span class="keyword">new</span> <span class="title class_">Date</span>() + <span class="string">&quot;: hello world!&quot;</span>); <span class="comment">// 7</span></span><br></pre></td></tr></table></figure><p>ä»£ç è§£è¯»</p><ul><li><p>1 å¤„ï¼Œåˆ›å»º NioEventLoopGroupï¼ŒåŒ Server</p></li><li><p>2 å¤„ï¼Œé€‰æ‹©å®¢æˆ· Socket å®ç°ç±»ï¼ŒNioSocketChannel è¡¨ç¤ºåŸºäº NIO çš„å®¢æˆ·ç«¯å®ç°ï¼Œå…¶å®ƒå®ç°è¿˜æœ‰</p><p><img src="/img/0007.png"></p></li><li><p>3 å¤„ï¼Œæ·»åŠ  SocketChannel çš„å¤„ç†å™¨ï¼ŒChannelInitializer å¤„ç†å™¨ï¼ˆä»…æ‰§è¡Œä¸€æ¬¡ï¼‰ï¼Œå®ƒçš„ä½œç”¨æ˜¯å¾…å®¢æˆ·ç«¯ SocketChannel å»ºç«‹è¿æ¥åï¼Œæ‰§è¡Œ initChannel ä»¥ä¾¿æ·»åŠ æ›´å¤šçš„å¤„ç†å™¨</p></li><li><p>4 å¤„ï¼ŒæŒ‡å®šè¦è¿æ¥çš„æœåŠ¡å™¨å’Œç«¯å£</p></li><li><p>5 å¤„ï¼ŒNetty ä¸­å¾ˆå¤šæ–¹æ³•éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œå¦‚ connectï¼Œè¿™æ—¶éœ€è¦ä½¿ç”¨ sync æ–¹æ³•ç­‰å¾… connect å»ºç«‹è¿æ¥å®Œæ¯•</p></li><li><p>6 å¤„ï¼Œè·å– channel å¯¹è±¡ï¼Œå®ƒå³ä¸ºé€šé“æŠ½è±¡ï¼Œå¯ä»¥è¿›è¡Œæ•°æ®è¯»å†™æ“ä½œ</p></li><li><p>7 å¤„ï¼Œå†™å…¥æ¶ˆæ¯å¹¶æ¸…ç©ºç¼“å†²åŒº</p></li><li><p>8 å¤„ï¼Œæ¶ˆæ¯ä¼šç»è¿‡é€šé“ handler å¤„ç†ï¼Œè¿™é‡Œæ˜¯å°† String &#x3D;&gt; ByteBuf å‘å‡º</p></li><li><p>æ•°æ®ç»è¿‡ç½‘ç»œä¼ è¾“ï¼Œåˆ°è¾¾æœåŠ¡å™¨ç«¯ï¼ŒæœåŠ¡å™¨ç«¯ 5 å’Œ 6 å¤„çš„ handler å…ˆåè¢«è§¦å‘ï¼Œèµ°å®Œä¸€ä¸ªæµç¨‹</p></li></ul><h3 id="2-4-æµç¨‹æ¢³ç†"><a href="#2-4-æµç¨‹æ¢³ç†" class="headerlink" title="2.4 æµç¨‹æ¢³ç†"></a>2.4 æµç¨‹æ¢³ç†</h3><p><img src="/img/0040.png"></p><h4 id="ğŸ’¡-æç¤º"><a href="#ğŸ’¡-æç¤º" class="headerlink" title="ğŸ’¡ æç¤º"></a>ğŸ’¡ æç¤º</h4><blockquote><p>ä¸€å¼€å§‹éœ€è¦æ ‘ç«‹æ­£ç¡®çš„è§‚å¿µ</p><ul><li>æŠŠ channel ç†è§£ä¸ºæ•°æ®çš„é€šé“</li><li>æŠŠ msg ç†è§£ä¸ºæµåŠ¨çš„æ•°æ®ï¼Œæœ€å¼€å§‹è¾“å…¥æ˜¯ ByteBufï¼Œä½†ç»è¿‡ pipeline çš„åŠ å·¥ï¼Œä¼šå˜æˆå…¶å®ƒç±»å‹å¯¹è±¡ï¼Œæœ€åè¾“å‡ºåˆå˜æˆ ByteBuf</li><li>æŠŠ handler ç†è§£ä¸ºæ•°æ®çš„å¤„ç†å·¥åº<ul><li>å·¥åºæœ‰å¤šé“ï¼Œåˆåœ¨ä¸€èµ·å°±æ˜¯ pipelineï¼Œpipeline è´Ÿè´£å‘å¸ƒäº‹ä»¶ï¼ˆè¯»ã€è¯»å–å®Œæˆâ€¦ï¼‰ä¼ æ’­ç»™æ¯ä¸ª handlerï¼Œ handler å¯¹è‡ªå·±æ„Ÿå…´è¶£çš„äº‹ä»¶è¿›è¡Œå¤„ç†ï¼ˆé‡å†™äº†ç›¸åº”äº‹ä»¶å¤„ç†æ–¹æ³•ï¼‰</li><li>handler åˆ† Inbound å’Œ Outbound ä¸¤ç±»</li></ul></li><li>æŠŠ eventLoop ç†è§£ä¸ºå¤„ç†æ•°æ®çš„å·¥äºº<ul><li>å·¥äººå¯ä»¥ç®¡ç†å¤šä¸ª channel çš„ io æ“ä½œï¼Œå¹¶ä¸”ä¸€æ—¦å·¥äººè´Ÿè´£äº†æŸä¸ª channelï¼Œå°±è¦è´Ÿè´£åˆ°åº•ï¼ˆç»‘å®šï¼‰</li><li>å·¥äººæ—¢å¯ä»¥æ‰§è¡Œ io æ“ä½œï¼Œä¹Ÿå¯ä»¥è¿›è¡Œä»»åŠ¡å¤„ç†ï¼Œæ¯ä½å·¥äººæœ‰ä»»åŠ¡é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—é‡Œå¯ä»¥å †æ”¾å¤šä¸ª channel çš„å¾…å¤„ç†ä»»åŠ¡ï¼Œä»»åŠ¡åˆ†ä¸ºæ™®é€šä»»åŠ¡ã€å®šæ—¶ä»»åŠ¡</li><li>å·¥äººæŒ‰ç…§ pipeline é¡ºåºï¼Œä¾æ¬¡æŒ‰ç…§ handler çš„è§„åˆ’ï¼ˆä»£ç ï¼‰å¤„ç†æ•°æ®ï¼Œå¯ä»¥ä¸ºæ¯é“å·¥åºæŒ‡å®šä¸åŒçš„å·¥äºº</li></ul></li></ul></blockquote><h2 id="3-ç»„ä»¶"><a href="#3-ç»„ä»¶" class="headerlink" title="3. ç»„ä»¶"></a>3. ç»„ä»¶</h2><h3 id="3-1-EventLoop"><a href="#3-1-EventLoop" class="headerlink" title="3.1 EventLoop"></a>3.1 EventLoop</h3><p>äº‹ä»¶å¾ªç¯å¯¹è±¡</p><p>EventLoop æœ¬è´¨æ˜¯ä¸€ä¸ªå•çº¿ç¨‹æ‰§è¡Œå™¨ï¼ˆåŒæ—¶ç»´æŠ¤äº†ä¸€ä¸ª Selectorï¼‰ï¼Œé‡Œé¢æœ‰ run æ–¹æ³•å¤„ç† Channel ä¸Šæºæºä¸æ–­çš„ io äº‹ä»¶ã€‚</p><p>å®ƒçš„ç»§æ‰¿å…³ç³»æ¯”è¾ƒå¤æ‚</p><ul><li>ä¸€æ¡çº¿æ˜¯ç»§æ‰¿è‡ª j.u.c.ScheduledExecutorService å› æ­¤åŒ…å«äº†çº¿ç¨‹æ± ä¸­æ‰€æœ‰çš„æ–¹æ³•</li><li>å¦ä¸€æ¡çº¿æ˜¯ç»§æ‰¿è‡ª netty è‡ªå·±çš„ OrderedEventExecutorï¼Œ<ul><li>æä¾›äº† boolean inEventLoop(Thread thread) æ–¹æ³•åˆ¤æ–­ä¸€ä¸ªçº¿ç¨‹æ˜¯å¦å±äºæ­¤ EventLoop</li><li>æä¾›äº† parent æ–¹æ³•æ¥çœ‹çœ‹è‡ªå·±å±äºå“ªä¸ª EventLoopGroup</li></ul></li></ul><p>äº‹ä»¶å¾ªç¯ç»„</p><p>EventLoopGroup æ˜¯ä¸€ç»„ EventLoopï¼ŒChannel ä¸€èˆ¬ä¼šè°ƒç”¨ EventLoopGroup çš„ register æ–¹æ³•æ¥ç»‘å®šå…¶ä¸­ä¸€ä¸ª EventLoopï¼Œåç»­è¿™ä¸ª Channel ä¸Šçš„ io äº‹ä»¶éƒ½ç”±æ­¤ EventLoop æ¥å¤„ç†ï¼ˆä¿è¯äº† io äº‹ä»¶å¤„ç†æ—¶çš„çº¿ç¨‹å®‰å…¨ï¼‰</p><ul><li>ç»§æ‰¿è‡ª netty è‡ªå·±çš„ EventExecutorGroup<ul><li>å®ç°äº† Iterable æ¥å£æä¾›éå† EventLoop çš„èƒ½åŠ›</li><li>å¦æœ‰ next æ–¹æ³•è·å–é›†åˆä¸­ä¸‹ä¸€ä¸ª EventLoop</li></ul></li></ul><p>ä»¥ä¸€ä¸ªç®€å•çš„å®ç°ä¸ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å†…éƒ¨åˆ›å»ºäº†ä¸¤ä¸ª EventLoop, æ¯ä¸ª EventLoop ç»´æŠ¤ä¸€ä¸ªçº¿ç¨‹</span></span><br><span class="line"><span class="type">DefaultEventLoopGroup</span> <span class="variable">group</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultEventLoopGroup</span>(<span class="number">2</span>);</span><br><span class="line">System.out.println(group.next());</span><br><span class="line">System.out.println(group.next());</span><br><span class="line">System.out.println(group.next());</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">io.netty.channel.DefaultEventLoop@60f82f98</span><br><span class="line">io.netty.channel.DefaultEventLoop@35f983a6</span><br><span class="line">io.netty.channel.DefaultEventLoop@60f82f98</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ for å¾ªç¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">DefaultEventLoopGroup</span> <span class="variable">group</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultEventLoopGroup</span>(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (EventExecutor eventLoop : group) &#123;</span><br><span class="line">    System.out.println(eventLoop);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">io.netty.channel.DefaultEventLoop@60f82f98</span><br><span class="line">io.netty.channel.DefaultEventLoop@35f983a6</span><br></pre></td></tr></table></figure><h4 id="ğŸ’¡-ä¼˜é›…å…³é—­"><a href="#ğŸ’¡-ä¼˜é›…å…³é—­" class="headerlink" title="ğŸ’¡ ä¼˜é›…å…³é—­"></a>ğŸ’¡ ä¼˜é›…å…³é—­</h4><p>ä¼˜é›…å…³é—­ <code>shutdownGracefully</code> æ–¹æ³•ã€‚è¯¥æ–¹æ³•ä¼šé¦–å…ˆåˆ‡æ¢ <code>EventLoopGroup</code> åˆ°å…³é—­çŠ¶æ€ä»è€Œæ‹’ç»æ–°çš„ä»»åŠ¡çš„åŠ å…¥ï¼Œç„¶ååœ¨ä»»åŠ¡é˜Ÿåˆ—çš„ä»»åŠ¡éƒ½å¤„ç†å®Œæˆåï¼Œåœæ­¢çº¿ç¨‹çš„è¿è¡Œã€‚ä»è€Œç¡®ä¿æ•´ä½“åº”ç”¨æ˜¯åœ¨æ­£å¸¸æœ‰åºçš„çŠ¶æ€ä¸‹é€€å‡ºçš„</p><h4 id="æ¼”ç¤º-NioEventLoop-å¤„ç†-io-äº‹ä»¶"><a href="#æ¼”ç¤º-NioEventLoop-å¤„ç†-io-äº‹ä»¶" class="headerlink" title="æ¼”ç¤º NioEventLoop å¤„ç† io äº‹ä»¶"></a>æ¼”ç¤º NioEventLoop å¤„ç† io äº‹ä»¶</h4><p>æœåŠ¡å™¨ç«¯ä¸¤ä¸ª nio worker å·¥äºº</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">ServerBootstrap</span>()</span><br><span class="line">    .group(<span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>(<span class="number">1</span>), <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>(<span class="number">2</span>))</span><br><span class="line">    .channel(NioServerSocketChannel.class)</span><br><span class="line">    .childHandler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;NioSocketChannel&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(NioSocketChannel ch)</span> &#123;</span><br><span class="line">            ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">ChannelInboundHandlerAdapter</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">channelRead</span><span class="params">(ChannelHandlerContext ctx, Object msg)</span> &#123;</span><br><span class="line">                    <span class="type">ByteBuf</span> <span class="variable">byteBuf</span> <span class="operator">=</span> msg <span class="keyword">instanceof</span> ByteBuf ? ((ByteBuf) msg) : <span class="literal">null</span>;</span><br><span class="line">                    <span class="keyword">if</span> (byteBuf != <span class="literal">null</span>) &#123;</span><br><span class="line">                        <span class="type">byte</span>[] buf = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">16</span>];</span><br><span class="line">                        <span class="type">ByteBuf</span> <span class="variable">len</span> <span class="operator">=</span> byteBuf.readBytes(buf, <span class="number">0</span>, byteBuf.readableBytes());</span><br><span class="line">                        log.debug(<span class="keyword">new</span> <span class="title class_">String</span>(buf));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;).bind(<span class="number">8080</span>).sync();</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯ï¼Œå¯åŠ¨ä¸‰æ¬¡ï¼Œåˆ†åˆ«ä¿®æ”¹å‘é€å­—ç¬¦ä¸²ä¸º zhangsanï¼ˆç¬¬ä¸€æ¬¡ï¼‰ï¼Œlisiï¼ˆç¬¬äºŒæ¬¡ï¼‰ï¼Œwangwuï¼ˆç¬¬ä¸‰æ¬¡ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">    <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bootstrap</span>()</span><br><span class="line">            .group(<span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>(<span class="number">1</span>))</span><br><span class="line">            .handler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;NioSocketChannel&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(NioSocketChannel ch)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;init...&quot;</span>);</span><br><span class="line">                    ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">LoggingHandler</span>(LogLevel.DEBUG));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            .channel(NioSocketChannel.class).connect(<span class="string">&quot;localhost&quot;</span>, <span class="number">8080</span>)</span><br><span class="line">            .sync()</span><br><span class="line">            .channel();</span><br><span class="line"></span><br><span class="line">    channel.writeAndFlush(ByteBufAllocator.DEFAULT.buffer().writeBytes(<span class="string">&quot;wangwu&quot;</span>.getBytes()));</span><br><span class="line">    Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">    channel.writeAndFlush(ByteBufAllocator.DEFAULT.buffer().writeBytes(<span class="string">&quot;wangwu&quot;</span>.getBytes()));</span><br></pre></td></tr></table></figure><p>æœ€åè¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">22:03:34 [DEBUG] [nioEventLoopGroup-3-1] c.i.o.EventLoopTest - zhangsan       </span><br><span class="line">22:03:36 [DEBUG] [nioEventLoopGroup-3-1] c.i.o.EventLoopTest - zhangsan       </span><br><span class="line">22:05:36 [DEBUG] [nioEventLoopGroup-3-2] c.i.o.EventLoopTest - lisi           </span><br><span class="line">22:05:38 [DEBUG] [nioEventLoopGroup-3-2] c.i.o.EventLoopTest - lisi           </span><br><span class="line">22:06:09 [DEBUG] [nioEventLoopGroup-3-1] c.i.o.EventLoopTest - wangwu        </span><br><span class="line">22:06:11 [DEBUG] [nioEventLoopGroup-3-1] c.i.o.EventLoopTest - wangwu         </span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªå·¥äººè½®æµå¤„ç† channelï¼Œä½†å·¥äººä¸ channel ä¹‹é—´è¿›è¡Œäº†ç»‘å®š</p><p><img src="/img/0042.png"></p><p>å†å¢åŠ ä¸¤ä¸ªé nio å·¥äºº</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">DefaultEventLoopGroup</span> <span class="variable">normalWorkers</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultEventLoopGroup</span>(<span class="number">2</span>);</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">ServerBootstrap</span>()</span><br><span class="line">    .group(<span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>(<span class="number">1</span>), <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>(<span class="number">2</span>))</span><br><span class="line">    .channel(NioServerSocketChannel.class)</span><br><span class="line">    .childHandler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;NioSocketChannel&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(NioSocketChannel ch)</span>  &#123;</span><br><span class="line">            ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">LoggingHandler</span>(LogLevel.DEBUG));</span><br><span class="line">            ch.pipeline().addLast(normalWorkers,<span class="string">&quot;myhandler&quot;</span>,</span><br><span class="line">              <span class="keyword">new</span> <span class="title class_">ChannelInboundHandlerAdapter</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">channelRead</span><span class="params">(ChannelHandlerContext ctx, Object msg)</span> &#123;</span><br><span class="line">                    <span class="type">ByteBuf</span> <span class="variable">byteBuf</span> <span class="operator">=</span> msg <span class="keyword">instanceof</span> ByteBuf ? ((ByteBuf) msg) : <span class="literal">null</span>;</span><br><span class="line">                    <span class="keyword">if</span> (byteBuf != <span class="literal">null</span>) &#123;</span><br><span class="line">                        <span class="type">byte</span>[] buf = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">16</span>];</span><br><span class="line">                        <span class="type">ByteBuf</span> <span class="variable">len</span> <span class="operator">=</span> byteBuf.readBytes(buf, <span class="number">0</span>, byteBuf.readableBytes());</span><br><span class="line">                        log.debug(<span class="keyword">new</span> <span class="title class_">String</span>(buf));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;).bind(<span class="number">8080</span>).sync();</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯ä»£ç ä¸å˜ï¼Œå¯åŠ¨ä¸‰æ¬¡ï¼Œåˆ†åˆ«ä¿®æ”¹å‘é€å­—ç¬¦ä¸²ä¸º zhangsanï¼ˆç¬¬ä¸€æ¬¡ï¼‰ï¼Œlisiï¼ˆç¬¬äºŒæ¬¡ï¼‰ï¼Œwangwuï¼ˆç¬¬ä¸‰æ¬¡ï¼‰</p><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">22:19:48 [DEBUG] [nioEventLoopGroup-4-1] i.n.h.l.LoggingHandler - [id: 0x251562d5, L:/127.0.0.1:8080 - R:/127.0.0.1:52588] REGISTERED</span><br><span class="line">22:19:48 [DEBUG] [nioEventLoopGroup-4-1] i.n.h.l.LoggingHandler - [id: 0x251562d5, L:/127.0.0.1:8080 - R:/127.0.0.1:52588] ACTIVE</span><br><span class="line">22:19:48 [DEBUG] [nioEventLoopGroup-4-1] i.n.h.l.LoggingHandler - [id: 0x251562d5, L:/127.0.0.1:8080 - R:/127.0.0.1:52588] READ: 8B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 7a 68 61 6e 67 73 61 6e                         |zhangsan        |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">22:19:48 [DEBUG] [nioEventLoopGroup-4-1] i.n.h.l.LoggingHandler - [id: 0x251562d5, L:/127.0.0.1:8080 - R:/127.0.0.1:52588] READ COMPLETE</span><br><span class="line">22:19:48 [DEBUG] [defaultEventLoopGroup-2-1] c.i.o.EventLoopTest - zhangsan        </span><br><span class="line">22:19:50 [DEBUG] [nioEventLoopGroup-4-1] i.n.h.l.LoggingHandler - [id: 0x251562d5, L:/127.0.0.1:8080 - R:/127.0.0.1:52588] READ: 8B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 7a 68 61 6e 67 73 61 6e                         |zhangsan        |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">22:19:50 [DEBUG] [nioEventLoopGroup-4-1] i.n.h.l.LoggingHandler - [id: 0x251562d5, L:/127.0.0.1:8080 - R:/127.0.0.1:52588] READ COMPLETE</span><br><span class="line">22:19:50 [DEBUG] [defaultEventLoopGroup-2-1] c.i.o.EventLoopTest - zhangsan        </span><br><span class="line">22:20:24 [DEBUG] [nioEventLoopGroup-4-2] i.n.h.l.LoggingHandler - [id: 0x94b2a840, L:/127.0.0.1:8080 - R:/127.0.0.1:52612] REGISTERED</span><br><span class="line">22:20:24 [DEBUG] [nioEventLoopGroup-4-2] i.n.h.l.LoggingHandler - [id: 0x94b2a840, L:/127.0.0.1:8080 - R:/127.0.0.1:52612] ACTIVE</span><br><span class="line">22:20:25 [DEBUG] [nioEventLoopGroup-4-2] i.n.h.l.LoggingHandler - [id: 0x94b2a840, L:/127.0.0.1:8080 - R:/127.0.0.1:52612] READ: 4B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 6c 69 73 69                                     |lisi            |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">22:20:25 [DEBUG] [nioEventLoopGroup-4-2] i.n.h.l.LoggingHandler - [id: 0x94b2a840, L:/127.0.0.1:8080 - R:/127.0.0.1:52612] READ COMPLETE</span><br><span class="line">22:20:25 [DEBUG] [defaultEventLoopGroup-2-2] c.i.o.EventLoopTest - lisi            </span><br><span class="line">22:20:27 [DEBUG] [nioEventLoopGroup-4-2] i.n.h.l.LoggingHandler - [id: 0x94b2a840, L:/127.0.0.1:8080 - R:/127.0.0.1:52612] READ: 4B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 6c 69 73 69                                     |lisi            |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">22:20:27 [DEBUG] [nioEventLoopGroup-4-2] i.n.h.l.LoggingHandler - [id: 0x94b2a840, L:/127.0.0.1:8080 - R:/127.0.0.1:52612] READ COMPLETE</span><br><span class="line">22:20:27 [DEBUG] [defaultEventLoopGroup-2-2] c.i.o.EventLoopTest - lisi            </span><br><span class="line">22:20:38 [DEBUG] [nioEventLoopGroup-4-1] i.n.h.l.LoggingHandler - [id: 0x79a26af9, L:/127.0.0.1:8080 - R:/127.0.0.1:52625] REGISTERED</span><br><span class="line">22:20:38 [DEBUG] [nioEventLoopGroup-4-1] i.n.h.l.LoggingHandler - [id: 0x79a26af9, L:/127.0.0.1:8080 - R:/127.0.0.1:52625] ACTIVE</span><br><span class="line">22:20:38 [DEBUG] [nioEventLoopGroup-4-1] i.n.h.l.LoggingHandler - [id: 0x79a26af9, L:/127.0.0.1:8080 - R:/127.0.0.1:52625] READ: 6B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 77 61 6e 67 77 75                               |wangwu          |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">22:20:38 [DEBUG] [nioEventLoopGroup-4-1] i.n.h.l.LoggingHandler - [id: 0x79a26af9, L:/127.0.0.1:8080 - R:/127.0.0.1:52625] READ COMPLETE</span><br><span class="line">22:20:38 [DEBUG] [defaultEventLoopGroup-2-1] c.i.o.EventLoopTest - wangwu          </span><br><span class="line">22:20:40 [DEBUG] [nioEventLoopGroup-4-1] i.n.h.l.LoggingHandler - [id: 0x79a26af9, L:/127.0.0.1:8080 - R:/127.0.0.1:52625] READ: 6B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 77 61 6e 67 77 75                               |wangwu          |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">22:20:40 [DEBUG] [nioEventLoopGroup-4-1] i.n.h.l.LoggingHandler - [id: 0x79a26af9, L:/127.0.0.1:8080 - R:/127.0.0.1:52625] READ COMPLETE</span><br><span class="line">22:20:40 [DEBUG] [defaultEventLoopGroup-2-1] c.i.o.EventLoopTest - wangwu          </span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œnio å·¥äººå’Œ é nio å·¥äººä¹Ÿåˆ†åˆ«ç»‘å®šäº† channelï¼ˆLoggingHandler ç”± nio å·¥äººæ‰§è¡Œï¼Œè€Œæˆ‘ä»¬è‡ªå·±çš„ handler ç”±é nio å·¥äººæ‰§è¡Œï¼‰</p><p><img src="/img/0041.png"></p><h4 id="ğŸ’¡-handler-æ‰§è¡Œä¸­å¦‚ä½•æ¢äººï¼Ÿ"><a href="#ğŸ’¡-handler-æ‰§è¡Œä¸­å¦‚ä½•æ¢äººï¼Ÿ" class="headerlink" title="ğŸ’¡ handler æ‰§è¡Œä¸­å¦‚ä½•æ¢äººï¼Ÿ"></a>ğŸ’¡ handler æ‰§è¡Œä¸­å¦‚ä½•æ¢äººï¼Ÿ</h4><p>å…³é”®ä»£ç  <code>io.netty.channel.AbstractChannelHandlerContext#invokeChannelRead()</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">invokeChannelRead</span><span class="params">(<span class="keyword">final</span> AbstractChannelHandlerContext next, Object msg)</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">Object</span> <span class="variable">m</span> <span class="operator">=</span> next.pipeline.touch(ObjectUtil.checkNotNull(msg, <span class="string">&quot;msg&quot;</span>), next);</span><br><span class="line">    <span class="comment">// ä¸‹ä¸€ä¸ª handler çš„äº‹ä»¶å¾ªç¯æ˜¯å¦ä¸å½“å‰çš„äº‹ä»¶å¾ªç¯æ˜¯åŒä¸€ä¸ªçº¿ç¨‹</span></span><br><span class="line">    <span class="type">EventExecutor</span> <span class="variable">executor</span> <span class="operator">=</span> next.executor();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ˜¯ï¼Œç›´æ¥è°ƒç”¨</span></span><br><span class="line">    <span class="keyword">if</span> (executor.inEventLoop()) &#123;</span><br><span class="line">        next.invokeChannelRead(m);</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="comment">// ä¸æ˜¯ï¼Œå°†è¦æ‰§è¡Œçš„ä»£ç ä½œä¸ºä»»åŠ¡æäº¤ç»™ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯å¤„ç†ï¼ˆæ¢äººï¼‰</span></span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        executor.execute(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                next.invokeChannelRead(m);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¦‚æœä¸¤ä¸ª handler ç»‘å®šçš„æ˜¯åŒä¸€ä¸ªçº¿ç¨‹ï¼Œé‚£ä¹ˆå°±ç›´æ¥è°ƒç”¨</li><li>å¦åˆ™ï¼ŒæŠŠè¦è°ƒç”¨çš„ä»£ç å°è£…ä¸ºä¸€ä¸ªä»»åŠ¡å¯¹è±¡ï¼Œç”±ä¸‹ä¸€ä¸ª handler çš„çº¿ç¨‹æ¥è°ƒç”¨</li></ul><h4 id="æ¼”ç¤º-NioEventLoop-å¤„ç†æ™®é€šä»»åŠ¡"><a href="#æ¼”ç¤º-NioEventLoop-å¤„ç†æ™®é€šä»»åŠ¡" class="headerlink" title="æ¼”ç¤º NioEventLoop å¤„ç†æ™®é€šä»»åŠ¡"></a>æ¼”ç¤º NioEventLoop å¤„ç†æ™®é€šä»»åŠ¡</h4><p>NioEventLoop é™¤äº†å¯ä»¥å¤„ç† io äº‹ä»¶ï¼ŒåŒæ ·å¯ä»¥å‘å®ƒæäº¤æ™®é€šä»»åŠ¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NioEventLoopGroup</span> <span class="variable">nioWorkers</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">log.debug(<span class="string">&quot;server start...&quot;</span>);</span><br><span class="line">Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">nioWorkers.execute(()-&gt;&#123;</span><br><span class="line">    log.debug(<span class="string">&quot;normal task...&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">22:30:36 [DEBUG] [main] c.i.o.EventLoopTest2 - server start...</span><br><span class="line">22:30:38 [DEBUG] [nioEventLoopGroup-2-1] c.i.o.EventLoopTest2 - normal task...</span><br></pre></td></tr></table></figure><blockquote><p>å¯ä»¥ç”¨æ¥æ‰§è¡Œè€—æ—¶è¾ƒé•¿çš„ä»»åŠ¡</p></blockquote><h4 id="æ¼”ç¤º-NioEventLoop-å¤„ç†å®šæ—¶ä»»åŠ¡"><a href="#æ¼”ç¤º-NioEventLoop-å¤„ç†å®šæ—¶ä»»åŠ¡" class="headerlink" title="æ¼”ç¤º NioEventLoop å¤„ç†å®šæ—¶ä»»åŠ¡"></a>æ¼”ç¤º NioEventLoop å¤„ç†å®šæ—¶ä»»åŠ¡</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NioEventLoopGroup</span> <span class="variable">nioWorkers</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">log.debug(<span class="string">&quot;server start...&quot;</span>);</span><br><span class="line">Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">nioWorkers.scheduleAtFixedRate(() -&gt; &#123;</span><br><span class="line">    log.debug(<span class="string">&quot;running...&quot;</span>);</span><br><span class="line">&#125;, <span class="number">0</span>, <span class="number">1</span>, TimeUnit.SECONDS);</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">22:35:15 [DEBUG] [main] c.i.o.EventLoopTest2 - server start...</span><br><span class="line">22:35:17 [DEBUG] [nioEventLoopGroup-2-1] c.i.o.EventLoopTest2 - running...</span><br><span class="line">22:35:18 [DEBUG] [nioEventLoopGroup-2-1] c.i.o.EventLoopTest2 - running...</span><br><span class="line">22:35:19 [DEBUG] [nioEventLoopGroup-2-1] c.i.o.EventLoopTest2 - running...</span><br><span class="line">22:35:20 [DEBUG] [nioEventLoopGroup-2-1] c.i.o.EventLoopTest2 - running...</span><br><span class="line">...</span><br></pre></td></tr></table></figure><blockquote><p>å¯ä»¥ç”¨æ¥æ‰§è¡Œå®šæ—¶ä»»åŠ¡</p></blockquote><h3 id="3-2-Channel"><a href="#3-2-Channel" class="headerlink" title="3.2 Channel"></a>3.2 Channel</h3><p>channel çš„ä¸»è¦ä½œç”¨</p><ul><li>close() å¯ä»¥ç”¨æ¥å…³é—­ channel</li><li>closeFuture() ç”¨æ¥å¤„ç† channel çš„å…³é—­<ul><li>sync æ–¹æ³•ä½œç”¨æ˜¯åŒæ­¥ç­‰å¾… channel å…³é—­</li><li>è€Œ addListener æ–¹æ³•æ˜¯å¼‚æ­¥ç­‰å¾… channel å…³é—­</li></ul></li><li>pipeline() æ–¹æ³•æ·»åŠ å¤„ç†å™¨</li><li>write() æ–¹æ³•å°†æ•°æ®å†™å…¥</li><li>writeAndFlush() æ–¹æ³•å°†æ•°æ®å†™å…¥å¹¶åˆ·å‡º</li></ul><h4 id="ChannelFuture"><a href="#ChannelFuture" class="headerlink" title="ChannelFuture"></a>ChannelFuture</h4><p>è¿™æ—¶åˆšæ‰çš„å®¢æˆ·ç«¯ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Bootstrap</span>()</span><br><span class="line">    .group(<span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>())</span><br><span class="line">    .channel(NioSocketChannel.class)</span><br><span class="line">    .handler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;Channel&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(Channel ch)</span> &#123;</span><br><span class="line">            ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">StringEncoder</span>());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .connect(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">8080</span>)</span><br><span class="line">    .sync()</span><br><span class="line">    .channel()</span><br><span class="line">    .writeAndFlush(<span class="keyword">new</span> <span class="title class_">Date</span>() + <span class="string">&quot;: hello world!&quot;</span>);</span><br></pre></td></tr></table></figure><p>ç°åœ¨æŠŠå®ƒæ‹†å¼€æ¥çœ‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ChannelFuture</span> <span class="variable">channelFuture</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bootstrap</span>()</span><br><span class="line">    .group(<span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>())</span><br><span class="line">    .channel(NioSocketChannel.class)</span><br><span class="line">    .handler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;Channel&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(Channel ch)</span> &#123;</span><br><span class="line">            ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">StringEncoder</span>());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .connect(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">8080</span>); <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line">channelFuture.sync().channel().writeAndFlush(<span class="keyword">new</span> <span class="title class_">Date</span>() + <span class="string">&quot;: hello world!&quot;</span>);</span><br></pre></td></tr></table></figure><ul><li>1 å¤„è¿”å›çš„æ˜¯ ChannelFuture å¯¹è±¡ï¼Œå®ƒçš„ä½œç”¨æ˜¯åˆ©ç”¨ channel() æ–¹æ³•æ¥è·å– Channel å¯¹è±¡</li></ul><p><strong>æ³¨æ„</strong> connect æ–¹æ³•æ˜¯å¼‚æ­¥çš„ï¼Œæ„å‘³ç€ä¸ç­‰è¿æ¥å»ºç«‹ï¼Œæ–¹æ³•æ‰§è¡Œå°±è¿”å›äº†ã€‚å› æ­¤ channelFuture å¯¹è±¡ä¸­ä¸èƒ½ã€ç«‹åˆ»ã€‘è·å¾—åˆ°æ­£ç¡®çš„ Channel å¯¹è±¡</p><p>å®éªŒå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ChannelFuture</span> <span class="variable">channelFuture</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bootstrap</span>()</span><br><span class="line">    .group(<span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>())</span><br><span class="line">    .channel(NioSocketChannel.class)</span><br><span class="line">    .handler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;Channel&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(Channel ch)</span> &#123;</span><br><span class="line">            ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">StringEncoder</span>());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .connect(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">8080</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(channelFuture.channel()); <span class="comment">// 1</span></span><br><span class="line">channelFuture.sync(); <span class="comment">// 2</span></span><br><span class="line">System.out.println(channelFuture.channel()); <span class="comment">// 3</span></span><br></pre></td></tr></table></figure><ul><li>æ‰§è¡Œåˆ° 1 æ—¶ï¼Œè¿æ¥æœªå»ºç«‹ï¼Œæ‰“å° <code>[id: 0x2e1884dd]</code></li><li>æ‰§è¡Œåˆ° 2 æ—¶ï¼Œsync æ–¹æ³•æ˜¯åŒæ­¥ç­‰å¾…è¿æ¥å»ºç«‹å®Œæˆ</li><li>æ‰§è¡Œåˆ° 3 æ—¶ï¼Œè¿æ¥è‚¯å®šå»ºç«‹äº†ï¼Œæ‰“å° <code>[id: 0x2e1884dd, L:/127.0.0.1:57191 - R:/127.0.0.1:8080]</code></li></ul><p>é™¤äº†ç”¨ sync æ–¹æ³•å¯ä»¥è®©å¼‚æ­¥æ“ä½œåŒæ­¥ä»¥å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å›è°ƒçš„æ–¹å¼ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ChannelFuture</span> <span class="variable">channelFuture</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bootstrap</span>()</span><br><span class="line">    .group(<span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>())</span><br><span class="line">    .channel(NioSocketChannel.class)</span><br><span class="line">    .handler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;Channel&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(Channel ch)</span> &#123;</span><br><span class="line">            ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">StringEncoder</span>());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .connect(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">8080</span>);</span><br><span class="line">System.out.println(channelFuture.channel()); <span class="comment">// 1</span></span><br><span class="line">channelFuture.addListener((ChannelFutureListener) future -&gt; &#123;</span><br><span class="line">    System.out.println(future.channel()); <span class="comment">// 2</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li>æ‰§è¡Œåˆ° 1 æ—¶ï¼Œè¿æ¥æœªå»ºç«‹ï¼Œæ‰“å° <code>[id: 0x749124ba]</code></li><li>ChannelFutureListener ä¼šåœ¨è¿æ¥å»ºç«‹æ—¶è¢«è°ƒç”¨ï¼ˆå…¶ä¸­ operationComplete æ–¹æ³•ï¼‰ï¼Œå› æ­¤æ‰§è¡Œåˆ° 2 æ—¶ï¼Œè¿æ¥è‚¯å®šå»ºç«‹äº†ï¼Œæ‰“å° <code>[id: 0x749124ba, L:/127.0.0.1:57351 - R:/127.0.0.1:8080]</code></li></ul><h4 id="CloseFuture"><a href="#CloseFuture" class="headerlink" title="CloseFuture"></a>CloseFuture</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CloseFutureClient</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        NioEventLoopGroup group <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line">        <span class="type">ChannelFuture</span> <span class="variable">channelFuture</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bootstrap</span>()</span><br><span class="line">                .group(group)</span><br><span class="line">                .channel(NioSocketChannel.class)</span><br><span class="line">                .handler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;NioSocketChannel&gt;() &#123;</span><br><span class="line">                    <span class="meta">@Override</span> <span class="comment">// åœ¨è¿æ¥å»ºç«‹åè¢«è°ƒç”¨</span></span><br><span class="line">                    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(NioSocketChannel ch)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                        ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">LoggingHandler</span>(LogLevel.DEBUG));</span><br><span class="line">                        ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">StringEncoder</span>());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">                .connect(<span class="keyword">new</span> <span class="title class_">InetSocketAddress</span>(<span class="string">&quot;localhost&quot;</span>, <span class="number">8080</span>));</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> channelFuture.sync().channel();</span><br><span class="line">        log.debug(<span class="string">&quot;&#123;&#125;&quot;</span>, channel);</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(()-&gt;&#123;</span><br><span class="line">            <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> scanner.nextLine();</span><br><span class="line">                <span class="keyword">if</span> (<span class="string">&quot;q&quot;</span>.equals(line)) &#123;</span><br><span class="line">                    channel.close(); <span class="comment">// close å¼‚æ­¥æ“ä½œ 1s ä¹‹å</span></span><br><span class="line"><span class="comment">//                    log.debug(&quot;å¤„ç†å…³é—­ä¹‹åçš„æ“ä½œ&quot;); // ä¸èƒ½åœ¨è¿™é‡Œå–„å</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                channel.writeAndFlush(line);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="string">&quot;input&quot;</span>).start();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å– CloseFuture å¯¹è±¡ï¼Œ 1) åŒæ­¥å¤„ç†å…³é—­ï¼Œ 2) å¼‚æ­¥å¤„ç†å…³é—­</span></span><br><span class="line">        <span class="type">ChannelFuture</span> <span class="variable">closeFuture</span> <span class="operator">=</span> channel.closeFuture();</span><br><span class="line">        <span class="comment">/*log.debug(&quot;waiting close...&quot;);</span></span><br><span class="line"><span class="comment">        closeFuture.sync();</span></span><br><span class="line"><span class="comment">        log.debug(&quot;å¤„ç†å…³é—­ä¹‹åçš„æ“ä½œ&quot;);*/</span></span><br><span class="line">        closeFuture.addListener(<span class="keyword">new</span> <span class="title class_">ChannelFutureListener</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">operationComplete</span><span class="params">(ChannelFuture future)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                log.debug(<span class="string">&quot;å¤„ç†å…³é—­ä¹‹åçš„æ“ä½œ&quot;</span>);</span><br><span class="line">                group.shutdownGracefully();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’¡-å¼‚æ­¥æå‡çš„æ˜¯ä»€ä¹ˆ"><a href="#ğŸ’¡-å¼‚æ­¥æå‡çš„æ˜¯ä»€ä¹ˆ" class="headerlink" title="ğŸ’¡ å¼‚æ­¥æå‡çš„æ˜¯ä»€ä¹ˆ"></a>ğŸ’¡ å¼‚æ­¥æå‡çš„æ˜¯ä»€ä¹ˆ</h4><ul><li><p>æœ‰äº›åŒå­¦çœ‹åˆ°è¿™é‡Œä¼šæœ‰ç–‘é—®ï¼šä¸ºä»€ä¹ˆä¸åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­å»æ‰§è¡Œå»ºç«‹è¿æ¥ã€å»æ‰§è¡Œå…³é—­ channelï¼Œé‚£æ ·ä¸æ˜¯ä¹Ÿå¯ä»¥å—ï¼Ÿéè¦ç”¨è¿™ä¹ˆå¤æ‚çš„å¼‚æ­¥æ–¹å¼ï¼šæ¯”å¦‚ä¸€ä¸ªçº¿ç¨‹å‘èµ·å»ºç«‹è¿æ¥ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹å»çœŸæ­£å»ºç«‹è¿æ¥</p></li><li><p>è¿˜æœ‰åŒå­¦ä¼šç¬¼ç»Ÿåœ°å›ç­”ï¼Œå› ä¸º netty å¼‚æ­¥æ–¹å¼ç”¨äº†å¤šçº¿ç¨‹ã€å¤šçº¿ç¨‹å°±æ•ˆç‡é«˜ã€‚å…¶å®è¿™äº›è®¤è¯†éƒ½æ¯”è¾ƒç‰‡é¢ï¼Œå¤šçº¿ç¨‹å’Œå¼‚æ­¥æ‰€æå‡çš„æ•ˆç‡å¹¶ä¸æ˜¯æ‰€è®¤ä¸ºçš„</p></li></ul><p>æ€è€ƒä¸‹é¢çš„åœºæ™¯ï¼Œ4 ä¸ªåŒ»ç”Ÿç»™äººçœ‹ç—…ï¼Œæ¯ä¸ªç—…äººèŠ±è´¹ 20 åˆ†é’Ÿï¼Œè€Œä¸”åŒ»ç”Ÿçœ‹ç—…çš„è¿‡ç¨‹ä¸­æ˜¯ä»¥ç—…äººä¸ºå•ä½çš„ï¼Œä¸€ä¸ªç—…äººçœ‹å®Œäº†ï¼Œæ‰èƒ½çœ‹ä¸‹ä¸€ä¸ªç—…äººã€‚å‡è®¾ç—…äººæºæºä¸æ–­åœ°æ¥ï¼Œå¯ä»¥è®¡ç®—ä¸€ä¸‹ 4 ä¸ªåŒ»ç”Ÿä¸€å¤©å·¥ä½œ 8 å°æ—¶ï¼Œå¤„ç†çš„ç—…äººæ€»æ•°æ˜¯ï¼š<code>4 * 8 * 3 = 96</code></p><p><img src="/img/0044.png"></p><p>ç»ç ”ç©¶å‘ç°ï¼Œçœ‹ç—…å¯ä»¥ç»†åˆ†ä¸ºå››ä¸ªæ­¥éª¤ï¼Œç»æ‹†åˆ†åæ¯ä¸ªæ­¥éª¤éœ€è¦ 5 åˆ†é’Ÿï¼Œå¦‚ä¸‹</p><p><img src="/img/0048.png"></p><p>å› æ­¤å¯ä»¥åšå¦‚ä¸‹ä¼˜åŒ–ï¼Œåªæœ‰ä¸€å¼€å§‹ï¼ŒåŒ»ç”Ÿ 2ã€3ã€4 åˆ†åˆ«è¦ç­‰å¾… 5ã€10ã€15 åˆ†é’Ÿæ‰èƒ½æ‰§è¡Œå·¥ä½œï¼Œä½†åªè¦åç»­ç—…äººæºæºä¸æ–­åœ°æ¥ï¼Œä»–ä»¬å°±èƒ½å¤Ÿæ»¡è´Ÿè·å·¥ä½œï¼Œå¹¶ä¸”å¤„ç†ç—…äººçš„èƒ½åŠ›æé«˜åˆ°äº† <code>4 * 8 * 12</code> æ•ˆç‡å‡ ä¹æ˜¯åŸæ¥çš„å››å€</p><p><img src="/img/0047.png"></p><p>è¦ç‚¹</p><ul><li>å•çº¿ç¨‹æ²¡æ³•å¼‚æ­¥æé«˜æ•ˆç‡ï¼Œå¿…é¡»é…åˆå¤šçº¿ç¨‹ã€å¤šæ ¸ cpu æ‰èƒ½å‘æŒ¥å¼‚æ­¥çš„ä¼˜åŠ¿</li><li>å¼‚æ­¥å¹¶æ²¡æœ‰ç¼©çŸ­å“åº”æ—¶é—´ï¼Œåè€Œæœ‰æ‰€å¢åŠ </li><li>åˆç†è¿›è¡Œä»»åŠ¡æ‹†åˆ†ï¼Œä¹Ÿæ˜¯åˆ©ç”¨å¼‚æ­¥çš„å…³é”®</li></ul><h3 id="3-3-Future-amp-Promise"><a href="#3-3-Future-amp-Promise" class="headerlink" title="3.3 Future &amp; Promise"></a>3.3 Future &amp; Promise</h3><p>åœ¨å¼‚æ­¥å¤„ç†æ—¶ï¼Œç»å¸¸ç”¨åˆ°è¿™ä¸¤ä¸ªæ¥å£</p><p>é¦–å…ˆè¦è¯´æ˜ netty ä¸­çš„ Future ä¸ jdk ä¸­çš„ Future åŒåï¼Œä½†æ˜¯æ˜¯ä¸¤ä¸ªæ¥å£ï¼Œnetty çš„ Future ç»§æ‰¿è‡ª jdk çš„ Futureï¼Œè€Œ Promise åˆå¯¹ netty Future è¿›è¡Œäº†æ‰©å±•</p><ul><li>jdk Future åªèƒ½åŒæ­¥ç­‰å¾…ä»»åŠ¡ç»“æŸï¼ˆæˆ–æˆåŠŸã€æˆ–å¤±è´¥ï¼‰æ‰èƒ½å¾—åˆ°ç»“æœ</li><li>netty Future å¯ä»¥åŒæ­¥ç­‰å¾…ä»»åŠ¡ç»“æŸå¾—åˆ°ç»“æœï¼Œä¹Ÿå¯ä»¥å¼‚æ­¥æ–¹å¼å¾—åˆ°ç»“æœï¼Œä½†éƒ½æ˜¯è¦ç­‰ä»»åŠ¡ç»“æŸ</li><li>netty Promise ä¸ä»…æœ‰ netty Future çš„åŠŸèƒ½ï¼Œè€Œä¸”è„±ç¦»äº†ä»»åŠ¡ç‹¬ç«‹å­˜åœ¨ï¼Œåªä½œä¸ºä¸¤ä¸ªçº¿ç¨‹é—´ä¼ é€’ç»“æœçš„å®¹å™¨</li></ul><table><thead><tr><th>åŠŸèƒ½&#x2F;åç§°</th><th>jdk Future</th><th>netty Future</th><th>Promise</th></tr></thead><tbody><tr><td>cancel</td><td>å–æ¶ˆä»»åŠ¡</td><td>-</td><td>-</td></tr><tr><td>isCanceled</td><td>ä»»åŠ¡æ˜¯å¦å–æ¶ˆ</td><td>-</td><td>-</td></tr><tr><td>isDone</td><td>ä»»åŠ¡æ˜¯å¦å®Œæˆï¼Œä¸èƒ½åŒºåˆ†æˆåŠŸå¤±è´¥</td><td>-</td><td>-</td></tr><tr><td>get</td><td>è·å–ä»»åŠ¡ç»“æœï¼Œé˜»å¡ç­‰å¾…</td><td>-</td><td>-</td></tr><tr><td>getNow</td><td>-</td><td>è·å–ä»»åŠ¡ç»“æœï¼Œéé˜»å¡ï¼Œè¿˜æœªäº§ç”Ÿç»“æœæ—¶è¿”å› null</td><td>-</td></tr><tr><td>await</td><td>-</td><td>ç­‰å¾…ä»»åŠ¡ç»“æŸï¼Œå¦‚æœä»»åŠ¡å¤±è´¥ï¼Œä¸ä¼šæŠ›å¼‚å¸¸ï¼Œè€Œæ˜¯é€šè¿‡ isSuccess åˆ¤æ–­</td><td>-</td></tr><tr><td>sync</td><td>-</td><td>ç­‰å¾…ä»»åŠ¡ç»“æŸï¼Œå¦‚æœä»»åŠ¡å¤±è´¥ï¼ŒæŠ›å‡ºå¼‚å¸¸</td><td>-</td></tr><tr><td>isSuccess</td><td>-</td><td>åˆ¤æ–­ä»»åŠ¡æ˜¯å¦æˆåŠŸ</td><td>-</td></tr><tr><td>cause</td><td>-</td><td>è·å–å¤±è´¥ä¿¡æ¯ï¼Œéé˜»å¡ï¼Œå¦‚æœæ²¡æœ‰å¤±è´¥ï¼Œè¿”å›null</td><td>-</td></tr><tr><td>addLinstener</td><td>-</td><td>æ·»åŠ å›è°ƒï¼Œå¼‚æ­¥æ¥æ”¶ç»“æœ</td><td>-</td></tr><tr><td>setSuccess</td><td>-</td><td>-</td><td>è®¾ç½®æˆåŠŸç»“æœ</td></tr><tr><td>setFailure</td><td>-</td><td>-</td><td>è®¾ç½®å¤±è´¥ç»“æœ</td></tr></tbody></table><h4 id="ä¾‹1"><a href="#ä¾‹1" class="headerlink" title="ä¾‹1"></a>ä¾‹1</h4><p>åŒæ­¥å¤„ç†ä»»åŠ¡æˆåŠŸ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">DefaultEventLoop</span> <span class="variable">eventExecutors</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultEventLoop</span>();</span><br><span class="line">DefaultPromise&lt;Integer&gt; promise = <span class="keyword">new</span> <span class="title class_">DefaultPromise</span>&lt;&gt;(eventExecutors);</span><br><span class="line"></span><br><span class="line">eventExecutors.execute(()-&gt;&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    log.debug(<span class="string">&quot;set success, &#123;&#125;&quot;</span>,<span class="number">10</span>);</span><br><span class="line">    promise.setSuccess(<span class="number">10</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">log.debug(<span class="string">&quot;start...&quot;</span>);</span><br><span class="line">log.debug(<span class="string">&quot;&#123;&#125;&quot;</span>,promise.getNow()); <span class="comment">// è¿˜æ²¡æœ‰ç»“æœ</span></span><br><span class="line">log.debug(<span class="string">&quot;&#123;&#125;&quot;</span>,promise.get());</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">11:51:53 [DEBUG] [main] c.i.o.DefaultPromiseTest2 - start...</span><br><span class="line">11:51:53 [DEBUG] [main] c.i.o.DefaultPromiseTest2 - null</span><br><span class="line">11:51:54 [DEBUG] [defaultEventLoop-1-1] c.i.o.DefaultPromiseTest2 - set success, 10</span><br><span class="line">11:51:54 [DEBUG] [main] c.i.o.DefaultPromiseTest2 - 10</span><br></pre></td></tr></table></figure><h4 id="ä¾‹2"><a href="#ä¾‹2" class="headerlink" title="ä¾‹2"></a>ä¾‹2</h4><p>å¼‚æ­¥å¤„ç†ä»»åŠ¡æˆåŠŸ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">DefaultEventLoop</span> <span class="variable">eventExecutors</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultEventLoop</span>();</span><br><span class="line">DefaultPromise&lt;Integer&gt; promise = <span class="keyword">new</span> <span class="title class_">DefaultPromise</span>&lt;&gt;(eventExecutors);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®å›è°ƒï¼Œå¼‚æ­¥æ¥æ”¶ç»“æœ</span></span><br><span class="line">promise.addListener(future -&gt; &#123;</span><br><span class="line">    <span class="comment">// è¿™é‡Œçš„ future å°±æ˜¯ä¸Šé¢çš„ promise</span></span><br><span class="line">    log.debug(<span class="string">&quot;&#123;&#125;&quot;</span>,future.getNow());</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç­‰å¾… 1000 åè®¾ç½®æˆåŠŸç»“æœ</span></span><br><span class="line">eventExecutors.execute(()-&gt;&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    log.debug(<span class="string">&quot;set success, &#123;&#125;&quot;</span>,<span class="number">10</span>);</span><br><span class="line">    promise.setSuccess(<span class="number">10</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">log.debug(<span class="string">&quot;start...&quot;</span>);</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">11:49:30 [DEBUG] [main] c.i.o.DefaultPromiseTest2 - start...</span><br><span class="line">11:49:31 [DEBUG] [defaultEventLoop-1-1] c.i.o.DefaultPromiseTest2 - set success, 10</span><br><span class="line">11:49:31 [DEBUG] [defaultEventLoop-1-1] c.i.o.DefaultPromiseTest2 - 10</span><br></pre></td></tr></table></figure><h4 id="ä¾‹3"><a href="#ä¾‹3" class="headerlink" title="ä¾‹3"></a>ä¾‹3</h4><p>åŒæ­¥å¤„ç†ä»»åŠ¡å¤±è´¥ - sync &amp; get</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">DefaultEventLoop</span> <span class="variable">eventExecutors</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultEventLoop</span>();</span><br><span class="line">        DefaultPromise&lt;Integer&gt; promise = <span class="keyword">new</span> <span class="title class_">DefaultPromise</span>&lt;&gt;(eventExecutors);</span><br><span class="line"></span><br><span class="line">        eventExecutors.execute(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">RuntimeException</span> <span class="variable">e</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;error...&quot;</span>);</span><br><span class="line">            log.debug(<span class="string">&quot;set failure, &#123;&#125;&quot;</span>, e.toString());</span><br><span class="line">            promise.setFailure(e);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        log.debug(<span class="string">&quot;start...&quot;</span>);</span><br><span class="line">        log.debug(<span class="string">&quot;&#123;&#125;&quot;</span>, promise.getNow());</span><br><span class="line">        promise.get(); <span class="comment">// sync() ä¹Ÿä¼šå‡ºç°å¼‚å¸¸ï¼Œåªæ˜¯ get ä¼šå†ç”¨ ExecutionException åŒ…ä¸€å±‚å¼‚å¸¸</span></span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">12:11:07 [DEBUG] [main] c.i.o.DefaultPromiseTest2 - start...</span><br><span class="line">12:11:07 [DEBUG] [main] c.i.o.DefaultPromiseTest2 - null</span><br><span class="line">12:11:08 [DEBUG] [defaultEventLoop-1-1] c.i.o.DefaultPromiseTest2 - set failure, java.lang.RuntimeException: error...</span><br><span class="line">Exception in thread &quot;main&quot; java.util.concurrent.ExecutionException: java.lang.RuntimeException: error...</span><br><span class="line">at io.netty.util.concurrent.AbstractFuture.get(AbstractFuture.java:41)</span><br><span class="line">at com.itcast.oio.DefaultPromiseTest2.main(DefaultPromiseTest2.java:34)</span><br><span class="line">Caused by: java.lang.RuntimeException: error...</span><br><span class="line">at com.itcast.oio.DefaultPromiseTest2.lambda$main$0(DefaultPromiseTest2.java:27)</span><br><span class="line">at io.netty.channel.DefaultEventLoop.run(DefaultEventLoop.java:54)</span><br><span class="line">at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:918)</span><br><span class="line">at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)</span><br><span class="line">at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)</span><br><span class="line">at java.lang.Thread.run(Thread.java:745)</span><br></pre></td></tr></table></figure><h4 id="ä¾‹4"><a href="#ä¾‹4" class="headerlink" title="ä¾‹4"></a>ä¾‹4</h4><p>åŒæ­¥å¤„ç†ä»»åŠ¡å¤±è´¥ - await</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">DefaultEventLoop</span> <span class="variable">eventExecutors</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultEventLoop</span>();</span><br><span class="line">DefaultPromise&lt;Integer&gt; promise = <span class="keyword">new</span> <span class="title class_">DefaultPromise</span>&lt;&gt;(eventExecutors);</span><br><span class="line"></span><br><span class="line">eventExecutors.execute(() -&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">RuntimeException</span> <span class="variable">e</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;error...&quot;</span>);</span><br><span class="line">    log.debug(<span class="string">&quot;set failure, &#123;&#125;&quot;</span>, e.toString());</span><br><span class="line">    promise.setFailure(e);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">log.debug(<span class="string">&quot;start...&quot;</span>);</span><br><span class="line">log.debug(<span class="string">&quot;&#123;&#125;&quot;</span>, promise.getNow());</span><br><span class="line">promise.await(); <span class="comment">// ä¸ sync å’Œ get åŒºåˆ«åœ¨äºï¼Œä¸ä¼šæŠ›å¼‚å¸¸</span></span><br><span class="line">log.debug(<span class="string">&quot;result &#123;&#125;&quot;</span>, (promise.isSuccess() ? promise.getNow() : promise.cause()).toString());</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">12:18:53 [DEBUG] [main] c.i.o.DefaultPromiseTest2 - start...</span><br><span class="line">12:18:53 [DEBUG] [main] c.i.o.DefaultPromiseTest2 - null</span><br><span class="line">12:18:54 [DEBUG] [defaultEventLoop-1-1] c.i.o.DefaultPromiseTest2 - set failure, java.lang.RuntimeException: error...</span><br><span class="line">12:18:54 [DEBUG] [main] c.i.o.DefaultPromiseTest2 - result java.lang.RuntimeException: error...</span><br></pre></td></tr></table></figure><h4 id="ä¾‹5"><a href="#ä¾‹5" class="headerlink" title="ä¾‹5"></a>ä¾‹5</h4><p>å¼‚æ­¥å¤„ç†ä»»åŠ¡å¤±è´¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">DefaultEventLoop</span> <span class="variable">eventExecutors</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultEventLoop</span>();</span><br><span class="line">DefaultPromise&lt;Integer&gt; promise = <span class="keyword">new</span> <span class="title class_">DefaultPromise</span>&lt;&gt;(eventExecutors);</span><br><span class="line"></span><br><span class="line">promise.addListener(future -&gt; &#123;</span><br><span class="line">    log.debug(<span class="string">&quot;result &#123;&#125;&quot;</span>, (promise.isSuccess() ? promise.getNow() : promise.cause()).toString());</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">eventExecutors.execute(() -&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">RuntimeException</span> <span class="variable">e</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;error...&quot;</span>);</span><br><span class="line">    log.debug(<span class="string">&quot;set failure, &#123;&#125;&quot;</span>, e.toString());</span><br><span class="line">    promise.setFailure(e);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">log.debug(<span class="string">&quot;start...&quot;</span>);</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">12:04:57 [DEBUG] [main] c.i.o.DefaultPromiseTest2 - start...</span><br><span class="line">12:04:58 [DEBUG] [defaultEventLoop-1-1] c.i.o.DefaultPromiseTest2 - set failure, java.lang.RuntimeException: error...</span><br><span class="line">12:04:58 [DEBUG] [defaultEventLoop-1-1] c.i.o.DefaultPromiseTest2 - result java.lang.RuntimeException: error...</span><br></pre></td></tr></table></figure><h4 id="ä¾‹6"><a href="#ä¾‹6" class="headerlink" title="ä¾‹6"></a>ä¾‹6</h4><p>await æ­»é”æ£€æŸ¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">DefaultEventLoop</span> <span class="variable">eventExecutors</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultEventLoop</span>();</span><br><span class="line">DefaultPromise&lt;Integer&gt; promise = <span class="keyword">new</span> <span class="title class_">DefaultPromise</span>&lt;&gt;(eventExecutors);</span><br><span class="line"></span><br><span class="line">eventExecutors.submit(()-&gt;&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        promise.await();</span><br><span class="line">        <span class="comment">// æ³¨æ„ä¸èƒ½ä»…æ•è· InterruptedException å¼‚å¸¸</span></span><br><span class="line">        <span class="comment">// å¦åˆ™ æ­»é”æ£€æŸ¥æŠ›å‡ºçš„ BlockingOperationException ä¼šç»§ç»­å‘ä¸Šä¼ æ’­</span></span><br><span class="line">        <span class="comment">// è€Œæäº¤çš„ä»»åŠ¡ä¼šè¢«åŒ…è£…ä¸º PromiseTaskï¼Œå®ƒçš„ run æ–¹æ³•ä¸­ä¼š catch æ‰€æœ‰å¼‚å¸¸ç„¶åè®¾ç½®ä¸º Promise çš„å¤±è´¥ç»“æœè€Œä¸ä¼šæŠ›å‡º</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123; </span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(<span class="string">&quot;2&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">eventExecutors.submit(()-&gt;&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;3&quot;</span>);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        promise.await();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(<span class="string">&quot;4&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">io.netty.util.concurrent.BlockingOperationException: DefaultPromise@47499c2a(incomplete)</span><br><span class="line">at io.netty.util.concurrent.DefaultPromise.checkDeadLock(DefaultPromise.java:384)</span><br><span class="line">at io.netty.util.concurrent.DefaultPromise.await(DefaultPromise.java:212)</span><br><span class="line">at com.itcast.oio.DefaultPromiseTest.lambda$main$0(DefaultPromiseTest.java:27)</span><br><span class="line">at io.netty.util.concurrent.PromiseTask$RunnableAdapter.call(PromiseTask.java:38)</span><br><span class="line">at io.netty.util.concurrent.PromiseTask.run(PromiseTask.java:73)</span><br><span class="line">at io.netty.channel.DefaultEventLoop.run(DefaultEventLoop.java:54)</span><br><span class="line">at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:918)</span><br><span class="line">at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)</span><br><span class="line">at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)</span><br><span class="line">at java.lang.Thread.run(Thread.java:745)</span><br><span class="line">io.netty.util.concurrent.BlockingOperationException: DefaultPromise@47499c2a(incomplete)</span><br><span class="line">at io.netty.util.concurrent.DefaultPromise.checkDeadLock(DefaultPromise.java:384)</span><br><span class="line">at io.netty.util.concurrent.DefaultPromise.await(DefaultPromise.java:212)</span><br><span class="line">at com.itcast.oio.DefaultPromiseTest.lambda$main$1(DefaultPromiseTest.java:36)</span><br><span class="line">at io.netty.util.concurrent.PromiseTask$RunnableAdapter.call(PromiseTask.java:38)</span><br><span class="line">at io.netty.util.concurrent.PromiseTask.run(PromiseTask.java:73)</span><br><span class="line">at io.netty.channel.DefaultEventLoop.run(DefaultEventLoop.java:54)</span><br><span class="line">at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:918)</span><br><span class="line">at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)</span><br><span class="line">at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)</span><br><span class="line">at java.lang.Thread.run(Thread.java:745)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-4-Handler-amp-Pipeline"><a href="#3-4-Handler-amp-Pipeline" class="headerlink" title="3.4 Handler &amp; Pipeline"></a>3.4 Handler &amp; Pipeline</h3><p>ChannelHandler ç”¨æ¥å¤„ç† Channel ä¸Šçš„å„ç§äº‹ä»¶ï¼Œåˆ†ä¸ºå…¥ç«™ã€å‡ºç«™ä¸¤ç§ã€‚æ‰€æœ‰ ChannelHandler è¢«è¿æˆä¸€ä¸²ï¼Œå°±æ˜¯ Pipeline</p><ul><li>å…¥ç«™å¤„ç†å™¨é€šå¸¸æ˜¯ ChannelInboundHandlerAdapter çš„å­ç±»ï¼Œä¸»è¦ç”¨æ¥è¯»å–å®¢æˆ·ç«¯æ•°æ®ï¼Œå†™å›ç»“æœ</li><li>å‡ºç«™å¤„ç†å™¨é€šå¸¸æ˜¯ ChannelOutboundHandlerAdapter çš„å­ç±»ï¼Œä¸»è¦å¯¹å†™å›ç»“æœè¿›è¡ŒåŠ å·¥</li></ul><p>æ‰“ä¸ªæ¯”å–»ï¼Œæ¯ä¸ª Channel æ˜¯ä¸€ä¸ªäº§å“çš„åŠ å·¥è½¦é—´ï¼ŒPipeline æ˜¯è½¦é—´ä¸­çš„æµæ°´çº¿ï¼ŒChannelHandler å°±æ˜¯æµæ°´çº¿ä¸Šçš„å„é“å·¥åºï¼Œè€Œåé¢è¦è®²çš„ ByteBuf æ˜¯åŸææ–™ï¼Œç»è¿‡å¾ˆå¤šå·¥åºçš„åŠ å·¥ï¼šå…ˆç»è¿‡ä¸€é“é“å…¥ç«™å·¥åºï¼Œå†ç»è¿‡ä¸€é“é“å‡ºç«™å·¥åºæœ€ç»ˆå˜æˆäº§å“</p><p>å…ˆææ¸…æ¥šé¡ºåºï¼ŒæœåŠ¡ç«¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">ServerBootstrap</span>()</span><br><span class="line">    .group(<span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>())</span><br><span class="line">    .channel(NioServerSocketChannel.class)</span><br><span class="line">    .childHandler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;NioSocketChannel&gt;() &#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(NioSocketChannel ch)</span> &#123;</span><br><span class="line">            ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">ChannelInboundHandlerAdapter</span>()&#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">channelRead</span><span class="params">(ChannelHandlerContext ctx, Object msg)</span> &#123;</span><br><span class="line">                    System.out.println(<span class="number">1</span>);</span><br><span class="line">                    ctx.fireChannelRead(msg); <span class="comment">// 1</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">ChannelInboundHandlerAdapter</span>()&#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">channelRead</span><span class="params">(ChannelHandlerContext ctx, Object msg)</span> &#123;</span><br><span class="line">                    System.out.println(<span class="number">2</span>);</span><br><span class="line">                    ctx.fireChannelRead(msg); <span class="comment">// 2</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">ChannelInboundHandlerAdapter</span>()&#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">channelRead</span><span class="params">(ChannelHandlerContext ctx, Object msg)</span> &#123;</span><br><span class="line">                    System.out.println(<span class="number">3</span>);</span><br><span class="line">                    ctx.channel().write(msg); <span class="comment">// 3</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">ChannelOutboundHandlerAdapter</span>()&#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">write</span><span class="params">(ChannelHandlerContext ctx, Object msg, </span></span><br><span class="line"><span class="params">                                  ChannelPromise promise)</span> &#123;</span><br><span class="line">                    System.out.println(<span class="number">4</span>);</span><br><span class="line">                    ctx.write(msg, promise); <span class="comment">// 4</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">ChannelOutboundHandlerAdapter</span>()&#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">write</span><span class="params">(ChannelHandlerContext ctx, Object msg, </span></span><br><span class="line"><span class="params">                                  ChannelPromise promise)</span> &#123;</span><br><span class="line">                    System.out.println(<span class="number">5</span>);</span><br><span class="line">                    ctx.write(msg, promise); <span class="comment">// 5</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">ChannelOutboundHandlerAdapter</span>()&#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">write</span><span class="params">(ChannelHandlerContext ctx, Object msg, </span></span><br><span class="line"><span class="params">                                  ChannelPromise promise)</span> &#123;</span><br><span class="line">                    System.out.println(<span class="number">6</span>);</span><br><span class="line">                    ctx.write(msg, promise); <span class="comment">// 6</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .bind(<span class="number">8080</span>);</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Bootstrap</span>()</span><br><span class="line">    .group(<span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>())</span><br><span class="line">    .channel(NioSocketChannel.class)</span><br><span class="line">    .handler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;Channel&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(Channel ch)</span> &#123;</span><br><span class="line">            ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">StringEncoder</span>());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .connect(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">8080</span>)</span><br><span class="line">    .addListener((ChannelFutureListener) future -&gt; &#123;</span><br><span class="line">        future.channel().writeAndFlush(<span class="string">&quot;hello,world&quot;</span>);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure><p>æœåŠ¡å™¨ç«¯æ‰“å°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">6</span><br><span class="line">5</span><br><span class="line">4</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼ŒChannelInboundHandlerAdapter æ˜¯æŒ‰ç…§ addLast çš„é¡ºåºæ‰§è¡Œçš„ï¼Œè€Œ ChannelOutboundHandlerAdapter æ˜¯æŒ‰ç…§ addLast çš„é€†åºæ‰§è¡Œçš„ã€‚ChannelPipeline çš„å®ç°æ˜¯ä¸€ä¸ª ChannelHandlerContextï¼ˆåŒ…è£…äº† ChannelHandlerï¼‰ ç»„æˆçš„åŒå‘é“¾è¡¨</p><p><img src="/img/0008.png"></p><ul><li>å…¥ç«™å¤„ç†å™¨ä¸­ï¼Œctx.fireChannelRead(msg) æ˜¯ <strong>è°ƒç”¨ä¸‹ä¸€ä¸ªå…¥ç«™å¤„ç†å™¨</strong><ul><li>å¦‚æœæ³¨é‡Šæ‰ 1 å¤„ä»£ç ï¼Œåˆ™ä»…ä¼šæ‰“å° 1</li><li>å¦‚æœæ³¨é‡Šæ‰ 2 å¤„ä»£ç ï¼Œåˆ™ä»…ä¼šæ‰“å° 1 2</li></ul></li><li>3 å¤„çš„ ctx.channel().write(msg) ä¼š <strong>ä»å°¾éƒ¨å¼€å§‹è§¦å‘</strong> åç»­å‡ºç«™å¤„ç†å™¨çš„æ‰§è¡Œ<ul><li>å¦‚æœæ³¨é‡Šæ‰ 3 å¤„ä»£ç ï¼Œåˆ™ä»…ä¼šæ‰“å° 1 2 3</li></ul></li><li>ç±»ä¼¼çš„ï¼Œå‡ºç«™å¤„ç†å™¨ä¸­ï¼Œctx.write(msg, promise) çš„è°ƒç”¨ä¹Ÿä¼š <strong>è§¦å‘ä¸Šä¸€ä¸ªå‡ºç«™å¤„ç†å™¨</strong><ul><li>å¦‚æœæ³¨é‡Šæ‰ 6 å¤„ä»£ç ï¼Œåˆ™ä»…ä¼šæ‰“å° 1 2 3 6</li></ul></li><li>ctx.channel().write(msg) vs ctx.write(msg)<ul><li>éƒ½æ˜¯è§¦å‘å‡ºç«™å¤„ç†å™¨çš„æ‰§è¡Œ</li><li>ctx.channel().write(msg) ä»å°¾éƒ¨å¼€å§‹æŸ¥æ‰¾å‡ºç«™å¤„ç†å™¨</li><li>ctx.write(msg) æ˜¯ä»å½“å‰èŠ‚ç‚¹æ‰¾ä¸Šä¸€ä¸ªå‡ºç«™å¤„ç†å™¨</li><li>3 å¤„çš„ ctx.channel().write(msg) å¦‚æœæ”¹ä¸º ctx.write(msg) ä»…ä¼šæ‰“å° 1 2 3ï¼Œå› ä¸ºèŠ‚ç‚¹3 ä¹‹å‰æ²¡æœ‰å…¶å®ƒå‡ºç«™å¤„ç†å™¨äº†</li><li>6 å¤„çš„ ctx.write(msg, promise) å¦‚æœæ”¹ä¸º ctx.channel().write(msg) ä¼šæ‰“å° 1 2 3 6 6 6â€¦ å› ä¸º ctx.channel().write() æ˜¯ä»å°¾éƒ¨å¼€å§‹æŸ¥æ‰¾ï¼Œç»“æœåˆæ˜¯èŠ‚ç‚¹6 è‡ªå·±</li></ul></li></ul><p>å›¾1 - æœåŠ¡ç«¯ pipeline è§¦å‘çš„åŸå§‹æµç¨‹ï¼Œå›¾ä¸­æ•°å­—ä»£è¡¨äº†å¤„ç†æ­¥éª¤çš„å…ˆåæ¬¡åº</p><p><img src="/img/0009.png"></p><h3 id="3-5-ByteBuf"><a href="#3-5-ByteBuf" class="headerlink" title="3.5 ByteBuf"></a>3.5 ByteBuf</h3><p>æ˜¯å¯¹å­—èŠ‚æ•°æ®çš„å°è£…</p><h4 id="1ï¼‰åˆ›å»º"><a href="#1ï¼‰åˆ›å»º" class="headerlink" title="1ï¼‰åˆ›å»º"></a>1ï¼‰åˆ›å»º</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ByteBuf</span> <span class="variable">buffer</span> <span class="operator">=</span> ByteBufAllocator.DEFAULT.buffer(<span class="number">10</span>);</span><br><span class="line">log(buffer);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ä»£ç åˆ›å»ºäº†ä¸€ä¸ªé»˜è®¤çš„ ByteBufï¼ˆæ± åŒ–åŸºäºç›´æ¥å†…å­˜çš„ ByteBufï¼‰ï¼Œåˆå§‹å®¹é‡æ˜¯ 10</p><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">read index:0 write index:0 capacity:10</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ log æ–¹æ³•å‚è€ƒå¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">log</span><span class="params">(ByteBuf buffer)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> buffer.readableBytes();</span><br><span class="line">    <span class="type">int</span> <span class="variable">rows</span> <span class="operator">=</span> length / <span class="number">16</span> + (length % <span class="number">15</span> == <span class="number">0</span> ? <span class="number">0</span> : <span class="number">1</span>) + <span class="number">4</span>;</span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">buf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(rows * <span class="number">80</span> * <span class="number">2</span>)</span><br><span class="line">        .append(<span class="string">&quot;read index:&quot;</span>).append(buffer.readerIndex())</span><br><span class="line">        .append(<span class="string">&quot; write index:&quot;</span>).append(buffer.writerIndex())</span><br><span class="line">        .append(<span class="string">&quot; capacity:&quot;</span>).append(buffer.capacity())</span><br><span class="line">        .append(NEWLINE);</span><br><span class="line">    appendPrettyHexDump(buf, buffer);</span><br><span class="line">    System.out.println(buf.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2ï¼‰ç›´æ¥å†…å­˜-vs-å †å†…å­˜"><a href="#2ï¼‰ç›´æ¥å†…å­˜-vs-å †å†…å­˜" class="headerlink" title="2ï¼‰ç›´æ¥å†…å­˜ vs å †å†…å­˜"></a>2ï¼‰ç›´æ¥å†…å­˜ vs å †å†…å­˜</h4><p>å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç æ¥åˆ›å»ºæ± åŒ–åŸºäºå †çš„ ByteBuf</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ByteBuf</span> <span class="variable">buffer</span> <span class="operator">=</span> ByteBufAllocator.DEFAULT.heapBuffer(<span class="number">10</span>);</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç æ¥åˆ›å»ºæ± åŒ–åŸºäºç›´æ¥å†…å­˜çš„ ByteBuf</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ByteBuf</span> <span class="variable">buffer</span> <span class="operator">=</span> ByteBufAllocator.DEFAULT.directBuffer(<span class="number">10</span>);</span><br></pre></td></tr></table></figure><ul><li>ç›´æ¥å†…å­˜åˆ›å»ºå’Œé”€æ¯çš„ä»£ä»·æ˜‚è´µï¼Œä½†è¯»å†™æ€§èƒ½é«˜ï¼ˆå°‘ä¸€æ¬¡å†…å­˜å¤åˆ¶ï¼‰ï¼Œé€‚åˆé…åˆæ± åŒ–åŠŸèƒ½ä¸€èµ·ç”¨</li><li>ç›´æ¥å†…å­˜å¯¹ GC å‹åŠ›å°ï¼Œå› ä¸ºè¿™éƒ¨åˆ†å†…å­˜ä¸å— JVM åƒåœ¾å›æ”¶çš„ç®¡ç†ï¼Œä½†ä¹Ÿè¦æ³¨æ„åŠæ—¶ä¸»åŠ¨é‡Šæ”¾</li></ul><h4 id="3ï¼‰æ± åŒ–-vs-éæ± åŒ–"><a href="#3ï¼‰æ± åŒ–-vs-éæ± åŒ–" class="headerlink" title="3ï¼‰æ± åŒ– vs éæ± åŒ–"></a>3ï¼‰æ± åŒ– vs éæ± åŒ–</h4><p>æ± åŒ–çš„æœ€å¤§æ„ä¹‰åœ¨äºå¯ä»¥é‡ç”¨ ByteBufï¼Œä¼˜ç‚¹æœ‰</p><ul><li>æ²¡æœ‰æ± åŒ–ï¼Œåˆ™æ¯æ¬¡éƒ½å¾—åˆ›å»ºæ–°çš„ ByteBuf å®ä¾‹ï¼Œè¿™ä¸ªæ“ä½œå¯¹ç›´æ¥å†…å­˜ä»£ä»·æ˜‚è´µï¼Œå°±ç®—æ˜¯å †å†…å­˜ï¼Œä¹Ÿä¼šå¢åŠ  GC å‹åŠ›</li><li>æœ‰äº†æ± åŒ–ï¼Œåˆ™å¯ä»¥é‡ç”¨æ± ä¸­ ByteBuf å®ä¾‹ï¼Œå¹¶ä¸”é‡‡ç”¨äº†ä¸ jemalloc ç±»ä¼¼çš„å†…å­˜åˆ†é…ç®—æ³•æå‡åˆ†é…æ•ˆç‡</li><li>é«˜å¹¶å‘æ—¶ï¼Œæ± åŒ–åŠŸèƒ½æ›´èŠ‚çº¦å†…å­˜ï¼Œå‡å°‘å†…å­˜æº¢å‡ºçš„å¯èƒ½</li></ul><p>æ± åŒ–åŠŸèƒ½æ˜¯å¦å¼€å¯ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„ç³»ç»Ÿç¯å¢ƒå˜é‡æ¥è®¾ç½®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-Dio.netty.allocator.type=&#123;unpooled|pooled&#125;</span><br></pre></td></tr></table></figure><ul><li>4.1 ä»¥åï¼Œé Android å¹³å°é»˜è®¤å¯ç”¨æ± åŒ–å®ç°ï¼ŒAndroid å¹³å°å¯ç”¨éæ± åŒ–å®ç°</li><li>4.1 ä¹‹å‰ï¼Œæ± åŒ–åŠŸèƒ½è¿˜ä¸æˆç†Ÿï¼Œé»˜è®¤æ˜¯éæ± åŒ–å®ç°</li></ul><h4 id="4ï¼‰ç»„æˆ"><a href="#4ï¼‰ç»„æˆ" class="headerlink" title="4ï¼‰ç»„æˆ"></a>4ï¼‰ç»„æˆ</h4><p>ByteBuf ç”±å››éƒ¨åˆ†ç»„æˆ</p><p><img src="/img/0010.png"></p><p>æœ€å¼€å§‹è¯»å†™æŒ‡é’ˆéƒ½åœ¨ 0 ä½ç½®</p><h4 id="5ï¼‰å†™å…¥"><a href="#5ï¼‰å†™å…¥" class="headerlink" title="5ï¼‰å†™å…¥"></a>5ï¼‰å†™å…¥</h4><p>æ–¹æ³•åˆ—è¡¨ï¼Œçœç•¥ä¸€äº›ä¸é‡è¦çš„æ–¹æ³•</p><table><thead><tr><th>æ–¹æ³•ç­¾å</th><th>å«ä¹‰</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>writeBoolean(boolean value)</td><td>å†™å…¥ boolean å€¼</td><td>ç”¨ä¸€å­—èŠ‚ 01|00 ä»£è¡¨ true|false</td></tr><tr><td>writeByte(int value)</td><td>å†™å…¥ byte å€¼</td><td></td></tr><tr><td>writeShort(int value)</td><td>å†™å…¥ short å€¼</td><td></td></tr><tr><td>writeInt(int value)</td><td>å†™å…¥ int å€¼</td><td>Big Endianï¼Œå³ 0x250ï¼Œå†™å…¥å 00 00 02 50</td></tr><tr><td>writeIntLE(int value)</td><td>å†™å…¥ int å€¼</td><td>Little Endianï¼Œå³ 0x250ï¼Œå†™å…¥å 50 02 00 00</td></tr><tr><td>writeLong(long value)</td><td>å†™å…¥ long å€¼</td><td></td></tr><tr><td>writeChar(int value)</td><td>å†™å…¥ char å€¼</td><td></td></tr><tr><td>writeFloat(float value)</td><td>å†™å…¥ float å€¼</td><td></td></tr><tr><td>writeDouble(double value)</td><td>å†™å…¥ double å€¼</td><td></td></tr><tr><td>writeBytes(ByteBuf src)</td><td>å†™å…¥ netty çš„ ByteBuf</td><td></td></tr><tr><td>writeBytes(byte[] src)</td><td>å†™å…¥ byte[]</td><td></td></tr><tr><td>writeBytes(ByteBuffer src)</td><td>å†™å…¥ nio çš„ ByteBuffer</td><td></td></tr><tr><td>int writeCharSequence(CharSequence sequence, Charset charset)</td><td>å†™å…¥å­—ç¬¦ä¸²</td><td></td></tr></tbody></table><blockquote><p>æ³¨æ„</p><ul><li>è¿™äº›æ–¹æ³•çš„æœªæŒ‡æ˜è¿”å›å€¼çš„ï¼Œå…¶è¿”å›å€¼éƒ½æ˜¯ ByteBufï¼Œæ„å‘³ç€å¯ä»¥é“¾å¼è°ƒç”¨</li><li>ç½‘ç»œä¼ è¾“ï¼Œé»˜è®¤ä¹ æƒ¯æ˜¯ Big Endian</li></ul></blockquote><p>å…ˆå†™å…¥ 4 ä¸ªå­—èŠ‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">buffer.writeBytes(<span class="keyword">new</span> <span class="title class_">byte</span>[]&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;);</span><br><span class="line">log(buffer);</span><br></pre></td></tr></table></figure><p>ç»“æœæ˜¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">read index:0 write index:4 capacity:10</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 01 02 03 04                                     |....            |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br></pre></td></tr></table></figure><p>å†å†™å…¥ä¸€ä¸ª int æ•´æ•°ï¼Œä¹Ÿæ˜¯ 4 ä¸ªå­—èŠ‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">buffer.writeInt(<span class="number">5</span>);</span><br><span class="line">log(buffer);</span><br></pre></td></tr></table></figure><p>ç»“æœæ˜¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">read index:0 write index:8 capacity:10</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 01 02 03 04 00 00 00 05                         |........        |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ç±»æ–¹æ³•æ˜¯ set å¼€å¤´çš„ä¸€ç³»åˆ—æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥å†™å…¥æ•°æ®ï¼Œä½†ä¸ä¼šæ”¹å˜å†™æŒ‡é’ˆä½ç½®</p><h4 id="6ï¼‰æ‰©å®¹"><a href="#6ï¼‰æ‰©å®¹" class="headerlink" title="6ï¼‰æ‰©å®¹"></a>6ï¼‰æ‰©å®¹</h4><p>å†å†™å…¥ä¸€ä¸ª int æ•´æ•°æ—¶ï¼Œå®¹é‡ä¸å¤Ÿäº†ï¼ˆåˆå§‹å®¹é‡æ˜¯ 10ï¼‰ï¼Œè¿™æ—¶ä¼šå¼•å‘æ‰©å®¹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">buffer.writeInt(<span class="number">6</span>);</span><br><span class="line">log(buffer);</span><br></pre></td></tr></table></figure><p>æ‰©å®¹è§„åˆ™æ˜¯</p><ul><li>å¦‚ä½•å†™å…¥åæ•°æ®å¤§å°æœªè¶…è¿‡ 512ï¼Œåˆ™é€‰æ‹©ä¸‹ä¸€ä¸ª 16 çš„æ•´æ•°å€ï¼Œä¾‹å¦‚å†™å…¥åå¤§å°ä¸º 12 ï¼Œåˆ™æ‰©å®¹å capacity æ˜¯ 16</li><li>å¦‚æœå†™å…¥åæ•°æ®å¤§å°è¶…è¿‡ 512ï¼Œåˆ™é€‰æ‹©ä¸‹ä¸€ä¸ª 2^nï¼Œä¾‹å¦‚å†™å…¥åå¤§å°ä¸º 513ï¼Œåˆ™æ‰©å®¹å capacity æ˜¯ 2^10&#x3D;1024ï¼ˆ2^9&#x3D;512 å·²ç»ä¸å¤Ÿäº†ï¼‰</li><li>æ‰©å®¹ä¸èƒ½è¶…è¿‡ max capacity ä¼šæŠ¥é”™</li></ul><p>ç»“æœæ˜¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">read index:0 write index:12 capacity:16</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 01 02 03 04 00 00 00 05 00 00 00 06             |............    |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br></pre></td></tr></table></figure><h4 id="7ï¼‰è¯»å–"><a href="#7ï¼‰è¯»å–" class="headerlink" title="7ï¼‰è¯»å–"></a>7ï¼‰è¯»å–</h4><p>ä¾‹å¦‚è¯»äº† 4 æ¬¡ï¼Œæ¯æ¬¡ä¸€ä¸ªå­—èŠ‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(buffer.readByte());</span><br><span class="line">System.out.println(buffer.readByte());</span><br><span class="line">System.out.println(buffer.readByte());</span><br><span class="line">System.out.println(buffer.readByte());</span><br><span class="line">log(buffer);</span><br></pre></td></tr></table></figure><p>è¯»è¿‡çš„å†…å®¹ï¼Œå°±å±äºåºŸå¼ƒéƒ¨åˆ†äº†ï¼Œå†è¯»åªèƒ½è¯»é‚£äº›å°šæœªè¯»å–çš„éƒ¨åˆ†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">read index:4 write index:12 capacity:16</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 00 00 00 05 00 00 00 06                         |........        |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br></pre></td></tr></table></figure><p>å¦‚æœéœ€è¦é‡å¤è¯»å– int æ•´æ•° 5ï¼Œæ€ä¹ˆåŠï¼Ÿ</p><p>å¯ä»¥åœ¨ read å‰å…ˆåšä¸ªæ ‡è®° mark</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">buffer.markReaderIndex();</span><br><span class="line">System.out.println(buffer.readInt());</span><br><span class="line">log(buffer);</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">5</span><br><span class="line">read index:8 write index:12 capacity:16</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 00 00 00 06                                     |....            |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br></pre></td></tr></table></figure><p>è¿™æ—¶è¦é‡å¤è¯»å–çš„è¯ï¼Œé‡ç½®åˆ°æ ‡è®°ä½ç½® reset</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">buffer.resetReaderIndex();</span><br><span class="line">log(buffer);</span><br></pre></td></tr></table></figure><p>è¿™æ—¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">read index:4 write index:12 capacity:16</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 00 00 00 05 00 00 00 06                         |........        |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ç§åŠæ³•æ˜¯é‡‡ç”¨ get å¼€å¤´çš„ä¸€ç³»åˆ—æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•ä¸ä¼šæ”¹å˜ read index</p><h4 id="8ï¼‰retain-amp-release"><a href="#8ï¼‰retain-amp-release" class="headerlink" title="8ï¼‰retain &amp; release"></a>8ï¼‰retain &amp; release</h4><p>ç”±äº Netty ä¸­æœ‰å †å¤–å†…å­˜çš„ ByteBuf å®ç°ï¼Œå †å¤–å†…å­˜æœ€å¥½æ˜¯æ‰‹åŠ¨æ¥é‡Šæ”¾ï¼Œè€Œä¸æ˜¯ç­‰ GC åƒåœ¾å›æ”¶ã€‚</p><ul><li>UnpooledHeapByteBuf ä½¿ç”¨çš„æ˜¯ JVM å†…å­˜ï¼Œåªéœ€ç­‰ GC å›æ”¶å†…å­˜å³å¯</li><li>UnpooledDirectByteBuf ä½¿ç”¨çš„å°±æ˜¯ç›´æ¥å†…å­˜äº†ï¼Œéœ€è¦ç‰¹æ®Šçš„æ–¹æ³•æ¥å›æ”¶å†…å­˜</li><li>PooledByteBuf å’Œå®ƒçš„å­ç±»ä½¿ç”¨äº†æ± åŒ–æœºåˆ¶ï¼Œéœ€è¦æ›´å¤æ‚çš„è§„åˆ™æ¥å›æ”¶å†…å­˜</li></ul><blockquote><p>å›æ”¶å†…å­˜çš„æºç å®ç°ï¼Œè¯·å…³æ³¨ä¸‹é¢æ–¹æ³•çš„ä¸åŒå®ç°</p><p><code>protected abstract void deallocate()</code></p></blockquote><p>Netty è¿™é‡Œé‡‡ç”¨äº†å¼•ç”¨è®¡æ•°æ³•æ¥æ§åˆ¶å›æ”¶å†…å­˜ï¼Œæ¯ä¸ª ByteBuf éƒ½å®ç°äº† ReferenceCounted æ¥å£</p><ul><li>æ¯ä¸ª ByteBuf å¯¹è±¡çš„åˆå§‹è®¡æ•°ä¸º 1</li><li>è°ƒç”¨ release æ–¹æ³•è®¡æ•°å‡ 1ï¼Œå¦‚æœè®¡æ•°ä¸º 0ï¼ŒByteBuf å†…å­˜è¢«å›æ”¶</li><li>è°ƒç”¨ retain æ–¹æ³•è®¡æ•°åŠ  1ï¼Œè¡¨ç¤ºè°ƒç”¨è€…æ²¡ç”¨å®Œä¹‹å‰ï¼Œå…¶å®ƒ handler å³ä½¿è°ƒç”¨äº† release ä¹Ÿä¸ä¼šé€ æˆå›æ”¶</li><li>å½“è®¡æ•°ä¸º 0 æ—¶ï¼Œåº•å±‚å†…å­˜ä¼šè¢«å›æ”¶ï¼Œè¿™æ—¶å³ä½¿ ByteBuf å¯¹è±¡è¿˜åœ¨ï¼Œå…¶å„ä¸ªæ–¹æ³•å‡æ— æ³•æ­£å¸¸ä½¿ç”¨</li></ul><p>è°æ¥è´Ÿè´£ release å‘¢ï¼Ÿ</p><p>ä¸æ˜¯æˆ‘ä»¬æƒ³è±¡çš„ï¼ˆä¸€èˆ¬æƒ…å†µä¸‹ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ByteBuf</span> <span class="variable">buf</span> <span class="operator">=</span> ...</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    buf.release();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯·æ€è€ƒï¼Œå› ä¸º pipeline çš„å­˜åœ¨ï¼Œä¸€èˆ¬éœ€è¦å°† ByteBuf ä¼ é€’ç»™ä¸‹ä¸€ä¸ª ChannelHandlerï¼Œå¦‚æœåœ¨ finally ä¸­ release äº†ï¼Œå°±å¤±å»äº†ä¼ é€’æ€§ï¼ˆå½“ç„¶ï¼Œå¦‚æœåœ¨è¿™ä¸ª ChannelHandler å†…è¿™ä¸ª ByteBuf å·²å®Œæˆäº†å®ƒçš„ä½¿å‘½ï¼Œé‚£ä¹ˆä¾¿æ— é¡»å†ä¼ é€’ï¼‰</p><p>åŸºæœ¬è§„åˆ™æ˜¯ï¼Œ<strong>è°æ˜¯æœ€åä½¿ç”¨è€…ï¼Œè°è´Ÿè´£ release</strong>ï¼Œè¯¦ç»†åˆ†æå¦‚ä¸‹</p><ul><li>èµ·ç‚¹ï¼Œå¯¹äº NIO å®ç°æ¥è®²ï¼Œåœ¨ io.netty.channel.nio.AbstractNioByteChannel.NioByteUnsafe#read æ–¹æ³•ä¸­é¦–æ¬¡åˆ›å»º ByteBuf æ”¾å…¥ pipelineï¼ˆline 163 pipeline.fireChannelRead(byteBuf)ï¼‰</li><li>å…¥ç«™ ByteBuf å¤„ç†åŸåˆ™<ul><li>å¯¹åŸå§‹ ByteBuf ä¸åšå¤„ç†ï¼Œè°ƒç”¨ ctx.fireChannelRead(msg) å‘åä¼ é€’ï¼Œè¿™æ—¶æ— é¡» release</li><li>å°†åŸå§‹ ByteBuf è½¬æ¢ä¸ºå…¶å®ƒç±»å‹çš„ Java å¯¹è±¡ï¼Œè¿™æ—¶ ByteBuf å°±æ²¡ç”¨äº†ï¼Œå¿…é¡» release</li><li>å¦‚æœä¸è°ƒç”¨ ctx.fireChannelRead(msg) å‘åä¼ é€’ï¼Œé‚£ä¹ˆä¹Ÿå¿…é¡» release</li><li>æ³¨æ„å„ç§å¼‚å¸¸ï¼Œå¦‚æœ ByteBuf æ²¡æœ‰æˆåŠŸä¼ é€’åˆ°ä¸‹ä¸€ä¸ª ChannelHandlerï¼Œå¿…é¡» release</li><li>å‡è®¾æ¶ˆæ¯ä¸€ç›´å‘åä¼ ï¼Œé‚£ä¹ˆ TailContext ä¼šè´Ÿè´£é‡Šæ”¾æœªå¤„ç†æ¶ˆæ¯ï¼ˆåŸå§‹çš„ ByteBufï¼‰</li></ul></li><li>å‡ºç«™ ByteBuf å¤„ç†åŸåˆ™<ul><li>å‡ºç«™æ¶ˆæ¯æœ€ç»ˆéƒ½ä¼šè½¬ä¸º ByteBuf è¾“å‡ºï¼Œä¸€ç›´å‘å‰ä¼ ï¼Œç”± HeadContext flush å release</li></ul></li><li>å¼‚å¸¸å¤„ç†åŸåˆ™<ul><li>æœ‰æ—¶å€™ä¸æ¸…æ¥š ByteBuf è¢«å¼•ç”¨äº†å¤šå°‘æ¬¡ï¼Œä½†åˆå¿…é¡»å½»åº•é‡Šæ”¾ï¼Œå¯ä»¥å¾ªç¯è°ƒç”¨ release ç›´åˆ°è¿”å› true</li></ul></li></ul><p>TailContext é‡Šæ”¾æœªå¤„ç†æ¶ˆæ¯é€»è¾‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// io.netty.channel.DefaultChannelPipeline#onUnhandledInboundMessage(java.lang.Object)</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onUnhandledInboundMessage</span><span class="params">(Object msg)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        logger.debug(</span><br><span class="line">            <span class="string">&quot;Discarded inbound message &#123;&#125; that reached at the tail of the pipeline. &quot;</span> +</span><br><span class="line">            <span class="string">&quot;Please check your pipeline configuration.&quot;</span>, msg);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        ReferenceCountUtil.release(msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…·ä½“ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// io.netty.util.ReferenceCountUtil#release(java.lang.Object)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">release</span><span class="params">(Object msg)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (msg <span class="keyword">instanceof</span> ReferenceCounted) &#123;</span><br><span class="line">        <span class="keyword">return</span> ((ReferenceCounted) msg).release();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="9ï¼‰slice"><a href="#9ï¼‰slice" class="headerlink" title="9ï¼‰slice"></a>9ï¼‰slice</h4><p>ã€é›¶æ‹·è´ã€‘çš„ä½“ç°ä¹‹ä¸€ï¼Œå¯¹åŸå§‹ ByteBuf è¿›è¡Œåˆ‡ç‰‡æˆå¤šä¸ª ByteBufï¼Œåˆ‡ç‰‡åçš„ ByteBuf å¹¶æ²¡æœ‰å‘ç”Ÿå†…å­˜å¤åˆ¶ï¼Œè¿˜æ˜¯ä½¿ç”¨åŸå§‹ ByteBuf çš„å†…å­˜ï¼Œåˆ‡ç‰‡åçš„ ByteBuf ç»´æŠ¤ç‹¬ç«‹çš„ readï¼Œwrite æŒ‡é’ˆ</p><p><img src="/img/0011.png"></p><p>ä¾‹ï¼ŒåŸå§‹ ByteBuf è¿›è¡Œä¸€äº›åˆå§‹æ“ä½œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ByteBuf</span> <span class="variable">origin</span> <span class="operator">=</span> ByteBufAllocator.DEFAULT.buffer(<span class="number">10</span>);</span><br><span class="line">origin.writeBytes(<span class="keyword">new</span> <span class="title class_">byte</span>[]&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;);</span><br><span class="line">origin.readByte();</span><br><span class="line">System.out.println(ByteBufUtil.prettyHexDump(origin));</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 02 03 04                                        |...             |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br></pre></td></tr></table></figure><p>è¿™æ—¶è°ƒç”¨ slice è¿›è¡Œåˆ‡ç‰‡ï¼Œæ— å‚ slice æ˜¯ä»åŸå§‹ ByteBuf çš„ read index åˆ° write index ä¹‹é—´çš„å†…å®¹è¿›è¡Œåˆ‡ç‰‡ï¼Œåˆ‡ç‰‡åçš„ max capacity è¢«å›ºå®šä¸ºè¿™ä¸ªåŒºé—´çš„å¤§å°ï¼Œå› æ­¤ä¸èƒ½è¿½åŠ  write</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ByteBuf</span> <span class="variable">slice</span> <span class="operator">=</span> origin.slice();</span><br><span class="line">System.out.println(ByteBufUtil.prettyHexDump(slice));</span><br><span class="line"><span class="comment">// slice.writeByte(5); å¦‚æœæ‰§è¡Œï¼Œä¼šæŠ¥ IndexOutOfBoundsException å¼‚å¸¸</span></span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 02 03 04                                        |...             |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br></pre></td></tr></table></figure><p>å¦‚æœåŸå§‹ ByteBuf å†æ¬¡è¯»æ“ä½œï¼ˆåˆè¯»äº†ä¸€ä¸ªå­—èŠ‚ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">origin.readByte();</span><br><span class="line">System.out.println(ByteBufUtil.prettyHexDump(origin));</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 03 04                                           |..              |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br></pre></td></tr></table></figure><p>è¿™æ—¶çš„ slice ä¸å—å½±å“ï¼Œå› ä¸ºå®ƒæœ‰ç‹¬ç«‹çš„è¯»å†™æŒ‡é’ˆ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(ByteBufUtil.prettyHexDump(slice));</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 02 03 04                                        |...             |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br></pre></td></tr></table></figure><p>å¦‚æœ slice çš„å†…å®¹å‘ç”Ÿäº†æ›´æ”¹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">slice.setByte(<span class="number">2</span>, <span class="number">5</span>);</span><br><span class="line">System.out.println(ByteBufUtil.prettyHexDump(slice));</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 02 03 05                                        |...             |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br></pre></td></tr></table></figure><p>è¿™æ—¶ï¼ŒåŸå§‹ ByteBuf ä¹Ÿä¼šå—å½±å“ï¼Œå› ä¸ºåº•å±‚éƒ½æ˜¯åŒä¸€å—å†…å­˜</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(ByteBufUtil.prettyHexDump(origin));</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 03 05                                           |..              |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br></pre></td></tr></table></figure><h4 id="10ï¼‰duplicate"><a href="#10ï¼‰duplicate" class="headerlink" title="10ï¼‰duplicate"></a>10ï¼‰duplicate</h4><p>ã€é›¶æ‹·è´ã€‘çš„ä½“ç°ä¹‹ä¸€ï¼Œå°±å¥½æ¯”æˆªå–äº†åŸå§‹ ByteBuf æ‰€æœ‰å†…å®¹ï¼Œå¹¶ä¸”æ²¡æœ‰ max capacity çš„é™åˆ¶ï¼Œä¹Ÿæ˜¯ä¸åŸå§‹ ByteBuf ä½¿ç”¨åŒä¸€å—åº•å±‚å†…å­˜ï¼Œåªæ˜¯è¯»å†™æŒ‡é’ˆæ˜¯ç‹¬ç«‹çš„</p><p><img src="/img/0012.png"></p><h4 id="11ï¼‰copy"><a href="#11ï¼‰copy" class="headerlink" title="11ï¼‰copy"></a>11ï¼‰copy</h4><p>ä¼šå°†åº•å±‚å†…å­˜æ•°æ®è¿›è¡Œæ·±æ‹·è´ï¼Œå› æ­¤æ— è®ºè¯»å†™ï¼Œéƒ½ä¸åŸå§‹ ByteBuf æ— å…³</p><h4 id="12ï¼‰CompositeByteBuf"><a href="#12ï¼‰CompositeByteBuf" class="headerlink" title="12ï¼‰CompositeByteBuf"></a>12ï¼‰CompositeByteBuf</h4><p>ã€é›¶æ‹·è´ã€‘çš„ä½“ç°ä¹‹ä¸€ï¼Œå¯ä»¥å°†å¤šä¸ª ByteBuf åˆå¹¶ä¸ºä¸€ä¸ªé€»è¾‘ä¸Šçš„ ByteBufï¼Œé¿å…æ‹·è´</p><p>æœ‰ä¸¤ä¸ª ByteBuf å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ByteBuf</span> <span class="variable">buf1</span> <span class="operator">=</span> ByteBufAllocator.DEFAULT.buffer(<span class="number">5</span>);</span><br><span class="line">buf1.writeBytes(<span class="keyword">new</span> <span class="title class_">byte</span>[]&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;);</span><br><span class="line"><span class="type">ByteBuf</span> <span class="variable">buf2</span> <span class="operator">=</span> ByteBufAllocator.DEFAULT.buffer(<span class="number">5</span>);</span><br><span class="line">buf2.writeBytes(<span class="keyword">new</span> <span class="title class_">byte</span>[]&#123;<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>&#125;);</span><br><span class="line">System.out.println(ByteBufUtil.prettyHexDump(buf1));</span><br><span class="line">System.out.println(ByteBufUtil.prettyHexDump(buf2));</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 01 02 03 04 05                                  |.....           |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 06 07 08 09 0a                                  |.....           |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br></pre></td></tr></table></figure><p>ç°åœ¨éœ€è¦ä¸€ä¸ªæ–°çš„ ByteBufï¼Œå†…å®¹æ¥è‡ªäºåˆšæ‰çš„ buf1 å’Œ buf2ï¼Œå¦‚ä½•å®ç°ï¼Ÿ</p><p>æ–¹æ³•1ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ByteBuf</span> <span class="variable">buf3</span> <span class="operator">=</span> ByteBufAllocator.DEFAULT</span><br><span class="line">    .buffer(buf1.readableBytes()+buf2.readableBytes());</span><br><span class="line">buf3.writeBytes(buf1);</span><br><span class="line">buf3.writeBytes(buf2);</span><br><span class="line">System.out.println(ByteBufUtil.prettyHexDump(buf3));</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 01 02 03 04 05 06 07 08 09 0a                   |..........      |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹æ³•å¥½ä¸å¥½ï¼Ÿå›ç­”æ˜¯ä¸å¤ªå¥½ï¼Œå› ä¸ºè¿›è¡Œäº†æ•°æ®çš„å†…å­˜å¤åˆ¶æ“ä½œ</p><p>æ–¹æ³•2ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">CompositeByteBuf</span> <span class="variable">buf3</span> <span class="operator">=</span> ByteBufAllocator.DEFAULT.compositeBuffer();</span><br><span class="line"><span class="comment">// true è¡¨ç¤ºå¢åŠ æ–°çš„ ByteBuf è‡ªåŠ¨é€’å¢ write index, å¦åˆ™ write index ä¼šå§‹ç»ˆä¸º 0</span></span><br><span class="line">buf3.addComponents(<span class="literal">true</span>, buf1, buf2);</span><br></pre></td></tr></table></figure><p>ç»“æœæ˜¯ä¸€æ ·çš„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 01 02 03 04 05 06 07 08 09 0a                   |..........      |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br></pre></td></tr></table></figure><p>CompositeByteBuf æ˜¯ä¸€ä¸ªç»„åˆçš„ ByteBufï¼Œå®ƒå†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ª Component æ•°ç»„ï¼Œæ¯ä¸ª Component ç®¡ç†ä¸€ä¸ª ByteBufï¼Œè®°å½•äº†è¿™ä¸ª ByteBuf ç›¸å¯¹äºæ•´ä½“åç§»é‡ç­‰ä¿¡æ¯ï¼Œä»£è¡¨ç€æ•´ä½“ä¸­æŸä¸€æ®µçš„æ•°æ®ã€‚</p><ul><li>ä¼˜ç‚¹ï¼Œå¯¹å¤–æ˜¯ä¸€ä¸ªè™šæ‹Ÿè§†å›¾ï¼Œç»„åˆè¿™äº› ByteBuf ä¸ä¼šäº§ç”Ÿå†…å­˜å¤åˆ¶</li><li>ç¼ºç‚¹ï¼Œå¤æ‚äº†å¾ˆå¤šï¼Œå¤šæ¬¡æ“ä½œä¼šå¸¦æ¥æ€§èƒ½çš„æŸè€—</li></ul><h4 id="13ï¼‰Unpooled"><a href="#13ï¼‰Unpooled" class="headerlink" title="13ï¼‰Unpooled"></a>13ï¼‰Unpooled</h4><p>Unpooled æ˜¯ä¸€ä¸ªå·¥å…·ç±»ï¼Œç±»å¦‚å…¶åï¼Œæä¾›äº†éæ± åŒ–çš„ ByteBuf åˆ›å»ºã€ç»„åˆã€å¤åˆ¶ç­‰æ“ä½œ</p><p>è¿™é‡Œä»…ä»‹ç»å…¶è·Ÿã€é›¶æ‹·è´ã€‘ç›¸å…³çš„ wrappedBuffer æ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥åŒ…è£… ByteBuf</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ByteBuf</span> <span class="variable">buf1</span> <span class="operator">=</span> ByteBufAllocator.DEFAULT.buffer(<span class="number">5</span>);</span><br><span class="line">buf1.writeBytes(<span class="keyword">new</span> <span class="title class_">byte</span>[]&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;);</span><br><span class="line"><span class="type">ByteBuf</span> <span class="variable">buf2</span> <span class="operator">=</span> ByteBufAllocator.DEFAULT.buffer(<span class="number">5</span>);</span><br><span class="line">buf2.writeBytes(<span class="keyword">new</span> <span class="title class_">byte</span>[]&#123;<span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å½“åŒ…è£… ByteBuf ä¸ªæ•°è¶…è¿‡ä¸€ä¸ªæ—¶, åº•å±‚ä½¿ç”¨äº† CompositeByteBuf</span></span><br><span class="line"><span class="type">ByteBuf</span> <span class="variable">buf3</span> <span class="operator">=</span> Unpooled.wrappedBuffer(buf1, buf2);</span><br><span class="line">System.out.println(ByteBufUtil.prettyHexDump(buf3));</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 01 02 03 04 05 06 07 08 09 0a                   |..........      |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ç”¨æ¥åŒ…è£…æ™®é€šå­—èŠ‚æ•°ç»„ï¼Œåº•å±‚ä¹Ÿä¸ä¼šæœ‰æ‹·è´æ“ä½œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ByteBuf</span> <span class="variable">buf4</span> <span class="operator">=</span> Unpooled.wrappedBuffer(<span class="keyword">new</span> <span class="title class_">byte</span>[]&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;, <span class="keyword">new</span> <span class="title class_">byte</span>[]&#123;<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&#125;);</span><br><span class="line">System.out.println(buf4.getClass());</span><br><span class="line">System.out.println(ByteBufUtil.prettyHexDump(buf4));</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">class io.netty.buffer.CompositeByteBuf</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 01 02 03 04 05 06                               |......          |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br></pre></td></tr></table></figure><h4 id="ğŸ’¡-ByteBuf-ä¼˜åŠ¿"><a href="#ğŸ’¡-ByteBuf-ä¼˜åŠ¿" class="headerlink" title="ğŸ’¡ ByteBuf ä¼˜åŠ¿"></a>ğŸ’¡ ByteBuf ä¼˜åŠ¿</h4><ul><li>æ± åŒ– - å¯ä»¥é‡ç”¨æ± ä¸­ ByteBuf å®ä¾‹ï¼Œæ›´èŠ‚çº¦å†…å­˜ï¼Œå‡å°‘å†…å­˜æº¢å‡ºçš„å¯èƒ½</li><li>è¯»å†™æŒ‡é’ˆåˆ†ç¦»ï¼Œä¸éœ€è¦åƒ ByteBuffer ä¸€æ ·åˆ‡æ¢è¯»å†™æ¨¡å¼</li><li>å¯ä»¥è‡ªåŠ¨æ‰©å®¹</li><li>æ”¯æŒé“¾å¼è°ƒç”¨ï¼Œä½¿ç”¨æ›´æµç•…</li><li>å¾ˆå¤šåœ°æ–¹ä½“ç°é›¶æ‹·è´ï¼Œä¾‹å¦‚ sliceã€duplicateã€CompositeByteBuf</li></ul><h2 id="4-åŒå‘é€šä¿¡"><a href="#4-åŒå‘é€šä¿¡" class="headerlink" title="4. åŒå‘é€šä¿¡"></a>4. åŒå‘é€šä¿¡</h2><h3 id="4-1-ç»ƒä¹ "><a href="#4-1-ç»ƒä¹ " class="headerlink" title="4.1 ç»ƒä¹ "></a>4.1 ç»ƒä¹ </h3><p>å®ç°ä¸€ä¸ª echo server</p><p>ç¼–å†™ server</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">ServerBootstrap</span>()</span><br><span class="line">    .group(<span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>())</span><br><span class="line">    .channel(NioServerSocketChannel.class)</span><br><span class="line">    .childHandler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;NioSocketChannel&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(NioSocketChannel ch)</span> &#123;</span><br><span class="line">            ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">ChannelInboundHandlerAdapter</span>()&#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">channelRead</span><span class="params">(ChannelHandlerContext ctx, Object msg)</span> &#123;</span><br><span class="line">                    <span class="type">ByteBuf</span> <span class="variable">buffer</span> <span class="operator">=</span> (ByteBuf) msg;</span><br><span class="line">                    System.out.println(buffer.toString(Charset.defaultCharset()));</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// å»ºè®®ä½¿ç”¨ ctx.alloc() åˆ›å»º ByteBuf</span></span><br><span class="line">                    <span class="type">ByteBuf</span> <span class="variable">response</span> <span class="operator">=</span> ctx.alloc().buffer();</span><br><span class="line">                    response.writeBytes(buffer);</span><br><span class="line">                    ctx.writeAndFlush(response);</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// æ€è€ƒï¼šéœ€è¦é‡Šæ”¾ buffer å—</span></span><br><span class="line">                    <span class="comment">// æ€è€ƒï¼šéœ€è¦é‡Šæ”¾ response å—</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;).bind(<span class="number">8080</span>);</span><br></pre></td></tr></table></figure><p>ç¼–å†™ client</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NioEventLoopGroup</span> <span class="variable">group</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line"><span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bootstrap</span>()</span><br><span class="line">    .group(group)</span><br><span class="line">    .channel(NioSocketChannel.class)</span><br><span class="line">    .handler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;NioSocketChannel&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(NioSocketChannel ch)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">            ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">StringEncoder</span>());</span><br><span class="line">            ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">ChannelInboundHandlerAdapter</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">channelRead</span><span class="params">(ChannelHandlerContext ctx, Object msg)</span> &#123;</span><br><span class="line">                    <span class="type">ByteBuf</span> <span class="variable">buffer</span> <span class="operator">=</span> (ByteBuf) msg;</span><br><span class="line">                    System.out.println(buffer.toString(Charset.defaultCharset()));</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// æ€è€ƒï¼šéœ€è¦é‡Šæ”¾ buffer å—</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;).connect(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">8080</span>).sync().channel();</span><br><span class="line"></span><br><span class="line">channel.closeFuture().addListener(future -&gt; &#123;</span><br><span class="line">    group.shutdownGracefully();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">    <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">line</span> <span class="operator">=</span> scanner.nextLine();</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;q&quot;</span>.equals(line)) &#123;</span><br><span class="line">            channel.close();</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        channel.writeAndFlush(line);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;).start();</span><br></pre></td></tr></table></figure><h3 id="ğŸ’¡-è¯»å’Œå†™çš„è¯¯è§£"><a href="#ğŸ’¡-è¯»å’Œå†™çš„è¯¯è§£" class="headerlink" title="ğŸ’¡ è¯»å’Œå†™çš„è¯¯è§£"></a>ğŸ’¡ è¯»å’Œå†™çš„è¯¯è§£</h3><p>æˆ‘æœ€åˆåœ¨è®¤è¯†ä¸Šæœ‰è¿™æ ·çš„è¯¯åŒºï¼Œè®¤ä¸ºåªæœ‰åœ¨ nettyï¼Œnio è¿™æ ·çš„å¤šè·¯å¤ç”¨ IO æ¨¡å‹æ—¶ï¼Œè¯»å†™æ‰ä¸ä¼šç›¸äº’é˜»å¡ï¼Œæ‰å¯ä»¥å®ç°é«˜æ•ˆçš„åŒå‘é€šä¿¡ï¼Œä½†å®é™…ä¸Šï¼ŒJava Socket æ˜¯å…¨åŒå·¥çš„ï¼šåœ¨ä»»æ„æ—¶åˆ»ï¼Œçº¿è·¯ä¸Šå­˜åœ¨<code>A åˆ° B</code> å’Œ <code>B åˆ° A</code> çš„åŒå‘ä¿¡å·ä¼ è¾“ã€‚å³ä½¿æ˜¯é˜»å¡ IOï¼Œè¯»å’Œå†™æ˜¯å¯ä»¥åŒæ—¶è¿›è¡Œçš„ï¼Œåªè¦åˆ†åˆ«é‡‡ç”¨è¯»çº¿ç¨‹å’Œå†™çº¿ç¨‹å³å¯ï¼Œè¯»ä¸ä¼šé˜»å¡å†™ã€å†™ä¹Ÿä¸ä¼šé˜»å¡è¯»</p><p>ä¾‹å¦‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestServer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ServerSocket</span> <span class="variable">ss</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerSocket</span>(<span class="number">8888</span>);</span><br><span class="line">        <span class="type">Socket</span> <span class="variable">s</span> <span class="operator">=</span> ss.accept();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(s.getInputStream()));</span><br><span class="line">                <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                    System.out.println(reader.readLine());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">BufferedWriter</span> <span class="variable">writer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedWriter</span>(<span class="keyword">new</span> <span class="title class_">OutputStreamWriter</span>(s.getOutputStream()));</span><br><span class="line">                <span class="comment">// ä¾‹å¦‚åœ¨è¿™ä¸ªä½ç½®åŠ å…¥ thread çº§åˆ«æ–­ç‚¹ï¼Œå¯ä»¥å‘ç°å³ä½¿ä¸å†™å…¥æ•°æ®ï¼Œä¹Ÿä¸å¦¨ç¢å‰é¢çº¿ç¨‹è¯»å–å®¢æˆ·ç«¯æ•°æ®</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">                    writer.write(String.valueOf(i));</span><br><span class="line">                    writer.newLine();</span><br><span class="line">                    writer.flush();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestClient</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">Socket</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Socket</span>(<span class="string">&quot;localhost&quot;</span>, <span class="number">8888</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(s.getInputStream()));</span><br><span class="line">                <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                    System.out.println(reader.readLine());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">BufferedWriter</span> <span class="variable">writer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedWriter</span>(<span class="keyword">new</span> <span class="title class_">OutputStreamWriter</span>(s.getOutputStream()));</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">                    writer.write(String.valueOf(i));</span><br><span class="line">                    writer.newLine();</span><br><span class="line">                    writer.flush();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> JAVA </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¸­é—´ä»¶ </tag>
            
            <tag> Netty </tag>
            
            <tag> ç½‘ç»œç¼–ç¨‹ </tag>
            
            <tag> æ¡†æ¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NIOåŸºç¡€</title>
      <link href="/2022/11/22/Netty01-nio/"/>
      <url>/2022/11/22/Netty01-nio/</url>
      
        <content type="html"><![CDATA[<p><img src="/../images/Netty01-nio/202211171905300.png" alt="image-20221117190504231"></p><h1 id="ä¸€-NIO-åŸºç¡€"><a href="#ä¸€-NIO-åŸºç¡€" class="headerlink" title="ä¸€. NIO åŸºç¡€"></a>ä¸€. NIO åŸºç¡€</h1><p>non-blocking io éé˜»å¡ IO</p><h2 id="ä¸‰å¤§ç»„ä»¶"><a href="#ä¸‰å¤§ç»„ä»¶" class="headerlink" title="ä¸‰å¤§ç»„ä»¶"></a>ä¸‰å¤§ç»„ä»¶</h2><h3 id="Channel-amp-Buffer"><a href="#Channel-amp-Buffer" class="headerlink" title="Channel &amp; Buffer"></a>Channel &amp; Buffer</h3><p>channel æœ‰ä¸€ç‚¹ç±»ä¼¼äº streamï¼Œå®ƒå°±æ˜¯è¯»å†™æ•°æ®çš„<strong>åŒå‘é€šé“</strong>ï¼Œå¯ä»¥ä» channel å°†æ•°æ®è¯»å…¥ bufferï¼Œä¹Ÿå¯ä»¥å°† buffer çš„æ•°æ®å†™å…¥ channelï¼Œè€Œä¹‹å‰çš„ stream è¦ä¹ˆæ˜¯è¾“å…¥ï¼Œè¦ä¹ˆæ˜¯è¾“å‡ºï¼Œchannel æ¯” stream æ›´ä¸ºåº•å±‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">channel --&gt; buffer</span><br><span class="line">buffer --&gt; channel</span><br></pre></td></tr></table></figure><p>å¸¸è§çš„ Channel æœ‰</p><ul><li>FileChannel  æ–‡ä»¶</li><li>DatagramChannel   ç”¨æ¥åšUDPçš„</li><li>SocketChannel ç”¨æ¥åšTCPçš„ï¼ŒæœåŠ¡å™¨ã€å®¢æˆ·ç«¯éƒ½èƒ½ç”¨</li><li>ServerSocketChannel ç”¨æ¥åšTCPçš„ï¼ŒæœåŠ¡å™¨</li></ul><p>bufferå†…å­˜ç¼“å†²åŒºï¼Œbuffer åˆ™ç”¨æ¥ç¼“å†²è¯»å†™æ•°æ®ï¼Œå¸¸è§çš„ buffer æœ‰</p><ul><li>ByteBuffer æŠ½è±¡ç±» ä¸‹è¾¹æ˜¯å®ç°ç±»<ul><li>MappedByteBuffer</li><li>DirectByteBuffer</li><li>HeapByteBuffer</li></ul></li><li>ShortBuffer</li><li>IntBuffer</li><li>LongBuffer</li><li>FloatBuffer</li><li>DoubleBuffer</li><li>CharBuffer</li></ul><p>bufferç›¸å½“äºåº”ç”¨ç¨‹åºè·Ÿæ–‡ä»¶å’Œç½‘ç»œçš„ä¸€ä¸ªæ¡¥æ¢ã€‚</p><h3 id="Selector"><a href="#Selector" class="headerlink" title="Selector"></a>Selector</h3><p>é€‰æ‹©å™¨</p><p>selector å•ä»å­—é¢æ„æ€ä¸å¥½ç†è§£ï¼Œéœ€è¦ç»“åˆæœåŠ¡å™¨çš„è®¾è®¡æ¼”åŒ–æ¥ç†è§£å®ƒçš„ç”¨é€”</p><h4 id="å¤šçº¿ç¨‹ç‰ˆè®¾è®¡"><a href="#å¤šçº¿ç¨‹ç‰ˆè®¾è®¡" class="headerlink" title="å¤šçº¿ç¨‹ç‰ˆè®¾è®¡"></a>å¤šçº¿ç¨‹ç‰ˆè®¾è®¡</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">subgraph å¤šçº¿ç¨‹ç‰ˆ</span><br><span class="line">t1(thread) --&gt; s1(socket1)</span><br><span class="line">t2(thread) --&gt; s2(socket2)</span><br><span class="line">t3(thread) --&gt; s3(socket3)</span><br><span class="line">end</span><br></pre></td></tr></table></figure><h4 id="âš ï¸-å¤šçº¿ç¨‹ç‰ˆç¼ºç‚¹"><a href="#âš ï¸-å¤šçº¿ç¨‹ç‰ˆç¼ºç‚¹" class="headerlink" title="âš ï¸ å¤šçº¿ç¨‹ç‰ˆç¼ºç‚¹"></a>âš ï¸ å¤šçº¿ç¨‹ç‰ˆç¼ºç‚¹</h4><ul><li>å†…å­˜å ç”¨é«˜ï¼ŒæœåŠ¡å™¨åœ¨é«˜è¿æ¥æ•°æ—¶å¯èƒ½ä¼šç˜«ç—ª</li><li>çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢æˆæœ¬é«˜</li><li>åªé€‚åˆè¿æ¥æ•°å°‘çš„åœºæ™¯</li></ul><h4 id="çº¿ç¨‹æ± ç‰ˆè®¾è®¡"><a href="#çº¿ç¨‹æ± ç‰ˆè®¾è®¡" class="headerlink" title="çº¿ç¨‹æ± ç‰ˆè®¾è®¡"></a>çº¿ç¨‹æ± ç‰ˆè®¾è®¡</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">subgraph çº¿ç¨‹æ± ç‰ˆ</span><br><span class="line">t4(thread) --&gt; s4(socket1)</span><br><span class="line">t5(thread) --&gt; s5(socket2)</span><br><span class="line">t4(thread) -.-&gt; s6(socket3)</span><br><span class="line">t5(thread) -.-&gt; s7(socket4)</span><br><span class="line">end</span><br></pre></td></tr></table></figure><h4 id="âš ï¸-çº¿ç¨‹æ± ç‰ˆç¼ºç‚¹"><a href="#âš ï¸-çº¿ç¨‹æ± ç‰ˆç¼ºç‚¹" class="headerlink" title="âš ï¸ çº¿ç¨‹æ± ç‰ˆç¼ºç‚¹"></a>âš ï¸ çº¿ç¨‹æ± ç‰ˆç¼ºç‚¹</h4><ul><li>å·¥ä½œåœ¨é˜»å¡æ¨¡å¼ä¸‹</li></ul><ul><li>é˜»å¡æ¨¡å¼ä¸‹ï¼Œä¸€ä¸ªçº¿ç¨‹ä»…èƒ½å¤„ç†ä¸€ä¸ª socket è¿æ¥ï¼ˆåŒä¸€æ—¶åˆ»ï¼‰</li><li>ä»…é€‚åˆçŸ­è¿æ¥åœºæ™¯ï¼Œsocketåšå®Œå¤„ç†åï¼Œç«‹é©¬æ–­å¼€è¿æ¥ï¼Œè®©çº¿ç¨‹å¤„ç†ä¸‹ä¸€ä¸ªè¯·æ±‚ã€‚</li></ul><h4 id="selector-ç‰ˆè®¾è®¡"><a href="#selector-ç‰ˆè®¾è®¡" class="headerlink" title="selector ç‰ˆè®¾è®¡"></a>selector ç‰ˆè®¾è®¡</h4><p>selector çš„ä½œç”¨å°±æ˜¯é…åˆä¸€ä¸ªçº¿ç¨‹æ¥ç®¡ç†å¤šä¸ª channelï¼Œè·å–è¿™äº› channel ä¸Šå‘ç”Ÿçš„äº‹ä»¶ï¼Œè¿™äº› channel å·¥ä½œåœ¨éé˜»å¡æ¨¡å¼ä¸‹ï¼Œä¸ä¼šè®©çº¿ç¨‹åŠæ­»åœ¨ä¸€ä¸ª channel ä¸Šã€‚é€‚åˆè¿æ¥æ•°ç‰¹åˆ«å¤šï¼Œä½†æµé‡ä½çš„åœºæ™¯ï¼ˆlow trafficï¼‰</p><ul><li><p>threadè®¤ä¸ºä¸ºæœåŠ¡å‘˜</p></li><li><p>channelè®¤ä¸ºæ˜¯é¡¾å®¢</p></li><li><p>selectorèƒ½å¤Ÿæ£€æµ‹é¡¾å®¢çš„ä¸€ä¸¾ä¸€åŠ¨</p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">subgraph selector ç‰ˆ</span><br><span class="line">thread --&gt; selector</span><br><span class="line">selector --&gt; c1(channel)</span><br><span class="line">selector --&gt; c2(channel)</span><br><span class="line">selector --&gt; c3(channel)</span><br><span class="line">end</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master../images/Netty01-nio/202211171930382.png" alt="image-20221117193022324"></p><p>è°ƒç”¨ selector çš„ select() ä¼šé˜»å¡ç›´åˆ° channel å‘ç”Ÿäº†è¯»å†™å°±ç»ªäº‹ä»¶ï¼Œè¿™äº›äº‹ä»¶å‘ç”Ÿï¼Œselect æ–¹æ³•å°±ä¼šè¿”å›è¿™äº›äº‹ä»¶äº¤ç»™ thread æ¥å¤„ç†</p><h2 id="ByteBuffer"><a href="#ByteBuffer" class="headerlink" title="ByteBuffer"></a>ByteBuffer</h2><p>æœ‰ä¸€æ™®é€šæ–‡æœ¬æ–‡ä»¶ data.txtï¼Œå†…å®¹ä¸º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1234567890abcd</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ FileChannel æ¥è¯»å–æ–‡ä»¶å†…å®¹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChannelDemo1</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">RandomAccessFile</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RandomAccessFile</span>(<span class="string">&quot;helloword/data.txt&quot;</span>, <span class="string">&quot;rw&quot;</span>)) &#123;</span><br><span class="line">            <span class="type">FileChannel</span> <span class="variable">channel</span> <span class="operator">=</span> file.getChannel();</span><br><span class="line">            <span class="type">ByteBuffer</span> <span class="variable">buffer</span> <span class="operator">=</span> ByteBuffer.allocate(<span class="number">10</span>);</span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                <span class="comment">// å‘ buffer å†™å…¥</span></span><br><span class="line">                <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> channel.read(buffer);</span><br><span class="line">                log.debug(<span class="string">&quot;è¯»åˆ°å­—èŠ‚æ•°ï¼š&#123;&#125;&quot;</span>, len);</span><br><span class="line">                <span class="keyword">if</span> (len == -<span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// åˆ‡æ¢ buffer è¯»æ¨¡å¼</span></span><br><span class="line">                buffer.flip();</span><br><span class="line">                <span class="keyword">while</span>(buffer.hasRemaining()) &#123;</span><br><span class="line">                    log.debug(<span class="string">&quot;&#123;&#125;&quot;</span>, (<span class="type">char</span>)buffer.get());</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// åˆ‡æ¢ buffer å†™æ¨¡å¼</span></span><br><span class="line">                buffer.clear();</span><br><span class="line">            &#125; <span class="keyword">while</span> (<span class="literal">true</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">10:39:03 [DEBUG] [main] c.i.n.ChannelDemo1 - è¯»åˆ°å­—èŠ‚æ•°ï¼š10</span><br><span class="line">10:39:03 [DEBUG] [main] c.i.n.ChannelDemo1 - 1</span><br><span class="line">10:39:03 [DEBUG] [main] c.i.n.ChannelDemo1 - 2</span><br><span class="line">10:39:03 [DEBUG] [main] c.i.n.ChannelDemo1 - 3</span><br><span class="line">10:39:03 [DEBUG] [main] c.i.n.ChannelDemo1 - 4</span><br><span class="line">10:39:03 [DEBUG] [main] c.i.n.ChannelDemo1 - 5</span><br><span class="line">10:39:03 [DEBUG] [main] c.i.n.ChannelDemo1 - 6</span><br><span class="line">10:39:03 [DEBUG] [main] c.i.n.ChannelDemo1 - 7</span><br><span class="line">10:39:03 [DEBUG] [main] c.i.n.ChannelDemo1 - 8</span><br><span class="line">10:39:03 [DEBUG] [main] c.i.n.ChannelDemo1 - 9</span><br><span class="line">10:39:03 [DEBUG] [main] c.i.n.ChannelDemo1 - 0</span><br><span class="line">10:39:03 [DEBUG] [main] c.i.n.ChannelDemo1 - è¯»åˆ°å­—èŠ‚æ•°ï¼š4</span><br><span class="line">10:39:03 [DEBUG] [main] c.i.n.ChannelDemo1 - a</span><br><span class="line">10:39:03 [DEBUG] [main] c.i.n.ChannelDemo1 - b</span><br><span class="line">10:39:03 [DEBUG] [main] c.i.n.ChannelDemo1 - c</span><br><span class="line">10:39:03 [DEBUG] [main] c.i.n.ChannelDemo1 - d</span><br><span class="line">10:39:03 [DEBUG] [main] c.i.n.ChannelDemo1 - è¯»åˆ°å­—èŠ‚æ•°ï¼š-1</span><br></pre></td></tr></table></figure><h3 id="ByteBuffer-æ­£ç¡®ä½¿ç”¨å§¿åŠ¿"><a href="#ByteBuffer-æ­£ç¡®ä½¿ç”¨å§¿åŠ¿" class="headerlink" title="ByteBuffer æ­£ç¡®ä½¿ç”¨å§¿åŠ¿"></a>ByteBuffer æ­£ç¡®ä½¿ç”¨å§¿åŠ¿</h3><ol><li>å‘ buffer å†™å…¥æ•°æ®ï¼Œä¾‹å¦‚è°ƒç”¨ channel.read(buffer)</li><li>è°ƒç”¨ flip() åˆ‡æ¢è‡³<strong>è¯»æ¨¡å¼</strong></li><li>ä» buffer è¯»å–æ•°æ®ï¼Œä¾‹å¦‚è°ƒç”¨ buffer.get()</li><li>è°ƒç”¨ clear() æˆ– compact() åˆ‡æ¢è‡³<strong>å†™æ¨¡å¼</strong></li><li>é‡å¤ 1~4 æ­¥éª¤</li></ol><h3 id="ByteBuffer-ç»“æ„"><a href="#ByteBuffer-ç»“æ„" class="headerlink" title="ByteBuffer ç»“æ„"></a>ByteBuffer ç»“æ„</h3><p>ByteBuffer æœ‰ä»¥ä¸‹é‡è¦å±æ€§</p><ul><li>capacity å®¹é‡</li><li>position è¯»å†™æŒ‡é’ˆ</li><li>limit è¯»å†™é™åˆ¶</li></ul><p>ä¸€å¼€å§‹</p><p><img src="/../images/Netty01-nio/0021.png"></p><p>å†™æ¨¡å¼ä¸‹ï¼Œposition æ˜¯å†™å…¥ä½ç½®ï¼Œlimit ç­‰äºå®¹é‡ï¼Œä¸‹å›¾è¡¨ç¤ºå†™å…¥äº† 4 ä¸ªå­—èŠ‚åçš„çŠ¶æ€</p><p><img src="/../images/Netty01-nio/0018.png"></p><p>flip åŠ¨ä½œå‘ç”Ÿåï¼Œposition åˆ‡æ¢ä¸ºè¯»å–ä½ç½®ï¼Œlimit åˆ‡æ¢ä¸ºè¯»å–é™åˆ¶ã€‚ä»å“ªè¯»åˆ°å“ª</p><p>positionå˜ä¸ºå¼€å§‹ä½ç½®</p><p>limitåˆ—æ¢åˆ°ä¹‹å‰position</p><p><img src="/../images/Netty01-nio/0019.png"></p><p>è¯»å– 4 ä¸ªå­—èŠ‚åï¼ŒçŠ¶æ€</p><p><img src="/../images/Netty01-nio/0020.png"></p><p>clear åŠ¨ä½œå‘ç”Ÿåï¼ŒçŠ¶æ€</p><p><img src="/../images/Netty01-nio/0021.png"></p><p>compact æ–¹æ³•ï¼Œæ˜¯æŠŠæœªè¯»å®Œçš„éƒ¨åˆ†å‘å‰å‹ç¼©ï¼Œç„¶ååˆ‡æ¢è‡³å†™æ¨¡å¼ã€‚</p><p><strong>compactä»ä¸Šæ¬¡æœªè¯»å®Œçš„åœ°æ–¹å¼€å§‹å†™ã€‚</strong></p><p><img src="/../images/Netty01-nio/0022.png"></p><h4 id="ğŸ’¡-è°ƒè¯•å·¥å…·ç±»"><a href="#ğŸ’¡-è°ƒè¯•å·¥å…·ç±»" class="headerlink" title="ğŸ’¡ è°ƒè¯•å·¥å…·ç±»"></a>ğŸ’¡ è°ƒè¯•å·¥å…·ç±»</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ByteBufferUtil</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">char</span>[] BYTE2CHAR = <span class="keyword">new</span> <span class="title class_">char</span>[<span class="number">256</span>];</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">char</span>[] HEXDUMP_TABLE = <span class="keyword">new</span> <span class="title class_">char</span>[<span class="number">256</span> * <span class="number">4</span>];</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] HEXPADDING = <span class="keyword">new</span> <span class="title class_">String</span>[<span class="number">16</span>];</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] HEXDUMP_ROWPREFIXES = <span class="keyword">new</span> <span class="title class_">String</span>[<span class="number">65536</span> &gt;&gt;&gt; <span class="number">4</span>];</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] BYTE2HEX = <span class="keyword">new</span> <span class="title class_">String</span>[<span class="number">256</span>];</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] BYTEPADDING = <span class="keyword">new</span> <span class="title class_">String</span>[<span class="number">16</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">char</span>[] DIGITS = <span class="string">&quot;0123456789abcdef&quot;</span>.toCharArray();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</span><br><span class="line">            HEXDUMP_TABLE[i &lt;&lt; <span class="number">1</span>] = DIGITS[i &gt;&gt;&gt; <span class="number">4</span> &amp; <span class="number">0x0F</span>];</span><br><span class="line">            HEXDUMP_TABLE[(i &lt;&lt; <span class="number">1</span>) + <span class="number">1</span>] = DIGITS[i &amp; <span class="number">0x0F</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> i;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Generate the lookup table for hex dump paddings</span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; HEXPADDING.length; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">padding</span> <span class="operator">=</span> HEXPADDING.length - i;</span><br><span class="line">            <span class="type">StringBuilder</span> <span class="variable">buf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(padding * <span class="number">3</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; padding; j++) &#123;</span><br><span class="line">                buf.append(<span class="string">&quot;   &quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            HEXPADDING[i] = buf.toString();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Generate the lookup table for the start-offset header in each row (up to 64KiB).</span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; HEXDUMP_ROWPREFIXES.length; i++) &#123;</span><br><span class="line">            <span class="type">StringBuilder</span> <span class="variable">buf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(<span class="number">12</span>);</span><br><span class="line">            buf.append(NEWLINE);</span><br><span class="line">            buf.append(Long.toHexString(i &lt;&lt; <span class="number">4</span> &amp; <span class="number">0xFFFFFFFFL</span> | <span class="number">0x100000000L</span>));</span><br><span class="line">            buf.setCharAt(buf.length() - <span class="number">9</span>, <span class="string">&#x27;|&#x27;</span>);</span><br><span class="line">            buf.append(<span class="string">&#x27;|&#x27;</span>);</span><br><span class="line">            HEXDUMP_ROWPREFIXES[i] = buf.toString();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Generate the lookup table for byte-to-hex-dump conversion</span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; BYTE2HEX.length; i++) &#123;</span><br><span class="line">            BYTE2HEX[i] = <span class="string">&#x27; &#x27;</span> + StringUtil.byteToHexStringPadded(i);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Generate the lookup table for byte dump paddings</span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; BYTEPADDING.length; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">padding</span> <span class="operator">=</span> BYTEPADDING.length - i;</span><br><span class="line">            <span class="type">StringBuilder</span> <span class="variable">buf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(padding);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; padding; j++) &#123;</span><br><span class="line">                buf.append(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            BYTEPADDING[i] = buf.toString();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Generate the lookup table for byte-to-char conversion</span></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; BYTE2CHAR.length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &lt;= <span class="number">0x1f</span> || i &gt;= <span class="number">0x7f</span>) &#123;</span><br><span class="line">                BYTE2CHAR[i] = <span class="string">&#x27;.&#x27;</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                BYTE2CHAR[i] = (<span class="type">char</span>) i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰“å°æ‰€æœ‰å†…å®¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> buffer</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">debugAll</span><span class="params">(ByteBuffer buffer)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">oldlimit</span> <span class="operator">=</span> buffer.limit();</span><br><span class="line">        buffer.limit(buffer.capacity());</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">origin</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(<span class="number">256</span>);</span><br><span class="line">        appendPrettyHexDump(origin, buffer, <span class="number">0</span>, buffer.capacity());</span><br><span class="line">        System.out.println(<span class="string">&quot;+--------+-------------------- all ------------------------+----------------+&quot;</span>);</span><br><span class="line">        System.out.printf(<span class="string">&quot;position: [%d], limit: [%d]\n&quot;</span>, buffer.position(), oldlimit);</span><br><span class="line">        System.out.println(origin);</span><br><span class="line">        buffer.limit(oldlimit);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰“å°å¯è¯»å–å†…å®¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> buffer</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">debugRead</span><span class="params">(ByteBuffer buffer)</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(<span class="number">256</span>);</span><br><span class="line">        appendPrettyHexDump(builder, buffer, buffer.position(), buffer.limit() - buffer.position());</span><br><span class="line">        System.out.println(<span class="string">&quot;+--------+-------------------- read -----------------------+----------------+&quot;</span>);</span><br><span class="line">        System.out.printf(<span class="string">&quot;position: [%d], limit: [%d]\n&quot;</span>, buffer.position(), buffer.limit());</span><br><span class="line">        System.out.println(builder);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">appendPrettyHexDump</span><span class="params">(StringBuilder dump, ByteBuffer buf, <span class="type">int</span> offset, <span class="type">int</span> length)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isOutOfBounds(offset, length, buf.capacity())) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IndexOutOfBoundsException</span>(</span><br><span class="line">                    <span class="string">&quot;expected: &quot;</span> + <span class="string">&quot;0 &lt;= offset(&quot;</span> + offset + <span class="string">&quot;) &lt;= offset + length(&quot;</span> + length</span><br><span class="line">                            + <span class="string">&quot;) &lt;= &quot;</span> + <span class="string">&quot;buf.capacity(&quot;</span> + buf.capacity() + <span class="string">&#x27;)&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (length == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        dump.append(</span><br><span class="line">                <span class="string">&quot;         +-------------------------------------------------+&quot;</span> +</span><br><span class="line">                        NEWLINE + <span class="string">&quot;         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |&quot;</span> +</span><br><span class="line">                        NEWLINE + <span class="string">&quot;+--------+-------------------------------------------------+----------------+&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> <span class="type">int</span> <span class="variable">startIndex</span> <span class="operator">=</span> offset;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">int</span> <span class="variable">fullRows</span> <span class="operator">=</span> length &gt;&gt;&gt; <span class="number">4</span>;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">int</span> <span class="variable">remainder</span> <span class="operator">=</span> length &amp; <span class="number">0xF</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Dump the rows which have 16 bytes.</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">row</span> <span class="operator">=</span> <span class="number">0</span>; row &lt; fullRows; row++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">rowStartIndex</span> <span class="operator">=</span> (row &lt;&lt; <span class="number">4</span>) + startIndex;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Per-row prefix.</span></span><br><span class="line">            appendHexDumpRowPrefix(dump, row, rowStartIndex);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Hex dump</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">rowEndIndex</span> <span class="operator">=</span> rowStartIndex + <span class="number">16</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> rowStartIndex; j &lt; rowEndIndex; j++) &#123;</span><br><span class="line">                dump.append(BYTE2HEX[getUnsignedByte(buf, j)]);</span><br><span class="line">            &#125;</span><br><span class="line">            dump.append(<span class="string">&quot; |&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// ASCII dump</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> rowStartIndex; j &lt; rowEndIndex; j++) &#123;</span><br><span class="line">                dump.append(BYTE2CHAR[getUnsignedByte(buf, j)]);</span><br><span class="line">            &#125;</span><br><span class="line">            dump.append(<span class="string">&#x27;|&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Dump the last row which has less than 16 bytes.</span></span><br><span class="line">        <span class="keyword">if</span> (remainder != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">rowStartIndex</span> <span class="operator">=</span> (fullRows &lt;&lt; <span class="number">4</span>) + startIndex;</span><br><span class="line">            appendHexDumpRowPrefix(dump, fullRows, rowStartIndex);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Hex dump</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">rowEndIndex</span> <span class="operator">=</span> rowStartIndex + remainder;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> rowStartIndex; j &lt; rowEndIndex; j++) &#123;</span><br><span class="line">                dump.append(BYTE2HEX[getUnsignedByte(buf, j)]);</span><br><span class="line">            &#125;</span><br><span class="line">            dump.append(HEXPADDING[remainder]);</span><br><span class="line">            dump.append(<span class="string">&quot; |&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Ascii dump</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> rowStartIndex; j &lt; rowEndIndex; j++) &#123;</span><br><span class="line">                dump.append(BYTE2CHAR[getUnsignedByte(buf, j)]);</span><br><span class="line">            &#125;</span><br><span class="line">            dump.append(BYTEPADDING[remainder]);</span><br><span class="line">            dump.append(<span class="string">&#x27;|&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        dump.append(NEWLINE +</span><br><span class="line">                <span class="string">&quot;+--------+-------------------------------------------------+----------------+&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">appendHexDumpRowPrefix</span><span class="params">(StringBuilder dump, <span class="type">int</span> row, <span class="type">int</span> rowStartIndex)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (row &lt; HEXDUMP_ROWPREFIXES.length) &#123;</span><br><span class="line">            dump.append(HEXDUMP_ROWPREFIXES[row]);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            dump.append(NEWLINE);</span><br><span class="line">            dump.append(Long.toHexString(rowStartIndex &amp; <span class="number">0xFFFFFFFFL</span> | <span class="number">0x100000000L</span>));</span><br><span class="line">            dump.setCharAt(dump.length() - <span class="number">9</span>, <span class="string">&#x27;|&#x27;</span>);</span><br><span class="line">            dump.append(<span class="string">&#x27;|&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">short</span> <span class="title function_">getUnsignedByte</span><span class="params">(ByteBuffer buffer, <span class="type">int</span> index)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="type">short</span>) (buffer.get(index) &amp; <span class="number">0xFF</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ByteBuffer-å¸¸è§æ–¹æ³•"><a href="#ByteBuffer-å¸¸è§æ–¹æ³•" class="headerlink" title="ByteBuffer å¸¸è§æ–¹æ³•"></a>ByteBuffer å¸¸è§æ–¹æ³•</h3><h4 id="åˆ†é…ç©ºé—´"><a href="#åˆ†é…ç©ºé—´" class="headerlink" title="åˆ†é…ç©ºé—´"></a>åˆ†é…ç©ºé—´</h4><p>å¯ä»¥ä½¿ç”¨ allocate æ–¹æ³•ä¸º ByteBuffer åˆ†é…ç©ºé—´ï¼Œå…¶å®ƒ buffer ç±»ä¹Ÿæœ‰è¯¥æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Bytebuffer</span> <span class="variable">buf</span> <span class="operator">=</span> ByteBuffer.allocate(<span class="number">16</span>);</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    System.out.println(ByteBuffer.allocate(<span class="number">16</span>).getClass());</span><br><span class="line">    System.out.println(ByteBuffer.allocateDirect(<span class="number">16</span>).getClass());</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    class java.nio.HeapByteBuffer       - java å †å†…å­˜ï¼Œè¯»å†™æ•ˆç‡ä½ï¼Œå—åˆ°GCå½±å“</span></span><br><span class="line"><span class="comment">    class java.nio.DirectByteBuffer     - ç›´æ¥å†…å­˜ï¼Œè¯»å†™æ•ˆç‡é«˜ï¼ˆå°‘ä¸€æ¬¡æ‹·è´ï¼‰ï¼Œä¸ä¼šå—GCå½±å“ï¼Œåˆ†é…é€Ÿç‡ä½ï¼Œä½¿ç”¨ä¸å½“ä¼šå‘ç”Ÿå†…å­˜æ³„æ¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å‘-buffer-å†™å…¥æ•°æ®"><a href="#å‘-buffer-å†™å…¥æ•°æ®" class="headerlink" title="å‘ buffer å†™å…¥æ•°æ®"></a>å‘ buffer å†™å…¥æ•°æ®</h4><p>æœ‰ä¸¤ç§åŠæ³•</p><ul><li>è°ƒç”¨ channel çš„ read æ–¹æ³•</li><li>è°ƒç”¨ buffer è‡ªå·±çš„ put æ–¹æ³•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">readBytes</span> <span class="operator">=</span> channel.read(buf);</span><br></pre></td></tr></table></figure><p>å’Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">buf.put((<span class="type">byte</span>)<span class="number">127</span>);</span><br></pre></td></tr></table></figure><h4 id="ä»-buffer-è¯»å–æ•°æ®"><a href="#ä»-buffer-è¯»å–æ•°æ®" class="headerlink" title="ä» buffer è¯»å–æ•°æ®"></a>ä» buffer è¯»å–æ•°æ®</h4><p>åŒæ ·æœ‰ä¸¤ç§åŠæ³•</p><ul><li>è°ƒç”¨ channel çš„ write æ–¹æ³•</li><li>è°ƒç”¨ buffer è‡ªå·±çš„ get æ–¹æ³•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">writeBytes</span> <span class="operator">=</span> channel.write(buf);</span><br></pre></td></tr></table></figure><p>å’Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">byte</span> <span class="variable">b</span> <span class="operator">=</span> buf.get();</span><br></pre></td></tr></table></figure><p>get æ–¹æ³•ä¼šè®© position è¯»æŒ‡é’ˆå‘åèµ°ï¼Œå¦‚æœæƒ³é‡å¤è¯»å–æ•°æ®</p><ul><li>å¯ä»¥è°ƒç”¨ rewind æ–¹æ³•å°† position é‡æ–°ç½®ä¸º 0</li><li>æˆ–è€…è°ƒç”¨ get(int i) æ–¹æ³•è·å–ç´¢å¼• i çš„å†…å®¹ï¼Œå®ƒä¸ä¼šç§»åŠ¨è¯»æŒ‡é’ˆ</li></ul><h4 id="mark-å’Œ-reset"><a href="#mark-å’Œ-reset" class="headerlink" title="mark å’Œ reset"></a>mark å’Œ reset</h4><p>mark æ˜¯åœ¨è¯»å–æ—¶ï¼Œåšä¸€ä¸ªæ ‡è®°ï¼Œå³ä½¿ position æ”¹å˜ï¼Œåªè¦è°ƒç”¨ reset å°±èƒ½å›åˆ° mark çš„ä½ç½®</p><blockquote><p><strong>æ³¨æ„</strong></p><p>rewind å’Œ flip éƒ½ä¼šæ¸…é™¤ mark ä½ç½®</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">ByteBuffer</span> <span class="variable">buffer</span> <span class="operator">=</span> ByteBuffer.allocate(<span class="number">10</span>);</span><br><span class="line">    buffer.put(<span class="keyword">new</span> <span class="title class_">byte</span>[]&#123;<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>&#125;);</span><br><span class="line">    buffer.flip();<span class="comment">//åˆ‡æ¢åˆ°è¯»æ¨¡å¼</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//rewindä»å¤´è¯»</span></span><br><span class="line">    <span class="comment">/*buffer.get(new byte[4]);</span></span><br><span class="line"><span class="comment">    debugAll(buffer);</span></span><br><span class="line"><span class="comment">    buffer.rewind();</span></span><br><span class="line"><span class="comment">    System.out.println((char) buffer.get());*/</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//mark &amp; reset</span></span><br><span class="line">    <span class="comment">//mark åšä¸€ä¸ªæ ‡è®°ï¼Œè®°å½•positionä½ç½®ï¼Œresetæ˜¯å°†positioné‡ç½®åˆ°markä½ç½®</span></span><br><span class="line">    <span class="comment">/*System.out.println((char) buffer.get());</span></span><br><span class="line"><span class="comment">    System.out.println((char) buffer.get());</span></span><br><span class="line"><span class="comment">    buffer.mark();//åŠ æ ‡è®°ï¼Œç´¢å¼•2 çš„ä½ç½®</span></span><br><span class="line"><span class="comment">    System.out.println((char) buffer.get());</span></span><br><span class="line"><span class="comment">    System.out.println((char) buffer.get());</span></span><br><span class="line"><span class="comment">    buffer.reset();//å°†å°†positioné‡ç½®åˆ°ç´¢å¼•2</span></span><br><span class="line"><span class="comment">    System.out.println((char) buffer.get());</span></span><br><span class="line"><span class="comment">    System.out.println((char) buffer.get());*/</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//get(i)ä¸ä¼šæ”¹å˜è¯»ç´¢å¼•(position)çš„ä½ç½®</span></span><br><span class="line">    System.out.println((<span class="type">char</span>) buffer.get(<span class="number">3</span>));</span><br><span class="line">    debugAll(buffer);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å­—ç¬¦ä¸²ä¸-ByteBuffer-äº’è½¬"><a href="#å­—ç¬¦ä¸²ä¸-ByteBuffer-äº’è½¬" class="headerlink" title="å­—ç¬¦ä¸²ä¸ ByteBuffer äº’è½¬"></a>å­—ç¬¦ä¸²ä¸ ByteBuffer äº’è½¬</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ByteBuffer</span> <span class="variable">buffer1</span> <span class="operator">=</span> StandardCharsets.UTF_8.encode(<span class="string">&quot;ä½ å¥½&quot;</span>);</span><br><span class="line"><span class="type">ByteBuffer</span> <span class="variable">buffer2</span> <span class="operator">=</span> Charset.forName(<span class="string">&quot;utf-8&quot;</span>).encode(<span class="string">&quot;ä½ å¥½&quot;</span>);</span><br><span class="line"></span><br><span class="line">debug(buffer1);</span><br><span class="line">debug(buffer2);</span><br><span class="line"></span><br><span class="line"><span class="type">CharBuffer</span> <span class="variable">buffer3</span> <span class="operator">=</span> StandardCharsets.UTF_8.decode(buffer1);</span><br><span class="line">System.out.println(buffer3.getClass());</span><br><span class="line">System.out.println(buffer3.toString());</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| e4 bd a0 e5 a5 bd                               |......          |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| e4 bd a0 e5 a5 bd                               |......          |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">class java.nio.HeapCharBuffer</span><br><span class="line">ä½ å¥½</span><br></pre></td></tr></table></figure><h4 id="âš ï¸-Buffer-çš„çº¿ç¨‹å®‰å…¨"><a href="#âš ï¸-Buffer-çš„çº¿ç¨‹å®‰å…¨" class="headerlink" title="âš ï¸ Buffer çš„çº¿ç¨‹å®‰å…¨"></a>âš ï¸ Buffer çš„çº¿ç¨‹å®‰å…¨</h4><blockquote><p>Buffer æ˜¯<strong>éçº¿ç¨‹å®‰å…¨çš„</strong></p></blockquote><h3 id="Scattering-Reads"><a href="#Scattering-Reads" class="headerlink" title="Scattering Reads"></a>Scattering Reads</h3><p>åˆ†æ•£è¯»å–ï¼Œæœ‰ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ 3parts.txt</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">onetwothree</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å¦‚ä¸‹æ–¹å¼è¯»å–ï¼Œå¯ä»¥å°†æ•°æ®å¡«å……è‡³å¤šä¸ª buffer</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> (<span class="type">RandomAccessFile</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RandomAccessFile</span>(<span class="string">&quot;helloword/3parts.txt&quot;</span>, <span class="string">&quot;rw&quot;</span>)) &#123;</span><br><span class="line">    <span class="type">FileChannel</span> <span class="variable">channel</span> <span class="operator">=</span> file.getChannel();</span><br><span class="line">    <span class="type">ByteBuffer</span> <span class="variable">a</span> <span class="operator">=</span> ByteBuffer.allocate(<span class="number">3</span>);</span><br><span class="line">    <span class="type">ByteBuffer</span> <span class="variable">b</span> <span class="operator">=</span> ByteBuffer.allocate(<span class="number">3</span>);</span><br><span class="line">    <span class="type">ByteBuffer</span> <span class="variable">c</span> <span class="operator">=</span> ByteBuffer.allocate(<span class="number">5</span>);</span><br><span class="line">    channel.read(<span class="keyword">new</span> <span class="title class_">ByteBuffer</span>[]&#123;a, b, c&#125;);</span><br><span class="line">    a.flip();</span><br><span class="line">    b.flip();</span><br><span class="line">    c.flip();</span><br><span class="line">    debug(a);</span><br><span class="line">    debug(b);</span><br><span class="line">    debug(c);</span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 6f 6e 65                                        |one             |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 74 77 6f                                        |two             |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 74 68 72 65 65                                  |three           |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br></pre></td></tr></table></figure><h3 id="Gathering-Writes"><a href="#Gathering-Writes" class="headerlink" title="Gathering Writes"></a>Gathering Writes</h3><p>ä½¿ç”¨å¦‚ä¸‹æ–¹å¼å†™å…¥ï¼Œå¯ä»¥å°†å¤šä¸ª buffer çš„æ•°æ®å¡«å……è‡³ channel</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> (<span class="type">RandomAccessFile</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RandomAccessFile</span>(<span class="string">&quot;helloword/3parts.txt&quot;</span>, <span class="string">&quot;rw&quot;</span>)) &#123;</span><br><span class="line">    <span class="type">FileChannel</span> <span class="variable">channel</span> <span class="operator">=</span> file.getChannel();</span><br><span class="line">    <span class="type">ByteBuffer</span> <span class="variable">d</span> <span class="operator">=</span> ByteBuffer.allocate(<span class="number">4</span>);</span><br><span class="line">    <span class="type">ByteBuffer</span> <span class="variable">e</span> <span class="operator">=</span> ByteBuffer.allocate(<span class="number">4</span>);</span><br><span class="line">    channel.position(<span class="number">11</span>);</span><br><span class="line"></span><br><span class="line">    d.put(<span class="keyword">new</span> <span class="title class_">byte</span>[]&#123;<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;r&#x27;</span>&#125;);</span><br><span class="line">    e.put(<span class="keyword">new</span> <span class="title class_">byte</span>[]&#123;<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;e&#x27;</span>&#125;);</span><br><span class="line">    d.flip();</span><br><span class="line">    e.flip();</span><br><span class="line">    debug(d);</span><br><span class="line">    debug(e);</span><br><span class="line">    channel.write(<span class="keyword">new</span> <span class="title class_">ByteBuffer</span>[]&#123;d, e&#125;);</span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 66 6f 75 72                                     |four            |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 66 69 76 65                                     |five            |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br></pre></td></tr></table></figure><p>æ–‡ä»¶å†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">onetwothreefourfive</span><br></pre></td></tr></table></figure><h3 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h3><blockquote><p>é»åŒ…ï¼ŒåŠåŒ…</p></blockquote><p>ç½‘ç»œä¸Šæœ‰å¤šæ¡æ•°æ®å‘é€ç»™æœåŠ¡ç«¯ï¼Œæ•°æ®ä¹‹é—´ä½¿ç”¨ \n è¿›è¡Œåˆ†éš”<br>ä½†ç”±äºæŸç§åŸå› è¿™äº›æ•°æ®åœ¨æ¥æ”¶æ—¶ï¼Œè¢«è¿›è¡Œäº†é‡æ–°ç»„åˆï¼Œä¾‹å¦‚åŸå§‹æ•°æ®æœ‰3æ¡ä¸º</p><ul><li>Hello,world\n</li><li>Iâ€™m zhangsan\n</li><li>How are you?\n</li></ul><p>å˜æˆäº†ä¸‹é¢çš„ä¸¤ä¸ª byteBuffer (é»åŒ…ï¼ŒåŠåŒ…)</p><ul><li>Hello,world\nIâ€™m zhangsan\nHo</li><li>w are you?\n</li></ul><p>ç°åœ¨è¦æ±‚ä½ ç¼–å†™ç¨‹åºï¼Œå°†é”™ä¹±çš„æ•°æ®æ¢å¤æˆåŸå§‹çš„æŒ‰ \n åˆ†éš”çš„æ•°æ®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">ByteBuffer</span> <span class="variable">source</span> <span class="operator">=</span> ByteBuffer.allocate(<span class="number">32</span>);</span><br><span class="line">    <span class="comment">//                     11            24</span></span><br><span class="line">    source.put(<span class="string">&quot;Hello,world\nI&#x27;m zhangsan\nHo&quot;</span>.getBytes());</span><br><span class="line">    split(source);</span><br><span class="line"></span><br><span class="line">    source.put(<span class="string">&quot;w are you?\nhaha!\n&quot;</span>.getBytes());</span><br><span class="line">    split(source);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">split</span><span class="params">(ByteBuffer source)</span> &#123;</span><br><span class="line">    source.flip();</span><br><span class="line">    <span class="type">int</span> <span class="variable">oldLimit</span> <span class="operator">=</span> source.limit();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; oldLimit; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (source.get(i) == <span class="string">&#x27;\n&#x27;</span>) &#123;</span><br><span class="line">            System.out.println(i);</span><br><span class="line">            <span class="type">ByteBuffer</span> <span class="variable">target</span> <span class="operator">=</span> ByteBuffer.allocate(i + <span class="number">1</span> - source.position());</span><br><span class="line">            <span class="comment">// 0 ~ limit</span></span><br><span class="line">            source.limit(i + <span class="number">1</span>);</span><br><span class="line">            target.put(source); <span class="comment">// ä»source è¯»ï¼Œå‘ target å†™</span></span><br><span class="line">            debugAll(target);</span><br><span class="line">            source.limit(oldLimit);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    source.compact();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ–‡ä»¶ç¼–ç¨‹"><a href="#æ–‡ä»¶ç¼–ç¨‹" class="headerlink" title="æ–‡ä»¶ç¼–ç¨‹"></a>æ–‡ä»¶ç¼–ç¨‹</h2><h3 id="FileChannel"><a href="#FileChannel" class="headerlink" title="FileChannel"></a>FileChannel</h3><h4 id="âš ï¸-FileChannel-å·¥ä½œæ¨¡å¼"><a href="#âš ï¸-FileChannel-å·¥ä½œæ¨¡å¼" class="headerlink" title="âš ï¸ FileChannel å·¥ä½œæ¨¡å¼"></a>âš ï¸ FileChannel å·¥ä½œæ¨¡å¼</h4><blockquote><p>FileChannel åªèƒ½å·¥ä½œåœ¨é˜»å¡æ¨¡å¼ä¸‹</p></blockquote><h4 id="è·å–"><a href="#è·å–" class="headerlink" title="è·å–"></a>è·å–</h4><p>ä¸èƒ½ç›´æ¥æ‰“å¼€ FileChannelï¼Œå¿…é¡»é€šè¿‡ FileInputStreamã€FileOutputStream æˆ–è€… RandomAccessFile æ¥è·å– FileChannelï¼Œå®ƒä»¬éƒ½æœ‰ getChannel æ–¹æ³•</p><ul><li>é€šè¿‡ FileInputStream è·å–çš„ channel åªèƒ½è¯»</li><li>é€šè¿‡ FileOutputStream è·å–çš„ channel åªèƒ½å†™</li><li>é€šè¿‡ RandomAccessFile æ˜¯å¦èƒ½è¯»å†™æ ¹æ®æ„é€  RandomAccessFile æ—¶çš„è¯»å†™æ¨¡å¼å†³å®š</li></ul><h4 id="è¯»å–"><a href="#è¯»å–" class="headerlink" title="è¯»å–"></a>è¯»å–</h4><p>ä¼šä» channel è¯»å–æ•°æ®å¡«å…… ByteBufferï¼Œè¿”å›å€¼è¡¨ç¤ºè¯»åˆ°äº†å¤šå°‘å­—èŠ‚ï¼Œ-1 è¡¨ç¤ºåˆ°è¾¾äº†æ–‡ä»¶çš„æœ«å°¾</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">readBytes</span> <span class="operator">=</span> channel.read(buffer);</span><br></pre></td></tr></table></figure><h4 id="å†™å…¥"><a href="#å†™å…¥" class="headerlink" title="å†™å…¥"></a>å†™å…¥</h4><p>å†™å…¥çš„æ­£ç¡®å§¿åŠ¿å¦‚ä¸‹ï¼Œ SocketChannel(ä¼ è¾“æœ‰é™)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ByteBuffer</span> <span class="variable">buffer</span> <span class="operator">=</span> ...;</span><br><span class="line">buffer.put(...); <span class="comment">// å­˜å…¥æ•°æ®</span></span><br><span class="line">buffer.flip();   <span class="comment">// åˆ‡æ¢è¯»æ¨¡å¼</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(buffer.hasRemaining()) &#123;</span><br><span class="line">    channel.write(buffer);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ while ä¸­è°ƒç”¨ channel.write æ˜¯å› ä¸º write æ–¹æ³•å¹¶ä¸èƒ½ä¿è¯ä¸€æ¬¡å°† buffer ä¸­çš„å†…å®¹å…¨éƒ¨å†™å…¥ channel</p><h4 id="å…³é—­"><a href="#å…³é—­" class="headerlink" title="å…³é—­"></a>å…³é—­</h4><p>channel å¿…é¡»å…³é—­ï¼Œä¸è¿‡è°ƒç”¨äº† FileInputStreamã€FileOutputStream æˆ–è€… RandomAccessFile çš„ close æ–¹æ³•ä¼šé—´æ¥åœ°è°ƒç”¨ channel çš„ close æ–¹æ³•</p><h4 id="ä½ç½®"><a href="#ä½ç½®" class="headerlink" title="ä½ç½®"></a>ä½ç½®</h4><p>è·å–å½“å‰ä½ç½®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="variable">pos</span> <span class="operator">=</span> channel.position();</span><br></pre></td></tr></table></figure><p>è®¾ç½®å½“å‰ä½ç½®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="variable">newPos</span> <span class="operator">=</span> ...;</span><br><span class="line">channel.position(newPos);</span><br></pre></td></tr></table></figure><p>è®¾ç½®å½“å‰ä½ç½®æ—¶ï¼Œå¦‚æœè®¾ç½®ä¸ºæ–‡ä»¶çš„æœ«å°¾</p><ul><li>è¿™æ—¶è¯»å–ä¼šè¿”å› -1 </li><li>è¿™æ—¶å†™å…¥ï¼Œä¼šè¿½åŠ å†…å®¹ï¼Œä½†è¦æ³¨æ„å¦‚æœ position è¶…è¿‡äº†æ–‡ä»¶æœ«å°¾ï¼Œå†å†™å…¥æ—¶åœ¨æ–°å†…å®¹å’ŒåŸæœ«å°¾ä¹‹é—´ä¼šæœ‰ç©ºæ´ï¼ˆ00ï¼‰</li></ul><h4 id="å¤§å°"><a href="#å¤§å°" class="headerlink" title="å¤§å°"></a>å¤§å°</h4><p>ä½¿ç”¨ size æ–¹æ³•è·å–æ–‡ä»¶çš„å¤§å°</p><h4 id="å¼ºåˆ¶å†™å…¥"><a href="#å¼ºåˆ¶å†™å…¥" class="headerlink" title="å¼ºåˆ¶å†™å…¥"></a>å¼ºåˆ¶å†™å…¥</h4><p>æ“ä½œç³»ç»Ÿå‡ºäºæ€§èƒ½çš„è€ƒè™‘ï¼Œä¼šå°†æ•°æ®ç¼“å­˜ï¼Œä¸æ˜¯ç«‹åˆ»å†™å…¥ç£ç›˜ã€‚å¯ä»¥è°ƒç”¨ force(true)  æ–¹æ³•å°†æ–‡ä»¶å†…å®¹å’Œå…ƒæ•°æ®ï¼ˆæ–‡ä»¶çš„æƒé™ç­‰ä¿¡æ¯ï¼‰ç«‹åˆ»å†™å…¥ç£ç›˜</p><h3 id="3-2-ä¸¤ä¸ª-Channel-ä¼ è¾“æ•°æ®"><a href="#3-2-ä¸¤ä¸ª-Channel-ä¼ è¾“æ•°æ®" class="headerlink" title="3.2 ä¸¤ä¸ª Channel ä¼ è¾“æ•°æ®"></a>3.2 ä¸¤ä¸ª Channel ä¼ è¾“æ•°æ®</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">FROM</span> <span class="operator">=</span> <span class="string">&quot;helloword/data.txt&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">TO</span> <span class="operator">=</span> <span class="string">&quot;helloword/to.txt&quot;</span>;</span><br><span class="line"><span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line"><span class="keyword">try</span> (<span class="type">FileChannel</span> <span class="variable">from</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(FROM).getChannel();</span><br><span class="line">     <span class="type">FileChannel</span> <span class="variable">to</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(TO).getChannel();</span><br><span class="line">    ) &#123;</span><br><span class="line">    from.transferTo(<span class="number">0</span>, from.size(), to);</span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line">System.out.println(<span class="string">&quot;transferTo ç”¨æ—¶ï¼š&quot;</span> + (end - start) / <span class="number">1000_000.0</span>);</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">transferTo ç”¨æ—¶ï¼š8.2011</span><br></pre></td></tr></table></figure><p>è¶…è¿‡ 2g å¤§å°çš„æ–‡ä»¶ä¼ è¾“</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestFileChannelTransferTo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> (</span><br><span class="line">                <span class="type">FileChannel</span> <span class="variable">from</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;data.txt&quot;</span>).getChannel();</span><br><span class="line">                <span class="type">FileChannel</span> <span class="variable">to</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;to.txt&quot;</span>).getChannel();</span><br><span class="line">        ) &#123;</span><br><span class="line">            <span class="comment">// æ•ˆç‡é«˜ï¼Œåº•å±‚ä¼šåˆ©ç”¨æ“ä½œç³»ç»Ÿçš„é›¶æ‹·è´è¿›è¡Œä¼˜åŒ–</span></span><br><span class="line">            <span class="type">long</span> <span class="variable">size</span> <span class="operator">=</span> from.size();</span><br><span class="line">            <span class="comment">// left å˜é‡ä»£è¡¨è¿˜å‰©ä½™å¤šå°‘å­—èŠ‚</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">long</span> <span class="variable">left</span> <span class="operator">=</span> size; left &gt; <span class="number">0</span>; ) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;position:&quot;</span> + (size - left) + <span class="string">&quot; left:&quot;</span> + left);</span><br><span class="line">                left -= from.transferTo((size - left), left, to);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®é™…ä¼ è¾“ä¸€ä¸ªè¶…å¤§æ–‡ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">position:0 left:7769948160</span><br><span class="line">position:2147483647 left:5622464513</span><br><span class="line">position:4294967294 left:3474980866</span><br><span class="line">position:6442450941 left:1327497219</span><br></pre></td></tr></table></figure><h3 id="Path"><a href="#Path" class="headerlink" title="Path"></a>Path</h3><p>jdk7 å¼•å…¥äº† Path å’Œ Paths ç±»</p><ul><li>Path ç”¨æ¥è¡¨ç¤ºæ–‡ä»¶è·¯å¾„</li><li>Paths æ˜¯å·¥å…·ç±»ï¼Œç”¨æ¥è·å– Path å®ä¾‹</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Path</span> <span class="variable">source</span> <span class="operator">=</span> Paths.get(<span class="string">&quot;1.txt&quot;</span>); <span class="comment">// ç›¸å¯¹è·¯å¾„ ä½¿ç”¨ user.dir ç¯å¢ƒå˜é‡æ¥å®šä½ 1.txt</span></span><br><span class="line"></span><br><span class="line"><span class="type">Path</span> <span class="variable">source</span> <span class="operator">=</span> Paths.get(<span class="string">&quot;d:\\1.txt&quot;</span>); <span class="comment">// ç»å¯¹è·¯å¾„ ä»£è¡¨äº†  d:\1.txt</span></span><br><span class="line"></span><br><span class="line"><span class="type">Path</span> <span class="variable">source</span> <span class="operator">=</span> Paths.get(<span class="string">&quot;d:/1.txt&quot;</span>); <span class="comment">// ç»å¯¹è·¯å¾„ åŒæ ·ä»£è¡¨äº†  d:\1.txt</span></span><br><span class="line"></span><br><span class="line"><span class="type">Path</span> <span class="variable">projects</span> <span class="operator">=</span> Paths.get(<span class="string">&quot;d:\\data&quot;</span>, <span class="string">&quot;projects&quot;</span>); <span class="comment">// ä»£è¡¨äº†  d:\data\projects</span></span><br></pre></td></tr></table></figure><ul><li><code>.</code> ä»£è¡¨äº†å½“å‰è·¯å¾„</li><li><code>..</code> ä»£è¡¨äº†ä¸Šä¸€çº§è·¯å¾„</li></ul><p>ä¾‹å¦‚ç›®å½•ç»“æ„å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">d:</span><br><span class="line">|- data</span><br><span class="line">|- projects</span><br><span class="line">|- a</span><br><span class="line">|- b</span><br></pre></td></tr></table></figure><p>ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Path</span> <span class="variable">path</span> <span class="operator">=</span> Paths.get(<span class="string">&quot;d:\\data\\projects\\a\\..\\b&quot;</span>);</span><br><span class="line">System.out.println(path);</span><br><span class="line">System.out.println(path.normalize()); <span class="comment">// æ­£å¸¸åŒ–è·¯å¾„</span></span><br></pre></td></tr></table></figure><p>ä¼šè¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d:\data\projects\a\..\b</span><br><span class="line">d:\data\projects\b</span><br></pre></td></tr></table></figure><h3 id="Files"><a href="#Files" class="headerlink" title="Files"></a>Files</h3><p>æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Path</span> <span class="variable">path</span> <span class="operator">=</span> Paths.get(<span class="string">&quot;helloword/data.txt&quot;</span>);</span><br><span class="line">System.out.println(Files.exists(path));</span><br></pre></td></tr></table></figure><p>åˆ›å»ºä¸€çº§ç›®å½•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Path</span> <span class="variable">path</span> <span class="operator">=</span> Paths.get(<span class="string">&quot;helloword/d1&quot;</span>);</span><br><span class="line">Files.createDirectory(path);</span><br></pre></td></tr></table></figure><ul><li>å¦‚æœç›®å½•å·²å­˜åœ¨ï¼Œä¼šæŠ›å¼‚å¸¸ FileAlreadyExistsException</li><li>ä¸èƒ½ä¸€æ¬¡åˆ›å»ºå¤šçº§ç›®å½•ï¼Œå¦åˆ™ä¼šæŠ›å¼‚å¸¸ NoSuchFileException</li></ul><p>åˆ›å»ºå¤šçº§ç›®å½•ç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Path</span> <span class="variable">path</span> <span class="operator">=</span> Paths.get(<span class="string">&quot;helloword/d1/d2&quot;</span>);</span><br><span class="line">Files.createDirectories(path);</span><br></pre></td></tr></table></figure><p>æ‹·è´æ–‡ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Path</span> <span class="variable">source</span> <span class="operator">=</span> Paths.get(<span class="string">&quot;helloword/data.txt&quot;</span>);</span><br><span class="line"><span class="type">Path</span> <span class="variable">target</span> <span class="operator">=</span> Paths.get(<span class="string">&quot;helloword/target.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line">Files.copy(source, target);</span><br></pre></td></tr></table></figure><ul><li>å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œä¼šæŠ›å¼‚å¸¸ FileAlreadyExistsException</li></ul><p>å¦‚æœå¸Œæœ›ç”¨ source è¦†ç›–æ‰ targetï¼Œéœ€è¦ç”¨ StandardCopyOption æ¥æ§åˆ¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Files.copy(source, target, StandardCopyOption.REPLACE_EXISTING);</span><br></pre></td></tr></table></figure><p>ç§»åŠ¨æ–‡ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Path</span> <span class="variable">source</span> <span class="operator">=</span> Paths.get(<span class="string">&quot;helloword/data.txt&quot;</span>);</span><br><span class="line"><span class="type">Path</span> <span class="variable">target</span> <span class="operator">=</span> Paths.get(<span class="string">&quot;helloword/data.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line">Files.move(source, target, StandardCopyOption.ATOMIC_MOVE);</span><br></pre></td></tr></table></figure><ul><li>StandardCopyOption.ATOMIC_MOVE ä¿è¯æ–‡ä»¶ç§»åŠ¨çš„åŸå­æ€§</li></ul><p>åˆ é™¤æ–‡ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Path</span> <span class="variable">target</span> <span class="operator">=</span> Paths.get(<span class="string">&quot;helloword/target.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line">Files.delete(target);</span><br></pre></td></tr></table></figure><ul><li>å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œä¼šæŠ›å¼‚å¸¸ NoSuchFileException</li></ul><p>åˆ é™¤ç›®å½•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Path</span> <span class="variable">target</span> <span class="operator">=</span> Paths.get(<span class="string">&quot;helloword/d1&quot;</span>);</span><br><span class="line"></span><br><span class="line">Files.delete(target);</span><br></pre></td></tr></table></figure><ul><li>å¦‚æœç›®å½•è¿˜æœ‰å†…å®¹ï¼Œä¼šæŠ›å¼‚å¸¸ DirectoryNotEmptyException</li></ul><p>éå†ç›®å½•æ–‡ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="type">Path</span> <span class="variable">path</span> <span class="operator">=</span> Paths.get(<span class="string">&quot;C:\\Program Files\\Java\\jdk1.8.0_91&quot;</span>);</span><br><span class="line">    <span class="type">AtomicInteger</span> <span class="variable">dirCount</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>();</span><br><span class="line">    <span class="type">AtomicInteger</span> <span class="variable">fileCount</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>();</span><br><span class="line">    Files.walkFileTree(path, <span class="keyword">new</span> <span class="title class_">SimpleFileVisitor</span>&lt;Path&gt;()&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> FileVisitResult <span class="title function_">preVisitDirectory</span><span class="params">(Path dir, BasicFileAttributes attrs)</span> </span><br><span class="line">            <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">            System.out.println(dir);</span><br><span class="line">            dirCount.incrementAndGet();</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">super</span>.preVisitDirectory(dir, attrs);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> FileVisitResult <span class="title function_">visitFile</span><span class="params">(Path file, BasicFileAttributes attrs)</span> </span><br><span class="line">            <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">            System.out.println(file);</span><br><span class="line">            fileCount.incrementAndGet();</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">super</span>.visitFile(file, attrs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    System.out.println(dirCount); <span class="comment">// 133</span></span><br><span class="line">    System.out.println(fileCount); <span class="comment">// 1479</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»Ÿè®¡ jar çš„æ•°ç›®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Path</span> <span class="variable">path</span> <span class="operator">=</span> Paths.get(<span class="string">&quot;C:\\Program Files\\Java\\jdk1.8.0_91&quot;</span>);</span><br><span class="line"><span class="type">AtomicInteger</span> <span class="variable">fileCount</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>();</span><br><span class="line">Files.walkFileTree(path, <span class="keyword">new</span> <span class="title class_">SimpleFileVisitor</span>&lt;Path&gt;()&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> FileVisitResult <span class="title function_">visitFile</span><span class="params">(Path file, BasicFileAttributes attrs)</span> </span><br><span class="line">        <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="keyword">if</span> (file.toFile().getName().endsWith(<span class="string">&quot;.jar&quot;</span>)) &#123;</span><br><span class="line">            fileCount.incrementAndGet();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.visitFile(file, attrs);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">System.out.println(fileCount); <span class="comment">// 724</span></span><br></pre></td></tr></table></figure><p>åˆ é™¤å¤šçº§ç›®å½•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Path</span> <span class="variable">path</span> <span class="operator">=</span> Paths.get(<span class="string">&quot;d:\\a&quot;</span>);</span><br><span class="line">Files.walkFileTree(path, <span class="keyword">new</span> <span class="title class_">SimpleFileVisitor</span>&lt;Path&gt;()&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> FileVisitResult <span class="title function_">visitFile</span><span class="params">(Path file, BasicFileAttributes attrs)</span> </span><br><span class="line">        <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        Files.delete(file);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.visitFile(file, attrs);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> FileVisitResult <span class="title function_">postVisitDirectory</span><span class="params">(Path dir, IOException exc)</span> </span><br><span class="line">        <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        Files.delete(dir);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.postVisitDirectory(dir, exc);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h4 id="âš ï¸-åˆ é™¤å¾ˆå±é™©"><a href="#âš ï¸-åˆ é™¤å¾ˆå±é™©" class="headerlink" title="âš ï¸ åˆ é™¤å¾ˆå±é™©"></a>âš ï¸ åˆ é™¤å¾ˆå±é™©</h4><blockquote><p>åˆ é™¤æ˜¯å±é™©æ“ä½œï¼Œç¡®ä¿è¦é€’å½’åˆ é™¤çš„æ–‡ä»¶å¤¹æ²¡æœ‰é‡è¦å†…å®¹</p></blockquote><p>æ‹·è´å¤šçº§ç›®å½•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="variable">start</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line"><span class="type">String</span> <span class="variable">source</span> <span class="operator">=</span> <span class="string">&quot;D:\\Snipaste-1.16.2-x64&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">target</span> <span class="operator">=</span> <span class="string">&quot;D:\\Snipaste-1.16.2-x64aaa&quot;</span>;</span><br><span class="line"></span><br><span class="line">Files.walk(Paths.get(source)).forEach(path -&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">targetName</span> <span class="operator">=</span> path.toString().replace(source, target);</span><br><span class="line">        <span class="comment">// æ˜¯ç›®å½•</span></span><br><span class="line">        <span class="keyword">if</span> (Files.isDirectory(path)) &#123;</span><br><span class="line">            Files.createDirectory(Paths.get(targetName));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ˜¯æ™®é€šæ–‡ä»¶</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (Files.isRegularFile(path)) &#123;</span><br><span class="line">            Files.copy(path, Paths.get(targetName));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="type">long</span> <span class="variable">end</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">System.out.println(end - start);</span><br></pre></td></tr></table></figure><h2 id="ç½‘ç»œç¼–ç¨‹"><a href="#ç½‘ç»œç¼–ç¨‹" class="headerlink" title="ç½‘ç»œç¼–ç¨‹"></a>ç½‘ç»œç¼–ç¨‹</h2><h3 id="éé˜»å¡-vs-é˜»å¡"><a href="#éé˜»å¡-vs-é˜»å¡" class="headerlink" title="éé˜»å¡ vs é˜»å¡"></a>éé˜»å¡ vs é˜»å¡</h3><h4 id="é˜»å¡"><a href="#é˜»å¡" class="headerlink" title="é˜»å¡"></a>é˜»å¡</h4><ul><li>é˜»å¡æ¨¡å¼ä¸‹ï¼Œç›¸å…³æ–¹æ³•éƒ½ä¼šå¯¼è‡´çº¿ç¨‹æš‚åœ<ul><li>ServerSocketChannel.accept ä¼šåœ¨æ²¡æœ‰è¿æ¥å»ºç«‹æ—¶è®©çº¿ç¨‹æš‚åœ</li><li>SocketChannel.read ä¼šåœ¨æ²¡æœ‰æ•°æ®å¯è¯»æ—¶è®©çº¿ç¨‹æš‚åœ</li><li>é˜»å¡çš„è¡¨ç°å…¶å®å°±æ˜¯çº¿ç¨‹æš‚åœäº†ï¼Œæš‚åœæœŸé—´ä¸ä¼šå ç”¨ cpuï¼Œä½†çº¿ç¨‹ç›¸å½“äºé—²ç½®</li></ul></li><li>å•çº¿ç¨‹ä¸‹ï¼Œé˜»å¡æ–¹æ³•ä¹‹é—´ç›¸äº’å½±å“ï¼Œå‡ ä¹ä¸èƒ½æ­£å¸¸å·¥ä½œï¼Œéœ€è¦å¤šçº¿ç¨‹æ”¯æŒ</li><li>ä½†å¤šçº¿ç¨‹ä¸‹ï¼Œæœ‰æ–°çš„é—®é¢˜ï¼Œä½“ç°åœ¨ä»¥ä¸‹æ–¹é¢<ul><li>32 ä½ jvm ä¸€ä¸ªçº¿ç¨‹ 320kï¼Œ64 ä½ jvm ä¸€ä¸ªçº¿ç¨‹ 1024kï¼Œå¦‚æœè¿æ¥æ•°è¿‡å¤šï¼Œå¿…ç„¶å¯¼è‡´ OOMï¼Œå¹¶ä¸”çº¿ç¨‹å¤ªå¤šï¼Œåè€Œä¼šå› ä¸ºé¢‘ç¹ä¸Šä¸‹æ–‡åˆ‡æ¢å¯¼è‡´æ€§èƒ½é™ä½</li><li>å¯ä»¥é‡‡ç”¨çº¿ç¨‹æ± æŠ€æœ¯æ¥å‡å°‘çº¿ç¨‹æ•°å’Œçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä½†æ²»æ ‡ä¸æ²»æœ¬ï¼Œå¦‚æœæœ‰å¾ˆå¤šè¿æ¥å»ºç«‹ï¼Œä½†é•¿æ—¶é—´ inactiveï¼Œä¼šé˜»å¡çº¿ç¨‹æ± ä¸­æ‰€æœ‰çº¿ç¨‹ï¼Œå› æ­¤ä¸é€‚åˆé•¿è¿æ¥ï¼Œåªé€‚åˆçŸ­è¿æ¥</li></ul></li></ul><p><strong>é˜»å¡æ¨¡å¼ä¸‹ï¼šä¸€ä¸ªæ–¹æ³•çš„é˜»å¡å½±å“å¦ä¸€ä¸ªæ–¹æ³•çš„æ‰§è¡Œã€‚</strong></p><p>æœåŠ¡å™¨ç«¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Server</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨nioæ¥ç†è§£é˜»å¡æ¨¡å¼ï¼Œå•çº¿ç¨‹</span></span><br><span class="line">        <span class="comment">// 1. åˆ›å»ºByteBuffer</span></span><br><span class="line">        <span class="type">ByteBuffer</span> <span class="variable">buffer</span> <span class="operator">=</span> ByteBuffer.allocate(<span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. åˆ›å»ºæœåŠ¡å™¨</span></span><br><span class="line">        <span class="type">ServerSocketChannel</span> <span class="variable">ssc</span> <span class="operator">=</span> ServerSocketChannel.open();</span><br><span class="line">        ssc.configureBlocking(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. ç»‘å®šç›‘å¬ç«¯å£</span></span><br><span class="line">        ssc.bind(<span class="keyword">new</span> <span class="title class_">InetSocketAddress</span>(<span class="number">8080</span>));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4. è¿æ¥é›†åˆ</span></span><br><span class="line">        List&lt;SocketChannel&gt; channels = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="comment">// 4. acceptç®€å†ä¸å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œ SocketChannelç”¨æ¥ä¸å®¢æˆ·ç«¯ä¹‹é—´é€šä¿¡</span></span><br><span class="line">            System.out.println(<span class="string">&quot;connecting...&quot;</span>);</span><br><span class="line">            <span class="type">SocketChannel</span> <span class="variable">sc</span> <span class="operator">=</span> ssc.accept(); <span class="comment">// é˜»å¡æ–¹æ³•ï¼Œçº¿ç¨‹åœæ­¢è¿è¡Œ</span></span><br><span class="line">            System.out.println(<span class="string">&quot;connected...&#123;&#125;&quot;</span> + sc);</span><br><span class="line">            channels.add(sc);</span><br><span class="line">            <span class="keyword">for</span> (SocketChannel channel : channels) &#123;</span><br><span class="line">                <span class="comment">// 5. æ¥å—å®¢æˆ·ç«¯å‘é€çš„æ•°æ®</span></span><br><span class="line">                System.out.println(<span class="string">&quot;before read...&#123;&#125;&quot;</span> + channel);</span><br><span class="line">                channel.read(buffer); <span class="comment">// é˜»å¡æ–¹æ³•ï¼Œçº¿ç¨‹åœæ­¢è¿è¡Œ</span></span><br><span class="line">                buffer.flip();</span><br><span class="line">                debugAll(buffer);</span><br><span class="line">                buffer.clear();</span><br><span class="line">                System.out.println(<span class="string">&quot;after read...&#123;&#125;&quot;</span> + channel);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="type">SocketChannel</span> <span class="variable">sc</span> <span class="operator">=</span> SocketChannel.open();</span><br><span class="line">    sc.connect(<span class="keyword">new</span> <span class="title class_">InetSocketAddress</span>(<span class="string">&quot;localhost&quot;</span>, <span class="number">8080</span>));</span><br><span class="line">    System.out.println(<span class="string">&quot;waiting...&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="éé˜»å¡"><a href="#éé˜»å¡" class="headerlink" title="éé˜»å¡"></a>éé˜»å¡</h4><ul><li>éé˜»å¡æ¨¡å¼ä¸‹ï¼Œç›¸å…³æ–¹æ³•éƒ½ä¼šä¸ä¼šè®©çº¿ç¨‹æš‚åœ<ul><li>åœ¨ ServerSocketChannel.accept åœ¨æ²¡æœ‰è¿æ¥å»ºç«‹æ—¶ï¼Œä¼šè¿”å› nullï¼Œç»§ç»­è¿è¡Œ</li><li>SocketChannel.read åœ¨æ²¡æœ‰æ•°æ®å¯è¯»æ—¶ï¼Œä¼šè¿”å› 0ï¼Œä½†çº¿ç¨‹ä¸å¿…é˜»å¡ï¼Œå¯ä»¥å»æ‰§è¡Œå…¶å®ƒ SocketChannel çš„ read æˆ–æ˜¯å»æ‰§è¡Œ ServerSocketChannel.accept </li><li>å†™æ•°æ®æ—¶ï¼Œçº¿ç¨‹åªæ˜¯ç­‰å¾…æ•°æ®å†™å…¥ Channel å³å¯ï¼Œæ— éœ€ç­‰ Channel é€šè¿‡ç½‘ç»œæŠŠæ•°æ®å‘é€å‡ºå»</li></ul></li><li>ä½†éé˜»å¡æ¨¡å¼ä¸‹ï¼Œå³ä½¿æ²¡æœ‰è¿æ¥å»ºç«‹ï¼Œå’Œå¯è¯»æ•°æ®ï¼Œçº¿ç¨‹ä»ç„¶åœ¨ä¸æ–­è¿è¡Œï¼Œç™½ç™½æµªè´¹äº† cpu</li><li>æ•°æ®å¤åˆ¶è¿‡ç¨‹ä¸­ï¼Œçº¿ç¨‹å®é™…è¿˜æ˜¯é˜»å¡çš„ï¼ˆAIO æ”¹è¿›çš„åœ°æ–¹ï¼‰</li></ul><p>çº¿ç¨‹ä¸€ç›´åœ¨å¾ªç¯ï¼Œå¯èƒ½ä¼šè¿‡åŠ³æ­»ã€‚</p><p>æœåŠ¡å™¨ç«¯ï¼Œå®¢æˆ·ç«¯ä»£ç ä¸å˜</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨nioæ¥ç†è§£é˜»å¡æ¨¡å¼ï¼Œå•çº¿ç¨‹</span></span><br><span class="line">    <span class="comment">// 1. åˆ›å»ºByteBuffer</span></span><br><span class="line">    <span class="type">ByteBuffer</span> <span class="variable">buffer</span> <span class="operator">=</span> ByteBuffer.allocate(<span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. åˆ›å»ºæœåŠ¡å™¨</span></span><br><span class="line">    <span class="type">ServerSocketChannel</span> <span class="variable">ssc</span> <span class="operator">=</span> ServerSocketChannel.open();</span><br><span class="line">    ssc.configureBlocking(<span class="literal">false</span>);<span class="comment">// åˆ‡æ¢ä¸ºéé˜»å¡æ¨¡å¼</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. ç»‘å®šç›‘å¬ç«¯å£</span></span><br><span class="line">    ssc.bind(<span class="keyword">new</span> <span class="title class_">InetSocketAddress</span>(<span class="number">8080</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. è¿æ¥é›†åˆ</span></span><br><span class="line">    List&lt;SocketChannel&gt; channels = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="comment">// 5. acceptç®€å†ä¸å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œ SocketChannelç”¨æ¥ä¸å®¢æˆ·ç«¯ä¹‹é—´é€šä¿¡</span></span><br><span class="line">        <span class="comment">// System.out.println(&quot;connecting...&quot;);</span></span><br><span class="line">        <span class="type">SocketChannel</span> <span class="variable">sc</span> <span class="operator">=</span> ssc.accept(); <span class="comment">// éé˜»å¡æ–¹æ³•ï¼Œçº¿ç¨‹ç»§ç»­è¿è¡Œï¼Œå¦‚æœæ²¡æœ‰è¿æ¥ç®€å»ºç«‹ï¼Œä½†scä¸ºnullï¼ˆåˆ‡æ¢åä¸ºéé˜»å¡æ¨¡å¼ï¼‰</span></span><br><span class="line">        <span class="keyword">if</span> (sc != <span class="literal">null</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;connected...&#123;&#125;&quot;</span> + sc);</span><br><span class="line">            sc.configureBlocking(<span class="literal">false</span>);<span class="comment">// åˆ‡æ¢ä¸ºéé˜»å¡æ¨¡å¼</span></span><br><span class="line">            channels.add(sc);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (SocketChannel channel : channels) &#123;</span><br><span class="line">            <span class="comment">// 6. æ¥å—å®¢æˆ·ç«¯å‘é€çš„æ•°æ®</span></span><br><span class="line">            <span class="comment">// System.out.println(&quot;before read...&#123;&#125;&quot; + channel);</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">read</span> <span class="operator">=</span> channel.read(buffer);<span class="comment">// éé˜»å¡æ–¹æ³•ï¼Œçº¿ç¨‹è®©ç„¶ä¼šç»§ç»­è¿è¡Œï¼Œ æ²¡æœ‰è¯»åˆ°æ•°æ®ï¼Œreadè¿”å›0</span></span><br><span class="line">            <span class="keyword">if</span> (read &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                buffer.flip();</span><br><span class="line">                debugAll(buffer);</span><br><span class="line">                buffer.clear();</span><br><span class="line">                System.out.println(<span class="string">&quot;after read...&#123;&#125;&quot;</span> + channel);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å¤šè·¯å¤ç”¨"><a href="#å¤šè·¯å¤ç”¨" class="headerlink" title="å¤šè·¯å¤ç”¨"></a>å¤šè·¯å¤ç”¨</h4><p>å•çº¿ç¨‹å¯ä»¥é…åˆ Selector å®Œæˆå¯¹å¤šä¸ª Channel å¯è¯»å†™äº‹ä»¶çš„ç›‘æ§ï¼Œè¿™ç§°ä¹‹ä¸ºå¤šè·¯å¤ç”¨</p><ul><li>å¤šè·¯å¤ç”¨ä»…é’ˆå¯¹ç½‘ç»œ IOã€æ™®é€šæ–‡ä»¶ IO æ²¡æ³•åˆ©ç”¨å¤šè·¯å¤ç”¨</li><li>å¦‚æœä¸ç”¨ Selector çš„éé˜»å¡æ¨¡å¼ï¼Œçº¿ç¨‹å¤§éƒ¨åˆ†æ—¶é—´éƒ½åœ¨åšæ— ç”¨åŠŸï¼Œè€Œ Selector èƒ½å¤Ÿä¿è¯<ul><li>æœ‰å¯è¿æ¥äº‹ä»¶æ—¶æ‰å»è¿æ¥</li><li>æœ‰å¯è¯»äº‹ä»¶æ‰å»è¯»å–</li><li>æœ‰å¯å†™äº‹ä»¶æ‰å»å†™å…¥<ul><li>é™äºç½‘ç»œä¼ è¾“èƒ½åŠ›ï¼ŒChannel æœªå¿…æ—¶æ—¶å¯å†™ï¼Œä¸€æ—¦ Channel å¯å†™ï¼Œä¼šè§¦å‘ Selector çš„å¯å†™äº‹ä»¶</li></ul></li></ul></li></ul><h3 id="Selector-1"><a href="#Selector-1" class="headerlink" title="Selector"></a>Selector</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">graph TD</span><br><span class="line">subgraph selector ç‰ˆ</span><br><span class="line">thread --&gt; selector</span><br><span class="line">selector --&gt; c1(channel)</span><br><span class="line">selector --&gt; c2(channel)</span><br><span class="line">selector --&gt; c3(channel)</span><br><span class="line">end</span><br></pre></td></tr></table></figure><p>å¥½å¤„</p><ul><li>ä¸€ä¸ªçº¿ç¨‹é…åˆ selector å°±å¯ä»¥ç›‘æ§å¤šä¸ª channel çš„äº‹ä»¶ï¼Œäº‹ä»¶å‘ç”Ÿçº¿ç¨‹æ‰å»å¤„ç†ã€‚é¿å…éé˜»å¡æ¨¡å¼ä¸‹æ‰€åšæ— ç”¨åŠŸ</li><li>è®©è¿™ä¸ªçº¿ç¨‹èƒ½å¤Ÿè¢«å……åˆ†åˆ©ç”¨</li><li>èŠ‚çº¦äº†çº¿ç¨‹çš„æ•°é‡</li><li>å‡å°‘äº†çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢</li></ul><h4 id="åˆ›å»º"><a href="#åˆ›å»º" class="headerlink" title="åˆ›å»º"></a>åˆ›å»º</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Selector</span> <span class="variable">selector</span> <span class="operator">=</span> Selector.open();</span><br></pre></td></tr></table></figure><h4 id="ç»‘å®š-Channel-äº‹ä»¶"><a href="#ç»‘å®š-Channel-äº‹ä»¶" class="headerlink" title="ç»‘å®š Channel äº‹ä»¶"></a>ç»‘å®š Channel äº‹ä»¶</h4><p>ä¹Ÿç§°ä¹‹ä¸ºæ³¨å†Œäº‹ä»¶ï¼Œç»‘å®šçš„äº‹ä»¶ selector æ‰ä¼šå…³å¿ƒ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">channel.configureBlocking(<span class="literal">false</span>);</span><br><span class="line"><span class="type">SelectionKey</span> <span class="variable">key</span> <span class="operator">=</span> channel.register(selector, ç»‘å®šäº‹ä»¶);</span><br></pre></td></tr></table></figure><ul><li>channel å¿…é¡»å·¥ä½œåœ¨éé˜»å¡æ¨¡å¼</li><li>FileChannel æ²¡æœ‰éé˜»å¡æ¨¡å¼ï¼Œå› æ­¤ä¸èƒ½é…åˆ selector ä¸€èµ·ä½¿ç”¨</li><li>ç»‘å®šçš„äº‹ä»¶ç±»å‹å¯ä»¥æœ‰<ul><li>connect - å®¢æˆ·ç«¯è¿æ¥æˆåŠŸæ—¶è§¦å‘</li><li>accept - æœåŠ¡å™¨ç«¯æˆåŠŸæ¥å—è¿æ¥æ—¶è§¦å‘</li><li>read - æ•°æ®å¯è¯»å…¥æ—¶è§¦å‘ï¼Œæœ‰å› ä¸ºæ¥æ”¶èƒ½åŠ›å¼±ï¼Œæ•°æ®æš‚ä¸èƒ½è¯»å…¥çš„æƒ…å†µ</li><li>write - æ•°æ®å¯å†™å‡ºæ—¶è§¦å‘ï¼Œæœ‰å› ä¸ºå‘é€èƒ½åŠ›å¼±ï¼Œæ•°æ®æš‚ä¸èƒ½å†™å‡ºçš„æƒ…å†µ</li></ul></li></ul><h4 id="ç›‘å¬-Channel-äº‹ä»¶"><a href="#ç›‘å¬-Channel-äº‹ä»¶" class="headerlink" title="ç›‘å¬ Channel äº‹ä»¶"></a>ç›‘å¬ Channel äº‹ä»¶</h4><p>å¯ä»¥é€šè¿‡ä¸‹é¢ä¸‰ç§æ–¹æ³•æ¥ç›‘å¬æ˜¯å¦æœ‰äº‹ä»¶å‘ç”Ÿï¼Œæ–¹æ³•çš„è¿”å›å€¼ä»£è¡¨æœ‰å¤šå°‘ channel å‘ç”Ÿäº†äº‹ä»¶</p><p>æ–¹æ³•1ï¼Œé˜»å¡ç›´åˆ°ç»‘å®šäº‹ä»¶å‘ç”Ÿ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> selector.select();</span><br></pre></td></tr></table></figure><p>æ–¹æ³•2ï¼Œé˜»å¡ç›´åˆ°ç»‘å®šäº‹ä»¶å‘ç”Ÿï¼Œæˆ–æ˜¯è¶…æ—¶ï¼ˆæ—¶é—´å•ä½ä¸º msï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> selector.select(<span class="type">long</span> timeout);</span><br></pre></td></tr></table></figure><p>æ–¹æ³•3ï¼Œä¸ä¼šé˜»å¡ï¼Œä¹Ÿå°±æ˜¯ä¸ç®¡æœ‰æ²¡æœ‰äº‹ä»¶ï¼Œç«‹åˆ»è¿”å›ï¼Œè‡ªå·±æ ¹æ®è¿”å›å€¼æ£€æŸ¥æ˜¯å¦æœ‰äº‹ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> selector.selectNow();</span><br></pre></td></tr></table></figure><h4 id="ğŸ’¡-select-ä½•æ—¶ä¸é˜»å¡"><a href="#ğŸ’¡-select-ä½•æ—¶ä¸é˜»å¡" class="headerlink" title="ğŸ’¡ select ä½•æ—¶ä¸é˜»å¡"></a>ğŸ’¡ select ä½•æ—¶ä¸é˜»å¡</h4><blockquote><ul><li>äº‹ä»¶å‘ç”Ÿæ—¶<ul><li>å®¢æˆ·ç«¯å‘èµ·è¿æ¥è¯·æ±‚ï¼Œä¼šè§¦å‘ accept äº‹ä»¶</li><li>å®¢æˆ·ç«¯å‘é€æ•°æ®è¿‡æ¥ï¼Œå®¢æˆ·ç«¯æ­£å¸¸ã€å¼‚å¸¸å…³é—­æ—¶ï¼Œéƒ½ä¼šè§¦å‘ read äº‹ä»¶ï¼Œå¦å¤–å¦‚æœå‘é€çš„æ•°æ®å¤§äº buffer ç¼“å†²åŒºï¼Œä¼šè§¦å‘å¤šæ¬¡è¯»å–äº‹ä»¶</li><li>channel å¯å†™ï¼Œä¼šè§¦å‘ write äº‹ä»¶</li><li>åœ¨ linux ä¸‹ nio bug å‘ç”Ÿæ—¶</li></ul></li><li>è°ƒç”¨ selector.wakeup()</li><li>è°ƒç”¨ selector.close()</li><li>selector æ‰€åœ¨çº¿ç¨‹ interrupt</li></ul></blockquote><h3 id="å¯¹æ¡ˆä¾‹çš„åˆ†æå’Œè¡¥å……"><a href="#å¯¹æ¡ˆä¾‹çš„åˆ†æå’Œè¡¥å……" class="headerlink" title="å¯¹æ¡ˆä¾‹çš„åˆ†æå’Œè¡¥å……"></a>å¯¹æ¡ˆä¾‹çš„åˆ†æå’Œè¡¥å……</h3><p><strong>æ•´ä½“çš„æµç¨‹</strong>ï¼šå…ˆæ³¨å†Œä¸€ä¸ªServerSocketChannelè¿›selectoré‡Œä¸“é—¨è·å–è¿æ¥ç”ŸæˆSokertChannelçš„ï¼Œç„¶åç”Ÿæˆçš„SokertChannelæ³¨å†Œè¿›selectoré‡Œï¼Œæœ‰äº‹ä»¶è¿›æ¥å°±è¿­ä»£å¤„ç†ã€‚</p><p><strong>ä»€ä¹ˆæ—¶å€™æ³¨å†ŒSokertChannelä¸ºread</strong>ï¼šå»ºç«‹è¿æ¥ä¹‹ååœ¨acceptäº‹ä»¶é‡Œé¢æ³¨å†Œreadï¼Œç„¶åç­‰readäº‹ä»¶è§¦å‘.</p><p><strong>ServerSocketChannelå’ŒSokertChannelçš„åŒºåˆ«</strong>ï¼š</p><ul><li>ServerSocketChannelæ˜¯æœåŠ¡å™¨çš„channelã€‚</li><li>SokertChannelæ˜¯å®¢æˆ·ç«¯çš„channelï¼Œç”¨æ¥é€šä¿¡ã€‚</li></ul><p><strong>ä¸ºä»€ä¹ˆè¦åˆ é™¤åœ¨selectkeysä¸Šçš„key</strong>?</p><p><img src="/../images/Netty01-nio/image-20221123165357016.png" alt="image-20221123165357016"></p><p><img src="/../images/Netty01-nio/image-20221123170138209.png" alt="image-20221123170138209"></p><p><img src="/../images/Netty01-nio/image-20221123170207056.png" alt="image-20221123170207056"></p><p>selectorå†…éƒ¨å­˜åœ¨ä¸€ä¸ªç›‘å¬é›†åˆï¼Œè€Œselectkeysæ˜¯çŠ¶æ€å‘ç”Ÿå˜åŒ–çš„é›†åˆã€‚ä»çŠ¶æ€å‘ç”Ÿå˜åŒ–çš„é›†åˆä¸­ç§»é™¤å…ƒç´ ï¼Œä¸ä»£è¡¨ç›‘å¬åˆ—è¡¨ä¸­çš„å…ƒç´ è¢«ç§»é™¤äº†ã€‚è€Œåœ¨åŸä¾‹é¢˜ä¸­ï¼Œå®¢æˆ·ç«¯å‘é€æ•°æ®ï¼Œå‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œæ˜¯å› ä¸ºåœ¨selectkeysï¼ˆæ²¡åˆ é™¤ç¬¬ä¸€ä¸ªssckeyï¼‰ï¼Œè¯¥keyæ˜¯acceptè¯·æ±‚ï¼Œè¿›å…¥åˆ°ç¬¬ä¸€ä¸ªifä¸­ï¼Œå› ä¸ºæ²¡æœ‰å®¢æˆ·ç«¯è¿æ¥ï¼Œæ‰€ä»¥channel.accept()è¿”å›nullã€‚æ‰§è¡Œä¸‹ä¸€å¥å°±ä¼šæŠ¥é”™ã€‚æ‰€ä»¥åªè¦æ‹¿å‡ºäº†ä¸€ä¸ªkeyï¼Œå°±è¦åŠæ—¶åœ¨selectkeysä¸Šåˆ é™¤ã€‚</p><p><strong>å¯¹è¯»äº‹ä»¶çš„å¤„ç†</strong>ï¼š</p><p>å®¢æˆ·ç«¯åœ¨å…³é—­ä¹‹åä¼šå‘é€ä¸€ä¸ªè¯»äº‹ä»¶ï¼Œå¦‚æœä¸å¤„ç†çš„è¯ï¼ŒæœåŠ¡èµ·å°±ä¼šæŒ‚æ‰ã€‚</p><p>å¦‚ä½•è§£å†³ï¼Ÿ</p><ul><li>å¯¹äºå¼‚å¸¸å…³é—­çš„å®¢æˆ·ç«¯è¿æ¥ï¼Œé€šè¿‡æ•è·å¼‚å¸¸ï¼Œåœ¨catchä¸­è°ƒç”¨key.cancel();å…³é—­ã€‚</li><li>å¯¹äºæ­£å¸¸å…³é—­çš„å®¢æˆ·ç«¯è¿æ¥ï¼Œé€šè¿‡åˆ¤æ–­readçš„è¿”å›å€¼ï¼Œå¦‚æœæ˜¯-1è¯´æ˜å·²ç»å…³é—­äº†ï¼Œè°ƒç”¨key.cancel();å…³é—­ã€‚</li><li>å› ä¸ºå®¢æˆ·ç«¯æ–­å¼€äº†ï¼Œå› æ­¤éœ€è¦å°†keyå–æ¶ˆï¼ˆä»selectorçš„keyé›†åˆæ­£çœŸåˆ é™¤keyï¼‰</li></ul><h3 id="å¤„ç†-accept-äº‹ä»¶"><a href="#å¤„ç†-accept-äº‹ä»¶" class="headerlink" title="å¤„ç† accept äº‹ä»¶"></a>å¤„ç† accept äº‹ä»¶</h3><p>å®¢æˆ·ç«¯ä»£ç ä¸º</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Socket</span>(<span class="string">&quot;localhost&quot;</span>, <span class="number">8080</span>)) &#123;</span><br><span class="line">            System.out.println(socket);</span><br><span class="line">            socket.getOutputStream().write(<span class="string">&quot;world&quot;</span>.getBytes());</span><br><span class="line">            System.in.read();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœåŠ¡å™¨ç«¯ä»£ç ä¸º</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChannelDemo6</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">ServerSocketChannel</span> <span class="variable">channel</span> <span class="operator">=</span> ServerSocketChannel.open()) &#123;</span><br><span class="line">            channel.bind(<span class="keyword">new</span> <span class="title class_">InetSocketAddress</span>(<span class="number">8080</span>));</span><br><span class="line">            System.out.println(channel);</span><br><span class="line">            <span class="type">Selector</span> <span class="variable">selector</span> <span class="operator">=</span> Selector.open();</span><br><span class="line">            channel.configureBlocking(<span class="literal">false</span>);</span><br><span class="line">            channel.register(selector, SelectionKey.OP_ACCEPT);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> selector.select();</span><br><span class="line"><span class="comment">//                int count = selector.selectNow();</span></span><br><span class="line">                log.debug(<span class="string">&quot;select count: &#123;&#125;&quot;</span>, count);</span><br><span class="line"><span class="comment">//                if(count &lt;= 0) &#123;</span></span><br><span class="line"><span class="comment">//                    continue;</span></span><br><span class="line"><span class="comment">//                &#125;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">// è·å–æ‰€æœ‰äº‹ä»¶</span></span><br><span class="line">                Set&lt;SelectionKey&gt; keys = selector.selectedKeys();</span><br><span class="line"></span><br><span class="line">                <span class="comment">// éå†æ‰€æœ‰äº‹ä»¶ï¼Œé€ä¸€å¤„ç†</span></span><br><span class="line">                Iterator&lt;SelectionKey&gt; iter = keys.iterator();</span><br><span class="line">                <span class="keyword">while</span> (iter.hasNext()) &#123;</span><br><span class="line">                    <span class="type">SelectionKey</span> <span class="variable">key</span> <span class="operator">=</span> iter.next();</span><br><span class="line">                    <span class="comment">// åˆ¤æ–­äº‹ä»¶ç±»å‹</span></span><br><span class="line">                    <span class="keyword">if</span> (key.isAcceptable()) &#123;</span><br><span class="line">                        <span class="type">ServerSocketChannel</span> <span class="variable">c</span> <span class="operator">=</span> (ServerSocketChannel) key.channel();</span><br><span class="line">                        <span class="comment">// å¿…é¡»å¤„ç†</span></span><br><span class="line">                        <span class="type">SocketChannel</span> <span class="variable">sc</span> <span class="operator">=</span> c.accept();</span><br><span class="line">                        log.debug(<span class="string">&quot;&#123;&#125;&quot;</span>, sc);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// å¤„ç†å®Œæ¯•ï¼Œå¿…é¡»å°†äº‹ä»¶ç§»é™¤</span></span><br><span class="line">                    iter.remove();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’¡-äº‹ä»¶å‘ç”Ÿåèƒ½å¦ä¸å¤„ç†"><a href="#ğŸ’¡-äº‹ä»¶å‘ç”Ÿåèƒ½å¦ä¸å¤„ç†" class="headerlink" title="ğŸ’¡ äº‹ä»¶å‘ç”Ÿåèƒ½å¦ä¸å¤„ç†"></a>ğŸ’¡ äº‹ä»¶å‘ç”Ÿåèƒ½å¦ä¸å¤„ç†</h4><blockquote><p>äº‹ä»¶ä¸å¤„ç†ï¼Œç­‰äºä¸€ç›´æœ‰è¿™ä¸ªäº‹ä»¶ï¼Œselectæ–¹æ³•å°±ä¸ä¼šé˜»å¡äº†ã€‚</p><p>æ‰€ä»¥äº‹ä»¶å‘ç”Ÿåï¼Œè¦ä¹ˆå¤„ç†(accept)ï¼Œè¦ä¹ˆå–æ¶ˆï¼ˆcancelï¼‰ï¼Œä¸èƒ½ä»€ä¹ˆéƒ½ä¸åšï¼Œå¦åˆ™ä¸‹æ¬¡è¯¥äº‹ä»¶ä»ä¼šè§¦å‘ï¼Œè¿™æ˜¯å› ä¸º nio åº•å±‚ä½¿ç”¨çš„æ˜¯æ°´å¹³è§¦å‘</p></blockquote><h3 id="å¤„ç†-read-äº‹ä»¶"><a href="#å¤„ç†-read-äº‹ä»¶" class="headerlink" title="å¤„ç† read äº‹ä»¶"></a>å¤„ç† read äº‹ä»¶</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChannelDemo6</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">ServerSocketChannel</span> <span class="variable">channel</span> <span class="operator">=</span> ServerSocketChannel.open()) &#123;</span><br><span class="line">            channel.bind(<span class="keyword">new</span> <span class="title class_">InetSocketAddress</span>(<span class="number">8080</span>));</span><br><span class="line">            System.out.println(channel);</span><br><span class="line">            <span class="type">Selector</span> <span class="variable">selector</span> <span class="operator">=</span> Selector.open();</span><br><span class="line">            channel.configureBlocking(<span class="literal">false</span>);</span><br><span class="line">            channel.register(selector, SelectionKey.OP_ACCEPT);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> selector.select();</span><br><span class="line"><span class="comment">//                int count = selector.selectNow();</span></span><br><span class="line">                log.debug(<span class="string">&quot;select count: &#123;&#125;&quot;</span>, count);</span><br><span class="line"><span class="comment">//                if(count &lt;= 0) &#123;</span></span><br><span class="line"><span class="comment">//                    continue;</span></span><br><span class="line"><span class="comment">//                &#125;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">// è·å–æ‰€æœ‰äº‹ä»¶</span></span><br><span class="line">                Set&lt;SelectionKey&gt; keys = selector.selectedKeys();</span><br><span class="line"></span><br><span class="line">                <span class="comment">// éå†æ‰€æœ‰äº‹ä»¶ï¼Œé€ä¸€å¤„ç†</span></span><br><span class="line">                Iterator&lt;SelectionKey&gt; iter = keys.iterator();</span><br><span class="line">                <span class="keyword">while</span> (iter.hasNext()) &#123;</span><br><span class="line">                    <span class="type">SelectionKey</span> <span class="variable">key</span> <span class="operator">=</span> iter.next();</span><br><span class="line">                    <span class="comment">// åˆ¤æ–­äº‹ä»¶ç±»å‹</span></span><br><span class="line">                    <span class="keyword">if</span> (key.isAcceptable()) &#123;</span><br><span class="line">                        <span class="type">ServerSocketChannel</span> <span class="variable">c</span> <span class="operator">=</span> (ServerSocketChannel) key.channel();</span><br><span class="line">                        <span class="comment">// å¿…é¡»å¤„ç†</span></span><br><span class="line">                        <span class="type">SocketChannel</span> <span class="variable">sc</span> <span class="operator">=</span> c.accept();</span><br><span class="line">                        sc.configureBlocking(<span class="literal">false</span>);</span><br><span class="line">                        sc.register(selector, SelectionKey.OP_READ);</span><br><span class="line">                        log.debug(<span class="string">&quot;è¿æ¥å·²å»ºç«‹: &#123;&#125;&quot;</span>, sc);</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (key.isReadable()) &#123;</span><br><span class="line">                        <span class="type">SocketChannel</span> <span class="variable">sc</span> <span class="operator">=</span> (SocketChannel) key.channel();</span><br><span class="line">                        <span class="type">ByteBuffer</span> <span class="variable">buffer</span> <span class="operator">=</span> ByteBuffer.allocate(<span class="number">128</span>);</span><br><span class="line">                        <span class="type">int</span> <span class="variable">read</span> <span class="operator">=</span> sc.read(buffer);</span><br><span class="line">                        <span class="keyword">if</span>(read == -<span class="number">1</span>) &#123;</span><br><span class="line">                            key.cancel();</span><br><span class="line">                            sc.close();</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            buffer.flip();</span><br><span class="line">                            debug(buffer);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// å¤„ç†å®Œæ¯•ï¼Œå¿…é¡»å°†äº‹ä»¶ç§»é™¤</span></span><br><span class="line">                    iter.remove();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¼€å¯ä¸¤ä¸ªå®¢æˆ·ç«¯ï¼Œä¿®æ”¹ä¸€ä¸‹å‘é€æ–‡å­—ï¼Œè¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">sun.nio.ch.ServerSocketChannelImpl[/0:0:0:0:0:0:0:0:8080]</span><br><span class="line">21:16:39 [DEBUG] [main] c.i.n.ChannelDemo6 - select count: 1</span><br><span class="line">21:16:39 [DEBUG] [main] c.i.n.ChannelDemo6 - è¿æ¥å·²å»ºç«‹: java.nio.channels.SocketChannel[connected local=/127.0.0.1:8080 remote=/127.0.0.1:60367]</span><br><span class="line">21:16:39 [DEBUG] [main] c.i.n.ChannelDemo6 - select count: 1</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 68 65 6c 6c 6f                                  |hello           |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">21:16:59 [DEBUG] [main] c.i.n.ChannelDemo6 - select count: 1</span><br><span class="line">21:16:59 [DEBUG] [main] c.i.n.ChannelDemo6 - è¿æ¥å·²å»ºç«‹: java.nio.channels.SocketChannel[connected local=/127.0.0.1:8080 remote=/127.0.0.1:60378]</span><br><span class="line">21:16:59 [DEBUG] [main] c.i.n.ChannelDemo6 - select count: 1</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 77 6f 72 6c 64                                  |world           |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br></pre></td></tr></table></figure><h4 id="ğŸ’¡-ä¸ºä½•è¦-iter-remove"><a href="#ğŸ’¡-ä¸ºä½•è¦-iter-remove" class="headerlink" title="ğŸ’¡ ä¸ºä½•è¦ iter.remove()"></a>ğŸ’¡ ä¸ºä½•è¦ iter.remove()</h4><blockquote><p>å› ä¸º select åœ¨äº‹ä»¶å‘ç”Ÿåï¼Œå°±ä¼šå°†ç›¸å…³çš„ key æ”¾å…¥ selectedKeys é›†åˆï¼Œä½†ä¸ä¼šåœ¨å¤„ç†å®Œåä» selectedKeys é›†åˆä¸­ç§»é™¤ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±ç¼–ç åˆ é™¤ã€‚ä¾‹å¦‚</p><ul><li>ç¬¬ä¸€æ¬¡è§¦å‘äº† ssckey ä¸Šçš„ accept äº‹ä»¶ï¼Œæ²¡æœ‰ç§»é™¤ ssckey </li><li>ç¬¬äºŒæ¬¡è§¦å‘äº† sckey ä¸Šçš„ read äº‹ä»¶ï¼Œä½†è¿™æ—¶ selectedKeys ä¸­è¿˜æœ‰ä¸Šæ¬¡çš„ ssckey ï¼Œåœ¨å¤„ç†æ—¶å› ä¸ºæ²¡æœ‰çœŸæ­£çš„ serverSocket è¿ä¸Šäº†ï¼Œå°±ä¼šå¯¼è‡´ç©ºæŒ‡é’ˆå¼‚å¸¸</li></ul></blockquote><h4 id="ğŸ’¡-cancel-çš„ä½œç”¨"><a href="#ğŸ’¡-cancel-çš„ä½œç”¨" class="headerlink" title="ğŸ’¡ cancel çš„ä½œç”¨"></a>ğŸ’¡ cancel çš„ä½œç”¨</h4><blockquote><p>cancel ä¼šå–æ¶ˆæ³¨å†Œåœ¨ selector ä¸Šçš„ channelï¼Œå¹¶ä» keys é›†åˆä¸­åˆ é™¤ key åç»­ä¸ä¼šå†ç›‘å¬äº‹ä»¶</p></blockquote><h4 id="âš ï¸-ä¸å¤„ç†è¾¹ç•Œçš„é—®é¢˜"><a href="#âš ï¸-ä¸å¤„ç†è¾¹ç•Œçš„é—®é¢˜" class="headerlink" title="âš ï¸  ä¸å¤„ç†è¾¹ç•Œçš„é—®é¢˜"></a>âš ï¸  ä¸å¤„ç†è¾¹ç•Œçš„é—®é¢˜</h4><p>ä»¥å‰æœ‰åŒå­¦å†™è¿‡è¿™æ ·çš„ä»£ç ï¼Œæ€è€ƒæ³¨é‡Šä¸­ä¸¤ä¸ªé—®é¢˜ï¼Œä»¥ bio ä¸ºä¾‹ï¼Œå…¶å® nio é“ç†æ˜¯ä¸€æ ·çš„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Server</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        ServerSocket ss=<span class="keyword">new</span> <span class="title class_">ServerSocket</span>(<span class="number">9000</span>);</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="type">Socket</span> <span class="variable">s</span> <span class="operator">=</span> ss.accept();</span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> s.getInputStream();</span><br><span class="line">            <span class="comment">// è¿™é‡Œè¿™ä¹ˆå†™ï¼Œæœ‰æ²¡æœ‰é—®é¢˜</span></span><br><span class="line">            <span class="type">byte</span>[] arr = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">4</span>];</span><br><span class="line">            <span class="keyword">while</span>(<span class="literal">true</span>) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">read</span> <span class="operator">=</span> in.read(arr);</span><br><span class="line">                <span class="comment">// è¿™é‡Œè¿™ä¹ˆå†™ï¼Œæœ‰æ²¡æœ‰é—®é¢˜</span></span><br><span class="line">                <span class="keyword">if</span>(read == -<span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(arr, <span class="number">0</span>, read));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">Socket</span> <span class="variable">max</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Socket</span>(<span class="string">&quot;localhost&quot;</span>, <span class="number">9000</span>);</span><br><span class="line">        <span class="type">OutputStream</span> <span class="variable">out</span> <span class="operator">=</span> max.getOutputStream();</span><br><span class="line">        out.write(<span class="string">&quot;hello&quot;</span>.getBytes());</span><br><span class="line">        out.write(<span class="string">&quot;world&quot;</span>.getBytes());</span><br><span class="line">        out.write(<span class="string">&quot;ä½ å¥½&quot;</span>.getBytes());</span><br><span class="line">        max.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hell</span><br><span class="line">owor</span><br><span class="line">ldï¿½</span><br><span class="line">ï¿½å¥½</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆï¼Ÿ</p><h4 id="å¤„ç†æ¶ˆæ¯çš„è¾¹ç•Œ"><a href="#å¤„ç†æ¶ˆæ¯çš„è¾¹ç•Œ" class="headerlink" title="å¤„ç†æ¶ˆæ¯çš„è¾¹ç•Œ"></a>å¤„ç†æ¶ˆæ¯çš„è¾¹ç•Œ</h4><p><img src="/../images/Netty01-nio/0023.png"></p><p><img src="/../images/Netty01-nio/image-20221123184612089.png" alt="image-20221123184612089"></p><ul><li>ä¸€ç§æ€è·¯æ˜¯å›ºå®šæ¶ˆæ¯é•¿åº¦ï¼Œæ•°æ®åŒ…å¤§å°ä¸€æ ·ï¼ŒæœåŠ¡å™¨æŒ‰é¢„å®šé•¿åº¦è¯»å–ï¼Œç¼ºç‚¹æ˜¯æµªè´¹å¸¦å®½</li><li>å¦ä¸€ç§æ€è·¯æ˜¯æŒ‰åˆ†éš”ç¬¦æ‹†åˆ†ï¼Œç¼ºç‚¹æ˜¯æ•ˆç‡ä½</li><li>TLV æ ¼å¼ï¼Œå³ Type ç±»å‹ã€Length é•¿åº¦ã€Value æ•°æ®ï¼Œç±»å‹å’Œé•¿åº¦å·²çŸ¥çš„æƒ…å†µä¸‹ï¼Œå°±å¯ä»¥æ–¹ä¾¿è·å–æ¶ˆæ¯å¤§å°ï¼Œåˆ†é…åˆé€‚çš„ bufferï¼Œç¼ºç‚¹æ˜¯ buffer éœ€è¦æå‰åˆ†é…ï¼Œå¦‚æœå†…å®¹è¿‡å¤§ï¼Œåˆ™å½±å“ server ååé‡<ul><li>Http 1.1 æ˜¯ TLV æ ¼å¼</li><li>Http 2.0 æ˜¯ LTV æ ¼å¼</li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram </span><br><span class="line">participant c1 as å®¢æˆ·ç«¯1</span><br><span class="line">participant s as æœåŠ¡å™¨</span><br><span class="line">participant b1 as ByteBuffer1</span><br><span class="line">participant b2 as ByteBuffer2</span><br><span class="line">c1 -&gt;&gt; s: å‘é€ 01234567890abcdef3333\r</span><br><span class="line">s -&gt;&gt; b1: ç¬¬ä¸€æ¬¡ read å­˜å…¥ 01234567890abcdef</span><br><span class="line">s -&gt;&gt; b2: æ‰©å®¹</span><br><span class="line">b1 -&gt;&gt; b2: æ‹·è´ 01234567890abcdef</span><br><span class="line">s -&gt;&gt; b2: ç¬¬äºŒæ¬¡ read å­˜å…¥ 3333\r</span><br><span class="line">b2 -&gt;&gt; b2: 01234567890abcdef3333\r</span><br></pre></td></tr></table></figure><p>æœåŠ¡å™¨ç«¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">split</span><span class="params">(ByteBuffer source)</span> &#123;</span><br><span class="line">    source.flip();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; source.limit(); i++) &#123;</span><br><span class="line">        <span class="comment">// æ‰¾åˆ°ä¸€æ¡å®Œæ•´æ¶ˆæ¯</span></span><br><span class="line">        <span class="keyword">if</span> (source.get(i) == <span class="string">&#x27;\n&#x27;</span>) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> i + <span class="number">1</span> - source.position();</span><br><span class="line">            <span class="comment">// æŠŠè¿™æ¡å®Œæ•´æ¶ˆæ¯å­˜å…¥æ–°çš„ ByteBuffer</span></span><br><span class="line">            <span class="type">ByteBuffer</span> <span class="variable">target</span> <span class="operator">=</span> ByteBuffer.allocate(length);</span><br><span class="line">            <span class="comment">// ä» source è¯»ï¼Œå‘ target å†™</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; length; j++) &#123;</span><br><span class="line">                target.put(source.get());</span><br><span class="line">            &#125;</span><br><span class="line">            debugAll(target);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    source.compact(); <span class="comment">// 0123456789abcdef  position 16 limit 16</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="comment">// 1. åˆ›å»º selector, ç®¡ç†å¤šä¸ª channel</span></span><br><span class="line">    <span class="type">Selector</span> <span class="variable">selector</span> <span class="operator">=</span> Selector.open();</span><br><span class="line">    <span class="type">ServerSocketChannel</span> <span class="variable">ssc</span> <span class="operator">=</span> ServerSocketChannel.open();</span><br><span class="line">    ssc.configureBlocking(<span class="literal">false</span>);</span><br><span class="line">    <span class="comment">// 2. å»ºç«‹ selector å’Œ channel çš„è”ç³»ï¼ˆæ³¨å†Œï¼‰</span></span><br><span class="line">    <span class="comment">// SelectionKey å°±æ˜¯å°†æ¥äº‹ä»¶å‘ç”Ÿåï¼Œé€šè¿‡å®ƒå¯ä»¥çŸ¥é“äº‹ä»¶å’Œå“ªä¸ªchannelçš„äº‹ä»¶</span></span><br><span class="line">    <span class="type">SelectionKey</span> <span class="variable">sscKey</span> <span class="operator">=</span> ssc.register(selector, <span class="number">0</span>, <span class="literal">null</span>);</span><br><span class="line">    <span class="comment">// key åªå…³æ³¨ accept äº‹ä»¶</span></span><br><span class="line">    sscKey.interestOps(SelectionKey.OP_ACCEPT);</span><br><span class="line">    log.debug(<span class="string">&quot;sscKey:&#123;&#125;&quot;</span>, sscKey);</span><br><span class="line">    ssc.bind(<span class="keyword">new</span> <span class="title class_">InetSocketAddress</span>(<span class="number">8080</span>));</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="comment">// 3. select æ–¹æ³•, æ²¡æœ‰äº‹ä»¶å‘ç”Ÿï¼Œçº¿ç¨‹é˜»å¡ï¼Œæœ‰äº‹ä»¶ï¼Œçº¿ç¨‹æ‰ä¼šæ¢å¤è¿è¡Œ</span></span><br><span class="line">        <span class="comment">// select åœ¨äº‹ä»¶æœªå¤„ç†æ—¶ï¼Œå®ƒä¸ä¼šé˜»å¡, äº‹ä»¶å‘ç”Ÿåè¦ä¹ˆå¤„ç†ï¼Œè¦ä¹ˆå–æ¶ˆï¼Œä¸èƒ½ç½®ä¹‹ä¸ç†</span></span><br><span class="line">        selector.select();</span><br><span class="line">        <span class="comment">// 4. å¤„ç†äº‹ä»¶, selectedKeys å†…éƒ¨åŒ…å«äº†æ‰€æœ‰å‘ç”Ÿçš„äº‹ä»¶</span></span><br><span class="line">        Iterator&lt;SelectionKey&gt; iter = selector.selectedKeys().iterator(); <span class="comment">// accept, read</span></span><br><span class="line">        <span class="keyword">while</span> (iter.hasNext()) &#123;</span><br><span class="line">            <span class="type">SelectionKey</span> <span class="variable">key</span> <span class="operator">=</span> iter.next();</span><br><span class="line">            <span class="comment">// å¤„ç†key æ—¶ï¼Œè¦ä» selectedKeys é›†åˆä¸­åˆ é™¤ï¼Œå¦åˆ™ä¸‹æ¬¡å¤„ç†å°±ä¼šæœ‰é—®é¢˜</span></span><br><span class="line">            iter.remove();</span><br><span class="line">            log.debug(<span class="string">&quot;key: &#123;&#125;&quot;</span>, key);</span><br><span class="line">            <span class="comment">// 5. åŒºåˆ†äº‹ä»¶ç±»å‹</span></span><br><span class="line">            <span class="keyword">if</span> (key.isAcceptable()) &#123; <span class="comment">// å¦‚æœæ˜¯ accept</span></span><br><span class="line">                <span class="type">ServerSocketChannel</span> <span class="variable">channel</span> <span class="operator">=</span> (ServerSocketChannel) key.channel();</span><br><span class="line">                <span class="type">SocketChannel</span> <span class="variable">sc</span> <span class="operator">=</span> channel.accept();</span><br><span class="line">                sc.configureBlocking(<span class="literal">false</span>);</span><br><span class="line">                <span class="type">ByteBuffer</span> <span class="variable">buffer</span> <span class="operator">=</span> ByteBuffer.allocate(<span class="number">16</span>); <span class="comment">// attachment</span></span><br><span class="line">                <span class="comment">// å°†ä¸€ä¸ª byteBuffer ä½œä¸ºé™„ä»¶å…³è”åˆ° selectionKey ä¸Š</span></span><br><span class="line">                <span class="type">SelectionKey</span> <span class="variable">scKey</span> <span class="operator">=</span> sc.register(selector, <span class="number">0</span>, buffer);</span><br><span class="line">                scKey.interestOps(SelectionKey.OP_READ);</span><br><span class="line">                log.debug(<span class="string">&quot;&#123;&#125;&quot;</span>, sc);</span><br><span class="line">                log.debug(<span class="string">&quot;scKey:&#123;&#125;&quot;</span>, scKey);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (key.isReadable()) &#123; <span class="comment">// å¦‚æœæ˜¯ read</span></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="type">SocketChannel</span> <span class="variable">channel</span> <span class="operator">=</span> (SocketChannel) key.channel(); <span class="comment">// æ‹¿åˆ°è§¦å‘äº‹ä»¶çš„channel</span></span><br><span class="line">                    <span class="comment">// è·å– selectionKey ä¸Šå…³è”çš„é™„ä»¶</span></span><br><span class="line">                    <span class="type">ByteBuffer</span> <span class="variable">buffer</span> <span class="operator">=</span> (ByteBuffer) key.attachment();</span><br><span class="line">                    <span class="type">int</span> <span class="variable">read</span> <span class="operator">=</span> channel.read(buffer); <span class="comment">// å¦‚æœæ˜¯æ­£å¸¸æ–­å¼€ï¼Œread çš„æ–¹æ³•çš„è¿”å›å€¼æ˜¯ -1</span></span><br><span class="line">                    <span class="keyword">if</span>(read == -<span class="number">1</span>) &#123;</span><br><span class="line">                        key.cancel();</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        split(buffer);</span><br><span class="line">                        <span class="comment">// éœ€è¦æ‰©å®¹</span></span><br><span class="line">                        <span class="keyword">if</span> (buffer.position() == buffer.limit()) &#123;</span><br><span class="line">                            <span class="type">ByteBuffer</span> <span class="variable">newBuffer</span> <span class="operator">=</span> ByteBuffer.allocate(buffer.capacity() * <span class="number">2</span>);</span><br><span class="line">                            buffer.flip();</span><br><span class="line">                            newBuffer.put(buffer); <span class="comment">// 0123456789abcdef3333\n</span></span><br><span class="line">                            key.attach(newBuffer);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                    key.cancel();  <span class="comment">// å› ä¸ºå®¢æˆ·ç«¯æ–­å¼€äº†,å› æ­¤éœ€è¦å°† key å–æ¶ˆï¼ˆä» selector çš„ keys é›†åˆä¸­çœŸæ­£åˆ é™¤ keyï¼‰</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">SocketChannel</span> <span class="variable">sc</span> <span class="operator">=</span> SocketChannel.open();</span><br><span class="line">sc.connect(<span class="keyword">new</span> <span class="title class_">InetSocketAddress</span>(<span class="string">&quot;localhost&quot;</span>, <span class="number">8080</span>));</span><br><span class="line"><span class="type">SocketAddress</span> <span class="variable">address</span> <span class="operator">=</span> sc.getLocalAddress();</span><br><span class="line"><span class="comment">// sc.write(Charset.defaultCharset().encode(&quot;hello\nworld\n&quot;));</span></span><br><span class="line">sc.write(Charset.defaultCharset().encode(<span class="string">&quot;0123\n456789abcdef&quot;</span>));</span><br><span class="line">sc.write(Charset.defaultCharset().encode(<span class="string">&quot;0123456789abcdef3333\n&quot;</span>));</span><br><span class="line">System.in.read();</span><br></pre></td></tr></table></figure><h4 id="ByteBuffer-å¤§å°åˆ†é…"><a href="#ByteBuffer-å¤§å°åˆ†é…" class="headerlink" title="ByteBuffer å¤§å°åˆ†é…"></a>ByteBuffer å¤§å°åˆ†é…</h4><ul><li>æ¯ä¸ª channel éƒ½éœ€è¦è®°å½•å¯èƒ½è¢«åˆ‡åˆ†çš„æ¶ˆæ¯ï¼Œå› ä¸º ByteBuffer ä¸èƒ½è¢«å¤šä¸ª channel å…±åŒä½¿ç”¨ï¼Œå› æ­¤éœ€è¦ä¸ºæ¯ä¸ª channel ç»´æŠ¤ä¸€ä¸ªç‹¬ç«‹çš„ ByteBuffer</li><li>ByteBuffer ä¸èƒ½å¤ªå¤§ï¼Œæ¯”å¦‚ä¸€ä¸ª ByteBuffer 1Mb çš„è¯ï¼Œè¦æ”¯æŒç™¾ä¸‡è¿æ¥å°±è¦ 1Tb å†…å­˜ï¼Œå› æ­¤éœ€è¦è®¾è®¡å¤§å°å¯å˜çš„ ByteBuffer<ul><li>ä¸€ç§æ€è·¯æ˜¯é¦–å…ˆåˆ†é…ä¸€ä¸ªè¾ƒå°çš„ bufferï¼Œä¾‹å¦‚ 4kï¼Œå¦‚æœå‘ç°æ•°æ®ä¸å¤Ÿï¼Œå†åˆ†é… 8k çš„ bufferï¼Œå°† 4k buffer å†…å®¹æ‹·è´è‡³ 8k bufferï¼Œä¼˜ç‚¹æ˜¯æ¶ˆæ¯è¿ç»­å®¹æ˜“å¤„ç†ï¼Œç¼ºç‚¹æ˜¯æ•°æ®æ‹·è´è€—è´¹æ€§èƒ½ï¼Œå‚è€ƒå®ç° <a href="http://tutorials.jenkov.com/java-performance/resizable-array.html">http://tutorials.jenkov.com/java-performance/resizable-array.html</a></li><li>å¦ä¸€ç§æ€è·¯æ˜¯ç”¨å¤šä¸ªæ•°ç»„ç»„æˆ bufferï¼Œä¸€ä¸ªæ•°ç»„ä¸å¤Ÿï¼ŒæŠŠå¤šå‡ºæ¥çš„å†…å®¹å†™å…¥æ–°çš„æ•°ç»„ï¼Œä¸å‰é¢çš„åŒºåˆ«æ˜¯æ¶ˆæ¯å­˜å‚¨ä¸è¿ç»­è§£æå¤æ‚ï¼Œä¼˜ç‚¹æ˜¯é¿å…äº†æ‹·è´å¼•èµ·çš„æ€§èƒ½æŸè€—</li></ul></li></ul><h3 id="4-5-å¤„ç†-write-äº‹ä»¶"><a href="#4-5-å¤„ç†-write-äº‹ä»¶" class="headerlink" title="4.5 å¤„ç† write äº‹ä»¶"></a>4.5 å¤„ç† write äº‹ä»¶</h3><h4 id="ä¸€æ¬¡æ— æ³•å†™å®Œä¾‹å­"><a href="#ä¸€æ¬¡æ— æ³•å†™å®Œä¾‹å­" class="headerlink" title="ä¸€æ¬¡æ— æ³•å†™å®Œä¾‹å­"></a>ä¸€æ¬¡æ— æ³•å†™å®Œä¾‹å­</h4><ul><li>éé˜»å¡æ¨¡å¼ä¸‹ï¼Œæ— æ³•ä¿è¯æŠŠ buffer ä¸­æ‰€æœ‰æ•°æ®éƒ½å†™å…¥ channelï¼Œå› æ­¤éœ€è¦è¿½è¸ª write æ–¹æ³•çš„è¿”å›å€¼ï¼ˆä»£è¡¨å®é™…å†™å…¥å­—èŠ‚æ•°ï¼‰</li><li>ç”¨ selector ç›‘å¬æ‰€æœ‰ channel çš„å¯å†™äº‹ä»¶ï¼Œæ¯ä¸ª channel éƒ½éœ€è¦ä¸€ä¸ª key æ¥è·Ÿè¸ª bufferï¼Œä½†è¿™æ ·åˆä¼šå¯¼è‡´å ç”¨å†…å­˜è¿‡å¤šï¼Œå°±æœ‰ä¸¤é˜¶æ®µç­–ç•¥<ul><li>å½“æ¶ˆæ¯å¤„ç†å™¨ç¬¬ä¸€æ¬¡å†™å…¥æ¶ˆæ¯æ—¶ï¼Œæ‰å°† channel æ³¨å†Œåˆ° selector ä¸Š</li><li>selector æ£€æŸ¥ channel ä¸Šçš„å¯å†™äº‹ä»¶ï¼Œå¦‚æœæ‰€æœ‰çš„æ•°æ®å†™å®Œäº†ï¼Œå°±å–æ¶ˆ channel çš„æ³¨å†Œ</li><li>å¦‚æœä¸å–æ¶ˆï¼Œä¼šæ¯æ¬¡å¯å†™å‡ä¼šè§¦å‘ write äº‹ä»¶</li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WriteServer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ServerSocketChannel</span> <span class="variable">ssc</span> <span class="operator">=</span> ServerSocketChannel.open();</span><br><span class="line">        ssc.configureBlocking(<span class="literal">false</span>);</span><br><span class="line">        ssc.bind(<span class="keyword">new</span> <span class="title class_">InetSocketAddress</span>(<span class="number">8080</span>));</span><br><span class="line"></span><br><span class="line">        <span class="type">Selector</span> <span class="variable">selector</span> <span class="operator">=</span> Selector.open();</span><br><span class="line">        ssc.register(selector, SelectionKey.OP_ACCEPT);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(<span class="literal">true</span>) &#123;</span><br><span class="line">            selector.select();</span><br><span class="line"></span><br><span class="line">            Iterator&lt;SelectionKey&gt; iter = selector.selectedKeys().iterator();</span><br><span class="line">            <span class="keyword">while</span> (iter.hasNext()) &#123;</span><br><span class="line">                <span class="type">SelectionKey</span> <span class="variable">key</span> <span class="operator">=</span> iter.next();</span><br><span class="line">                iter.remove();</span><br><span class="line">                <span class="keyword">if</span> (key.isAcceptable()) &#123;</span><br><span class="line">                    <span class="type">SocketChannel</span> <span class="variable">sc</span> <span class="operator">=</span> ssc.accept();</span><br><span class="line">                    sc.configureBlocking(<span class="literal">false</span>);</span><br><span class="line">                    <span class="type">SelectionKey</span> <span class="variable">sckey</span> <span class="operator">=</span> sc.register(selector, SelectionKey.OP_READ);</span><br><span class="line">                    <span class="comment">// 1. å‘å®¢æˆ·ç«¯å‘é€å†…å®¹</span></span><br><span class="line">                    <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">3000000</span>; i++) &#123;</span><br><span class="line">                        sb.append(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="type">ByteBuffer</span> <span class="variable">buffer</span> <span class="operator">=</span> Charset.defaultCharset().encode(sb.toString());</span><br><span class="line">                    <span class="type">int</span> <span class="variable">write</span> <span class="operator">=</span> sc.write(buffer);</span><br><span class="line">                    <span class="comment">// 3. write è¡¨ç¤ºå®é™…å†™äº†å¤šå°‘å­—èŠ‚</span></span><br><span class="line">                    System.out.println(<span class="string">&quot;å®é™…å†™å…¥å­—èŠ‚:&quot;</span> + write);</span><br><span class="line">                    <span class="comment">// 4. å¦‚æœæœ‰å‰©ä½™æœªè¯»å­—èŠ‚ï¼Œæ‰éœ€è¦å…³æ³¨å†™äº‹ä»¶</span></span><br><span class="line">                    <span class="keyword">if</span> (buffer.hasRemaining()) &#123;</span><br><span class="line">                        <span class="comment">// read 1  write 4</span></span><br><span class="line">                        <span class="comment">// åœ¨åŸæœ‰å…³æ³¨äº‹ä»¶çš„åŸºç¡€ä¸Šï¼Œå¤šå…³æ³¨ å†™äº‹ä»¶</span></span><br><span class="line">                        sckey.interestOps(sckey.interestOps() + SelectionKey.OP_WRITE);</span><br><span class="line">                        <span class="comment">// æŠŠ buffer ä½œä¸ºé™„ä»¶åŠ å…¥ sckey</span></span><br><span class="line">                        sckey.attach(buffer);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (key.isWritable()) &#123;</span><br><span class="line">                    <span class="type">ByteBuffer</span> <span class="variable">buffer</span> <span class="operator">=</span> (ByteBuffer) key.attachment();</span><br><span class="line">                    <span class="type">SocketChannel</span> <span class="variable">sc</span> <span class="operator">=</span> (SocketChannel) key.channel();</span><br><span class="line">                    <span class="type">int</span> <span class="variable">write</span> <span class="operator">=</span> sc.write(buffer);</span><br><span class="line">                    System.out.println(<span class="string">&quot;å®é™…å†™å…¥å­—èŠ‚:&quot;</span> + write);</span><br><span class="line">                    <span class="keyword">if</span> (!buffer.hasRemaining()) &#123; <span class="comment">// å†™å®Œäº†</span></span><br><span class="line">                        key.interestOps(key.interestOps() - SelectionKey.OP_WRITE);</span><br><span class="line">                        key.attach(<span class="literal">null</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WriteClient</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">Selector</span> <span class="variable">selector</span> <span class="operator">=</span> Selector.open();</span><br><span class="line">        <span class="type">SocketChannel</span> <span class="variable">sc</span> <span class="operator">=</span> SocketChannel.open();</span><br><span class="line">        sc.configureBlocking(<span class="literal">false</span>);</span><br><span class="line">        sc.register(selector, SelectionKey.OP_CONNECT | SelectionKey.OP_READ);</span><br><span class="line">        sc.connect(<span class="keyword">new</span> <span class="title class_">InetSocketAddress</span>(<span class="string">&quot;localhost&quot;</span>, <span class="number">8080</span>));</span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            selector.select();</span><br><span class="line">            Iterator&lt;SelectionKey&gt; iter = selector.selectedKeys().iterator();</span><br><span class="line">            <span class="keyword">while</span> (iter.hasNext()) &#123;</span><br><span class="line">                <span class="type">SelectionKey</span> <span class="variable">key</span> <span class="operator">=</span> iter.next();</span><br><span class="line">                iter.remove();</span><br><span class="line">                <span class="keyword">if</span> (key.isConnectable()) &#123;</span><br><span class="line">                    System.out.println(sc.finishConnect());</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (key.isReadable()) &#123;</span><br><span class="line">                    <span class="type">ByteBuffer</span> <span class="variable">buffer</span> <span class="operator">=</span> ByteBuffer.allocate(<span class="number">1024</span> * <span class="number">1024</span>);</span><br><span class="line">                    count += sc.read(buffer);</span><br><span class="line">                    buffer.clear();</span><br><span class="line">                    System.out.println(count);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’¡-write-ä¸ºä½•è¦å–æ¶ˆ"><a href="#ğŸ’¡-write-ä¸ºä½•è¦å–æ¶ˆ" class="headerlink" title="ğŸ’¡ write ä¸ºä½•è¦å–æ¶ˆ"></a>ğŸ’¡ write ä¸ºä½•è¦å–æ¶ˆ</h4><p>åªè¦å‘ channel å‘é€æ•°æ®æ—¶ï¼Œsocket ç¼“å†²å¯å†™ï¼Œè¿™ä¸ªäº‹ä»¶ä¼šé¢‘ç¹è§¦å‘ï¼Œå› æ­¤åº”å½“åªåœ¨ socket ç¼“å†²åŒºå†™ä¸ä¸‹æ—¶å†å…³æ³¨å¯å†™äº‹ä»¶ï¼Œæ•°æ®å†™å®Œä¹‹åå†å–æ¶ˆå…³æ³¨</p><h3 id="æ›´è¿›ä¸€æ­¥"><a href="#æ›´è¿›ä¸€æ­¥" class="headerlink" title="æ›´è¿›ä¸€æ­¥"></a>æ›´è¿›ä¸€æ­¥</h3><h4 id="ğŸ’¡-åˆ©ç”¨å¤šçº¿ç¨‹ä¼˜åŒ–"><a href="#ğŸ’¡-åˆ©ç”¨å¤šçº¿ç¨‹ä¼˜åŒ–" class="headerlink" title="ğŸ’¡ åˆ©ç”¨å¤šçº¿ç¨‹ä¼˜åŒ–"></a>ğŸ’¡ åˆ©ç”¨å¤šçº¿ç¨‹ä¼˜åŒ–</h4><blockquote><p>ç°åœ¨éƒ½æ˜¯å¤šæ ¸ cpuï¼Œè®¾è®¡æ—¶è¦å……åˆ†è€ƒè™‘åˆ«è®© cpu çš„åŠ›é‡è¢«ç™½ç™½æµªè´¹</p></blockquote><p><img src="/../images/Netty01-nio/image-20221124104234662.png" alt="image-20221124104234662"></p><blockquote><p>Bossè´Ÿè´£è¿æ¥</p><p>workerè´Ÿè´£è¿›è¡Œå¤šå†™</p></blockquote><p>å‰é¢çš„ä»£ç åªæœ‰ä¸€ä¸ªé€‰æ‹©å™¨ï¼Œæ²¡æœ‰å……åˆ†åˆ©ç”¨å¤šæ ¸ cpuï¼Œå¦‚ä½•æ”¹è¿›å‘¢ï¼Ÿ</p><p>åˆ†ä¸¤ç»„é€‰æ‹©å™¨</p><ul><li>å•çº¿ç¨‹é…ä¸€ä¸ªé€‰æ‹©å™¨ï¼Œä¸“é—¨å¤„ç† accept äº‹ä»¶</li><li>åˆ›å»º cpu æ ¸å¿ƒæ•°çš„çº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹é…ä¸€ä¸ªé€‰æ‹©å™¨ï¼Œè½®æµå¤„ç† read äº‹ä»¶</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChannelDemo7</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">BossEventLoop</span>().register();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Slf4j</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">BossEventLoop</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> Selector boss;</span><br><span class="line">        <span class="keyword">private</span> WorkerEventLoop[] workers;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="type">boolean</span> <span class="variable">start</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">AtomicInteger</span> <span class="variable">index</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">register</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">            <span class="keyword">if</span> (!start) &#123;</span><br><span class="line">                <span class="type">ServerSocketChannel</span> <span class="variable">ssc</span> <span class="operator">=</span> ServerSocketChannel.open();</span><br><span class="line">                ssc.bind(<span class="keyword">new</span> <span class="title class_">InetSocketAddress</span>(<span class="number">8080</span>));</span><br><span class="line">                ssc.configureBlocking(<span class="literal">false</span>);</span><br><span class="line">                boss = Selector.open();</span><br><span class="line">                <span class="type">SelectionKey</span> <span class="variable">ssckey</span> <span class="operator">=</span> ssc.register(boss, <span class="number">0</span>, <span class="literal">null</span>);</span><br><span class="line">                ssckey.interestOps(SelectionKey.OP_ACCEPT);</span><br><span class="line">                workers = initEventLoops();</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="built_in">this</span>, <span class="string">&quot;boss&quot;</span>).start();</span><br><span class="line">                log.debug(<span class="string">&quot;boss start...&quot;</span>);</span><br><span class="line">                start = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> WorkerEventLoop[] initEventLoops() &#123;</span><br><span class="line"><span class="comment">//        EventLoop[] eventLoops = new EventLoop[Runtime.getRuntime().availableProcessors()];</span></span><br><span class="line">            WorkerEventLoop[] workerEventLoops = <span class="keyword">new</span> <span class="title class_">WorkerEventLoop</span>[<span class="number">2</span>];</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; workerEventLoops.length; i++) &#123;</span><br><span class="line">                workerEventLoops[i] = <span class="keyword">new</span> <span class="title class_">WorkerEventLoop</span>(i);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> workerEventLoops;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    boss.select();</span><br><span class="line">                    Iterator&lt;SelectionKey&gt; iter = boss.selectedKeys().iterator();</span><br><span class="line">                    <span class="keyword">while</span> (iter.hasNext()) &#123;</span><br><span class="line">                        <span class="type">SelectionKey</span> <span class="variable">key</span> <span class="operator">=</span> iter.next();</span><br><span class="line">                        iter.remove();</span><br><span class="line">                        <span class="keyword">if</span> (key.isAcceptable()) &#123;</span><br><span class="line">                            <span class="type">ServerSocketChannel</span> <span class="variable">c</span> <span class="operator">=</span> (ServerSocketChannel) key.channel();</span><br><span class="line">                            <span class="type">SocketChannel</span> <span class="variable">sc</span> <span class="operator">=</span> c.accept();</span><br><span class="line">                            sc.configureBlocking(<span class="literal">false</span>);</span><br><span class="line">                            log.debug(<span class="string">&quot;&#123;&#125; connected&quot;</span>, sc.getRemoteAddress());</span><br><span class="line">                            workers[index.getAndIncrement() % workers.length].register(sc);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Slf4j</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">WorkerEventLoop</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> Selector worker;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="type">boolean</span> <span class="variable">start</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> index;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> ConcurrentLinkedQueue&lt;Runnable&gt; tasks = <span class="keyword">new</span> <span class="title class_">ConcurrentLinkedQueue</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">WorkerEventLoop</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.index = index;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">register</span><span class="params">(SocketChannel sc)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">            <span class="keyword">if</span> (!start) &#123;</span><br><span class="line">                worker = Selector.open();</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="built_in">this</span>, <span class="string">&quot;worker-&quot;</span> + index).start();</span><br><span class="line">                start = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            tasks.add(() -&gt; &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="type">SelectionKey</span> <span class="variable">sckey</span> <span class="operator">=</span> sc.register(worker, <span class="number">0</span>, <span class="literal">null</span>);</span><br><span class="line">                    sckey.interestOps(SelectionKey.OP_READ);</span><br><span class="line">                    worker.selectNow();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            worker.wakeup();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    worker.select();</span><br><span class="line">                    <span class="type">Runnable</span> <span class="variable">task</span> <span class="operator">=</span> tasks.poll();</span><br><span class="line">                    <span class="keyword">if</span> (task != <span class="literal">null</span>) &#123;</span><br><span class="line">                        task.run();</span><br><span class="line">                    &#125;</span><br><span class="line">                    Set&lt;SelectionKey&gt; keys = worker.selectedKeys();</span><br><span class="line">                    Iterator&lt;SelectionKey&gt; iter = keys.iterator();</span><br><span class="line">                    <span class="keyword">while</span> (iter.hasNext()) &#123;</span><br><span class="line">                        <span class="type">SelectionKey</span> <span class="variable">key</span> <span class="operator">=</span> iter.next();</span><br><span class="line">                        <span class="keyword">if</span> (key.isReadable()) &#123;</span><br><span class="line">                            <span class="type">SocketChannel</span> <span class="variable">sc</span> <span class="operator">=</span> (SocketChannel) key.channel();</span><br><span class="line">                            <span class="type">ByteBuffer</span> <span class="variable">buffer</span> <span class="operator">=</span> ByteBuffer.allocate(<span class="number">128</span>);</span><br><span class="line">                            <span class="keyword">try</span> &#123;</span><br><span class="line">                                <span class="type">int</span> <span class="variable">read</span> <span class="operator">=</span> sc.read(buffer);</span><br><span class="line">                                <span class="keyword">if</span> (read == -<span class="number">1</span>) &#123;</span><br><span class="line">                                    key.cancel();</span><br><span class="line">                                    sc.close();</span><br><span class="line">                                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                    buffer.flip();</span><br><span class="line">                                    log.debug(<span class="string">&quot;&#123;&#125; message:&quot;</span>, sc.getRemoteAddress());</span><br><span class="line">                                    debugAll(buffer);</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                                e.printStackTrace();</span><br><span class="line">                                key.cancel();</span><br><span class="line">                                sc.close();</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                        iter.remove();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ğŸ’¡-å¦‚ä½•æ‹¿åˆ°-cpu-ä¸ªæ•°"><a href="#ğŸ’¡-å¦‚ä½•æ‹¿åˆ°-cpu-ä¸ªæ•°" class="headerlink" title="ğŸ’¡ å¦‚ä½•æ‹¿åˆ° cpu ä¸ªæ•°"></a>ğŸ’¡ å¦‚ä½•æ‹¿åˆ° cpu ä¸ªæ•°</h4><blockquote><ul><li>Runtime.getRuntime().availableProcessors() å¦‚æœå·¥ä½œåœ¨ docker å®¹å™¨ä¸‹ï¼Œå› ä¸ºå®¹å™¨ä¸æ˜¯ç‰©ç†éš”ç¦»çš„ï¼Œä¼šæ‹¿åˆ°ç‰©ç† cpu ä¸ªæ•°ï¼Œè€Œä¸æ˜¯å®¹å™¨ç”³è¯·æ—¶çš„ä¸ªæ•°</li><li>è¿™ä¸ªé—®é¢˜ç›´åˆ° jdk 10 æ‰ä¿®å¤ï¼Œä½¿ç”¨ jvm å‚æ•° UseContainerSupport é…ç½®ï¼Œ é»˜è®¤å¼€å¯</li></ul></blockquote><h3 id="4-7-UDP"><a href="#4-7-UDP" class="headerlink" title="4.7 UDP"></a>4.7 UDP</h3><ul><li>UDP æ˜¯æ— è¿æ¥çš„ï¼Œclient å‘é€æ•°æ®ä¸ä¼šç®¡ server æ˜¯å¦å¼€å¯</li><li>server è¿™è¾¹çš„ receive æ–¹æ³•ä¼šå°†æ¥æ”¶åˆ°çš„æ•°æ®å­˜å…¥ byte bufferï¼Œä½†å¦‚æœæ•°æ®æŠ¥æ–‡è¶…è¿‡ buffer å¤§å°ï¼Œå¤šå‡ºæ¥çš„æ•°æ®ä¼šè¢«é»˜é»˜æŠ›å¼ƒ</li></ul><p>é¦–å…ˆå¯åŠ¨æœåŠ¡å™¨ç«¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UdpServer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">DatagramChannel</span> <span class="variable">channel</span> <span class="operator">=</span> DatagramChannel.open()) &#123;</span><br><span class="line">            channel.socket().bind(<span class="keyword">new</span> <span class="title class_">InetSocketAddress</span>(<span class="number">9999</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;waiting...&quot;</span>);</span><br><span class="line">            <span class="type">ByteBuffer</span> <span class="variable">buffer</span> <span class="operator">=</span> ByteBuffer.allocate(<span class="number">32</span>);</span><br><span class="line">            channel.receive(buffer);</span><br><span class="line">            buffer.flip();</span><br><span class="line">            debug(buffer);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">waiting...</span><br></pre></td></tr></table></figure><p>è¿è¡Œå®¢æˆ·ç«¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UdpClient</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">DatagramChannel</span> <span class="variable">channel</span> <span class="operator">=</span> DatagramChannel.open()) &#123;</span><br><span class="line">            <span class="type">ByteBuffer</span> <span class="variable">buffer</span> <span class="operator">=</span> StandardCharsets.UTF_8.encode(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">            <span class="type">InetSocketAddress</span> <span class="variable">address</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InetSocketAddress</span>(<span class="string">&quot;localhost&quot;</span>, <span class="number">9999</span>);</span><br><span class="line">            channel.send(buffer, address);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æœåŠ¡å™¨ç«¯è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 68 65 6c 6c 6f                                  |hello           |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br></pre></td></tr></table></figure><h2 id="5-NIO-vs-BIO"><a href="#5-NIO-vs-BIO" class="headerlink" title="5. NIO vs BIO"></a>5. NIO vs BIO</h2><h3 id="5-1-stream-vs-channel"><a href="#5-1-stream-vs-channel" class="headerlink" title="5.1 stream vs channel"></a>5.1 stream vs channel</h3><ul><li>stream ä¸ä¼šè‡ªåŠ¨ç¼“å†²æ•°æ®ï¼Œchannel ä¼šåˆ©ç”¨ç³»ç»Ÿæä¾›çš„å‘é€ç¼“å†²åŒºã€æ¥æ”¶ç¼“å†²åŒºï¼ˆæ›´ä¸ºåº•å±‚ï¼‰</li><li>stream ä»…æ”¯æŒé˜»å¡ APIï¼Œchannel åŒæ—¶æ”¯æŒé˜»å¡ã€éé˜»å¡ APIï¼Œç½‘ç»œ channel å¯é…åˆ selector å®ç°å¤šè·¯å¤ç”¨</li><li>äºŒè€…å‡ä¸ºå…¨åŒå·¥ï¼Œå³è¯»å†™å¯ä»¥åŒæ—¶è¿›è¡Œ</li></ul><h3 id="5-2-IO-æ¨¡å‹"><a href="#5-2-IO-æ¨¡å‹" class="headerlink" title="5.2 IO æ¨¡å‹"></a>5.2 IO æ¨¡å‹</h3><p>åŒæ­¥é˜»å¡ã€åŒæ­¥éé˜»å¡ã€åŒæ­¥å¤šè·¯å¤ç”¨ã€å¼‚æ­¥é˜»å¡ï¼ˆæ²¡æœ‰æ­¤æƒ…å†µï¼‰ã€å¼‚æ­¥éé˜»å¡</p><ul><li>åŒæ­¥ï¼šçº¿ç¨‹è‡ªå·±å»è·å–ç»“æœï¼ˆä¸€ä¸ªçº¿ç¨‹ï¼‰</li><li>å¼‚æ­¥ï¼šçº¿ç¨‹è‡ªå·±ä¸å»è·å–ç»“æœï¼Œè€Œæ˜¯ç”±å…¶å®ƒçº¿ç¨‹é€ç»“æœï¼ˆè‡³å°‘ä¸¤ä¸ªçº¿ç¨‹ï¼‰</li></ul><p>å½“è°ƒç”¨ä¸€æ¬¡ channel.read æˆ– stream.read åï¼Œä¼šåˆ‡æ¢è‡³æ“ä½œç³»ç»Ÿå†…æ ¸æ€æ¥å®ŒæˆçœŸæ­£æ•°æ®è¯»å–ï¼Œè€Œè¯»å–åˆåˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼Œåˆ†åˆ«ä¸ºï¼š</p><ul><li>ç­‰å¾…æ•°æ®é˜¶æ®µ</li><li>å¤åˆ¶æ•°æ®é˜¶æ®µ</li></ul><p><img src="/../images/Netty01-nio/0033.png"></p><ul><li><p>é˜»å¡ IO</p><p><img src="/../images/Netty01-nio/0039.png"></p></li><li><p>éé˜»å¡  IO</p><p><img src="/../images/Netty01-nio/0035.png"></p></li><li><p>å¤šè·¯å¤ç”¨</p><p><img src="/../images/Netty01-nio/0038.png"></p></li><li><p>ä¿¡å·é©±åŠ¨</p></li><li><p>å¼‚æ­¥ IO</p><p><img src="/../images/Netty01-nio/0037.png"></p></li><li><p>é˜»å¡ IO vs å¤šè·¯å¤ç”¨</p><p><img src="/../images/Netty01-nio/0034.png"></p><p><img src="/../images/Netty01-nio/0036.png"></p></li></ul><h4 id="ğŸ”–-å‚è€ƒ"><a href="#ğŸ”–-å‚è€ƒ" class="headerlink" title="ğŸ”– å‚è€ƒ"></a>ğŸ”– å‚è€ƒ</h4><p>UNIX ç½‘ç»œç¼–ç¨‹ - å· I</p><h3 id="5-3-é›¶æ‹·è´"><a href="#5-3-é›¶æ‹·è´" class="headerlink" title="5.3 é›¶æ‹·è´"></a>5.3 é›¶æ‹·è´</h3><h4 id="ä¼ ç»Ÿ-IO-é—®é¢˜"><a href="#ä¼ ç»Ÿ-IO-é—®é¢˜" class="headerlink" title="ä¼ ç»Ÿ IO é—®é¢˜"></a>ä¼ ç»Ÿ IO é—®é¢˜</h4><p>ä¼ ç»Ÿçš„ IO å°†ä¸€ä¸ªæ–‡ä»¶é€šè¿‡ socket å†™å‡º</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">File</span> <span class="variable">f</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;helloword/data.txt&quot;</span>);</span><br><span class="line"><span class="type">RandomAccessFile</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RandomAccessFile</span>(file, <span class="string">&quot;r&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">byte</span>[] buf = <span class="keyword">new</span> <span class="title class_">byte</span>[(<span class="type">int</span>)f.length()];</span><br><span class="line">file.read(buf);</span><br><span class="line"></span><br><span class="line"><span class="type">Socket</span> <span class="variable">socket</span> <span class="operator">=</span> ...;</span><br><span class="line">socket.getOutputStream().write(buf);</span><br></pre></td></tr></table></figure><p>å†…éƒ¨å·¥ä½œæµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p><p><img src="/../images/Netty01-nio/0024.png"></p><ol><li><p>java æœ¬èº«å¹¶ä¸å…·å¤‡ IO è¯»å†™èƒ½åŠ›ï¼Œå› æ­¤ read æ–¹æ³•è°ƒç”¨åï¼Œè¦ä» java ç¨‹åºçš„<strong>ç”¨æˆ·æ€</strong>åˆ‡æ¢è‡³<strong>å†…æ ¸æ€</strong>ï¼Œå»è°ƒç”¨æ“ä½œç³»ç»Ÿï¼ˆKernelï¼‰çš„è¯»èƒ½åŠ›ï¼Œå°†æ•°æ®è¯»å…¥<strong>å†…æ ¸ç¼“å†²åŒº</strong>ã€‚è¿™æœŸé—´ç”¨æˆ·çº¿ç¨‹é˜»å¡ï¼Œæ“ä½œç³»ç»Ÿä½¿ç”¨ DMAï¼ˆDirect Memory Accessï¼‰æ¥å®ç°æ–‡ä»¶è¯»ï¼Œå…¶é—´ä¹Ÿä¸ä¼šä½¿ç”¨ cpu</p><blockquote><p>DMA ä¹Ÿå¯ä»¥ç†è§£ä¸ºç¡¬ä»¶å•å…ƒï¼Œç”¨æ¥è§£æ”¾ cpu å®Œæˆæ–‡ä»¶ IO</p></blockquote></li><li><p>ä»<strong>å†…æ ¸æ€</strong>åˆ‡æ¢å›<strong>ç”¨æˆ·æ€</strong>ï¼Œå°†æ•°æ®ä»<strong>å†…æ ¸ç¼“å†²åŒº</strong>è¯»å…¥<strong>ç”¨æˆ·ç¼“å†²åŒº</strong>ï¼ˆå³ byte[] bufï¼‰ï¼Œè¿™æœŸé—´ cpu ä¼šå‚ä¸æ‹·è´ï¼Œæ— æ³•åˆ©ç”¨ DMA</p></li><li><p>è°ƒç”¨ write æ–¹æ³•ï¼Œè¿™æ—¶å°†æ•°æ®ä»<strong>ç”¨æˆ·ç¼“å†²åŒº</strong>ï¼ˆbyte[] bufï¼‰å†™å…¥ <strong>socket ç¼“å†²åŒº</strong>ï¼Œcpu ä¼šå‚ä¸æ‹·è´</p></li><li><p>æ¥ä¸‹æ¥è¦å‘ç½‘å¡å†™æ•°æ®ï¼Œè¿™é¡¹èƒ½åŠ› java åˆä¸å…·å¤‡ï¼Œå› æ­¤åˆå¾—ä»<strong>ç”¨æˆ·æ€</strong>åˆ‡æ¢è‡³<strong>å†…æ ¸æ€</strong>ï¼Œè°ƒç”¨æ“ä½œç³»ç»Ÿçš„å†™èƒ½åŠ›ï¼Œä½¿ç”¨ DMA å°† <strong>socket ç¼“å†²åŒº</strong>çš„æ•°æ®å†™å…¥ç½‘å¡ï¼Œä¸ä¼šä½¿ç”¨ cpu</p></li></ol><p>å¯ä»¥çœ‹åˆ°ä¸­é—´ç¯èŠ‚è¾ƒå¤šï¼Œjava çš„ IO å®é™…ä¸æ˜¯ç‰©ç†è®¾å¤‡çº§åˆ«çš„è¯»å†™ï¼Œè€Œæ˜¯ç¼“å­˜çš„å¤åˆ¶ï¼Œåº•å±‚çš„çœŸæ­£è¯»å†™æ˜¯æ“ä½œç³»ç»Ÿæ¥å®Œæˆçš„</p><ul><li>ç”¨æˆ·æ€ä¸å†…æ ¸æ€çš„åˆ‡æ¢å‘ç”Ÿäº† 3 æ¬¡ï¼Œè¿™ä¸ªæ“ä½œæ¯”è¾ƒé‡é‡çº§</li><li>æ•°æ®æ‹·è´äº†å…± 4 æ¬¡</li></ul><h4 id="NIO-ä¼˜åŒ–"><a href="#NIO-ä¼˜åŒ–" class="headerlink" title="NIO ä¼˜åŒ–"></a>NIO ä¼˜åŒ–</h4><p>é€šè¿‡ DirectByteBuf </p><ul><li>ByteBuffer.allocate(10)  HeapByteBuffer ä½¿ç”¨çš„è¿˜æ˜¯ java å†…å­˜</li><li>ByteBuffer.allocateDirect(10)  DirectByteBuffer ä½¿ç”¨çš„æ˜¯æ“ä½œç³»ç»Ÿå†…å­˜</li></ul><p><img src="/../images/Netty01-nio/0025.png"></p><p>å¤§éƒ¨åˆ†æ­¥éª¤ä¸ä¼˜åŒ–å‰ç›¸åŒï¼Œä¸å†èµ˜è¿°ã€‚å”¯æœ‰ä¸€ç‚¹ï¼šjava å¯ä»¥ä½¿ç”¨ DirectByteBuf å°†å †å¤–å†…å­˜æ˜ å°„åˆ° jvm å†…å­˜ä¸­æ¥ç›´æ¥è®¿é—®ä½¿ç”¨</p><ul><li>è¿™å—å†…å­˜ä¸å— jvm åƒåœ¾å›æ”¶çš„å½±å“ï¼Œå› æ­¤å†…å­˜åœ°å€å›ºå®šï¼Œæœ‰åŠ©äº IO è¯»å†™</li><li>java ä¸­çš„ DirectByteBuf å¯¹è±¡ä»…ç»´æŠ¤äº†æ­¤å†…å­˜çš„è™šå¼•ç”¨ï¼Œå†…å­˜å›æ”¶åˆ†æˆä¸¤æ­¥<ul><li>DirectByteBuf å¯¹è±¡è¢«åƒåœ¾å›æ”¶ï¼Œå°†è™šå¼•ç”¨åŠ å…¥å¼•ç”¨é˜Ÿåˆ—</li><li>é€šè¿‡ä¸“é—¨çº¿ç¨‹è®¿é—®å¼•ç”¨é˜Ÿåˆ—ï¼Œæ ¹æ®è™šå¼•ç”¨é‡Šæ”¾å †å¤–å†…å­˜</li></ul></li><li>å‡å°‘äº†ä¸€æ¬¡æ•°æ®æ‹·è´ï¼Œç”¨æˆ·æ€ä¸å†…æ ¸æ€çš„åˆ‡æ¢æ¬¡æ•°æ²¡æœ‰å‡å°‘</li></ul><p>è¿›ä¸€æ­¥ä¼˜åŒ–ï¼ˆåº•å±‚é‡‡ç”¨äº† linux 2.1 åæä¾›çš„ sendFile æ–¹æ³•ï¼‰ï¼Œjava ä¸­å¯¹åº”ç€ä¸¤ä¸ª channel è°ƒç”¨ transferTo&#x2F;transferFrom æ–¹æ³•æ‹·è´æ•°æ®</p><p><img src="/../images/Netty01-nio/0026.png"></p><ol><li>java è°ƒç”¨ transferTo æ–¹æ³•åï¼Œè¦ä» java ç¨‹åºçš„<strong>ç”¨æˆ·æ€</strong>åˆ‡æ¢è‡³<strong>å†…æ ¸æ€</strong>ï¼Œä½¿ç”¨ DMAå°†æ•°æ®è¯»å…¥<strong>å†…æ ¸ç¼“å†²åŒº</strong>ï¼Œä¸ä¼šä½¿ç”¨ cpu</li><li>æ•°æ®ä»<strong>å†…æ ¸ç¼“å†²åŒº</strong>ä¼ è¾“åˆ° <strong>socket ç¼“å†²åŒº</strong>ï¼Œcpu ä¼šå‚ä¸æ‹·è´</li><li>æœ€åä½¿ç”¨ DMA å°† <strong>socket ç¼“å†²åŒº</strong>çš„æ•°æ®å†™å…¥ç½‘å¡ï¼Œä¸ä¼šä½¿ç”¨ cpu</li></ol><p>å¯ä»¥çœ‹åˆ°</p><ul><li>åªå‘ç”Ÿäº†ä¸€æ¬¡ç”¨æˆ·æ€ä¸å†…æ ¸æ€çš„åˆ‡æ¢</li><li>æ•°æ®æ‹·è´äº† 3 æ¬¡</li></ul><p>è¿›ä¸€æ­¥ä¼˜åŒ–ï¼ˆlinux 2.4ï¼‰</p><p><img src="/../images/Netty01-nio/0027.png"></p><ol><li>java è°ƒç”¨ transferTo æ–¹æ³•åï¼Œè¦ä» java ç¨‹åºçš„<strong>ç”¨æˆ·æ€</strong>åˆ‡æ¢è‡³<strong>å†…æ ¸æ€</strong>ï¼Œä½¿ç”¨ DMAå°†æ•°æ®è¯»å…¥<strong>å†…æ ¸ç¼“å†²åŒº</strong>ï¼Œä¸ä¼šä½¿ç”¨ cpu</li><li>åªä¼šå°†ä¸€äº› offset å’Œ length ä¿¡æ¯æ‹·å…¥ <strong>socket ç¼“å†²åŒº</strong>ï¼Œå‡ ä¹æ— æ¶ˆè€—</li><li>ä½¿ç”¨ DMA å°† <strong>å†…æ ¸ç¼“å†²åŒº</strong>çš„æ•°æ®å†™å…¥ç½‘å¡ï¼Œä¸ä¼šä½¿ç”¨ cpu</li></ol><p>æ•´ä¸ªè¿‡ç¨‹ä»…åªå‘ç”Ÿäº†ä¸€æ¬¡ç”¨æˆ·æ€ä¸å†…æ ¸æ€çš„åˆ‡æ¢ï¼Œæ•°æ®æ‹·è´äº† 2 æ¬¡ã€‚æ‰€è°“çš„ã€é›¶æ‹·è´ã€‘ï¼Œå¹¶ä¸æ˜¯çœŸæ­£æ— æ‹·è´ï¼Œè€Œæ˜¯åœ¨ä¸ä¼šæ‹·è´é‡å¤æ•°æ®åˆ° jvm å†…å­˜ä¸­ï¼Œé›¶æ‹·è´çš„ä¼˜ç‚¹æœ‰</p><ul><li>æ›´å°‘çš„ç”¨æˆ·æ€ä¸å†…æ ¸æ€çš„åˆ‡æ¢</li><li>ä¸åˆ©ç”¨ cpu è®¡ç®—ï¼Œå‡å°‘ cpu ç¼“å­˜ä¼ªå…±äº«</li><li>é›¶æ‹·è´é€‚åˆå°æ–‡ä»¶ä¼ è¾“</li></ul><h3 id="5-3-AIO"><a href="#5-3-AIO" class="headerlink" title="5.3 AIO"></a>5.3 AIO</h3><p>AIO ç”¨æ¥è§£å†³æ•°æ®å¤åˆ¶é˜¶æ®µçš„é˜»å¡é—®é¢˜</p><ul><li>åŒæ­¥æ„å‘³ç€ï¼Œåœ¨è¿›è¡Œè¯»å†™æ“ä½œæ—¶ï¼Œçº¿ç¨‹éœ€è¦ç­‰å¾…ç»“æœï¼Œè¿˜æ˜¯ç›¸å½“äºé—²ç½®</li><li>å¼‚æ­¥æ„å‘³ç€ï¼Œåœ¨è¿›è¡Œè¯»å†™æ“ä½œæ—¶ï¼Œçº¿ç¨‹ä¸å¿…ç­‰å¾…ç»“æœï¼Œè€Œæ˜¯å°†æ¥ç”±æ“ä½œç³»ç»Ÿæ¥é€šè¿‡å›è°ƒæ–¹å¼ç”±å¦å¤–çš„çº¿ç¨‹æ¥è·å¾—ç»“æœ</li></ul><blockquote><p>å¼‚æ­¥æ¨¡å‹éœ€è¦åº•å±‚æ“ä½œç³»ç»Ÿï¼ˆKernelï¼‰æä¾›æ”¯æŒ</p><ul><li>Windows ç³»ç»Ÿé€šè¿‡ IOCP å®ç°äº†çœŸæ­£çš„å¼‚æ­¥ IO</li><li>Linux ç³»ç»Ÿå¼‚æ­¥ IO åœ¨ 2.6 ç‰ˆæœ¬å¼•å…¥ï¼Œä½†å…¶åº•å±‚å®ç°è¿˜æ˜¯ç”¨å¤šè·¯å¤ç”¨æ¨¡æ‹Ÿäº†å¼‚æ­¥ IOï¼Œæ€§èƒ½æ²¡æœ‰ä¼˜åŠ¿</li></ul></blockquote><h4 id="æ–‡ä»¶-AIO"><a href="#æ–‡ä»¶-AIO" class="headerlink" title="æ–‡ä»¶ AIO"></a>æ–‡ä»¶ AIO</h4><p>å…ˆæ¥çœ‹çœ‹ AsynchronousFileChannel</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AioDemo1</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="type">AsynchronousFileChannel</span> <span class="variable">s</span> <span class="operator">=</span> </span><br><span class="line">                AsynchronousFileChannel.open(</span><br><span class="line">                Paths.get(<span class="string">&quot;1.txt&quot;</span>), StandardOpenOption.READ);</span><br><span class="line">            <span class="type">ByteBuffer</span> <span class="variable">buffer</span> <span class="operator">=</span> ByteBuffer.allocate(<span class="number">2</span>);</span><br><span class="line">            log.debug(<span class="string">&quot;begin...&quot;</span>);</span><br><span class="line">            s.read(buffer, <span class="number">0</span>, <span class="literal">null</span>, <span class="keyword">new</span> <span class="title class_">CompletionHandler</span>&lt;Integer, ByteBuffer&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">completed</span><span class="params">(Integer result, ByteBuffer attachment)</span> &#123;</span><br><span class="line">                    log.debug(<span class="string">&quot;read completed...&#123;&#125;&quot;</span>, result);</span><br><span class="line">                    buffer.flip();</span><br><span class="line">                    debug(buffer);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">failed</span><span class="params">(Throwable exc, ByteBuffer attachment)</span> &#123;</span><br><span class="line">                    log.debug(<span class="string">&quot;read failed...&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        log.debug(<span class="string">&quot;do other things...&quot;</span>);</span><br><span class="line">        System.in.read();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">13:44:56 [DEBUG] [main] c.i.aio.AioDemo1 - begin...</span><br><span class="line">13:44:56 [DEBUG] [main] c.i.aio.AioDemo1 - do other things...</span><br><span class="line">13:44:56 [DEBUG] [Thread-5] c.i.aio.AioDemo1 - read completed...2</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 61 0d                                           |a.              |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°</p><ul><li>å“åº”æ–‡ä»¶è¯»å–æˆåŠŸçš„æ˜¯å¦ä¸€ä¸ªçº¿ç¨‹ Thread-5</li><li>ä¸»çº¿ç¨‹å¹¶æ²¡æœ‰ IO æ“ä½œé˜»å¡</li></ul><h4 id="ğŸ’¡-å®ˆæŠ¤çº¿ç¨‹"><a href="#ğŸ’¡-å®ˆæŠ¤çº¿ç¨‹" class="headerlink" title="ğŸ’¡ å®ˆæŠ¤çº¿ç¨‹"></a>ğŸ’¡ å®ˆæŠ¤çº¿ç¨‹</h4><p>é»˜è®¤æ–‡ä»¶ AIO ä½¿ç”¨çš„çº¿ç¨‹éƒ½æ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼Œæ‰€ä»¥æœ€åè¦æ‰§è¡Œ <code>System.in.read()</code> ä»¥é¿å…å®ˆæŠ¤çº¿ç¨‹æ„å¤–ç»“æŸ</p><h4 id="ç½‘ç»œ-AIO"><a href="#ç½‘ç»œ-AIO" class="headerlink" title="ç½‘ç»œ AIO"></a>ç½‘ç»œ AIO</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AioServer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">AsynchronousServerSocketChannel</span> <span class="variable">ssc</span> <span class="operator">=</span> AsynchronousServerSocketChannel.open();</span><br><span class="line">        ssc.bind(<span class="keyword">new</span> <span class="title class_">InetSocketAddress</span>(<span class="number">8080</span>));</span><br><span class="line">        ssc.accept(<span class="literal">null</span>, <span class="keyword">new</span> <span class="title class_">AcceptHandler</span>(ssc));</span><br><span class="line">        System.in.read();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">closeChannel</span><span class="params">(AsynchronousSocketChannel sc)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.printf(<span class="string">&quot;[%s] %s close\n&quot;</span>, Thread.currentThread().getName(), sc.getRemoteAddress());</span><br><span class="line">            sc.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ReadHandler</span> <span class="keyword">implements</span> <span class="title class_">CompletionHandler</span>&lt;Integer, ByteBuffer&gt; &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> AsynchronousSocketChannel sc;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">ReadHandler</span><span class="params">(AsynchronousSocketChannel sc)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.sc = sc;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">completed</span><span class="params">(Integer result, ByteBuffer attachment)</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (result == -<span class="number">1</span>) &#123;</span><br><span class="line">                    closeChannel(sc);</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.printf(<span class="string">&quot;[%s] %s read\n&quot;</span>, Thread.currentThread().getName(), sc.getRemoteAddress());</span><br><span class="line">                attachment.flip();</span><br><span class="line">                System.out.println(Charset.defaultCharset().decode(attachment));</span><br><span class="line">                attachment.clear();</span><br><span class="line">                <span class="comment">// å¤„ç†å®Œç¬¬ä¸€ä¸ª read æ—¶ï¼Œéœ€è¦å†æ¬¡è°ƒç”¨ read æ–¹æ³•æ¥å¤„ç†ä¸‹ä¸€ä¸ª read äº‹ä»¶</span></span><br><span class="line">                sc.read(attachment, attachment, <span class="built_in">this</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">failed</span><span class="params">(Throwable exc, ByteBuffer attachment)</span> &#123;</span><br><span class="line">            closeChannel(sc);</span><br><span class="line">            exc.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">WriteHandler</span> <span class="keyword">implements</span> <span class="title class_">CompletionHandler</span>&lt;Integer, ByteBuffer&gt; &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> AsynchronousSocketChannel sc;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="title function_">WriteHandler</span><span class="params">(AsynchronousSocketChannel sc)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.sc = sc;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">completed</span><span class="params">(Integer result, ByteBuffer attachment)</span> &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœä½œä¸ºé™„ä»¶çš„ buffer è¿˜æœ‰å†…å®¹ï¼Œéœ€è¦å†æ¬¡ write å†™å‡ºå‰©ä½™å†…å®¹</span></span><br><span class="line">            <span class="keyword">if</span> (attachment.hasRemaining()) &#123;</span><br><span class="line">                sc.write(attachment);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">failed</span><span class="params">(Throwable exc, ByteBuffer attachment)</span> &#123;</span><br><span class="line">            exc.printStackTrace();</span><br><span class="line">            closeChannel(sc);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">AcceptHandler</span> <span class="keyword">implements</span> <span class="title class_">CompletionHandler</span>&lt;AsynchronousSocketChannel, Object&gt; &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> AsynchronousServerSocketChannel ssc;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">AcceptHandler</span><span class="params">(AsynchronousServerSocketChannel ssc)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.ssc = ssc;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">completed</span><span class="params">(AsynchronousSocketChannel sc, Object attachment)</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                System.out.printf(<span class="string">&quot;[%s] %s connected\n&quot;</span>, Thread.currentThread().getName(), sc.getRemoteAddress());</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">ByteBuffer</span> <span class="variable">buffer</span> <span class="operator">=</span> ByteBuffer.allocate(<span class="number">16</span>);</span><br><span class="line">            <span class="comment">// è¯»äº‹ä»¶ç”± ReadHandler å¤„ç†</span></span><br><span class="line">            sc.read(buffer, buffer, <span class="keyword">new</span> <span class="title class_">ReadHandler</span>(sc));</span><br><span class="line">            <span class="comment">// å†™äº‹ä»¶ç”± WriteHandler å¤„ç†</span></span><br><span class="line">            sc.write(Charset.defaultCharset().encode(<span class="string">&quot;server hello!&quot;</span>), ByteBuffer.allocate(<span class="number">16</span>), <span class="keyword">new</span> <span class="title class_">WriteHandler</span>(sc));</span><br><span class="line">            <span class="comment">// å¤„ç†å®Œç¬¬ä¸€ä¸ª accpet æ—¶ï¼Œéœ€è¦å†æ¬¡è°ƒç”¨ accept æ–¹æ³•æ¥å¤„ç†ä¸‹ä¸€ä¸ª accept äº‹ä»¶</span></span><br><span class="line">            ssc.accept(<span class="literal">null</span>, <span class="built_in">this</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">failed</span><span class="params">(Throwable exc, Object attachment)</span> &#123;</span><br><span class="line">            exc.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> JAVA </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¸­é—´ä»¶ </tag>
            
            <tag> Netty </tag>
            
            <tag> ç½‘ç»œç¼–ç¨‹ </tag>
            
            <tag> æ¡†æ¶ </tag>
            
            <tag> NIO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Netty è¿›é˜¶</title>
      <link href="/2022/11/22/Netty03-%E8%BF%9B%E9%98%B6/"/>
      <url>/2022/11/22/Netty03-%E8%BF%9B%E9%98%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸‰-Netty-è¿›é˜¶"><a href="#ä¸‰-Netty-è¿›é˜¶" class="headerlink" title="ä¸‰. Netty è¿›é˜¶"></a>ä¸‰. Netty è¿›é˜¶</h1><h2 id="1-ç²˜åŒ…ä¸åŠåŒ…"><a href="#1-ç²˜åŒ…ä¸åŠåŒ…" class="headerlink" title="1. ç²˜åŒ…ä¸åŠåŒ…"></a>1. ç²˜åŒ…ä¸åŠåŒ…</h2><h3 id="1-1-ç²˜åŒ…ç°è±¡"><a href="#1-1-ç²˜åŒ…ç°è±¡" class="headerlink" title="1.1 ç²˜åŒ…ç°è±¡"></a>1.1 ç²˜åŒ…ç°è±¡</h3><p>æœåŠ¡ç«¯ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloWorldServer</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> LoggerFactory.getLogger(HelloWorldServer.class);</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">start</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">NioEventLoopGroup</span> <span class="variable">boss</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="type">NioEventLoopGroup</span> <span class="variable">worker</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">ServerBootstrap</span> <span class="variable">serverBootstrap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerBootstrap</span>();</span><br><span class="line">            serverBootstrap.channel(NioServerSocketChannel.class);</span><br><span class="line">            serverBootstrap.group(boss, worker);</span><br><span class="line">            serverBootstrap.childHandler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(SocketChannel ch)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                    ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">LoggingHandler</span>(LogLevel.DEBUG));</span><br><span class="line">                    ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">ChannelInboundHandlerAdapter</span>() &#123;</span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">channelActive</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                            log.debug(<span class="string">&quot;connected &#123;&#125;&quot;</span>, ctx.channel());</span><br><span class="line">                            <span class="built_in">super</span>.channelActive(ctx);</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">channelInactive</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                            log.debug(<span class="string">&quot;disconnect &#123;&#125;&quot;</span>, ctx.channel());</span><br><span class="line">                            <span class="built_in">super</span>.channelInactive(ctx);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="type">ChannelFuture</span> <span class="variable">channelFuture</span> <span class="operator">=</span> serverBootstrap.bind(<span class="number">8080</span>);</span><br><span class="line">            log.debug(<span class="string">&quot;&#123;&#125; binding...&quot;</span>, channelFuture.channel());</span><br><span class="line">            channelFuture.sync();</span><br><span class="line">            log.debug(<span class="string">&quot;&#123;&#125; bound...&quot;</span>, channelFuture.channel());</span><br><span class="line">            channelFuture.channel().closeFuture().sync();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;server error&quot;</span>, e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            boss.shutdownGracefully();</span><br><span class="line">            worker.shutdownGracefully();</span><br><span class="line">            log.debug(<span class="string">&quot;stoped&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">HelloWorldServer</span>().start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯ä»£ç å¸Œæœ›å‘é€ 10 ä¸ªæ¶ˆæ¯ï¼Œæ¯ä¸ªæ¶ˆæ¯æ˜¯ 16 å­—èŠ‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloWorldClient</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> LoggerFactory.getLogger(HelloWorldClient.class);</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">NioEventLoopGroup</span> <span class="variable">worker</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Bootstrap</span> <span class="variable">bootstrap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bootstrap</span>();</span><br><span class="line">            bootstrap.channel(NioSocketChannel.class);</span><br><span class="line">            bootstrap.group(worker);</span><br><span class="line">            bootstrap.handler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(SocketChannel ch)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                    log.debug(<span class="string">&quot;connetted...&quot;</span>);</span><br><span class="line">                    ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">ChannelInboundHandlerAdapter</span>() &#123;</span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">channelActive</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                            log.debug(<span class="string">&quot;sending...&quot;</span>);</span><br><span class="line">                            <span class="type">Random</span> <span class="variable">r</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">                            <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">                            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">                                <span class="type">ByteBuf</span> <span class="variable">buffer</span> <span class="operator">=</span> ctx.alloc().buffer();</span><br><span class="line">                                buffer.writeBytes(<span class="keyword">new</span> <span class="title class_">byte</span>[]&#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>&#125;);</span><br><span class="line">                                ctx.writeAndFlush(buffer);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="type">ChannelFuture</span> <span class="variable">channelFuture</span> <span class="operator">=</span> bootstrap.connect(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">8080</span>).sync();</span><br><span class="line">            channelFuture.channel().closeFuture().sync();</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;client error&quot;</span>, e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            worker.shutdownGracefully();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœåŠ¡å™¨ç«¯çš„æŸæ¬¡è¾“å‡ºï¼Œå¯ä»¥çœ‹åˆ°ä¸€æ¬¡å°±æ¥æ”¶äº† 160 ä¸ªå­—èŠ‚ï¼Œè€Œéåˆ† 10 æ¬¡æ¥æ”¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">08:24:46 [DEBUG] [main] c.i.n.HelloWorldServer - [id: 0x81e0fda5] binding...</span><br><span class="line">08:24:46 [DEBUG] [main] c.i.n.HelloWorldServer - [id: 0x81e0fda5, L:/0:0:0:0:0:0:0:0:8080] bound...</span><br><span class="line">08:24:55 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0x94132411, L:/127.0.0.1:8080 - R:/127.0.0.1:58177] REGISTERED</span><br><span class="line">08:24:55 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0x94132411, L:/127.0.0.1:8080 - R:/127.0.0.1:58177] ACTIVE</span><br><span class="line">08:24:55 [DEBUG] [nioEventLoopGroup-3-1] c.i.n.HelloWorldServer - connected [id: 0x94132411, L:/127.0.0.1:8080 - R:/127.0.0.1:58177]</span><br><span class="line">08:24:55 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0x94132411, L:/127.0.0.1:8080 - R:/127.0.0.1:58177] READ: 160B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f |................|</span><br><span class="line">|00000010| 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f |................|</span><br><span class="line">|00000020| 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f |................|</span><br><span class="line">|00000030| 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f |................|</span><br><span class="line">|00000040| 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f |................|</span><br><span class="line">|00000050| 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f |................|</span><br><span class="line">|00000060| 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f |................|</span><br><span class="line">|00000070| 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f |................|</span><br><span class="line">|00000080| 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f |................|</span><br><span class="line">|00000090| 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f |................|</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">08:24:55 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0x94132411, L:/127.0.0.1:8080 - R:/127.0.0.1:58177] READ COMPLETE</span><br></pre></td></tr></table></figure><h3 id="1-2-åŠåŒ…ç°è±¡"><a href="#1-2-åŠåŒ…ç°è±¡" class="headerlink" title="1.2 åŠåŒ…ç°è±¡"></a>1.2 åŠåŒ…ç°è±¡</h3><p>å®¢æˆ·ç«¯ä»£ç å¸Œæœ›å‘é€ 1 ä¸ªæ¶ˆæ¯ï¼Œè¿™ä¸ªæ¶ˆæ¯æ˜¯ 160 å­—èŠ‚ï¼Œä»£ç æ”¹ä¸º</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ByteBuf</span> <span class="variable">buffer</span> <span class="operator">=</span> ctx.alloc().buffer();</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    buffer.writeBytes(<span class="keyword">new</span> <span class="title class_">byte</span>[]&#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>&#125;);</span><br><span class="line">&#125;</span><br><span class="line">ctx.writeAndFlush(buffer);</span><br></pre></td></tr></table></figure><p>ä¸ºç°è±¡æ˜æ˜¾ï¼ŒæœåŠ¡ç«¯ä¿®æ”¹ä¸€ä¸‹æ¥æ”¶ç¼“å†²åŒºï¼Œå…¶å®ƒä»£ç ä¸å˜</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">serverBootstrap.option(ChannelOption.SO_RCVBUF, <span class="number">10</span>);</span><br></pre></td></tr></table></figure><p>æœåŠ¡å™¨ç«¯çš„æŸæ¬¡è¾“å‡ºï¼Œå¯ä»¥çœ‹åˆ°æ¥æ”¶çš„æ¶ˆæ¯è¢«åˆ†ä¸ºä¸¤èŠ‚ï¼Œç¬¬ä¸€æ¬¡ 20 å­—èŠ‚ï¼Œç¬¬äºŒæ¬¡ 140 å­—èŠ‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">08:43:49 [DEBUG] [main] c.i.n.HelloWorldServer - [id: 0x4d6c6a84] binding...</span><br><span class="line">08:43:49 [DEBUG] [main] c.i.n.HelloWorldServer - [id: 0x4d6c6a84, L:/0:0:0:0:0:0:0:0:8080] bound...</span><br><span class="line">08:44:23 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0x1719abf7, L:/127.0.0.1:8080 - R:/127.0.0.1:59221] REGISTERED</span><br><span class="line">08:44:23 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0x1719abf7, L:/127.0.0.1:8080 - R:/127.0.0.1:59221] ACTIVE</span><br><span class="line">08:44:23 [DEBUG] [nioEventLoopGroup-3-1] c.i.n.HelloWorldServer - connected [id: 0x1719abf7, L:/127.0.0.1:8080 - R:/127.0.0.1:59221]</span><br><span class="line">08:44:24 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0x1719abf7, L:/127.0.0.1:8080 - R:/127.0.0.1:59221] READ: 20B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f |................|</span><br><span class="line">|00000010| 00 01 02 03                                     |....            |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">08:44:24 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0x1719abf7, L:/127.0.0.1:8080 - R:/127.0.0.1:59221] READ COMPLETE</span><br><span class="line">08:44:24 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0x1719abf7, L:/127.0.0.1:8080 - R:/127.0.0.1:59221] READ: 140B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 00 01 02 03 |................|</span><br><span class="line">|00000010| 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 00 01 02 03 |................|</span><br><span class="line">|00000020| 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 00 01 02 03 |................|</span><br><span class="line">|00000030| 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 00 01 02 03 |................|</span><br><span class="line">|00000040| 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 00 01 02 03 |................|</span><br><span class="line">|00000050| 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 00 01 02 03 |................|</span><br><span class="line">|00000060| 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 00 01 02 03 |................|</span><br><span class="line">|00000070| 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 00 01 02 03 |................|</span><br><span class="line">|00000080| 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f             |............    |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">08:44:24 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0x1719abf7, L:/127.0.0.1:8080 - R:/127.0.0.1:59221] READ COMPLETE</span><br></pre></td></tr></table></figure><blockquote><p><strong>æ³¨æ„</strong></p><p>serverBootstrap.option(ChannelOption.SO_RCVBUF, 10) å½±å“çš„åº•å±‚æ¥æ”¶ç¼“å†²åŒºï¼ˆå³æ»‘åŠ¨çª—å£ï¼‰å¤§å°ï¼Œä»…å†³å®šäº† netty è¯»å–çš„æœ€å°å•ä½ï¼Œnetty å®é™…æ¯æ¬¡è¯»å–çš„ä¸€èˆ¬æ˜¯å®ƒçš„æ•´æ•°å€</p></blockquote><h3 id="1-3-ç°è±¡åˆ†æ"><a href="#1-3-ç°è±¡åˆ†æ" class="headerlink" title="1.3 ç°è±¡åˆ†æ"></a>1.3 ç°è±¡åˆ†æ</h3><p>ç²˜åŒ…</p><ul><li>ç°è±¡ï¼Œå‘é€ abc defï¼Œæ¥æ”¶ abcdef</li><li>åŸå› <ul><li>åº”ç”¨å±‚ï¼šæ¥æ”¶æ–¹ ByteBuf è®¾ç½®å¤ªå¤§ï¼ˆNetty é»˜è®¤ 1024ï¼‰</li><li>æ»‘åŠ¨çª—å£ï¼šå‡è®¾å‘é€æ–¹ 256 bytes è¡¨ç¤ºä¸€ä¸ªå®Œæ•´æŠ¥æ–‡ï¼Œä½†ç”±äºæ¥æ”¶æ–¹å¤„ç†ä¸åŠæ—¶ä¸”çª—å£å¤§å°è¶³å¤Ÿå¤§ï¼Œè¿™ 256 bytes å­—èŠ‚å°±ä¼šç¼“å†²åœ¨æ¥æ”¶æ–¹çš„æ»‘åŠ¨çª—å£ä¸­ï¼Œå½“æ»‘åŠ¨çª—å£ä¸­ç¼“å†²äº†å¤šä¸ªæŠ¥æ–‡å°±ä¼šç²˜åŒ…</li><li>Nagle ç®—æ³•ï¼šä¼šé€ æˆç²˜åŒ…</li></ul></li></ul><p>åŠåŒ…</p><ul><li>ç°è±¡ï¼Œå‘é€ abcdefï¼Œæ¥æ”¶ abc def</li><li>åŸå› <ul><li>åº”ç”¨å±‚ï¼šæ¥æ”¶æ–¹ ByteBuf å°äºå®é™…å‘é€æ•°æ®é‡</li><li>æ»‘åŠ¨çª—å£ï¼šå‡è®¾æ¥æ”¶æ–¹çš„çª—å£åªå‰©äº† 128 bytesï¼Œå‘é€æ–¹çš„æŠ¥æ–‡å¤§å°æ˜¯ 256 bytesï¼Œè¿™æ—¶æ”¾ä¸ä¸‹äº†ï¼Œåªèƒ½å…ˆå‘é€å‰ 128 bytesï¼Œç­‰å¾… ack åæ‰èƒ½å‘é€å‰©ä½™éƒ¨åˆ†ï¼Œè¿™å°±é€ æˆäº†åŠåŒ…</li><li>MSS é™åˆ¶ï¼šå½“å‘é€çš„æ•°æ®è¶…è¿‡ MSS é™åˆ¶åï¼Œä¼šå°†æ•°æ®åˆ‡åˆ†å‘é€ï¼Œå°±ä¼šé€ æˆåŠåŒ…</li></ul></li></ul><p>æœ¬è´¨æ˜¯å› ä¸º TCP æ˜¯æµå¼åè®®ï¼Œæ¶ˆæ¯æ— è¾¹ç•Œ</p><blockquote><p>æ»‘åŠ¨çª—å£</p><ul><li><p>TCP ä»¥ä¸€ä¸ªæ®µï¼ˆsegmentï¼‰ä¸ºå•ä½ï¼Œæ¯å‘é€ä¸€ä¸ªæ®µå°±éœ€è¦è¿›è¡Œä¸€æ¬¡ç¡®è®¤åº”ç­”ï¼ˆackï¼‰å¤„ç†ï¼Œä½†å¦‚æœè¿™ä¹ˆåšï¼Œç¼ºç‚¹æ˜¯åŒ…çš„å¾€è¿”æ—¶é—´è¶Šé•¿æ€§èƒ½å°±è¶Šå·®</p><p><img src="/img/0049.png"></p></li><li><p>ä¸ºäº†è§£å†³æ­¤é—®é¢˜ï¼Œå¼•å…¥äº†çª—å£æ¦‚å¿µï¼Œçª—å£å¤§å°å³å†³å®šäº†æ— éœ€ç­‰å¾…åº”ç­”è€Œå¯ä»¥ç»§ç»­å‘é€çš„æ•°æ®æœ€å¤§å€¼</p><p><img src="/img/0051.png"></p></li><li><p>çª—å£å®é™…å°±èµ·åˆ°ä¸€ä¸ªç¼“å†²åŒºçš„ä½œç”¨ï¼ŒåŒæ—¶ä¹Ÿèƒ½èµ·åˆ°æµé‡æ§åˆ¶çš„ä½œç”¨</p><ul><li>å›¾ä¸­æ·±è‰²çš„éƒ¨åˆ†å³è¦å‘é€çš„æ•°æ®ï¼Œé«˜äº®çš„éƒ¨åˆ†å³çª—å£</li><li>çª—å£å†…çš„æ•°æ®æ‰å…è®¸è¢«å‘é€ï¼Œå½“åº”ç­”æœªåˆ°è¾¾å‰ï¼Œçª—å£å¿…é¡»åœæ­¢æ»‘åŠ¨</li><li>å¦‚æœ 1001~2000 è¿™ä¸ªæ®µçš„æ•°æ® ack å›æ¥äº†ï¼Œçª—å£å°±å¯ä»¥å‘å‰æ»‘åŠ¨</li><li>æ¥æ”¶æ–¹ä¹Ÿä¼šç»´æŠ¤ä¸€ä¸ªçª—å£ï¼Œåªæœ‰è½åœ¨çª—å£å†…çš„æ•°æ®æ‰èƒ½å…è®¸æ¥æ”¶</li></ul></li></ul></blockquote><blockquote><p> MSS é™åˆ¶</p><ul><li><p>é“¾è·¯å±‚å¯¹ä¸€æ¬¡èƒ½å¤Ÿå‘é€çš„æœ€å¤§æ•°æ®æœ‰é™åˆ¶ï¼Œè¿™ä¸ªé™åˆ¶ç§°ä¹‹ä¸º MTUï¼ˆmaximum transmission unitï¼‰ï¼Œä¸åŒçš„é“¾è·¯è®¾å¤‡çš„ MTU å€¼ä¹Ÿæœ‰æ‰€ä¸åŒï¼Œä¾‹å¦‚</p></li><li><p>ä»¥å¤ªç½‘çš„ MTU æ˜¯ 1500</p></li><li><p>FDDIï¼ˆå…‰çº¤åˆ†å¸ƒå¼æ•°æ®æ¥å£ï¼‰çš„ MTU æ˜¯ 4352</p></li><li><p>æœ¬åœ°å›ç¯åœ°å€çš„ MTU æ˜¯ 65535 - æœ¬åœ°æµ‹è¯•ä¸èµ°ç½‘å¡</p></li><li><p>MSS æ˜¯æœ€å¤§æ®µé•¿åº¦ï¼ˆmaximum segment sizeï¼‰ï¼Œå®ƒæ˜¯ MTU åˆ¨å» tcp å¤´å’Œ ip å¤´åå‰©ä½™èƒ½å¤Ÿä½œä¸ºæ•°æ®ä¼ è¾“çš„å­—èŠ‚æ•°</p></li><li><p>ipv4 tcp å¤´å ç”¨ 20 bytesï¼Œip å¤´å ç”¨ 20 bytesï¼Œå› æ­¤ä»¥å¤ªç½‘ MSS çš„å€¼ä¸º 1500 - 40 &#x3D; 1460</p></li><li><p>TCP åœ¨ä¼ é€’å¤§é‡æ•°æ®æ—¶ï¼Œä¼šæŒ‰ç…§ MSS å¤§å°å°†æ•°æ®è¿›è¡Œåˆ†å‰²å‘é€</p></li><li><p>MSS çš„å€¼åœ¨ä¸‰æ¬¡æ¡æ‰‹æ—¶é€šçŸ¥å¯¹æ–¹è‡ªå·± MSS çš„å€¼ï¼Œç„¶ååœ¨ä¸¤è€…ä¹‹é—´é€‰æ‹©ä¸€ä¸ªå°å€¼ä½œä¸º MSS</p></li></ul>  <img src="img/0031.jpg" style="zoom:50%;" /></blockquote><blockquote><p>Nagle ç®—æ³•</p><ul><li>å³ä½¿å‘é€ä¸€ä¸ªå­—èŠ‚ï¼Œä¹Ÿéœ€è¦åŠ å…¥ tcp å¤´å’Œ ip å¤´ï¼Œä¹Ÿå°±æ˜¯æ€»å­—èŠ‚æ•°ä¼šä½¿ç”¨ 41 bytesï¼Œéå¸¸ä¸ç»æµã€‚å› æ­¤ä¸ºäº†æé«˜ç½‘ç»œåˆ©ç”¨ç‡ï¼Œtcp å¸Œæœ›å°½å¯èƒ½å‘é€è¶³å¤Ÿå¤§çš„æ•°æ®ï¼Œè¿™å°±æ˜¯ Nagle ç®—æ³•äº§ç”Ÿçš„ç¼˜ç”±</li><li>è¯¥ç®—æ³•æ˜¯æŒ‡å‘é€ç«¯å³ä½¿è¿˜æœ‰åº”è¯¥å‘é€çš„æ•°æ®ï¼Œä½†å¦‚æœè¿™éƒ¨åˆ†æ•°æ®å¾ˆå°‘çš„è¯ï¼Œåˆ™è¿›è¡Œå»¶è¿Ÿå‘é€<ul><li>å¦‚æœ SO_SNDBUF çš„æ•°æ®è¾¾åˆ° MSSï¼Œåˆ™éœ€è¦å‘é€</li><li>å¦‚æœ SO_SNDBUF ä¸­å«æœ‰ FINï¼ˆè¡¨ç¤ºéœ€è¦è¿æ¥å…³é—­ï¼‰è¿™æ—¶å°†å‰©ä½™æ•°æ®å‘é€ï¼Œå†å…³é—­</li><li>å¦‚æœ TCP_NODELAY &#x3D; trueï¼Œåˆ™éœ€è¦å‘é€</li><li>å·²å‘é€çš„æ•°æ®éƒ½æ”¶åˆ° ack æ—¶ï¼Œåˆ™éœ€è¦å‘é€</li><li>ä¸Šè¿°æ¡ä»¶ä¸æ»¡è¶³ï¼Œä½†å‘ç”Ÿè¶…æ—¶ï¼ˆä¸€èˆ¬ä¸º 200msï¼‰åˆ™éœ€è¦å‘é€</li><li>é™¤ä¸Šè¿°æƒ…å†µï¼Œå»¶è¿Ÿå‘é€</li></ul></li></ul></blockquote><h3 id="1-4-è§£å†³æ–¹æ¡ˆ"><a href="#1-4-è§£å†³æ–¹æ¡ˆ" class="headerlink" title="1.4 è§£å†³æ–¹æ¡ˆ"></a>1.4 è§£å†³æ–¹æ¡ˆ</h3><ol><li>çŸ­é“¾æ¥ï¼Œå‘ä¸€ä¸ªåŒ…å»ºç«‹ä¸€æ¬¡è¿æ¥ï¼Œè¿™æ ·è¿æ¥å»ºç«‹åˆ°è¿æ¥æ–­å¼€ä¹‹é—´å°±æ˜¯æ¶ˆæ¯çš„è¾¹ç•Œï¼Œç¼ºç‚¹æ•ˆç‡å¤ªä½</li><li>æ¯ä¸€æ¡æ¶ˆæ¯é‡‡ç”¨å›ºå®šé•¿åº¦ï¼Œç¼ºç‚¹æµªè´¹ç©ºé—´</li><li>æ¯ä¸€æ¡æ¶ˆæ¯é‡‡ç”¨åˆ†éš”ç¬¦ï¼Œä¾‹å¦‚ \nï¼Œç¼ºç‚¹éœ€è¦è½¬ä¹‰</li><li>æ¯ä¸€æ¡æ¶ˆæ¯åˆ†ä¸º head å’Œ bodyï¼Œhead ä¸­åŒ…å« body çš„é•¿åº¦</li></ol><h4 id="æ–¹æ³•1ï¼ŒçŸ­é“¾æ¥"><a href="#æ–¹æ³•1ï¼ŒçŸ­é“¾æ¥" class="headerlink" title="æ–¹æ³•1ï¼ŒçŸ­é“¾æ¥"></a>æ–¹æ³•1ï¼ŒçŸ­é“¾æ¥</h4><p>ä»¥è§£å†³ç²˜åŒ…ä¸ºä¾‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloWorldClient</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> LoggerFactory.getLogger(HelloWorldClient.class);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// åˆ† 10 æ¬¡å‘é€</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">            send();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">send</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">NioEventLoopGroup</span> <span class="variable">worker</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Bootstrap</span> <span class="variable">bootstrap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bootstrap</span>();</span><br><span class="line">            bootstrap.channel(NioSocketChannel.class);</span><br><span class="line">            bootstrap.group(worker);</span><br><span class="line">            bootstrap.handler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(SocketChannel ch)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                    log.debug(<span class="string">&quot;conneted...&quot;</span>);</span><br><span class="line">                    ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">LoggingHandler</span>(LogLevel.DEBUG));</span><br><span class="line">                    ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">ChannelInboundHandlerAdapter</span>() &#123;</span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">channelActive</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                            log.debug(<span class="string">&quot;sending...&quot;</span>);</span><br><span class="line">                            <span class="type">ByteBuf</span> <span class="variable">buffer</span> <span class="operator">=</span> ctx.alloc().buffer();</span><br><span class="line">                            buffer.writeBytes(<span class="keyword">new</span> <span class="title class_">byte</span>[]&#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>&#125;);</span><br><span class="line">                            ctx.writeAndFlush(buffer);</span><br><span class="line">                            <span class="comment">// å‘å®Œå³å…³</span></span><br><span class="line">                            ctx.close();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="type">ChannelFuture</span> <span class="variable">channelFuture</span> <span class="operator">=</span> bootstrap.connect(<span class="string">&quot;localhost&quot;</span>, <span class="number">8080</span>).sync();</span><br><span class="line">            channelFuture.channel().closeFuture().sync();</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;client error&quot;</span>, e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            worker.shutdownGracefully();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼Œç•¥</p><blockquote><p>åŠåŒ…ç”¨è¿™ç§åŠæ³•è¿˜æ˜¯ä¸å¥½è§£å†³ï¼Œå› ä¸ºæ¥æ”¶æ–¹çš„ç¼“å†²åŒºå¤§å°æ˜¯æœ‰é™çš„</p></blockquote><h4 id="æ–¹æ³•2ï¼Œå›ºå®šé•¿åº¦"><a href="#æ–¹æ³•2ï¼Œå›ºå®šé•¿åº¦" class="headerlink" title="æ–¹æ³•2ï¼Œå›ºå®šé•¿åº¦"></a>æ–¹æ³•2ï¼Œå›ºå®šé•¿åº¦</h4><p>è®©æ‰€æœ‰æ•°æ®åŒ…é•¿åº¦å›ºå®šï¼ˆå‡è®¾é•¿åº¦ä¸º 8 å­—èŠ‚ï¼‰ï¼ŒæœåŠ¡å™¨ç«¯åŠ å…¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">FixedLengthFrameDecoder</span>(<span class="number">8</span>));</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯æµ‹è¯•ä»£ç ï¼Œæ³¨æ„, é‡‡ç”¨è¿™ç§æ–¹æ³•åï¼Œå®¢æˆ·ç«¯ä»€ä¹ˆæ—¶å€™ flush éƒ½å¯ä»¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloWorldClient</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> LoggerFactory.getLogger(HelloWorldClient.class);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">NioEventLoopGroup</span> <span class="variable">worker</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Bootstrap</span> <span class="variable">bootstrap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bootstrap</span>();</span><br><span class="line">            bootstrap.channel(NioSocketChannel.class);</span><br><span class="line">            bootstrap.group(worker);</span><br><span class="line">            bootstrap.handler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(SocketChannel ch)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                    log.debug(<span class="string">&quot;connetted...&quot;</span>);</span><br><span class="line">                    ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">LoggingHandler</span>(LogLevel.DEBUG));</span><br><span class="line">                    ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">ChannelInboundHandlerAdapter</span>() &#123;</span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">channelActive</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                            log.debug(<span class="string">&quot;sending...&quot;</span>);</span><br><span class="line">                            <span class="comment">// å‘é€å†…å®¹éšæœºçš„æ•°æ®åŒ…</span></span><br><span class="line">                            <span class="type">Random</span> <span class="variable">r</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">                            <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">                            <span class="type">ByteBuf</span> <span class="variable">buffer</span> <span class="operator">=</span> ctx.alloc().buffer();</span><br><span class="line">                            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">                                <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">8</span>];</span><br><span class="line">                                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; r.nextInt(<span class="number">8</span>); j++) &#123;</span><br><span class="line">                                    bytes[j] = (<span class="type">byte</span>) c;</span><br><span class="line">                                &#125;</span><br><span class="line">                                c++;</span><br><span class="line">                                buffer.writeBytes(bytes);</span><br><span class="line">                            &#125;</span><br><span class="line">                            ctx.writeAndFlush(buffer);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="type">ChannelFuture</span> <span class="variable">channelFuture</span> <span class="operator">=</span> bootstrap.connect(<span class="string">&quot;192.168.0.103&quot;</span>, <span class="number">9090</span>).sync();</span><br><span class="line">            channelFuture.channel().closeFuture().sync();</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;client error&quot;</span>, e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            worker.shutdownGracefully();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">12:07:00 [DEBUG] [nioEventLoopGroup-2-1] c.i.n.HelloWorldClient - connetted...</span><br><span class="line">12:07:00 [DEBUG] [nioEventLoopGroup-2-1] i.n.h.l.LoggingHandler - [id: 0x3c2ef3c2] REGISTERED</span><br><span class="line">12:07:00 [DEBUG] [nioEventLoopGroup-2-1] i.n.h.l.LoggingHandler - [id: 0x3c2ef3c2] CONNECT: /192.168.0.103:9090</span><br><span class="line">12:07:00 [DEBUG] [nioEventLoopGroup-2-1] i.n.h.l.LoggingHandler - [id: 0x3c2ef3c2, L:/192.168.0.103:53155 - R:/192.168.0.103:9090] ACTIVE</span><br><span class="line">12:07:00 [DEBUG] [nioEventLoopGroup-2-1] c.i.n.HelloWorldClient - sending...</span><br><span class="line">12:07:00 [DEBUG] [nioEventLoopGroup-2-1] i.n.h.l.LoggingHandler - [id: 0x3c2ef3c2, L:/192.168.0.103:53155 - R:/192.168.0.103:9090] WRITE: 80B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 61 61 61 61 00 00 00 00 62 00 00 00 00 00 00 00 |aaaa....b.......|</span><br><span class="line">|00000010| 63 63 00 00 00 00 00 00 64 00 00 00 00 00 00 00 |cc......d.......|</span><br><span class="line">|00000020| 00 00 00 00 00 00 00 00 66 66 66 66 00 00 00 00 |........ffff....|</span><br><span class="line">|00000030| 67 67 67 00 00 00 00 00 68 00 00 00 00 00 00 00 |ggg.....h.......|</span><br><span class="line">|00000040| 69 69 69 69 69 00 00 00 6a 6a 6a 6a 00 00 00 00 |iiiii...jjjj....|</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">12:07:00 [DEBUG] [nioEventLoopGroup-2-1] i.n.h.l.LoggingHandler - [id: 0x3c2ef3c2, L:/192.168.0.103:53155 - R:/192.168.0.103:9090] FLUSH</span><br></pre></td></tr></table></figure><p>æœåŠ¡ç«¯è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">12:06:51 [DEBUG] [main] c.i.n.HelloWorldServer - [id: 0xe3d9713f] binding...</span><br><span class="line">12:06:51 [DEBUG] [main] c.i.n.HelloWorldServer - [id: 0xe3d9713f, L:/192.168.0.103:9090] bound...</span><br><span class="line">12:07:00 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0xd739f137, L:/192.168.0.103:9090 - R:/192.168.0.103:53155] REGISTERED</span><br><span class="line">12:07:00 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0xd739f137, L:/192.168.0.103:9090 - R:/192.168.0.103:53155] ACTIVE</span><br><span class="line">12:07:00 [DEBUG] [nioEventLoopGroup-3-1] c.i.n.HelloWorldServer - connected [id: 0xd739f137, L:/192.168.0.103:9090 - R:/192.168.0.103:53155]</span><br><span class="line">12:07:00 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0xd739f137, L:/192.168.0.103:9090 - R:/192.168.0.103:53155] READ: 8B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 61 61 61 61 00 00 00 00                         |aaaa....        |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">12:07:00 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0xd739f137, L:/192.168.0.103:9090 - R:/192.168.0.103:53155] READ: 8B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 62 00 00 00 00 00 00 00                         |b.......        |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">12:07:00 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0xd739f137, L:/192.168.0.103:9090 - R:/192.168.0.103:53155] READ: 8B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 63 63 00 00 00 00 00 00                         |cc......        |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">12:07:00 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0xd739f137, L:/192.168.0.103:9090 - R:/192.168.0.103:53155] READ: 8B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 64 00 00 00 00 00 00 00                         |d.......        |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">12:07:00 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0xd739f137, L:/192.168.0.103:9090 - R:/192.168.0.103:53155] READ: 8B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 00 00 00 00 00 00 00 00                         |........        |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">12:07:00 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0xd739f137, L:/192.168.0.103:9090 - R:/192.168.0.103:53155] READ: 8B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 66 66 66 66 00 00 00 00                         |ffff....        |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">12:07:00 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0xd739f137, L:/192.168.0.103:9090 - R:/192.168.0.103:53155] READ: 8B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 67 67 67 00 00 00 00 00                         |ggg.....        |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">12:07:00 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0xd739f137, L:/192.168.0.103:9090 - R:/192.168.0.103:53155] READ: 8B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 68 00 00 00 00 00 00 00                         |h.......        |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">12:07:00 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0xd739f137, L:/192.168.0.103:9090 - R:/192.168.0.103:53155] READ: 8B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 69 69 69 69 69 00 00 00                         |iiiii...        |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">12:07:00 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0xd739f137, L:/192.168.0.103:9090 - R:/192.168.0.103:53155] READ: 8B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 6a 6a 6a 6a 00 00 00 00                         |jjjj....        |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">12:07:00 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0xd739f137, L:/192.168.0.103:9090 - R:/192.168.0.103:53155] READ COMPLETE</span><br></pre></td></tr></table></figure><p>ç¼ºç‚¹æ˜¯ï¼Œæ•°æ®åŒ…çš„å¤§å°ä¸å¥½æŠŠæ¡</p><ul><li>é•¿åº¦å®šçš„å¤ªå¤§ï¼Œæµªè´¹</li><li>é•¿åº¦å®šçš„å¤ªå°ï¼Œå¯¹æŸäº›æ•°æ®åŒ…åˆæ˜¾å¾—ä¸å¤Ÿ</li></ul><h4 id="æ–¹æ³•3ï¼Œå›ºå®šåˆ†éš”ç¬¦"><a href="#æ–¹æ³•3ï¼Œå›ºå®šåˆ†éš”ç¬¦" class="headerlink" title="æ–¹æ³•3ï¼Œå›ºå®šåˆ†éš”ç¬¦"></a>æ–¹æ³•3ï¼Œå›ºå®šåˆ†éš”ç¬¦</h4><p>æœåŠ¡ç«¯åŠ å…¥ï¼Œé»˜è®¤ä»¥ \n æˆ– \r\n ä½œä¸ºåˆ†éš”ç¬¦ï¼Œå¦‚æœè¶…å‡ºæŒ‡å®šé•¿åº¦ä»æœªå‡ºç°åˆ†éš”ç¬¦ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">LineBasedFrameDecoder</span>(<span class="number">1024</span>));</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯åœ¨æ¯æ¡æ¶ˆæ¯ä¹‹åï¼ŒåŠ å…¥ \n åˆ†éš”ç¬¦</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloWorldClient</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> LoggerFactory.getLogger(HelloWorldClient.class);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">NioEventLoopGroup</span> <span class="variable">worker</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Bootstrap</span> <span class="variable">bootstrap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bootstrap</span>();</span><br><span class="line">            bootstrap.channel(NioSocketChannel.class);</span><br><span class="line">            bootstrap.group(worker);</span><br><span class="line">            bootstrap.handler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(SocketChannel ch)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                    log.debug(<span class="string">&quot;connetted...&quot;</span>);</span><br><span class="line">                    ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">LoggingHandler</span>(LogLevel.DEBUG));</span><br><span class="line">                    ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">ChannelInboundHandlerAdapter</span>() &#123;</span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">channelActive</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                            log.debug(<span class="string">&quot;sending...&quot;</span>);</span><br><span class="line">                            <span class="type">Random</span> <span class="variable">r</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">                            <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">                            <span class="type">ByteBuf</span> <span class="variable">buffer</span> <span class="operator">=</span> ctx.alloc().buffer();</span><br><span class="line">                            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">                                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt;= r.nextInt(<span class="number">16</span>)+<span class="number">1</span>; j++) &#123;</span><br><span class="line">                                    buffer.writeByte((<span class="type">byte</span>) c);</span><br><span class="line">                                &#125;</span><br><span class="line">                                buffer.writeByte(<span class="number">10</span>);</span><br><span class="line">                                c++;</span><br><span class="line">                            &#125;</span><br><span class="line">                            ctx.writeAndFlush(buffer);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="type">ChannelFuture</span> <span class="variable">channelFuture</span> <span class="operator">=</span> bootstrap.connect(<span class="string">&quot;192.168.0.103&quot;</span>, <span class="number">9090</span>).sync();</span><br><span class="line">            channelFuture.channel().closeFuture().sync();</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;client error&quot;</span>, e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            worker.shutdownGracefully();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">14:08:18 [DEBUG] [nioEventLoopGroup-2-1] c.i.n.HelloWorldClient - connetted...</span><br><span class="line">14:08:18 [DEBUG] [nioEventLoopGroup-2-1] i.n.h.l.LoggingHandler - [id: 0x1282d755] REGISTERED</span><br><span class="line">14:08:18 [DEBUG] [nioEventLoopGroup-2-1] i.n.h.l.LoggingHandler - [id: 0x1282d755] CONNECT: /192.168.0.103:9090</span><br><span class="line">14:08:18 [DEBUG] [nioEventLoopGroup-2-1] i.n.h.l.LoggingHandler - [id: 0x1282d755, L:/192.168.0.103:63641 - R:/192.168.0.103:9090] ACTIVE</span><br><span class="line">14:08:18 [DEBUG] [nioEventLoopGroup-2-1] c.i.n.HelloWorldClient - sending...</span><br><span class="line">14:08:18 [DEBUG] [nioEventLoopGroup-2-1] i.n.h.l.LoggingHandler - [id: 0x1282d755, L:/192.168.0.103:63641 - R:/192.168.0.103:9090] WRITE: 60B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 61 0a 62 62 62 0a 63 63 63 0a 64 64 0a 65 65 65 |a.bbb.ccc.dd.eee|</span><br><span class="line">|00000010| 65 65 65 65 65 65 65 0a 66 66 0a 67 67 67 67 67 |eeeeeee.ff.ggggg|</span><br><span class="line">|00000020| 67 67 0a 68 68 68 68 0a 69 69 69 69 69 69 69 0a |gg.hhhh.iiiiiii.|</span><br><span class="line">|00000030| 6a 6a 6a 6a 6a 6a 6a 6a 6a 6a 6a 0a             |jjjjjjjjjjj.    |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">14:08:18 [DEBUG] [nioEventLoopGroup-2-1] i.n.h.l.LoggingHandler - [id: 0x1282d755, L:/192.168.0.103:63641 - R:/192.168.0.103:9090] FLUSH</span><br></pre></td></tr></table></figure><p>æœåŠ¡ç«¯è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">14:08:18 [DEBUG] [nioEventLoopGroup-3-5] c.i.n.HelloWorldServer - connected [id: 0xa4b3be43, L:/192.168.0.103:9090 - R:/192.168.0.103:63641]</span><br><span class="line">14:08:18 [DEBUG] [nioEventLoopGroup-3-5] i.n.h.l.LoggingHandler - [id: 0xa4b3be43, L:/192.168.0.103:9090 - R:/192.168.0.103:63641] READ: 1B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 61                                              |a               |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">14:08:18 [DEBUG] [nioEventLoopGroup-3-5] i.n.h.l.LoggingHandler - [id: 0xa4b3be43, L:/192.168.0.103:9090 - R:/192.168.0.103:63641] READ: 3B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 62 62 62                                        |bbb             |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">14:08:18 [DEBUG] [nioEventLoopGroup-3-5] i.n.h.l.LoggingHandler - [id: 0xa4b3be43, L:/192.168.0.103:9090 - R:/192.168.0.103:63641] READ: 3B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 63 63 63                                        |ccc             |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">14:08:18 [DEBUG] [nioEventLoopGroup-3-5] i.n.h.l.LoggingHandler - [id: 0xa4b3be43, L:/192.168.0.103:9090 - R:/192.168.0.103:63641] READ: 2B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 64 64                                           |dd              |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">14:08:18 [DEBUG] [nioEventLoopGroup-3-5] i.n.h.l.LoggingHandler - [id: 0xa4b3be43, L:/192.168.0.103:9090 - R:/192.168.0.103:63641] READ: 10B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 65 65 65 65 65 65 65 65 65 65                   |eeeeeeeeee      |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">14:08:18 [DEBUG] [nioEventLoopGroup-3-5] i.n.h.l.LoggingHandler - [id: 0xa4b3be43, L:/192.168.0.103:9090 - R:/192.168.0.103:63641] READ: 2B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 66 66                                           |ff              |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">14:08:18 [DEBUG] [nioEventLoopGroup-3-5] i.n.h.l.LoggingHandler - [id: 0xa4b3be43, L:/192.168.0.103:9090 - R:/192.168.0.103:63641] READ: 7B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 67 67 67 67 67 67 67                            |ggggggg         |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">14:08:18 [DEBUG] [nioEventLoopGroup-3-5] i.n.h.l.LoggingHandler - [id: 0xa4b3be43, L:/192.168.0.103:9090 - R:/192.168.0.103:63641] READ: 4B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 68 68 68 68                                     |hhhh            |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">14:08:18 [DEBUG] [nioEventLoopGroup-3-5] i.n.h.l.LoggingHandler - [id: 0xa4b3be43, L:/192.168.0.103:9090 - R:/192.168.0.103:63641] READ: 7B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 69 69 69 69 69 69 69                            |iiiiiii         |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">14:08:18 [DEBUG] [nioEventLoopGroup-3-5] i.n.h.l.LoggingHandler - [id: 0xa4b3be43, L:/192.168.0.103:9090 - R:/192.168.0.103:63641] READ: 11B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 6a 6a 6a 6a 6a 6a 6a 6a 6a 6a 6a                |jjjjjjjjjjj     |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">14:08:18 [DEBUG] [nioEventLoopGroup-3-5] i.n.h.l.LoggingHandler - [id: 0xa4b3be43, L:/192.168.0.103:9090 - R:/192.168.0.103:63641] READ COMPLETE</span><br></pre></td></tr></table></figure><p>ç¼ºç‚¹ï¼Œå¤„ç†å­—ç¬¦æ•°æ®æ¯”è¾ƒåˆé€‚ï¼Œä½†å¦‚æœå†…å®¹æœ¬èº«åŒ…å«äº†åˆ†éš”ç¬¦ï¼ˆå­—èŠ‚æ•°æ®å¸¸å¸¸ä¼šæœ‰æ­¤æƒ…å†µï¼‰ï¼Œé‚£ä¹ˆå°±ä¼šè§£æé”™è¯¯</p><h4 id="æ–¹æ³•4ï¼Œé¢„è®¾é•¿åº¦"><a href="#æ–¹æ³•4ï¼Œé¢„è®¾é•¿åº¦" class="headerlink" title="æ–¹æ³•4ï¼Œé¢„è®¾é•¿åº¦"></a>æ–¹æ³•4ï¼Œé¢„è®¾é•¿åº¦</h4><p>åœ¨å‘é€æ¶ˆæ¯å‰ï¼Œå…ˆçº¦å®šç”¨å®šé•¿å­—èŠ‚è¡¨ç¤ºæ¥ä¸‹æ¥æ•°æ®çš„é•¿åº¦</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœ€å¤§é•¿åº¦ï¼Œé•¿åº¦åç§»ï¼Œé•¿åº¦å ç”¨å­—èŠ‚ï¼Œé•¿åº¦è°ƒæ•´ï¼Œå‰¥ç¦»å­—èŠ‚æ•°</span></span><br><span class="line">ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">LengthFieldBasedFrameDecoder</span>(<span class="number">1024</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>));</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloWorldClient</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> LoggerFactory.getLogger(HelloWorldClient.class);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">NioEventLoopGroup</span> <span class="variable">worker</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Bootstrap</span> <span class="variable">bootstrap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bootstrap</span>();</span><br><span class="line">            bootstrap.channel(NioSocketChannel.class);</span><br><span class="line">            bootstrap.group(worker);</span><br><span class="line">            bootstrap.handler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(SocketChannel ch)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                    log.debug(<span class="string">&quot;connetted...&quot;</span>);</span><br><span class="line">                    ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">LoggingHandler</span>(LogLevel.DEBUG));</span><br><span class="line">                    ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">ChannelInboundHandlerAdapter</span>() &#123;</span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">channelActive</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                            log.debug(<span class="string">&quot;sending...&quot;</span>);</span><br><span class="line">                            <span class="type">Random</span> <span class="variable">r</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">                            <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">                            <span class="type">ByteBuf</span> <span class="variable">buffer</span> <span class="operator">=</span> ctx.alloc().buffer();</span><br><span class="line">                            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">                                <span class="type">byte</span> <span class="variable">length</span> <span class="operator">=</span> (<span class="type">byte</span>) (r.nextInt(<span class="number">16</span>) + <span class="number">1</span>);</span><br><span class="line">                                <span class="comment">// å…ˆå†™å…¥é•¿åº¦</span></span><br><span class="line">                                buffer.writeByte(length);</span><br><span class="line">                                <span class="comment">// å†</span></span><br><span class="line">                                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt;= length; j++) &#123;</span><br><span class="line">                                    buffer.writeByte((<span class="type">byte</span>) c);</span><br><span class="line">                                &#125;</span><br><span class="line">                                c++;</span><br><span class="line">                            &#125;</span><br><span class="line">                            ctx.writeAndFlush(buffer);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="type">ChannelFuture</span> <span class="variable">channelFuture</span> <span class="operator">=</span> bootstrap.connect(<span class="string">&quot;192.168.0.103&quot;</span>, <span class="number">9090</span>).sync();</span><br><span class="line">            channelFuture.channel().closeFuture().sync();</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;client error&quot;</span>, e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            worker.shutdownGracefully();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">14:37:10 [DEBUG] [nioEventLoopGroup-2-1] c.i.n.HelloWorldClient - connetted...</span><br><span class="line">14:37:10 [DEBUG] [nioEventLoopGroup-2-1] i.n.h.l.LoggingHandler - [id: 0xf0f347b8] REGISTERED</span><br><span class="line">14:37:10 [DEBUG] [nioEventLoopGroup-2-1] i.n.h.l.LoggingHandler - [id: 0xf0f347b8] CONNECT: /192.168.0.103:9090</span><br><span class="line">14:37:10 [DEBUG] [nioEventLoopGroup-2-1] i.n.h.l.LoggingHandler - [id: 0xf0f347b8, L:/192.168.0.103:49979 - R:/192.168.0.103:9090] ACTIVE</span><br><span class="line">14:37:10 [DEBUG] [nioEventLoopGroup-2-1] c.i.n.HelloWorldClient - sending...</span><br><span class="line">14:37:10 [DEBUG] [nioEventLoopGroup-2-1] i.n.h.l.LoggingHandler - [id: 0xf0f347b8, L:/192.168.0.103:49979 - R:/192.168.0.103:9090] WRITE: 97B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 09 61 61 61 61 61 61 61 61 61 09 62 62 62 62 62 |.aaaaaaaaa.bbbbb|</span><br><span class="line">|00000010| 62 62 62 62 06 63 63 63 63 63 63 08 64 64 64 64 |bbbb.cccccc.dddd|</span><br><span class="line">|00000020| 64 64 64 64 0f 65 65 65 65 65 65 65 65 65 65 65 |dddd.eeeeeeeeeee|</span><br><span class="line">|00000030| 65 65 65 65 0d 66 66 66 66 66 66 66 66 66 66 66 |eeee.fffffffffff|</span><br><span class="line">|00000040| 66 66 02 67 67 02 68 68 0e 69 69 69 69 69 69 69 |ff.gg.hh.iiiiiii|</span><br><span class="line">|00000050| 69 69 69 69 69 69 69 09 6a 6a 6a 6a 6a 6a 6a 6a |iiiiiii.jjjjjjjj|</span><br><span class="line">|00000060| 6a                                              |j               |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">14:37:10 [DEBUG] [nioEventLoopGroup-2-1] i.n.h.l.LoggingHandler - [id: 0xf0f347b8, L:/192.168.0.103:49979 - R:/192.168.0.103:9090] FLUSH</span><br></pre></td></tr></table></figure><p>æœåŠ¡ç«¯è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">14:36:50 [DEBUG] [main] c.i.n.HelloWorldServer - [id: 0xdff439d3] binding...</span><br><span class="line">14:36:51 [DEBUG] [main] c.i.n.HelloWorldServer - [id: 0xdff439d3, L:/192.168.0.103:9090] bound...</span><br><span class="line">14:37:10 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0x744f2b47, L:/192.168.0.103:9090 - R:/192.168.0.103:49979] REGISTERED</span><br><span class="line">14:37:10 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0x744f2b47, L:/192.168.0.103:9090 - R:/192.168.0.103:49979] ACTIVE</span><br><span class="line">14:37:10 [DEBUG] [nioEventLoopGroup-3-1] c.i.n.HelloWorldServer - connected [id: 0x744f2b47, L:/192.168.0.103:9090 - R:/192.168.0.103:49979]</span><br><span class="line">14:37:10 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0x744f2b47, L:/192.168.0.103:9090 - R:/192.168.0.103:49979] READ: 9B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 61 61 61 61 61 61 61 61 61                      |aaaaaaaaa       |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">14:37:10 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0x744f2b47, L:/192.168.0.103:9090 - R:/192.168.0.103:49979] READ: 9B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 62 62 62 62 62 62 62 62 62                      |bbbbbbbbb       |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">14:37:10 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0x744f2b47, L:/192.168.0.103:9090 - R:/192.168.0.103:49979] READ: 6B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 63 63 63 63 63 63                               |cccccc          |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">14:37:10 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0x744f2b47, L:/192.168.0.103:9090 - R:/192.168.0.103:49979] READ: 8B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 64 64 64 64 64 64 64 64                         |dddddddd        |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">14:37:10 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0x744f2b47, L:/192.168.0.103:9090 - R:/192.168.0.103:49979] READ: 15B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 65 65 65 65 65 65 65 65 65 65 65 65 65 65 65    |eeeeeeeeeeeeeee |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">14:37:10 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0x744f2b47, L:/192.168.0.103:9090 - R:/192.168.0.103:49979] READ: 13B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 66 66 66 66 66 66 66 66 66 66 66 66 66          |fffffffffffff   |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">14:37:10 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0x744f2b47, L:/192.168.0.103:9090 - R:/192.168.0.103:49979] READ: 2B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 67 67                                           |gg              |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">14:37:10 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0x744f2b47, L:/192.168.0.103:9090 - R:/192.168.0.103:49979] READ: 2B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 68 68                                           |hh              |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">14:37:10 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0x744f2b47, L:/192.168.0.103:9090 - R:/192.168.0.103:49979] READ: 14B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 69 69 69 69 69 69 69 69 69 69 69 69 69 69       |iiiiiiiiiiiiii  |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">14:37:10 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0x744f2b47, L:/192.168.0.103:9090 - R:/192.168.0.103:49979] READ: 9B</span><br><span class="line">         +-------------------------------------------------+</span><br><span class="line">         |  0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">|00000000| 6a 6a 6a 6a 6a 6a 6a 6a 6a                      |jjjjjjjjj       |</span><br><span class="line">+--------+-------------------------------------------------+----------------+</span><br><span class="line">14:37:10 [DEBUG] [nioEventLoopGroup-3-1] i.n.h.l.LoggingHandler - [id: 0x744f2b47, L:/192.168.0.103:9090 - R:/192.168.0.103:49979] READ COMPLETE</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="2-åè®®è®¾è®¡ä¸è§£æ"><a href="#2-åè®®è®¾è®¡ä¸è§£æ" class="headerlink" title="2. åè®®è®¾è®¡ä¸è§£æ"></a>2. åè®®è®¾è®¡ä¸è§£æ</h2><h3 id="2-1-ä¸ºä»€ä¹ˆéœ€è¦åè®®ï¼Ÿ"><a href="#2-1-ä¸ºä»€ä¹ˆéœ€è¦åè®®ï¼Ÿ" class="headerlink" title="2.1 ä¸ºä»€ä¹ˆéœ€è¦åè®®ï¼Ÿ"></a>2.1 ä¸ºä»€ä¹ˆéœ€è¦åè®®ï¼Ÿ</h3><p>TCP&#x2F;IP ä¸­æ¶ˆæ¯ä¼ è¾“åŸºäºæµçš„æ–¹å¼ï¼Œæ²¡æœ‰è¾¹ç•Œã€‚</p><p>åè®®çš„ç›®çš„å°±æ˜¯åˆ’å®šæ¶ˆæ¯çš„è¾¹ç•Œï¼Œåˆ¶å®šé€šä¿¡åŒæ–¹è¦å…±åŒéµå®ˆçš„é€šä¿¡è§„åˆ™</p><p>ä¾‹å¦‚ï¼šåœ¨ç½‘ç»œä¸Šä¼ è¾“</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¸‹é›¨å¤©ç•™å®¢å¤©ç•™æˆ‘ä¸ç•™</span><br></pre></td></tr></table></figure><p>æ˜¯ä¸­æ–‡ä¸€å¥è‘—åçš„æ— æ ‡ç‚¹ç¬¦å·å¥å­ï¼Œåœ¨æ²¡æœ‰æ ‡ç‚¹ç¬¦å·æƒ…å†µä¸‹ï¼Œè¿™å¥è¯æœ‰æ•°ç§æ‹†è§£æ–¹å¼ï¼Œè€Œæ„æ€å´æ˜¯å®Œå…¨ä¸åŒï¼Œæ‰€ä»¥å¸¸è¢«ç”¨ä½œè®²è¿°æ ‡ç‚¹ç¬¦å·çš„é‡è¦æ€§</p><p>ä¸€ç§è§£è¯»</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¸‹é›¨å¤©ç•™å®¢ï¼Œå¤©ç•™ï¼Œæˆ‘ä¸ç•™</span><br></pre></td></tr></table></figure><p>å¦ä¸€ç§è§£è¯»</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¸‹é›¨å¤©ï¼Œç•™å®¢å¤©ï¼Œç•™æˆ‘ä¸ï¼Ÿç•™</span><br></pre></td></tr></table></figure><p>å¦‚ä½•è®¾è®¡åè®®å‘¢ï¼Ÿå…¶å®å°±æ˜¯ç»™ç½‘ç»œä¼ è¾“çš„ä¿¡æ¯åŠ ä¸Šâ€œæ ‡ç‚¹ç¬¦å·â€ã€‚ä½†é€šè¿‡åˆ†éš”ç¬¦æ¥æ–­å¥ä¸æ˜¯å¾ˆå¥½ï¼Œå› ä¸ºåˆ†éš”ç¬¦æœ¬èº«å¦‚æœç”¨äºä¼ è¾“ï¼Œé‚£ä¹ˆå¿…é¡»åŠ ä»¥åŒºåˆ†ã€‚å› æ­¤ï¼Œä¸‹é¢ä¸€ç§åè®®è¾ƒä¸ºå¸¸ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å®šé•¿å­—èŠ‚è¡¨ç¤ºå†…å®¹é•¿åº¦ + å®é™…å†…å®¹</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼Œå‡è®¾ä¸€ä¸ªä¸­æ–‡å­—ç¬¦é•¿åº¦ä¸º 3ï¼ŒæŒ‰ç…§ä¸Šè¿°åè®®çš„è§„åˆ™ï¼Œå‘é€ä¿¡æ¯æ–¹å¼å¦‚ä¸‹ï¼Œå°±ä¸ä¼šè¢«æ¥æ”¶æ–¹å¼„é”™æ„æ€äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0fä¸‹é›¨å¤©ç•™å®¢06å¤©ç•™09æˆ‘ä¸ç•™</span><br></pre></td></tr></table></figure><blockquote><p>å°æ•…äº‹</p><p>å¾ˆä¹…å¾ˆä¹…ä»¥å‰ï¼Œä¸€ä½ç§å¡¾å…ˆç”Ÿåˆ°ä¸€å®¶ä»»æ•™ã€‚åŒæ–¹ç­¾è®¢äº†ä¸€çº¸åè®®ï¼šâ€œæ— é¸¡é¸­äº¦å¯æ— é±¼è‚‰äº¦å¯ç™½èœè±†è…ä¸å¯å°‘ä¸å¾—æŸä¿®é‡‘â€ã€‚æ­¤åï¼Œç§å¡¾å…ˆç”Ÿè™½ç„¶è®¤çœŸæ•™è¯¾ï¼Œä½†ä¸»äººå®¶åˆ™æ€»æ˜¯ç»™ç§å¡¾å…ˆç”Ÿä»¥ç™½èœè±†è…ä¸ºèœï¼Œä¸æ¯«æœªè§é¸¡é¸­é±¼è‚‰çš„æ¬¾å¾…ã€‚ç§å¡¾å…ˆç”Ÿå…ˆæ˜¯å¾ˆä¸è§£ï¼Œå¯æ˜¯åæ¥ä¹Ÿå°±æƒ³é€šäº†ï¼šä¸»äººæŠŠé¸¡é¸­é±¼è‚‰çš„é’±éƒ½ä¼šæ¢ä¸ºæŸä¿®é‡‘çš„ï¼Œä¹Ÿç½¢ã€‚è‡³æ­¤åŒæ–¹ç›¸å®‰æ— äº‹ã€‚</p><p>å¹´å…³å°†è‡³ï¼Œä¸€ä¸ªå­¦å¹´æ®µäº¦å‘Šç»“æŸã€‚ç§å¡¾å…ˆç”Ÿä¸´è¡Œæ—¶ï¼Œä¹Ÿä¸è§ä¸»äººå®¶ä¸ºä»–äº¤ä»˜æŸä¿®é‡‘ï¼Œé‚ä¸ä¸»å®¶ç†è®ºã€‚ç„¶ä¸»å®¶äº¦æŒ¯æŒ¯æœ‰è¯ï¼šâ€œæœ‰åè®®ä¸ºè¯â€”â€”æ— é¸¡é¸­äº¦å¯ï¼Œæ— é±¼è‚‰äº¦å¯ï¼Œç™½èœè±†è…ä¸å¯å°‘ï¼Œä¸å¾—æŸä¿®é‡‘ã€‚è¿™ç™½çº¸é»‘å­—æ˜æ‘†ç€çš„ï¼Œä½ æœ‰ä»€ä¹ˆè¦è¯´çš„å‘¢ï¼Ÿâ€</p><p>ç§å¡¾å…ˆç”Ÿæ®ç†åŠ›äº‰ï¼šâ€œåè®®æ˜¯è¿™æ ·çš„â€”â€”æ— é¸¡ï¼Œé¸­äº¦å¯ï¼›æ— é±¼ï¼Œè‚‰äº¦å¯ï¼›ç™½èœè±†è…ä¸å¯ï¼Œå°‘ä¸å¾—æŸä¿®é‡‘ã€‚â€</p><p>åŒæ–¹å”‡æªèˆŒæˆ˜ï¼Œä½ æ¥æˆ‘å¾€ï¼ŒçœŸä¸ªæ˜¯ä¸äº¦ä¹ä¹ï¼</p><p>è¿™é‡Œçš„æŸä¿®é‡‘ï¼Œä¹Ÿä½œâ€œæŸè„©â€ï¼Œåº”å½“æ˜¯æ³›æŒ‡æ•™å¸ˆåº”å½“å¾—åˆ°çš„æŠ¥é…¬</p></blockquote><h3 id="2-2-redis-åè®®ä¸¾ä¾‹"><a href="#2-2-redis-åè®®ä¸¾ä¾‹" class="headerlink" title="2.2 redis åè®®ä¸¾ä¾‹"></a>2.2 redis åè®®ä¸¾ä¾‹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NioEventLoopGroup</span> <span class="variable">worker</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line"><span class="type">byte</span>[] LINE = &#123;<span class="number">13</span>, <span class="number">10</span>&#125;;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="type">Bootstrap</span> <span class="variable">bootstrap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bootstrap</span>();</span><br><span class="line">    bootstrap.channel(NioSocketChannel.class);</span><br><span class="line">    bootstrap.group(worker);</span><br><span class="line">    bootstrap.handler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(SocketChannel ch)</span> &#123;</span><br><span class="line">            ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">LoggingHandler</span>());</span><br><span class="line">            ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">ChannelInboundHandlerAdapter</span>() &#123;</span><br><span class="line">                <span class="comment">// ä¼šåœ¨è¿æ¥ channel å»ºç«‹æˆåŠŸåï¼Œä¼šè§¦å‘ active äº‹ä»¶</span></span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">channelActive</span><span class="params">(ChannelHandlerContext ctx)</span> &#123;</span><br><span class="line">                    set(ctx);</span><br><span class="line">                    get(ctx);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">get</span><span class="params">(ChannelHandlerContext ctx)</span> &#123;</span><br><span class="line">                    <span class="type">ByteBuf</span> <span class="variable">buf</span> <span class="operator">=</span> ctx.alloc().buffer();</span><br><span class="line">                    buf.writeBytes(<span class="string">&quot;*2&quot;</span>.getBytes());</span><br><span class="line">                    buf.writeBytes(LINE);</span><br><span class="line">                    buf.writeBytes(<span class="string">&quot;$3&quot;</span>.getBytes());</span><br><span class="line">                    buf.writeBytes(LINE);</span><br><span class="line">                    buf.writeBytes(<span class="string">&quot;get&quot;</span>.getBytes());</span><br><span class="line">                    buf.writeBytes(LINE);</span><br><span class="line">                    buf.writeBytes(<span class="string">&quot;$3&quot;</span>.getBytes());</span><br><span class="line">                    buf.writeBytes(LINE);</span><br><span class="line">                    buf.writeBytes(<span class="string">&quot;aaa&quot;</span>.getBytes());</span><br><span class="line">                    buf.writeBytes(LINE);</span><br><span class="line">                    ctx.writeAndFlush(buf);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(ChannelHandlerContext ctx)</span> &#123;</span><br><span class="line">                    <span class="type">ByteBuf</span> <span class="variable">buf</span> <span class="operator">=</span> ctx.alloc().buffer();</span><br><span class="line">                    buf.writeBytes(<span class="string">&quot;*3&quot;</span>.getBytes());</span><br><span class="line">                    buf.writeBytes(LINE);</span><br><span class="line">                    buf.writeBytes(<span class="string">&quot;$3&quot;</span>.getBytes());</span><br><span class="line">                    buf.writeBytes(LINE);</span><br><span class="line">                    buf.writeBytes(<span class="string">&quot;set&quot;</span>.getBytes());</span><br><span class="line">                    buf.writeBytes(LINE);</span><br><span class="line">                    buf.writeBytes(<span class="string">&quot;$3&quot;</span>.getBytes());</span><br><span class="line">                    buf.writeBytes(LINE);</span><br><span class="line">                    buf.writeBytes(<span class="string">&quot;aaa&quot;</span>.getBytes());</span><br><span class="line">                    buf.writeBytes(LINE);</span><br><span class="line">                    buf.writeBytes(<span class="string">&quot;$3&quot;</span>.getBytes());</span><br><span class="line">                    buf.writeBytes(LINE);</span><br><span class="line">                    buf.writeBytes(<span class="string">&quot;bbb&quot;</span>.getBytes());</span><br><span class="line">                    buf.writeBytes(LINE);</span><br><span class="line">                    ctx.writeAndFlush(buf);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">channelRead</span><span class="params">(ChannelHandlerContext ctx, Object msg)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                    <span class="type">ByteBuf</span> <span class="variable">buf</span> <span class="operator">=</span> (ByteBuf) msg;</span><br><span class="line">                    System.out.println(buf.toString(Charset.defaultCharset()));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="type">ChannelFuture</span> <span class="variable">channelFuture</span> <span class="operator">=</span> bootstrap.connect(<span class="string">&quot;localhost&quot;</span>, <span class="number">6379</span>).sync();</span><br><span class="line">    channelFuture.channel().closeFuture().sync();</span><br><span class="line">&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">    log.error(<span class="string">&quot;client error&quot;</span>, e);</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    worker.shutdownGracefully();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-3-http-åè®®ä¸¾ä¾‹"><a href="#2-3-http-åè®®ä¸¾ä¾‹" class="headerlink" title="2.3 http åè®®ä¸¾ä¾‹"></a>2.3 http åè®®ä¸¾ä¾‹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NioEventLoopGroup</span> <span class="variable">boss</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line"><span class="type">NioEventLoopGroup</span> <span class="variable">worker</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="type">ServerBootstrap</span> <span class="variable">serverBootstrap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerBootstrap</span>();</span><br><span class="line">    serverBootstrap.channel(NioServerSocketChannel.class);</span><br><span class="line">    serverBootstrap.group(boss, worker);</span><br><span class="line">    serverBootstrap.childHandler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(SocketChannel ch)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">            ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">LoggingHandler</span>(LogLevel.DEBUG));</span><br><span class="line">            ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">HttpServerCodec</span>());</span><br><span class="line">            ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">SimpleChannelInboundHandler</span>&lt;HttpRequest&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">channelRead0</span><span class="params">(ChannelHandlerContext ctx, HttpRequest msg)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                    <span class="comment">// è·å–è¯·æ±‚</span></span><br><span class="line">                    log.debug(msg.uri());</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// è¿”å›å“åº”</span></span><br><span class="line">                    <span class="type">DefaultFullHttpResponse</span> <span class="variable">response</span> <span class="operator">=</span></span><br><span class="line">                            <span class="keyword">new</span> <span class="title class_">DefaultFullHttpResponse</span>(msg.protocolVersion(), HttpResponseStatus.OK);</span><br><span class="line"></span><br><span class="line">                    <span class="type">byte</span>[] bytes = <span class="string">&quot;&lt;h1&gt;Hello, world!&lt;/h1&gt;&quot;</span>.getBytes();</span><br><span class="line"></span><br><span class="line">                    response.headers().setInt(CONTENT_LENGTH, bytes.length);</span><br><span class="line">                    response.content().writeBytes(bytes);</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// å†™å›å“åº”</span></span><br><span class="line">                    ctx.writeAndFlush(response);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">/*ch.pipeline().addLast(new ChannelInboundHandlerAdapter() &#123;</span></span><br><span class="line"><span class="comment">                @Override</span></span><br><span class="line"><span class="comment">                public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception &#123;</span></span><br><span class="line"><span class="comment">                    log.debug(&quot;&#123;&#125;&quot;, msg.getClass());</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                    if (msg instanceof HttpRequest) &#123; // è¯·æ±‚è¡Œï¼Œè¯·æ±‚å¤´</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                    &#125; else if (msg instanceof HttpContent) &#123; //è¯·æ±‚ä½“</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                    &#125;</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment">            &#125;);*/</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="type">ChannelFuture</span> <span class="variable">channelFuture</span> <span class="operator">=</span> serverBootstrap.bind(<span class="number">8080</span>).sync();</span><br><span class="line">    channelFuture.channel().closeFuture().sync();</span><br><span class="line">&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">    log.error(<span class="string">&quot;server error&quot;</span>, e);</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    boss.shutdownGracefully();</span><br><span class="line">    worker.shutdownGracefully();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-4-è‡ªå®šä¹‰åè®®è¦ç´ "><a href="#2-4-è‡ªå®šä¹‰åè®®è¦ç´ " class="headerlink" title="2.4 è‡ªå®šä¹‰åè®®è¦ç´ "></a>2.4 è‡ªå®šä¹‰åè®®è¦ç´ </h3><ul><li>é­”æ•°ï¼Œç”¨æ¥åœ¨ç¬¬ä¸€æ—¶é—´åˆ¤å®šæ˜¯å¦æ˜¯æ— æ•ˆæ•°æ®åŒ…</li><li>ç‰ˆæœ¬å·ï¼Œå¯ä»¥æ”¯æŒåè®®çš„å‡çº§</li><li>åºåˆ—åŒ–ç®—æ³•ï¼Œæ¶ˆæ¯æ­£æ–‡åˆ°åº•é‡‡ç”¨å“ªç§åºåˆ—åŒ–ååºåˆ—åŒ–æ–¹å¼ï¼Œå¯ä»¥ç”±æ­¤æ‰©å±•ï¼Œä¾‹å¦‚ï¼šjsonã€protobufã€hessianã€jdk</li><li>æŒ‡ä»¤ç±»å‹ï¼Œæ˜¯ç™»å½•ã€æ³¨å†Œã€å•èŠã€ç¾¤èŠâ€¦ è·Ÿä¸šåŠ¡ç›¸å…³</li><li>è¯·æ±‚åºå·ï¼Œä¸ºäº†åŒå·¥é€šä¿¡ï¼Œæä¾›å¼‚æ­¥èƒ½åŠ›</li><li>æ­£æ–‡é•¿åº¦</li><li>æ¶ˆæ¯æ­£æ–‡</li></ul><h4 id="ç¼–è§£ç å™¨"><a href="#ç¼–è§£ç å™¨" class="headerlink" title="ç¼–è§£ç å™¨"></a>ç¼–è§£ç å™¨</h4><p>æ ¹æ®ä¸Šé¢çš„è¦ç´ ï¼Œè®¾è®¡ä¸€ä¸ªç™»å½•è¯·æ±‚æ¶ˆæ¯å’Œç™»å½•å“åº”æ¶ˆæ¯ï¼Œå¹¶ä½¿ç”¨ Netty å®Œæˆæ”¶å‘</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MessageCodec</span> <span class="keyword">extends</span> <span class="title class_">ByteToMessageCodec</span>&lt;Message&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">encode</span><span class="params">(ChannelHandlerContext ctx, Message msg, ByteBuf out)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// 1. 4 å­—èŠ‚çš„é­”æ•°</span></span><br><span class="line">        out.writeBytes(<span class="keyword">new</span> <span class="title class_">byte</span>[]&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;);</span><br><span class="line">        <span class="comment">// 2. 1 å­—èŠ‚çš„ç‰ˆæœ¬,</span></span><br><span class="line">        out.writeByte(<span class="number">1</span>);</span><br><span class="line">        <span class="comment">// 3. 1 å­—èŠ‚çš„åºåˆ—åŒ–æ–¹å¼ jdk 0 , json 1</span></span><br><span class="line">        out.writeByte(<span class="number">0</span>);</span><br><span class="line">        <span class="comment">// 4. 1 å­—èŠ‚çš„æŒ‡ä»¤ç±»å‹</span></span><br><span class="line">        out.writeByte(msg.getMessageType());</span><br><span class="line">        <span class="comment">// 5. 4 ä¸ªå­—èŠ‚</span></span><br><span class="line">        out.writeInt(msg.getSequenceId());</span><br><span class="line">        <span class="comment">// æ— æ„ä¹‰ï¼Œå¯¹é½å¡«å……</span></span><br><span class="line">        out.writeByte(<span class="number">0xff</span>);</span><br><span class="line">        <span class="comment">// 6. è·å–å†…å®¹çš„å­—èŠ‚æ•°ç»„</span></span><br><span class="line">        <span class="type">ByteArrayOutputStream</span> <span class="variable">bos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(bos);</span><br><span class="line">        oos.writeObject(msg);</span><br><span class="line">        <span class="type">byte</span>[] bytes = bos.toByteArray();</span><br><span class="line">        <span class="comment">// 7. é•¿åº¦</span></span><br><span class="line">        out.writeInt(bytes.length);</span><br><span class="line">        <span class="comment">// 8. å†™å…¥å†…å®¹</span></span><br><span class="line">        out.writeBytes(bytes);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">decode</span><span class="params">(ChannelHandlerContext ctx, ByteBuf in, List&lt;Object&gt; out)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">magicNum</span> <span class="operator">=</span> in.readInt();</span><br><span class="line">        <span class="type">byte</span> <span class="variable">version</span> <span class="operator">=</span> in.readByte();</span><br><span class="line">        <span class="type">byte</span> <span class="variable">serializerType</span> <span class="operator">=</span> in.readByte();</span><br><span class="line">        <span class="type">byte</span> <span class="variable">messageType</span> <span class="operator">=</span> in.readByte();</span><br><span class="line">        <span class="type">int</span> <span class="variable">sequenceId</span> <span class="operator">=</span> in.readInt();</span><br><span class="line">        in.readByte();</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> in.readInt();</span><br><span class="line">        <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[length];</span><br><span class="line">        in.readBytes(bytes, <span class="number">0</span>, length);</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(bytes));</span><br><span class="line">        <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> (Message) ois.readObject();</span><br><span class="line">        log.debug(<span class="string">&quot;&#123;&#125;, &#123;&#125;, &#123;&#125;, &#123;&#125;, &#123;&#125;, &#123;&#125;&quot;</span>, magicNum, version, serializerType, messageType, sequenceId, length);</span><br><span class="line">        log.debug(<span class="string">&quot;&#123;&#125;&quot;</span>, message);</span><br><span class="line">        out.add(message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">EmbeddedChannel</span> <span class="variable">channel</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EmbeddedChannel</span>(</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">LoggingHandler</span>(),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">LengthFieldBasedFrameDecoder</span>(</span><br><span class="line">        <span class="number">1024</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">MessageCodec</span>()</span><br><span class="line">);</span><br><span class="line"><span class="comment">// encode</span></span><br><span class="line"><span class="type">LoginRequestMessage</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LoginRequestMessage</span>(<span class="string">&quot;zhangsan&quot;</span>, <span class="string">&quot;123&quot;</span>, <span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line"><span class="comment">//        channel.writeOutbound(message);</span></span><br><span class="line"><span class="comment">// decode</span></span><br><span class="line"><span class="type">ByteBuf</span> <span class="variable">buf</span> <span class="operator">=</span> ByteBufAllocator.DEFAULT.buffer();</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">MessageCodec</span>().encode(<span class="literal">null</span>, message, buf);</span><br><span class="line"></span><br><span class="line"><span class="type">ByteBuf</span> <span class="variable">s1</span> <span class="operator">=</span> buf.slice(<span class="number">0</span>, <span class="number">100</span>);</span><br><span class="line"><span class="type">ByteBuf</span> <span class="variable">s2</span> <span class="operator">=</span> buf.slice(<span class="number">100</span>, buf.readableBytes() - <span class="number">100</span>);</span><br><span class="line">s1.retain(); <span class="comment">// å¼•ç”¨è®¡æ•° 2</span></span><br><span class="line">channel.writeInbound(s1); <span class="comment">// release 1</span></span><br><span class="line">channel.writeInbound(s2);</span><br></pre></td></tr></table></figure><p>è§£è¯»</p><p><img src="/img/0013.png"></p><h4 id="ğŸ’¡-ä»€ä¹ˆæ—¶å€™å¯ä»¥åŠ -Sharable"><a href="#ğŸ’¡-ä»€ä¹ˆæ—¶å€™å¯ä»¥åŠ -Sharable" class="headerlink" title="ğŸ’¡ ä»€ä¹ˆæ—¶å€™å¯ä»¥åŠ  @Sharable"></a>ğŸ’¡ ä»€ä¹ˆæ—¶å€™å¯ä»¥åŠ  @Sharable</h4><ul><li>å½“ handler ä¸ä¿å­˜çŠ¶æ€æ—¶ï¼Œå°±å¯ä»¥å®‰å…¨åœ°åœ¨å¤šçº¿ç¨‹ä¸‹è¢«å…±äº«</li><li>ä½†è¦æ³¨æ„å¯¹äºç¼–è§£ç å™¨ç±»ï¼Œä¸èƒ½ç»§æ‰¿ ByteToMessageCodec æˆ– CombinedChannelDuplexHandler çˆ¶ç±»ï¼Œä»–ä»¬çš„æ„é€ æ–¹æ³•å¯¹ @Sharable æœ‰é™åˆ¶</li><li>å¦‚æœèƒ½ç¡®ä¿ç¼–è§£ç å™¨ä¸ä¼šä¿å­˜çŠ¶æ€ï¼Œå¯ä»¥ç»§æ‰¿ MessageToMessageCodec çˆ¶ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@ChannelHandler</span>.Sharable</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¿…é¡»å’Œ LengthFieldBasedFrameDecoder ä¸€èµ·ä½¿ç”¨ï¼Œç¡®ä¿æ¥åˆ°çš„ ByteBuf æ¶ˆæ¯æ˜¯å®Œæ•´çš„</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MessageCodecSharable</span> <span class="keyword">extends</span> <span class="title class_">MessageToMessageCodec</span>&lt;ByteBuf, Message&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">encode</span><span class="params">(ChannelHandlerContext ctx, Message msg, List&lt;Object&gt; outList)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">ByteBuf</span> <span class="variable">out</span> <span class="operator">=</span> ctx.alloc().buffer();</span><br><span class="line">        <span class="comment">// 1. 4 å­—èŠ‚çš„é­”æ•°</span></span><br><span class="line">        out.writeBytes(<span class="keyword">new</span> <span class="title class_">byte</span>[]&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;);</span><br><span class="line">        <span class="comment">// 2. 1 å­—èŠ‚çš„ç‰ˆæœ¬,</span></span><br><span class="line">        out.writeByte(<span class="number">1</span>);</span><br><span class="line">        <span class="comment">// 3. 1 å­—èŠ‚çš„åºåˆ—åŒ–æ–¹å¼ jdk 0 , json 1</span></span><br><span class="line">        out.writeByte(<span class="number">0</span>);</span><br><span class="line">        <span class="comment">// 4. 1 å­—èŠ‚çš„æŒ‡ä»¤ç±»å‹</span></span><br><span class="line">        out.writeByte(msg.getMessageType());</span><br><span class="line">        <span class="comment">// 5. 4 ä¸ªå­—èŠ‚</span></span><br><span class="line">        out.writeInt(msg.getSequenceId());</span><br><span class="line">        <span class="comment">// æ— æ„ä¹‰ï¼Œå¯¹é½å¡«å……</span></span><br><span class="line">        out.writeByte(<span class="number">0xff</span>);</span><br><span class="line">        <span class="comment">// 6. è·å–å†…å®¹çš„å­—èŠ‚æ•°ç»„</span></span><br><span class="line">        <span class="type">ByteArrayOutputStream</span> <span class="variable">bos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(bos);</span><br><span class="line">        oos.writeObject(msg);</span><br><span class="line">        <span class="type">byte</span>[] bytes = bos.toByteArray();</span><br><span class="line">        <span class="comment">// 7. é•¿åº¦</span></span><br><span class="line">        out.writeInt(bytes.length);</span><br><span class="line">        <span class="comment">// 8. å†™å…¥å†…å®¹</span></span><br><span class="line">        out.writeBytes(bytes);</span><br><span class="line">        outList.add(out);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">decode</span><span class="params">(ChannelHandlerContext ctx, ByteBuf in, List&lt;Object&gt; out)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">magicNum</span> <span class="operator">=</span> in.readInt();</span><br><span class="line">        <span class="type">byte</span> <span class="variable">version</span> <span class="operator">=</span> in.readByte();</span><br><span class="line">        <span class="type">byte</span> <span class="variable">serializerType</span> <span class="operator">=</span> in.readByte();</span><br><span class="line">        <span class="type">byte</span> <span class="variable">messageType</span> <span class="operator">=</span> in.readByte();</span><br><span class="line">        <span class="type">int</span> <span class="variable">sequenceId</span> <span class="operator">=</span> in.readInt();</span><br><span class="line">        in.readByte();</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> in.readInt();</span><br><span class="line">        <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[length];</span><br><span class="line">        in.readBytes(bytes, <span class="number">0</span>, length);</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(bytes));</span><br><span class="line">        <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> (Message) ois.readObject();</span><br><span class="line">        log.debug(<span class="string">&quot;&#123;&#125;, &#123;&#125;, &#123;&#125;, &#123;&#125;, &#123;&#125;, &#123;&#125;&quot;</span>, magicNum, version, serializerType, messageType, sequenceId, length);</span><br><span class="line">        log.debug(<span class="string">&quot;&#123;&#125;&quot;</span>, message);</span><br><span class="line">        out.add(message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-èŠå¤©å®¤æ¡ˆä¾‹"><a href="#3-èŠå¤©å®¤æ¡ˆä¾‹" class="headerlink" title="3. èŠå¤©å®¤æ¡ˆä¾‹"></a>3. èŠå¤©å®¤æ¡ˆä¾‹</h2><h3 id="3-1-èŠå¤©å®¤ä¸šåŠ¡ä»‹ç»"><a href="#3-1-èŠå¤©å®¤ä¸šåŠ¡ä»‹ç»" class="headerlink" title="3.1 èŠå¤©å®¤ä¸šåŠ¡ä»‹ç»"></a>3.1 èŠå¤©å®¤ä¸šåŠ¡ä»‹ç»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·ç®¡ç†æ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç™»å½•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> username ç”¨æˆ·å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> password å¯†ç </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> ç™»å½•æˆåŠŸè¿”å› true, å¦åˆ™è¿”å› false</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">login</span><span class="params">(String username, String password)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¼šè¯ç®¡ç†æ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Session</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»‘å®šä¼šè¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> channel å“ªä¸ª channel è¦ç»‘å®šä¼šè¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> username ä¼šè¯ç»‘å®šç”¨æˆ·</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">bind</span><span class="params">(Channel channel, String username)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è§£ç»‘ä¼šè¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> channel å“ªä¸ª channel è¦è§£ç»‘ä¼šè¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">unbind</span><span class="params">(Channel channel)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å±æ€§</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> channel å“ªä¸ª channel</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name å±æ€§å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å±æ€§å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Object <span class="title function_">getAttribute</span><span class="params">(Channel channel, String name)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®¾ç½®å±æ€§</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> channel å“ªä¸ª channel</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name å±æ€§å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value å±æ€§å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">setAttribute</span><span class="params">(Channel channel, String name, Object value)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®ç”¨æˆ·åè·å– channel</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> username ç”¨æˆ·å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> channel</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Channel <span class="title function_">getChannel</span><span class="params">(String username)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * èŠå¤©ç»„ä¼šè¯ç®¡ç†æ¥å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">GroupSession</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºä¸€ä¸ªèŠå¤©ç»„, å¦‚æœä¸å­˜åœ¨æ‰èƒ½åˆ›å»ºæˆåŠŸ, å¦åˆ™è¿”å› null</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name ç»„å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> members æˆå‘˜</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æˆåŠŸæ—¶è¿”å›ç»„å¯¹è±¡, å¤±è´¥è¿”å› null</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Group <span class="title function_">createGroup</span><span class="params">(String name, Set&lt;String&gt; members)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠ å…¥èŠå¤©ç»„</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name ç»„å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> member æˆå‘˜å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å¦‚æœç»„ä¸å­˜åœ¨è¿”å› null, å¦åˆ™è¿”å›ç»„å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Group <span class="title function_">joinMember</span><span class="params">(String name, String member)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç§»é™¤ç»„æˆå‘˜</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name ç»„å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> member æˆå‘˜å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å¦‚æœç»„ä¸å­˜åœ¨è¿”å› null, å¦åˆ™è¿”å›ç»„å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Group <span class="title function_">removeMember</span><span class="params">(String name, String member)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç§»é™¤èŠå¤©ç»„</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name ç»„å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å¦‚æœç»„ä¸å­˜åœ¨è¿”å› null, å¦åˆ™è¿”å›ç»„å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Group <span class="title function_">removeGroup</span><span class="params">(String name)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–ç»„æˆå‘˜</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name ç»„å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æˆå‘˜é›†åˆ, æ²¡æœ‰æˆå‘˜ä¼šè¿”å› empty set</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Set&lt;String&gt; <span class="title function_">getMembers</span><span class="params">(String name)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–ç»„æˆå‘˜çš„ channel é›†åˆ, åªæœ‰åœ¨çº¿çš„ channel æ‰ä¼šè¿”å›</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> name ç»„å</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æˆå‘˜ channel é›†åˆ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;Channel&gt; <span class="title function_">getMembersChannel</span><span class="params">(String name)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-2-èŠå¤©å®¤ä¸šåŠ¡-ç™»å½•"><a href="#3-2-èŠå¤©å®¤ä¸šåŠ¡-ç™»å½•" class="headerlink" title="3.2 èŠå¤©å®¤ä¸šåŠ¡-ç™»å½•"></a>3.2 èŠå¤©å®¤ä¸šåŠ¡-ç™»å½•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChatServer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">NioEventLoopGroup</span> <span class="variable">boss</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line">        <span class="type">NioEventLoopGroup</span> <span class="variable">worker</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line">        <span class="type">LoggingHandler</span> <span class="variable">LOGGING_HANDLER</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LoggingHandler</span>(LogLevel.DEBUG);</span><br><span class="line">        <span class="type">MessageCodecSharable</span> <span class="variable">MESSAGE_CODEC</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MessageCodecSharable</span>();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">ServerBootstrap</span> <span class="variable">serverBootstrap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerBootstrap</span>();</span><br><span class="line">            serverBootstrap.channel(NioServerSocketChannel.class);</span><br><span class="line">            serverBootstrap.group(boss, worker);</span><br><span class="line">            serverBootstrap.childHandler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(SocketChannel ch)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                    ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">ProcotolFrameDecoder</span>());</span><br><span class="line">                    ch.pipeline().addLast(LOGGING_HANDLER);</span><br><span class="line">                    ch.pipeline().addLast(MESSAGE_CODEC);</span><br><span class="line">                    ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">SimpleChannelInboundHandler</span>&lt;LoginRequestMessage&gt;() &#123;</span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">channelRead0</span><span class="params">(ChannelHandlerContext ctx, LoginRequestMessage msg)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                            <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> msg.getUsername();</span><br><span class="line">                            <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> msg.getPassword();</span><br><span class="line">                            <span class="type">boolean</span> <span class="variable">login</span> <span class="operator">=</span> UserServiceFactory.getUserService().login(username, password);</span><br><span class="line">                            LoginResponseMessage message;</span><br><span class="line">                            <span class="keyword">if</span>(login) &#123;</span><br><span class="line">                                message = <span class="keyword">new</span> <span class="title class_">LoginResponseMessage</span>(<span class="literal">true</span>, <span class="string">&quot;ç™»å½•æˆåŠŸ&quot;</span>);</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                message = <span class="keyword">new</span> <span class="title class_">LoginResponseMessage</span>(<span class="literal">false</span>, <span class="string">&quot;ç”¨æˆ·åæˆ–å¯†ç ä¸æ­£ç¡®&quot;</span>);</span><br><span class="line">                            &#125;</span><br><span class="line">                            ctx.writeAndFlush(message);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> serverBootstrap.bind(<span class="number">8080</span>).sync().channel();</span><br><span class="line">            channel.closeFuture().sync();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;server error&quot;</span>, e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            boss.shutdownGracefully();</span><br><span class="line">            worker.shutdownGracefully();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChatClient</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">NioEventLoopGroup</span> <span class="variable">group</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line">        <span class="type">LoggingHandler</span> <span class="variable">LOGGING_HANDLER</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LoggingHandler</span>(LogLevel.DEBUG);</span><br><span class="line">        <span class="type">MessageCodecSharable</span> <span class="variable">MESSAGE_CODEC</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MessageCodecSharable</span>();</span><br><span class="line">        <span class="type">CountDownLatch</span> <span class="variable">WAIT_FOR_LOGIN</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CountDownLatch</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="type">AtomicBoolean</span> <span class="variable">LOGIN</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicBoolean</span>(<span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Bootstrap</span> <span class="variable">bootstrap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bootstrap</span>();</span><br><span class="line">            bootstrap.channel(NioSocketChannel.class);</span><br><span class="line">            bootstrap.group(group);</span><br><span class="line">            bootstrap.handler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(SocketChannel ch)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                    ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">ProcotolFrameDecoder</span>());</span><br><span class="line"><span class="comment">//                    ch.pipeline().addLast(LOGGING_HANDLER);</span></span><br><span class="line">                    ch.pipeline().addLast(MESSAGE_CODEC);</span><br><span class="line">                    ch.pipeline().addLast(<span class="string">&quot;client handler&quot;</span>, <span class="keyword">new</span> <span class="title class_">ChannelInboundHandlerAdapter</span>() &#123;</span><br><span class="line">                        <span class="comment">// æ¥æ”¶å“åº”æ¶ˆæ¯</span></span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">channelRead</span><span class="params">(ChannelHandlerContext ctx, Object msg)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                            log.debug(<span class="string">&quot;msg: &#123;&#125;&quot;</span>, msg);</span><br><span class="line">                            <span class="keyword">if</span> ((msg <span class="keyword">instanceof</span> LoginResponseMessage)) &#123;</span><br><span class="line">                                <span class="type">LoginResponseMessage</span> <span class="variable">response</span> <span class="operator">=</span> (LoginResponseMessage) msg;</span><br><span class="line">                                <span class="keyword">if</span> (response.isSuccess()) &#123;</span><br><span class="line">                                    <span class="comment">// å¦‚æœç™»å½•æˆåŠŸ</span></span><br><span class="line">                                    LOGIN.set(<span class="literal">true</span>);</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="comment">// å”¤é†’ system in çº¿ç¨‹</span></span><br><span class="line">                                WAIT_FOR_LOGIN.countDown();</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        <span class="comment">// åœ¨è¿æ¥å»ºç«‹åè§¦å‘ active äº‹ä»¶</span></span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">channelActive</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                            <span class="comment">// è´Ÿè´£æ¥æ”¶ç”¨æˆ·åœ¨æ§åˆ¶å°çš„è¾“å…¥ï¼Œè´Ÿè´£å‘æœåŠ¡å™¨å‘é€å„ç§æ¶ˆæ¯</span></span><br><span class="line">                            <span class="keyword">new</span> <span class="title class_">Thread</span>(() -&gt; &#123;</span><br><span class="line">                                <span class="type">Scanner</span> <span class="variable">scanner</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">                                System.out.println(<span class="string">&quot;è¯·è¾“å…¥ç”¨æˆ·å:&quot;</span>);</span><br><span class="line">                                <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> scanner.nextLine();</span><br><span class="line">                                System.out.println(<span class="string">&quot;è¯·è¾“å…¥å¯†ç :&quot;</span>);</span><br><span class="line">                                <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> scanner.nextLine();</span><br><span class="line">                                <span class="comment">// æ„é€ æ¶ˆæ¯å¯¹è±¡</span></span><br><span class="line">                                <span class="type">LoginRequestMessage</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LoginRequestMessage</span>(username, password);</span><br><span class="line">                                <span class="comment">// å‘é€æ¶ˆæ¯</span></span><br><span class="line">                                ctx.writeAndFlush(message);</span><br><span class="line">                                System.out.println(<span class="string">&quot;ç­‰å¾…åç»­æ“ä½œ...&quot;</span>);</span><br><span class="line">                                <span class="keyword">try</span> &#123;</span><br><span class="line">                                    WAIT_FOR_LOGIN.await();</span><br><span class="line">                                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                                    e.printStackTrace();</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="comment">// å¦‚æœç™»å½•å¤±è´¥</span></span><br><span class="line">                                <span class="keyword">if</span> (!LOGIN.get()) &#123;</span><br><span class="line">                                    ctx.channel().close();</span><br><span class="line">                                    <span class="keyword">return</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                                <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                                    System.out.println(<span class="string">&quot;==================================&quot;</span>);</span><br><span class="line">                                    System.out.println(<span class="string">&quot;send [username] [content]&quot;</span>);</span><br><span class="line">                                    System.out.println(<span class="string">&quot;gsend [group name] [content]&quot;</span>);</span><br><span class="line">                                    System.out.println(<span class="string">&quot;gcreate [group name] [m1,m2,m3...]&quot;</span>);</span><br><span class="line">                                    System.out.println(<span class="string">&quot;gmembers [group name]&quot;</span>);</span><br><span class="line">                                    System.out.println(<span class="string">&quot;gjoin [group name]&quot;</span>);</span><br><span class="line">                                    System.out.println(<span class="string">&quot;gquit [group name]&quot;</span>);</span><br><span class="line">                                    System.out.println(<span class="string">&quot;quit&quot;</span>);</span><br><span class="line">                                    System.out.println(<span class="string">&quot;==================================&quot;</span>);</span><br><span class="line">                                    <span class="type">String</span> <span class="variable">command</span> <span class="operator">=</span> scanner.nextLine();</span><br><span class="line">                                    String[] s = command.split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">                                    <span class="keyword">switch</span> (s[<span class="number">0</span>])&#123;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="string">&quot;send&quot;</span>:</span><br><span class="line">                                            ctx.writeAndFlush(<span class="keyword">new</span> <span class="title class_">ChatRequestMessage</span>(username, s[<span class="number">1</span>], s[<span class="number">2</span>]));</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="string">&quot;gsend&quot;</span>:</span><br><span class="line">                                            ctx.writeAndFlush(<span class="keyword">new</span> <span class="title class_">GroupChatRequestMessage</span>(username, s[<span class="number">1</span>], s[<span class="number">2</span>]));</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="string">&quot;gcreate&quot;</span>:</span><br><span class="line">                                            Set&lt;String&gt; set = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;(Arrays.asList(s[<span class="number">2</span>].split(<span class="string">&quot;,&quot;</span>)));</span><br><span class="line">                                            set.add(username); <span class="comment">// åŠ å…¥è‡ªå·±</span></span><br><span class="line">                                            ctx.writeAndFlush(<span class="keyword">new</span> <span class="title class_">GroupCreateRequestMessage</span>(s[<span class="number">1</span>], set));</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="string">&quot;gmembers&quot;</span>:</span><br><span class="line">                                            ctx.writeAndFlush(<span class="keyword">new</span> <span class="title class_">GroupMembersRequestMessage</span>(s[<span class="number">1</span>]));</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="string">&quot;gjoin&quot;</span>:</span><br><span class="line">                                            ctx.writeAndFlush(<span class="keyword">new</span> <span class="title class_">GroupJoinRequestMessage</span>(username, s[<span class="number">1</span>]));</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="string">&quot;gquit&quot;</span>:</span><br><span class="line">                                            ctx.writeAndFlush(<span class="keyword">new</span> <span class="title class_">GroupQuitRequestMessage</span>(username, s[<span class="number">1</span>]));</span><br><span class="line">                                            <span class="keyword">break</span>;</span><br><span class="line">                                        <span class="keyword">case</span> <span class="string">&quot;quit&quot;</span>:</span><br><span class="line">                                            ctx.channel().close();</span><br><span class="line">                                            <span class="keyword">return</span>;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;, <span class="string">&quot;system in&quot;</span>).start();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> bootstrap.connect(<span class="string">&quot;localhost&quot;</span>, <span class="number">8080</span>).sync().channel();</span><br><span class="line">            channel.closeFuture().sync();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;client error&quot;</span>, e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            group.shutdownGracefully();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-3-èŠå¤©å®¤ä¸šåŠ¡-å•èŠ"><a href="#3-3-èŠå¤©å®¤ä¸šåŠ¡-å•èŠ" class="headerlink" title="3.3 èŠå¤©å®¤ä¸šåŠ¡-å•èŠ"></a>3.3 èŠå¤©å®¤ä¸šåŠ¡-å•èŠ</h3><p>æœåŠ¡å™¨ç«¯å°† handler ç‹¬ç«‹å‡ºæ¥</p><p>ç™»å½• handler</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ChannelHandler</span>.Sharable</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginRequestMessageHandler</span> <span class="keyword">extends</span> <span class="title class_">SimpleChannelInboundHandler</span>&lt;LoginRequestMessage&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">channelRead0</span><span class="params">(ChannelHandlerContext ctx, LoginRequestMessage msg)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> msg.getUsername();</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> msg.getPassword();</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">login</span> <span class="operator">=</span> UserServiceFactory.getUserService().login(username, password);</span><br><span class="line">        LoginResponseMessage message;</span><br><span class="line">        <span class="keyword">if</span>(login) &#123;</span><br><span class="line">            SessionFactory.getSession().bind(ctx.channel(), username);</span><br><span class="line">            message = <span class="keyword">new</span> <span class="title class_">LoginResponseMessage</span>(<span class="literal">true</span>, <span class="string">&quot;ç™»å½•æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            message = <span class="keyword">new</span> <span class="title class_">LoginResponseMessage</span>(<span class="literal">false</span>, <span class="string">&quot;ç”¨æˆ·åæˆ–å¯†ç ä¸æ­£ç¡®&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        ctx.writeAndFlush(message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å•èŠ handler</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ChannelHandler</span>.Sharable</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ChatRequestMessageHandler</span> <span class="keyword">extends</span> <span class="title class_">SimpleChannelInboundHandler</span>&lt;ChatRequestMessage&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">channelRead0</span><span class="params">(ChannelHandlerContext ctx, ChatRequestMessage msg)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">to</span> <span class="operator">=</span> msg.getTo();</span><br><span class="line">        <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> SessionFactory.getSession().getChannel(to);</span><br><span class="line">        <span class="comment">// åœ¨çº¿</span></span><br><span class="line">        <span class="keyword">if</span>(channel != <span class="literal">null</span>) &#123;</span><br><span class="line">            channel.writeAndFlush(<span class="keyword">new</span> <span class="title class_">ChatResponseMessage</span>(msg.getFrom(), msg.getContent()));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ä¸åœ¨çº¿</span></span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            ctx.writeAndFlush(<span class="keyword">new</span> <span class="title class_">ChatResponseMessage</span>(<span class="literal">false</span>, <span class="string">&quot;å¯¹æ–¹ç”¨æˆ·ä¸å­˜åœ¨æˆ–è€…ä¸åœ¨çº¿&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-4-èŠå¤©å®¤ä¸šåŠ¡-ç¾¤èŠ"><a href="#3-4-èŠå¤©å®¤ä¸šåŠ¡-ç¾¤èŠ" class="headerlink" title="3.4 èŠå¤©å®¤ä¸šåŠ¡-ç¾¤èŠ"></a>3.4 èŠå¤©å®¤ä¸šåŠ¡-ç¾¤èŠ</h3><p>åˆ›å»ºç¾¤èŠ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ChannelHandler</span>.Sharable</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GroupCreateRequestMessageHandler</span> <span class="keyword">extends</span> <span class="title class_">SimpleChannelInboundHandler</span>&lt;GroupCreateRequestMessage&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">channelRead0</span><span class="params">(ChannelHandlerContext ctx, GroupCreateRequestMessage msg)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">groupName</span> <span class="operator">=</span> msg.getGroupName();</span><br><span class="line">        Set&lt;String&gt; members = msg.getMembers();</span><br><span class="line">        <span class="comment">// ç¾¤ç®¡ç†å™¨</span></span><br><span class="line">        <span class="type">GroupSession</span> <span class="variable">groupSession</span> <span class="operator">=</span> GroupSessionFactory.getGroupSession();</span><br><span class="line">        <span class="type">Group</span> <span class="variable">group</span> <span class="operator">=</span> groupSession.createGroup(groupName, members);</span><br><span class="line">        <span class="keyword">if</span> (group == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// å‘ç”ŸæˆåŠŸæ¶ˆæ¯</span></span><br><span class="line">            ctx.writeAndFlush(<span class="keyword">new</span> <span class="title class_">GroupCreateResponseMessage</span>(<span class="literal">true</span>, groupName + <span class="string">&quot;åˆ›å»ºæˆåŠŸ&quot;</span>));</span><br><span class="line">            <span class="comment">// å‘é€æ‹‰ç¾¤æ¶ˆæ¯</span></span><br><span class="line">            List&lt;Channel&gt; channels = groupSession.getMembersChannel(groupName);</span><br><span class="line">            <span class="keyword">for</span> (Channel channel : channels) &#123;</span><br><span class="line">                channel.writeAndFlush(<span class="keyword">new</span> <span class="title class_">GroupCreateResponseMessage</span>(<span class="literal">true</span>, <span class="string">&quot;æ‚¨å·²è¢«æ‹‰å…¥&quot;</span> + groupName));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            ctx.writeAndFlush(<span class="keyword">new</span> <span class="title class_">GroupCreateResponseMessage</span>(<span class="literal">false</span>, groupName + <span class="string">&quot;å·²ç»å­˜åœ¨&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¾¤èŠ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ChannelHandler</span>.Sharable</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GroupChatRequestMessageHandler</span> <span class="keyword">extends</span> <span class="title class_">SimpleChannelInboundHandler</span>&lt;GroupChatRequestMessage&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">channelRead0</span><span class="params">(ChannelHandlerContext ctx, GroupChatRequestMessage msg)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        List&lt;Channel&gt; channels = GroupSessionFactory.getGroupSession()</span><br><span class="line">                .getMembersChannel(msg.getGroupName());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Channel channel : channels) &#123;</span><br><span class="line">            channel.writeAndFlush(<span class="keyword">new</span> <span class="title class_">GroupChatResponseMessage</span>(msg.getFrom(), msg.getContent()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŠ å…¥ç¾¤èŠ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ChannelHandler</span>.Sharable</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GroupJoinRequestMessageHandler</span> <span class="keyword">extends</span> <span class="title class_">SimpleChannelInboundHandler</span>&lt;GroupJoinRequestMessage&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">channelRead0</span><span class="params">(ChannelHandlerContext ctx, GroupJoinRequestMessage msg)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Group</span> <span class="variable">group</span> <span class="operator">=</span> GroupSessionFactory.getGroupSession().joinMember(msg.getGroupName(), msg.getUsername());</span><br><span class="line">        <span class="keyword">if</span> (group != <span class="literal">null</span>) &#123;</span><br><span class="line">            ctx.writeAndFlush(<span class="keyword">new</span> <span class="title class_">GroupJoinResponseMessage</span>(<span class="literal">true</span>, msg.getGroupName() + <span class="string">&quot;ç¾¤åŠ å…¥æˆåŠŸ&quot;</span>));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            ctx.writeAndFlush(<span class="keyword">new</span> <span class="title class_">GroupJoinResponseMessage</span>(<span class="literal">true</span>, msg.getGroupName() + <span class="string">&quot;ç¾¤ä¸å­˜åœ¨&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€€å‡ºç¾¤èŠ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ChannelHandler</span>.Sharable</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GroupQuitRequestMessageHandler</span> <span class="keyword">extends</span> <span class="title class_">SimpleChannelInboundHandler</span>&lt;GroupQuitRequestMessage&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">channelRead0</span><span class="params">(ChannelHandlerContext ctx, GroupQuitRequestMessage msg)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Group</span> <span class="variable">group</span> <span class="operator">=</span> GroupSessionFactory.getGroupSession().removeMember(msg.getGroupName(), msg.getUsername());</span><br><span class="line">        <span class="keyword">if</span> (group != <span class="literal">null</span>) &#123;</span><br><span class="line">            ctx.writeAndFlush(<span class="keyword">new</span> <span class="title class_">GroupJoinResponseMessage</span>(<span class="literal">true</span>, <span class="string">&quot;å·²é€€å‡ºç¾¤&quot;</span> + msg.getGroupName()));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            ctx.writeAndFlush(<span class="keyword">new</span> <span class="title class_">GroupJoinResponseMessage</span>(<span class="literal">true</span>, msg.getGroupName() + <span class="string">&quot;ç¾¤ä¸å­˜åœ¨&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æˆå‘˜</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ChannelHandler</span>.Sharable</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GroupMembersRequestMessageHandler</span> <span class="keyword">extends</span> <span class="title class_">SimpleChannelInboundHandler</span>&lt;GroupMembersRequestMessage&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">channelRead0</span><span class="params">(ChannelHandlerContext ctx, GroupMembersRequestMessage msg)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Set&lt;String&gt; members = GroupSessionFactory.getGroupSession()</span><br><span class="line">                .getMembers(msg.getGroupName());</span><br><span class="line">        ctx.writeAndFlush(<span class="keyword">new</span> <span class="title class_">GroupMembersResponseMessage</span>(members));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-5-èŠå¤©å®¤ä¸šåŠ¡-é€€å‡º"><a href="#3-5-èŠå¤©å®¤ä¸šåŠ¡-é€€å‡º" class="headerlink" title="3.5 èŠå¤©å®¤ä¸šåŠ¡-é€€å‡º"></a>3.5 èŠå¤©å®¤ä¸šåŠ¡-é€€å‡º</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">@Slf4j</span><br><span class="line">@ChannelHandler.Sharable</span><br><span class="line">public class QuitHandler extends ChannelInboundHandlerAdapter &#123;</span><br><span class="line"></span><br><span class="line">    // å½“è¿æ¥æ–­å¼€æ—¶è§¦å‘ inactive äº‹ä»¶</span><br><span class="line">    @Override</span><br><span class="line">    public void channelInactive(ChannelHandlerContext ctx) throws Exception &#123;</span><br><span class="line">        SessionFactory.getSession().unbind(ctx.channel());</span><br><span class="line">        log.debug(&quot;&#123;&#125; å·²ç»æ–­å¼€&quot;, ctx.channel());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">// å½“å‡ºç°å¼‚å¸¸æ—¶è§¦å‘</span><br><span class="line">    @Override</span><br><span class="line">    public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) throws Exception &#123;</span><br><span class="line">        SessionFactory.getSession().unbind(ctx.channel());</span><br><span class="line">        log.debug(&quot;&#123;&#125; å·²ç»å¼‚å¸¸æ–­å¼€ å¼‚å¸¸æ˜¯&#123;&#125;&quot;, ctx.channel(), cause.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-6-èŠå¤©å®¤ä¸šåŠ¡-ç©ºé—²æ£€æµ‹"><a href="#3-6-èŠå¤©å®¤ä¸šåŠ¡-ç©ºé—²æ£€æµ‹" class="headerlink" title="3.6 èŠå¤©å®¤ä¸šåŠ¡-ç©ºé—²æ£€æµ‹"></a>3.6 èŠå¤©å®¤ä¸šåŠ¡-ç©ºé—²æ£€æµ‹</h3><h4 id="è¿æ¥å‡æ­»"><a href="#è¿æ¥å‡æ­»" class="headerlink" title="è¿æ¥å‡æ­»"></a>è¿æ¥å‡æ­»</h4><p>åŸå› </p><ul><li>ç½‘ç»œè®¾å¤‡å‡ºç°æ•…éšœï¼Œä¾‹å¦‚ç½‘å¡ï¼Œæœºæˆ¿ç­‰ï¼Œåº•å±‚çš„ TCP è¿æ¥å·²ç»æ–­å¼€äº†ï¼Œä½†åº”ç”¨ç¨‹åºæ²¡æœ‰æ„ŸçŸ¥åˆ°ï¼Œä»ç„¶å ç”¨ç€èµ„æºã€‚</li><li>å…¬ç½‘ç½‘ç»œä¸ç¨³å®šï¼Œå‡ºç°ä¸¢åŒ…ã€‚å¦‚æœè¿ç»­å‡ºç°ä¸¢åŒ…ï¼Œè¿™æ—¶ç°è±¡å°±æ˜¯å®¢æˆ·ç«¯æ•°æ®å‘ä¸å‡ºå»ï¼ŒæœåŠ¡ç«¯ä¹Ÿä¸€ç›´æ”¶ä¸åˆ°æ•°æ®ï¼Œå°±è¿™ä¹ˆä¸€ç›´è€—ç€</li><li>åº”ç”¨ç¨‹åºçº¿ç¨‹é˜»å¡ï¼Œæ— æ³•è¿›è¡Œæ•°æ®è¯»å†™</li></ul><p>é—®é¢˜</p><ul><li>å‡æ­»çš„è¿æ¥å ç”¨çš„èµ„æºä¸èƒ½è‡ªåŠ¨é‡Šæ”¾</li><li>å‘å‡æ­»çš„è¿æ¥å‘é€æ•°æ®ï¼Œå¾—åˆ°çš„åé¦ˆæ˜¯å‘é€è¶…æ—¶</li></ul><p>æœåŠ¡å™¨ç«¯è§£å†³</p><ul><li>æ€ä¹ˆåˆ¤æ–­å®¢æˆ·ç«¯è¿æ¥æ˜¯å¦å‡æ­»å‘¢ï¼Ÿå¦‚æœèƒ½æ”¶åˆ°å®¢æˆ·ç«¯æ•°æ®ï¼Œè¯´æ˜æ²¡æœ‰å‡æ­»ã€‚å› æ­¤ç­–ç•¥å°±å¯ä»¥å®šä¸ºï¼Œæ¯éš”ä¸€æ®µæ—¶é—´å°±æ£€æŸ¥è¿™æ®µæ—¶é—´å†…æ˜¯å¦æ¥æ”¶åˆ°å®¢æˆ·ç«¯æ•°æ®ï¼Œæ²¡æœ‰å°±å¯ä»¥åˆ¤å®šä¸ºè¿æ¥å‡æ­»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç”¨æ¥åˆ¤æ–­æ˜¯ä¸æ˜¯ è¯»ç©ºé—²æ—¶é—´è¿‡é•¿ï¼Œæˆ– å†™ç©ºé—²æ—¶é—´è¿‡é•¿</span></span><br><span class="line"><span class="comment">// 5s å†…å¦‚æœæ²¡æœ‰æ”¶åˆ° channel çš„æ•°æ®ï¼Œä¼šè§¦å‘ä¸€ä¸ª IdleState#READER_IDLE äº‹ä»¶</span></span><br><span class="line">ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">IdleStateHandler</span>(<span class="number">5</span>, <span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line"><span class="comment">// ChannelDuplexHandler å¯ä»¥åŒæ—¶ä½œä¸ºå…¥ç«™å’Œå‡ºç«™å¤„ç†å™¨</span></span><br><span class="line">ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">ChannelDuplexHandler</span>() &#123;</span><br><span class="line">    <span class="comment">// ç”¨æ¥è§¦å‘ç‰¹æ®Šäº‹ä»¶</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">userEventTriggered</span><span class="params">(ChannelHandlerContext ctx, Object evt)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">IdleStateEvent</span> <span class="variable">event</span> <span class="operator">=</span> (IdleStateEvent) evt;</span><br><span class="line">        <span class="comment">// è§¦å‘äº†è¯»ç©ºé—²äº‹ä»¶</span></span><br><span class="line">        <span class="keyword">if</span> (event.state() == IdleState.READER_IDLE) &#123;</span><br><span class="line">            log.debug(<span class="string">&quot;å·²ç» 5s æ²¡æœ‰è¯»åˆ°æ•°æ®äº†&quot;</span>);</span><br><span class="line">            ctx.channel().close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯å®šæ—¶å¿ƒè·³</p><ul><li>å®¢æˆ·ç«¯å¯ä»¥å®šæ—¶å‘æœåŠ¡å™¨ç«¯å‘é€æ•°æ®ï¼Œåªè¦è¿™ä¸ªæ—¶é—´é—´éš”å°äºæœåŠ¡å™¨å®šä¹‰çš„ç©ºé—²æ£€æµ‹çš„æ—¶é—´é—´éš”ï¼Œé‚£ä¹ˆå°±èƒ½é˜²æ­¢å‰é¢æåˆ°çš„è¯¯åˆ¤ï¼Œå®¢æˆ·ç«¯å¯ä»¥å®šä¹‰å¦‚ä¸‹å¿ƒè·³å¤„ç†å™¨</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç”¨æ¥åˆ¤æ–­æ˜¯ä¸æ˜¯ è¯»ç©ºé—²æ—¶é—´è¿‡é•¿ï¼Œæˆ– å†™ç©ºé—²æ—¶é—´è¿‡é•¿</span></span><br><span class="line"><span class="comment">// 3s å†…å¦‚æœæ²¡æœ‰å‘æœåŠ¡å™¨å†™æ•°æ®ï¼Œä¼šè§¦å‘ä¸€ä¸ª IdleState#WRITER_IDLE äº‹ä»¶</span></span><br><span class="line">ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">IdleStateHandler</span>(<span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>));</span><br><span class="line"><span class="comment">// ChannelDuplexHandler å¯ä»¥åŒæ—¶ä½œä¸ºå…¥ç«™å’Œå‡ºç«™å¤„ç†å™¨</span></span><br><span class="line">ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">ChannelDuplexHandler</span>() &#123;</span><br><span class="line">    <span class="comment">// ç”¨æ¥è§¦å‘ç‰¹æ®Šäº‹ä»¶</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">userEventTriggered</span><span class="params">(ChannelHandlerContext ctx, Object evt)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">IdleStateEvent</span> <span class="variable">event</span> <span class="operator">=</span> (IdleStateEvent) evt;</span><br><span class="line">        <span class="comment">// è§¦å‘äº†å†™ç©ºé—²äº‹ä»¶</span></span><br><span class="line">        <span class="keyword">if</span> (event.state() == IdleState.WRITER_IDLE) &#123;</span><br><span class="line">            <span class="comment">//                                log.debug(&quot;3s æ²¡æœ‰å†™æ•°æ®äº†ï¼Œå‘é€ä¸€ä¸ªå¿ƒè·³åŒ…&quot;);</span></span><br><span class="line">            ctx.writeAndFlush(<span class="keyword">new</span> <span class="title class_">PingMessage</span>());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> JAVA </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¸­é—´ä»¶ </tag>
            
            <tag> Netty </tag>
            
            <tag> ç½‘ç»œç¼–ç¨‹ </tag>
            
            <tag> æ¡†æ¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Netty ä¼˜åŒ–ä¸æºç </title>
      <link href="/2022/11/22/Netty04-%E4%BC%98%E5%8C%96%E4%B8%8E%E6%BA%90%E7%A0%81/"/>
      <url>/2022/11/22/Netty04-%E4%BC%98%E5%8C%96%E4%B8%8E%E6%BA%90%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<h1 id="å››-ä¼˜åŒ–ä¸æºç "><a href="#å››-ä¼˜åŒ–ä¸æºç " class="headerlink" title="å››. ä¼˜åŒ–ä¸æºç "></a>å››. ä¼˜åŒ–ä¸æºç </h1><h2 id="1-ä¼˜åŒ–"><a href="#1-ä¼˜åŒ–" class="headerlink" title="1. ä¼˜åŒ–"></a>1. ä¼˜åŒ–</h2><h3 id="1-1-æ‰©å±•åºåˆ—åŒ–ç®—æ³•"><a href="#1-1-æ‰©å±•åºåˆ—åŒ–ç®—æ³•" class="headerlink" title="1.1 æ‰©å±•åºåˆ—åŒ–ç®—æ³•"></a>1.1 æ‰©å±•åºåˆ—åŒ–ç®—æ³•</h3><p>åºåˆ—åŒ–ï¼Œååºåˆ—åŒ–ä¸»è¦ç”¨åœ¨æ¶ˆæ¯æ­£æ–‡çš„è½¬æ¢ä¸Š</p><ul><li>åºåˆ—åŒ–æ—¶ï¼Œéœ€è¦å°† Java å¯¹è±¡å˜ä¸ºè¦ä¼ è¾“çš„æ•°æ®ï¼ˆå¯ä»¥æ˜¯ byte[]ï¼Œæˆ– json ç­‰ï¼Œæœ€ç»ˆéƒ½éœ€è¦å˜æˆ byte[]ï¼‰</li><li>ååºåˆ—åŒ–æ—¶ï¼Œéœ€è¦å°†ä¼ å…¥çš„æ­£æ–‡æ•°æ®è¿˜åŸæˆ Java å¯¹è±¡ï¼Œä¾¿äºå¤„ç†</li></ul><p>ç›®å‰çš„ä»£ç ä»…æ”¯æŒ Java è‡ªå¸¦çš„åºåˆ—åŒ–ï¼Œååºåˆ—åŒ–æœºåˆ¶ï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ååºåˆ—åŒ–</span></span><br><span class="line"><span class="type">byte</span>[] body = <span class="keyword">new</span> <span class="title class_">byte</span>[bodyLength];</span><br><span class="line">byteByf.readBytes(body);</span><br><span class="line"><span class="type">ObjectInputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(body));</span><br><span class="line"><span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> (Message) in.readObject();</span><br><span class="line">message.setSequenceId(sequenceId);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åºåˆ—åŒ–</span></span><br><span class="line"><span class="type">ByteArrayOutputStream</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(out).writeObject(message);</span><br><span class="line"><span class="type">byte</span>[] bytes = out.toByteArray();</span><br></pre></td></tr></table></figure><p>ä¸ºäº†æ”¯æŒæ›´å¤šåºåˆ—åŒ–ç®—æ³•ï¼ŒæŠ½è±¡ä¸€ä¸ª Serializer æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Serializer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ååºåˆ—åŒ–æ–¹æ³•</span></span><br><span class="line">    &lt;T&gt; T <span class="title function_">deserialize</span><span class="params">(Class&lt;T&gt; clazz, <span class="type">byte</span>[] bytes)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åºåˆ—åŒ–æ–¹æ³•</span></span><br><span class="line">    &lt;T&gt; <span class="type">byte</span>[] serialize(T object);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æä¾›ä¸¤ä¸ªå®ç°ï¼Œæˆ‘è¿™é‡Œç›´æ¥å°†å®ç°åŠ å…¥äº†æšä¸¾ç±» Serializer.Algorithm ä¸­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">SerializerAlgorithm</span> <span class="keyword">implements</span> <span class="title class_">Serializer</span> &#123;</span><br><span class="line"><span class="comment">// Java å®ç°</span></span><br><span class="line">    Java &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> &lt;T&gt; T <span class="title function_">deserialize</span><span class="params">(Class&lt;T&gt; clazz, <span class="type">byte</span>[] bytes)</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">ObjectInputStream</span> <span class="variable">in</span> <span class="operator">=</span> </span><br><span class="line">                    <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(bytes));</span><br><span class="line">                <span class="type">Object</span> <span class="variable">object</span> <span class="operator">=</span> in.readObject();</span><br><span class="line">                <span class="keyword">return</span> (T) object;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException | ClassNotFoundException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;SerializerAlgorithm.Java ååºåˆ—åŒ–é”™è¯¯&quot;</span>, e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> &lt;T&gt; <span class="type">byte</span>[] serialize(T object) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="type">ByteArrayOutputStream</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(out).writeObject(object);</span><br><span class="line">                <span class="keyword">return</span> out.toByteArray();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;SerializerAlgorithm.Java åºåˆ—åŒ–é”™è¯¯&quot;</span>, e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, </span><br><span class="line">    <span class="comment">// Json å®ç°(å¼•å…¥äº† Gson ä¾èµ–)</span></span><br><span class="line">    Json &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> &lt;T&gt; T <span class="title function_">deserialize</span><span class="params">(Class&lt;T&gt; clazz, <span class="type">byte</span>[] bytes)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Gson</span>().fromJson(<span class="keyword">new</span> <span class="title class_">String</span>(bytes, StandardCharsets.UTF_8), clazz);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> &lt;T&gt; <span class="type">byte</span>[] serialize(T object) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Gson</span>().toJson(object).getBytes(StandardCharsets.UTF_8);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// éœ€è¦ä»åè®®çš„å­—èŠ‚ä¸­å¾—åˆ°æ˜¯å“ªç§åºåˆ—åŒ–ç®—æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> SerializerAlgorithm <span class="title function_">getByInt</span><span class="params">(<span class="type">int</span> type)</span> &#123;</span><br><span class="line">        SerializerAlgorithm[] array = SerializerAlgorithm.values();</span><br><span class="line">        <span class="keyword">if</span> (type &lt; <span class="number">0</span> || type &gt; array.length - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;è¶…è¿‡ SerializerAlgorithm èŒƒå›´&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> array[type];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¢åŠ é…ç½®ç±»å’Œé…ç½®æ–‡ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Config</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> Properties properties;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> Config.class.getResourceAsStream(<span class="string">&quot;/application.properties&quot;</span>)) &#123;</span><br><span class="line">            properties = <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">            properties.load(in);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ExceptionInInitializerError</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">getServerPort</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> properties.getProperty(<span class="string">&quot;server.port&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(value == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">8080</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> Integer.parseInt(value);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Serializer.Algorithm <span class="title function_">getSerializerAlgorithm</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> properties.getProperty(<span class="string">&quot;serializer.algorithm&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(value == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> Serializer.Algorithm.Java;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> Serializer.Algorithm.valueOf(value);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é…ç½®æ–‡ä»¶</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">serializer.algorithm</span>=<span class="string">Json</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ç¼–è§£ç å™¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¿…é¡»å’Œ LengthFieldBasedFrameDecoder ä¸€èµ·ä½¿ç”¨ï¼Œç¡®ä¿æ¥åˆ°çš„ ByteBuf æ¶ˆæ¯æ˜¯å®Œæ•´çš„</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MessageCodecSharable</span> <span class="keyword">extends</span> <span class="title class_">MessageToMessageCodec</span>&lt;ByteBuf, Message&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">encode</span><span class="params">(ChannelHandlerContext ctx, Message msg, List&lt;Object&gt; outList)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">ByteBuf</span> <span class="variable">out</span> <span class="operator">=</span> ctx.alloc().buffer();</span><br><span class="line">        <span class="comment">// 1. 4 å­—èŠ‚çš„é­”æ•°</span></span><br><span class="line">        out.writeBytes(<span class="keyword">new</span> <span class="title class_">byte</span>[]&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;);</span><br><span class="line">        <span class="comment">// 2. 1 å­—èŠ‚çš„ç‰ˆæœ¬,</span></span><br><span class="line">        out.writeByte(<span class="number">1</span>);</span><br><span class="line">        <span class="comment">// 3. 1 å­—èŠ‚çš„åºåˆ—åŒ–æ–¹å¼ jdk 0 , json 1</span></span><br><span class="line">        out.writeByte(Config.getSerializerAlgorithm().ordinal());</span><br><span class="line">        <span class="comment">// 4. 1 å­—èŠ‚çš„æŒ‡ä»¤ç±»å‹</span></span><br><span class="line">        out.writeByte(msg.getMessageType());</span><br><span class="line">        <span class="comment">// 5. 4 ä¸ªå­—èŠ‚</span></span><br><span class="line">        out.writeInt(msg.getSequenceId());</span><br><span class="line">        <span class="comment">// æ— æ„ä¹‰ï¼Œå¯¹é½å¡«å……</span></span><br><span class="line">        out.writeByte(<span class="number">0xff</span>);</span><br><span class="line">        <span class="comment">// 6. è·å–å†…å®¹çš„å­—èŠ‚æ•°ç»„</span></span><br><span class="line">        <span class="type">byte</span>[] bytes = Config.getSerializerAlgorithm().serialize(msg);</span><br><span class="line">        <span class="comment">// 7. é•¿åº¦</span></span><br><span class="line">        out.writeInt(bytes.length);</span><br><span class="line">        <span class="comment">// 8. å†™å…¥å†…å®¹</span></span><br><span class="line">        out.writeBytes(bytes);</span><br><span class="line">        outList.add(out);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">decode</span><span class="params">(ChannelHandlerContext ctx, ByteBuf in, List&lt;Object&gt; out)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">magicNum</span> <span class="operator">=</span> in.readInt();</span><br><span class="line">        <span class="type">byte</span> <span class="variable">version</span> <span class="operator">=</span> in.readByte();</span><br><span class="line">        <span class="type">byte</span> <span class="variable">serializerAlgorithm</span> <span class="operator">=</span> in.readByte(); <span class="comment">// 0 æˆ– 1</span></span><br><span class="line">        <span class="type">byte</span> <span class="variable">messageType</span> <span class="operator">=</span> in.readByte(); <span class="comment">// 0,1,2...</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">sequenceId</span> <span class="operator">=</span> in.readInt();</span><br><span class="line">        in.readByte();</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> in.readInt();</span><br><span class="line">        <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[length];</span><br><span class="line">        in.readBytes(bytes, <span class="number">0</span>, length);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ‰¾åˆ°ååºåˆ—åŒ–ç®—æ³•</span></span><br><span class="line">        Serializer.<span class="type">Algorithm</span> <span class="variable">algorithm</span> <span class="operator">=</span> Serializer.Algorithm.values()[serializerAlgorithm];</span><br><span class="line">        <span class="comment">// ç¡®å®šå…·ä½“æ¶ˆæ¯ç±»å‹</span></span><br><span class="line">        Class&lt;? <span class="keyword">extends</span> <span class="title class_">Message</span>&gt; messageClass = Message.getMessageClass(messageType);</span><br><span class="line">        <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> algorithm.deserialize(messageClass, bytes);</span><br><span class="line"><span class="comment">//        log.debug(&quot;&#123;&#125;, &#123;&#125;, &#123;&#125;, &#123;&#125;, &#123;&#125;, &#123;&#125;&quot;, magicNum, version, serializerType, messageType, sequenceId, length);</span></span><br><span class="line"><span class="comment">//        log.debug(&quot;&#123;&#125;&quot;, message);</span></span><br><span class="line">        out.add(message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ç¡®å®šå…·ä½“æ¶ˆæ¯ç±»å‹ï¼Œå¯ä»¥æ ¹æ® <code>æ¶ˆæ¯ç±»å‹å­—èŠ‚</code> è·å–åˆ°å¯¹åº”çš„ <code>æ¶ˆæ¯ class</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Message</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®æ¶ˆæ¯ç±»å‹å­—èŠ‚ï¼Œè·å¾—å¯¹åº”çš„æ¶ˆæ¯ class</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> messageType æ¶ˆæ¯ç±»å‹å­—èŠ‚</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ¶ˆæ¯ class</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Class&lt;? <span class="keyword">extends</span> <span class="title class_">Message</span>&gt; getMessageClass(<span class="type">int</span> messageType) &#123;</span><br><span class="line">        <span class="keyword">return</span> messageClasses.get(messageType);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> sequenceId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> messageType;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="type">int</span> <span class="title function_">getMessageType</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">LoginRequestMessage</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">LoginResponseMessage</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">ChatRequestMessage</span> <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">ChatResponseMessage</span> <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">GroupCreateRequestMessage</span> <span class="operator">=</span> <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">GroupCreateResponseMessage</span> <span class="operator">=</span> <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">GroupJoinRequestMessage</span> <span class="operator">=</span> <span class="number">6</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">GroupJoinResponseMessage</span> <span class="operator">=</span> <span class="number">7</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">GroupQuitRequestMessage</span> <span class="operator">=</span> <span class="number">8</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">GroupQuitResponseMessage</span> <span class="operator">=</span> <span class="number">9</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">GroupChatRequestMessage</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">GroupChatResponseMessage</span> <span class="operator">=</span> <span class="number">11</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">GroupMembersRequestMessage</span> <span class="operator">=</span> <span class="number">12</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">GroupMembersResponseMessage</span> <span class="operator">=</span> <span class="number">13</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">PingMessage</span> <span class="operator">=</span> <span class="number">14</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">PongMessage</span> <span class="operator">=</span> <span class="number">15</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Map&lt;Integer, Class&lt;? <span class="keyword">extends</span> <span class="title class_">Message</span>&gt;&gt; messageClasses = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        messageClasses.put(LoginRequestMessage, LoginRequestMessage.class);</span><br><span class="line">        messageClasses.put(LoginResponseMessage, LoginResponseMessage.class);</span><br><span class="line">        messageClasses.put(ChatRequestMessage, ChatRequestMessage.class);</span><br><span class="line">        messageClasses.put(ChatResponseMessage, ChatResponseMessage.class);</span><br><span class="line">        messageClasses.put(GroupCreateRequestMessage, GroupCreateRequestMessage.class);</span><br><span class="line">        messageClasses.put(GroupCreateResponseMessage, GroupCreateResponseMessage.class);</span><br><span class="line">        messageClasses.put(GroupJoinRequestMessage, GroupJoinRequestMessage.class);</span><br><span class="line">        messageClasses.put(GroupJoinResponseMessage, GroupJoinResponseMessage.class);</span><br><span class="line">        messageClasses.put(GroupQuitRequestMessage, GroupQuitRequestMessage.class);</span><br><span class="line">        messageClasses.put(GroupQuitResponseMessage, GroupQuitResponseMessage.class);</span><br><span class="line">        messageClasses.put(GroupChatRequestMessage, GroupChatRequestMessage.class);</span><br><span class="line">        messageClasses.put(GroupChatResponseMessage, GroupChatResponseMessage.class);</span><br><span class="line">        messageClasses.put(GroupMembersRequestMessage, GroupMembersRequestMessage.class);</span><br><span class="line">        messageClasses.put(GroupMembersResponseMessage, GroupMembersResponseMessage.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1-2-å‚æ•°è°ƒä¼˜"><a href="#1-2-å‚æ•°è°ƒä¼˜" class="headerlink" title="1.2 å‚æ•°è°ƒä¼˜"></a>1.2 å‚æ•°è°ƒä¼˜</h3><h4 id="1ï¼‰CONNECT-TIMEOUT-MILLIS"><a href="#1ï¼‰CONNECT-TIMEOUT-MILLIS" class="headerlink" title="1ï¼‰CONNECT_TIMEOUT_MILLIS"></a>1ï¼‰CONNECT_TIMEOUT_MILLIS</h4><ul><li><p>å±äº SocketChannal å‚æ•°</p></li><li><p>ç”¨åœ¨å®¢æˆ·ç«¯å»ºç«‹è¿æ¥æ—¶ï¼Œå¦‚æœåœ¨æŒ‡å®šæ¯«ç§’å†…æ— æ³•è¿æ¥ï¼Œä¼šæŠ›å‡º timeout å¼‚å¸¸</p></li><li><p>SO_TIMEOUT ä¸»è¦ç”¨åœ¨é˜»å¡ IOï¼Œé˜»å¡ IO ä¸­ acceptï¼Œread ç­‰éƒ½æ˜¯æ— é™ç­‰å¾…çš„ï¼Œå¦‚æœä¸å¸Œæœ›æ°¸è¿œé˜»å¡ï¼Œä½¿ç”¨å®ƒè°ƒæ•´è¶…æ—¶æ—¶é—´</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestConnectionTimeout</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">NioEventLoopGroup</span> <span class="variable">group</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Bootstrap</span> <span class="variable">bootstrap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bootstrap</span>()</span><br><span class="line">                    .group(group)</span><br><span class="line">                    .option(ChannelOption.CONNECT_TIMEOUT_MILLIS, <span class="number">300</span>)</span><br><span class="line">                    .channel(NioSocketChannel.class)</span><br><span class="line">                    .handler(<span class="keyword">new</span> <span class="title class_">LoggingHandler</span>());</span><br><span class="line">            <span class="type">ChannelFuture</span> <span class="variable">future</span> <span class="operator">=</span> bootstrap.connect(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">8080</span>);</span><br><span class="line">            future.sync().channel().closeFuture().sync(); <span class="comment">// æ–­ç‚¹1</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            log.debug(<span class="string">&quot;timeout&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            group.shutdownGracefully();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦å¤–æºç éƒ¨åˆ† <code>io.netty.channel.nio.AbstractNioChannel.AbstractNioUnsafe#connect</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">connect</span><span class="params">(</span></span><br><span class="line"><span class="params">        <span class="keyword">final</span> SocketAddress remoteAddress, <span class="keyword">final</span> SocketAddress localAddress, <span class="keyword">final</span> ChannelPromise promise)</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="comment">// Schedule connect timeout.</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">connectTimeoutMillis</span> <span class="operator">=</span> config().getConnectTimeoutMillis();</span><br><span class="line">    <span class="keyword">if</span> (connectTimeoutMillis &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        connectTimeoutFuture = eventLoop().schedule(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;                </span><br><span class="line">                <span class="type">ChannelPromise</span> <span class="variable">connectPromise</span> <span class="operator">=</span> AbstractNioChannel.<span class="built_in">this</span>.connectPromise;</span><br><span class="line">                <span class="type">ConnectTimeoutException</span> <span class="variable">cause</span> <span class="operator">=</span></span><br><span class="line">                    <span class="keyword">new</span> <span class="title class_">ConnectTimeoutException</span>(<span class="string">&quot;connection timed out: &quot;</span> + remoteAddress); <span class="comment">// æ–­ç‚¹2</span></span><br><span class="line">                <span class="keyword">if</span> (connectPromise != <span class="literal">null</span> &amp;&amp; connectPromise.tryFailure(cause)) &#123;</span><br><span class="line">                    close(voidPromise());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, connectTimeoutMillis, TimeUnit.MILLISECONDS);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2ï¼‰SO-BACKLOG"><a href="#2ï¼‰SO-BACKLOG" class="headerlink" title="2ï¼‰SO_BACKLOG"></a>2ï¼‰SO_BACKLOG</h4><ul><li>å±äº ServerSocketChannal å‚æ•°</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">sequenceDiagram</span><br><span class="line"></span><br><span class="line">participant c as client</span><br><span class="line">participant s as server</span><br><span class="line">participant sq as syns queue</span><br><span class="line">participant aq as accept queue</span><br><span class="line"></span><br><span class="line">s -&gt;&gt; s : bind()</span><br><span class="line">s -&gt;&gt; s : listen()</span><br><span class="line">c -&gt;&gt; c : connect()</span><br><span class="line">c -&gt;&gt; s : 1. SYN</span><br><span class="line">Note left of c : SYN_SEND</span><br><span class="line">s -&gt;&gt; sq : put</span><br><span class="line">Note right of s : SYN_RCVD</span><br><span class="line">s -&gt;&gt; c : 2. SYN + ACK</span><br><span class="line">Note left of c : ESTABLISHED</span><br><span class="line">c -&gt;&gt; s : 3. ACK</span><br><span class="line">sq -&gt;&gt; aq : put</span><br><span class="line">Note right of s : ESTABLISHED</span><br><span class="line">aq --&gt;&gt; s : </span><br><span class="line">s -&gt;&gt; s : accept()</span><br></pre></td></tr></table></figure><ol><li>ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼Œclient å‘é€ SYN åˆ° serverï¼ŒçŠ¶æ€ä¿®æ”¹ä¸º SYN_SENDï¼Œserver æ”¶åˆ°ï¼ŒçŠ¶æ€æ”¹å˜ä¸º SYN_REVDï¼Œå¹¶å°†è¯¥è¯·æ±‚æ”¾å…¥ sync queue é˜Ÿåˆ—</li><li>ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼Œserver å›å¤ SYN + ACK ç»™ clientï¼Œclient æ”¶åˆ°ï¼ŒçŠ¶æ€æ”¹å˜ä¸º ESTABLISHEDï¼Œå¹¶å‘é€ ACK ç»™ server</li><li>ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼Œserver æ”¶åˆ° ACKï¼ŒçŠ¶æ€æ”¹å˜ä¸º ESTABLISHEDï¼Œå°†è¯¥è¯·æ±‚ä» sync queue æ”¾å…¥ accept queue</li></ol><p>å…¶ä¸­</p><ul><li><p>åœ¨ linux 2.2 ä¹‹å‰ï¼Œbacklog å¤§å°åŒ…æ‹¬äº†ä¸¤ä¸ªé˜Ÿåˆ—çš„å¤§å°ï¼Œåœ¨ 2.2 ä¹‹åï¼Œåˆ†åˆ«ç”¨ä¸‹é¢ä¸¤ä¸ªå‚æ•°æ¥æ§åˆ¶</p></li><li><p>sync queue - åŠè¿æ¥é˜Ÿåˆ—</p><ul><li>å¤§å°é€šè¿‡ &#x2F;proc&#x2F;sys&#x2F;net&#x2F;ipv4&#x2F;tcp_max_syn_backlog æŒ‡å®šï¼Œåœ¨ <code>syncookies</code> å¯ç”¨çš„æƒ…å†µä¸‹ï¼Œé€»è¾‘ä¸Šæ²¡æœ‰æœ€å¤§å€¼é™åˆ¶ï¼Œè¿™ä¸ªè®¾ç½®ä¾¿è¢«å¿½ç•¥</li></ul></li><li><p>accept queue - å…¨è¿æ¥é˜Ÿåˆ—</p><ul><li>å…¶å¤§å°é€šè¿‡ &#x2F;proc&#x2F;sys&#x2F;net&#x2F;core&#x2F;somaxconn æŒ‡å®šï¼Œåœ¨ä½¿ç”¨ listen å‡½æ•°æ—¶ï¼Œå†…æ ¸ä¼šæ ¹æ®ä¼ å…¥çš„ backlog å‚æ•°ä¸ç³»ç»Ÿå‚æ•°ï¼Œå–äºŒè€…çš„è¾ƒå°å€¼</li><li>å¦‚æœ accpet queue é˜Ÿåˆ—æ»¡äº†ï¼Œserver å°†å‘é€ä¸€ä¸ªæ‹’ç»è¿æ¥çš„é”™è¯¯ä¿¡æ¯åˆ° client</li></ul></li></ul><p>netty ä¸­</p><p>å¯ä»¥é€šè¿‡  option(ChannelOption.SO_BACKLOG, å€¼) æ¥è®¾ç½®å¤§å°</p><p>å¯ä»¥é€šè¿‡ä¸‹é¢æºç æŸ¥çœ‹é»˜è®¤å¤§å°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DefaultServerSocketChannelConfig</span> <span class="keyword">extends</span> <span class="title class_">DefaultChannelConfig</span></span><br><span class="line">                                              <span class="keyword">implements</span> <span class="title class_">ServerSocketChannelConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">volatile</span> <span class="type">int</span> <span class="variable">backlog</span> <span class="operator">=</span> NetUtil.SOMAXCONN;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯¾å ‚è°ƒè¯•å…³é”®æ–­ç‚¹ä¸ºï¼š<code>io.netty.channel.nio.NioEventLoop#processSelectedKey</code></p><p>oio ä¸­æ›´å®¹æ˜“è¯´æ˜ï¼Œä¸ç”¨ debug æ¨¡å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Server</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ServerSocket</span> <span class="variable">ss</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerSocket</span>(<span class="number">8888</span>, <span class="number">2</span>);</span><br><span class="line">        <span class="type">Socket</span> <span class="variable">accept</span> <span class="operator">=</span> ss.accept();</span><br><span class="line">        System.out.println(accept);</span><br><span class="line">        System.in.read();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯å¯åŠ¨ 4 ä¸ª</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Socket</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Socket</span>();</span><br><span class="line">            System.out.println(<span class="keyword">new</span> <span class="title class_">Date</span>()+<span class="string">&quot; connecting...&quot;</span>);</span><br><span class="line">            s.connect(<span class="keyword">new</span> <span class="title class_">InetSocketAddress</span>(<span class="string">&quot;localhost&quot;</span>, <span class="number">8888</span>),<span class="number">1000</span>);</span><br><span class="line">            System.out.println(<span class="keyword">new</span> <span class="title class_">Date</span>()+<span class="string">&quot; connected...&quot;</span>);</span><br><span class="line">            s.getOutputStream().write(<span class="number">1</span>);</span><br><span class="line">            System.in.read();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            System.out.println(<span class="keyword">new</span> <span class="title class_">Date</span>()+<span class="string">&quot; connecting timeout...&quot;</span>);</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ 1ï¼Œ2ï¼Œ3 ä¸ªå®¢æˆ·ç«¯éƒ½æ‰“å°ï¼Œä½†é™¤äº†ç¬¬ä¸€ä¸ªå¤„äº accpet å¤–ï¼Œå…¶å®ƒä¸¤ä¸ªéƒ½å¤„äº accept queue ä¸­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Tue Apr <span class="number">21</span> <span class="number">20</span>:<span class="number">30</span>:<span class="number">28</span> CST <span class="number">2020</span> connecting...</span><br><span class="line">Tue Apr <span class="number">21</span> <span class="number">20</span>:<span class="number">30</span>:<span class="number">28</span> CST <span class="number">2020</span> connected...</span><br></pre></td></tr></table></figure><p>ç¬¬ 4 ä¸ªå®¢æˆ·ç«¯è¿æ¥æ—¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Tue Apr 21 20:53:58 CST 2020 connecting...</span><br><span class="line">Tue Apr 21 20:53:59 CST 2020 connecting timeout...</span><br><span class="line">java.net.SocketTimeoutException: connect timed out</span><br></pre></td></tr></table></figure><h4 id="3ï¼‰ulimit-n"><a href="#3ï¼‰ulimit-n" class="headerlink" title="3ï¼‰ulimit -n"></a>3ï¼‰ulimit -n</h4><ul><li>å±äºæ“ä½œç³»ç»Ÿå‚æ•°</li></ul><h4 id="4ï¼‰TCP-NODELAY"><a href="#4ï¼‰TCP-NODELAY" class="headerlink" title="4ï¼‰TCP_NODELAY"></a>4ï¼‰TCP_NODELAY</h4><ul><li>å±äº SocketChannal å‚æ•°</li></ul><h4 id="5ï¼‰SO-SNDBUF-amp-SO-RCVBUF"><a href="#5ï¼‰SO-SNDBUF-amp-SO-RCVBUF" class="headerlink" title="5ï¼‰SO_SNDBUF &amp; SO_RCVBUF"></a>5ï¼‰SO_SNDBUF &amp; SO_RCVBUF</h4><ul><li>SO_SNDBUF å±äº SocketChannal å‚æ•°</li><li>SO_RCVBUF æ—¢å¯ç”¨äº SocketChannal å‚æ•°ï¼Œä¹Ÿå¯ä»¥ç”¨äº ServerSocketChannal å‚æ•°ï¼ˆå»ºè®®è®¾ç½®åˆ° ServerSocketChannal ä¸Šï¼‰</li></ul><h4 id="6ï¼‰ALLOCATOR"><a href="#6ï¼‰ALLOCATOR" class="headerlink" title="6ï¼‰ALLOCATOR"></a>6ï¼‰ALLOCATOR</h4><ul><li>å±äº SocketChannal å‚æ•°</li><li>ç”¨æ¥åˆ†é… ByteBufï¼Œ ctx.alloc()</li></ul><h4 id="7ï¼‰RCVBUF-ALLOCATOR"><a href="#7ï¼‰RCVBUF-ALLOCATOR" class="headerlink" title="7ï¼‰RCVBUF_ALLOCATOR"></a>7ï¼‰RCVBUF_ALLOCATOR</h4><ul><li>å±äº SocketChannal å‚æ•°</li><li>æ§åˆ¶ netty æ¥æ”¶ç¼“å†²åŒºå¤§å°</li><li>è´Ÿè´£å…¥ç«™æ•°æ®çš„åˆ†é…ï¼Œå†³å®šå…¥ç«™ç¼“å†²åŒºçš„å¤§å°ï¼ˆå¹¶å¯åŠ¨æ€è°ƒæ•´ï¼‰ï¼Œç»Ÿä¸€é‡‡ç”¨ direct ç›´æ¥å†…å­˜ï¼Œå…·ä½“æ± åŒ–è¿˜æ˜¯éæ± åŒ–ç”± allocator å†³å®š</li></ul><h3 id="1-3-RPC-æ¡†æ¶"><a href="#1-3-RPC-æ¡†æ¶" class="headerlink" title="1.3 RPC æ¡†æ¶"></a>1.3 RPC æ¡†æ¶</h3><h4 id="1ï¼‰å‡†å¤‡å·¥ä½œ"><a href="#1ï¼‰å‡†å¤‡å·¥ä½œ" class="headerlink" title="1ï¼‰å‡†å¤‡å·¥ä½œ"></a>1ï¼‰å‡†å¤‡å·¥ä½œ</h4><p>è¿™äº›ä»£ç å¯ä»¥è®¤ä¸ºæ˜¯ç°æˆçš„ï¼Œæ— éœ€ä»å¤´ç¼–å†™ç»ƒä¹ </p><p>ä¸ºäº†ç®€åŒ–èµ·è§ï¼Œåœ¨åŸæ¥èŠå¤©é¡¹ç›®çš„åŸºç¡€ä¸Šæ–°å¢ Rpc è¯·æ±‚å’Œå“åº”æ¶ˆæ¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Message</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// çœç•¥æ—§çš„ä»£ç </span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">RPC_MESSAGE_TYPE_REQUEST</span> <span class="operator">=</span> <span class="number">101</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span>  <span class="variable">RPC_MESSAGE_TYPE_RESPONSE</span> <span class="operator">=</span> <span class="number">102</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        messageClasses.put(RPC_MESSAGE_TYPE_REQUEST, RpcRequestMessage.class);</span><br><span class="line">        messageClasses.put(RPC_MESSAGE_TYPE_RESPONSE, RpcResponseMessage.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯·æ±‚æ¶ˆæ¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@ToString(callSuper = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RpcRequestMessage</span> <span class="keyword">extends</span> <span class="title class_">Message</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è°ƒç”¨çš„æ¥å£å…¨é™å®šåï¼ŒæœåŠ¡ç«¯æ ¹æ®å®ƒæ‰¾åˆ°å®ç°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String interfaceName;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è°ƒç”¨æ¥å£ä¸­çš„æ–¹æ³•å</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String methodName;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–¹æ³•è¿”å›ç±»å‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Class&lt;?&gt; returnType;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–¹æ³•å‚æ•°ç±»å‹æ•°ç»„</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Class[] parameterTypes;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–¹æ³•å‚æ•°å€¼æ•°ç»„</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Object[] parameterValue;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">RpcRequestMessage</span><span class="params">(<span class="type">int</span> sequenceId, String interfaceName, String methodName, Class&lt;?&gt; returnType, Class[] parameterTypes, Object[] parameterValue)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.setSequenceId(sequenceId);</span><br><span class="line">        <span class="built_in">this</span>.interfaceName = interfaceName;</span><br><span class="line">        <span class="built_in">this</span>.methodName = methodName;</span><br><span class="line">        <span class="built_in">this</span>.returnType = returnType;</span><br><span class="line">        <span class="built_in">this</span>.parameterTypes = parameterTypes;</span><br><span class="line">        <span class="built_in">this</span>.parameterValue = parameterValue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getMessageType</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> RPC_MESSAGE_TYPE_REQUEST;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å“åº”æ¶ˆæ¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ToString(callSuper = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RpcResponseMessage</span> <span class="keyword">extends</span> <span class="title class_">Message</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿”å›å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Object returnValue;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¼‚å¸¸å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Exception exceptionValue;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getMessageType</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> RPC_MESSAGE_TYPE_RESPONSE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœåŠ¡å™¨æ¶å­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RpcServer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">NioEventLoopGroup</span> <span class="variable">boss</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line">        <span class="type">NioEventLoopGroup</span> <span class="variable">worker</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line">        <span class="type">LoggingHandler</span> <span class="variable">LOGGING_HANDLER</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LoggingHandler</span>(LogLevel.DEBUG);</span><br><span class="line">        <span class="type">MessageCodecSharable</span> <span class="variable">MESSAGE_CODEC</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MessageCodecSharable</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// rpc è¯·æ±‚æ¶ˆæ¯å¤„ç†å™¨ï¼Œå¾…å®ç°</span></span><br><span class="line">        <span class="type">RpcRequestMessageHandler</span> <span class="variable">RPC_HANDLER</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RpcRequestMessageHandler</span>();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">ServerBootstrap</span> <span class="variable">serverBootstrap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ServerBootstrap</span>();</span><br><span class="line">            serverBootstrap.channel(NioServerSocketChannel.class);</span><br><span class="line">            serverBootstrap.group(boss, worker);</span><br><span class="line">            serverBootstrap.childHandler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(SocketChannel ch)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                    ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">ProcotolFrameDecoder</span>());</span><br><span class="line">                    ch.pipeline().addLast(LOGGING_HANDLER);</span><br><span class="line">                    ch.pipeline().addLast(MESSAGE_CODEC);</span><br><span class="line">                    ch.pipeline().addLast(RPC_HANDLER);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> serverBootstrap.bind(<span class="number">8080</span>).sync().channel();</span><br><span class="line">            channel.closeFuture().sync();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;server error&quot;</span>, e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            boss.shutdownGracefully();</span><br><span class="line">            worker.shutdownGracefully();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯æ¶å­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RpcClient</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">NioEventLoopGroup</span> <span class="variable">group</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line">        <span class="type">LoggingHandler</span> <span class="variable">LOGGING_HANDLER</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LoggingHandler</span>(LogLevel.DEBUG);</span><br><span class="line">        <span class="type">MessageCodecSharable</span> <span class="variable">MESSAGE_CODEC</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MessageCodecSharable</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// rpc å“åº”æ¶ˆæ¯å¤„ç†å™¨ï¼Œå¾…å®ç°</span></span><br><span class="line">        <span class="type">RpcResponseMessageHandler</span> <span class="variable">RPC_HANDLER</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RpcResponseMessageHandler</span>();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Bootstrap</span> <span class="variable">bootstrap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bootstrap</span>();</span><br><span class="line">            bootstrap.channel(NioSocketChannel.class);</span><br><span class="line">            bootstrap.group(group);</span><br><span class="line">            bootstrap.handler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(SocketChannel ch)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                    ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">ProcotolFrameDecoder</span>());</span><br><span class="line">                    ch.pipeline().addLast(LOGGING_HANDLER);</span><br><span class="line">                    ch.pipeline().addLast(MESSAGE_CODEC);</span><br><span class="line">                    ch.pipeline().addLast(RPC_HANDLER);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> bootstrap.connect(<span class="string">&quot;localhost&quot;</span>, <span class="number">8080</span>).sync().channel();</span><br><span class="line">            channel.closeFuture().sync();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;client error&quot;</span>, e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            group.shutdownGracefully();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœåŠ¡å™¨ç«¯çš„ service è·å–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ServicesFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> Properties properties;</span><br><span class="line">    <span class="keyword">static</span> Map&lt;Class&lt;?&gt;, Object&gt; map = <span class="keyword">new</span> <span class="title class_">ConcurrentHashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> Config.class.getResourceAsStream(<span class="string">&quot;/application.properties&quot;</span>)) &#123;</span><br><span class="line">            properties = <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">            properties.load(in);</span><br><span class="line">            Set&lt;String&gt; names = properties.stringPropertyNames();</span><br><span class="line">            <span class="keyword">for</span> (String name : names) &#123;</span><br><span class="line">                <span class="keyword">if</span> (name.endsWith(<span class="string">&quot;Service&quot;</span>)) &#123;</span><br><span class="line">                    Class&lt;?&gt; interfaceClass = Class.forName(name);</span><br><span class="line">                    Class&lt;?&gt; instanceClass = Class.forName(properties.getProperty(name));</span><br><span class="line">                    map.put(interfaceClass, instanceClass.newInstance());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException | ClassNotFoundException | InstantiationException | IllegalAccessException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ExceptionInInitializerError</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T <span class="title function_">getService</span><span class="params">(Class&lt;T&gt; interfaceClass)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (T) map.get(interfaceClass);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›¸å…³é…ç½® application.properties</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">serializer.algorithm=Json</span><br><span class="line">cn.itcast.server.service.HelloService=cn.itcast.server.service.HelloServiceImpl</span><br></pre></td></tr></table></figure><h4 id="2ï¼‰æœåŠ¡å™¨-handler"><a href="#2ï¼‰æœåŠ¡å™¨-handler" class="headerlink" title="2ï¼‰æœåŠ¡å™¨ handler"></a>2ï¼‰æœåŠ¡å™¨ handler</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@ChannelHandler</span>.Sharable</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RpcRequestMessageHandler</span> <span class="keyword">extends</span> <span class="title class_">SimpleChannelInboundHandler</span>&lt;RpcRequestMessage&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">channelRead0</span><span class="params">(ChannelHandlerContext ctx, RpcRequestMessage message)</span> &#123;</span><br><span class="line">        <span class="type">RpcResponseMessage</span> <span class="variable">response</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RpcResponseMessage</span>();</span><br><span class="line">        response.setSequenceId(message.getSequenceId());</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// è·å–çœŸæ­£çš„å®ç°å¯¹è±¡</span></span><br><span class="line">            <span class="type">HelloService</span> <span class="variable">service</span> <span class="operator">=</span> (HelloService)</span><br><span class="line">                    ServicesFactory.getService(Class.forName(message.getInterfaceName()));</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// è·å–è¦è°ƒç”¨çš„æ–¹æ³•</span></span><br><span class="line">            <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> service.getClass().getMethod(message.getMethodName(), message.getParameterTypes());</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// è°ƒç”¨æ–¹æ³•</span></span><br><span class="line">            <span class="type">Object</span> <span class="variable">invoke</span> <span class="operator">=</span> method.invoke(service, message.getParameterValue());</span><br><span class="line">            <span class="comment">// è°ƒç”¨æˆåŠŸ</span></span><br><span class="line">            response.setReturnValue(invoke);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="comment">// è°ƒç”¨å¼‚å¸¸</span></span><br><span class="line">            response.setExceptionValue(e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è¿”å›ç»“æœ</span></span><br><span class="line">        ctx.writeAndFlush(response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3ï¼‰å®¢æˆ·ç«¯ä»£ç ç¬¬ä¸€ç‰ˆ"><a href="#3ï¼‰å®¢æˆ·ç«¯ä»£ç ç¬¬ä¸€ç‰ˆ" class="headerlink" title="3ï¼‰å®¢æˆ·ç«¯ä»£ç ç¬¬ä¸€ç‰ˆ"></a>3ï¼‰å®¢æˆ·ç«¯ä»£ç ç¬¬ä¸€ç‰ˆ</h4><p>åªå‘æ¶ˆæ¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RpcClient</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">NioEventLoopGroup</span> <span class="variable">group</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line">        <span class="type">LoggingHandler</span> <span class="variable">LOGGING_HANDLER</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LoggingHandler</span>(LogLevel.DEBUG);</span><br><span class="line">        <span class="type">MessageCodecSharable</span> <span class="variable">MESSAGE_CODEC</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MessageCodecSharable</span>();</span><br><span class="line">        <span class="type">RpcResponseMessageHandler</span> <span class="variable">RPC_HANDLER</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RpcResponseMessageHandler</span>();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Bootstrap</span> <span class="variable">bootstrap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bootstrap</span>();</span><br><span class="line">            bootstrap.channel(NioSocketChannel.class);</span><br><span class="line">            bootstrap.group(group);</span><br><span class="line">            bootstrap.handler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(SocketChannel ch)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                    ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">ProcotolFrameDecoder</span>());</span><br><span class="line">                    ch.pipeline().addLast(LOGGING_HANDLER);</span><br><span class="line">                    ch.pipeline().addLast(MESSAGE_CODEC);</span><br><span class="line">                    ch.pipeline().addLast(RPC_HANDLER);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> bootstrap.connect(<span class="string">&quot;localhost&quot;</span>, <span class="number">8080</span>).sync().channel();</span><br><span class="line"></span><br><span class="line">            <span class="type">ChannelFuture</span> <span class="variable">future</span> <span class="operator">=</span> channel.writeAndFlush(<span class="keyword">new</span> <span class="title class_">RpcRequestMessage</span>(</span><br><span class="line">                    <span class="number">1</span>,</span><br><span class="line">                    <span class="string">&quot;cn.itcast.server.service.HelloService&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;sayHello&quot;</span>,</span><br><span class="line">                    String.class,</span><br><span class="line">                    <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,</span><br><span class="line">                    <span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;å¼ ä¸‰&quot;</span>&#125;</span><br><span class="line">            )).addListener(promise -&gt; &#123;</span><br><span class="line">                <span class="keyword">if</span> (!promise.isSuccess()) &#123;</span><br><span class="line">                    <span class="type">Throwable</span> <span class="variable">cause</span> <span class="operator">=</span> promise.cause();</span><br><span class="line">                    log.error(<span class="string">&quot;error&quot;</span>, cause);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            channel.closeFuture().sync();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;client error&quot;</span>, e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            group.shutdownGracefully();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4ï¼‰å®¢æˆ·ç«¯-handler-ç¬¬ä¸€ç‰ˆ"><a href="#4ï¼‰å®¢æˆ·ç«¯-handler-ç¬¬ä¸€ç‰ˆ" class="headerlink" title="4ï¼‰å®¢æˆ·ç«¯ handler ç¬¬ä¸€ç‰ˆ"></a>4ï¼‰å®¢æˆ·ç«¯ handler ç¬¬ä¸€ç‰ˆ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@ChannelHandler</span>.Sharable</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RpcResponseMessageHandler</span> <span class="keyword">extends</span> <span class="title class_">SimpleChannelInboundHandler</span>&lt;RpcResponseMessage&gt; &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">channelRead0</span><span class="params">(ChannelHandlerContext ctx, RpcResponseMessage msg)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;&#123;&#125;&quot;</span>, msg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5ï¼‰å®¢æˆ·ç«¯ä»£ç -ç¬¬äºŒç‰ˆ"><a href="#5ï¼‰å®¢æˆ·ç«¯ä»£ç -ç¬¬äºŒç‰ˆ" class="headerlink" title="5ï¼‰å®¢æˆ·ç«¯ä»£ç  ç¬¬äºŒç‰ˆ"></a>5ï¼‰å®¢æˆ·ç«¯ä»£ç  ç¬¬äºŒç‰ˆ</h4><p>åŒ…æ‹¬ channel ç®¡ç†ï¼Œä»£ç†ï¼Œæ¥æ”¶ç»“æœ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RpcClientManager</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">HelloService</span> <span class="variable">service</span> <span class="operator">=</span> getProxyService(HelloService.class);</span><br><span class="line">        System.out.println(service.sayHello(<span class="string">&quot;zhangsan&quot;</span>));</span><br><span class="line"><span class="comment">//        System.out.println(service.sayHello(&quot;lisi&quot;));</span></span><br><span class="line"><span class="comment">//        System.out.println(service.sayHello(&quot;wangwu&quot;));</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºä»£ç†ç±»</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T <span class="title function_">getProxyService</span><span class="params">(Class&lt;T&gt; serviceClass)</span> &#123;</span><br><span class="line">        <span class="type">ClassLoader</span> <span class="variable">loader</span> <span class="operator">=</span> serviceClass.getClassLoader();</span><br><span class="line">        Class&lt;?&gt;[] interfaces = <span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;serviceClass&#125;;</span><br><span class="line">        <span class="comment">//                                                            sayHello  &quot;å¼ ä¸‰&quot;</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> Proxy.newProxyInstance(loader, interfaces, (proxy, method, args) -&gt; &#123;</span><br><span class="line">            <span class="comment">// 1. å°†æ–¹æ³•è°ƒç”¨è½¬æ¢ä¸º æ¶ˆæ¯å¯¹è±¡</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">sequenceId</span> <span class="operator">=</span> SequenceIdGenerator.nextId();</span><br><span class="line">            <span class="type">RpcRequestMessage</span> <span class="variable">msg</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RpcRequestMessage</span>(</span><br><span class="line">                    sequenceId,</span><br><span class="line">                    serviceClass.getName(),</span><br><span class="line">                    method.getName(),</span><br><span class="line">                    method.getReturnType(),</span><br><span class="line">                    method.getParameterTypes(),</span><br><span class="line">                    args</span><br><span class="line">            );</span><br><span class="line">            <span class="comment">// 2. å°†æ¶ˆæ¯å¯¹è±¡å‘é€å‡ºå»</span></span><br><span class="line">            getChannel().writeAndFlush(msg);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 3. å‡†å¤‡ä¸€ä¸ªç©º Promise å¯¹è±¡ï¼Œæ¥æ¥æ”¶ç»“æœ             æŒ‡å®š promise å¯¹è±¡å¼‚æ­¥æ¥æ”¶ç»“æœçº¿ç¨‹</span></span><br><span class="line">            DefaultPromise&lt;Object&gt; promise = <span class="keyword">new</span> <span class="title class_">DefaultPromise</span>&lt;&gt;(getChannel().eventLoop());</span><br><span class="line">            RpcResponseMessageHandler.PROMISES.put(sequenceId, promise);</span><br><span class="line"></span><br><span class="line"><span class="comment">//            promise.addListener(future -&gt; &#123;</span></span><br><span class="line"><span class="comment">//                // çº¿ç¨‹</span></span><br><span class="line"><span class="comment">//            &#125;);</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 4. ç­‰å¾… promise ç»“æœ</span></span><br><span class="line">            promise.await();</span><br><span class="line">            <span class="keyword">if</span>(promise.isSuccess()) &#123;</span><br><span class="line">                <span class="comment">// è°ƒç”¨æ­£å¸¸</span></span><br><span class="line">                <span class="keyword">return</span> promise.getNow();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// è°ƒç”¨å¤±è´¥</span></span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(promise.cause());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> (T) o;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Object</span> <span class="variable">LOCK</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–å”¯ä¸€çš„ channel å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Channel <span class="title function_">getChannel</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (channel != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> channel;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">synchronized</span> (LOCK) &#123; <span class="comment">//  t2</span></span><br><span class="line">            <span class="keyword">if</span> (channel != <span class="literal">null</span>) &#123; <span class="comment">// t1</span></span><br><span class="line">                <span class="keyword">return</span> channel;</span><br><span class="line">            &#125;</span><br><span class="line">            initChannel();</span><br><span class="line">            <span class="keyword">return</span> channel;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ– channel æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">NioEventLoopGroup</span> <span class="variable">group</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioEventLoopGroup</span>();</span><br><span class="line">        <span class="type">LoggingHandler</span> <span class="variable">LOGGING_HANDLER</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LoggingHandler</span>(LogLevel.DEBUG);</span><br><span class="line">        <span class="type">MessageCodecSharable</span> <span class="variable">MESSAGE_CODEC</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MessageCodecSharable</span>();</span><br><span class="line">        <span class="type">RpcResponseMessageHandler</span> <span class="variable">RPC_HANDLER</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RpcResponseMessageHandler</span>();</span><br><span class="line">        <span class="type">Bootstrap</span> <span class="variable">bootstrap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bootstrap</span>();</span><br><span class="line">        bootstrap.channel(NioSocketChannel.class);</span><br><span class="line">        bootstrap.group(group);</span><br><span class="line">        bootstrap.handler(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;SocketChannel&gt;() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(SocketChannel ch)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                ch.pipeline().addLast(<span class="keyword">new</span> <span class="title class_">ProcotolFrameDecoder</span>());</span><br><span class="line">                ch.pipeline().addLast(LOGGING_HANDLER);</span><br><span class="line">                ch.pipeline().addLast(MESSAGE_CODEC);</span><br><span class="line">                ch.pipeline().addLast(RPC_HANDLER);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            channel = bootstrap.connect(<span class="string">&quot;localhost&quot;</span>, <span class="number">8080</span>).sync().channel();</span><br><span class="line">            channel.closeFuture().addListener(future -&gt; &#123;</span><br><span class="line">                group.shutdownGracefully();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;client error&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="6ï¼‰å®¢æˆ·ç«¯-handler-ç¬¬äºŒç‰ˆ"><a href="#6ï¼‰å®¢æˆ·ç«¯-handler-ç¬¬äºŒç‰ˆ" class="headerlink" title="6ï¼‰å®¢æˆ·ç«¯ handler ç¬¬äºŒç‰ˆ"></a>6ï¼‰å®¢æˆ·ç«¯ handler ç¬¬äºŒç‰ˆ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@ChannelHandler</span>.Sharable</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RpcResponseMessageHandler</span> <span class="keyword">extends</span> <span class="title class_">SimpleChannelInboundHandler</span>&lt;RpcResponseMessage&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//                       åºå·      ç”¨æ¥æ¥æ”¶ç»“æœçš„ promise å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Map&lt;Integer, Promise&lt;Object&gt;&gt; PROMISES = <span class="keyword">new</span> <span class="title class_">ConcurrentHashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">channelRead0</span><span class="params">(ChannelHandlerContext ctx, RpcResponseMessage msg)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        log.debug(<span class="string">&quot;&#123;&#125;&quot;</span>, msg);</span><br><span class="line">        <span class="comment">// æ‹¿åˆ°ç©ºçš„ promise</span></span><br><span class="line">        Promise&lt;Object&gt; promise = PROMISES.remove(msg.getSequenceId());</span><br><span class="line">        <span class="keyword">if</span> (promise != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">Object</span> <span class="variable">returnValue</span> <span class="operator">=</span> msg.getReturnValue();</span><br><span class="line">            <span class="type">Exception</span> <span class="variable">exceptionValue</span> <span class="operator">=</span> msg.getExceptionValue();</span><br><span class="line">            <span class="keyword">if</span>(exceptionValue != <span class="literal">null</span>) &#123;</span><br><span class="line">                promise.setFailure(exceptionValue);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                promise.setSuccess(returnValue);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-æºç åˆ†æ"><a href="#2-æºç åˆ†æ" class="headerlink" title="2. æºç åˆ†æ"></a>2. æºç åˆ†æ</h2><h3 id="2-1-å¯åŠ¨å‰–æ"><a href="#2-1-å¯åŠ¨å‰–æ" class="headerlink" title="2.1 å¯åŠ¨å‰–æ"></a>2.1 å¯åŠ¨å‰–æ</h3><p>æˆ‘ä»¬å°±æ¥çœ‹çœ‹ netty ä¸­å¯¹ä¸‹é¢çš„ä»£ç æ˜¯æ€æ ·è¿›è¡Œå¤„ç†çš„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1 netty ä¸­ä½¿ç”¨ NioEventLoopGroup ï¼ˆç®€ç§° nio boss çº¿ç¨‹ï¼‰æ¥å°è£…çº¿ç¨‹å’Œ selector</span></span><br><span class="line"><span class="type">Selector</span> <span class="variable">selector</span> <span class="operator">=</span> Selector.open(); </span><br><span class="line"></span><br><span class="line"><span class="comment">//2 åˆ›å»º NioServerSocketChannelï¼ŒåŒæ—¶ä¼šåˆå§‹åŒ–å®ƒå…³è”çš„ handlerï¼Œä»¥åŠä¸ºåŸç”Ÿ ssc å­˜å‚¨ config</span></span><br><span class="line"><span class="type">NioServerSocketChannel</span> <span class="variable">attachment</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NioServerSocketChannel</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//3 åˆ›å»º NioServerSocketChannel æ—¶ï¼Œåˆ›å»ºäº† java åŸç”Ÿçš„ ServerSocketChannel</span></span><br><span class="line"><span class="type">ServerSocketChannel</span> <span class="variable">serverSocketChannel</span> <span class="operator">=</span> ServerSocketChannel.open(); </span><br><span class="line">serverSocketChannel.configureBlocking(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//4 å¯åŠ¨ nio boss çº¿ç¨‹æ‰§è¡Œæ¥ä¸‹æ¥çš„æ“ä½œ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//5 æ³¨å†Œï¼ˆä»…å…³è” selector å’Œ NioServerSocketChannelï¼‰ï¼Œæœªå…³æ³¨äº‹ä»¶</span></span><br><span class="line"><span class="type">SelectionKey</span> <span class="variable">selectionKey</span> <span class="operator">=</span> serverSocketChannel.register(selector, <span class="number">0</span>, attachment);</span><br><span class="line"></span><br><span class="line"><span class="comment">//6 head -&gt; åˆå§‹åŒ–å™¨ -&gt; ServerBootstrapAcceptor -&gt; tailï¼Œåˆå§‹åŒ–å™¨æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œåªä¸ºæ·»åŠ  acceptor</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//7 ç»‘å®šç«¯å£</span></span><br><span class="line">serverSocketChannel.bind(<span class="keyword">new</span> <span class="title class_">InetSocketAddress</span>(<span class="number">8080</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//8 è§¦å‘ channel active äº‹ä»¶ï¼Œåœ¨ head ä¸­å…³æ³¨ op_accept äº‹ä»¶</span></span><br><span class="line">selectionKey.interestOps(SelectionKey.OP_ACCEPT);</span><br></pre></td></tr></table></figure><p>å…¥å£ <code>io.netty.bootstrap.ServerBootstrap#bind</code></p><p>å…³é”®ä»£ç  <code>io.netty.bootstrap.AbstractBootstrap#doBind</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> ChannelFuture <span class="title function_">doBind</span><span class="params">(<span class="keyword">final</span> SocketAddress localAddress)</span> &#123;</span><br><span class="line"><span class="comment">// 1. æ‰§è¡Œåˆå§‹åŒ–å’Œæ³¨å†Œ regFuture ä¼šç”± initAndRegister è®¾ç½®å…¶æ˜¯å¦å®Œæˆï¼Œä»è€Œå›è°ƒ 3.2 å¤„ä»£ç </span></span><br><span class="line">    <span class="keyword">final</span> <span class="type">ChannelFuture</span> <span class="variable">regFuture</span> <span class="operator">=</span> initAndRegister();</span><br><span class="line">    <span class="keyword">final</span> <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> regFuture.channel();</span><br><span class="line">    <span class="keyword">if</span> (regFuture.cause() != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> regFuture;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2. å› ä¸ºæ˜¯ initAndRegister å¼‚æ­¥æ‰§è¡Œï¼Œéœ€è¦åˆ†ä¸¤ç§æƒ…å†µæ¥çœ‹ï¼Œè°ƒè¯•æ—¶ä¹Ÿéœ€è¦é€šè¿‡ suspend æ–­ç‚¹ç±»å‹åŠ ä»¥åŒºåˆ†</span></span><br><span class="line">    <span class="comment">// 2.1 å¦‚æœå·²ç»å®Œæˆ</span></span><br><span class="line">    <span class="keyword">if</span> (regFuture.isDone()) &#123;</span><br><span class="line">        <span class="type">ChannelPromise</span> <span class="variable">promise</span> <span class="operator">=</span> channel.newPromise();</span><br><span class="line">        <span class="comment">// 3.1 ç«‹åˆ»è°ƒç”¨ doBind0</span></span><br><span class="line">        doBind0(regFuture, channel, localAddress, promise);</span><br><span class="line">        <span class="keyword">return</span> promise;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="comment">// 2.2 è¿˜æ²¡æœ‰å®Œæˆ</span></span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">PendingRegistrationPromise</span> <span class="variable">promise</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PendingRegistrationPromise</span>(channel);</span><br><span class="line">        <span class="comment">// 3.2 å›è°ƒ doBind0</span></span><br><span class="line">        regFuture.addListener(<span class="keyword">new</span> <span class="title class_">ChannelFutureListener</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">operationComplete</span><span class="params">(ChannelFuture future)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                <span class="type">Throwable</span> <span class="variable">cause</span> <span class="operator">=</span> future.cause();</span><br><span class="line">                <span class="keyword">if</span> (cause != <span class="literal">null</span>) &#123;</span><br><span class="line">                    <span class="comment">// å¤„ç†å¼‚å¸¸...</span></span><br><span class="line">                    promise.setFailure(cause);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    promise.registered();</span><br><span class="line"><span class="comment">// 3. ç”±æ³¨å†Œçº¿ç¨‹å»æ‰§è¡Œ doBind0</span></span><br><span class="line">                    doBind0(regFuture, channel, localAddress, promise);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> promise;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³é”®ä»£ç  <code>io.netty.bootstrap.AbstractBootstrap#initAndRegister</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> ChannelFuture <span class="title function_">initAndRegister</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        channel = channelFactory.newChannel();</span><br><span class="line">        <span class="comment">// 1.1 åˆå§‹åŒ– - åšçš„äº‹å°±æ˜¯æ·»åŠ ä¸€ä¸ªåˆå§‹åŒ–å™¨ ChannelInitializer</span></span><br><span class="line">        init(channel);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable t) &#123;</span><br><span class="line">        <span class="comment">// å¤„ç†å¼‚å¸¸...</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DefaultChannelPromise</span>(<span class="keyword">new</span> <span class="title class_">FailedChannel</span>(), GlobalEventExecutor.INSTANCE).setFailure(t);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1.2 æ³¨å†Œ - åšçš„äº‹å°±æ˜¯å°†åŸç”Ÿ channel æ³¨å†Œåˆ° selector ä¸Š</span></span><br><span class="line">    <span class="type">ChannelFuture</span> <span class="variable">regFuture</span> <span class="operator">=</span> config().group().register(channel);</span><br><span class="line">    <span class="keyword">if</span> (regFuture.cause() != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// å¤„ç†å¼‚å¸¸...</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> regFuture;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³é”®ä»£ç  <code>io.netty.bootstrap.ServerBootstrap#init</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™é‡Œ channel å®é™…ä¸Šæ˜¯ NioServerSocketChannel</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">init</span><span class="params">(Channel channel)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="keyword">final</span> Map&lt;ChannelOption&lt;?&gt;, Object&gt; options = options0();</span><br><span class="line">    <span class="keyword">synchronized</span> (options) &#123;</span><br><span class="line">        setChannelOptions(channel, options, logger);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> Map&lt;AttributeKey&lt;?&gt;, Object&gt; attrs = attrs0();</span><br><span class="line">    <span class="keyword">synchronized</span> (attrs) &#123;</span><br><span class="line">        <span class="keyword">for</span> (Entry&lt;AttributeKey&lt;?&gt;, Object&gt; e: attrs.entrySet()) &#123;</span><br><span class="line">            <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">            AttributeKey&lt;Object&gt; key = (AttributeKey&lt;Object&gt;) e.getKey();</span><br><span class="line">            channel.attr(key).set(e.getValue());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">ChannelPipeline</span> <span class="variable">p</span> <span class="operator">=</span> channel.pipeline();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="type">EventLoopGroup</span> <span class="variable">currentChildGroup</span> <span class="operator">=</span> childGroup;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">ChannelHandler</span> <span class="variable">currentChildHandler</span> <span class="operator">=</span> childHandler;</span><br><span class="line">    <span class="keyword">final</span> Entry&lt;ChannelOption&lt;?&gt;, Object&gt;[] currentChildOptions;</span><br><span class="line">    <span class="keyword">final</span> Entry&lt;AttributeKey&lt;?&gt;, Object&gt;[] currentChildAttrs;</span><br><span class="line">    <span class="keyword">synchronized</span> (childOptions) &#123;</span><br><span class="line">        currentChildOptions = childOptions.entrySet().toArray(newOptionArray(<span class="number">0</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">synchronized</span> (childAttrs) &#123;</span><br><span class="line">        currentChildAttrs = childAttrs.entrySet().toArray(newAttrArray(<span class="number">0</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸º NioServerSocketChannel æ·»åŠ åˆå§‹åŒ–å™¨</span></span><br><span class="line">    p.addLast(<span class="keyword">new</span> <span class="title class_">ChannelInitializer</span>&lt;Channel&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initChannel</span><span class="params">(<span class="keyword">final</span> Channel ch)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">            <span class="keyword">final</span> <span class="type">ChannelPipeline</span> <span class="variable">pipeline</span> <span class="operator">=</span> ch.pipeline();</span><br><span class="line">            <span class="type">ChannelHandler</span> <span class="variable">handler</span> <span class="operator">=</span> config.handler();</span><br><span class="line">            <span class="keyword">if</span> (handler != <span class="literal">null</span>) &#123;</span><br><span class="line">                pipeline.addLast(handler);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// åˆå§‹åŒ–å™¨çš„èŒè´£æ˜¯å°† ServerBootstrapAcceptor åŠ å…¥è‡³ NioServerSocketChannel</span></span><br><span class="line">            ch.eventLoop().execute(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                    pipeline.addLast(<span class="keyword">new</span> <span class="title class_">ServerBootstrapAcceptor</span>(</span><br><span class="line">                            ch, currentChildGroup, currentChildHandler, currentChildOptions, currentChildAttrs));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³é”®ä»£ç  <code>io.netty.channel.AbstractChannel.AbstractUnsafe#register</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">register</span><span class="params">(EventLoop eventLoop, <span class="keyword">final</span> ChannelPromise promise)</span> &#123;</span><br><span class="line">    <span class="comment">// ä¸€äº›æ£€æŸ¥ï¼Œç•¥...</span></span><br><span class="line"></span><br><span class="line">    AbstractChannel.<span class="built_in">this</span>.eventLoop = eventLoop;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (eventLoop.inEventLoop()) &#123;</span><br><span class="line">        register0(promise);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// é¦–æ¬¡æ‰§è¡Œ execute æ–¹æ³•æ—¶ï¼Œä¼šå¯åŠ¨ nio çº¿ç¨‹ï¼Œä¹‹åæ³¨å†Œç­‰æ“ä½œåœ¨ nio çº¿ç¨‹ä¸Šæ‰§è¡Œ</span></span><br><span class="line">            <span class="comment">// å› ä¸ºåªæœ‰ä¸€ä¸ª NioServerSocketChannel å› æ­¤ï¼Œä¹Ÿåªä¼šæœ‰ä¸€ä¸ª boss nio çº¿ç¨‹</span></span><br><span class="line">            <span class="comment">// è¿™è¡Œä»£ç å®Œæˆçš„äº‹å®æ˜¯ main -&gt; nio boss çº¿ç¨‹çš„åˆ‡æ¢</span></span><br><span class="line">            eventLoop.execute(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                    register0(promise);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable t) &#123;</span><br><span class="line">            <span class="comment">// æ—¥å¿—è®°å½•...</span></span><br><span class="line">            closeForcibly();</span><br><span class="line">            closeFuture.setClosed();</span><br><span class="line">            safeSetFailure(promise, t);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>io.netty.channel.AbstractChannel.AbstractUnsafe#register0</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">register0</span><span class="params">(ChannelPromise promise)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!promise.setUncancellable() || !ensureOpen(promise)) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">firstRegistration</span> <span class="operator">=</span> neverRegistered;</span><br><span class="line">        <span class="comment">// 1.2.1 åŸç”Ÿçš„ nio channel ç»‘å®šåˆ° selector ä¸Šï¼Œæ³¨æ„æ­¤æ—¶æ²¡æœ‰æ³¨å†Œ selector å…³æ³¨äº‹ä»¶ï¼Œé™„ä»¶ä¸º NioServerSocketChannel</span></span><br><span class="line">        doRegister();</span><br><span class="line">        neverRegistered = <span class="literal">false</span>;</span><br><span class="line">        registered = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1.2.2 æ‰§è¡Œ NioServerSocketChannel åˆå§‹åŒ–å™¨çš„ initChannel</span></span><br><span class="line">        pipeline.invokeHandlerAddedIfNeeded();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å›è°ƒ 3.2 io.netty.bootstrap.AbstractBootstrap#doBind0</span></span><br><span class="line">        safeSetSuccess(promise);</span><br><span class="line">        pipeline.fireChannelRegistered();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å¯¹åº” server socket channel è¿˜æœªç»‘å®šï¼ŒisActive ä¸º false</span></span><br><span class="line">        <span class="keyword">if</span> (isActive()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (firstRegistration) &#123;</span><br><span class="line">                pipeline.fireChannelActive();</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (config().isAutoRead()) &#123;</span><br><span class="line">                beginRead();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable t) &#123;</span><br><span class="line">        <span class="comment">// Close the channel directly to avoid FD leak.</span></span><br><span class="line">        closeForcibly();</span><br><span class="line">        closeFuture.setClosed();</span><br><span class="line">        safeSetFailure(promise, t);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³é”®ä»£ç  <code>io.netty.channel.ChannelInitializer#initChannel</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">initChannel</span><span class="params">(ChannelHandlerContext ctx)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="keyword">if</span> (initMap.add(ctx)) &#123; <span class="comment">// Guard against re-entrance.</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 1.2.2.1 æ‰§è¡Œåˆå§‹åŒ–</span></span><br><span class="line">            initChannel((C) ctx.channel());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable cause) &#123;</span><br><span class="line">            exceptionCaught(ctx, cause);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="comment">// 1.2.2.2 ç§»é™¤åˆå§‹åŒ–å™¨</span></span><br><span class="line">            <span class="type">ChannelPipeline</span> <span class="variable">pipeline</span> <span class="operator">=</span> ctx.pipeline();</span><br><span class="line">            <span class="keyword">if</span> (pipeline.context(<span class="built_in">this</span>) != <span class="literal">null</span>) &#123;</span><br><span class="line">                pipeline.remove(<span class="built_in">this</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³é”®ä»£ç  <code>io.netty.bootstrap.AbstractBootstrap#doBind0</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 3.1 æˆ– 3.2 æ‰§è¡Œ doBind0</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">doBind0</span><span class="params">(</span></span><br><span class="line"><span class="params">        <span class="keyword">final</span> ChannelFuture regFuture, <span class="keyword">final</span> Channel channel,</span></span><br><span class="line"><span class="params">        <span class="keyword">final</span> SocketAddress localAddress, <span class="keyword">final</span> ChannelPromise promise)</span> &#123;</span><br><span class="line"></span><br><span class="line">    channel.eventLoop().execute(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (regFuture.isSuccess()) &#123;</span><br><span class="line">                channel.bind(localAddress, promise).addListener(ChannelFutureListener.CLOSE_ON_FAILURE);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                promise.setFailure(regFuture.cause());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³é”®ä»£ç  <code>io.netty.channel.AbstractChannel.AbstractUnsafe#bind</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">bind</span><span class="params">(<span class="keyword">final</span> SocketAddress localAddress, <span class="keyword">final</span> ChannelPromise promise)</span> &#123;</span><br><span class="line">    assertEventLoop();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!promise.setUncancellable() || !ensureOpen(promise)) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (Boolean.TRUE.equals(config().getOption(ChannelOption.SO_BROADCAST)) &amp;&amp;</span><br><span class="line">        localAddress <span class="keyword">instanceof</span> InetSocketAddress &amp;&amp;</span><br><span class="line">        !((InetSocketAddress) localAddress).getAddress().isAnyLocalAddress() &amp;&amp;</span><br><span class="line">        !PlatformDependent.isWindows() &amp;&amp; !PlatformDependent.maybeSuperUser()) &#123;</span><br><span class="line">        <span class="comment">// è®°å½•æ—¥å¿—...</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">wasActive</span> <span class="operator">=</span> isActive();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 3.3 æ‰§è¡Œç«¯å£ç»‘å®š</span></span><br><span class="line">        doBind(localAddress);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable t) &#123;</span><br><span class="line">        safeSetFailure(promise, t);</span><br><span class="line">        closeIfClosed();</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!wasActive &amp;&amp; isActive()) &#123;</span><br><span class="line">        invokeLater(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                <span class="comment">// 3.4 è§¦å‘ active äº‹ä»¶</span></span><br><span class="line">                pipeline.fireChannelActive();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    safeSetSuccess(promise);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.3 å…³é”®ä»£ç  <code>io.netty.channel.socket.nio.NioServerSocketChannel#doBind</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doBind</span><span class="params">(SocketAddress localAddress)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="keyword">if</span> (PlatformDependent.javaVersion() &gt;= <span class="number">7</span>) &#123;</span><br><span class="line">        javaChannel().bind(localAddress, config.getBacklog());</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        javaChannel().socket().bind(localAddress, config.getBacklog());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3.4 å…³é”®ä»£ç  <code>io.netty.channel.DefaultChannelPipeline.HeadContext#channelActive</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">channelActive</span><span class="params">(ChannelHandlerContext ctx)</span> &#123;</span><br><span class="line">    ctx.fireChannelActive();</span><br><span class="line"><span class="comment">// è§¦å‘ read (NioServerSocketChannel ä¸Šçš„ read ä¸æ˜¯è¯»å–æ•°æ®ï¼Œåªæ˜¯ä¸ºäº†è§¦å‘ channel çš„äº‹ä»¶æ³¨å†Œ)</span></span><br><span class="line">    readIfIsAutoRead();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³é”®ä»£ç  <code>io.netty.channel.nio.AbstractNioChannel#doBeginRead</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doBeginRead</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="comment">// Channel.read() or ChannelHandlerContext.read() was called</span></span><br><span class="line">    <span class="keyword">final</span> <span class="type">SelectionKey</span> <span class="variable">selectionKey</span> <span class="operator">=</span> <span class="built_in">this</span>.selectionKey;</span><br><span class="line">    <span class="keyword">if</span> (!selectionKey.isValid()) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    readPending = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span> <span class="variable">interestOps</span> <span class="operator">=</span> selectionKey.interestOps();</span><br><span class="line">    <span class="comment">// readInterestOp å–å€¼æ˜¯ 16ï¼Œåœ¨ NioServerSocketChannel åˆ›å»ºæ—¶åˆå§‹åŒ–å¥½ï¼Œä»£è¡¨å…³æ³¨ accept äº‹ä»¶</span></span><br><span class="line">    <span class="keyword">if</span> ((interestOps &amp; readInterestOp) == <span class="number">0</span>) &#123;</span><br><span class="line">        selectionKey.interestOps(interestOps | readInterestOp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-2-NioEventLoop-å‰–æ"><a href="#2-2-NioEventLoop-å‰–æ" class="headerlink" title="2.2 NioEventLoop å‰–æ"></a>2.2 NioEventLoop å‰–æ</h3><p>NioEventLoop çº¿ç¨‹ä¸ä»…è¦å¤„ç† IO äº‹ä»¶ï¼Œè¿˜è¦å¤„ç† Taskï¼ˆåŒ…æ‹¬æ™®é€šä»»åŠ¡å’Œå®šæ—¶ä»»åŠ¡ï¼‰ï¼Œ</p><p>æäº¤ä»»åŠ¡ä»£ç  <code>io.netty.util.concurrent.SingleThreadEventExecutor#execute</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">execute</span><span class="params">(Runnable task)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (task == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NullPointerException</span>(<span class="string">&quot;task&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">inEventLoop</span> <span class="operator">=</span> inEventLoop();</span><br><span class="line">    <span class="comment">// æ·»åŠ ä»»åŠ¡ï¼Œå…¶ä¸­é˜Ÿåˆ—ä½¿ç”¨äº† jctools æä¾›çš„ mpsc æ— é”é˜Ÿåˆ—</span></span><br><span class="line">    addTask(task);</span><br><span class="line">    <span class="keyword">if</span> (!inEventLoop) &#123;</span><br><span class="line">        <span class="comment">// inEventLoop å¦‚æœä¸º false è¡¨ç¤ºç”±å…¶å®ƒçº¿ç¨‹æ¥è°ƒç”¨ executeï¼Œå³é¦–æ¬¡è°ƒç”¨ï¼Œè¿™æ—¶éœ€è¦å‘ eventLoop æäº¤é¦–ä¸ªä»»åŠ¡ï¼Œå¯åŠ¨æ­»å¾ªç¯ï¼Œä¼šæ‰§è¡Œåˆ°ä¸‹é¢çš„ doStartThread</span></span><br><span class="line">        startThread();</span><br><span class="line">        <span class="keyword">if</span> (isShutdown()) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœå·²ç» shutdownï¼Œåšæ‹’ç»é€»è¾‘ï¼Œä»£ç ç•¥...</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!addTaskWakesUp &amp;&amp; wakesUpForTask(task)) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœçº¿ç¨‹ç”±äº IO select é˜»å¡äº†ï¼Œæ·»åŠ çš„ä»»åŠ¡çš„çº¿ç¨‹éœ€è¦è´Ÿè´£å”¤é†’ NioEventLoop çº¿ç¨‹</span></span><br><span class="line">        wakeup(inEventLoop);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å”¤é†’ select é˜»å¡çº¿ç¨‹<code>io.netty.channel.nio.NioEventLoop#wakeup</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">wakeup</span><span class="params">(<span class="type">boolean</span> inEventLoop)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!inEventLoop &amp;&amp; wakenUp.compareAndSet(<span class="literal">false</span>, <span class="literal">true</span>)) &#123;</span><br><span class="line">        selector.wakeup();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯åŠ¨ EventLoop ä¸»å¾ªç¯ <code>io.netty.util.concurrent.SingleThreadEventExecutor#doStartThread</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">doStartThread</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">assert</span> thread == <span class="literal">null</span>;</span><br><span class="line">    executor.execute(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="comment">// å°†çº¿ç¨‹æ± çš„å½“å‰çº¿ç¨‹ä¿å­˜åœ¨æˆå‘˜å˜é‡ä¸­ï¼Œä»¥ä¾¿åç»­ä½¿ç”¨</span></span><br><span class="line">            thread = Thread.currentThread();</span><br><span class="line">            <span class="keyword">if</span> (interrupted) &#123;</span><br><span class="line">                thread.interrupt();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="type">boolean</span> <span class="variable">success</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">            updateLastExecutionTime();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">// è°ƒç”¨å¤–éƒ¨ç±» SingleThreadEventExecutor çš„ run æ–¹æ³•ï¼Œè¿›å…¥æ­»å¾ªç¯ï¼Œrun æ–¹æ³•è§ä¸‹</span></span><br><span class="line">                SingleThreadEventExecutor.<span class="built_in">this</span>.run();</span><br><span class="line">                success = <span class="literal">true</span>;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Throwable t) &#123;</span><br><span class="line">                logger.warn(<span class="string">&quot;Unexpected exception from an event executor: &quot;</span>, t);</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line"><span class="comment">// æ¸…ç†å·¥ä½œï¼Œä»£ç ç•¥...</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>io.netty.channel.nio.NioEventLoop#run</code> ä¸»è¦ä»»åŠ¡æ˜¯æ‰§è¡Œæ­»å¾ªç¯ï¼Œä¸æ–­çœ‹æœ‰æ²¡æœ‰æ–°ä»»åŠ¡ï¼Œæœ‰æ²¡æœ‰ IO äº‹ä»¶</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">// calculateStrategy çš„é€»è¾‘å¦‚ä¸‹ï¼š</span></span><br><span class="line">                <span class="comment">// æœ‰ä»»åŠ¡ï¼Œä¼šæ‰§è¡Œä¸€æ¬¡ selectNowï¼Œæ¸…é™¤ä¸Šä¸€æ¬¡çš„ wakeup ç»“æœï¼Œæ— è®ºæœ‰æ²¡æœ‰ IO äº‹ä»¶ï¼Œéƒ½ä¼šè·³è¿‡ switch</span></span><br><span class="line">                <span class="comment">// æ²¡æœ‰ä»»åŠ¡ï¼Œä¼šåŒ¹é… SelectStrategy.SELECTï¼Œçœ‹æ˜¯å¦åº”å½“é˜»å¡</span></span><br><span class="line">                <span class="keyword">switch</span> (selectStrategy.calculateStrategy(selectNowSupplier, hasTasks())) &#123;</span><br><span class="line">                    <span class="keyword">case</span> SelectStrategy.CONTINUE:</span><br><span class="line">                        <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">case</span> SelectStrategy.BUSY_WAIT:</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">case</span> SelectStrategy.SELECT:</span><br><span class="line">                        <span class="comment">// å› ä¸º IO çº¿ç¨‹å’Œæäº¤ä»»åŠ¡çº¿ç¨‹éƒ½æœ‰å¯èƒ½æ‰§è¡Œ wakeupï¼Œè€Œ wakeup å±äºæ¯”è¾ƒæ˜‚è´µçš„æ“ä½œï¼Œå› æ­¤ä½¿ç”¨äº†ä¸€ä¸ªåŸå­å¸ƒå°”å¯¹è±¡ wakenUpï¼Œå®ƒå–å€¼ä¸º true æ—¶ï¼Œè¡¨ç¤ºè¯¥ç”±å½“å‰çº¿ç¨‹å”¤é†’</span></span><br><span class="line">                        <span class="comment">// è¿›è¡Œ select é˜»å¡ï¼Œå¹¶è®¾ç½®å”¤é†’çŠ¶æ€ä¸º false</span></span><br><span class="line">                        <span class="type">boolean</span> <span class="variable">oldWakenUp</span> <span class="operator">=</span> wakenUp.getAndSet(<span class="literal">false</span>);</span><br><span class="line">                        </span><br><span class="line">                        <span class="comment">// å¦‚æœåœ¨è¿™ä¸ªä½ç½®ï¼Œé EventLoop çº¿ç¨‹æŠ¢å…ˆå°† wakenUp ç½®ä¸º trueï¼Œå¹¶ wakeup</span></span><br><span class="line">                        <span class="comment">// ä¸‹é¢çš„ select æ–¹æ³•ä¸ä¼šé˜»å¡</span></span><br><span class="line">                        <span class="comment">// ç­‰ runAllTasks å¤„ç†å®Œæˆåï¼Œåˆ°å†å¾ªç¯è¿›æ¥è¿™ä¸ªé˜¶æ®µæ–°å¢çš„ä»»åŠ¡ä¼šä¸ä¼šåŠæ—¶æ‰§è¡Œå‘¢?</span></span><br><span class="line">                        <span class="comment">// å› ä¸º oldWakenUp ä¸º trueï¼Œå› æ­¤ä¸‹é¢çš„ select æ–¹æ³•å°±ä¼šé˜»å¡ï¼Œç›´åˆ°è¶…æ—¶</span></span><br><span class="line">                        <span class="comment">// æ‰èƒ½æ‰§è¡Œï¼Œè®© select æ–¹æ³•æ— è°“é˜»å¡</span></span><br><span class="line">                        select(oldWakenUp);</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span> (wakenUp.get()) &#123;</span><br><span class="line">                            selector.wakeup();</span><br><span class="line">                        &#125;</span><br><span class="line">                    <span class="keyword">default</span>:</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                rebuildSelector0();</span><br><span class="line">                handleLoopException(e);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            cancelledKeys = <span class="number">0</span>;</span><br><span class="line">            needsToSelectAgain = <span class="literal">false</span>;</span><br><span class="line">            <span class="comment">// ioRatio é»˜è®¤æ˜¯ 50</span></span><br><span class="line">            <span class="keyword">final</span> <span class="type">int</span> <span class="variable">ioRatio</span> <span class="operator">=</span> <span class="built_in">this</span>.ioRatio;</span><br><span class="line">            <span class="keyword">if</span> (ioRatio == <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    processSelectedKeys();</span><br><span class="line">                &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                    <span class="comment">// ioRatio ä¸º 100 æ—¶ï¼Œæ€»æ˜¯è¿è¡Œå®Œæ‰€æœ‰é IO ä»»åŠ¡</span></span><br><span class="line">                    runAllTasks();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;                </span><br><span class="line">                <span class="keyword">final</span> <span class="type">long</span> <span class="variable">ioStartTime</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    processSelectedKeys();</span><br><span class="line">                &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                    <span class="comment">// è®°å½• io äº‹ä»¶å¤„ç†è€—æ—¶</span></span><br><span class="line">                    <span class="keyword">final</span> <span class="type">long</span> <span class="variable">ioTime</span> <span class="operator">=</span> System.nanoTime() - ioStartTime;</span><br><span class="line">                    <span class="comment">// è¿è¡Œé IO ä»»åŠ¡ï¼Œä¸€æ—¦è¶…æ—¶ä¼šé€€å‡º runAllTasks</span></span><br><span class="line">                    runAllTasks(ioTime * (<span class="number">100</span> - ioRatio) / ioRatio);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable t) &#123;</span><br><span class="line">            handleLoopException(t);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (isShuttingDown()) &#123;</span><br><span class="line">                closeAll();</span><br><span class="line">                <span class="keyword">if</span> (confirmShutdown()) &#123;</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable t) &#123;</span><br><span class="line">            handleLoopException(t);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="âš ï¸-æ³¨æ„"><a href="#âš ï¸-æ³¨æ„" class="headerlink" title="âš ï¸ æ³¨æ„"></a>âš ï¸ æ³¨æ„</h4><blockquote><p>è¿™é‡Œæœ‰ä¸ªè´¹è§£çš„åœ°æ–¹å°±æ˜¯ wakeupï¼Œå®ƒæ—¢å¯ä»¥ç”±æäº¤ä»»åŠ¡çš„çº¿ç¨‹æ¥è°ƒç”¨ï¼ˆæ¯”è¾ƒå¥½ç†è§£ï¼‰ï¼Œä¹Ÿå¯ä»¥ç”± EventLoop çº¿ç¨‹æ¥è°ƒç”¨ï¼ˆæ¯”è¾ƒè´¹è§£ï¼‰ï¼Œè¿™é‡Œè¦çŸ¥é“ wakeup æ–¹æ³•çš„æ•ˆæœï¼š</p><ul><li>ç”±é EventLoop çº¿ç¨‹è°ƒç”¨ï¼Œä¼šå”¤é†’å½“å‰åœ¨æ‰§è¡Œ select é˜»å¡çš„ EventLoop çº¿ç¨‹</li><li>ç”± EventLoop è‡ªå·±è°ƒç”¨ï¼Œä¼šæœ¬æ¬¡çš„ wakeup ä¼šå–æ¶ˆä¸‹ä¸€æ¬¡çš„ select æ“ä½œ</li></ul></blockquote><p>å‚è€ƒä¸‹å›¾</p><img src="img/0032.png"  /><p><code>io.netty.channel.nio.NioEventLoop#select</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">select</span><span class="params">(<span class="type">boolean</span> oldWakenUp)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="type">Selector</span> <span class="variable">selector</span> <span class="operator">=</span> <span class="built_in">this</span>.selector;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">selectCnt</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">long</span> <span class="variable">currentTimeNanos</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line">        <span class="comment">// è®¡ç®—ç­‰å¾…æ—¶é—´</span></span><br><span class="line">        <span class="comment">// * æ²¡æœ‰ scheduledTaskï¼Œè¶…æ—¶æ—¶é—´ä¸º 1s</span></span><br><span class="line">        <span class="comment">// * æœ‰ scheduledTaskï¼Œè¶…æ—¶æ—¶é—´ä¸º `ä¸‹ä¸€ä¸ªå®šæ—¶ä»»åŠ¡æ‰§è¡Œæ—¶é—´ - å½“å‰æ—¶é—´`</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">selectDeadLineNanos</span> <span class="operator">=</span> currentTimeNanos + delayNanos(currentTimeNanos);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">            <span class="type">long</span> <span class="variable">timeoutMillis</span> <span class="operator">=</span> (selectDeadLineNanos - currentTimeNanos + <span class="number">500000L</span>) / <span class="number">1000000L</span>;</span><br><span class="line">            <span class="comment">// å¦‚æœè¶…æ—¶ï¼Œé€€å‡ºå¾ªç¯</span></span><br><span class="line">            <span class="keyword">if</span> (timeoutMillis &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (selectCnt == <span class="number">0</span>) &#123;</span><br><span class="line">                    selector.selectNow();</span><br><span class="line">                    selectCnt = <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å¦‚æœæœŸé—´åˆæœ‰ task é€€å‡ºå¾ªç¯ï¼Œå¦‚æœæ²¡è¿™ä¸ªåˆ¤æ–­ï¼Œé‚£ä¹ˆä»»åŠ¡å°±ä¼šç­‰åˆ°ä¸‹æ¬¡ select è¶…æ—¶æ—¶æ‰èƒ½è¢«æ‰§è¡Œ</span></span><br><span class="line">            <span class="comment">// wakenUp.compareAndSet(false, true) æ˜¯è®©é NioEventLoop ä¸å¿…å†æ‰§è¡Œ wakeup</span></span><br><span class="line">            <span class="keyword">if</span> (hasTasks() &amp;&amp; wakenUp.compareAndSet(<span class="literal">false</span>, <span class="literal">true</span>)) &#123;</span><br><span class="line">                selector.selectNow();</span><br><span class="line">                selectCnt = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// select æœ‰é™æ—¶é˜»å¡</span></span><br><span class="line">            <span class="comment">// æ³¨æ„ nio æœ‰ bugï¼Œå½“ bug å‡ºç°æ—¶ï¼Œselect æ–¹æ³•å³ä½¿æ²¡æœ‰æ—¶é—´å‘ç”Ÿï¼Œä¹Ÿä¸ä¼šé˜»å¡ä½ï¼Œå¯¼è‡´ä¸æ–­ç©ºè½®è¯¢ï¼Œcpu å ç”¨ 100%</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">selectedKeys</span> <span class="operator">=</span> selector.select(timeoutMillis);</span><br><span class="line">            <span class="comment">// è®¡æ•°åŠ  1</span></span><br><span class="line">            selectCnt ++;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// é†’æ¥åï¼Œå¦‚æœæœ‰ IO äº‹ä»¶ã€æˆ–æ˜¯ç”±é EventLoop çº¿ç¨‹å”¤é†’ï¼Œæˆ–è€…æœ‰ä»»åŠ¡ï¼Œé€€å‡ºå¾ªç¯</span></span><br><span class="line">            <span class="keyword">if</span> (selectedKeys != <span class="number">0</span> || oldWakenUp || wakenUp.get() || hasTasks() || hasScheduledTasks()) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (Thread.interrupted()) &#123;</span><br><span class="line">               <span class="comment">// çº¿ç¨‹è¢«æ‰“æ–­ï¼Œé€€å‡ºå¾ªç¯</span></span><br><span class="line">                <span class="comment">// è®°å½•æ—¥å¿—</span></span><br><span class="line">                selectCnt = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="type">long</span> <span class="variable">time</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line">            <span class="keyword">if</span> (time - TimeUnit.MILLISECONDS.toNanos(timeoutMillis) &gt;= currentTimeNanos) &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœè¶…æ—¶ï¼Œè®¡æ•°é‡ç½®ä¸º 1ï¼Œä¸‹æ¬¡å¾ªç¯å°±ä¼š break</span></span><br><span class="line">                selectCnt = <span class="number">1</span>;</span><br><span class="line">            &#125; </span><br><span class="line">            <span class="comment">// è®¡æ•°è¶…è¿‡é˜ˆå€¼ï¼Œç”± io.netty.selectorAutoRebuildThreshold æŒ‡å®šï¼Œé»˜è®¤ 512</span></span><br><span class="line">            <span class="comment">// è¿™æ˜¯ä¸ºäº†è§£å†³ nio ç©ºè½®è¯¢ bug</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (SELECTOR_AUTO_REBUILD_THRESHOLD &gt; <span class="number">0</span> &amp;&amp;</span><br><span class="line">                    selectCnt &gt;= SELECTOR_AUTO_REBUILD_THRESHOLD) &#123;</span><br><span class="line">                <span class="comment">// é‡å»º selector</span></span><br><span class="line">                selector = selectRebuildSelector(selectCnt);</span><br><span class="line">                selectCnt = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            currentTimeNanos = time;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (selectCnt &gt; MIN_PREMATURE_SELECTOR_RETURNS) &#123;</span><br><span class="line">            <span class="comment">// è®°å½•æ—¥å¿—</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (CancelledKeyException e) &#123;</span><br><span class="line">        <span class="comment">// è®°å½•æ—¥å¿—</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤„ç† keys <code>io.netty.channel.nio.NioEventLoop#processSelectedKeys</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">processSelectedKeys</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (selectedKeys != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="comment">// é€šè¿‡åå°„å°† Selector å®ç°ç±»ä¸­çš„å°±ç»ªäº‹ä»¶é›†åˆæ›¿æ¢ä¸º SelectedSelectionKeySet </span></span><br><span class="line">        <span class="comment">// SelectedSelectionKeySet åº•å±‚ä¸ºæ•°ç»„å®ç°ï¼Œå¯ä»¥æé«˜éå†æ€§èƒ½ï¼ˆåŸæœ¬ä¸º HashSetï¼‰</span></span><br><span class="line">        processSelectedKeysOptimized();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        processSelectedKeysPlain(selector.selectedKeys());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>io.netty.channel.nio.NioEventLoop#processSelectedKey</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">processSelectedKey</span><span class="params">(SelectionKey k, AbstractNioChannel ch)</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> AbstractNioChannel.<span class="type">NioUnsafe</span> <span class="variable">unsafe</span> <span class="operator">=</span> ch.unsafe();</span><br><span class="line">    <span class="comment">// å½“ key å–æ¶ˆæˆ–å…³é—­æ—¶ä¼šå¯¼è‡´è¿™ä¸ª key æ— æ•ˆ</span></span><br><span class="line">    <span class="keyword">if</span> (!k.isValid()) &#123;</span><br><span class="line">        <span class="comment">// æ— æ•ˆæ—¶å¤„ç†...</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">readyOps</span> <span class="operator">=</span> k.readyOps();</span><br><span class="line">        <span class="comment">// è¿æ¥äº‹ä»¶</span></span><br><span class="line">        <span class="keyword">if</span> ((readyOps &amp; SelectionKey.OP_CONNECT) != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">ops</span> <span class="operator">=</span> k.interestOps();</span><br><span class="line">            ops &amp;= ~SelectionKey.OP_CONNECT;</span><br><span class="line">            k.interestOps(ops);</span><br><span class="line"></span><br><span class="line">            unsafe.finishConnect();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¯å†™äº‹ä»¶</span></span><br><span class="line">        <span class="keyword">if</span> ((readyOps &amp; SelectionKey.OP_WRITE) != <span class="number">0</span>) &#123;</span><br><span class="line">            ch.unsafe().forceFlush();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¯è¯»æˆ–å¯æ¥å…¥äº‹ä»¶</span></span><br><span class="line">        <span class="keyword">if</span> ((readyOps &amp; (SelectionKey.OP_READ | SelectionKey.OP_ACCEPT)) != <span class="number">0</span> || readyOps == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœæ˜¯å¯æ¥å…¥ io.netty.channel.nio.AbstractNioMessageChannel.NioMessageUnsafe#read</span></span><br><span class="line">            <span class="comment">// å¦‚æœæ˜¯å¯è¯» io.netty.channel.nio.AbstractNioByteChannel.NioByteUnsafe#read</span></span><br><span class="line">            unsafe.read();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (CancelledKeyException ignored) &#123;</span><br><span class="line">        unsafe.close(unsafe.voidPromise());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-3-accept-å‰–æ"><a href="#2-3-accept-å‰–æ" class="headerlink" title="2.3 accept å‰–æ"></a>2.3 accept å‰–æ</h3><p>nio ä¸­å¦‚ä¸‹ä»£ç ï¼Œåœ¨ netty ä¸­çš„æµç¨‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1 é˜»å¡ç›´åˆ°äº‹ä»¶å‘ç”Ÿ</span></span><br><span class="line">selector.select();</span><br><span class="line"></span><br><span class="line">Iterator&lt;SelectionKey&gt; iter = selector.selectedKeys().iterator();</span><br><span class="line"><span class="keyword">while</span> (iter.hasNext()) &#123;    </span><br><span class="line">    <span class="comment">//2 æ‹¿åˆ°ä¸€ä¸ªäº‹ä»¶</span></span><br><span class="line">    <span class="type">SelectionKey</span> <span class="variable">key</span> <span class="operator">=</span> iter.next();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//3 å¦‚æœæ˜¯ accept äº‹ä»¶</span></span><br><span class="line">    <span class="keyword">if</span> (key.isAcceptable()) &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//4 æ‰§è¡Œ accept</span></span><br><span class="line">        <span class="type">SocketChannel</span> <span class="variable">channel</span> <span class="operator">=</span> serverSocketChannel.accept();</span><br><span class="line">        channel.configureBlocking(<span class="literal">false</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//5 å…³æ³¨ read äº‹ä»¶</span></span><br><span class="line">        channel.register(selector, SelectionKey.OP_READ);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…ˆæ¥çœ‹å¯æ¥å…¥äº‹ä»¶å¤„ç†ï¼ˆacceptï¼‰</p><p><code>io.netty.channel.nio.AbstractNioMessageChannel.NioMessageUnsafe#read</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">read</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">assert</span> <span class="title function_">eventLoop</span><span class="params">()</span>.inEventLoop();</span><br><span class="line">    <span class="keyword">final</span> <span class="type">ChannelConfig</span> <span class="variable">config</span> <span class="operator">=</span> config();</span><br><span class="line">    <span class="keyword">final</span> <span class="type">ChannelPipeline</span> <span class="variable">pipeline</span> <span class="operator">=</span> pipeline();    </span><br><span class="line">    <span class="keyword">final</span> RecvByteBufAllocator.<span class="type">Handle</span> <span class="variable">allocHandle</span> <span class="operator">=</span> unsafe().recvBufAllocHandle();</span><br><span class="line">    allocHandle.reset(config);</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="variable">closed</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="type">Throwable</span> <span class="variable">exception</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line"><span class="comment">// doReadMessages ä¸­æ‰§è¡Œäº† accept å¹¶åˆ›å»º NioSocketChannel ä½œä¸ºæ¶ˆæ¯æ”¾å…¥ readBuf</span></span><br><span class="line">                <span class="comment">// readBuf æ˜¯ä¸€ä¸ª ArrayList ç”¨æ¥ç¼“å­˜æ¶ˆæ¯</span></span><br><span class="line">                <span class="type">int</span> <span class="variable">localRead</span> <span class="operator">=</span> doReadMessages(readBuf);</span><br><span class="line">                <span class="keyword">if</span> (localRead == <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (localRead &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                    closed = <span class="literal">true</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line"><span class="comment">// localRead ä¸º 1ï¼Œå°±ä¸€æ¡æ¶ˆæ¯ï¼Œå³æ¥æ”¶ä¸€ä¸ªå®¢æˆ·ç«¯è¿æ¥</span></span><br><span class="line">                allocHandle.incMessagesRead(localRead);</span><br><span class="line">            &#125; <span class="keyword">while</span> (allocHandle.continueReading());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable t) &#123;</span><br><span class="line">            exception = t;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> readBuf.size();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i ++) &#123;</span><br><span class="line">            readPending = <span class="literal">false</span>;</span><br><span class="line">            <span class="comment">// è§¦å‘ read äº‹ä»¶ï¼Œè®© pipeline ä¸Šçš„ handler å¤„ç†ï¼Œè¿™æ—¶æ˜¯å¤„ç†</span></span><br><span class="line">            <span class="comment">// io.netty.bootstrap.ServerBootstrap.ServerBootstrapAcceptor#channelRead</span></span><br><span class="line">            pipeline.fireChannelRead(readBuf.get(i));</span><br><span class="line">        &#125;</span><br><span class="line">        readBuf.clear();</span><br><span class="line">        allocHandle.readComplete();</span><br><span class="line">        pipeline.fireChannelReadComplete();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (exception != <span class="literal">null</span>) &#123;</span><br><span class="line">            closed = closeOnReadError(exception);</span><br><span class="line"></span><br><span class="line">            pipeline.fireExceptionCaught(exception);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (closed) &#123;</span><br><span class="line">            inputShutdown = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (isOpen()) &#123;</span><br><span class="line">                close(voidPromise());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!readPending &amp;&amp; !config.isAutoRead()) &#123;</span><br><span class="line">            removeReadOp();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³é”®ä»£ç  <code>io.netty.bootstrap.ServerBootstrap.ServerBootstrapAcceptor#channelRead</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">channelRead</span><span class="params">(ChannelHandlerContext ctx, Object msg)</span> &#123;</span><br><span class="line">    <span class="comment">// è¿™æ—¶çš„ msg æ˜¯ NioSocketChannel</span></span><br><span class="line">    <span class="keyword">final</span> <span class="type">Channel</span> <span class="variable">child</span> <span class="operator">=</span> (Channel) msg;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// NioSocketChannel æ·»åŠ   childHandler å³åˆå§‹åŒ–å™¨</span></span><br><span class="line">    child.pipeline().addLast(childHandler);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®é€‰é¡¹</span></span><br><span class="line">    setChannelOptions(child, childOptions, logger);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Entry&lt;AttributeKey&lt;?&gt;, Object&gt; e: childAttrs) &#123;</span><br><span class="line">        child.attr((AttributeKey&lt;Object&gt;) e.getKey()).set(e.getValue());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// æ³¨å†Œ NioSocketChannel åˆ° nio worker çº¿ç¨‹ï¼Œæ¥ä¸‹æ¥çš„å¤„ç†ä¹Ÿç§»äº¤è‡³ nio worker çº¿ç¨‹</span></span><br><span class="line">        childGroup.register(child).addListener(<span class="keyword">new</span> <span class="title class_">ChannelFutureListener</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">operationComplete</span><span class="params">(ChannelFuture future)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                <span class="keyword">if</span> (!future.isSuccess()) &#123;</span><br><span class="line">                    forceClose(child, future.cause());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable t) &#123;</span><br><span class="line">        forceClose(child, t);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆå›åˆ°äº†ç†Ÿæ‚‰çš„ <code>io.netty.channel.AbstractChannel.AbstractUnsafe#register</code>  æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">register</span><span class="params">(EventLoop eventLoop, <span class="keyword">final</span> ChannelPromise promise)</span> &#123;</span><br><span class="line">    <span class="comment">// ä¸€äº›æ£€æŸ¥ï¼Œç•¥...</span></span><br><span class="line"></span><br><span class="line">    AbstractChannel.<span class="built_in">this</span>.eventLoop = eventLoop;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (eventLoop.inEventLoop()) &#123;</span><br><span class="line">        register0(promise);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// è¿™è¡Œä»£ç å®Œæˆçš„äº‹å®æ˜¯ nio boss -&gt; nio worker çº¿ç¨‹çš„åˆ‡æ¢</span></span><br><span class="line">            eventLoop.execute(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                    register0(promise);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable t) &#123;</span><br><span class="line">            <span class="comment">// æ—¥å¿—è®°å½•...</span></span><br><span class="line">            closeForcibly();</span><br><span class="line">            closeFuture.setClosed();</span><br><span class="line">            safeSetFailure(promise, t);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>io.netty.channel.AbstractChannel.AbstractUnsafe#register0</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">register0</span><span class="params">(ChannelPromise promise)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!promise.setUncancellable() || !ensureOpen(promise)) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">firstRegistration</span> <span class="operator">=</span> neverRegistered;</span><br><span class="line">        doRegister();</span><br><span class="line">        neverRegistered = <span class="literal">false</span>;</span><br><span class="line">        registered = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ‰§è¡Œåˆå§‹åŒ–å™¨ï¼Œæ‰§è¡Œå‰ pipeline ä¸­åªæœ‰ head -&gt; åˆå§‹åŒ–å™¨ -&gt; tail</span></span><br><span class="line">        pipeline.invokeHandlerAddedIfNeeded();</span><br><span class="line">        <span class="comment">// æ‰§è¡Œåå°±æ˜¯ head -&gt; logging handler -&gt; my handler -&gt; tail</span></span><br><span class="line"></span><br><span class="line">        safeSetSuccess(promise);</span><br><span class="line">        pipeline.fireChannelRegistered();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (isActive()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (firstRegistration) &#123;</span><br><span class="line">                <span class="comment">// è§¦å‘ pipeline ä¸Š active äº‹ä»¶</span></span><br><span class="line">                pipeline.fireChannelActive();</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (config().isAutoRead()) &#123;</span><br><span class="line">                beginRead();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable t) &#123;</span><br><span class="line">        closeForcibly();</span><br><span class="line">        closeFuture.setClosed();</span><br><span class="line">        safeSetFailure(promise, t);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å›åˆ°äº†ç†Ÿæ‚‰çš„ä»£ç  <code>io.netty.channel.DefaultChannelPipeline.HeadContext#channelActive</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">channelActive</span><span class="params">(ChannelHandlerContext ctx)</span> &#123;</span><br><span class="line">    ctx.fireChannelActive();</span><br><span class="line"><span class="comment">// è§¦å‘ read (NioSocketChannel è¿™é‡Œ readï¼Œåªæ˜¯ä¸ºäº†è§¦å‘ channel çš„äº‹ä»¶æ³¨å†Œï¼Œè¿˜æœªæ¶‰åŠæ•°æ®è¯»å–)</span></span><br><span class="line">    readIfIsAutoRead();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>io.netty.channel.nio.AbstractNioChannel#doBeginRead</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">doBeginRead</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="comment">// Channel.read() or ChannelHandlerContext.read() was called</span></span><br><span class="line">    <span class="keyword">final</span> <span class="type">SelectionKey</span> <span class="variable">selectionKey</span> <span class="operator">=</span> <span class="built_in">this</span>.selectionKey;</span><br><span class="line">    <span class="keyword">if</span> (!selectionKey.isValid()) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    readPending = <span class="literal">true</span>;</span><br><span class="line"><span class="comment">// è¿™æ—¶å€™ interestOps æ˜¯ 0</span></span><br><span class="line">    <span class="keyword">final</span> <span class="type">int</span> <span class="variable">interestOps</span> <span class="operator">=</span> selectionKey.interestOps();</span><br><span class="line">    <span class="keyword">if</span> ((interestOps &amp; readInterestOp) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// å…³æ³¨ read äº‹ä»¶</span></span><br><span class="line">        selectionKey.interestOps(interestOps | readInterestOp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-4-read-å‰–æ"><a href="#2-4-read-å‰–æ" class="headerlink" title="2.4 read å‰–æ"></a>2.4 read å‰–æ</h3><p>å†æ¥çœ‹å¯è¯»äº‹ä»¶ <code>io.netty.channel.nio.AbstractNioByteChannel.NioByteUnsafe#read</code>ï¼Œæ³¨æ„å‘é€çš„æ•°æ®æœªå¿…èƒ½å¤Ÿä¸€æ¬¡è¯»å®Œï¼Œå› æ­¤ä¼šè§¦å‘å¤šæ¬¡ nio read äº‹ä»¶ï¼Œä¸€æ¬¡äº‹ä»¶å†…ä¼šè§¦å‘å¤šæ¬¡ pipeline readï¼Œä¸€æ¬¡äº‹ä»¶ä¼šè§¦å‘ä¸€æ¬¡ pipeline read complete</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">read</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">ChannelConfig</span> <span class="variable">config</span> <span class="operator">=</span> config();</span><br><span class="line">    <span class="keyword">if</span> (shouldBreakReadReady(config)) &#123;</span><br><span class="line">        clearReadPending();</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">ChannelPipeline</span> <span class="variable">pipeline</span> <span class="operator">=</span> pipeline();</span><br><span class="line">    <span class="comment">// io.netty.allocator.type å†³å®š allocator çš„å®ç°</span></span><br><span class="line">    <span class="keyword">final</span> <span class="type">ByteBufAllocator</span> <span class="variable">allocator</span> <span class="operator">=</span> config.getAllocator();</span><br><span class="line">    <span class="comment">// ç”¨æ¥åˆ†é… byteBufï¼Œç¡®å®šå•æ¬¡è¯»å–å¤§å°</span></span><br><span class="line">    <span class="keyword">final</span> RecvByteBufAllocator.<span class="type">Handle</span> <span class="variable">allocHandle</span> <span class="operator">=</span> recvBufAllocHandle();</span><br><span class="line">    allocHandle.reset(config);</span><br><span class="line"></span><br><span class="line">    <span class="type">ByteBuf</span> <span class="variable">byteBuf</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">close</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            byteBuf = allocHandle.allocate(allocator);</span><br><span class="line">            <span class="comment">// è¯»å–</span></span><br><span class="line">            allocHandle.lastBytesRead(doReadBytes(byteBuf));</span><br><span class="line">            <span class="keyword">if</span> (allocHandle.lastBytesRead() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">                byteBuf.release();</span><br><span class="line">                byteBuf = <span class="literal">null</span>;</span><br><span class="line">                close = allocHandle.lastBytesRead() &lt; <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">if</span> (close) &#123;</span><br><span class="line">                    readPending = <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            allocHandle.incMessagesRead(<span class="number">1</span>);</span><br><span class="line">            readPending = <span class="literal">false</span>;</span><br><span class="line">            <span class="comment">// è§¦å‘ read äº‹ä»¶ï¼Œè®© pipeline ä¸Šçš„ handler å¤„ç†ï¼Œè¿™æ—¶æ˜¯å¤„ç† NioSocketChannel ä¸Šçš„ handler</span></span><br><span class="line">            pipeline.fireChannelRead(byteBuf);</span><br><span class="line">            byteBuf = <span class="literal">null</span>;</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="comment">// æ˜¯å¦è¦ç»§ç»­å¾ªç¯</span></span><br><span class="line">        <span class="keyword">while</span> (allocHandle.continueReading());</span><br><span class="line"></span><br><span class="line">        allocHandle.readComplete();</span><br><span class="line">        <span class="comment">// è§¦å‘ read complete äº‹ä»¶</span></span><br><span class="line">        pipeline.fireChannelReadComplete();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (close) &#123;</span><br><span class="line">            closeOnRead(pipeline);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable t) &#123;</span><br><span class="line">        handleReadException(pipeline, byteBuf, t, close, allocHandle);</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!readPending &amp;&amp; !config.isAutoRead()) &#123;</span><br><span class="line">            removeReadOp();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>io.netty.channel.DefaultMaxMessagesRecvByteBufAllocator.MaxMessageHandle#continueReading(io.netty.util.UncheckedBooleanSupplier)</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">continueReading</span><span class="params">(UncheckedBooleanSupplier maybeMoreDataSupplier)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> </span><br><span class="line">           <span class="comment">// ä¸€èˆ¬ä¸º true</span></span><br><span class="line">           config.isAutoRead() &amp;&amp;</span><br><span class="line">           <span class="comment">// respectMaybeMoreData é»˜è®¤ä¸º true</span></span><br><span class="line">           <span class="comment">// maybeMoreDataSupplier çš„é€»è¾‘æ˜¯å¦‚æœé¢„æœŸè¯»å–å­—èŠ‚ä¸å®é™…è¯»å–å­—èŠ‚ç›¸ç­‰ï¼Œè¿”å› true</span></span><br><span class="line">           (!respectMaybeMoreData || maybeMoreDataSupplier.get()) &amp;&amp;</span><br><span class="line">           <span class="comment">// å°äºæœ€å¤§æ¬¡æ•°ï¼ŒmaxMessagePerRead é»˜è®¤ 16</span></span><br><span class="line">           totalMessages &lt; maxMessagePerRead &amp;&amp;</span><br><span class="line">           <span class="comment">// å®é™…è¯»åˆ°äº†æ•°æ®</span></span><br><span class="line">           totalBytesRead &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> JAVA </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¸­é—´ä»¶ </tag>
            
            <tag> Netty </tag>
            
            <tag> ç½‘ç»œç¼–ç¨‹ </tag>
            
            <tag> æ¡†æ¶ </tag>
            
            <tag> NIO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„å®éªŒ</title>
      <link href="/2022/11/22/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/"/>
      <url>/2022/11/22/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/</url>
      
        <content type="html"><![CDATA[<h1 id="æ•°æ®ç»“æ„å®éªŒ"><a href="#æ•°æ®ç»“æ„å®éªŒ" class="headerlink" title="æ•°æ®ç»“æ„å®éªŒ"></a>æ•°æ®ç»“æ„å®éªŒ</h1><h2 id="çº¿æ€§è¡¨çš„åº”ç”¨"><a href="#çº¿æ€§è¡¨çš„åº”ç”¨" class="headerlink" title="çº¿æ€§è¡¨çš„åº”ç”¨"></a>çº¿æ€§è¡¨çš„åº”ç”¨</h2><h3 id="ä¸€ï¼å®éªŒç›®çš„"><a href="#ä¸€ï¼å®éªŒç›®çš„" class="headerlink" title="ä¸€ï¼å®éªŒç›®çš„"></a>ä¸€ï¼å®éªŒç›®çš„</h3><ol><li><p>æŒæ¡çº¿æ€§è¡¨çš„å•é“¾è¡¨å®ç°ä¸é™æ€é“¾è¡¨å®ç°ã€‚ </p></li><li><p>æŒæ¡çº¿æ€§è¡¨çš„åº”ç”¨ï¼šè¿åŠ¨ä¼šä¿¡æ¯ç®¡ç†ç³»ç»Ÿã€‚</p></li></ol><h3 id="äºŒ-å®éªŒè¦æ±‚ã€å†…å®¹"><a href="#äºŒ-å®éªŒè¦æ±‚ã€å†…å®¹" class="headerlink" title="äºŒ. å®éªŒè¦æ±‚ã€å†…å®¹"></a>äºŒ. å®éªŒè¦æ±‚ã€å†…å®¹</h3><ol><li>åŸºäºå•é“¾è¡¨å®ç°çº¿æ€§è¡¨ List1 çš„å…¸å‹æ“ä½œï¼ˆåˆ¤ç©ºã€åˆ¤æ»¡ã€æ±‚è¡¨é•¿ã€æ’å…¥ã€åˆ é™¤ã€æŸ¥æ‰¾ã€ä¿®æ”¹ã€éå†ã€ç½®ç©ºã€æ™®</li></ol><p>é€šæ„é€ ã€æ‹·è´æ„é€ ã€èµ‹å€¼è¿ç®—ç¬¦é‡è½½ã€ææ„ï¼‰ï¼Œç¼–å†™ç®€å•ç¨‹åºä½¿ç”¨è¯¥çº¿æ€§è¡¨ï¼Œæµ‹è¯•å’Œè°ƒè¯•ç¨‹åºã€‚ </p><ol start="2"><li>åŸºäºé™æ€é“¾è¡¨å®ç°çº¿æ€§è¡¨ List2 çš„å…¸å‹æ“ä½œï¼ˆåˆ¤ç©ºã€åˆ¤æ»¡ã€æ±‚è¡¨é•¿ã€æ’å…¥ã€åˆ é™¤ã€æŸ¥æ‰¾ã€ä¿®æ”¹ã€éå†ã€ç½®ç©ºã€</li></ol><p>æ™®é€šæ„é€ ï¼‰ï¼Œç¼–å†™ç®€å•ç¨‹åºä½¿ç”¨è¯¥çº¿æ€§è¡¨ï¼Œæµ‹è¯•å’Œè°ƒè¯•ç¨‹åºã€‚ </p><ol start="3"><li><p>åŸºäºçº¿æ€§è¡¨ List1ã€çº¿æ€§è¡¨ List2 å®ç°çº¿æ€§è¡¨çš„åº”ç”¨ï¼šè¿åŠ¨ä¼šä¿¡æ¯ç®¡ç†ï¼Œæµ‹è¯•å’Œè°ƒè¯•ç¨‹åºã€‚ </p></li><li><p>æŒ‰è¦æ±‚æ’°å†™å®éªŒæŠ¥å‘Šã€å½•åˆ¶ç¨‹åºè¿è¡Œä»¥åŠè®²è§£ç¨‹åºçš„è§†é¢‘ã€‚æŠ¥å‘Šä¸­è¦åŒ…å«ç®—æ³•æ€§èƒ½çš„è®¨è®ºä»¥åŠæ ¹æ®å®ç°æ•ˆç‡</p></li></ol><p>åœ¨é—®é¢˜çš„å¤šç§è§£å†³æ–¹æ¡ˆä¸­è¿›è¡Œæ¯”è¾ƒã€é€‰æ‹©çš„è¯´æ˜ã€‚</p><h3 id="ä¸‰ï¼å®éªŒè®¾å¤‡"><a href="#ä¸‰ï¼å®éªŒè®¾å¤‡" class="headerlink" title="ä¸‰ï¼å®éªŒè®¾å¤‡"></a>ä¸‰ï¼å®éªŒè®¾å¤‡</h3><p>è®¡ç®—æœºã€Windows æ“ä½œç³»ç»Ÿã€C++è¯­è¨€é›†æˆå¼€å‘ç¯å¢ƒã€‚</p><h3 id="å››ï¼å®éªŒåŸç†ï¼ˆæˆ–ç¨‹åºæ¡†å›¾ï¼‰åŠæ­¥éª¤"><a href="#å››ï¼å®éªŒåŸç†ï¼ˆæˆ–ç¨‹åºæ¡†å›¾ï¼‰åŠæ­¥éª¤" class="headerlink" title="å››ï¼å®éªŒåŸç†ï¼ˆæˆ–ç¨‹åºæ¡†å›¾ï¼‰åŠæ­¥éª¤"></a>å››ï¼å®éªŒåŸç†ï¼ˆæˆ–ç¨‹åºæ¡†å›¾ï¼‰åŠæ­¥éª¤</h3><p><em><strong>*å®éªŒ1*</strong></em></p><p>1.é—®é¢˜åˆ†è§£</p><p> <img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps2.jpg" alt="img"></p><p>é“¾è¡¨ä¸­æ¯ä¸ªèŠ‚ç‚¹åŒ…å« 1 ä¸ªæ•°æ®åŸŸ(entry)å’Œ 1 ä¸ªæŒ‡é’ˆåŸŸ(next)ï¼ŒæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚é‡‡ç”¨æ¨¡æ¿å®ŒæˆèŠ‚ç‚¹çš„å®šä¹‰ã€‚</p><ol start="2"><li>å¯¹é—®é¢˜ä¸€åŸºäºå•é“¾è¡¨å®ç°çº¿æ€§è¡¨List1çš„å…¸å‹æ“ä½œã€‚</li></ol><p>(1) .æ„é€ æ–¹æ³•</p><p>å¯¹çº¿æ€§è¡¨è¿›è¡Œåˆå§‹åŒ–ï¼Œå› ä¸ºæ˜¯å•é“¾è¡¨ï¼Œå°±è®©countè®¡æ•°å™¨ä¸º0ï¼Œè®©nextæŒ‡é’ˆä¸ºç©ºã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(1)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; List1&lt;List_entry&gt;::<span class="built_in">List1</span>() &#123;</span><br><span class="line">  <span class="comment">//å¯¹çº¿æ€§è¡¨åˆå§‹åŒ–</span></span><br><span class="line">  count = <span class="number">0</span>;</span><br><span class="line">  head = <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(2) .ææ„æ–¹æ³•</p><p>å¯¹çº¿æ€§è¡¨è¿›è¡Œæ¸…ç©ºï¼Œææ„å€ŸåŠ©ä»–çš„clearï¼ˆï¼‰æ–¹æ³•ï¼Œå¦‚æœçº¿æ€§è¡¨ä¸ä¸ºç©ºï¼Œåˆ™æŠŠçº¿æ€§è¡¨æ¸…ç©ºã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; List1&lt;List_entry&gt;::~<span class="built_in">List1</span>() &#123;</span><br><span class="line">  <span class="comment">//å€ŸåŠ©clear()æ–¹æ³•æ¸…ç©º</span></span><br><span class="line">  <span class="built_in">clear</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(3) .clear()ç½®ç©ºæ–¹æ³•</p><p>ç›¸å½“äºå•é“¾è¡¨çš„æ¸…ç©ºè¡¨ï¼Œä»è¡¨å¤´éå†é“¾è¡¨ï¼Œé€”ä¸­å¯¹æ¯ä¸€ä¸ªèŠ‚ç‚¹è¿›è¡Œç½®ç©ºï¼Œå¹¶é€šè¿‡deleteæ¥åˆ é™¤èŠ‚ç‚¹ï¼Œæœ€åå¯¹countè®¡æ•°å™¨å’Œheadå¤´æŒ‡é’ˆè¿›è¡Œåˆå§‹åŒ–ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; <span class="type">void</span> List1&lt;List_entry&gt;::<span class="built_in">clear</span>() &#123;</span><br><span class="line">  Node&lt;List_entry&gt;* p, * q;</span><br><span class="line">  <span class="comment">//p å½“å‰èŠ‚ç‚¹   q nextèŠ‚ç‚¹</span></span><br><span class="line">  <span class="keyword">for</span> (p = head; p; p = q) &#123;</span><br><span class="line">    q = p-&gt;next;</span><br><span class="line">    <span class="keyword">delete</span> p;</span><br><span class="line">  &#125;</span><br><span class="line">  count = <span class="number">0</span>;</span><br><span class="line">  head = <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(4) .size()æ±‚è¡¨é•¿</p><p>é€šè¿‡è¿”å›countè®¡æ•°å™¨ã€‚æ—¶é—´å¤æ‚åº¦ï¼šO(1)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; <span class="type">int</span> List1&lt;List_entry&gt;::<span class="built_in">size</span>()<span class="type">const</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(5) .full()åˆ¤æ»¡</p><p>å› ä¸ºæ˜¯å•é“¾è¡¨å®ç°æ‰€ä»¥åªè¦ä¸€ç›´æœ‰å†…å­˜ç©ºé—´å°±ä¸å¯èƒ½å­˜åœ¨æ»¡çš„æƒ…å†µï¼Œç›´æ¥è¿”å›falseã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(1)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; <span class="type">bool</span> List1&lt;List_entry&gt;::<span class="built_in">full</span>() <span class="type">const</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(6) .empty()åˆ¤ç©º</p><p>å¦‚æœå¤´èŠ‚ç‚¹ä¸ºç©ºï¼Œåˆ™è¯´æ˜çº¿æ€§è¡¨ä¸ºç©ºï¼Œå¦‚æœå¤´èŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œåˆ™è¯´æ˜çº¿æ€§è¡¨ä¸ä¸ºç©ºã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(1)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; <span class="type">bool</span> List1&lt;List_entry&gt;::<span class="built_in">empty</span>()<span class="type">const</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (head != <span class="literal">nullptr</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(7) .set_position()æ‰¾ä½ç½®</p><p>å…ˆåˆ¤æ–­æ‰¾çš„ä½ç½®çš„ä¸‹æ ‡æ˜¯å¦ç¬¦åˆè§„èŒƒï¼Œå½“ç¬¦åˆè§„èŒƒæ—¶ï¼ŒæŠŠé“¾è¡¨ä»è¡¨å¤´å¼€å§‹ï¼Œéå†positionæ¬¡ï¼Œæ¥åˆ°è¦æ‰¾çš„èŠ‚ç‚¹ä½ç½®ï¼Œè¿”å›å½“å‰ä½ç½®ã€‚æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; Node&lt;List_entry&gt;* List1&lt;List_entry&gt;::<span class="built_in">set_position</span>(<span class="type">int</span> position) <span class="type">const</span> &#123;</span><br><span class="line">  Node&lt;List_entry&gt;* q = head;</span><br><span class="line">  <span class="comment">//éå†positionæ¬¡å°±æ¥åˆ°äº†positionçš„èŠ‚ç‚¹ä½ç½®</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; position; i++) q = q-&gt;next;</span><br><span class="line">  <span class="keyword">return</span> q;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(8) .insert()æ’å…¥æ–¹æ³•</p><p>å…ˆçœ‹æ’å…¥çš„ä½ç½®æ˜¯å¦ç¬¦åˆè§„èŒƒï¼Œå¦‚æœç¬¦åˆè§„èŒƒï¼Œé€šè¿‡set_position()æ–¹æ³•æ‰¾åˆ°å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œnewä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ï¼Œè®©å‰ä¸€ä¸ªèŠ‚ç‚¹çš„nextæŒ‡é’ˆåŸŸæŒ‡å‘æ–°èŠ‚ç‚¹ï¼Œè€Œè®©æ–°èŠ‚ç‚¹çš„nextæŒ‡é’ˆåŸŸæŒ‡å‘å‰ä¸€ä¸ªç»“ç‚¹è€çš„nextåŸŸï¼ˆä¹Ÿå°±æ˜¯ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼‰ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; Error_code List1&lt;List_entry&gt;::<span class="built_in">insert</span>(<span class="type">int</span> position, <span class="type">const</span> List_entry&amp; x) &#123;</span><br><span class="line">  <span class="keyword">if</span> (position &lt; <span class="number">0</span> || position &gt; count) <span class="comment">//positionçš„ä½ç½®ä¸åˆæ³•</span></span><br><span class="line">    <span class="keyword">return</span> range_errors;</span><br><span class="line">  Node&lt;List_entry&gt;* new_node, <span class="comment">//æ–°èŠ‚ç‚¹</span></span><br><span class="line">          \* previous, <span class="comment">//å‰é©±èŠ‚ç‚¹</span></span><br><span class="line">          \* following;<span class="comment">//åç»§èŠ‚ç‚¹</span></span><br><span class="line">  previous = <span class="literal">nullptr</span>;</span><br><span class="line">  <span class="keyword">if</span> (position &gt; <span class="number">0</span>) &#123; <span class="comment">//ä¸æ˜¯å¤´æ’</span></span><br><span class="line">    previous = <span class="built_in">set_position</span>(position - <span class="number">1</span>);<span class="comment">//æ‰¾åˆ°ä»–çš„å‰é©±èŠ‚ç‚¹</span></span><br><span class="line">    following = previous-&gt;next;<span class="comment">//åç»§èŠ‚ç‚¹</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> following = head;<span class="comment">//æ˜¯å¤´æ’çš„è¯ï¼Œæ²¡æœ‰å‰é©±ï¼Œåç»§å°±æ˜¯åŸæ¥çš„å¤´èŠ‚ç‚¹</span></span><br><span class="line">  new_node = <span class="keyword">new</span> <span class="built_in">Node</span>&lt;List_entry&gt;(x, following);<span class="comment">//å€Ÿç”¨äº†nodeçš„æ„é€ æ–¹æ³• //node-&gt;next = following</span></span><br><span class="line">  <span class="keyword">if</span> (new_node == <span class="literal">nullptr</span>)</span><br><span class="line">    <span class="keyword">return</span> overflow;</span><br><span class="line">  <span class="keyword">if</span> (position == <span class="number">0</span>)<span class="comment">//å¦‚æœæ˜¯å¤´æ’çš„è¯ï¼Œå¤´èŠ‚ç‚¹å°±æ˜¯æ’å…¥çš„new_node</span></span><br><span class="line">    head = new_node;</span><br><span class="line">  <span class="keyword">else</span><span class="comment">//ä¸æ˜¯å¤´æ’çš„è¯ï¼Œå°±è®©å‰é©±èŠ‚ç‚¹çš„nextæŒ‡å‘new_node</span></span><br><span class="line">    previous-&gt;next = new_node;</span><br><span class="line">  count++;</span><br><span class="line">  <span class="keyword">return</span> success;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(9) .traverse()æ–¹æ³•</p><p>éå†å½“å‰åˆ—è¡¨ï¼Œé€šè¿‡ä¼ å…¥çš„æŒ‡é’ˆå‡½æ•°ï¼Œå¯¹æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½ç”¨ä¼ å…¥çš„å‡½æ•°æ¥æ“ä½œã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; <span class="type">void</span> List1&lt;List_entry&gt;::<span class="built_in">traverse</span>(<span class="built_in">void</span> (*visit) (List_entry&amp;)) &#123;</span><br><span class="line">  Node&lt;List_entry&gt;* q;</span><br><span class="line">  <span class="keyword">for</span> (q = head; q; q = q-&gt;next) &#123; <span class="comment">//éå†æ¯ä¸€ä¸ªèŠ‚ç‚¹ å¯¹æ¯ä¸€ä¸ªèŠ‚ç‚¹ é€šè¿‡å‡½æ•°æŒ‡é’ˆæ¥è¿›è¡Œæ“ä½œ</span></span><br><span class="line">    (*visit) (q-&gt;entry);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(10) .remove()åˆ é™¤èŠ‚ç‚¹</p><p>å…ˆåˆ¤æ–­è¡¨æ˜¯å¦ä¸ºç©ºï¼Œå†åˆ¤æ–­è¦åˆ é™¤çš„ä½ç½®æ˜¯å¦ç¬¦åˆè§„èŒƒï¼Œå¦‚æœéƒ½æ»¡è¶³ï¼Œåˆ¤æ–­æ˜¯ä¸æ˜¯å¤´èŠ‚ç‚¹(åˆ é™¤çš„ä½ç½®æ˜¯ä¸æ˜¯0)ï¼Œå¦‚æœä¸æ˜¯å°±é€šè¿‡set_position()æ–¹æ³•æ¥æ‰¾åˆ°è¦åˆ é™¤èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè®©å‰ä¸€ä¸ªèŠ‚ç‚¹çš„nextæŒ‡é’ˆåŸŸæŒ‡å‘è¦åˆ é™¤èŠ‚ç‚¹çš„nextæŒ‡é’ˆåŸŸã€‚å¦‚æœè¦åˆ é™¤çš„æ˜¯å¤´èŠ‚ç‚¹ï¼Œå°±ç›´æ¥è®©ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä½œä¸ºå¤´ç»“ç‚¹ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; Error_code List1&lt;List_entry&gt;::<span class="built_in">remove</span>(<span class="type">int</span> position, List_entry&amp; x) &#123;</span><br><span class="line">  Node&lt;List_entry&gt;* prior,<span class="comment">//å‰é©±èŠ‚ç‚¹</span></span><br><span class="line">          \* current;<span class="comment">//å½“å‰èŠ‚ç‚¹</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">empty</span>()) <span class="keyword">return</span> fail;</span><br><span class="line">  <span class="keyword">if</span> (position &lt; <span class="number">0</span> || position &gt;= count) <span class="keyword">return</span> range_errors;<span class="comment">//positionä½ç½®æ˜¯å¦åˆæ³•</span></span><br><span class="line">  <span class="keyword">if</span> (position &gt; <span class="number">0</span>) &#123; <span class="comment">//åˆ çš„ä¸æ˜¯å¤´èŠ‚ç‚¹</span></span><br><span class="line">    prior = <span class="built_in">set_position</span>(position - <span class="number">1</span>);<span class="comment">//å‰é©±</span></span><br><span class="line">    current = prior-&gt;next;<span class="comment">//å½“å‰</span></span><br><span class="line">    prior-&gt;next = current-&gt;next;<span class="comment">//è®©å‰é©±èŠ‚ç‚¹ç»•è¿‡å½“å‰èŠ‚ç‚¹ç›´æ¥æŒ‡åˆ°åç»§èŠ‚ç‚¹</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123; <span class="comment">//åˆ é™¤å¤´èŠ‚ç‚¹</span></span><br><span class="line">    current = head;</span><br><span class="line">    head = head-&gt;next;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  x = current-&gt;entry;<span class="comment">//xå¸¦å‡ºè¦åˆ é™¤èŠ‚ç‚¹çš„å€¼</span></span><br><span class="line">  <span class="keyword">delete</span> current;<span class="comment">//é€šè¿‡deleteåˆ é™¤èŠ‚ç‚¹</span></span><br><span class="line">  count--;</span><br><span class="line">  <span class="keyword">return</span> success;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(11) .retrieve()è®¿é—®æ–¹æ³•</p><p>å…ˆåˆ¤æ–­è¦è®¿é—®çš„ä½ç½®æ˜¯å¦ç¬¦åˆè§„èŒƒï¼Œå¦‚æœç¬¦åˆè§„èŒƒå°±é€šè¿‡set_positionæ–¹æ³•æ¥æ‰¾åˆ°å½“å‰èŠ‚ç‚¹ï¼Œé€šè¿‡xæŠŠå½“å‰èŠ‚ç‚¹çš„å€¼å¸¦å‡ºå»ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; Error_code List1&lt;List_entry&gt;::<span class="built_in">retrieve</span>(<span class="type">int</span> position,List_entry&amp; x) <span class="type">const</span> &#123;</span><br><span class="line">  Node&lt;List_entry&gt;* current;</span><br><span class="line">  <span class="keyword">if</span> (position &lt; <span class="number">0</span> || position &gt;= count) <span class="keyword">return</span> range_errors;<span class="comment">//positionä½ç½®æ˜¯å¦åˆæ³•</span></span><br><span class="line">  current = <span class="built_in">set_position</span>(position);<span class="comment">//é€šè¿‡set_positionæ‹¿åˆ°å½“å‰èŠ‚ç‚¹</span></span><br><span class="line">  x = current-&gt;entry;</span><br><span class="line">  <span class="keyword">return</span> success;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(12) .replace()æ›¿æ¢æ–¹æ³•</p><p>å…ˆåˆ¤æ–­è¦æ›¿æ¢çš„ä½ç½®æ˜¯å¦ç¬¦åˆè§„èŒƒï¼Œå¦‚æœç¬¦åˆè§„èŒƒå°±é€šè¿‡set_positionæ–¹æ³•æ¥æ‰¾åˆ°å½“å‰èŠ‚ç‚¹ï¼ŒæŠŠxçš„å€¼èµ‹ç»™å½“å‰èŠ‚ç‚¹çš„æ•°æ®åŸŸå®Œæˆæ›¿æ¢ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; Error_code List1&lt;List_entry&gt;::<span class="built_in">replace</span>(<span class="type">int</span> position, <span class="type">const</span> List_entry&amp; x) &#123;</span><br><span class="line">  Node&lt;List_entry&gt;* current;</span><br><span class="line">  <span class="keyword">if</span> (position &lt; <span class="number">0</span> || position &gt;= count) <span class="keyword">return</span> range_errors;</span><br><span class="line">  current = <span class="built_in">set_position</span>(position);</span><br><span class="line">  current-&gt;entry = x;</span><br><span class="line">  <span class="keyword">return</span> success;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(13) .æ‹·è´æ„é€ </p><p>å’Œé“¾è¡¨çš„æ‹·è´æ„é€ ç±»ä¼¼ï¼Œå…ˆé€šè¿‡å¤´èŠ‚ç‚¹åˆ›é€ ä¸€ä¸ªæ–°èŠ‚ç‚¹ï¼Œå†éå†è€é“¾è¡¨ï¼ŒNodeç»“æ„ä½“æœ‰ä¸€ä¸ªæ„é€ æ–¹æ³•ï¼Œä¼šæŠŠä¸Šä¸€ä¸ªç‚¹çš„nextæŒ‡é’ˆåŸŸæŒ‡å‘å½“å‰æ–°å»ºçš„èŠ‚ç‚¹ï¼Œé€šè¿‡è¯¥æ–¹æ³•ä¸æ–­åˆ›é€ æ–°èŠ‚ç‚¹æ¥å¯¹è€é“¾è¡¨è¿›è¡Œæ‹·è´ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; List1&lt;List_entry&gt;::<span class="built_in">List1</span>(<span class="type">const</span> List1&lt;List_entry&gt;&amp; copy) &#123;<span class="comment">//æ‹·è´æ„é€ </span></span><br><span class="line">  count = copy.count;</span><br><span class="line">  Node&lt;List_entry&gt;* new_node, * old_node = copy.head;</span><br><span class="line">  <span class="keyword">if</span> (old_node == <span class="literal">nullptr</span>) head = <span class="literal">nullptr</span>;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    new_node = <span class="keyword">new</span> <span class="built_in">Node</span>&lt;List_entry&gt;();</span><br><span class="line">    head = new_node;</span><br><span class="line">    <span class="keyword">while</span> (old_node != <span class="literal">nullptr</span>) &#123; <span class="comment">//éå†æ‹·è´çš„çº¿æ€§è¡¨</span></span><br><span class="line">      old_node = old_node-&gt;next;</span><br><span class="line">      new_node-&gt;next = <span class="keyword">new</span> <span class="built_in">Node</span>&lt;List_entry&gt;(old_node-&gt;entry);</span><br><span class="line">      new_node = new_node-&gt;next;<span class="comment">//new_nodeå¾€åæ‹¨ä¸€ä¸ª</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(14) .èµ‹å€¼è¿ç®—ç¬¦é‡è½½</p><p>å€ŸåŠ©æ‹·è´æ„é€ å‡½æ•°ï¼Œæ‹·è´ä¸€ä¸ªæ–°çº¿æ€§è¡¨ï¼ŒæŠŠå½“å‰çº¿æ€§è¡¨ç½®ç©ºï¼Œè®©æ–°çº¿æ€§è¡¨çš„æŒ‡é’ˆåŸŸä½œä¸ºå½“å‰çº¿æ€§è¡¨çš„æŒ‡é’ˆåŸŸï¼Œåˆ é™¤æ–°çš„çº¿æ€§è¡¨å¤´èŠ‚ç‚¹ï¼Œå³å¯ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line"><span class="type">void</span> List1&lt;List_entry&gt;::<span class="keyword">operator</span> =(<span class="type">const</span> List1&lt;List_entry&gt;&amp; copy) &#123; <span class="comment">//èµ‹å€¼è¿ç®—ç¬¦é‡è½½</span></span><br><span class="line">  List1 <span class="built_in">new_copy</span>(copy);<span class="comment">//å€Ÿç”¨æ‹·è´æ„é€ </span></span><br><span class="line">  <span class="built_in">clear</span>();<span class="comment">//æ¸…ç©ºå½“å‰è¡¨</span></span><br><span class="line">  count = <span class="number">0</span>;</span><br><span class="line">  head = <span class="literal">nullptr</span>;</span><br><span class="line">  new_copy.count = copy.count;</span><br><span class="line">  new_copy.head = head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em><strong>*å®éªŒ2*</strong></em></p><p>1.é—®é¢˜åˆ†è§£</p><p> <img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps3.jpg" alt="img"></p><p>é™æ€é“¾è¡¨çš„åº•å±‚å®é™…ä¸Šæ˜¯æ•°ç»„ï¼Œæ¯ä¸ªèŠ‚ç‚¹åŒ…å« 1 ä¸ªæ•°æ®åŸŸ(entry æ•°ç»„å­˜æ”¾çš„å€¼)å’Œ 1 ä¸ªâ€œæŒ‡é’ˆåŸŸâ€(next å…¶å®ä¸æ˜¯æŒ‡é’ˆï¼Œæ˜¯æŒ‡ä¸‹æ ‡)ï¼ŒæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚</p><p>\2. å¯¹é—®é¢˜ä¸€åŸºäºå•é“¾è¡¨å®ç°çº¿æ€§è¡¨List2çš„å…¸å‹æ“ä½œã€‚</p><p>(1) .æ„é€ æ–¹æ³•</p><p>å¯¹çº¿æ€§è¡¨è¿›è¡Œåˆå§‹åŒ–ï¼Œé¦–å…ˆè¦å¼„æ¸…æ¥šä»–çš„å±æ€§availableï¼ˆå¯è·å¾—çš„ç©ºé—´é“¾è¡¨çš„å¤´æŒ‡é’ˆ æ•°ç»„çš„ä¸‹æ ‡ï¼‰, last_usedï¼ˆä¸Šä¸€æ¬¡ä½¿ç”¨çš„ç©ºé—´ ç›¸å½“äºæŒ‡é’ˆ æ•°ç»„ä¸‹æ ‡ï¼‰, headï¼ˆé™æ€é“¾è¡¨çš„å¤´æŒ‡é’ˆ ä¹Ÿæ˜¯æ•°ç»„ä¸‹æ ‡ï¼‰ã€‚åœ¨å¯¹çº¿æ€§è¡¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œå°±è®©ä¸Šè¾¹çš„ä¸‰ä¸ªæŒ‡é’ˆå…¨éƒ¨è®¾åˆå€¼ä¸º-1ï¼Œåœ¨æ•°ç»„ä¸­è¡¨ç¤ºæ— ç©ºé—´ï¼Œå°±æ˜¯nullptrçš„æ„æ€ï¼Œè®©countçš„è®¡æ•°å™¨çš„å€¼ä¸º0ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(1)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line">List2&lt;List_entry&gt;::<span class="built_in">List2</span>()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//åˆå§‹åŒ–</span></span><br><span class="line">  <span class="comment">//éƒ½å‡å®šä¸ºç©º -1</span></span><br><span class="line">  available = <span class="number">-1</span>;</span><br><span class="line">  last_used = <span class="number">-1</span>;</span><br><span class="line">  head = <span class="number">-1</span>;</span><br><span class="line">  count = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br></pre></td></tr></table></figure><p>(2) .clear()ç½®ç©ºæ–¹æ³•</p><p>é™æ€é“¾è¡¨çš„çš„æ¸…ç©ºæ“ä½œï¼Œä»è¡¨å¤´éå†é™æ€é“¾è¡¨ï¼Œé€šè¿‡delete_node()æ–¹æ³•åˆ é™¤èŠ‚ç‚¹(å…¶å®æ˜¯åŠ åˆ°äº†availableé“¾è¡¨ä¸­)ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line"><span class="type">void</span> List2&lt;List_entry&gt;::<span class="built_in">clear</span>()</span><br><span class="line">&#123;</span><br><span class="line">  index p, q;</span><br><span class="line">  <span class="keyword">for</span> (p = head; p != <span class="number">-1</span>; p = workspace[p].next) &#123; <span class="comment">//éå†é“¾è¡¨ å¯¹æ¯ä¸€ä¸ªèŠ‚ç‚¹è¿›è¡Œdelete_node</span></span><br><span class="line">    q = p;</span><br><span class="line">    <span class="built_in">delete_node</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line">  count = <span class="number">0</span>;</span><br><span class="line">  head = <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(3) .size()æ±‚è¡¨é•¿</p><p>é€šè¿‡è¿”å›countè®¡æ•°å™¨ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(1)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line"><span class="type">int</span> List2&lt;List_entry&gt;::<span class="built_in">size</span>() <span class="type">const</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(4) .full()åˆ¤æ»¡</p><p>é™æ€é“¾è¡¨çš„åº•å±‚æ˜¯æ•°ç»„å®ç°çš„ï¼Œæ‰€ä»¥æ¯”è¾ƒcountè®¡æ•°å™¨å’Œmax_list(æ•°ç»„å®¹é‡)çš„å¤§å°ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(1)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line"><span class="type">bool</span> List2&lt;List_entry&gt;::<span class="built_in">full</span>() <span class="type">const</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> count &lt; max_list;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(5) .empty()åˆ¤ç©º</p><p>åˆ¤æ–­countè®¡æ•°å™¨æ˜¯å¦ä¸º0ã€‚æ—¶é—´å¤æ‚åº¦ï¼šO(1)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line"><span class="type">bool</span> List2&lt;List_entry&gt;::<span class="built_in">empty</span>() <span class="type">const</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> count == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(6) .set_position()æ‰¾ä½ç½®</p><p>æŠŠé™æ€é“¾è¡¨ä»è¡¨å¤´å¼€å§‹ï¼Œéå†positionæ¬¡ï¼Œæ¥åˆ°è¦æ‰¾çš„èŠ‚ç‚¹ä½ç½®ï¼Œè¿”å›å½“å‰ä½ç½®ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line">index List2&lt;List_entry&gt;::<span class="built_in">set_position</span>(<span class="type">int</span> position) <span class="type">const</span> &#123; <span class="comment">//æ ¹æ®ä¸‹æ ‡ï¼Œè·å¾—å½“å‰çš„å€¼</span></span><br><span class="line">  <span class="comment">//Node2&lt;List_entry&gt; p;</span></span><br><span class="line">  <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> (!(position&lt;<span class="number">0</span> || position&gt;max_list)) &#123;</span><br><span class="line">    <span class="comment">//éå†positionæ¬¡ æ‹¿åˆ°positionçš„èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">for</span> (i = head; cnt &lt; position; cnt++, i = workspace[i].next);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(7) .insert()æ’å…¥æ–¹æ³•</p><p>å…ˆçœ‹æ’å…¥çš„ä½ç½®æ˜¯å¦ç¬¦åˆè§„èŒƒï¼Œå¦‚æœç¬¦åˆè§„èŒƒï¼Œé€šè¿‡set_position()æ–¹æ³•æ‰¾åˆ°å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œé€šè¿‡new_node()æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹ï¼Œè®©å‰ä¸€ä¸ªèŠ‚ç‚¹çš„nextæŒ‡é’ˆåŸŸæŒ‡å‘æ–°èŠ‚ç‚¹ï¼Œè€Œè®©æ–°èŠ‚ç‚¹çš„nextæŒ‡é’ˆåŸŸæŒ‡å‘å‰ä¸€ä¸ªç»“ç‚¹è€çš„nextåŸŸï¼ˆä¹Ÿå°±æ˜¯ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼‰ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line">Error_code List2&lt;List_entry&gt;::<span class="built_in">insert</span>(<span class="type">int</span> position, <span class="type">const</span> List_entry&amp; x) &#123;</span><br><span class="line">  index new_index, previous, following;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//åˆ¤æ–­positionä½ç½®æ˜¯å¦åˆæ³•</span></span><br><span class="line">  <span class="keyword">if</span> (position &lt; <span class="number">0</span> || position &gt; count) <span class="keyword">return</span> range_errors;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//ä¸æ˜¯å¤´æ’</span></span><br><span class="line">  <span class="keyword">if</span> (position &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">//æ‰¾åˆ°å‰é©±èŠ‚ç‚¹ å’Œ åç»§èŠ‚ç‚¹</span></span><br><span class="line">    previous = <span class="built_in">set_position</span>(position - <span class="number">1</span>);</span><br><span class="line">    following = workspace[previous].next;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//å¤´æ’  åç»§å°±æ˜¯å¤´èŠ‚ç‚¹</span></span><br><span class="line">  <span class="keyword">else</span> following = head;</span><br><span class="line">  <span class="keyword">if</span> ((new_index = <span class="built_in">new_node</span>()) == <span class="number">-1</span>) <span class="keyword">return</span> overflow;<span class="comment">//æ–°å»ºèŠ‚ç‚¹</span></span><br><span class="line">  workspace[new_index].entry = x;</span><br><span class="line">  workspace[new_index].next = following;<span class="comment">//nextåŸŸä¸ºä»–çš„åç»§</span></span><br><span class="line">  <span class="keyword">if</span> (position == <span class="number">0</span>) <span class="comment">//å¦‚æœæ˜¯å¤´æ’ æ–°çš„å¤´èŠ‚ç‚¹å°±æ˜¯new_node</span></span><br><span class="line">    head = new_index;</span><br><span class="line">  <span class="keyword">else</span> <span class="comment">//ä¸æ˜¯å¤´æ’çš„è¯ å¤„ç†ä»–çš„å‰é©±èŠ‚ç‚¹</span></span><br><span class="line">    workspace[previous].next = new_index;</span><br><span class="line">  count++;</span><br><span class="line">  <span class="keyword">return</span> success;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(8) .traverse()æ–¹æ³•</p><p>éå†å½“å‰åˆ—è¡¨ï¼Œé€šè¿‡ä¼ å…¥çš„æŒ‡é’ˆå‡½æ•°ï¼Œå¯¹æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½ç”¨ä¼ å…¥çš„å‡½æ•°æ¥æ“ä½œã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line"><span class="type">void</span> List2&lt;List_entry&gt;::<span class="built_in">traverse</span>(<span class="built_in">void</span> (*visit)(List_entry&amp;)) &#123;</span><br><span class="line">  <span class="comment">//éå†é“¾è¡¨</span></span><br><span class="line">  <span class="keyword">for</span> (index n = head; n != <span class="number">-1</span>; n = workspace[n].next)<span class="comment">//n != -1   n != nullptr</span></span><br><span class="line">    (*visit)(workspace[n].entry);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(9) .remove()åˆ é™¤èŠ‚ç‚¹</p><p>é€šè¿‡set_position()æ–¹æ³•æ¥æ‰¾åˆ°è¦å½“å‰è¦åˆ é™¤èŠ‚ç‚¹çš„èŠ‚ç‚¹ï¼Œé€šè¿‡xæŠŠå½“å‰è¦åˆ é™¤ç»“ç‚¹çš„å€¼å¸¦å‡ºæ¥ï¼Œé€šè¿‡delete_node()æ–¹æ³•åˆ é™¤èŠ‚ç‚¹ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line">Error_code List2&lt;List_entry&gt;::<span class="built_in">remove</span>(<span class="type">int</span> position, List_entry&amp; x) &#123; <span class="comment">//æå‡ºpositionä½ç½®çš„èŠ‚ç‚¹</span></span><br><span class="line">  x = workspace[<span class="built_in">set_position</span>(position)].entry;<span class="comment">//set_positionæ‰¾åˆ°èŠ‚ç‚¹</span></span><br><span class="line">  <span class="built_in">delete_node</span>(<span class="built_in">set_position</span>(position));<span class="comment">//set_positionæ‰¾åˆ°èŠ‚ç‚¹ delete_nodeè¿›è¡Œåˆ é™¤</span></span><br><span class="line">  count--;</span><br><span class="line">  <span class="keyword">return</span> success;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(10) .retrieve()è®¿é—®æ–¹æ³•</p><p>å…ˆåˆ¤æ–­è¦è®¿é—®çš„ä½ç½®æ˜¯å¦ç¬¦åˆè§„èŒƒï¼Œå¦‚æœç¬¦åˆè§„èŒƒå°±é€šè¿‡set_positionæ–¹æ³•æ¥æ‰¾åˆ°å½“å‰èŠ‚ç‚¹ï¼Œé€šè¿‡xæŠŠå½“å‰èŠ‚ç‚¹çš„å€¼å¸¦å‡ºå»ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line">Error_code List2&lt;List_entry&gt;::<span class="built_in">retrieve</span>(<span class="type">int</span> position, List_entry&amp; x) <span class="type">const</span> &#123; <span class="comment">//è®¿é—®positionä½ç½®çš„å€¼ï¼Œé€šè¿‡xå¸¦å‡ºæ¥</span></span><br><span class="line">  <span class="keyword">if</span> (position &lt; <span class="number">0</span> || position &gt; count) <span class="keyword">return</span> range_errors;<span class="comment">//åˆ¤æ–­positionä½ç½®åˆä¸åˆæ³•</span></span><br><span class="line">  <span class="type">int</span> cnt = <span class="number">0</span>, i;</span><br><span class="line">  <span class="keyword">for</span> (i = head; cnt != position; cnt++, i = workspace[i].next);<span class="comment">//éå†çš„æ–¹å¼æ‰¾åˆ°positionä½ç½®</span></span><br><span class="line">  x = workspace[i].entry;</span><br><span class="line">  <span class="keyword">return</span> success;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(11) .replace()æ›¿æ¢æ–¹æ³•</p><p>å…ˆåˆ¤æ–­è¦æ›¿æ¢çš„ä½ç½®æ˜¯å¦ç¬¦åˆè§„èŒƒï¼Œå¦‚æœç¬¦åˆè§„èŒƒå°±é€šè¿‡set_positionæ–¹æ³•æ¥æ‰¾åˆ°å½“å‰èŠ‚ç‚¹ï¼ŒæŠŠxçš„å€¼èµ‹ç»™å½“å‰èŠ‚ç‚¹çš„æ•°æ®åŸŸå®Œæˆæ›¿æ¢ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line">Error_code List2&lt;List_entry&gt;::<span class="built_in">replace</span>(<span class="type">int</span> position, <span class="type">const</span> List_entry &amp;x) &#123;</span><br><span class="line">  <span class="keyword">if</span> (position &lt; <span class="number">0</span> || position &gt; count) <span class="keyword">return</span> range_errors;<span class="comment">//åˆ¤æ–­ä¸‹æ ‡åˆä¸åˆæ³•</span></span><br><span class="line">  workspace[<span class="built_in">set_position</span>(position)].entry = x;<span class="comment">//set_positionæ‰¾åˆ°positionä½ç½®çš„èŠ‚ç‚¹ æ›¿æ¢å€¼</span></span><br><span class="line">  <span class="keyword">return</span> success;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(12) .new_node()æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°ç©ºé—´</p><p>å…ˆçœ‹å¯ç”¨ç©ºé—´é“¾è¡¨availableæ˜¯ä¸æ˜¯è¿˜æœ‰å‰©ä½™çš„ç©ºé—´ï¼Œå¦‚æœæœ‰çš„è¯å°±æŠŠavailableé“¾è¡¨çš„ä¸‹ä¸€ä¸ªå…ƒç´ ç»™è¿”å›ï¼Œå¦‚æœavailableé“¾è¡¨æ²¡æœ‰å‰©ä½™ç©ºé—´äº†ï¼Œå°±çœ‹æ•´ä¸ªè¡¨çš„ç©ºé—´æ˜¯ä¸æ˜¯æ»¡äº†ï¼Œå¦‚æœæ²¡æ»¡çš„è¯ï¼Œå°±æŠŠlast_used++ï¼Œå®Œæˆæ–°å»ºèŠ‚ç‚¹ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(1)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line">index List2&lt;List_entry&gt;::<span class="built_in">new_node</span>()&#123;</span><br><span class="line">  index new_index;</span><br><span class="line">  <span class="comment">//å› ä¸ºæ˜¯æ•°ç»„ä¸‹æ ‡ ç”¨-1ä»£æ›¿nullptr</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   \* 1. å…ˆçœ‹availableæœ‰æ²¡æœ‰ç©ºé—´å¯ä»¥ç”¨</span></span><br><span class="line"><span class="comment">   \* 2. availableè¡¨æ²¡ç©ºé—´äº†ï¼Œçœ‹èƒ½ä¸èƒ½æ–°å»º</span></span><br><span class="line"><span class="comment">   \* */</span></span><br><span class="line">  <span class="keyword">if</span> (available != <span class="number">-1</span>) &#123; <span class="comment">//availableæœ‰ç©ºé—´å¯ä»¥ç”¨</span></span><br><span class="line">    new_index = available;<span class="comment">//availableæŠŠå¤´èŠ‚ç‚¹ç»™new_node</span></span><br><span class="line">    available = workspace[available].next;<span class="comment">//è‡ªå·±è·³åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (last_used &lt; max_list - <span class="number">1</span>) &#123; <span class="comment">//availableè¡¨æ²¡æœ‰ç©ºé—´å¯ä»¥ç”¨  é“¾è¡¨çš„å®¹é‡æ²¡è¶…è¿‡æœ€å¤§å®¹é‡</span></span><br><span class="line">    new_index = ++last_used;<span class="comment">//æ–°å»º</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">-1</span>;<span class="comment">//å¦‚æœæ–¹å¼1ã€2éƒ½æ²¡æœ‰æ–°å»ºæˆåŠŸï¼Œè¿”å›-1è¡¨ç¤ºå¤±è´¥</span></span><br><span class="line">  workspace[new_index].next = <span class="number">-1</span>;<span class="comment">//æ–°èŠ‚ç‚¹çš„nextåŸŸç½®ç©º</span></span><br><span class="line">  <span class="keyword">return</span> new_index;<span class="comment">//æˆåŠŸçš„è¯ è¿”å›æ–°èŠ‚ç‚¹</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(13) .delete_node()æ–¹æ³•åˆ é™¤èŠ‚ç‚¹</p><p>åˆ é™¤èŠ‚ç‚¹è¦æ³¨æ„çš„æ˜¯ï¼šå¹¶ä¸æ˜¯çœŸçš„åˆ é™¤ï¼Œè€Œæ˜¯æŠŠå½“å‰çš„é“¾è¡¨çš„èŠ‚ç‚¹åŠ åˆ°availableé“¾è¡¨ï¼ˆå¯ç”¨ç©ºé—´é“¾è¡¨ï¼‰ä¸­å»ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N^2)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line"><span class="type">void</span> List2&lt;List_entry&gt;::<span class="built_in">delete_node</span>(index old_index) &#123;</span><br><span class="line">  index previous;</span><br><span class="line">  <span class="keyword">if</span> (old_index == head) <span class="comment">//åˆ å¤´èŠ‚ç‚¹ è®©headä¸ºåŸæ¥å¤´ç»“ç‚¹çš„next</span></span><br><span class="line">    head = workspace[old_index].next;</span><br><span class="line">  <span class="keyword">else</span> &#123; <span class="comment">//åˆ é™¤çš„å…¶ä»–èŠ‚ç‚¹</span></span><br><span class="line">    previous = <span class="built_in">set_position</span>(<span class="built_in">current_position</span>(old_index) - <span class="number">1</span>);<span class="comment">//é€šè¿‡set_positionæ‹¿åˆ°å‰é©±èŠ‚ç‚¹</span></span><br><span class="line">    workspace[previous].next = workspace[old_index].next;<span class="comment">//è®©å‰é©±èŠ‚ç‚¹ç­‰äºå¾…åˆ èŠ‚ç‚¹çš„åç»§</span></span><br><span class="line">  &#125;</span><br><span class="line">  workspace[old_index].next = available;<span class="comment">//é€šè¿‡å¤´æ’çš„æ–¹å¼æŠŠèŠ‚ç‚¹æ·»åŠ åœ¨availableè¡¨ä¸­</span></span><br><span class="line">  available = old_index;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(14) .current_position()æ–¹æ³• è¿”å›å½“å‰çš„ä½ç½®</p><p>é€šè¿‡æŠŠé™æ€é“¾è¡¨éå†countæ¬¡ï¼Œæ¥è¿”å›å½“å‰ä½ç½®çš„èŠ‚ç‚¹ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line"><span class="type">int</span> List2&lt;List_entry&gt;::<span class="built_in">current_position</span>(index n) <span class="type">const</span> &#123; <span class="comment">//æ ¹æ®èŠ‚ç‚¹ æ¥è·å–ä¸‹æ ‡</span></span><br><span class="line">  <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = head; i != n; cnt++, i = workspace[i].next);</span><br><span class="line">  <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®éªŒ3</p><p>\1. é—®é¢˜åˆ†è§£</p><p>è¿åŠ¨ä¼šé¡¹ç›®ç±»ï¼š</p><p>â€‹         <img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps4.jpg" alt="img"></p><p>è¿åŠ¨å‘˜ç±»ï¼š</p><p>â€‹          <img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps5.jpg" alt="img"></p><p>å­¦é™¢ç±»ï¼š</p><p><img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps6.jpg" alt="img"> </p><p>åˆ›å»ºä¸‰ä¸ªç±»çš„çº¿æ€§è¡¨è¿›è¡Œæ“ä½œï¼Œé€šè¿‡ç›®å½•è¿æ¥èµ·æ¥ã€‚</p><ol start="2"><li>åŸºäºçº¿æ€§è¡¨ List1ã€çº¿æ€§è¡¨ List2 å®ç°çº¿æ€§è¡¨çš„åº”ç”¨ï¼šè¿åŠ¨ä¼šä¿¡æ¯ç®¡ç†ï¼Œæµ‹è¯•å’Œè°ƒè¯•ç¨‹åºã€‚</li></ol><p>l ç”¨List1æ¥å­˜æ”¾è¿åŠ¨ä¼šé¡¹ç›®</p><p>l ç”¨List2æ¥å­˜æ”¾è¿åŠ¨å‘˜</p><p>l ç”¨STLåº“ä¸­çš„vectorå­˜æ”¾å­¦é™¢</p><p>get()set()æ–¹æ³•è¾ƒä¸ºç®€å•ï¼Œè§ç¨‹åºæºä»£ç ã€‚</p><p>åˆ†æç›¸å…³çš„å‡½æ•°æ“ä½œï¼š</p><p>æ³¨ï¼šåˆ†ææ—¶é—´å¤æ‚åº¦æ—¶ï¼Œä¸è€ƒè™‘çº¿æ€§è¡¨æœ¬èº«çš„æ—¶é—´å¼€é”€ã€‚</p><p>(1) .è¿åŠ¨ä¼šé¡¹ç›®</p><p>A. void setMatch()æ–°å»ºé¡¹ç›®</p><p>åˆ©ç”¨çº¿æ€§è¡¨çš„æ’å…¥åŠŸèƒ½ï¼Œé€šè¿‡æ„é€ ä¸€ä¸ªmatchå¯¹è±¡æ¥æŠŠmatchå¯¹è±¡é€šè¿‡insert()åˆ°matchsçº¿æ€§è¡¨ä¸­ã€‚é€šè¿‡IOæµå†™é“ç£ç›˜ä¸­ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(1)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">setMatch</span><span class="params">()</span> <span class="comment">//æ–°å»ºé¡¹ç›®</span></span></span><br><span class="line"><span class="function"></span>&#123;  <span class="function">ofstream <span class="title">fout</span><span class="params">(<span class="string">&quot;D:\\æ¯”èµ›é¡¹ç›®.dat&quot;</span>,ios::app)</span></span>;</span><br><span class="line">  <span class="type">char</span> ch;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123; cout&lt;&lt;<span class="string">&quot;è¯·åˆ†åˆ«è¾“å…¥æ¯”èµ›é¡¹ç›®åç§°ã€ç¼–å·ï¼ˆå‡è®¾ä¸º 6 ä½æ•°å­—ï¼‰ã€å‚ä¸è¯¥é¡¹ç›®çš„è¿åŠ¨å‘˜æ€§åˆ«ã€æ¯”èµ› æ—¥æœŸã€æ¯”èµ›æ—¶é—´ã€æ¯”èµ›äººæ•°.&quot;</span>&lt;&lt;endl;</span><br><span class="line">    string call;</span><br><span class="line">    <span class="type">int</span> number;</span><br><span class="line">    string sex;</span><br><span class="line">    string date;</span><br><span class="line">    string time;</span><br><span class="line">    <span class="type">int</span> num;</span><br><span class="line">    cin&gt;&gt;call&gt;&gt;number&gt;&gt;sex&gt;&gt;date&gt;&gt;time&gt;&gt;num;<span class="comment">//è¾“å…¥ç›¸å…³å±æ€§</span></span><br><span class="line">    Match temp = <span class="built_in">Match</span>(call,number,sex,date,time,num);<span class="comment">//åˆ›å»ºä¸€ä¸ªtempä¸´æ—¶å˜é‡</span></span><br><span class="line">    matchs.<span class="built_in">insert</span>(<span class="number">0</span>,temp);<span class="comment">//å¤´æ’åœ¨é“¾è¡¨ä¸­</span></span><br><span class="line"></span><br><span class="line">â€‹    fout.<span class="built_in">write</span>((<span class="type">char</span> *)&amp;temp,<span class="built_in">sizeof</span>(Match));<span class="comment">//å†™å…¥æ–‡ä»¶æµ</span></span><br><span class="line">â€‹    cout&lt;&lt;<span class="string">&quot;æ˜¯å¦ç»§ç»­è¾“å…¥ï¼Œå¦‚æœç»§ç»­é”®å…¥Y|y&quot;</span>&lt;&lt;endl;</span><br><span class="line">â€‹    cin&gt;&gt;ch;</span><br><span class="line">  &#125;<span class="keyword">while</span>(ch==<span class="string">&#x27;y&#x27;</span>||ch==<span class="string">&#x27;Y&#x27;</span>);</span><br><span class="line">  fout.<span class="built_in">close</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ï¼š</p><p><img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps7.jpg" alt="img"> </p><p>B. int changeMatch()ä¿®æ”¹ä¸€ä¸ªé¡¹ç›®</p><p>å› ä¸ºæ‰€æœ‰é¡¹ç›®ä¸­æœ€ç‰¹æ®Šçš„å°±æ˜¯é¡¹ç›®çš„idå”¯ä¸€ï¼Œæ‰€ä»¥ä¿®æ”¹åªèƒ½é€šè¿‡æŸ¥è¯¢idæ¥å®Œæˆï¼Œéå†çº¿æ€§è¡¨ï¼Œæ‰¾åˆ°è¦ä¿®æ”¹çš„é¡¹ç›®ï¼Œæ ¹æ®æç¤ºå®Œæˆè¦ä¿®æ”¹çš„ä¿¡æ¯ï¼Œé€šè¿‡replace()å‡½æ•°ï¼Œå®Œæˆä¿®æ”¹çš„æ“ä½œã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">changeMatch</span><span class="params">()</span>  <span class="comment">//ä¿®æ”¹ä¸€ä¸ªé¡¹ç›®</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;æ‚¨æ­£åœ¨è¿›è¡Œä¿®æ”¹æ¯”èµ›é¡¹ç›®æœ‰å…³äº‹é¡¹æ“ä½œ!&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥è¦ä¿®æ”¹æ¯”èµ›é¡¹ç›®çš„ç¼–å·:&quot;</span>&lt;&lt;endl;</span><br><span class="line">  <span class="type">int</span> number1;    <span class="comment">//è¦ä¿®æ”¹çš„æ¯”èµ›é¡¹ç›®ç¼–å·</span></span><br><span class="line">  <span class="type">int</span> sign=<span class="number">0</span>;     <span class="comment">//è®¾ç½®çš„æ ‡è®°å˜é‡</span></span><br><span class="line">  cin&gt;&gt;number1;</span><br><span class="line">  <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (; i &lt; matchs.<span class="built_in">size</span>(); i++) &#123; <span class="comment">//éå†è¡¨ æ‰¾æŒ‡å®šçš„é¡¹ç›®ç¼–å·</span></span><br><span class="line">    Match temp;</span><br><span class="line">    matchs.<span class="built_in">retrieve</span>(i,temp);</span><br><span class="line">    <span class="keyword">if</span> (number1 == temp.<span class="built_in">getNumber</span>())&#123;</span><br><span class="line">      sign = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//æ²¡æ‰¾åˆ°çš„è¯ è¾“å‡ºä¿¡æ¯æç¤º</span></span><br><span class="line">  <span class="keyword">if</span> (sign==<span class="number">0</span>)</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;æ²¡æœ‰æ‰¾åˆ°è¦ä¿®æ”¹çš„è®°å½•ï¼&quot;</span>&lt;&lt;endl;</span><br><span class="line">  <span class="keyword">else</span> <span class="comment">//æ‰¾åˆ°äº†é¡¹ç›®</span></span><br><span class="line">  &#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;è¯·é€‰æ‹©è¦ä¿®æ”¹æ¯”èµ›é¡¹ç›®çš„é‚£äº›ä¿¡æ¯&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;------ä¿®æ”¹æ¯”èµ›é¡¹ç›®çš„åç§°----1&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;------ä¿®æ”¹æ¯”èµ›é¡¹ç›®çš„ç¼–å·----2&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;------ä¿®æ”¹æ¯”èµ›é¡¹ç›®çš„æ€§åˆ«----3&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;------ä¿®æ”¹æ¯”èµ›æ—¥æœŸ----4&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;------ä¿®æ”¹æ¯”èµ›æ—¶é—´----5&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;------ä¿®æ”¹æ¯”èµ›äººæ•°----6&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥å¯¹åº”ä¿¡æ¯çš„ç¼–å·&quot;</span>&lt;&lt;endl;</span><br><span class="line">    <span class="type">int</span> a;</span><br><span class="line">    cin&gt;&gt;a;</span><br><span class="line">    <span class="keyword">switch</span>(a) <span class="comment">//switch case æ§åˆ¶ä¿®æ”¹çš„é‚£ä¸€éƒ¨åˆ†</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥æ–°çš„æ¯”èµ›é¡¹ç›®åç§°:&quot;</span>&lt;&lt;endl;</span><br><span class="line">        string name;</span><br><span class="line">        cin&gt;&gt;name;</span><br><span class="line">        Match temp;</span><br><span class="line">        matchs.<span class="built_in">retrieve</span>(i,temp);<span class="comment">//é€šè¿‡ä¸Šæ¬¡æ ‡è®°çš„i æ‹¿å‡ºæ¥æ‰¾åˆ°çš„é¡¹ç›®</span></span><br><span class="line">        temp.<span class="built_in">setCall</span>(name);<span class="comment">//ä¿®æ”¹é¡¹ç›®å§“å</span></span><br><span class="line">        matchs.<span class="built_in">replace</span>(i,temp);<span class="comment">//å¯¹è¡¨ä¸­çš„æ•°æ®è¿›è¡Œæ›¿æ¢</span></span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;æ¯”èµ›é¡¹ç›®åç§°ä¿®æ”¹æˆåŠŸ!&quot;</span>&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;è¯·è¾“å…¥æ–°çš„æ¯”èµ›ç¼–å·:&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="type">int</span> number;</span><br><span class="line">        cin&gt;&gt;number;</span><br><span class="line">        Match match;</span><br><span class="line">        matchs.<span class="built_in">remove</span>(i,match);</span><br><span class="line">        match.<span class="built_in">setNumber</span>(number);</span><br><span class="line">        matchs.<span class="built_in">insert</span>(i,match);</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;æ¯”èµ›é¡¹ç›®ç¼–å·ä¿®æ”¹æˆåŠŸ!&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥æ–°çš„å‚èµ›é€‰æ‰‹æ€§åˆ«:&quot;</span>&lt;&lt;endl;</span><br><span class="line">        string sex;</span><br><span class="line">        cin&gt;&gt;sex;</span><br><span class="line">        Match match;</span><br><span class="line">        matchs.<span class="built_in">remove</span>(i,match);</span><br><span class="line">        match.<span class="built_in">setSex</span>(sex);</span><br><span class="line">        matchs.<span class="built_in">insert</span>(i,match);</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;å‚èµ›é€‰æ‰‹æ€§åˆ«ä¿®æ”¹æˆåŠŸ!&quot;</span>&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥æ–°çš„æ—¥æœŸ:&quot;</span>&lt;&lt;endl;</span><br><span class="line">        string date;</span><br><span class="line">        cin&gt;&gt;date;</span><br><span class="line">        Match match;</span><br><span class="line">        matchs.<span class="built_in">remove</span>(i,match);</span><br><span class="line">        match.<span class="built_in">setDate</span>(date);</span><br><span class="line">        matchs.<span class="built_in">insert</span>(i,match);</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;æ¯”èµ›æ—¥æœŸä¿®æ”¹æˆåŠŸ!&quot;</span>&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">5</span>:&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥æ–°çš„æ¯”èµ›æ—¶é—´:&quot;</span>&lt;&lt;endl;</span><br><span class="line">        string time;</span><br><span class="line">        cin&gt;&gt;time;</span><br><span class="line">        Match match;</span><br><span class="line">        matchs.<span class="built_in">remove</span>(i,match);</span><br><span class="line">        match.<span class="built_in">setDate</span>(time);</span><br><span class="line">        matchs.<span class="built_in">insert</span>(i,match);</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;æ¯”èµ›æ—¶é—´ä¿®æ”¹æˆåŠŸ!&quot;</span>&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">6</span>:&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥æ–°çš„å‚èµ›äººæ•°:&quot;</span>&lt;&lt;endl;</span><br><span class="line">        <span class="type">int</span> num;</span><br><span class="line">        cin&gt;&gt;num;</span><br><span class="line">        Match match;</span><br><span class="line">        matchs.<span class="built_in">remove</span>(i,match);</span><br><span class="line">        match.<span class="built_in">setNum</span>(num);</span><br><span class="line">        matchs.<span class="built_in">insert</span>(i,match);</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;å‚èµ›äººæ•°ä¿®æ”¹æˆåŠŸ!&quot;</span>&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•:</p><p><img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps8.jpg" alt="img"> </p><p><img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps9.jpg" alt="img"> </p><p>C. void deleteMatch()åˆ é™¤ä¸€ä¸ªé¡¹ç›®</p><p>åˆ é™¤ä¸€ä¸ªé¡¹ç›®ï¼Œå¯ä»¥é€šè¿‡idæ¥è¿›è¡Œåˆ é™¤ï¼Œä¹Ÿå¯ä»¥é€šè¿‡é¡¹ç›®åç§°æ¥åˆ é™¤ï¼Œéå†çº¿æ€§è¡¨ï¼Œæ‰¾åˆ°éœ€è¦åˆ é™¤çš„æ•°æ®ï¼Œé€šè¿‡çº¿æ€§è¡¨çš„remove()æ“ä½œå¯¹é¡¹ç›®è¿›è¡Œåˆ é™¤ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">deleteMatch</span><span class="params">()</span>  <span class="comment">//åˆ é™¤ä¸€ä¸ªé¡¹ç›®</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;------æ ¹æ®æ¯”èµ›é¡¹ç›®çš„ç¼–å·åˆ é™¤----1&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;------æ ¹æ®æ¯”èµ›é¡¹ç›®çš„åç§°åˆ é™¤----2&quot;</span>&lt;&lt;endl;</span><br><span class="line">  <span class="type">int</span> n;</span><br><span class="line">  cin&gt;&gt;n;</span><br><span class="line">  <span class="keyword">switch</span>(n) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>: &#123;</span><br><span class="line">      cout &lt;&lt; <span class="string">&quot;è¯·è¾“å…¥è¦åˆ é™¤çš„æ¯”èµ›ç¼–å·&quot;</span> &lt;&lt; endl;</span><br><span class="line">      <span class="type">int</span> number;</span><br><span class="line">      cin &gt;&gt; number;</span><br><span class="line">      Match temp;</span><br><span class="line">      <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">      <span class="type">bool</span> isFind = <span class="literal">false</span>;<span class="comment">//æ ‡è®°</span></span><br><span class="line">      <span class="keyword">for</span> (; i &lt; matchs.<span class="built_in">size</span>(); i++) &#123; <span class="comment">//éå†æ•´ä¸ªè¡¨ å¦‚æœæ‰¾åˆ° å°±é€šè¿‡removeè¿›è¡Œåˆ é™¤</span></span><br><span class="line">        matchs.<span class="built_in">retrieve</span>(i, temp);</span><br><span class="line">        <span class="keyword">if</span> (temp.<span class="built_in">getNumber</span>() == number) &#123;</span><br><span class="line">          cout &lt;&lt; <span class="string">&quot;æ‰¾åˆ°ä¿¡æ¯&quot;</span> &lt;&lt; endl;</span><br><span class="line">          matchs.<span class="built_in">remove</span>(i, temp);</span><br><span class="line">          cout &lt;&lt; <span class="string">&quot;åˆ é™¤æˆåŠŸ&quot;</span> &lt;&lt; endl;</span><br><span class="line">          isFind = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">//æ²¡æ‰¾åˆ°çš„è¯ è¾“å‡ºä¿¡æ¯æç¤º</span></span><br><span class="line">      <span class="keyword">if</span> (!isFind) cout &lt;&lt; <span class="string">&quot;æœªæ‰¾åˆ°è¯¥é¡¹ç›®&quot;</span> &lt;&lt; endl;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>: &#123;</span><br><span class="line">      cout &lt;&lt; <span class="string">&quot;è¯·è¾“å…¥è¦åˆ é™¤çš„æ¯”èµ›åç§°&quot;</span> &lt;&lt; endl;</span><br><span class="line">      string name;</span><br><span class="line">      cin &gt;&gt; name;</span><br><span class="line">      Match temp;</span><br><span class="line">      <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">      <span class="type">bool</span> isFind = <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">for</span> (; i &lt; matchs.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">        matchs.<span class="built_in">retrieve</span>(i, temp);</span><br><span class="line">        <span class="keyword">if</span> (temp.<span class="built_in">getCall</span>() == name) &#123;</span><br><span class="line">          cout &lt;&lt; <span class="string">&quot;æ‰¾åˆ°ä¿¡æ¯&quot;</span> &lt;&lt; endl;</span><br><span class="line">          matchs.<span class="built_in">remove</span>(i, temp);</span><br><span class="line">          cout &lt;&lt; <span class="string">&quot;åˆ é™¤æˆåŠŸ&quot;</span> &lt;&lt; endl;</span><br><span class="line">          isFind = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">//æ²¡æ‰¾åˆ°çš„è¯ è¾“å‡ºä¿¡æ¯æç¤º</span></span><br><span class="line">      <span class="keyword">if</span> (!isFind) cout &lt;&lt; <span class="string">&quot;æœªæ‰¾åˆ°è¯¥é¡¹ç›®&quot;</span> &lt;&lt; endl;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•:</p><p><img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps10.jpg" alt="img"> </p><p><img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps11.jpg" alt="img"> </p><p>D. void selectMatch()æŸ¥è¯¢ä¸€ä¸ªé¡¹ç›®</p><p>æŸ¥è¯¢ä¸€ä¸ªé¡¹ç›®ï¼Œå¯ä»¥é€šè¿‡idæ¥è¿›è¡ŒæŸ¥è¯¢ï¼Œä¹Ÿå¯ä»¥é€šè¿‡é¡¹ç›®åç§°æ¥æŸ¥è¯¢ï¼Œéå†çº¿æ€§è¡¨ï¼Œæ‰¾åˆ°éœ€è¦æŸ¥è¯¢çš„æ•°æ®ï¼Œå°†è¯¥ä¿¡æ¯è¿›è¡Œè¾“å‡ºã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">selectMatch</span><span class="params">()</span> <span class="comment">//æŸ¥è¯¢ä¸€ä¸ªé¡¹ç›®</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;------æ ¹æ®æ¯”èµ›é¡¹ç›®çš„ç¼–å·æŸ¥æ‰¾----1&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;------æ ¹æ®æ¯”èµ›é¡¹ç›®çš„åç§°æŸ¥æ‰¾----2&quot;</span>&lt;&lt;endl;</span><br><span class="line">  <span class="type">int</span> n;</span><br><span class="line">  cin&gt;&gt;n;</span><br><span class="line">  <span class="keyword">switch</span>(n) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>: &#123;</span><br><span class="line">      cout &lt;&lt; <span class="string">&quot;è¯·è¾“å…¥è¦æŸ¥æ‰¾çš„æ¯”èµ›ç¼–å·&quot;</span> &lt;&lt; endl;</span><br><span class="line">      <span class="type">int</span> number;</span><br><span class="line">      cin &gt;&gt; number;</span><br><span class="line">      Match temp;</span><br><span class="line">      <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">      <span class="type">bool</span> isFind = <span class="literal">false</span>;<span class="comment">//æ ‡å¿—ä½</span></span><br><span class="line">      <span class="keyword">for</span> (; i &lt; matchs.<span class="built_in">size</span>(); i++) &#123; <span class="comment">//éå†æ•´å¼ è¡¨ å¦‚æœæ‰¾åˆ° è®©æ ‡å¿—ä½è®¾ä¸ºtrue</span></span><br><span class="line">        matchs.<span class="built_in">retrieve</span>(i, temp);</span><br><span class="line">        <span class="keyword">if</span> (temp.<span class="built_in">getNumber</span>() == number) &#123; <span class="comment">//æ‰¾åˆ°ä¿¡æ¯çš„è¯ å°±æŠŠç›¸å…³çš„ä¿¡æ¯è¿›è¡Œè¾“å‡º</span></span><br><span class="line">          cout &lt;&lt; <span class="string">&quot;æ‰¾åˆ°ä¿¡æ¯ï¼š&quot;</span> &lt;&lt; endl;</span><br><span class="line">          cout&lt;&lt;temp.<span class="built_in">getNumber</span>()&lt;&lt;<span class="string">&quot; &quot;</span> &lt;&lt;temp.<span class="built_in">getCall</span>()&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;temp.<span class="built_in">getSex</span>()&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;temp.<span class="built_in">getDate</span>()&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;temp.<span class="built_in">getTime</span>()&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;temp.<span class="built_in">getNum</span>()&lt;&lt;endl;</span><br><span class="line">          isFind = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">//æ²¡æ‰¾åˆ°çš„è¯ è¾“å‡ºä¿¡æ¯æç¤º</span></span><br><span class="line">      <span class="keyword">if</span> (!isFind) cout &lt;&lt; <span class="string">&quot;æœªæ‰¾åˆ°è¯¥é¡¹ç›®&quot;</span> &lt;&lt; endl;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>: &#123;</span><br><span class="line">      cout &lt;&lt; <span class="string">&quot;è¯·è¾“å…¥è¦åˆ é™¤çš„æ¯”èµ›åç§°&quot;</span> &lt;&lt; endl;</span><br><span class="line">      string name;</span><br><span class="line">      cin &gt;&gt; name;</span><br><span class="line">      Match temp;</span><br><span class="line">      <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">      <span class="type">bool</span> isFind = <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">for</span> (; i &lt; matchs.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">        matchs.<span class="built_in">retrieve</span>(i, temp);</span><br><span class="line">        <span class="keyword">if</span> (temp.<span class="built_in">getCall</span>() == name) &#123;</span><br><span class="line">          cout &lt;&lt; <span class="string">&quot;æ‰¾åˆ°ä¿¡æ¯ï¼š&quot;</span> &lt;&lt; endl;</span><br><span class="line">          cout&lt;&lt;temp.<span class="built_in">getNumber</span>()&lt;&lt;<span class="string">&quot; &quot;</span> &lt;&lt;temp.<span class="built_in">getCall</span>()&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;temp.<span class="built_in">getSex</span>()&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;temp.<span class="built_in">getDate</span>()&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;temp.<span class="built_in">getTime</span>()&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;temp.<span class="built_in">getNum</span>()&lt;&lt;endl;</span><br><span class="line">          isFind = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (!isFind) cout &lt;&lt; <span class="string">&quot;æœªæ‰¾åˆ°è¯¥é¡¹ç›®&quot;</span> &lt;&lt; endl;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ï¼š</p><p><img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps12.jpg" alt="img"> </p><p>(2) .è¿åŠ¨å‘˜</p><p>A. void inputAthlete()æ–°å»ºè¿åŠ¨å‘˜</p><p>åˆ©ç”¨çº¿æ€§è¡¨çš„æ’å…¥åŠŸèƒ½ï¼Œé€šè¿‡æ„é€ ä¸€ä¸ªaehleteå¯¹è±¡æ¥æŠŠaehleteå¯¹è±¡é€šè¿‡insert()åˆ°aehletesçº¿æ€§è¡¨ä¸­ã€‚é€šè¿‡IOæµå†™é“ç£ç›˜ä¸­ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(1)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">inputAthlete</span><span class="params">()</span><span class="comment">//åˆ›å»ºè¿åŠ¨å‘˜</span></span></span><br><span class="line"><span class="function"></span>&#123;  <span class="function">ofstream <span class="title">fout</span><span class="params">(<span class="string">&quot;d:\\è¿åŠ¨å‘˜.dat&quot;</span>,ios::app)</span></span>;<span class="comment">//æ‰“å¼€æ–‡ä»¶</span></span><br><span class="line">  <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="type">char</span> ch;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;  cout&lt;&lt;<span class="string">&quot;è¯·åˆ†åˆ«è¾“å…¥è¿åŠ¨å‘˜å§“åï¼Œå­¦å·ï¼Œæ€§åˆ«ï¼Œå­¦é™¢ï¼Œå‚åŠ çš„é¡¹ç›®æ ‡å·&quot;</span>&lt;&lt;endl;</span><br><span class="line">    string name;</span><br><span class="line">    string id;</span><br><span class="line">    string sex;</span><br><span class="line">    string college;</span><br><span class="line">    string matchId;</span><br><span class="line">    cin&gt;&gt;name&gt;&gt;id&gt;&gt;sex&gt;&gt;college&gt;&gt;matchId;<span class="comment">//è¾“å…¥ç›¸å…³ä¿¡æ¯</span></span><br><span class="line">    <span class="function">Athlete <span class="title">temp</span><span class="params">(name,id,sex,college,matchId)</span></span>;<span class="comment">//åˆ›å»ºtempå¯¹è±¡</span></span><br><span class="line">    athletes.<span class="built_in">insert</span>(i,temp);<span class="comment">//æ’å…¥åˆ°çº¿æ€§è¡¨ä¸­</span></span><br><span class="line">    fout.<span class="built_in">write</span>((<span class="type">char</span> *)&amp;temp,<span class="built_in">sizeof</span>(Athlete));<span class="comment">//å†™å…¥æ–‡ä»¶</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;æ˜¯å¦ç»§ç»­è¾“å…¥ï¼Œå¦‚æœç»§ç»­é”®å…¥Y|y&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cin&gt;&gt;ch;</span><br><span class="line">  &#125;<span class="keyword">while</span>(ch==<span class="string">&#x27;y&#x27;</span>||ch==<span class="string">&#x27;Y&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br></pre></td></tr></table></figure><p>æµ‹è¯•ï¼š</p><p><img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps13.jpg" alt="img"> </p><p>B. Void deleteAthlete()æ’¤é”€æŠ¥å</p><p>åŒç†ï¼Œå› ä¸ºæ‰€æœ‰è¿åŠ¨å‘˜ä¸­æœ€ç‰¹æ®Šçš„å°±æ˜¯è¿åŠ¨å‘˜çš„å­¦å·idå”¯ä¸€ï¼Œæ‰€ä»¥æ’¤é”€æŠ¥ååªèƒ½é€šè¿‡æŸ¥è¯¢idæ¥å®Œæˆï¼Œéå†çº¿æ€§è¡¨ï¼Œæ‰¾åˆ°è¦ä¿®æ”¹çš„æ’¤é”€æŠ¥åçš„è¿åŠ¨å‘˜ï¼Œé€šè¿‡remove()å‡½æ•°ï¼Œå®Œæˆä¿®æ”¹çš„æ“ä½œã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span>  <span class="title">deleteAthlete</span><span class="params">()</span><span class="comment">//æ’¤é”€æŠ¥å ï¼ˆåˆ é™¤è¿åŠ¨å‘˜ï¼‰</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">//åªæœ‰å­¦å·æ˜¯å”¯ä¸€çš„ï¼Œæ‰€ä»¥æ ¹æ®å­¦å·æ¥æ’¤é”€æŠ¥å</span></span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥è¢«æ’¤é”€æŠ¥åçš„è¿åŠ¨å‘˜çš„å­¦å·&quot;</span>&lt;&lt;endl;</span><br><span class="line">  string id;</span><br><span class="line">  cin&gt;&gt;id;</span><br><span class="line">  Athlete temp;</span><br><span class="line">  <span class="type">bool</span> flag =<span class="literal">false</span>;<span class="comment">//æ ‡å¿—ä½</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; athletes.<span class="built_in">size</span>(); i++) &#123; <span class="comment">//éå†è¡¨ æ¥å¯»æ‰¾</span></span><br><span class="line">    athletes.<span class="built_in">retrieve</span>(i,temp);</span><br><span class="line">    <span class="keyword">if</span> (temp.<span class="built_in">getId</span>() == id) &#123;<span class="comment">//æ‰¾åˆ° é€šè¿‡removeç§»é™¤</span></span><br><span class="line">      athletes.<span class="built_in">remove</span>(i,temp);</span><br><span class="line">      cout&lt;&lt;<span class="string">&quot;åˆ é™¤æˆåŠŸ&quot;</span>&lt;&lt;endl;</span><br><span class="line">      flag = <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//æœªæ‰¾åˆ°è¿åŠ¨å‘˜ è¾“å‡ºä¿¡æ¯è¿›è¡Œæç¤º</span></span><br><span class="line">  <span class="keyword">if</span> (!flag) &#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;æœªæ‰¾åˆ°è¯¥è¿åŠ¨å‘˜&quot;</span>&lt;&lt;endl;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ï¼š</p><p><img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps14.jpg" alt="img"> </p><p><img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps15.jpg" alt="img"> </p><p>C. void cheekAthlete()å¯¹è¿åŠ¨å‘˜æ£€å½•</p><p>å› ä¸ºæ‰€æœ‰è¿åŠ¨å‘˜ä¸­æœ€ç‰¹æ®Šçš„å°±æ˜¯è¿åŠ¨å‘˜çš„å­¦å·idå”¯ä¸€ï¼Œæ‰€ä»¥å¯¹è¿åŠ¨å‘˜æ£€å½•åªèƒ½é€šè¿‡æŸ¥è¯¢idæ¥å®Œæˆï¼Œéå†çº¿æ€§è¡¨ï¼Œæ‰¾åˆ°è¦æ£€å½•çš„è¿åŠ¨å‘˜ï¼Œé€šè¿‡retrieve()å‡½æ•°æŠŠå€¼flagæ‹¿å‡ºæ¥æ£€å½•åé€šè¿‡replace()å®Œæˆæ›¿æ¢ï¼Œå®Œæˆä¿®æ”¹çš„æ“ä½œã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">cheekAthlete</span><span class="params">()</span></span>&#123;<span class="comment">//å¯¹è¿åŠ¨å‘˜æ£€å½•</span></span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥è¦æ£€å½•çš„è¿åŠ¨å‘˜çš„å­¦å·&quot;</span>&lt;&lt;endl;</span><br><span class="line">  string id;</span><br><span class="line">  cin&gt;&gt;id;</span><br><span class="line">  Athlete temp;</span><br><span class="line">  <span class="type">bool</span> flag =<span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; athletes.<span class="built_in">size</span>(); i++) &#123;<span class="comment">//éå†çº¿æ€§è¡¨</span></span><br><span class="line">    athletes.<span class="built_in">retrieve</span>(i,temp);</span><br><span class="line">    <span class="keyword">if</span> (temp.<span class="built_in">getId</span>() == id) &#123; <span class="comment">//å¦‚æœæ‰¾åˆ°äº†</span></span><br><span class="line">      <span class="keyword">if</span> (temp.<span class="built_in">isText1</span>()) &#123; <span class="comment">//å…ˆçœ‹æœ‰æ²¡æœ‰æ£€å½•è¿‡</span></span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;å·²ç»æ£€å½•è¿‡äº†&quot;</span>&lt;&lt;endl;</span><br><span class="line">        flag = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123; <span class="comment">//æ²¡æ£€å½•è¿‡ æ£€å½• replaceæ›¿æ¢è¡¨çš„æ•°æ®</span></span><br><span class="line">        temp.<span class="built_in">setIsText</span>(<span class="literal">true</span>);</span><br><span class="line">        athletes.<span class="built_in">replace</span>(i,temp);</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;æ£€å½•æˆåŠŸ&quot;</span>&lt;&lt;endl;</span><br><span class="line">        flag = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//æ²¡æ‰¾åˆ°çš„è¯ç»™å‡ºæç¤ºä¿¡æ¯</span></span><br><span class="line">  <span class="keyword">if</span> (!flag) &#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;æœªæ‰¾åˆ°è¯¥è¿åŠ¨å‘˜&quot;</span>&lt;&lt;endl;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ï¼š</p><p><img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps16.jpg" alt="img"> </p><p>D. void loginScoreAthlete()ç™»è®°è¿åŠ¨å‘˜çš„æˆç»©</p><p>æŸé¡¹æ¯”èµ›å®Œæˆåï¼Œå½•å…¥å‚åŠ æ¯”èµ›åŒå­¦çš„æˆç»©ã€æ’åï¼Œå¹¶è‡ªåŠ¨è·å¾—åˆ†æ•°ã€‚é€šè¿‡å¯¹è¾“å…¥çš„æ’åè¿›è¡Œè®¿é—®ï¼Œæ ¹æ®ä¸åŒçš„æ’åæ¥å¯¹è¿åŠ¨å‘˜çš„æˆç»©å±æ€§èµ‹ä¸åŒçš„å€¼ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">loginScoreAthlete</span><span class="params">()</span></span>&#123;<span class="comment">//ç­‰çº§è¿åŠ¨å‘˜çš„ä¿¡æ¯</span></span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥è¦å½•å…¥åˆ†æ•°çš„è¿åŠ¨å‘˜çš„å­¦å·&quot;</span>&lt;&lt;endl;</span><br><span class="line">  string id;</span><br><span class="line">  cin&gt;&gt;id;</span><br><span class="line">  Athlete temp;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥è¯¥è¿åŠ¨å‘˜çš„æˆç»© å’Œ æ’å&quot;</span>&lt;&lt;endl;</span><br><span class="line">  string score;</span><br><span class="line">  <span class="type">int</span> rank;</span><br><span class="line">  cin&gt;&gt;score;<span class="comment">//æˆç»©</span></span><br><span class="line">  cin&gt;&gt;rank;<span class="comment">//æ’å</span></span><br><span class="line">  <span class="type">bool</span> flag =<span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; athletes.<span class="built_in">size</span>(); i++) &#123; <span class="comment">//éå†æ•´ä¸ªè¡¨ æ‰¾åˆ°è¦ç™»è®°æˆç»©çš„å­¦ç”Ÿ</span></span><br><span class="line">    athletes.<span class="built_in">retrieve</span>(i,temp);</span><br><span class="line">    <span class="keyword">if</span> (temp.<span class="built_in">getId</span>() == id &amp;&amp; temp.<span class="built_in">isText1</span>()) &#123;<span class="comment">//å¦‚æœidæŸ¥åˆ°ï¼Œå¹¶ä¸”æ£€å½•è¿‡äº†</span></span><br><span class="line">      temp.<span class="built_in">setScore</span>(score);</span><br><span class="line">      temp.<span class="built_in">setRank</span>(rank);<span class="comment">//ç™»è®°ä¿¡æ¯</span></span><br><span class="line">      athletes.<span class="built_in">replace</span>(i,temp);<span class="comment">//æ›¿æ¢è¡¨ä¸­çš„æ•°æ®</span></span><br><span class="line">      cout&lt;&lt;<span class="string">&quot;æˆç»©å½•å…¥å®Œæˆ&quot;</span>&lt;&lt;endl;</span><br><span class="line">      flag = <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//æ²¡æ‰¾åˆ°çš„è¯ç»™å‡ºæç¤ºä¿¡æ¯</span></span><br><span class="line">  <span class="keyword">if</span> (!flag) &#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;æœªæ‰¾åˆ°è¯¥è¿åŠ¨å‘˜æˆ–è€…è¯¥è¿åŠ¨å‘˜æ²¡æœ‰æ£€å½•&quot;</span>&lt;&lt;endl;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•:</p><p><img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps17.jpg" alt="img"> </p><p>E. void selectAthlete()æŸ¥è¯¢è¿åŠ¨å‘˜</p><p>å› ä¸ºæ‰€æœ‰è¿åŠ¨å‘˜ä¸­æœ€ç‰¹æ®Šçš„å°±æ˜¯è¿åŠ¨å‘˜çš„å­¦å·idå”¯ä¸€ï¼Œæ‰€ä»¥å¯¹è¿åŠ¨å‘˜æŸ¥è¯¢åªèƒ½é€šè¿‡æŸ¥è¯¢idæ¥å®Œæˆï¼Œéå†çº¿æ€§è¡¨ï¼Œæ‰¾åˆ°è¦æŸ¥è¯¢çš„è¿åŠ¨å‘˜ï¼Œé€šè¿‡retrieve()å‡½æ•°æŠŠè¿åŠ¨å‘˜æ‹¿å‡ºæ¥ä¹‹åï¼Œè¾“å‡ºä¿¡æ¯ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">selectAthlete</span><span class="params">()</span> </span>&#123; <span class="comment">//æŸ¥è¯¢è¿åŠ¨å‘˜ä¿¡æ¯</span></span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥è¦æŸ¥è¯¢çš„è¿åŠ¨å‘˜çš„å­¦å·&quot;</span>&lt;&lt;endl;</span><br><span class="line">  string id;</span><br><span class="line">  cin&gt;&gt;id;</span><br><span class="line">  Athlete temp;</span><br><span class="line">  <span class="type">bool</span> flag =<span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; athletes.<span class="built_in">size</span>(); i++) &#123; <span class="comment">//éå†æ•´ä¸ªè¡¨ æ‰¾åˆ°æŒ‡å®šçš„è¿åŠ¨å‘˜</span></span><br><span class="line">    athletes.<span class="built_in">retrieve</span>(i,temp);</span><br><span class="line">    <span class="keyword">if</span> (temp.<span class="built_in">getId</span>() == id) &#123;</span><br><span class="line">      athletes.<span class="built_in">remove</span>(i,temp);</span><br><span class="line">      <span class="comment">//æ‰¾åˆ°äº† è¾“å‡ºç›¸å…³ä¿¡æ¯</span></span><br><span class="line">      cout&lt;&lt;<span class="string">&quot;å­¦å·:&quot;</span>&lt;&lt;temp.<span class="built_in">getId</span>()&lt;&lt;<span class="string">&quot; å§“åï¼š&quot;</span>&lt;&lt;temp.<span class="built_in">getName</span>()&lt;&lt; <span class="string">&quot; æ€§åˆ«ï¼š&quot;</span>&lt;&lt;temp.<span class="built_in">getSex</span>()&lt;&lt;<span class="string">&quot; å­¦é™¢ï¼š&quot;</span>&lt;&lt;temp.<span class="built_in">getCollege</span>()</span><br><span class="line">        &lt;&lt; <span class="string">&quot; å‚åŠ çš„é¡¹ç›®ç¼–å·ï¼š&quot;</span>&lt;&lt;temp.<span class="built_in">getMatchId</span>()&lt;&lt;<span class="string">&quot; æ˜¯å¦æ£€å½•ï¼š&quot;</span>&lt;&lt;temp.<span class="built_in">isText1</span>()&lt;&lt;<span class="string">&quot; å‚èµ›æˆç»©ï¼š&quot;</span>&lt;&lt;temp.<span class="built_in">getScore</span>()</span><br><span class="line">        &lt;&lt;<span class="string">&quot; æ’åï¼š&quot;</span>&lt;&lt;temp.<span class="built_in">getRank</span>()&lt;&lt;<span class="string">&quot; è·å¾—çš„åˆ†æ•°ï¼š&quot;</span>&lt;&lt;temp.<span class="built_in">getGrade</span>()&lt;&lt;endl;</span><br><span class="line">      flag = <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//æ²¡æ‰¾åˆ°çš„è¯ç»™å‡ºæç¤ºä¿¡æ¯</span></span><br><span class="line">  <span class="keyword">if</span> (!flag) &#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;æœªæ‰¾åˆ°è¯¥è¿åŠ¨å‘˜&quot;</span>&lt;&lt;endl;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ï¼š</p><p><img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps18.jpg" alt="img"> </p><p>F. void reviceAthlete()ä¿®æ”¹è¿åŠ¨å‘˜ä¿¡æ¯</p><p>åŒç†ï¼Œå› ä¸ºæ‰€æœ‰è¿åŠ¨å‘˜ä¸­æœ€ç‰¹æ®Šçš„å°±æ˜¯è¿åŠ¨å‘˜çš„å­¦å·idå”¯ä¸€ï¼Œæ‰€ä»¥ä¿®æ”¹ä¿¡æ¯åªèƒ½é€šè¿‡æŸ¥è¯¢idæ¥å®Œæˆï¼Œéå†çº¿æ€§è¡¨ï¼Œæ‰¾åˆ°è¦ä¿®æ”¹çš„ä¿¡æ¯çš„è¿åŠ¨å‘˜ï¼Œé€šè¿‡retrieve()å‡½æ•°ï¼Œå…ˆæŠŠå€¼æ‹¿å‡ºæ¥ï¼Œå†é€šè¿‡remove()ç§»é™¤å€¼ï¼Œå†é€šè¿‡insert()è¿›è¡Œæ’å…¥å®Œæˆä¿®æ”¹çš„æ“ä½œã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">reviceAthlete</span><span class="params">()</span></span>&#123; <span class="comment">//ä¿®æ”¹è¿åŠ¨å‘˜ä¿¡æ¯</span></span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥è¦ä¿®æ”¹çš„è¿åŠ¨å‘˜çš„å­¦å·&quot;</span>&lt;&lt;endl;</span><br><span class="line">  string id;</span><br><span class="line">  cin&gt;&gt;id;</span><br><span class="line">  Athlete temp;</span><br><span class="line">  <span class="type">bool</span> flag =<span class="literal">false</span>;</span><br><span class="line">  <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (; i &lt; athletes.<span class="built_in">size</span>(); i++) &#123; <span class="comment">//æ‰¾åˆ° æŒ‡å®šå­¦å·çš„è¿åŠ¨å‘˜</span></span><br><span class="line">    athletes.<span class="built_in">retrieve</span>(i,temp);</span><br><span class="line">    <span class="keyword">if</span> (temp.<span class="built_in">getId</span>() == id) &#123;</span><br><span class="line">      flag = <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (!flag) &#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;æœªæ‰¾åˆ°è¯¥è¿åŠ¨å‘˜&quot;</span>&lt;&lt;endl;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;è¯·é€‰æ‹©è¦ä¿®æ”¹è¿åŠ¨å‘˜çš„é‚£äº›ä¿¡æ¯&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;------ä¿®æ”¹è¿åŠ¨å‘˜çš„å§“å----1&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;------ä¿®æ”¹è¿åŠ¨å‘˜çš„å­¦å·----2&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;------ä¿®æ”¹è¿åŠ¨å‘˜çš„æ€§åˆ«----3&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;------ä¿®æ”¹è¿åŠ¨å‘˜å­¦é™¢----4&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;------ä¿®æ”¹è¿åŠ¨å‘˜å‚èµ›é¡¹ç›®ç¼–å·----5&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;è¿åŠ¨å‘˜çš„æ£€å½•ï¼Œæˆç»©æ’åï¼Œåˆ†æ•°ï¼Œä¸äºˆä¿®æ”¹ï¼Œè¯·ä½¿ç”¨ä¸Šä¸€æ­¥çš„å‡½æ•°æ“ä½œ&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥å¯¹åº”ä¿¡æ¯çš„ç¼–å·&quot;</span>&lt;&lt;endl;</span><br><span class="line">    <span class="type">int</span> a;</span><br><span class="line">    cin&gt;&gt;a;</span><br><span class="line">    <span class="keyword">switch</span>(a)&#123; <span class="comment">//è¿åŠ¨å‘˜çš„æ£€å½•ï¼Œæˆç»©æ’åï¼Œåˆ†æ•°ï¼Œä¸äºˆä¿®æ”¹</span></span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥æ–°çš„è¿åŠ¨å‘˜çš„å§“å:&quot;</span>&lt;&lt;endl;</span><br><span class="line">        string name;</span><br><span class="line">        cin&gt;&gt;name;</span><br><span class="line">        temp.<span class="built_in">setName</span>(name); <span class="comment">//è¾“å…¥æ–°ä¿¡æ¯</span></span><br><span class="line">        athletes.<span class="built_in">replace</span>(i,temp);<span class="comment">//è¿›è¡Œæ›¿æ¢</span></span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¿åŠ¨å‘˜çš„å§“åä¿®æ”¹æˆåŠŸ!&quot;</span>&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;è¯·è¾“å…¥æ–°çš„è¿åŠ¨å‘˜çš„å­¦å·:&quot;</span> &lt;&lt; endl;</span><br><span class="line">        string number;</span><br><span class="line">        cin&gt;&gt;number;</span><br><span class="line">        temp.<span class="built_in">setId</span>(number);</span><br><span class="line">        athletes.<span class="built_in">replace</span>(i,temp);</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;è¿åŠ¨å‘˜çš„å­¦å·ä¿®æ”¹æˆåŠŸ!&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥æ–°çš„è¿åŠ¨å‘˜çš„æ€§åˆ«:&quot;</span>&lt;&lt;endl;</span><br><span class="line">        string sex;</span><br><span class="line">        cin&gt;&gt;sex;</span><br><span class="line">        temp.<span class="built_in">setSex</span>(sex);</span><br><span class="line">        athletes.<span class="built_in">replace</span>(i,temp);</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¿åŠ¨å‘˜çš„æ€§åˆ«ä¿®æ”¹æˆåŠŸ!&quot;</span>&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥æ–°çš„å­¦é™¢:&quot;</span>&lt;&lt;endl;</span><br><span class="line">        string college;</span><br><span class="line">        cin&gt;&gt;college;</span><br><span class="line">        temp.<span class="built_in">setCollege</span>(college);</span><br><span class="line">        athletes.<span class="built_in">replace</span>(i,temp);</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¿åŠ¨å‘˜çš„å­¦é™¢æ”¹æˆåŠŸ!&quot;</span>&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">5</span>:&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥æ–°çš„è¿åŠ¨å‘˜å‚èµ›ç¼–å·:&quot;</span>&lt;&lt;endl;</span><br><span class="line">        string matchId;</span><br><span class="line">        cin&gt;&gt;matchId;</span><br><span class="line">        temp.<span class="built_in">setMatchId</span>(matchId);</span><br><span class="line">        athletes.<span class="built_in">replace</span>(i,temp);</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¿åŠ¨å‘˜å‚èµ›ç¼–å·ä¿®æ”¹æˆåŠŸ!&quot;</span>&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">default</span>: cout&lt;&lt;<span class="string">&quot;è¾“å…¥æœ‰è¯¯&quot;</span>&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ï¼š</p><p><img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps19.jpg" alt="img"> </p><p><img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps20.jpg" alt="img"> </p><p>(3) .å­¦é™¢</p><p>A. void creatColleges()åˆ›å»ºå­¦é™¢</p><p>åˆ©ç”¨æ ‡å‡†C++ STLåº“ä¸­çš„vectorå®¹å™¨å­˜å‚¨å­¦é™¢ï¼Œéå†è¿åŠ¨å‘˜è¡¨ï¼Œä¾æ¬¡æ‹¿å‡ºæ¯ä¸€ä¸ªè¿åŠ¨å‘˜ï¼Œéå†å­¦é™¢æ•°ç»„ï¼Œçœ‹å­¦é™¢æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨è¿åŠ¨å‘˜å¯¹åº”çš„å­¦é™¢ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå°±åˆ›å»ºå­¦é™¢ï¼Œå¹¶ä¸”æŠŠè¯¥è¿åŠ¨å‘˜ä¿¡æ¯æ’å…¥åˆ°å­¦é™¢ä¸­çš„è¿åŠ¨å‘˜ä¿¡æ¯ä¸­ï¼Œå¦‚æœæœ‰å¯¹åº”çš„å­¦é™¢ï¼Œå°±åªæŠŠè¿åŠ¨å‘˜çš„ä¿¡æ¯æ’å…¥åˆ°å­¦é™¢çš„è¿åŠ¨å‘˜æ•°ç»„ä¸­ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N^3)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">creatColleges</span><span class="params">(List2&lt;Athlete&gt; a)</span> </span>&#123;<span class="comment">//åˆ›å»ºå­¦é™¢</span></span><br><span class="line">  Athlete temp;</span><br><span class="line">  <span class="type">bool</span> flag;<span class="comment">//æ ‡å¿—1ï¼šæœ‰æ²¡æœ‰è¿åŠ¨å‘˜å¯¹åº”çš„å­¦é™¢</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; a.<span class="built_in">size</span>(); i++) &#123;<span class="comment">//éå†è¿åŠ¨å‘˜è¡¨</span></span><br><span class="line">    flag = <span class="literal">false</span>;</span><br><span class="line">    a.<span class="built_in">retrieve</span>(i,temp);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> &amp; college : colleges) &#123; <span class="comment">//éå†å­¦é™¢æ•°ç»„</span></span><br><span class="line">      <span class="keyword">if</span> (college.name == temp.<span class="built_in">getCollege</span>()) &#123; <span class="comment">//å¦‚æœæœ‰å’Œè¿åŠ¨å‘˜åŒåçš„å­¦é™¢</span></span><br><span class="line">        <span class="type">bool</span> flag2 = <span class="literal">false</span>;<span class="comment">//æ ‡å¿—ä½2ï¼šè®°å½•è¿åŠ¨å‘˜æ˜¯å¦è®°å½•è¿‡</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp; player : college.athletess) &#123;</span><br><span class="line">          <span class="keyword">if</span> (temp.<span class="built_in">getId</span>()==player.<span class="built_in">getId</span>()) flag2 = <span class="literal">true</span>;<span class="comment">//è®°å½•è¿‡ æ ‡å¿—ä½ä¸ºtrue</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (flag2) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">else</span>&#123; <span class="comment">//è¿åŠ¨å‘˜è¿˜æ²¡åŠ åœ¨å­¦é™¢çš„åŠ¨æ€æ•°ç»„é‡Œé¢</span></span><br><span class="line">          flag = <span class="literal">true</span>;</span><br><span class="line">          college.athletess.<span class="built_in">push_back</span>(temp);<span class="comment">//æŠŠè¿åŠ¨å‘˜åŠ åœ¨å­¦é™¢çš„åŠ¨æ€æ•°ç»„é‡Œé¢</span></span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!flag) &#123; <span class="comment">//æ²¡æœ‰å­¦é™¢</span></span><br><span class="line">      flag = <span class="literal">true</span>;</span><br><span class="line">      <span class="function">College <span class="title">collegeTemp</span><span class="params">(<span class="string">&quot;&quot;</span>+temp.getCollege())</span></span>;<span class="comment">//åˆ›å»ºå­¦é™¢</span></span><br><span class="line">      collegeTemp.athletess.<span class="built_in">push_back</span>(temp);<span class="comment">//æŠŠè¿åŠ¨å‘˜åŠ åœ¨å­¦é™¢é‡Œçš„è¿åŠ¨å‘˜ä¸­</span></span><br><span class="line">      colleges.<span class="built_in">push_back</span>(collegeTemp);<span class="comment">//å†æŠŠè¿åŠ¨å‘˜æ”¾å…¥æ•°ç»„ä¸­</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>B. void setCollegesScore()è®¾ç½®å­¦é™¢æˆç»©</p><p>é€šè¿‡éå†è¿åŠ¨å‘˜è¡¨æ¥åˆ›å»ºå¯¹åº”çš„å­¦é™¢ï¼Œå¹¶ä¸”å¯¹å¯¹åº”çš„å­¦é™¢çš„æˆç»©è¿›è¡Œå½•å…¥ã€‚å¦‚æœæ˜¯ç”·ç”Ÿï¼Œå°±åŠ å…¥åˆ°ç”·ç”Ÿæˆç»©å’Œæ€»æˆç»©ï¼›å¦‚æœæ˜¯å¥³ç”Ÿï¼Œå°±åŠ å…¥åˆ°å¥³ç”Ÿæˆç»©å’Œæ€»æˆç»©ã€‚</p><p>æ—¶é—´å¤æ‚åº¦O(N^2)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">setCollegesScore</span><span class="params">(vector&lt;College&gt; &amp;colleges)</span></span>&#123; <span class="comment">//è®¾ç½®å­¦é™¢çš„æˆç»©</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> &amp; college : colleges) &#123; <span class="comment">//éå†å­¦é™¢vectoræ•°ç»„ é€šè¿‡setScoreè®¾ç½®æˆç»©</span></span><br><span class="line">    college.<span class="built_in">setScore</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setScore</span><span class="params">()</span> </span>&#123; <span class="comment">//è®¾ç½®æˆç»©</span></span><br><span class="line">  <span class="keyword">this</span>-&gt;score = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">this</span>-&gt;manScore = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">this</span>-&gt;womenScore = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(Athlete temp:athletess)&#123; <span class="comment">//éå†è¿åŠ¨å‘˜è¡¨</span></span><br><span class="line">    <span class="keyword">if</span> (temp.<span class="built_in">getSex</span>() == <span class="string">&quot;ç”·&quot;</span>) &#123; <span class="comment">//å¦‚æœæ˜¯ç”·åŒå­¦ å°±åŠ manScore  score</span></span><br><span class="line">      <span class="keyword">this</span>-&gt;manScore += temp.<span class="built_in">getGrade</span>();</span><br><span class="line">      <span class="keyword">this</span>-&gt;score += temp.<span class="built_in">getGrade</span>();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123; <span class="comment">//å¦‚æœæ˜¯å¥³åŒå­¦ å°±åŠ womenScore  score</span></span><br><span class="line">      <span class="keyword">this</span>-&gt;womenScore += temp.<span class="built_in">getGrade</span>();</span><br><span class="line">      <span class="keyword">this</span>-&gt;score += temp.<span class="built_in">getGrade</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>C. void sortScore()æ ¹æ®æ€»æˆç»©æ’åº</p><p>åˆ©ç”¨é€‰æ‹©æ’åºçš„æ€æƒ³ï¼Œä»¥ä»–çš„ç»¼åˆå¾—åˆ†scoreä¸ºå…³é”®å€¼æ¥è¿›è¡Œæ’åºï¼Œæ¯æ¬¡éå†æ‰¾å‡ºè¯¥è½®æœ€å¤§å€¼ï¼Œæ‰¾åˆ°æœ€å¤§çš„å‰6ä¸ªå­¦é™¢ï¼Œå¦‚æœå°äº6ä¸ªå­¦é™¢ï¼Œå°±è¿›è¡Œå…¨æ’ã€‚</p><p>æ—¶é—´å¤æ‚åº¦O(N^2)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">sortScore</span><span class="params">(vector&lt;College&gt; colleges)</span></span>&#123; <span class="comment">//æ€»æˆç»©æ’åº</span></span><br><span class="line">  <span class="type">int</span> max = <span class="number">0</span>;</span><br><span class="line">  College temp;</span><br><span class="line">  <span class="comment">//ç¡®å®šæ’åºçš„è½®æ•° å¦‚æœä¸å¤Ÿ6ä¸ªå­¦é™¢çš„è¯å°±å…¨æ’ 6ä¸ªä»¥ä¸Šåªæ’å‰6ä¸ª</span></span><br><span class="line">  <span class="type">int</span> loop = <span class="number">6</span> &lt; colleges.<span class="built_in">size</span>()? <span class="number">6</span> : colleges.<span class="built_in">size</span>();</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> &amp; college : colleges)&#123;<span class="comment">//é˜²æ­¢ä¹‹å‰è¿›è¡Œè¿‡æ’åº å› æ­¤å¯¹æ‰€æœ‰çš„å­¦é™¢éƒ½è®¾ç½®ä¸ºfalse</span></span><br><span class="line">    college.flag = <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; loop; ++i) &#123;<span class="comment">//loopæ¬¡æœ€å¤§å€¼</span></span><br><span class="line">    max = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;college: colleges) &#123;</span><br><span class="line">      <span class="keyword">if</span> (college.score &gt; max &amp;&amp; !college.flag) &#123;</span><br><span class="line">        <span class="comment">//æ¯ä¸€éå¾ªç¯é‡Œè¾¹æ‰¾åˆ°æœ€å¤§çš„ å¹¶æŠŠæ ‡å¿—ä½ç½®ä½true æ„æ€æ˜¯å·²ç»æ’è¿‡åºäº†</span></span><br><span class="line">        college.flag = <span class="literal">true</span>;</span><br><span class="line">        max = college.score;</span><br><span class="line">        temp = college;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;æ··åˆåˆ†æ•°ç¬¬&quot;</span>&lt;&lt;i + <span class="number">1</span>&lt;&lt;<span class="string">&quot;çš„æ˜¯:&quot;</span> &lt;&lt; temp.name &lt;&lt; <span class="string">&quot;  &quot;</span> &lt;&lt; temp.score &lt;&lt; endl;<span class="comment">//æ˜¾ç¤º</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br></pre></td></tr></table></figure><p>D. void sortManScore()æ ¹æ®ç”·ç”Ÿæˆç»©æ’åº</p><p>åˆ©ç”¨é€‰æ‹©æ’åºçš„æ€æƒ³ï¼Œä»¥ä»–çš„ç”·ç”Ÿç»¼åˆå¾—åˆ†manScoreä¸ºKeyå€¼æ¥è¿›è¡Œæ’åºï¼Œæ‰¾åˆ°æœ€å¤§çš„å‰6ä½ã€‚</p><p>æ—¶é—´å¤æ‚åº¦O(N^2)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">sortManScore</span><span class="params">(vector&lt;College&gt; colleges)</span></span>&#123; <span class="comment">//ç”·å­å›¢ä½“æ’åº</span></span><br><span class="line">  <span class="type">int</span> max = <span class="number">0</span>;</span><br><span class="line">  College temp;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> &amp; college : colleges)&#123;<span class="comment">//é˜²æ­¢ä¹‹å‰è¿›è¡Œè¿‡æ’åº å› æ­¤å¯¹æ‰€æœ‰çš„å­¦é™¢éƒ½è®¾ç½®ä¸ºfalse</span></span><br><span class="line">    college.flag = <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//ç¡®å®šæ’åºçš„è½®æ•° å¦‚æœä¸å¤Ÿ6ä¸ªå­¦é™¢çš„è¯å°±å…¨æ’ 6ä¸ªä»¥ä¸Šåªæ’å‰6ä¸ª</span></span><br><span class="line">  <span class="type">int</span> loop = <span class="number">6</span> &lt; colleges.<span class="built_in">size</span>()? <span class="number">6</span> : colleges.<span class="built_in">size</span>();</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; loop; ++i) &#123;</span><br><span class="line">    max = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> &amp; college : colleges) &#123;</span><br><span class="line">      <span class="keyword">if</span> (college.manScore &gt; max &amp;&amp; !college.flag) &#123;</span><br><span class="line">        <span class="comment">//æ¯ä¸€éå¾ªç¯é‡Œè¾¹æ‰¾åˆ°æœ€å¤§çš„ å¹¶æŠŠæ ‡å¿—ä½ç½®ä½true æ„æ€æ˜¯å·²ç»æ’è¿‡åºäº†</span></span><br><span class="line">        college.flag = <span class="literal">true</span>;</span><br><span class="line">        max = college.score;</span><br><span class="line">        temp = college;</span><br><span class="line">        cout&lt;&lt;temp.name;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;ç”·å­å›¢ä½“åˆ†æ•°ç¬¬&quot;</span>&lt;&lt;i + <span class="number">1</span>&lt;&lt;<span class="string">&quot;çš„æ˜¯:&quot;</span> &lt;&lt; temp.name &lt;&lt; <span class="string">&quot;  &quot;</span> &lt;&lt; temp.manScore &lt;&lt; endl;<span class="comment">//æ˜¾ç¤º</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br></pre></td></tr></table></figure><p>E. void sortWomenScore()æ ¹æ®å¥³ç”Ÿæˆç»©æ’é˜Ÿ</p><p>åˆ©ç”¨é€‰æ‹©æ’åºçš„æ€æƒ³ï¼Œä»¥ä»–çš„å¥³ç”Ÿç»¼åˆå¾—åˆ†womenScoreä¸ºKeyå€¼æ¥è¿›è¡Œæ’åºï¼Œæ‰¾åˆ°æœ€å¤§çš„å‰6ä½ã€‚</p><p>æ—¶é—´å¤æ‚åº¦O(N^2)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">sortWomenScore</span><span class="params">(vector&lt;College&gt; colleges)</span></span>&#123;<span class="comment">//é˜²æ­¢ä¹‹å‰è¿›è¡Œè¿‡æ’åº å› æ­¤å¯¹æ‰€æœ‰çš„å­¦é™¢éƒ½è®¾ç½®ä¸ºfalse</span></span><br><span class="line">  <span class="type">int</span> max = <span class="number">0</span>;</span><br><span class="line">  College temp;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> &amp; college : colleges)&#123;</span><br><span class="line">    college.flag = <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//ç¡®å®šæ’åºçš„è½®æ•° å¦‚æœä¸å¤Ÿ6ä¸ªå­¦é™¢çš„è¯å°±å…¨æ’ 6ä¸ªä»¥ä¸Šåªæ’å‰6ä¸ª</span></span><br><span class="line">  <span class="type">int</span> loop = <span class="number">6</span> &lt; colleges.<span class="built_in">size</span>()? <span class="number">6</span> : colleges.<span class="built_in">size</span>();</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; loop; ++i) &#123;</span><br><span class="line">    max = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> &amp; college : colleges) &#123;</span><br><span class="line">      <span class="comment">//æ¯ä¸€éå¾ªç¯é‡Œè¾¹æ‰¾åˆ°æœ€å¤§çš„ å¹¶æŠŠæ ‡å¿—ä½ç½®ä½true æ„æ€æ˜¯å·²ç»æ’è¿‡åºäº†</span></span><br><span class="line">      <span class="keyword">if</span> (college.womenScore &gt; max &amp;&amp; !college.flag) &#123;</span><br><span class="line">        college.flag = <span class="literal">true</span>;</span><br><span class="line">        max = college.score;</span><br><span class="line">        temp = college;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;å¥³å­å›¢ä½“åˆ†æ•°ç¬¬&quot;</span>&lt;&lt;i + <span class="number">1</span>&lt;&lt;<span class="string">&quot;çš„æ˜¯:&quot;</span> &lt;&lt; temp.name &lt;&lt; <span class="string">&quot;  &quot;</span> &lt;&lt; temp.womenScore &lt;&lt; endl;<span class="comment">//æ˜¾ç¤º</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br></pre></td></tr></table></figure><p>æµ‹è¯•ï¼šï¼ˆæµ‹è¯•å­¦é™¢çš„å…¨éƒ¨æ“ä½œï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">Test.cpp</span><br><span class="line"></span><br><span class="line">\<span class="meta">#<span class="keyword">include</span> <span class="string">&quot;E3.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="function">Match <span class="title">match1</span><span class="params">(<span class="string">&quot;100m&quot;</span>,<span class="number">100001</span>,<span class="string">&quot;ç”·&quot;</span>,<span class="string">&quot;8-31&quot;</span>,<span class="string">&quot;2:00&quot;</span>,<span class="number">20</span>)</span></span>;</span><br><span class="line">  <span class="function">Match <span class="title">match2</span><span class="params">(<span class="string">&quot;100m&quot;</span>,<span class="number">100001</span>,<span class="string">&quot;å¥³&quot;</span>,<span class="string">&quot;8-31&quot;</span>,<span class="string">&quot;2:00&quot;</span>,<span class="number">20</span>)</span></span>;</span><br><span class="line">  <span class="function">Athlete <span class="title">a</span><span class="params">(<span class="string">&quot;a&quot;</span>,<span class="string">&quot;2001&quot;</span>,<span class="string">&quot;ç”·&quot;</span>,<span class="string">&quot;ä¿¡æ§&quot;</span>,<span class="string">&quot;10001&quot;</span>)</span></span>;</span><br><span class="line">  <span class="function">Athlete <span class="title">b</span><span class="params">(<span class="string">&quot;b&quot;</span>,<span class="string">&quot;2002&quot;</span>,<span class="string">&quot;ç”·&quot;</span>,<span class="string">&quot;ææ–™&quot;</span>,<span class="string">&quot;10001&quot;</span>)</span></span>;</span><br><span class="line">  <span class="function">Athlete <span class="title">c</span><span class="params">(<span class="string">&quot;c&quot;</span>,<span class="string">&quot;2003&quot;</span>,<span class="string">&quot;ç”·&quot;</span>,<span class="string">&quot;ä¿¡æ§&quot;</span>,<span class="string">&quot;10001&quot;</span>)</span></span>;</span><br><span class="line">  <span class="function">Athlete <span class="title">d</span><span class="params">(<span class="string">&quot;d&quot;</span>,<span class="string">&quot;2004&quot;</span>,<span class="string">&quot;ç”·&quot;</span>,<span class="string">&quot;ææ–™&quot;</span>,<span class="string">&quot;10001&quot;</span>)</span></span>;</span><br><span class="line">  <span class="function">Athlete <span class="title">e</span><span class="params">(<span class="string">&quot;e&quot;</span>,<span class="string">&quot;2005&quot;</span>,<span class="string">&quot;å¥³&quot;</span>,<span class="string">&quot;ä¿¡æ§&quot;</span>,<span class="string">&quot;10001&quot;</span>)</span></span>;</span><br><span class="line">  <span class="function">Athlete <span class="title">f</span><span class="params">(<span class="string">&quot;f&quot;</span>,<span class="string">&quot;2006&quot;</span>,<span class="string">&quot;å¥³&quot;</span>,<span class="string">&quot;ææ–™&quot;</span>,<span class="string">&quot;10001&quot;</span>)</span></span>;</span><br><span class="line">  <span class="function">Athlete <span class="title">g</span><span class="params">(<span class="string">&quot;g&quot;</span>,<span class="string">&quot;2007&quot;</span>,<span class="string">&quot;å¥³&quot;</span>,<span class="string">&quot;ä¿¡æ§&quot;</span>,<span class="string">&quot;10001&quot;</span>)</span></span>;</span><br><span class="line">  <span class="function">Athlete <span class="title">h</span><span class="params">(<span class="string">&quot;h&quot;</span>,<span class="string">&quot;2008&quot;</span>,<span class="string">&quot;å¥³&quot;</span>,<span class="string">&quot;ææ–™&quot;</span>,<span class="string">&quot;10001&quot;</span>)</span></span>;</span><br><span class="line">  a.<span class="built_in">setRank</span>(<span class="number">1</span>);</span><br><span class="line">  b.<span class="built_in">setRank</span>(<span class="number">2</span>);</span><br><span class="line">  c.<span class="built_in">setRank</span>(<span class="number">3</span>);</span><br><span class="line">  d.<span class="built_in">setRank</span>(<span class="number">4</span>);</span><br><span class="line">  e.<span class="built_in">setRank</span>(<span class="number">1</span>);</span><br><span class="line">  f.<span class="built_in">setRank</span>(<span class="number">2</span>);</span><br><span class="line">  g.<span class="built_in">setRank</span>(<span class="number">3</span>);</span><br><span class="line">  h.<span class="built_in">setRank</span>(<span class="number">4</span>);</span><br><span class="line">  athletes.<span class="built_in">insert</span>(<span class="number">0</span>,a);</span><br><span class="line">  athletes.<span class="built_in">insert</span>(<span class="number">1</span>,b);</span><br><span class="line">  athletes.<span class="built_in">insert</span>(<span class="number">2</span>,c);</span><br><span class="line">  athletes.<span class="built_in">insert</span>(<span class="number">3</span>,d);</span><br><span class="line">  athletes.<span class="built_in">insert</span>(<span class="number">4</span>,e);</span><br><span class="line">  athletes.<span class="built_in">insert</span>(<span class="number">5</span>,f);</span><br><span class="line">  athletes.<span class="built_in">insert</span>(<span class="number">6</span>,g);</span><br><span class="line">  athletes.<span class="built_in">insert</span>(<span class="number">7</span>,h);</span><br><span class="line">  <span class="built_in">creatColleges</span>(athletes);</span><br><span class="line">  <span class="built_in">setCollegesScore</span>(colleges);</span><br><span class="line">  <span class="built_in">sortScore</span>(colleges);</span><br><span class="line">  <span class="built_in">sortManScore</span>(colleges);</span><br><span class="line">  <span class="built_in">sortWomenScore</span>(colleges);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps21.jpg" alt="img"> </p><h3 id="äº”ï¼ç¨‹åºæºä»£ç "><a href="#äº”ï¼ç¨‹åºæºä»£ç " class="headerlink" title="äº”ï¼ç¨‹åºæºä»£ç "></a>äº”ï¼ç¨‹åºæºä»£ç </h3><p>Utility.h</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Error_code</span> &#123; success, fail, range_errors, underflow, overflow, fatal, not_present, duplicate_error, entry_inserted, entry_found, internal_error &#125;;</span><br></pre></td></tr></table></figure><h4 id="å®éªŒ1-åŸºäºå•é“¾è¡¨å®ç°çº¿æ€§è¡¨-List1"><a href="#å®éªŒ1-åŸºäºå•é“¾è¡¨å®ç°çº¿æ€§è¡¨-List1" class="headerlink" title="å®éªŒ1. åŸºäºå•é“¾è¡¨å®ç°çº¿æ€§è¡¨ List1"></a>å®éªŒ1. åŸºäºå•é“¾è¡¨å®ç°çº¿æ€§è¡¨ List1</h4><p>Node.h</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">Node_entry</span>&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">  <span class="comment">//æ•°æ®åŸŸ</span></span><br><span class="line">  Node_entry entry;<span class="comment">//æ•°å€¼</span></span><br><span class="line">  Node&lt;Node_entry&gt;* next;<span class="comment">//nextæŒ‡é’ˆ</span></span><br><span class="line">  <span class="comment">//æ„é€ æ–¹æ³•</span></span><br><span class="line">  <span class="built_in">Node</span>();</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   \* é»˜è®¤å‚æ•°</span></span><br><span class="line"><span class="comment">   \* å¦‚æœä¸ä¼ å°±ç”¨é»˜è®¤å‚æ•°</span></span><br><span class="line"><span class="comment">   \* å¦‚æœä¼ äº†å€¼å°±ç”¨ä¸‹è¾¹çš„æ„é€ æ–¹æ³•</span></span><br><span class="line"><span class="comment">   \* */</span></span><br><span class="line">  <span class="built_in">Node</span>(Node_entry item, Node&lt;Node_entry&gt;* add_on = <span class="literal">nullptr</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Node.cpp</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Node.h&quot;</span></span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">Node_entry</span>&gt; Node&lt;Node_entry&gt;::<span class="built_in">Node</span>()</span><br><span class="line">&#123;</span><br><span class="line">  next = <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">Node_entry</span>&gt; Node&lt;Node_entry&gt;::<span class="built_in">Node</span>(Node_entry item, Node&lt;Node_entry&gt;* add_on)</span><br><span class="line">&#123;</span><br><span class="line">  entry = item;</span><br><span class="line">  next = add_on;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">List1.h</span><br><span class="line"></span><br><span class="line">\<span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Node.h&quot;</span></span></span><br><span class="line">\<span class="meta">#<span class="keyword">include</span> <span class="string">&quot;utility.h&quot;</span><span class="comment">//çŠ¶æ€é”™è¯¯</span></span></span><br><span class="line"><span class="comment">//enum Error_code &#123; success, fail, range_errors, underflow, overflow, fatal, not_present, duplicate_error, entry_inserted, entry_found, internal_error &#125;;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; <span class="keyword">class</span> <span class="title class_">List1</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="built_in">List1</span>();</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">size</span><span class="params">()</span> <span class="type">const</span></span>;<span class="comment">//å¤§å°</span></span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">full</span><span class="params">()</span> <span class="type">const</span></span>;<span class="comment">//åˆ¤æ»¡</span></span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">empty</span><span class="params">()</span> <span class="type">const</span></span>;<span class="comment">//åˆ¤ç©º</span></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span></span>;<span class="comment">//æ¸…ç©º</span></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">traverse</span><span class="params">(<span class="type">void</span> (*visit)(List_entry &amp;))</span></span>;<span class="comment">//é€šè¿‡visitå‡½æ•°æŒ‡é’ˆéå†çº¿æ€§è¡¨</span></span><br><span class="line">  <span class="function">Error_code <span class="title">retrieve</span><span class="params">(<span class="type">int</span> position, List_entry&amp; x)</span> <span class="type">const</span></span>;<span class="comment">//è®¿é—®positionä½ç½®çš„å€¼</span></span><br><span class="line">  <span class="function">Error_code <span class="title">replace</span><span class="params">(<span class="type">int</span> position, <span class="type">const</span> List_entry&amp; x)</span></span>;<span class="comment">//æ›¿æ¢positionä½ç½®çš„å€¼</span></span><br><span class="line">  <span class="function">Error_code <span class="title">remove</span><span class="params">(<span class="type">int</span> position, List_entry&amp; x)</span></span>;<span class="comment">//ç§»é™¤positionä½ç½®çš„å€¼</span></span><br><span class="line">  <span class="function">Error_code <span class="title">insert</span><span class="params">(<span class="type">int</span> position, <span class="type">const</span> List_entry&amp; x)</span></span>;<span class="comment">//åœ¨positionä½ç½®æ’å…¥ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">  ~<span class="built_in">List1</span>();<span class="comment">//ææ„</span></span><br><span class="line">  <span class="built_in">List1</span>(<span class="type">const</span> List1&lt;List_entry&gt;&amp; copy);<span class="comment">//æ‹·è´æ„é€ </span></span><br><span class="line">  <span class="type">void</span> <span class="keyword">operator</span> =(<span class="type">const</span> List1&lt;List_entry&gt;&amp; copy);<span class="comment">//èµ‹å€¼è¿ç®—ç¬¦é‡è½½</span></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">  <span class="comment">//æ•°æ®åŸŸ</span></span><br><span class="line">  <span class="type">int</span> count;<span class="comment">//è®¡æ•°å™¨</span></span><br><span class="line">  Node&lt;List_entry&gt; *head;<span class="comment">//å¤´æŒ‡é’ˆ</span></span><br><span class="line">  <span class="comment">//è¾…åŠ©æ–¹æ³• æ‰¾åˆ°positionä½ç½®çš„èŠ‚ç‚¹å¹¶è¿”å›</span></span><br><span class="line">  <span class="function">Node&lt;List_entry&gt; * <span class="title">set_position</span><span class="params">(<span class="type">int</span> position)</span> <span class="type">const</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">List1.cpp</span><br><span class="line"></span><br><span class="line">\<span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Node.h&quot;</span></span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; List1&lt;List_entry&gt;::<span class="built_in">List1</span>() &#123;</span><br><span class="line">  <span class="comment">//å¯¹çº¿æ€§è¡¨åˆå§‹åŒ–</span></span><br><span class="line">  count = <span class="number">0</span>;</span><br><span class="line">  head = <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; List1&lt;List_entry&gt;::~<span class="built_in">List1</span>() &#123;</span><br><span class="line">  <span class="comment">//å€ŸåŠ©clear()æ–¹æ³•æ¸…ç©º</span></span><br><span class="line">  <span class="built_in">clear</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; <span class="type">void</span> List1&lt;List_entry&gt;::<span class="built_in">clear</span>() &#123;</span><br><span class="line">  Node&lt;List_entry&gt;* p, * q;</span><br><span class="line">  <span class="comment">//p å½“å‰èŠ‚ç‚¹  q nextèŠ‚ç‚¹</span></span><br><span class="line">  <span class="keyword">for</span> (p = head; p; p = q) &#123;</span><br><span class="line">    q = p-&gt;next;</span><br><span class="line">    <span class="keyword">delete</span> p;</span><br><span class="line">  &#125;</span><br><span class="line">  count = <span class="number">0</span>;</span><br><span class="line">  head = <span class="literal">nullptr</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; <span class="type">int</span> List1&lt;List_entry&gt;::<span class="built_in">size</span>()<span class="type">const</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; <span class="type">bool</span> List1&lt;List_entry&gt;::<span class="built_in">full</span>() <span class="type">const</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; <span class="type">bool</span> List1&lt;List_entry&gt;::<span class="built_in">empty</span>()<span class="type">const</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (head != <span class="literal">nullptr</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; Node&lt;List_entry&gt;* List1&lt;List_entry&gt;::<span class="built_in">set_position</span>(<span class="type">int</span> position) <span class="type">const</span> &#123;</span><br><span class="line">  Node&lt;List_entry&gt;* q = head;</span><br><span class="line">  <span class="comment">//éå†positionæ¬¡å°±æ¥åˆ°äº†positionçš„èŠ‚ç‚¹ä½ç½®</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; position; i++) q = q-&gt;next;</span><br><span class="line">  <span class="keyword">return</span> q;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; Error_code List1&lt;List_entry&gt;::<span class="built_in">insert</span>(<span class="type">int</span> position, <span class="type">const</span> List_entry&amp; x) &#123;</span><br><span class="line">  <span class="keyword">if</span> (position &lt; <span class="number">0</span> || position &gt; count) <span class="comment">//positionçš„ä½ç½®ä¸åˆæ³•</span></span><br><span class="line">    <span class="keyword">return</span> range_errors;</span><br><span class="line">  Node&lt;List_entry&gt;* new_node, <span class="comment">//æ–°èŠ‚ç‚¹</span></span><br><span class="line">          \* previous, <span class="comment">//å‰é©±èŠ‚ç‚¹</span></span><br><span class="line">          \* following;<span class="comment">//åç»§èŠ‚ç‚¹</span></span><br><span class="line">  previous = <span class="literal">nullptr</span>;</span><br><span class="line">  <span class="keyword">if</span> (position &gt; <span class="number">0</span>) &#123; <span class="comment">//ä¸æ˜¯å¤´æ’</span></span><br><span class="line">    previous = <span class="built_in">set_position</span>(position - <span class="number">1</span>);<span class="comment">//æ‰¾åˆ°ä»–çš„å‰é©±èŠ‚ç‚¹</span></span><br><span class="line">    following = previous-&gt;next;<span class="comment">//åç»§èŠ‚ç‚¹</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> following = head;<span class="comment">//æ˜¯å¤´æ’çš„è¯ï¼Œæ²¡æœ‰å‰é©±ï¼Œåç»§å°±æ˜¯åŸæ¥çš„å¤´èŠ‚ç‚¹</span></span><br><span class="line">  new_node = <span class="keyword">new</span> <span class="built_in">Node</span>&lt;List_entry&gt;(x, following);<span class="comment">//å€Ÿç”¨äº†nodeçš„æ„é€ æ–¹æ³• node-&gt;next = following</span></span><br><span class="line">  <span class="keyword">if</span> (new_node == <span class="literal">nullptr</span>)</span><br><span class="line">    <span class="keyword">return</span> overflow;</span><br><span class="line">  <span class="keyword">if</span> (position == <span class="number">0</span>)<span class="comment">//å¦‚æœæ˜¯å¤´æ’çš„è¯ï¼Œå¤´èŠ‚ç‚¹å°±æ˜¯æ’å…¥çš„new_node</span></span><br><span class="line">    head = new_node;</span><br><span class="line">  <span class="keyword">else</span><span class="comment">//ä¸æ˜¯å¤´æ’çš„è¯ï¼Œå°±è®©å‰é©±èŠ‚ç‚¹çš„nextæŒ‡å‘new_node</span></span><br><span class="line">    previous-&gt;next = new_node;</span><br><span class="line">  count++;</span><br><span class="line">  <span class="keyword">return</span> success;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; <span class="type">void</span> List1&lt;List_entry&gt;::<span class="built_in">traverse</span>(<span class="built_in">void</span> (*visit) (List_entry&amp;)) &#123;</span><br><span class="line">  Node&lt;List_entry&gt;* q;</span><br><span class="line">  <span class="keyword">for</span> (q = head; q; q = q-&gt;next) &#123; <span class="comment">//éå†æ¯ä¸€ä¸ªèŠ‚ç‚¹ å¯¹æ¯ä¸€ä¸ªèŠ‚ç‚¹ é€šè¿‡å‡½æ•°æŒ‡é’ˆæ¥è¿›è¡Œæ“ä½œ</span></span><br><span class="line">    (*visit) (q-&gt;entry);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; Error_code List1&lt;List_entry&gt;::<span class="built_in">remove</span>(<span class="type">int</span> position, List_entry&amp; x) &#123;</span><br><span class="line">  Node&lt;List_entry&gt;* prior,<span class="comment">//å‰é©±èŠ‚ç‚¹</span></span><br><span class="line">          \* current;<span class="comment">//å½“å‰èŠ‚ç‚¹</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">empty</span>()) <span class="keyword">return</span> fail;</span><br><span class="line">  <span class="keyword">if</span> (position &lt; <span class="number">0</span> || position &gt;= count) <span class="keyword">return</span> range_errors;<span class="comment">//positionä½ç½®æ˜¯å¦åˆæ³•</span></span><br><span class="line">  <span class="keyword">if</span> (position &gt; <span class="number">0</span>) &#123; <span class="comment">//åˆ çš„ä¸æ˜¯å¤´èŠ‚ç‚¹</span></span><br><span class="line">    prior = <span class="built_in">set_position</span>(position - <span class="number">1</span>);<span class="comment">//å‰é©±</span></span><br><span class="line">    current = prior-&gt;next;<span class="comment">//å½“å‰</span></span><br><span class="line">    prior-&gt;next = current-&gt;next;<span class="comment">//è®©å‰é©±èŠ‚ç‚¹ç»•è¿‡å½“å‰èŠ‚ç‚¹ç›´æ¥æŒ‡åˆ°åç»§èŠ‚ç‚¹</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123; <span class="comment">//åˆ é™¤å¤´èŠ‚ç‚¹</span></span><br><span class="line">    current = head;</span><br><span class="line">    head = head-&gt;next;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  x = current-&gt;entry;<span class="comment">//xå¸¦å‡ºè¦åˆ é™¤èŠ‚ç‚¹çš„å€¼</span></span><br><span class="line">  <span class="keyword">delete</span> current;<span class="comment">//é€šè¿‡deleteåˆ é™¤èŠ‚ç‚¹</span></span><br><span class="line">  count--;</span><br><span class="line">  <span class="keyword">return</span> success;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; Error_code List1&lt;List_entry&gt;::<span class="built_in">retrieve</span>(<span class="type">int</span> position,List_entry&amp; x) <span class="type">const</span> &#123;</span><br><span class="line">  Node&lt;List_entry&gt;* current;</span><br><span class="line">  <span class="keyword">if</span> (position &lt; <span class="number">0</span> || position &gt;= count) <span class="keyword">return</span> range_errors;<span class="comment">//positionä½ç½®æ˜¯å¦åˆæ³•</span></span><br><span class="line">  current = <span class="built_in">set_position</span>(position);<span class="comment">//é€šè¿‡set_positionæ‹¿åˆ°å½“å‰èŠ‚ç‚¹</span></span><br><span class="line">  x = current-&gt;entry;</span><br><span class="line">  <span class="keyword">return</span> success;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; Error_code List1&lt;List_entry&gt;::<span class="built_in">replace</span>(<span class="type">int</span> position, <span class="type">const</span> List_entry&amp; x) &#123;</span><br><span class="line">  Node&lt;List_entry&gt;* current;</span><br><span class="line">  <span class="keyword">if</span> (position &lt; <span class="number">0</span> || position &gt;= count) <span class="keyword">return</span> range_errors;</span><br><span class="line">  current = <span class="built_in">set_position</span>(position);</span><br><span class="line">  current-&gt;entry = x;</span><br><span class="line">  <span class="keyword">return</span> success;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt; List1&lt;List_entry&gt;::<span class="built_in">List1</span>(<span class="type">const</span> List1&lt;List_entry&gt;&amp; copy) &#123;<span class="comment">//æ‹·è´æ„é€ </span></span><br><span class="line">  count = copy.count;</span><br><span class="line">  Node&lt;List_entry&gt;* new_node, * old_node = copy.head;</span><br><span class="line">  <span class="keyword">if</span> (old_node == <span class="literal">nullptr</span>) head = <span class="literal">nullptr</span>;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    new_node = <span class="keyword">new</span> <span class="built_in">Node</span>&lt;List_entry&gt;();</span><br><span class="line">    head = new_node;</span><br><span class="line">    <span class="keyword">while</span> (old_node != <span class="literal">nullptr</span>) &#123; <span class="comment">//éå†æ‹·è´çš„çº¿æ€§è¡¨</span></span><br><span class="line">      old_node = old_node-&gt;next;</span><br><span class="line">      new_node-&gt;next = <span class="keyword">new</span> <span class="built_in">Node</span>&lt;List_entry&gt;(old_node-&gt;entry);</span><br><span class="line">      new_node = new_node-&gt;next;<span class="comment">//new_nodeå¾€åæ‹¨ä¸€ä¸ª</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line"><span class="type">void</span> List1&lt;List_entry&gt;::<span class="keyword">operator</span> =(<span class="type">const</span> List1&lt;List_entry&gt;&amp; copy) &#123; <span class="comment">//èµ‹å€¼è¿ç®—ç¬¦é‡è½½</span></span><br><span class="line">  List1 <span class="built_in">new_copy</span>(copy);<span class="comment">//å€Ÿç”¨æ‹·è´æ„é€ </span></span><br><span class="line">  <span class="built_in">clear</span>();<span class="comment">//æ¸…ç©ºå½“å‰è¡¨</span></span><br><span class="line">  count = <span class="number">0</span>;</span><br><span class="line">  head = <span class="literal">nullptr</span>;</span><br><span class="line">  new_copy.count = copy.count;</span><br><span class="line">  new_copy.head = head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">æµ‹è¯•main.cpp</span><br><span class="line"></span><br><span class="line">\<span class="meta">#<span class="keyword">include</span> <span class="string">&quot;List1.h&quot;</span></span></span><br><span class="line">\<span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// test List1 mechanism</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">write_entry</span><span class="params">(<span class="type">char</span> &amp;c)</span> </span>&#123;</span><br><span class="line">  cout &lt;&lt; c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">char</span> x;</span><br><span class="line">  List1&lt;<span class="type">char</span>&gt; c_list;</span><br><span class="line">  <span class="comment">// a list of characters, initialized empty</span></span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;List is empty, it has &quot;</span> &lt;&lt; c_list.<span class="built_in">size</span>() &lt;&lt; <span class="string">&quot; items.\n&quot;</span>;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;Enter characters and the program adds them to the list.\n&quot;</span>;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;Use Enter key (newline) to terminate the input.\n&quot;</span>;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;When ListSize() is 3, the element will be inserted at the &quot;</span>;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;front of the list.\n The others will appear at the back.\n&quot;</span>;</span><br><span class="line">  <span class="keyword">while</span> (!c_list.<span class="built_in">full</span>() &amp;&amp; (x = cin.<span class="built_in">get</span>()) != <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (c_list.<span class="built_in">size</span>() == <span class="number">3</span>) c_list.<span class="built_in">insert</span>(<span class="number">0</span>, x);</span><br><span class="line">    <span class="keyword">else</span> c_list.<span class="built_in">insert</span>(c_list.<span class="built_in">size</span>(), x);</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;The list has &quot;</span> &lt;&lt; c_list.<span class="built_in">size</span>() &lt;&lt; <span class="string">&quot; items.\n&quot;</span>;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;The function c_list.full(), got &quot;</span> &lt;&lt; c_list.<span class="built_in">full</span>();</span><br><span class="line">  <span class="keyword">if</span> (c_list.<span class="built_in">full</span>())</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot; because the list is full.\n&quot;</span>;</span><br><span class="line">  <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot; because the list is NOT full.\n&quot;</span>;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;c_list.empty(), expecting 0, got &quot;</span> &lt;&lt; c_list.<span class="built_in">empty</span>() &lt;&lt; <span class="string">&quot;.\n&quot;</span>;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;c_list.traverse(write_entry) output: &quot;</span>; c_list.<span class="built_in">traverse</span>(write_entry);</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;\n&quot;</span>; c_list.<span class="built_in">clear</span>();</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;Cleared the list, printing its contents:\n&quot;</span>;</span><br><span class="line">  c_list.<span class="built_in">traverse</span>(write_entry);</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;\n&quot;</span>; cout &lt;&lt; <span class="string">&quot;Enter characters and the program adds them to the list.\n&quot;</span>;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;Use Enter key (newline) to terminate the input.\n&quot;</span>;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;When ListSize() is &lt; 3, the element will be inserted at the &quot;</span>;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;front of the list.\n The others will appear at the back.\n&quot;</span>;</span><br><span class="line">  <span class="keyword">while</span> (!c_list.<span class="built_in">full</span>() &amp;&amp; (x = cin.<span class="built_in">get</span>()) != <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (c_list.<span class="built_in">size</span>() &lt; <span class="number">3</span>) c_list.<span class="built_in">insert</span>(<span class="number">0</span>, x);</span><br><span class="line">    <span class="keyword">else</span> c_list.<span class="built_in">insert</span>(c_list.<span class="built_in">size</span>(), x);</span><br><span class="line">  c_list.<span class="built_in">traverse</span>(write_entry);</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å®éªŒ2-åŸºäºé™æ€é“¾è¡¨å®ç°çº¿æ€§è¡¨-List2-çš„å…¸å‹æ“ä½œ"><a href="#å®éªŒ2-åŸºäºé™æ€é“¾è¡¨å®ç°çº¿æ€§è¡¨-List2-çš„å…¸å‹æ“ä½œ" class="headerlink" title="å®éªŒ2. åŸºäºé™æ€é“¾è¡¨å®ç°çº¿æ€§è¡¨ List2 çš„å…¸å‹æ“ä½œ"></a>å®éªŒ2. åŸºäºé™æ€é“¾è¡¨å®ç°çº¿æ€§è¡¨ List2 çš„å…¸å‹æ“ä½œ</h4><p>Node2.h</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;utility.h&quot;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> index;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> max_list = <span class="number">10</span>; <span class="comment">//  small value for testing purposes</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Node2</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  List_entry entry;<span class="comment">//æ•°æ®</span></span><br><span class="line">  index next;<span class="comment">//next  è¡¨ç¤ºæ•°ç»„çš„ä¸‹æ ‡</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>List2.h</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">List2</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="built_in">List2</span>();</span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">size</span><span class="params">()</span> <span class="type">const</span></span>;<span class="comment">//å¤§å°</span></span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">full</span><span class="params">()</span> <span class="type">const</span></span>;<span class="comment">//åˆ¤æ»¡</span></span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">empty</span><span class="params">()</span> <span class="type">const</span></span>;<span class="comment">//åˆ¤ç©º</span></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span></span>;<span class="comment">//æ¸…ç©º</span></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">traverse</span><span class="params">(<span class="type">void</span> (*visit)(List_entry&amp;))</span></span>;<span class="comment">//éå†</span></span><br><span class="line">  <span class="function">Error_code <span class="title">retrieve</span><span class="params">(<span class="type">int</span> position, List_entry&amp; x)</span> <span class="type">const</span></span>;<span class="comment">//è®¿é—®positionçš„å€¼ï¼Œé€šè¿‡xæŠŠå€¼å¸¦å‡ºæ¥</span></span><br><span class="line">  <span class="function">Error_code <span class="title">replace</span><span class="params">(<span class="type">int</span> position, <span class="type">const</span> List_entry&amp; x)</span></span>;<span class="comment">//æ›¿æ¢positionä½ç½®çš„å€¼è®¾ä¸ºx</span></span><br><span class="line">  <span class="function">Error_code <span class="title">remove</span><span class="params">(<span class="type">int</span> position, List_entry&amp; x)</span></span>;<span class="comment">//ç§»é™¤positionä½ç½®çš„å€¼,ç”¨xå¸¦å‡ºæ¥</span></span><br><span class="line">  <span class="function">Error_code <span class="title">insert</span><span class="params">(<span class="type">int</span> position, <span class="type">const</span> List_entry&amp; x)</span></span>;<span class="comment">//æŠŠxæ’å…¥åˆ°positionä½ç½®</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">  Node2&lt;List_entry&gt; workspace[max_list];<span class="comment">//ç”¨æ•°ç»„å®ç°é™æ€é“¾è¡¨</span></span><br><span class="line">  index available, <span class="comment">//å¯ç”¨ç©ºé—´çš„è¡¨å¤´èŠ‚ç‚¹</span></span><br><span class="line">    last_used, <span class="comment">//ä¸Šä¸€æ¬¡ä½¿ç”¨çš„ç©ºé—´  æ¥åšæ ‡è®°</span></span><br><span class="line">    head;<span class="comment">//å¤´èŠ‚ç‚¹</span></span><br><span class="line">  <span class="type">int</span> count;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//è¾…åŠ©æ–¹æ³•</span></span><br><span class="line">  <span class="function">index <span class="title">new_node</span><span class="params">()</span></span>;<span class="comment">//åˆ›å»ºä¸€ä¸ªç©ºé—´</span></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">delete_node</span><span class="params">(index old_index)</span></span>;<span class="comment">//é‡Šæ”¾ç©ºé—´ï¼Œè¿æ¥åˆ°availableè¡¨</span></span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">current_position</span><span class="params">(index n)</span> <span class="type">const</span></span>;<span class="comment">//æ ¹æ®å€¼è·å–å½“å‰çš„ä¸‹æ ‡</span></span><br><span class="line">  <span class="function">index <span class="title">set_position</span><span class="params">(<span class="type">int</span> position)</span> <span class="type">const</span></span>;<span class="comment">//æ ¹æ®ä¸‹æ ‡ï¼Œè·å¾—å½“å‰çš„å€¼</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">List2.cpp</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line">index List2&lt;List_entry&gt;::<span class="built_in">new_node</span>()&#123;</span><br><span class="line">  index new_index;</span><br><span class="line">  <span class="comment">//å› ä¸ºæ˜¯æ•°ç»„ä¸‹æ ‡ ç”¨-1ä»£æ›¿nullptr</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   \* 1. å…ˆçœ‹availableæœ‰æ²¡æœ‰ç©ºé—´å¯ä»¥ç”¨</span></span><br><span class="line"><span class="comment">   \* 2. availableè¡¨æ²¡ç©ºé—´äº†ï¼Œçœ‹èƒ½ä¸èƒ½æ–°å»º</span></span><br><span class="line"><span class="comment">   \* */</span></span><br><span class="line">  <span class="keyword">if</span> (available != <span class="number">-1</span>) &#123; <span class="comment">//availableæœ‰ç©ºé—´å¯ä»¥ç”¨</span></span><br><span class="line">    new_index = available;<span class="comment">//availableæŠŠå¤´èŠ‚ç‚¹ç»™new_node</span></span><br><span class="line">    available = workspace[available].next;<span class="comment">//è‡ªå·±è·³åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (last_used &lt; max_list - <span class="number">1</span>) &#123; <span class="comment">//availableè¡¨æ²¡æœ‰ç©ºé—´å¯ä»¥ç”¨  é“¾è¡¨çš„å®¹é‡æ²¡è¶…è¿‡æœ€å¤§å®¹é‡</span></span><br><span class="line">    new_index = ++last_used;<span class="comment">//æ–°å»º</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">-1</span>;<span class="comment">//å¦‚æœæ–¹å¼1ã€2éƒ½æ²¡æœ‰æ–°å»ºæˆåŠŸï¼Œè¿”å›-1è¡¨ç¤ºå¤±è´¥</span></span><br><span class="line">  workspace[new_index].next = <span class="number">-1</span>;<span class="comment">//æ–°èŠ‚ç‚¹çš„nextåŸŸç½®ç©º</span></span><br><span class="line">  <span class="keyword">return</span> new_index;<span class="comment">//æˆåŠŸçš„è¯ è¿”å›æ–°èŠ‚ç‚¹</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line"><span class="type">void</span> List2&lt;List_entry&gt;::<span class="built_in">delete_node</span>(index old_index) &#123;</span><br><span class="line">  index previous;</span><br><span class="line">  <span class="keyword">if</span> (old_index == head) <span class="comment">//åˆ å¤´èŠ‚ç‚¹ è®©headä¸ºåŸæ¥å¤´ç»“ç‚¹çš„next</span></span><br><span class="line">    head = workspace[old_index].next;</span><br><span class="line">  <span class="keyword">else</span> &#123; <span class="comment">//åˆ é™¤çš„å…¶ä»–èŠ‚ç‚¹</span></span><br><span class="line">    previous = <span class="built_in">set_position</span>(<span class="built_in">current_position</span>(old_index) - <span class="number">1</span>);<span class="comment">//é€šè¿‡set_positionæ‹¿åˆ°å‰é©±èŠ‚ç‚¹</span></span><br><span class="line">    workspace[previous].next = workspace[old_index].next;<span class="comment">//è®©å‰é©±èŠ‚ç‚¹ç­‰äºå¾…åˆ èŠ‚ç‚¹çš„åç»§</span></span><br><span class="line">  &#125;</span><br><span class="line">  workspace[old_index].next = available;<span class="comment">//é€šè¿‡å¤´æ’çš„æ–¹å¼æŠŠèŠ‚ç‚¹æ·»åŠ åœ¨availableè¡¨ä¸­</span></span><br><span class="line">  available = old_index;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line">List2&lt;List_entry&gt;::<span class="built_in">List2</span>()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//åˆå§‹åŒ–</span></span><br><span class="line">  <span class="comment">//éƒ½å‡å®šä¸ºç©º -1</span></span><br><span class="line">  available = <span class="number">-1</span>;</span><br><span class="line">  last_used = <span class="number">-1</span>;</span><br><span class="line">  head = <span class="number">-1</span>;</span><br><span class="line">  count = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line"><span class="type">int</span> List2&lt;List_entry&gt;::<span class="built_in">size</span>() <span class="type">const</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line"><span class="type">bool</span> List2&lt;List_entry&gt;::<span class="built_in">full</span>() <span class="type">const</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> count &gt; max_list;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line"><span class="type">bool</span> List2&lt;List_entry&gt;::<span class="built_in">empty</span>() <span class="type">const</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> count == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line"><span class="type">void</span> List2&lt;List_entry&gt;::<span class="built_in">traverse</span>(<span class="built_in">void</span> (*visit)(List_entry&amp;)) &#123;</span><br><span class="line">  <span class="comment">//éå†é“¾è¡¨</span></span><br><span class="line">  <span class="keyword">for</span> (index n = head; n != <span class="number">-1</span>; n = workspace[n].next)<span class="comment">//n != -1   n != nullptr</span></span><br><span class="line">    (*visit)(workspace[n].entry);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line">Error_code List2&lt;List_entry&gt;::<span class="built_in">insert</span>(<span class="type">int</span> position, <span class="type">const</span> List_entry&amp; x) &#123;</span><br><span class="line">  index new_index, previous, following;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//åˆ¤æ–­positionä½ç½®æ˜¯å¦åˆæ³•</span></span><br><span class="line">  <span class="keyword">if</span> (position &lt; <span class="number">0</span> || position &gt; count) <span class="keyword">return</span> range_errors;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//ä¸æ˜¯å¤´æ’</span></span><br><span class="line">  <span class="keyword">if</span> (position &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">//æ‰¾åˆ°å‰é©±èŠ‚ç‚¹ å’Œ åç»§èŠ‚ç‚¹</span></span><br><span class="line">    previous = <span class="built_in">set_position</span>(position - <span class="number">1</span>);</span><br><span class="line">    following = workspace[previous].next;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//å¤´æ’  åç»§å°±æ˜¯å¤´èŠ‚ç‚¹</span></span><br><span class="line">  <span class="keyword">else</span> following = head;</span><br><span class="line">  <span class="keyword">if</span> ((new_index = <span class="built_in">new_node</span>()) == <span class="number">-1</span>) <span class="keyword">return</span> overflow;<span class="comment">//æ–°å»ºèŠ‚ç‚¹</span></span><br><span class="line">  workspace[new_index].entry = x;</span><br><span class="line">  workspace[new_index].next = following;<span class="comment">//nextåŸŸä¸ºä»–çš„åç»§</span></span><br><span class="line">  <span class="keyword">if</span> (position == <span class="number">0</span>) <span class="comment">//å¦‚æœæ˜¯å¤´æ’ æ–°çš„å¤´èŠ‚ç‚¹å°±æ˜¯new_node</span></span><br><span class="line">    head = new_index;</span><br><span class="line">  <span class="keyword">else</span> <span class="comment">//ä¸æ˜¯å¤´æ’çš„è¯ å¤„ç†ä»–çš„å‰é©±èŠ‚ç‚¹</span></span><br><span class="line">    workspace[previous].next = new_index;</span><br><span class="line">  count++;</span><br><span class="line">  <span class="keyword">return</span> success;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line">index List2&lt;List_entry&gt;::<span class="built_in">set_position</span>(<span class="type">int</span> position) <span class="type">const</span> &#123; <span class="comment">//æ ¹æ®ä¸‹æ ‡ï¼Œè·å¾—å½“å‰çš„å€¼</span></span><br><span class="line">  <span class="comment">//Node2&lt;List_entry&gt; p;</span></span><br><span class="line">  <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> (!(position&lt;<span class="number">0</span> || position&gt;max_list)) &#123;</span><br><span class="line">    <span class="comment">//éå†positionæ¬¡ æ‹¿åˆ°positionçš„èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">for</span> (i = head; cnt &lt; position; cnt++, i = workspace[i].next);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line"><span class="type">int</span> List2&lt;List_entry&gt;::<span class="built_in">current_position</span>(index n) <span class="type">const</span> &#123; <span class="comment">//æ ¹æ®èŠ‚ç‚¹ æ¥è·å–ä¸‹æ ‡</span></span><br><span class="line">  <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = head; i != n; cnt++, i = workspace[i].next);</span><br><span class="line">  <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line">Error_code List2&lt;List_entry&gt;::<span class="built_in">retrieve</span>(<span class="type">int</span> position, List_entry&amp; x) <span class="type">const</span> &#123; <span class="comment">//è®¿é—®positionä½ç½®çš„å€¼ï¼Œé€šè¿‡xå¸¦å‡ºæ¥</span></span><br><span class="line">  <span class="keyword">if</span> (position &lt; <span class="number">0</span> || position &gt; count) <span class="keyword">return</span> range_errors;<span class="comment">//åˆ¤æ–­positionä½ç½®åˆä¸åˆæ³•</span></span><br><span class="line">  <span class="type">int</span> cnt = <span class="number">0</span>, i;</span><br><span class="line">  <span class="keyword">for</span> (i = head; cnt != position; cnt++, i = workspace[i].next);<span class="comment">//éå†çš„æ–¹å¼æ‰¾åˆ°positionä½ç½®</span></span><br><span class="line">  x = workspace[i].entry;</span><br><span class="line">  <span class="keyword">return</span> success;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line">Error_code List2&lt;List_entry&gt;::<span class="built_in">remove</span>(<span class="type">int</span> position, List_entry&amp; x) &#123; <span class="comment">//æå‡ºpositionä½ç½®çš„èŠ‚ç‚¹</span></span><br><span class="line">  x = workspace[<span class="built_in">set_position</span>(position)].entry;<span class="comment">//set_positionæ‰¾åˆ°èŠ‚ç‚¹</span></span><br><span class="line">  <span class="built_in">delete_node</span>(<span class="built_in">set_position</span>(position));<span class="comment">//set_positionæ‰¾åˆ°èŠ‚ç‚¹ delete_nodeè¿›è¡Œåˆ é™¤</span></span><br><span class="line">  count--;</span><br><span class="line">  <span class="keyword">return</span> success;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line"><span class="type">void</span> List2&lt;List_entry&gt;::<span class="built_in">clear</span>()</span><br><span class="line">&#123;</span><br><span class="line">  index p, q;</span><br><span class="line">  <span class="keyword">for</span> (p = head; p != <span class="number">-1</span>; p = workspace[p].next) &#123; <span class="comment">//éå†é“¾è¡¨ å¯¹æ¯ä¸€ä¸ªèŠ‚ç‚¹è¿›è¡Œdelete_node</span></span><br><span class="line">    q = p;</span><br><span class="line">    <span class="built_in">delete_node</span>(p);</span><br><span class="line">  &#125;</span><br><span class="line">  count = <span class="number">0</span>;</span><br><span class="line">  head = <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> <span class="title class_">List_entry</span>&gt;</span><br><span class="line">Error_code List2&lt;List_entry&gt;::<span class="built_in">replace</span>(<span class="type">int</span> position, <span class="type">const</span> List_entry &amp;x) &#123;</span><br><span class="line">  <span class="keyword">if</span> (position &lt; <span class="number">0</span> || position &gt; count) <span class="keyword">return</span> range_errors;<span class="comment">//åˆ¤æ–­ä¸‹æ ‡åˆä¸åˆæ³•</span></span><br><span class="line">  workspace[<span class="built_in">set_position</span>(position)].entry = x;<span class="comment">//set_positionæ‰¾åˆ°positionä½ç½®çš„èŠ‚ç‚¹ æ›¿æ¢å€¼</span></span><br><span class="line">  <span class="keyword">return</span> success;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Main.cpp</span><br><span class="line"></span><br><span class="line">\<span class="meta">#<span class="keyword">include</span> <span class="string">&quot;List2.h&quot;</span></span></span><br><span class="line">\<span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// test List2 mechanism</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">write_entry</span><span class="params">(<span class="type">char</span> &amp;c)</span> </span>&#123;</span><br><span class="line">  cout &lt;&lt; c;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">char</span> x;</span><br><span class="line">  List2&lt;<span class="type">char</span>&gt; c_list;</span><br><span class="line">  <span class="comment">// a list of characters, initialized empty</span></span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;List is empty, it has &quot;</span> &lt;&lt; c_list.<span class="built_in">size</span>() &lt;&lt; <span class="string">&quot; items.\n&quot;</span>;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;Enter characters and the program adds them to the list.\n&quot;</span>;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;Use Enter key (newline) to terminate the input.\n&quot;</span>;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;When ListSize() is 3, the element will be inserted at the &quot;</span>;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;front of the list.\n The others will appear at the back.\n&quot;</span>;</span><br><span class="line">  <span class="keyword">while</span> (!c_list.<span class="built_in">full</span>() &amp;&amp; (x = cin.<span class="built_in">get</span>()) != <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (c_list.<span class="built_in">size</span>() == <span class="number">3</span>) c_list.<span class="built_in">insert</span>(<span class="number">0</span>, x);</span><br><span class="line">    <span class="keyword">else</span> c_list.<span class="built_in">insert</span>(c_list.<span class="built_in">size</span>(), x);</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;The list has &quot;</span> &lt;&lt; c_list.<span class="built_in">size</span>() &lt;&lt; <span class="string">&quot; items.\n&quot;</span>;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;The function c_list.full(), got &quot;</span> &lt;&lt; c_list.<span class="built_in">full</span>();</span><br><span class="line">  <span class="keyword">if</span> (c_list.<span class="built_in">full</span>())</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot; because the list is full.\n&quot;</span>;</span><br><span class="line">  <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot; because the list is NOT full.\n&quot;</span>;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;c_list.empty(), expecting 0, got &quot;</span> &lt;&lt; c_list.<span class="built_in">empty</span>() &lt;&lt; <span class="string">&quot;.\n&quot;</span>;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;c_list.traverse(write_entry) output: &quot;</span>; c_list.<span class="built_in">traverse</span>(write_entry);</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;\n&quot;</span>; c_list.<span class="built_in">clear</span>();</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;Cleared the list, printing its contents:\n&quot;</span>;</span><br><span class="line">  c_list.<span class="built_in">traverse</span>(write_entry);</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;\n&quot;</span>; cout &lt;&lt; <span class="string">&quot;Enter characters and the program adds them to the list.\n&quot;</span>;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;Use Enter key (newline) to terminate the input.\n&quot;</span>;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;When ListSize() is &lt; 3, the element will be inserted at the &quot;</span>;</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;front of the list.\n The others will appear at the back.\n&quot;</span>;</span><br><span class="line">  <span class="keyword">while</span> (!c_list.<span class="built_in">full</span>() &amp;&amp; (x = cin.<span class="built_in">get</span>()) != <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (c_list.<span class="built_in">size</span>() &lt; <span class="number">3</span>) c_list.<span class="built_in">insert</span>(<span class="number">0</span>, x);</span><br><span class="line">    <span class="keyword">else</span> c_list.<span class="built_in">insert</span>(c_list.<span class="built_in">size</span>(), x);</span><br><span class="line">  c_list.<span class="built_in">traverse</span>(write_entry);</span><br><span class="line">  cout &lt;&lt; <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br></pre></td></tr></table></figure><h4 id="å®éªŒ3-åŸºäºçº¿æ€§è¡¨-List1ã€çº¿æ€§è¡¨-List2-å®ç°çº¿æ€§è¡¨çš„åº”ç”¨ï¼šè¿åŠ¨ä¼šä¿¡æ¯ç®¡ç†"><a href="#å®éªŒ3-åŸºäºçº¿æ€§è¡¨-List1ã€çº¿æ€§è¡¨-List2-å®ç°çº¿æ€§è¡¨çš„åº”ç”¨ï¼šè¿åŠ¨ä¼šä¿¡æ¯ç®¡ç†" class="headerlink" title="å®éªŒ3. åŸºäºçº¿æ€§è¡¨ List1ã€çº¿æ€§è¡¨ List2 å®ç°çº¿æ€§è¡¨çš„åº”ç”¨ï¼šè¿åŠ¨ä¼šä¿¡æ¯ç®¡ç†"></a>å®éªŒ3. åŸºäºçº¿æ€§è¡¨ List1ã€çº¿æ€§è¡¨ List2 å®ç°çº¿æ€§è¡¨çš„åº”ç”¨ï¼šè¿åŠ¨ä¼šä¿¡æ¯ç®¡ç†</h4><p>E3.h(åŒ…å«æ‰€éœ€è¦çš„3ä¸ªç±»å’Œç›¸å…³çš„å‡½æ•°)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by huangruidong on 2022/6/19.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line">\<span class="meta">#<span class="keyword">ifndef</span> NEWDATASTRUCT_E3_H</span></span><br><span class="line">\<span class="meta">#<span class="keyword">define</span> NEWDATASTRUCT_E3_H</span></span><br><span class="line">\<span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line">\<span class="meta">#<span class="keyword">include</span><span class="string">&lt;fstream&gt;</span></span></span><br><span class="line">\<span class="meta">#<span class="keyword">include</span> <span class="string">&quot;vector&quot;</span></span></span><br><span class="line">\<span class="meta">#<span class="keyword">include</span> <span class="string">&quot;List1.h&quot;</span></span></span><br><span class="line">\<span class="meta">#<span class="keyword">include</span> <span class="string">&quot;List2.h&quot;</span></span></span><br><span class="line">\<span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Match</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  string call;  <span class="comment">//æ¯”èµ›é¡¹ç›®åç§°</span></span><br><span class="line">  <span class="type">int</span> number;  <span class="comment">//æ¯”èµ›é¡¹ç›®ç¼–å·</span></span><br><span class="line">  string sex; <span class="comment">//æ¯”èµ›æ€§åˆ«</span></span><br><span class="line">  string date;<span class="comment">//æ¯”èµ›çš„æ—¥æœŸ</span></span><br><span class="line">  string time;<span class="comment">//æ¯”èµ›æ—¶é—´</span></span><br><span class="line">  <span class="type">int</span> num;<span class="comment">//äººæ•°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="comment">//æ— å‚æ„é€ </span></span><br><span class="line">  <span class="built_in">Match</span>()&#123;&#125;;</span><br><span class="line">  <span class="comment">//æœ‰å‚æ„é€ </span></span><br><span class="line">  <span class="built_in">Match</span>(<span class="type">const</span> string &amp;call, <span class="type">int</span> number, <span class="type">const</span> string &amp;sex, <span class="type">const</span> string &amp;date, <span class="type">const</span> string &amp;time, <span class="type">int</span> num) : <span class="built_in">call</span>(</span><br><span class="line">      call), <span class="built_in">number</span>(number), <span class="built_in">sex</span>(sex), <span class="built_in">date</span>(date), <span class="built_in">time</span>(time), <span class="built_in">num</span>(num) &#123;&#125;;</span><br><span class="line">  <span class="comment">//get setæ–¹æ³•</span></span><br><span class="line">  <span class="function"><span class="type">const</span> string &amp;<span class="title">getCall</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> call;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">setCall</span><span class="params">(<span class="type">const</span> string &amp;call)</span> </span>&#123;</span><br><span class="line">    Match::call = call;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">getNumber</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> number;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">setNumber</span><span class="params">(<span class="type">int</span> number)</span> </span>&#123;</span><br><span class="line">    Match::number = number;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">const</span> string &amp;<span class="title">getSex</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sex;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">setSex</span><span class="params">(<span class="type">const</span> string &amp;sex)</span> </span>&#123;</span><br><span class="line">    Match::sex = sex;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">const</span> string &amp;<span class="title">getDate</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> date;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">setDate</span><span class="params">(<span class="type">const</span> string &amp;date)</span> </span>&#123;</span><br><span class="line">    Match::date = date;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">const</span> string &amp;<span class="title">getTime</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> time;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">setTime</span><span class="params">(<span class="type">const</span> string &amp;time)</span> </span>&#123;</span><br><span class="line">    Match::time = time;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">getNum</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">setNum</span><span class="params">(<span class="type">int</span> num)</span> </span>&#123;</span><br><span class="line">    Match::num = num;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//èµ‹å€¼è¿ç®—ç¬¦é‡è½½</span></span><br><span class="line">  Match <span class="keyword">operator</span> = (<span class="type">const</span> Match&amp; copy) &#123;</span><br><span class="line">    call = copy.call;</span><br><span class="line">    number = copy.number;</span><br><span class="line">    sex = copy.sex;</span><br><span class="line">    date = copy.date;</span><br><span class="line">    time = copy.time;</span><br><span class="line">    num = copy.num;</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">List1&lt;Match&gt; matchs;<span class="comment">//ç”¨List1å­˜å‚¨æ¯”èµ›é¡¹ç›®</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> size = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setMatch</span><span class="params">()</span> <span class="comment">//æ–°å»ºé¡¹ç›®</span></span></span><br><span class="line"><span class="function"></span>&#123;  <span class="function">ofstream <span class="title">fout</span><span class="params">(<span class="string">&quot;D:\\æ¯”èµ›é¡¹ç›®.txt&quot;</span>,ios::app)</span></span>;</span><br><span class="line">  <span class="type">char</span> ch;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123; cout&lt;&lt;<span class="string">&quot;è¯·åˆ†åˆ«è¾“å…¥æ¯”èµ›é¡¹ç›®åç§°ã€ç¼–å·ï¼ˆå‡è®¾ä¸º 6 ä½æ•°å­—ï¼‰ã€å‚ä¸è¯¥é¡¹ç›®çš„è¿åŠ¨å‘˜æ€§åˆ«ã€æ¯”èµ› æ—¥æœŸã€æ¯”èµ›æ—¶é—´ã€æ¯”èµ›äººæ•°.&quot;</span>&lt;&lt;endl;</span><br><span class="line">    string call;</span><br><span class="line">    <span class="type">int</span> number;</span><br><span class="line">    string sex;</span><br><span class="line">    string date;</span><br><span class="line">    string time;</span><br><span class="line">    <span class="type">int</span> num;</span><br><span class="line">    cin&gt;&gt;call&gt;&gt;number&gt;&gt;sex&gt;&gt;date&gt;&gt;time&gt;&gt;num;<span class="comment">//è¾“å…¥ç›¸å…³å±æ€§</span></span><br><span class="line">    Match temp = <span class="built_in">Match</span>(call,number,sex,date,time,num);<span class="comment">//åˆ›å»ºä¸€ä¸ªtempä¸´æ—¶å˜é‡</span></span><br><span class="line">    matchs.<span class="built_in">insert</span>(<span class="number">0</span>,temp);<span class="comment">//å¤´æ’åœ¨é“¾è¡¨ä¸­</span></span><br><span class="line"></span><br><span class="line">â€‹    fout.<span class="built_in">write</span>((<span class="type">char</span> *)&amp;temp,<span class="built_in">sizeof</span>(Match));<span class="comment">//å†™å…¥æ–‡ä»¶æµ</span></span><br><span class="line">â€‹    cout&lt;&lt;<span class="string">&quot;æ˜¯å¦ç»§ç»­è¾“å…¥ï¼Œå¦‚æœç»§ç»­é”®å…¥Y|y&quot;</span>&lt;&lt;endl;</span><br><span class="line">â€‹    cin&gt;&gt;ch;</span><br><span class="line">  &#125;<span class="keyword">while</span>(ch==<span class="string">&#x27;y&#x27;</span>||ch==<span class="string">&#x27;Y&#x27;</span>);</span><br><span class="line">  fout.<span class="built_in">close</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">changeMatch</span><span class="params">()</span>  <span class="comment">//ä¿®æ”¹ä¸€ä¸ªé¡¹ç›®</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;æ‚¨æ­£åœ¨è¿›è¡Œä¿®æ”¹æ¯”èµ›é¡¹ç›®æœ‰å…³äº‹é¡¹æ“ä½œ!&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥è¦ä¿®æ”¹æ¯”èµ›é¡¹ç›®çš„ç¼–å·:&quot;</span>&lt;&lt;endl;</span><br><span class="line">  <span class="type">int</span> number1;    <span class="comment">//è¦ä¿®æ”¹çš„æ¯”èµ›é¡¹ç›®ç¼–å·</span></span><br><span class="line">  <span class="type">int</span> sign=<span class="number">0</span>;     <span class="comment">//è®¾ç½®çš„æ ‡è®°å˜é‡</span></span><br><span class="line">  cin&gt;&gt;number1;</span><br><span class="line">  <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (; i &lt; matchs.<span class="built_in">size</span>(); i++) &#123; <span class="comment">//éå†è¡¨ æ‰¾æŒ‡å®šçš„é¡¹ç›®ç¼–å·</span></span><br><span class="line">    Match temp;</span><br><span class="line">    matchs.<span class="built_in">retrieve</span>(i,temp);</span><br><span class="line">    <span class="keyword">if</span> (number1 == temp.<span class="built_in">getNumber</span>())&#123;</span><br><span class="line">      sign = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//æ²¡æ‰¾åˆ°çš„è¯ è¾“å‡ºä¿¡æ¯æç¤º</span></span><br><span class="line">  <span class="keyword">if</span> (sign==<span class="number">0</span>)</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;æ²¡æœ‰æ‰¾åˆ°è¦ä¿®æ”¹çš„è®°å½•ï¼&quot;</span>&lt;&lt;endl;</span><br><span class="line">  <span class="keyword">else</span> <span class="comment">//æ‰¾åˆ°äº†é¡¹ç›®</span></span><br><span class="line">  &#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;è¯·é€‰æ‹©è¦ä¿®æ”¹æ¯”èµ›é¡¹ç›®çš„é‚£äº›ä¿¡æ¯&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;------ä¿®æ”¹æ¯”èµ›é¡¹ç›®çš„åç§°----1&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;------ä¿®æ”¹æ¯”èµ›é¡¹ç›®çš„ç¼–å·----2&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;------ä¿®æ”¹æ¯”èµ›é¡¹ç›®çš„æ€§åˆ«----3&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;------ä¿®æ”¹æ¯”èµ›æ—¥æœŸ----4&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;------ä¿®æ”¹æ¯”èµ›æ—¶é—´----5&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;------ä¿®æ”¹æ¯”èµ›äººæ•°----6&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥å¯¹åº”ä¿¡æ¯çš„ç¼–å·&quot;</span>&lt;&lt;endl;</span><br><span class="line">    <span class="type">int</span> a;</span><br><span class="line">    cin&gt;&gt;a;</span><br><span class="line">    <span class="keyword">switch</span>(a) <span class="comment">//switch case æ§åˆ¶ä¿®æ”¹çš„é‚£ä¸€éƒ¨åˆ†</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥æ–°çš„æ¯”èµ›é¡¹ç›®åç§°:&quot;</span>&lt;&lt;endl;</span><br><span class="line">        string name;</span><br><span class="line">        cin&gt;&gt;name;</span><br><span class="line">        Match temp;</span><br><span class="line">        matchs.<span class="built_in">retrieve</span>(i,temp);<span class="comment">//é€šè¿‡ä¸Šæ¬¡æ ‡è®°çš„i æ‹¿å‡ºæ¥æ‰¾åˆ°çš„é¡¹ç›®</span></span><br><span class="line">        temp.<span class="built_in">setCall</span>(name);<span class="comment">//ä¿®æ”¹é¡¹ç›®å§“å</span></span><br><span class="line">        matchs.<span class="built_in">replace</span>(i,temp);<span class="comment">//å¯¹è¡¨ä¸­çš„æ•°æ®è¿›è¡Œæ›¿æ¢</span></span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;æ¯”èµ›é¡¹ç›®åç§°ä¿®æ”¹æˆåŠŸ!&quot;</span>&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;è¯·è¾“å…¥æ–°çš„æ¯”èµ›ç¼–å·:&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="type">int</span> number;</span><br><span class="line">        cin&gt;&gt;number;</span><br><span class="line">        Match match;</span><br><span class="line">        matchs.<span class="built_in">remove</span>(i,match);</span><br><span class="line">        match.<span class="built_in">setNumber</span>(number);</span><br><span class="line">        matchs.<span class="built_in">insert</span>(i,match);</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;æ¯”èµ›é¡¹ç›®ç¼–å·ä¿®æ”¹æˆåŠŸ!&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥æ–°çš„å‚èµ›é€‰æ‰‹æ€§åˆ«:&quot;</span>&lt;&lt;endl;</span><br><span class="line">        string sex;</span><br><span class="line">        cin&gt;&gt;sex;</span><br><span class="line">        Match match;</span><br><span class="line">        matchs.<span class="built_in">remove</span>(i,match);</span><br><span class="line">        match.<span class="built_in">setSex</span>(sex);</span><br><span class="line">        matchs.<span class="built_in">insert</span>(i,match);</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;å‚èµ›é€‰æ‰‹æ€§åˆ«ä¿®æ”¹æˆåŠŸ!&quot;</span>&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥æ–°çš„æ—¥æœŸ:&quot;</span>&lt;&lt;endl;</span><br><span class="line">        string date;</span><br><span class="line">        cin&gt;&gt;date;</span><br><span class="line">        Match match;</span><br><span class="line">        matchs.<span class="built_in">remove</span>(i,match);</span><br><span class="line">        match.<span class="built_in">setDate</span>(date);</span><br><span class="line">        matchs.<span class="built_in">insert</span>(i,match);</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;æ¯”èµ›æ—¥æœŸä¿®æ”¹æˆåŠŸ!&quot;</span>&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">5</span>:&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥æ–°çš„æ¯”èµ›æ—¶é—´:&quot;</span>&lt;&lt;endl;</span><br><span class="line">        string time;</span><br><span class="line">        cin&gt;&gt;time;</span><br><span class="line">        Match match;</span><br><span class="line">        matchs.<span class="built_in">remove</span>(i,match);</span><br><span class="line">        match.<span class="built_in">setDate</span>(time);</span><br><span class="line">        matchs.<span class="built_in">insert</span>(i,match);</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;æ¯”èµ›æ—¶é—´ä¿®æ”¹æˆåŠŸ!&quot;</span>&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">6</span>:&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥æ–°çš„å‚èµ›äººæ•°:&quot;</span>&lt;&lt;endl;</span><br><span class="line">        <span class="type">int</span> num;</span><br><span class="line">        cin&gt;&gt;num;</span><br><span class="line">        Match match;</span><br><span class="line">        matchs.<span class="built_in">remove</span>(i,match);</span><br><span class="line">        match.<span class="built_in">setNum</span>(num);</span><br><span class="line">        matchs.<span class="built_in">insert</span>(i,match);</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;å‚èµ›äººæ•°ä¿®æ”¹æˆåŠŸ!&quot;</span>&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">deleteMatch</span><span class="params">()</span>  <span class="comment">//åˆ é™¤ä¸€ä¸ªé¡¹ç›®</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;------æ ¹æ®æ¯”èµ›é¡¹ç›®çš„ç¼–å·åˆ é™¤----1&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;------æ ¹æ®æ¯”èµ›é¡¹ç›®çš„åç§°åˆ é™¤----2&quot;</span>&lt;&lt;endl;</span><br><span class="line">  <span class="type">int</span> n;</span><br><span class="line">  cin&gt;&gt;n;</span><br><span class="line">  <span class="keyword">switch</span>(n) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>: &#123;</span><br><span class="line">      cout &lt;&lt; <span class="string">&quot;è¯·è¾“å…¥è¦åˆ é™¤çš„æ¯”èµ›ç¼–å·&quot;</span> &lt;&lt; endl;</span><br><span class="line">      <span class="type">int</span> number;</span><br><span class="line">      cin &gt;&gt; number;</span><br><span class="line">      Match temp;</span><br><span class="line">      <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">      <span class="type">bool</span> isFind = <span class="literal">false</span>;<span class="comment">//æ ‡è®°</span></span><br><span class="line">      <span class="keyword">for</span> (; i &lt; matchs.<span class="built_in">size</span>(); i++) &#123; <span class="comment">//éå†æ•´ä¸ªè¡¨ å¦‚æœæ‰¾åˆ° å°±é€šè¿‡removeè¿›è¡Œåˆ é™¤</span></span><br><span class="line">        matchs.<span class="built_in">retrieve</span>(i, temp);</span><br><span class="line">        <span class="keyword">if</span> (temp.<span class="built_in">getNumber</span>() == number) &#123;</span><br><span class="line">          cout &lt;&lt; <span class="string">&quot;æ‰¾åˆ°ä¿¡æ¯&quot;</span> &lt;&lt; endl;</span><br><span class="line">          matchs.<span class="built_in">remove</span>(i, temp);</span><br><span class="line">          cout &lt;&lt; <span class="string">&quot;åˆ é™¤æˆåŠŸ&quot;</span> &lt;&lt; endl;</span><br><span class="line">          isFind = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">//æ²¡æ‰¾åˆ°çš„è¯ è¾“å‡ºä¿¡æ¯æç¤º</span></span><br><span class="line">      <span class="keyword">if</span> (!isFind) cout &lt;&lt; <span class="string">&quot;æœªæ‰¾åˆ°è¯¥é¡¹ç›®&quot;</span> &lt;&lt; endl;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>: &#123;</span><br><span class="line">      cout &lt;&lt; <span class="string">&quot;è¯·è¾“å…¥è¦åˆ é™¤çš„æ¯”èµ›åç§°&quot;</span> &lt;&lt; endl;</span><br><span class="line">      string name;</span><br><span class="line">      cin &gt;&gt; name;</span><br><span class="line">      Match temp;</span><br><span class="line">      <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">      <span class="type">bool</span> isFind = <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">for</span> (; i &lt; matchs.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">        matchs.<span class="built_in">retrieve</span>(i, temp);</span><br><span class="line">        <span class="keyword">if</span> (temp.<span class="built_in">getCall</span>() == name) &#123;</span><br><span class="line">          cout &lt;&lt; <span class="string">&quot;æ‰¾åˆ°ä¿¡æ¯&quot;</span> &lt;&lt; endl;</span><br><span class="line">          matchs.<span class="built_in">remove</span>(i, temp);</span><br><span class="line">          cout &lt;&lt; <span class="string">&quot;åˆ é™¤æˆåŠŸ&quot;</span> &lt;&lt; endl;</span><br><span class="line">          isFind = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">//æ²¡æ‰¾åˆ°çš„è¯ è¾“å‡ºä¿¡æ¯æç¤º</span></span><br><span class="line">      <span class="keyword">if</span> (!isFind) cout &lt;&lt; <span class="string">&quot;æœªæ‰¾åˆ°è¯¥é¡¹ç›®&quot;</span> &lt;&lt; endl;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">selectMatch</span><span class="params">()</span> <span class="comment">//æŸ¥è¯¢ä¸€ä¸ªé¡¹ç›®</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;------æ ¹æ®æ¯”èµ›é¡¹ç›®çš„ç¼–å·æŸ¥æ‰¾----1&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;------æ ¹æ®æ¯”èµ›é¡¹ç›®çš„åç§°æŸ¥æ‰¾----2&quot;</span>&lt;&lt;endl;</span><br><span class="line">  <span class="type">int</span> n;</span><br><span class="line">  cin&gt;&gt;n;</span><br><span class="line">  <span class="keyword">switch</span>(n) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>: &#123;</span><br><span class="line">      cout &lt;&lt; <span class="string">&quot;è¯·è¾“å…¥è¦æŸ¥æ‰¾çš„æ¯”èµ›ç¼–å·&quot;</span> &lt;&lt; endl;</span><br><span class="line">      <span class="type">int</span> number;</span><br><span class="line">      cin &gt;&gt; number;</span><br><span class="line">      Match temp;</span><br><span class="line">      <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">      <span class="type">bool</span> isFind = <span class="literal">false</span>;<span class="comment">//æ ‡å¿—ä½</span></span><br><span class="line">      <span class="keyword">for</span> (; i &lt; matchs.<span class="built_in">size</span>(); i++) &#123; <span class="comment">//éå†æ•´å¼ è¡¨ å¦‚æœæ‰¾åˆ° è®©æ ‡å¿—ä½è®¾ä¸ºtrue</span></span><br><span class="line">        matchs.<span class="built_in">retrieve</span>(i, temp);</span><br><span class="line">        <span class="keyword">if</span> (temp.<span class="built_in">getNumber</span>() == number) &#123; <span class="comment">//æ‰¾åˆ°ä¿¡æ¯çš„è¯ å°±æŠŠç›¸å…³çš„ä¿¡æ¯è¿›è¡Œè¾“å‡º</span></span><br><span class="line">          cout &lt;&lt; <span class="string">&quot;æ‰¾åˆ°ä¿¡æ¯ï¼š&quot;</span> &lt;&lt; endl;</span><br><span class="line">          cout&lt;&lt;temp.<span class="built_in">getNumber</span>()&lt;&lt;<span class="string">&quot; &quot;</span> &lt;&lt;temp.<span class="built_in">getCall</span>()&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;temp.<span class="built_in">getSex</span>()&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;temp.<span class="built_in">getDate</span>()&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;temp.<span class="built_in">getTime</span>()&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;temp.<span class="built_in">getNum</span>()&lt;&lt;endl;</span><br><span class="line">          isFind = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">//æ²¡æ‰¾åˆ°çš„è¯ è¾“å‡ºä¿¡æ¯æç¤º</span></span><br><span class="line">      <span class="keyword">if</span> (!isFind) cout &lt;&lt; <span class="string">&quot;æœªæ‰¾åˆ°è¯¥é¡¹ç›®&quot;</span> &lt;&lt; endl;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>: &#123;</span><br><span class="line">      cout &lt;&lt; <span class="string">&quot;è¯·è¾“å…¥è¦åˆ é™¤çš„æ¯”èµ›åç§°&quot;</span> &lt;&lt; endl;</span><br><span class="line">      string name;</span><br><span class="line">      cin &gt;&gt; name;</span><br><span class="line">      Match temp;</span><br><span class="line">      <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">      <span class="type">bool</span> isFind = <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">for</span> (; i &lt; matchs.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">        matchs.<span class="built_in">retrieve</span>(i, temp);</span><br><span class="line">        <span class="keyword">if</span> (temp.<span class="built_in">getCall</span>() == name) &#123;</span><br><span class="line">          cout &lt;&lt; <span class="string">&quot;æ‰¾åˆ°ä¿¡æ¯ï¼š&quot;</span> &lt;&lt; endl;</span><br><span class="line">          cout&lt;&lt;temp.<span class="built_in">getNumber</span>()&lt;&lt;<span class="string">&quot; &quot;</span> &lt;&lt;temp.<span class="built_in">getCall</span>()&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;temp.<span class="built_in">getSex</span>()&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;temp.<span class="built_in">getDate</span>()&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;temp.<span class="built_in">getTime</span>()&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;temp.<span class="built_in">getNum</span>()&lt;&lt;endl;</span><br><span class="line">          isFind = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (!isFind) cout &lt;&lt; <span class="string">&quot;æœªæ‰¾åˆ°è¯¥é¡¹ç›®&quot;</span> &lt;&lt; endl;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Athlete</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">  string name;<span class="comment">//å§“å</span></span><br><span class="line">  string id;<span class="comment">//å­¦å·</span></span><br><span class="line">  string sex;<span class="comment">//æ€§åˆ«</span></span><br><span class="line">  string college;<span class="comment">//å­¦é™¢</span></span><br><span class="line">  string matchId;<span class="comment">//å‚åŠ çš„æ¯”èµ›ç¼–å·</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="comment">//é¡¹ç›®ç¼–å·</span></span><br><span class="line">  <span class="type">bool</span> isText;<span class="comment">//æ˜¯å¦æ£€å½•</span></span><br><span class="line">  string score;<span class="comment">//å‚èµ›æˆç»©</span></span><br><span class="line">  <span class="type">int</span> rank;<span class="comment">//æ’å</span></span><br><span class="line">  <span class="type">int</span> grade;<span class="comment">//çº§åˆ«åˆ†æ•°</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="comment">//æœ‰å‚æ„é€ </span></span><br><span class="line">  <span class="built_in">Athlete</span>( string &amp;name,  string &amp;id,  string &amp;sex,  string &amp;college,  string &amp;matchId,</span><br><span class="line">      <span class="type">bool</span> isText,  string &amp;score, <span class="type">int</span> rank, <span class="type">int</span> grade) : <span class="built_in">name</span>(name), <span class="built_in">id</span>(id), <span class="built_in">sex</span>(sex), <span class="built_in">college</span>(college),</span><br><span class="line">                                   <span class="built_in">matchId</span>(matchId), <span class="built_in">isText</span>(isText), <span class="built_in">score</span>(score),</span><br><span class="line">                                   <span class="built_in">rank</span>(rank), <span class="built_in">grade</span>(grade) &#123;&#125;;</span><br><span class="line">  <span class="comment">//èµ‹å€¼è¿ç®—ç¬¦é‡è½½</span></span><br><span class="line">  Athlete <span class="keyword">operator</span> = (<span class="type">const</span> Athlete&amp; copy)&#123;</span><br><span class="line">    name = copy.name;</span><br><span class="line">    id = copy.id;</span><br><span class="line">    sex = copy.sex;</span><br><span class="line">    college = copy.college;</span><br><span class="line">    matchId = copy.matchId;</span><br><span class="line">    isText = copy.isText;</span><br><span class="line">    score = copy.score;</span><br><span class="line">    rank = copy.rank;</span><br><span class="line">    grade = copy.grade;</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//é‡å†™çš„æœ‰å‚æ„é€ </span></span><br><span class="line">  <span class="built_in">Athlete</span>(<span class="type">const</span> string &amp;name, <span class="type">const</span> string &amp;id, <span class="type">const</span> string &amp;sex, <span class="type">const</span> string &amp;college, <span class="type">const</span> string &amp;matchId)</span><br><span class="line">      : <span class="built_in">name</span>(name), <span class="built_in">id</span>(id), <span class="built_in">sex</span>(sex), <span class="built_in">college</span>(college), <span class="built_in">matchId</span>(matchId) &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//æ‹·è´æ„é€ </span></span><br><span class="line">  <span class="built_in">Athlete</span>(Athlete <span class="type">const</span> &amp;a2) &#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;name = a2.name;</span><br><span class="line">    <span class="keyword">this</span>-&gt;id = a2.id;</span><br><span class="line">    <span class="keyword">this</span>-&gt;sex = a2.sex;</span><br><span class="line">    <span class="keyword">this</span>-&gt;college = a2.college;</span><br><span class="line">    <span class="keyword">this</span>-&gt;isText = a2.isText;</span><br><span class="line">    <span class="keyword">this</span>-&gt;score = a2.score;</span><br><span class="line">    <span class="keyword">this</span>-&gt;rank = a2.rank;</span><br><span class="line">    <span class="keyword">this</span>-&gt;grade = a2.grade;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//get setæ–¹æ³•</span></span><br><span class="line">  <span class="function"><span class="type">const</span> string &amp;<span class="title">getName</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">setName</span><span class="params">(<span class="type">const</span> string &amp;name)</span> </span>&#123;</span><br><span class="line">    Athlete::name = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">const</span> string &amp;<span class="title">getId</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> id;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">setId</span><span class="params">(<span class="type">const</span> string &amp;id)</span> </span>&#123;</span><br><span class="line">    Athlete::id = id;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">const</span> string &amp;<span class="title">getSex</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sex;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">setSex</span><span class="params">(<span class="type">const</span> string &amp;sex)</span> </span>&#123;</span><br><span class="line">    Athlete::sex = sex;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">const</span> string &amp;<span class="title">getCollege</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> college;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">setCollege</span><span class="params">(<span class="type">const</span> string &amp;college)</span> </span>&#123;</span><br><span class="line">    Athlete::college = college;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">const</span> string &amp;<span class="title">getMatchId</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> matchId;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">setMatchId</span><span class="params">(<span class="type">const</span> string &amp;matchId)</span> </span>&#123;</span><br><span class="line">    Athlete::matchId = matchId;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">bool</span> <span class="title">isText1</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> isText;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">setIsText</span><span class="params">(<span class="type">bool</span> isText)</span> </span>&#123;</span><br><span class="line">    Athlete::isText = isText;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function">string <span class="title">getScore</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> score;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">setScore</span><span class="params">(string score)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;score = <span class="string">&quot;&quot;</span>+score;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">getRank</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> rank;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//è®¡ç®—åˆ†æ•°</span></span><br><span class="line">  <span class="comment">//rank è·å¾—å‡ ç­‰å¥–  å¯¹åº”çš„åˆ†æ•°gradeå°±æ˜¯å¤šå°‘</span></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">setRank</span><span class="params">(<span class="type">int</span> rank)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>-&gt;rank = rank;</span><br><span class="line">    <span class="keyword">if</span> (rank == <span class="number">1</span>) <span class="keyword">this</span>-&gt;grade = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (rank == <span class="number">2</span>) <span class="keyword">this</span>-&gt;grade = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (rank == <span class="number">3</span>) <span class="keyword">this</span>-&gt;grade = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">this</span>-&gt;grade = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">int</span> <span class="title">getGrade</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> grade;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//æ— å‚æ„é€ </span></span><br><span class="line">  <span class="built_in">Athlete</span>() &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">Athlete</span>(<span class="type">const</span> Node2&lt;<span class="keyword">struct</span> Athlete&gt; node2);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//é™æ€é“¾è¡¨å®ç°çš„çº¿æ€§è¡¨å­˜å‚¨è¿åŠ¨å‘˜</span></span><br><span class="line">List2&lt;Athlete&gt; athletes;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">inputAthlete</span><span class="params">()</span><span class="comment">//åˆ›å»ºè¿åŠ¨å‘˜</span></span></span><br><span class="line"><span class="function"></span>&#123;  <span class="function">ofstream <span class="title">fout</span><span class="params">(<span class="string">&quot;d:\\è¿åŠ¨å‘˜.txt&quot;</span>,ios::app)</span></span>;<span class="comment">//æ‰“å¼€æ–‡ä»¶</span></span><br><span class="line">  <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="type">char</span> ch;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;  cout&lt;&lt;<span class="string">&quot;è¯·åˆ†åˆ«è¾“å…¥è¿åŠ¨å‘˜å§“åï¼Œå­¦å·ï¼Œæ€§åˆ«ï¼Œå­¦é™¢ï¼Œå‚åŠ çš„é¡¹ç›®æ ‡å·&quot;</span>&lt;&lt;endl;</span><br><span class="line">    string name;</span><br><span class="line">    string id;</span><br><span class="line">    string sex;</span><br><span class="line">    string college;</span><br><span class="line">    string matchId;</span><br><span class="line">    cin&gt;&gt;name&gt;&gt;id&gt;&gt;sex&gt;&gt;college&gt;&gt;matchId;<span class="comment">//è¾“å…¥ç›¸å…³ä¿¡æ¯</span></span><br><span class="line">    <span class="function">Athlete <span class="title">temp</span><span class="params">(name,id,sex,college,matchId)</span></span>;<span class="comment">//åˆ›å»ºtempå¯¹è±¡</span></span><br><span class="line">    athletes.<span class="built_in">insert</span>(i,temp);<span class="comment">//æ’å…¥åˆ°çº¿æ€§è¡¨ä¸­</span></span><br><span class="line">    fout.<span class="built_in">write</span>((<span class="type">char</span> *)&amp;temp,<span class="built_in">sizeof</span>(Athlete));<span class="comment">//å†™å…¥æ–‡ä»¶</span></span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;æ˜¯å¦ç»§ç»­è¾“å…¥ï¼Œå¦‚æœç»§ç»­é”®å…¥Y|y&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cin&gt;&gt;ch;</span><br><span class="line">  &#125;<span class="keyword">while</span>(ch==<span class="string">&#x27;y&#x27;</span>||ch==<span class="string">&#x27;Y&#x27;</span>);</span><br><span class="line">  fout.<span class="built_in">close</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span>  <span class="title">deleteAthlete</span><span class="params">()</span><span class="comment">//æ’¤é”€æŠ¥å ï¼ˆåˆ é™¤è¿åŠ¨å‘˜ï¼‰</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">//åªæœ‰å­¦å·æ˜¯å”¯ä¸€çš„ï¼Œæ‰€ä»¥æ ¹æ®å­¦å·æ¥æ’¤é”€æŠ¥å</span></span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥è¢«æ’¤é”€æŠ¥åçš„è¿åŠ¨å‘˜çš„å­¦å·&quot;</span>&lt;&lt;endl;</span><br><span class="line">  string id;</span><br><span class="line">  cin&gt;&gt;id;</span><br><span class="line">  Athlete temp;</span><br><span class="line">  <span class="type">bool</span> flag =<span class="literal">false</span>;<span class="comment">//æ ‡å¿—ä½</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; athletes.<span class="built_in">size</span>(); i++) &#123; <span class="comment">//éå†è¡¨ æ¥å¯»æ‰¾</span></span><br><span class="line">    athletes.<span class="built_in">retrieve</span>(i,temp);</span><br><span class="line">    <span class="keyword">if</span> (temp.<span class="built_in">getId</span>() == id) &#123;<span class="comment">//æ‰¾åˆ° é€šè¿‡removeç§»é™¤</span></span><br><span class="line">      athletes.<span class="built_in">remove</span>(i,temp);</span><br><span class="line">      cout&lt;&lt;<span class="string">&quot;åˆ é™¤æˆåŠŸ&quot;</span>&lt;&lt;endl;</span><br><span class="line">      flag = <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//æœªæ‰¾åˆ°è¿åŠ¨å‘˜ è¾“å‡ºä¿¡æ¯è¿›è¡Œæç¤º</span></span><br><span class="line">  <span class="keyword">if</span> (!flag) &#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;æœªæ‰¾åˆ°è¯¥è¿åŠ¨å‘˜&quot;</span>&lt;&lt;endl;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">cheekAthlete</span><span class="params">()</span></span>&#123;<span class="comment">//å¯¹è¿åŠ¨å‘˜æ£€å½•</span></span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥è¦æ£€å½•çš„è¿åŠ¨å‘˜çš„å­¦å·&quot;</span>&lt;&lt;endl;</span><br><span class="line">  string id;</span><br><span class="line">  cin&gt;&gt;id;</span><br><span class="line">  Athlete temp;</span><br><span class="line">  <span class="type">bool</span> flag =<span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; athletes.<span class="built_in">size</span>(); i++) &#123;<span class="comment">//éå†çº¿æ€§è¡¨</span></span><br><span class="line">    athletes.<span class="built_in">retrieve</span>(i,temp);</span><br><span class="line">    <span class="keyword">if</span> (temp.<span class="built_in">getId</span>() == id) &#123; <span class="comment">//å¦‚æœæ‰¾åˆ°äº†</span></span><br><span class="line">      <span class="keyword">if</span> (temp.<span class="built_in">isText1</span>()) &#123; <span class="comment">//å…ˆçœ‹æœ‰æ²¡æœ‰æ£€å½•è¿‡</span></span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;å·²ç»æ£€å½•è¿‡äº†&quot;</span>&lt;&lt;endl;</span><br><span class="line">        flag = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123; <span class="comment">//æ²¡æ£€å½•è¿‡ æ£€å½• replaceæ›¿æ¢è¡¨çš„æ•°æ®</span></span><br><span class="line">        temp.<span class="built_in">setIsText</span>(<span class="literal">true</span>);</span><br><span class="line">        athletes.<span class="built_in">replace</span>(i,temp);</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;æ£€å½•æˆåŠŸ&quot;</span>&lt;&lt;endl;</span><br><span class="line">        flag = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//æ²¡æ‰¾åˆ°çš„è¯ç»™å‡ºæç¤ºä¿¡æ¯</span></span><br><span class="line">  <span class="keyword">if</span> (!flag) &#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;æœªæ‰¾åˆ°è¯¥è¿åŠ¨å‘˜&quot;</span>&lt;&lt;endl;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loginScoreAthlete</span><span class="params">()</span></span>&#123;<span class="comment">//ç­‰çº§è¿åŠ¨å‘˜çš„ä¿¡æ¯</span></span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥è¦å½•å…¥åˆ†æ•°çš„è¿åŠ¨å‘˜çš„å­¦å·&quot;</span>&lt;&lt;endl;</span><br><span class="line">  string id;</span><br><span class="line">  cin&gt;&gt;id;</span><br><span class="line">  Athlete temp;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥è¯¥è¿åŠ¨å‘˜çš„æˆç»© å’Œ æ’å&quot;</span>&lt;&lt;endl;</span><br><span class="line">  string score;</span><br><span class="line">  <span class="type">int</span> rank;</span><br><span class="line">  cin&gt;&gt;score;<span class="comment">//æˆç»©</span></span><br><span class="line">  cin&gt;&gt;rank;<span class="comment">//æ’å</span></span><br><span class="line">  <span class="type">bool</span> flag =<span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; athletes.<span class="built_in">size</span>(); i++) &#123; <span class="comment">//éå†æ•´ä¸ªè¡¨ æ‰¾åˆ°è¦ç™»è®°æˆç»©çš„å­¦ç”Ÿ</span></span><br><span class="line">    athletes.<span class="built_in">retrieve</span>(i,temp);</span><br><span class="line">    <span class="keyword">if</span> (temp.<span class="built_in">getId</span>() == id &amp;&amp; temp.<span class="built_in">isText1</span>()) &#123;<span class="comment">//å¦‚æœidæŸ¥åˆ°ï¼Œå¹¶ä¸”æ£€å½•è¿‡äº†</span></span><br><span class="line">      temp.<span class="built_in">setScore</span>(score);</span><br><span class="line">      temp.<span class="built_in">setRank</span>(rank);<span class="comment">//ç™»è®°ä¿¡æ¯</span></span><br><span class="line">      athletes.<span class="built_in">replace</span>(i,temp);<span class="comment">//æ›¿æ¢è¡¨ä¸­çš„æ•°æ®</span></span><br><span class="line">      cout&lt;&lt;<span class="string">&quot;æˆç»©å½•å…¥å®Œæˆ&quot;</span>&lt;&lt;endl;</span><br><span class="line">      flag = <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//æ²¡æ‰¾åˆ°çš„è¯ç»™å‡ºæç¤ºä¿¡æ¯</span></span><br><span class="line">  <span class="keyword">if</span> (!flag) &#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;æœªæ‰¾åˆ°è¯¥è¿åŠ¨å‘˜æˆ–è€…è¯¥è¿åŠ¨å‘˜æ²¡æœ‰æ£€å½•&quot;</span>&lt;&lt;endl;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">selectAthlete</span><span class="params">()</span> </span>&#123; <span class="comment">//æŸ¥è¯¢è¿åŠ¨å‘˜ä¿¡æ¯</span></span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥è¦æŸ¥è¯¢çš„è¿åŠ¨å‘˜çš„å­¦å·&quot;</span>&lt;&lt;endl;</span><br><span class="line">  string id;</span><br><span class="line">  cin&gt;&gt;id;</span><br><span class="line">  Athlete temp;</span><br><span class="line">  <span class="type">bool</span> flag =<span class="literal">false</span>;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; athletes.<span class="built_in">size</span>(); i++) &#123; <span class="comment">//éå†æ•´ä¸ªè¡¨ æ‰¾åˆ°æŒ‡å®šçš„è¿åŠ¨å‘˜</span></span><br><span class="line">    athletes.<span class="built_in">retrieve</span>(i,temp);</span><br><span class="line">    <span class="keyword">if</span> (temp.<span class="built_in">getId</span>() == id) &#123;</span><br><span class="line">      <span class="comment">//æ‰¾åˆ°äº† è¾“å‡ºç›¸å…³ä¿¡æ¯</span></span><br><span class="line">      cout&lt;&lt;<span class="string">&quot;å­¦å·:&quot;</span>&lt;&lt;temp.<span class="built_in">getId</span>()&lt;&lt;<span class="string">&quot; å§“åï¼š&quot;</span>&lt;&lt;temp.<span class="built_in">getName</span>()&lt;&lt; <span class="string">&quot; æ€§åˆ«ï¼š&quot;</span>&lt;&lt;temp.<span class="built_in">getSex</span>()&lt;&lt;<span class="string">&quot; å­¦é™¢ï¼š&quot;</span>&lt;&lt;temp.<span class="built_in">getCollege</span>()</span><br><span class="line">        &lt;&lt; <span class="string">&quot; å‚åŠ çš„é¡¹ç›®ç¼–å·ï¼š&quot;</span>&lt;&lt;temp.<span class="built_in">getMatchId</span>()&lt;&lt;<span class="string">&quot; æ˜¯å¦æ£€å½•ï¼š&quot;</span>&lt;&lt;temp.<span class="built_in">isText1</span>()&lt;&lt;<span class="string">&quot; å‚èµ›æˆç»©ï¼š&quot;</span>&lt;&lt;temp.<span class="built_in">getScore</span>()</span><br><span class="line">        &lt;&lt;<span class="string">&quot; æ’åï¼š&quot;</span>&lt;&lt;temp.<span class="built_in">getRank</span>()&lt;&lt;<span class="string">&quot; è·å¾—çš„åˆ†æ•°ï¼š&quot;</span>&lt;&lt;temp.<span class="built_in">getGrade</span>()&lt;&lt;endl;</span><br><span class="line">      flag = <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//æ²¡æ‰¾åˆ°çš„è¯ç»™å‡ºæç¤ºä¿¡æ¯</span></span><br><span class="line">  <span class="keyword">if</span> (!flag) &#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;æœªæ‰¾åˆ°è¯¥è¿åŠ¨å‘˜&quot;</span>&lt;&lt;endl;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">reviceAthlete</span><span class="params">()</span></span>&#123; <span class="comment">//ä¿®æ”¹è¿åŠ¨å‘˜ä¿¡æ¯</span></span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥è¦ä¿®æ”¹çš„è¿åŠ¨å‘˜çš„å­¦å·&quot;</span>&lt;&lt;endl;</span><br><span class="line">  string id;</span><br><span class="line">  cin&gt;&gt;id;</span><br><span class="line">  Athlete temp;</span><br><span class="line">  <span class="type">bool</span> flag =<span class="literal">false</span>;</span><br><span class="line">  <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (; i &lt; athletes.<span class="built_in">size</span>(); i++) &#123; <span class="comment">//æ‰¾åˆ° æŒ‡å®šå­¦å·çš„è¿åŠ¨å‘˜</span></span><br><span class="line">    athletes.<span class="built_in">retrieve</span>(i,temp);</span><br><span class="line">    <span class="keyword">if</span> (temp.<span class="built_in">getId</span>() == id) &#123;</span><br><span class="line">      flag = <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (!flag) &#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;æœªæ‰¾åˆ°è¯¥è¿åŠ¨å‘˜&quot;</span>&lt;&lt;endl;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;è¯·é€‰æ‹©è¦ä¿®æ”¹è¿åŠ¨å‘˜çš„é‚£äº›ä¿¡æ¯&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;------ä¿®æ”¹è¿åŠ¨å‘˜çš„å§“å----1&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;------ä¿®æ”¹è¿åŠ¨å‘˜çš„å­¦å·----2&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;------ä¿®æ”¹è¿åŠ¨å‘˜çš„æ€§åˆ«----3&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;------ä¿®æ”¹è¿åŠ¨å‘˜å­¦é™¢----4&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;------ä¿®æ”¹è¿åŠ¨å‘˜å‚èµ›é¡¹ç›®ç¼–å·----5&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;è¿åŠ¨å‘˜çš„æ£€å½•ï¼Œæˆç»©æ’åï¼Œåˆ†æ•°ï¼Œä¸äºˆä¿®æ”¹ï¼Œè¯·ä½¿ç”¨ä¸Šä¸€æ­¥çš„å‡½æ•°æ“ä½œ&quot;</span>&lt;&lt;endl;</span><br><span class="line">    cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥å¯¹åº”ä¿¡æ¯çš„ç¼–å·&quot;</span>&lt;&lt;endl;</span><br><span class="line">    <span class="type">int</span> a;</span><br><span class="line">    cin&gt;&gt;a;</span><br><span class="line">    <span class="keyword">switch</span>(a)&#123; <span class="comment">//è¿åŠ¨å‘˜çš„æ£€å½•ï¼Œæˆç»©æ’åï¼Œåˆ†æ•°ï¼Œä¸äºˆä¿®æ”¹</span></span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥æ–°çš„è¿åŠ¨å‘˜çš„å§“å:&quot;</span>&lt;&lt;endl;</span><br><span class="line">        string name;</span><br><span class="line">        cin&gt;&gt;name;</span><br><span class="line">        temp.<span class="built_in">setName</span>(name); <span class="comment">//è¾“å…¥æ–°ä¿¡æ¯</span></span><br><span class="line">        athletes.<span class="built_in">replace</span>(i,temp);<span class="comment">//è¿›è¡Œæ›¿æ¢</span></span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¿åŠ¨å‘˜çš„å§“åä¿®æ”¹æˆåŠŸ!&quot;</span>&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;è¯·è¾“å…¥æ–°çš„è¿åŠ¨å‘˜çš„å­¦å·:&quot;</span> &lt;&lt; endl;</span><br><span class="line">        string number;</span><br><span class="line">        cin&gt;&gt;number;</span><br><span class="line">        temp.<span class="built_in">setId</span>(number);</span><br><span class="line">        athletes.<span class="built_in">replace</span>(i,temp);</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;è¿åŠ¨å‘˜çš„å­¦å·ä¿®æ”¹æˆåŠŸ!&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥æ–°çš„è¿åŠ¨å‘˜çš„æ€§åˆ«:&quot;</span>&lt;&lt;endl;</span><br><span class="line">        string sex;</span><br><span class="line">        cin&gt;&gt;sex;</span><br><span class="line">        temp.<span class="built_in">setSex</span>(sex);</span><br><span class="line">        athletes.<span class="built_in">replace</span>(i,temp);</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¿åŠ¨å‘˜çš„æ€§åˆ«ä¿®æ”¹æˆåŠŸ!&quot;</span>&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4</span>:&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥æ–°çš„å­¦é™¢:&quot;</span>&lt;&lt;endl;</span><br><span class="line">        string college;</span><br><span class="line">        cin&gt;&gt;college;</span><br><span class="line">        temp.<span class="built_in">setCollege</span>(college);</span><br><span class="line">        athletes.<span class="built_in">replace</span>(i,temp);</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¿åŠ¨å‘˜çš„å­¦é™¢æ”¹æˆåŠŸ!&quot;</span>&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">5</span>:&#123;</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¯·è¾“å…¥æ–°çš„è¿åŠ¨å‘˜å‚èµ›ç¼–å·:&quot;</span>&lt;&lt;endl;</span><br><span class="line">        string matchId;</span><br><span class="line">        cin&gt;&gt;matchId;</span><br><span class="line">        temp.<span class="built_in">setMatchId</span>(matchId);</span><br><span class="line">        athletes.<span class="built_in">replace</span>(i,temp);</span><br><span class="line">        cout&lt;&lt;<span class="string">&quot;è¿åŠ¨å‘˜å‚èµ›ç¼–å·ä¿®æ”¹æˆåŠŸ!&quot;</span>&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">default</span>: cout&lt;&lt;<span class="string">&quot;è¾“å…¥æœ‰è¯¯&quot;</span>&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">College</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="built_in">College</span>() &#123; <span class="comment">//æ— å‚æ„é€ </span></span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  College <span class="keyword">operator</span>=(<span class="type">const</span> College&amp; college) &#123; <span class="comment">//èµ‹å€¼è¿ç®—ç¬¦é‡è½½</span></span><br><span class="line">    name = college.name;</span><br><span class="line">    athletess = college.athletess;</span><br><span class="line">    manScore = college.manScore;</span><br><span class="line">    womenScore = college.womenScore;</span><br><span class="line">    score = college.score;</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">College</span>(College <span class="type">const</span> &amp;college) &#123; <span class="comment">// æ‹·è´æ„é€ </span></span><br><span class="line">    name = college.name;</span><br><span class="line">    athletess = college.athletess;</span><br><span class="line">    manScore = college.manScore;</span><br><span class="line">    womenScore = college.womenScore;</span><br><span class="line">    score = college.score;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  string name;<span class="comment">//å­¦é™¢åç§°</span></span><br><span class="line">  vector&lt;Athlete&gt; athletess;<span class="comment">//æ•°ç»„vector è¿åŠ¨å‘˜</span></span><br><span class="line">  <span class="type">int</span> manScore;<span class="comment">//ç”·å­å¾—åˆ†</span></span><br><span class="line">  <span class="type">int</span> womenScore;<span class="comment">//å¥³å­å¾—åˆ†</span></span><br><span class="line">  <span class="type">int</span> score;<span class="comment">//æ··åˆå¾—åˆ†</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">  <span class="type">bool</span> flag;<span class="comment">//æ ‡å¿—ä½ è¿™ä¸ªå­¦é™¢æœ‰æ²¡æœ‰æ’è¿‡åº</span></span><br><span class="line">  <span class="built_in">College</span>(string name) &#123; <span class="comment">// é‡å†™çš„æ„é€ å‡½æ•°</span></span><br><span class="line">    flag = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">this</span>-&gt;name = name;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="type">void</span> <span class="title">setScore</span><span class="params">()</span> </span>&#123; <span class="comment">//è®¾ç½®æˆç»©</span></span><br><span class="line">    <span class="keyword">this</span>-&gt;score = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">this</span>-&gt;manScore = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">this</span>-&gt;womenScore = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(Athlete temp:athletess)&#123; <span class="comment">//éå†è¿åŠ¨å‘˜è¡¨</span></span><br><span class="line">      <span class="keyword">if</span> (temp.<span class="built_in">getSex</span>() == <span class="string">&quot;ç”·&quot;</span>) &#123; <span class="comment">//å¦‚æœæ˜¯ç”·åŒå­¦ å°±åŠ manScore  score</span></span><br><span class="line">        <span class="keyword">this</span>-&gt;manScore += temp.<span class="built_in">getGrade</span>();</span><br><span class="line">        <span class="keyword">this</span>-&gt;score += temp.<span class="built_in">getGrade</span>();</span><br><span class="line">      &#125;<span class="keyword">else</span>&#123; <span class="comment">//å¦‚æœæ˜¯å¥³åŒå­¦ å°±åŠ womenScore  score</span></span><br><span class="line">        <span class="keyword">this</span>-&gt;womenScore += temp.<span class="built_in">getGrade</span>();</span><br><span class="line">        <span class="keyword">this</span>-&gt;score += temp.<span class="built_in">getGrade</span>();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//åˆ©ç”¨STLçš„vectoræ¥å­˜å‚¨å­¦é™¢ æ˜“æ“ä½œ</span></span><br><span class="line">vector&lt;College&gt; colleges ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">creatColleges</span><span class="params">(List2&lt;Athlete&gt; a)</span> </span>&#123;<span class="comment">//åˆ›å»ºå­¦é™¢</span></span><br><span class="line">  Athlete temp;</span><br><span class="line">  <span class="type">bool</span> flag;<span class="comment">//æ ‡å¿—1ï¼šæœ‰æ²¡æœ‰è¿åŠ¨å‘˜å¯¹åº”çš„å­¦é™¢</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; a.<span class="built_in">size</span>(); i++) &#123;<span class="comment">//éå†è¿åŠ¨å‘˜è¡¨</span></span><br><span class="line">    flag = <span class="literal">false</span>;</span><br><span class="line">    a.<span class="built_in">retrieve</span>(i,temp);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> &amp; college : colleges) &#123; <span class="comment">//éå†å­¦é™¢æ•°ç»„</span></span><br><span class="line">      <span class="keyword">if</span> (college.name == temp.<span class="built_in">getCollege</span>()) &#123; <span class="comment">//å¦‚æœæœ‰å’Œè¿åŠ¨å‘˜åŒåçš„å­¦é™¢</span></span><br><span class="line">        <span class="type">bool</span> flag2 = <span class="literal">false</span>;<span class="comment">//æ ‡å¿—ä½2ï¼šè®°å½•è¿åŠ¨å‘˜æ˜¯å¦è®°å½•è¿‡</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp; player : college.athletess) &#123;</span><br><span class="line">          <span class="keyword">if</span> (temp.<span class="built_in">getId</span>()==player.<span class="built_in">getId</span>()) flag2 = <span class="literal">true</span>;<span class="comment">//è®°å½•è¿‡ æ ‡å¿—ä½ä¸ºtrue</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (flag2) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">else</span>&#123; <span class="comment">//è¿åŠ¨å‘˜è¿˜æ²¡åŠ åœ¨å­¦é™¢çš„åŠ¨æ€æ•°ç»„é‡Œé¢</span></span><br><span class="line">          flag = <span class="literal">true</span>;</span><br><span class="line">          college.athletess.<span class="built_in">push_back</span>(temp);<span class="comment">//æŠŠè¿åŠ¨å‘˜åŠ åœ¨å­¦é™¢çš„åŠ¨æ€æ•°ç»„é‡Œé¢</span></span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!flag) &#123; <span class="comment">//æ²¡æœ‰å­¦é™¢</span></span><br><span class="line">      flag = <span class="literal">true</span>;</span><br><span class="line">      <span class="function">College <span class="title">collegeTemp</span><span class="params">(<span class="string">&quot;&quot;</span>+temp.getCollege())</span></span>;<span class="comment">//åˆ›å»ºå­¦é™¢</span></span><br><span class="line">      collegeTemp.athletess.<span class="built_in">push_back</span>(temp);<span class="comment">//æŠŠè¿åŠ¨å‘˜åŠ åœ¨å­¦é™¢é‡Œçš„è¿åŠ¨å‘˜ä¸­</span></span><br><span class="line">      colleges.<span class="built_in">push_back</span>(collegeTemp);<span class="comment">//å†æŠŠè¿åŠ¨å‘˜æ”¾å…¥æ•°ç»„ä¸­</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setCollegesScore</span><span class="params">(vector&lt;College&gt; &amp;colleges)</span></span>&#123; <span class="comment">//è®¾ç½®å­¦é™¢çš„æˆç»©</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> &amp; college : colleges) &#123; <span class="comment">//éå†å­¦é™¢vectoræ•°ç»„ é€šè¿‡setScoreè®¾ç½®æˆç»©</span></span><br><span class="line">    college.<span class="built_in">setScore</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sortScore</span><span class="params">(vector&lt;College&gt; colleges)</span></span>&#123; <span class="comment">//æ€»æˆç»©æ’åº</span></span><br><span class="line">  <span class="type">int</span> max = <span class="number">0</span>;</span><br><span class="line">  College temp;</span><br><span class="line">  <span class="comment">//ç¡®å®šæ’åºçš„è½®æ•° å¦‚æœä¸å¤Ÿ6ä¸ªå­¦é™¢çš„è¯å°±å…¨æ’ 6ä¸ªä»¥ä¸Šåªæ’å‰6ä¸ª</span></span><br><span class="line">  <span class="type">int</span> loop = <span class="number">6</span> &lt; colleges.<span class="built_in">size</span>()? <span class="number">6</span> : colleges.<span class="built_in">size</span>();</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> &amp; college : colleges)&#123;<span class="comment">//é˜²æ­¢ä¹‹å‰è¿›è¡Œè¿‡æ’åº å› æ­¤å¯¹æ‰€æœ‰çš„å­¦é™¢éƒ½è®¾ç½®ä¸ºfalse</span></span><br><span class="line">    college.flag = <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; loop; ++i) &#123;<span class="comment">//loopæ¬¡æœ€å¤§å€¼</span></span><br><span class="line">    max = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;college: colleges) &#123;</span><br><span class="line">      <span class="keyword">if</span> (college.score &gt; max &amp;&amp; !college.flag) &#123;</span><br><span class="line">        <span class="comment">//æ¯ä¸€éå¾ªç¯é‡Œè¾¹æ‰¾åˆ°æœ€å¤§çš„ å¹¶æŠŠæ ‡å¿—ä½ç½®ä½true æ„æ€æ˜¯å·²ç»æ’è¿‡åºäº†</span></span><br><span class="line">        college.flag = <span class="literal">true</span>;</span><br><span class="line">        max = college.score;</span><br><span class="line">        temp = college;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;æ··åˆåˆ†æ•°ç¬¬&quot;</span>&lt;&lt;i + <span class="number">1</span>&lt;&lt;<span class="string">&quot;çš„æ˜¯:&quot;</span> &lt;&lt; temp.name &lt;&lt; <span class="string">&quot;  &quot;</span> &lt;&lt; temp.score &lt;&lt; endl;<span class="comment">//æ˜¾ç¤º</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sortManScore</span><span class="params">(vector&lt;College&gt; colleges)</span></span>&#123; <span class="comment">//ç”·å­å›¢ä½“æ’åº</span></span><br><span class="line">  <span class="type">int</span> max = <span class="number">0</span>;</span><br><span class="line">  College temp;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> &amp; college : colleges)&#123;<span class="comment">//é˜²æ­¢ä¹‹å‰è¿›è¡Œè¿‡æ’åº å› æ­¤å¯¹æ‰€æœ‰çš„å­¦é™¢éƒ½è®¾ç½®ä¸ºfalse</span></span><br><span class="line">    college.flag = <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//ç¡®å®šæ’åºçš„è½®æ•° å¦‚æœä¸å¤Ÿ6ä¸ªå­¦é™¢çš„è¯å°±å…¨æ’ 6ä¸ªä»¥ä¸Šåªæ’å‰6ä¸ª</span></span><br><span class="line">  <span class="type">int</span> loop = <span class="number">6</span> &lt; colleges.<span class="built_in">size</span>()? <span class="number">6</span> : colleges.<span class="built_in">size</span>();</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; loop; ++i) &#123;</span><br><span class="line">    max = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> &amp; college : colleges) &#123;</span><br><span class="line">      <span class="keyword">if</span> (college.manScore &gt; max &amp;&amp; !college.flag) &#123;</span><br><span class="line">        <span class="comment">//æ¯ä¸€éå¾ªç¯é‡Œè¾¹æ‰¾åˆ°æœ€å¤§çš„ å¹¶æŠŠæ ‡å¿—ä½ç½®ä½true æ„æ€æ˜¯å·²ç»æ’è¿‡åºäº†</span></span><br><span class="line">        college.flag = <span class="literal">true</span>;</span><br><span class="line">        max = college.score;</span><br><span class="line">        temp = college;</span><br><span class="line">        cout&lt;&lt;temp.name;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;ç”·å­å›¢ä½“åˆ†æ•°ç¬¬&quot;</span>&lt;&lt;i + <span class="number">1</span>&lt;&lt;<span class="string">&quot;çš„æ˜¯:&quot;</span> &lt;&lt; temp.name &lt;&lt; <span class="string">&quot;  &quot;</span> &lt;&lt; temp.manScore &lt;&lt; endl;<span class="comment">//æ˜¾ç¤º</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sortWomenScore</span><span class="params">(vector&lt;College&gt; colleges)</span></span>&#123;<span class="comment">//é˜²æ­¢ä¹‹å‰è¿›è¡Œè¿‡æ’åº å› æ­¤å¯¹æ‰€æœ‰çš„å­¦é™¢éƒ½è®¾ç½®ä¸ºfalse</span></span><br><span class="line">  <span class="type">int</span> max = <span class="number">0</span>;</span><br><span class="line">  College temp;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">auto</span> &amp; college : colleges)&#123;</span><br><span class="line">    college.flag = <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//ç¡®å®šæ’åºçš„è½®æ•° å¦‚æœä¸å¤Ÿ6ä¸ªå­¦é™¢çš„è¯å°±å…¨æ’ 6ä¸ªä»¥ä¸Šåªæ’å‰6ä¸ª</span></span><br><span class="line">  <span class="type">int</span> loop = <span class="number">6</span> &lt; colleges.<span class="built_in">size</span>()? <span class="number">6</span> : colleges.<span class="built_in">size</span>();</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; loop; ++i) &#123;</span><br><span class="line">    max = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> &amp; college : colleges) &#123;</span><br><span class="line">      <span class="comment">//æ¯ä¸€éå¾ªç¯é‡Œè¾¹æ‰¾åˆ°æœ€å¤§çš„ å¹¶æŠŠæ ‡å¿—ä½ç½®ä½true æ„æ€æ˜¯å·²ç»æ’è¿‡åºäº†</span></span><br><span class="line">      <span class="keyword">if</span> (college.womenScore &gt; max &amp;&amp; !college.flag) &#123;</span><br><span class="line">        college.flag = <span class="literal">true</span>;</span><br><span class="line">        max = college.score;</span><br><span class="line">        temp = college;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;å¥³å­å›¢ä½“åˆ†æ•°ç¬¬&quot;</span>&lt;&lt;i + <span class="number">1</span>&lt;&lt;<span class="string">&quot;çš„æ˜¯:&quot;</span> &lt;&lt; temp.name &lt;&lt; <span class="string">&quot;  &quot;</span> &lt;&lt; temp.womenScore &lt;&lt; endl;<span class="comment">//æ˜¾ç¤º</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">menu1</span><span class="params">()</span><span class="comment">//è¿åŠ¨ä¼šé¡¹ç›®ç®¡ç†èœå•</span></span></span><br><span class="line"><span class="function"></span>&#123;  cout&lt;&lt;<span class="string">&quot;******************************&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;******å­¦æ ¡è¿åŠ¨ä¼šç®¡ç†ç³»ç»Ÿ******&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout &lt;&lt;<span class="string">&quot;------è¿åŠ¨ä¼šé¡¹ç›®ç®¡ç†--------&quot;</span> &lt;&lt; endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;----åˆ›å»ºé¡¹ç›®    è¯·æŒ‰:1----&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;----æ•°æ®ä¿®æ”¹    è¯·æŒ‰:2----&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;----æ•°æ®åˆ é™¤    è¯·æŒ‰:3----&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;----æ•°æ®æŸ¥è¯¢    è¯·æŒ‰:4----&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;----è¿”å›ä¸»èœå•    è¯·æŒ‰:0----&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;*******************************&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;*****è¯·è¾“å…¥ä¸€ä¸ªæ•°æ®è¿›è¡Œé€‰æ‹©!*****&quot;</span>&lt;&lt;endl;</span><br><span class="line">  <span class="type">int</span> num;</span><br><span class="line">  cin&gt;&gt;num;</span><br><span class="line">  <span class="keyword">switch</span> (num) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:&#123;</span><br><span class="line">      <span class="built_in">setMatch</span>();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:&#123;</span><br><span class="line">      <span class="built_in">changeMatch</span>();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:&#123;</span><br><span class="line">      <span class="built_in">deleteMatch</span>();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:&#123;</span><br><span class="line">      <span class="built_in">selectMatch</span>();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>:&#123;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">default</span>:cout&lt;&lt;<span class="string">&quot;è¾“å…¥æœ‰è¯¯&quot;</span>&lt;&lt;endl;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">menu2</span><span class="params">()</span><span class="comment">//è¿åŠ¨å‘˜ç®¡ç†èœå•</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;******************************&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;******å­¦æ ¡è¿åŠ¨ä¼šç®¡ç†ç³»ç»Ÿ******&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout &lt;&lt;<span class="string">&quot;------è¿åŠ¨ä¼šè¿åŠ¨å‘˜ç®¡ç†--------&quot;</span> &lt;&lt; endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;----åˆ›å»ºè¿åŠ¨å‘˜    è¯·æŒ‰:1----&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;----æ’¤é”€æŠ¥å    è¯·æŒ‰:2----&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;----èµ›äº‹æ£€å½•    è¯·æŒ‰:3----&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;----æˆç»©å½•å…¥    è¯·æŒ‰:4----&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;----ä¿¡æ¯æŸ¥è¯¢    è¯·æŒ‰:5----&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;----ä¿¡æ¯ä¿®æ”¹    è¯·æŒ‰:6----&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;----è¿”å›ä¸»èœå•    è¯·æŒ‰:0----&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;*******************************&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;*****è¯·è¾“å…¥ä¸€ä¸ªæ•°æ®ï¼Œå¹¶æŒ‰å›è½¦é”®!*****&quot;</span>&lt;&lt;endl;</span><br><span class="line">  <span class="type">int</span> num;</span><br><span class="line">  cin&gt;&gt;num;</span><br><span class="line">  <span class="keyword">switch</span> (num) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:&#123;</span><br><span class="line">      <span class="built_in">inputAthlete</span>();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:&#123;</span><br><span class="line">      <span class="built_in">deleteAthlete</span>();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:&#123;</span><br><span class="line">      <span class="built_in">cheekAthlete</span>();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:&#123;</span><br><span class="line">      <span class="built_in">loginScoreAthlete</span>();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">5</span>:&#123;</span><br><span class="line">      <span class="built_in">selectAthlete</span>();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">6</span>:&#123;</span><br><span class="line">      <span class="built_in">reviceAthlete</span>();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>: <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:cout&lt;&lt;<span class="string">&quot;è¾“å…¥æœ‰è¯¯&quot;</span>&lt;&lt;endl;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">menu3</span><span class="params">()</span> </span>&#123;<span class="comment">//å­¦é™¢ç®¡ç†èœå•</span></span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;******************************&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;******å­¦æ ¡è¿åŠ¨ä¼šç®¡ç†ç³»ç»Ÿ******&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout &lt;&lt;<span class="string">&quot;------å­¦é™¢é¡¹ç›®ç®¡ç†--------&quot;</span> &lt;&lt; endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;----æ··åˆå›¢ä½“å‰6åå­¦é™¢    è¯·æŒ‰:1----&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;----ç”·å­å›¢ä½“å‰6åå­¦é™¢    è¯·æŒ‰:2----&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;----å¥³å­å›¢ä½“å‰6åå­¦é™¢    è¯·æŒ‰:3----&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;----è¿”å›ä¸»èœå•    è¯·æŒ‰:0----&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;*******************************&quot;</span>&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;endl;</span><br><span class="line">  cout&lt;&lt;<span class="string">&quot;*****è¯·è¾“å…¥ä¸€ä¸ªæ•°æ®ï¼Œå¹¶æŒ‰å›è½¦é”®!*****&quot;</span>&lt;&lt;endl;</span><br><span class="line">  <span class="type">int</span> num;</span><br><span class="line">  cin&gt;&gt;num;</span><br><span class="line">  <span class="built_in">creatColleges</span>(athletes);</span><br><span class="line">  <span class="built_in">setCollegesScore</span>(colleges);</span><br><span class="line">  <span class="keyword">switch</span> (num) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:&#123;</span><br><span class="line">      <span class="built_in">sortScore</span>(colleges);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:&#123;</span><br><span class="line">      <span class="built_in">sortManScore</span>(colleges);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:&#123;</span><br><span class="line">      <span class="built_in">sortWomenScore</span>(colleges);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>: <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">menu</span><span class="params">()</span> </span>&#123;<span class="comment">//ä¸»èœå•</span></span><br><span class="line">  <span class="keyword">while</span>(<span class="literal">true</span>) &#123;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;******************************&quot;</span> &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;******å­¦æ ¡è¿åŠ¨ä¼šç®¡ç†ç³»ç»Ÿ******&quot;</span> &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;----è¿åŠ¨ä¼šé¡¹ç›®ç®¡ç†  è¯·æŒ‰:1----&quot;</span> &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;----è¿åŠ¨å‘˜ç®¡ç†  è¯·æŒ‰:2----&quot;</span> &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;----å­¦é™¢ç®¡ç†   è¯·æŒ‰:3----&quot;</span> &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;----é€€å‡ºç³»ç»Ÿ    è¯·æŒ‰:0----&quot;</span> &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;*******************************&quot;</span> &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;*****è¯·è¾“å…¥ä¸€ä¸ªæ•°æ®ï¼Œå¹¶æŒ‰å›è½¦é”®!*****&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="type">int</span> num;</span><br><span class="line">    cin&gt;&gt;num;</span><br><span class="line">    <span class="keyword">switch</span> (num) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:&#123;<span class="comment">//è¿åŠ¨ä¼šé¡¹ç›®èœå•</span></span><br><span class="line">        <span class="built_in">menu1</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:&#123;<span class="comment">//è¿åŠ¨å‘˜ç®¡ç†èœå•</span></span><br><span class="line">        <span class="built_in">menu2</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:&#123;<span class="comment">//å­¦é™¢ç®¡ç†èœå•</span></span><br><span class="line">        <span class="built_in">menu3</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">\<span class="meta">#<span class="keyword">endif</span> <span class="comment">//NEWDATASTRUCT_E3_H</span></span></span><br></pre></td></tr></table></figure><p>Test.cpp</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Created by huangruidong on 2022/5/9.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line">\<span class="meta">#<span class="keyword">include</span> <span class="string">&quot;queue&quot;</span></span></span><br><span class="line">\<span class="meta">#<span class="keyword">include</span> <span class="string">&quot;E3.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">//int main()&#123;</span></span><br><span class="line"><span class="comment">//   Athlete athlete(&quot;zs&quot;,&quot;2005010112&quot;,&quot;ç”·&quot;,&quot;xk&quot;,&quot;1&quot;);</span></span><br><span class="line"><span class="comment">//   athlete.setRank(1);</span></span><br><span class="line"><span class="comment">//   athletes.insert(0,athlete);</span></span><br><span class="line"><span class="comment">//   creatColleges(athletes);</span></span><br><span class="line"><span class="comment">//   setCollegesScore(colleges);</span></span><br><span class="line"><span class="comment">//   cout&lt;&lt;colleges[0].score;</span></span><br><span class="line"><span class="comment">//   sortScore(colleges);</span></span><br><span class="line"><span class="comment">//   //Athlete(const string &amp;name, const string &amp;id, const string &amp;sex, const string &amp;college, const string &amp;matchId)</span></span><br><span class="line"><span class="comment">//   //       : name(name), id(id), sex(sex), college(college), matchId(matchId) &#123;&#125;;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//int main()&#123;</span></span><br><span class="line"><span class="comment">//   Match match(&quot;100m&quot;,10001,&quot;ç”·&quot;,&quot;8-31&quot;,&quot;2:00&quot;,20);</span></span><br><span class="line"><span class="comment">//   Match match2(&quot;200m&quot;,10002,&quot;ç”·&quot;,&quot;8-31&quot;,&quot;2:00&quot;,20);</span></span><br><span class="line"><span class="comment">//   matchs.insert(0,match);</span></span><br><span class="line"><span class="comment">//   matchs.insert(1,match2);</span></span><br><span class="line"><span class="comment">//   changeMatch();</span></span><br><span class="line"><span class="comment">//   cout&lt;&lt;match.getCall()&lt;&lt;endl;</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//int main()&#123;</span></span><br><span class="line"><span class="comment">//   Athlete athlete(&quot;zs&quot;,&quot;2005010112&quot;,&quot;ç”·&quot;,&quot;xk&quot;,&quot;1&quot;);</span></span><br><span class="line"><span class="comment">//   athletes.insert(0,athlete);</span></span><br><span class="line"><span class="comment">//   reviceAthlete();</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line">\<span class="meta">#<span class="keyword">include</span> <span class="string">&quot;E3.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">  <span class="function">Match <span class="title">match1</span><span class="params">(<span class="string">&quot;100m&quot;</span>,<span class="number">100001</span>,<span class="string">&quot;ç”·&quot;</span>,<span class="string">&quot;8-31&quot;</span>,<span class="string">&quot;2:00&quot;</span>,<span class="number">20</span>)</span></span>;</span><br><span class="line">  <span class="function">Match <span class="title">match2</span><span class="params">(<span class="string">&quot;100m&quot;</span>,<span class="number">100001</span>,<span class="string">&quot;å¥³&quot;</span>,<span class="string">&quot;8-31&quot;</span>,<span class="string">&quot;2:00&quot;</span>,<span class="number">20</span>)</span></span>;</span><br><span class="line">  <span class="function">Athlete <span class="title">a</span><span class="params">(<span class="string">&quot;a&quot;</span>,<span class="string">&quot;2001&quot;</span>,<span class="string">&quot;ç”·&quot;</span>,<span class="string">&quot;ä¿¡æ§&quot;</span>,<span class="string">&quot;10001&quot;</span>)</span></span>;</span><br><span class="line">  <span class="function">Athlete <span class="title">b</span><span class="params">(<span class="string">&quot;b&quot;</span>,<span class="string">&quot;2002&quot;</span>,<span class="string">&quot;ç”·&quot;</span>,<span class="string">&quot;ææ–™&quot;</span>,<span class="string">&quot;10001&quot;</span>)</span></span>;</span><br><span class="line">  <span class="function">Athlete <span class="title">c</span><span class="params">(<span class="string">&quot;c&quot;</span>,<span class="string">&quot;2003&quot;</span>,<span class="string">&quot;ç”·&quot;</span>,<span class="string">&quot;ä¿¡æ§&quot;</span>,<span class="string">&quot;10001&quot;</span>)</span></span>;</span><br><span class="line">  <span class="function">Athlete <span class="title">d</span><span class="params">(<span class="string">&quot;d&quot;</span>,<span class="string">&quot;2004&quot;</span>,<span class="string">&quot;ç”·&quot;</span>,<span class="string">&quot;ææ–™&quot;</span>,<span class="string">&quot;10001&quot;</span>)</span></span>;</span><br><span class="line">  <span class="function">Athlete <span class="title">e</span><span class="params">(<span class="string">&quot;e&quot;</span>,<span class="string">&quot;2005&quot;</span>,<span class="string">&quot;å¥³&quot;</span>,<span class="string">&quot;ä¿¡æ§&quot;</span>,<span class="string">&quot;10001&quot;</span>)</span></span>;</span><br><span class="line">  <span class="function">Athlete <span class="title">f</span><span class="params">(<span class="string">&quot;f&quot;</span>,<span class="string">&quot;2006&quot;</span>,<span class="string">&quot;å¥³&quot;</span>,<span class="string">&quot;ææ–™&quot;</span>,<span class="string">&quot;10001&quot;</span>)</span></span>;</span><br><span class="line">  <span class="function">Athlete <span class="title">g</span><span class="params">(<span class="string">&quot;g&quot;</span>,<span class="string">&quot;2007&quot;</span>,<span class="string">&quot;å¥³&quot;</span>,<span class="string">&quot;ä¿¡æ§&quot;</span>,<span class="string">&quot;10001&quot;</span>)</span></span>;</span><br><span class="line">  <span class="function">Athlete <span class="title">h</span><span class="params">(<span class="string">&quot;h&quot;</span>,<span class="string">&quot;2008&quot;</span>,<span class="string">&quot;å¥³&quot;</span>,<span class="string">&quot;ææ–™&quot;</span>,<span class="string">&quot;10001&quot;</span>)</span></span>;</span><br><span class="line">  a.<span class="built_in">setRank</span>(<span class="number">1</span>);</span><br><span class="line">  b.<span class="built_in">setRank</span>(<span class="number">2</span>);</span><br><span class="line">  c.<span class="built_in">setRank</span>(<span class="number">3</span>);</span><br><span class="line">  d.<span class="built_in">setRank</span>(<span class="number">4</span>);</span><br><span class="line">  e.<span class="built_in">setRank</span>(<span class="number">1</span>);</span><br><span class="line">  f.<span class="built_in">setRank</span>(<span class="number">2</span>);</span><br><span class="line">  g.<span class="built_in">setRank</span>(<span class="number">3</span>);</span><br><span class="line">  h.<span class="built_in">setRank</span>(<span class="number">4</span>);</span><br><span class="line">  athletes.<span class="built_in">insert</span>(<span class="number">0</span>,a);</span><br><span class="line">  athletes.<span class="built_in">insert</span>(<span class="number">1</span>,b);</span><br><span class="line">  athletes.<span class="built_in">insert</span>(<span class="number">2</span>,c);</span><br><span class="line">  athletes.<span class="built_in">insert</span>(<span class="number">3</span>,d);</span><br><span class="line">  athletes.<span class="built_in">insert</span>(<span class="number">4</span>,e);</span><br><span class="line">  athletes.<span class="built_in">insert</span>(<span class="number">5</span>,f);</span><br><span class="line">  athletes.<span class="built_in">insert</span>(<span class="number">6</span>,g);</span><br><span class="line">  athletes.<span class="built_in">insert</span>(<span class="number">7</span>,h);</span><br><span class="line">  <span class="built_in">creatColleges</span>(athletes);</span><br><span class="line">  <span class="built_in">setCollegesScore</span>(colleges);</span><br><span class="line">  <span class="built_in">sortScore</span>(colleges);</span><br><span class="line">  <span class="built_in">sortManScore</span>(colleges);</span><br><span class="line">  <span class="built_in">sortWomenScore</span>(colleges);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">Main.cpp</span><br><span class="line"></span><br><span class="line">\<span class="meta">#<span class="keyword">include</span> <span class="string">&quot;queue&quot;</span></span></span><br><span class="line">\<span class="meta">#<span class="keyword">include</span> <span class="string">&quot;E3.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">menu</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å…­ï¼å®éªŒæ•°æ®ã€ç»“æœåˆ†æ"><a href="#å…­ï¼å®éªŒæ•°æ®ã€ç»“æœåˆ†æ" class="headerlink" title="å…­ï¼å®éªŒæ•°æ®ã€ç»“æœåˆ†æ"></a>å…­ï¼å®éªŒæ•°æ®ã€ç»“æœåˆ†æ</h3><ol><li>åŸºäºå•é“¾è¡¨å®ç°çº¿æ€§è¡¨ List1</li></ol><p>Main.cppæµ‹è¯•ç»“æœï¼š</p><p><img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps22.jpg" alt="img"> </p><p>ç»“æœåˆ†æï¼šå®éªŒæŒ‰ä»»åŠ¡ä¹¦çš„è¦æ±‚å®Œæˆï¼Œæµ‹è¯•åŠŸèƒ½æ­£ç¡®æ— è¯¯ï¼Œæ—¶é—´å¤æ‚åº¦çš„ä¼°è®¡åœ¨è®¾è®¡æ—¶å·²ç»ç»™å‡ºï¼Œå®éªŒç»“æœç¨³å®šã€‚</p><ol start="2"><li>åŸºäºé™æ€é“¾è¡¨å®ç°çº¿æ€§è¡¨ List2 çš„å…¸å‹æ“ä½œ</li></ol><p>Main.cppæµ‹è¯•ç»“æœï¼š</p><p><img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps23.jpg" alt="img"> </p><p>ç»“æœåˆ†æï¼šå®éªŒæŒ‰ä»»åŠ¡ä¹¦çš„è¦æ±‚å®Œæˆï¼Œæµ‹è¯•åŠŸèƒ½æ­£ç¡®æ— è¯¯ï¼Œæ—¶é—´å¤æ‚åº¦çš„ä¼°è®¡åœ¨è®¾è®¡æ—¶å·²ç»ç»™å‡ºï¼Œå®éªŒç»“æœç¨³å®šã€‚</p><ol start="3"><li>å®éªŒ3. åŸºäºçº¿æ€§è¡¨ List1ã€çº¿æ€§è¡¨ List2 å®ç°çº¿æ€§è¡¨çš„åº”ç”¨ï¼šè¿åŠ¨ä¼šä¿¡æ¯ç®¡ç†</li></ol><p>å…·ä½“çš„æµ‹è¯•åœ¨é—®é¢˜çš„åˆ†è§£ä¸­å·²ç»æµ‹è¯•è¿‡äº†ã€‚</p><p>é€šè¿‡æ–‡ä»¶æµçš„æ¥æŠŠä¿¡æ¯ä¿å­˜åœ¨ç£ç›˜ä¸­ï¼š</p><p><img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps24.jpg" alt="img"> </p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä½†æ˜¯å­˜åœ¨ä¸€äº›é—®é¢˜ï¼š</p><p>å­—ç¬¦ç¼–ç åŠ è½½é”™è¯¯ï¼š</p><p>æ¯”èµ›é¡¹ç›®.dat</p><p><img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps25.jpg" alt="img"> </p><p>è¿åŠ¨å‘˜.dat</p><p><img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps26.jpg" alt="img"> </p><p>è®¤ä¸ºæ˜¯å­—ç¬¦ç¼–ç é—®é¢˜å¯¼è‡´</p><p><img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps27.jpg" alt="img"> </p><p>å°è¯•æ‰€æœ‰ç¼–ç ï¼Œæ²¡æœ‰è§£å†³é—®é¢˜ã€‚å¯èƒ½æ˜¯clioné…ç½®çš„å­—ç¬¦ä¸ºutf-8ä»£æ›¿GBKå¯¼è‡´çš„è¾“å‡ºçš„æ–‡ä»¶ç¼–ç é—®é¢˜ã€‚</p><p>Clionè®¾ç½®å¦‚ä¸‹ï¼š</p><p><img src="/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E9%AA%8C/wps28.jpg" alt="img"> </p><h3 id="ä¸ƒï¼å­˜åœ¨çš„é—®é¢˜ä¸ä½“ä¼š"><a href="#ä¸ƒï¼å­˜åœ¨çš„é—®é¢˜ä¸ä½“ä¼š" class="headerlink" title="ä¸ƒï¼å­˜åœ¨çš„é—®é¢˜ä¸ä½“ä¼š"></a>ä¸ƒï¼å­˜åœ¨çš„é—®é¢˜ä¸ä½“ä¼š</h3><ol><li><p>åœ¨æ•°æ®ç»“æ„çš„è®¾è®¡ä¸­ï¼Œæ¨¡æ¿çš„ä½¿ç”¨å’Œåˆ›å»ºå°¤ä¸ºé‡è¦ï¼Œè€Œä¸”è¾ƒéš¾æŒæ¡ï¼Œåœ¨ç¼–å†™åç»­æ“ä½œä¸­ï¼Œéœ€è¦ä¸æ–­åœ°å¯¹æ¨¡æ¿è¿›è¡Œè°ƒæ•´ã€‚</p></li><li><p>è®¾è®¡å®ç°æ•°æ®ç»“æ„ï¼Œé¦–å…ˆæ¸…é™¤è¿™ç§æ•°æ®ç»“æ„çš„ç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼Œäº†è§£è¦ç”¨ä»€ä¹ˆçš„æ–¹å¼æ¥å®ç°è¿™ç§æ•°æ®ç»“æ„ã€‚</p></li><li><p>è¿‡ç¨‹ä¸­å‡ºç°äº†å¥½å¤šçš„ç»†èŠ‚é”™è¯¯ï¼Œå¯¼è‡´è¿›åº¦ç¼“æ…¢ï¼Œä½¿ç”¨äº†å¤§é‡æ—¶é—´è°ƒè¯•ï¼Œä¾‹å¦‚ï¼šèµ‹å€¼è¿ç®—</p></li></ol><p>ç¬¦é‡è½½ï¼Œæ·±æµ…æ‹·è´æ„é€ çš„é—®é¢˜ï¼Œå‡½æ•°ä¼ å‚æ—¶ä¼ çš„å½¢å‚ï¼Œè€Œä¸èƒ½æ”¹å˜å®ä½“ç­‰ç­‰ã€‚</p><ol start="4"><li>è¯¥å®éªŒä½¿ç”¨çš„ç¯å¢ƒæ˜¯Clioné…ç½®çš„MinGW,å¯¹å®éªŒä¸­é‡åˆ°çš„å„ç§é—®ä¸æ–­åœ°ä¿®æ­£è°ƒè¯•ï¼ŒåŠ å¼ºäº†å¯¹è¿™æ¬¾ç¼–è¯‘å™¨çš„ç†Ÿç»ƒåº¦ã€‚</li><li>å®éªŒä¸­å­˜åœ¨çš„é—®é¢˜æ˜¯ï¼ŒæŠŠæ•°æ®å†™å…¥åˆ°æ–‡ä»¶ä¸­å­—ç¬¦ç¼–ç å¼‚å¸¸ï¼Œå°è¯•ä¿®æ”¹ï¼ŒæœªæˆåŠŸï¼Œåº”è¯¥æ˜¯clionçš„é…ç½®å­˜åœ¨é—®é¢˜ã€‚</li><li>æŒæ¡äº†é€šè¿‡å•é“¾è¡¨å’Œé™æ€é“¾è¡¨æ¥å®ç°çº¿æ€§è¡¨ï¼Œå¯¹å•é“¾è¡¨å’Œé™æ€é“¾è¡¨æ›´åŠ ç†Ÿæ‚‰ï¼Œåœ¨å®éªŒä¸‰ä¸­åˆé”»ç‚¼äº†çº¿æ€§è¡¨çš„ä½¿ç”¨ã€‚</li><li>ç†è§£äº†å¥½å¤šç¼–ç¨‹è¿‡ç¨‹çš„å°ç»†èŠ‚ï¼Œconst,å¸¸å¼•ç”¨ï¼Œå¼•ç”¨ï¼ŒæŒ‡é’ˆï¼Œdeleteç­‰è®¸å¤šç»†èŠ‚ã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
            <tag> å®éªŒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mysql</title>
      <link href="/2022/11/20/MySQL/"/>
      <url>/2022/11/20/MySQL/</url>
      
        <content type="html"><![CDATA[<h1 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h1><hr><h2 id="1-åˆè¯†MySQL"><a href="#1-åˆè¯†MySQL" class="headerlink" title="1. åˆè¯†MySQL"></a>1. åˆè¯†MySQL</h2><h3 id="1-1-ä¸ºä»€ä¹ˆå­¦ä¹ æ•°æ®åº“"><a href="#1-1-ä¸ºä»€ä¹ˆå­¦ä¹ æ•°æ®åº“" class="headerlink" title="1.1 ä¸ºä»€ä¹ˆå­¦ä¹ æ•°æ®åº“"></a>1.1 ä¸ºä»€ä¹ˆå­¦ä¹ æ•°æ®åº“</h3><ol><li>å²—ä½éœ€æ±‚</li><li>å¤§æ•°æ®æ—¶ä»£è¶‹åŠ¿</li><li>è¢«è¿«éœ€æ±‚ï¼šå­˜æ•°æ®</li><li>æ•°æ®åº“æ˜¯æ‰€æœ‰è½¯ä»¶ä½“ç³»ä¸­æœ€æ ¸å¿ƒçš„å­˜åœ¨ DBA</li></ol><h3 id="1-2-ä»€ä¹ˆæ˜¯æ•°æ®åº“"><a href="#1-2-ä»€ä¹ˆæ˜¯æ•°æ®åº“" class="headerlink" title="1.2  ä»€ä¹ˆæ˜¯æ•°æ®åº“"></a>1.2  ä»€ä¹ˆæ˜¯æ•°æ®åº“</h3><p>æ•°æ®åº“(DB,DataBase)</p><p>æ¦‚å¿µï¼šæ•°æ®ä»“åº“ï¼Œè½¯ä»¶ï¼Œå®‰è£…åœ¨æ“ä½œç³»ç»Ÿ</p><p>ä½œç”¨ï¼šå­˜å‚¨æ•°æ®ï¼Œç®¡ç†æ•°æ®</p><h3 id="1-3-æ•°æ®åº“åˆ†ç±»"><a href="#1-3-æ•°æ®åº“åˆ†ç±»" class="headerlink" title="1.3  æ•°æ®åº“åˆ†ç±»"></a>1.3  æ•°æ®åº“åˆ†ç±»</h3><p><strong>å…³ç³»å‹æ•°æ®åº“ï¼š(SQL)</strong></p><ul><li>MySQLã€Oracleã€Sql Serverã€DB2ã€SQLlite</li><li>é€šè¿‡è¡¨å’Œè¡¨ä¹‹é—´ï¼Œè¡Œå’Œåˆ—ä¹‹é—´çš„å…³ç³»è¿›è¡Œæ•°æ®çš„å­˜å‚¨ï¼Œå­¦å‘˜ä¿¡æ¯è¡¨ï¼Œè€ƒå‹¤è¡¨ï¼Œâ€¦.</li></ul><p><strong>éå…³ç³»å‹æ•°æ®åº“: (NoSQL)   Not  Only</strong></p><ul><li>Redisã€MongDB</li><li>éå…³ç³»å‹æ•°æ®åº“ï¼Œå¯¹è±¡å‚¨å­˜ï¼Œé€šè¿‡å¯¹è±¡çš„è‡ªèº«å±æ€§æ¥å†³å®šã€‚</li></ul><p><strong>DBMS(æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ)</strong></p><p>æ•°æ®åº“ç®¡ç†è½¯ä»¶ï¼Œç§‘å­¦æœ‰æ•ˆçš„ç®¡ç†æˆ‘ä»¬çš„æ•°æ®ï¼Œç»´æŠ¤å’Œè·å–æ•°æ®ï¼›</p><p>MySQLï¼Œæ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼</p><h3 id="1-4-è¿æ¥æ•°æ®åº“"><a href="#1-4-è¿æ¥æ•°æ®åº“" class="headerlink" title="1.4  è¿æ¥æ•°æ®åº“"></a>1.4  è¿æ¥æ•°æ®åº“</h3><p>å‘½ä»¤è¡Œè¿æ¥ï¼</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">MySQL <span class="operator">-</span>uroot <span class="operator">-</span>pxduniversity20 #è¿æ¥æ•°æ®åº“</span><br><span class="line"><span class="keyword">update</span> mysql.user <span class="keyword">set</span> authentication_string<span class="operator">=</span>password(<span class="string">&#x27;123456&#x27;</span>)<span class="keyword">where</span> <span class="keyword">user</span> <span class="operator">=</span><span class="string">&#x27;root&#x27;</span> <span class="keyword">and</span> Host <span class="operator">=</span> <span class="string">&#x27;localhost&#x27;</span>;#ä¿®æ”¹ç”¨æˆ·å¯†ç </span><br><span class="line">flush privileges;#åˆ·æ–°æƒé™</span><br><span class="line"><span class="comment">-----------------------------------------------</span></span><br><span class="line">#æ‰€æœ‰è¯­å¥éƒ½ä½¿ç”¨;ç»“å°¾</span><br><span class="line"><span class="keyword">show</span> databases;</span><br><span class="line">MySQL<span class="operator">&gt;</span> use school#åˆ‡æ¢æ•°æ®åº“ä¸­æ‰€æœ‰çš„è¡¨</span><br><span class="line">Database changed</span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> tables;#æŸ¥çœ‹æ•°æ®åº“ä¸­æ‰€æœ‰çš„è¡¨</span><br><span class="line"><span class="keyword">describe</span> student;#æ˜¾ç¤ºæ•°æ®åº“æ‰€æœ‰è¡¨çš„ä¿¡æ¯</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> database westos;#åˆ›å»ºä¸€ä¸ªæ•°æ®åº“</span><br><span class="line"></span><br><span class="line">exit;#é€€å‡ºè¿æ¥</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">å¤šè¡Œæ³¨é‡Š</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p><strong>æ•°æ®åº“xxè¯­è¨€</strong></p><p>DDL    å®šä¹‰</p><p>DML    æ“ä½œ</p><p>DQL    æŸ¥è¯¢</p><p>DCL    æ§åˆ¶</p><h2 id="2-æ“ä½œæ•°æ®åº“"><a href="#2-æ“ä½œæ•°æ®åº“" class="headerlink" title="2.æ“ä½œæ•°æ®åº“"></a>2.æ“ä½œæ•°æ®åº“</h2><h3 id="2-1-æ“ä½œæ•°æ®åº“ï¼ˆäº†è§£ï¼‰"><a href="#2-1-æ“ä½œæ•°æ®åº“ï¼ˆäº†è§£ï¼‰" class="headerlink" title="2.1 æ“ä½œæ•°æ®åº“ï¼ˆäº†è§£ï¼‰"></a>2.1 æ“ä½œæ•°æ®åº“ï¼ˆäº†è§£ï¼‰</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#<span class="number">1.</span>åˆ›å»ºæ•°æ®åº“</span><br><span class="line"><span class="keyword">CREATE</span> DATABASE IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> westos;</span><br><span class="line">#<span class="number">2.</span>åˆ é™¤æ•°æ®åº“</span><br><span class="line"><span class="keyword">DROP</span> DATABASE IF <span class="keyword">EXISTS</span> westos;</span><br><span class="line">#<span class="number">3.</span>ä½¿ç”¨æ•°æ®åº“</span><br><span class="line">USE `schoool`</span><br><span class="line">#<span class="number">4.</span>æŸ¥çœ‹æ•°æ®åº“</span><br><span class="line"><span class="keyword">SHOW</span> DATABASES</span><br></pre></td></tr></table></figure><p><strong>å­¦ä¹ æ€è·¯ï¼š</strong></p><ul><li>å¯¹ç…§sqlyogå¯è§†åŒ–å†å²è®°å½•æŸ¥çœ‹sql</li><li>å›ºå®šçš„è¯­æ³•æˆ–å…³é”®å­—å¿…é¡»è¦å¼ºå‹è¡Œè®°ä½</li></ul><h3 id="2-2-æ•°æ®åº“çš„åˆ—ç±»å‹"><a href="#2-2-æ•°æ®åº“çš„åˆ—ç±»å‹" class="headerlink" title="2.2 æ•°æ®åº“çš„åˆ—ç±»å‹"></a>2.2 æ•°æ®åº“çš„åˆ—ç±»å‹</h3><p><strong>æ•°å€¼</strong></p><ul><li>tinyintååˆ†å°çš„æ•°æ®1ä¸ªå­—èŠ‚</li><li>smallintè¾ƒå°çš„æ•°æ®2ä¸ªå­—èŠ‚</li><li>mediumintä¸­ç­‰å¤§å°çš„æ•°æ®3ä¸ªå­—èŠ‚</li><li><strong>intæ ‡å‡†çš„æ•´æ•°4ä¸ªå­—èŠ‚</strong></li><li>bigintè¾ƒå¤§çš„æ•°æ®8ä¸ªå­—èŠ‚</li><li>floatæµ®ç‚¹æ•°4ä¸ªå­—èŠ‚</li><li>doubleæµ®ç‚¹æ•°8ä¸ªå­—èŠ‚</li><li>decimalå­—ç¬¦ä¸²å½¢å¼çš„æµ®ç‚¹æ•°é‡‘èè®¡ç®—çš„æ—¶å€™ä¸€èˆ¬ç”¨decimal</li></ul><p>å­—ç¬¦ä¸²</p><ul><li>charå­—ç¬¦ä¸²å›ºå®šçš„å¤§å°0~255</li><li><strong>vacharå¯å˜å­—ç¬¦ä¸²0~65535å¸¸ç”¨çš„å˜é‡String</strong></li><li>tinytextå¾®å‹æ–‡æœ¬2^8 - 1 </li><li>textæ–‡æœ¬ä¸²2^16 - 1</li></ul><p>æ—¶é—´æ—¥æœŸ</p><p>java.util.Date</p><ul><li>dateYYYY-MM-DD,æ—¥æœŸæ ¼å¼</li><li>timeHH: mm: ssæ—¶é—´æ ¼å¼</li><li><strong>datetimeYYYY-MM-DDHH: mm: ssæœ€å¸¸ç”¨çš„æ—¶é—´æ ¼å¼</strong></li><li><strong>timestampæ—¶é—´æˆ³ï¼Œ1970.1.1åˆ°ç°åœ¨çš„æ¯«ç§’æ•°ï¼ä¹Ÿæ¯”è¾ƒå¸¸ç”¨</strong></li><li>yearå¹´ä»½è¡¨ç¤º</li></ul><p>null</p><ul><li>æ²¡æœ‰å€¼ï¼ŒæœªçŸ¥</li><li><strong>æ³¨æ„ï¼Œä¸è¦ä½¿ç”¨ NULLè¿›è¡Œè¿ç®—ï¼Œç»“æœä¸ºNULL</strong></li></ul><h3 id="2-3-æ•°æ®åº“çš„å­—æ®µå±æ€§ï¼ˆé‡ç‚¹ï¼‰"><a href="#2-3-æ•°æ®åº“çš„å­—æ®µå±æ€§ï¼ˆé‡ç‚¹ï¼‰" class="headerlink" title="2.3 æ•°æ®åº“çš„å­—æ®µå±æ€§ï¼ˆé‡ç‚¹ï¼‰"></a>2.3 æ•°æ®åº“çš„å­—æ®µå±æ€§ï¼ˆé‡ç‚¹ï¼‰</h3><p><strong>Unsigned:</strong></p><ul><li>æ— ç¬¦å·çš„æ•´æ•°</li><li>å£°æ˜äº†è¯¥åˆ—ä¸èƒ½å£°æ˜ä¸ºè´Ÿæ•°</li></ul><p><strong>zerofill:</strong></p><ul><li>0å¡«å……çš„</li><li>ä¸è¶³çš„ä½æ•°ï¼Œä½¿ç”¨0æ¥å¡«å……ï¼Œint(3),5â€“005</li></ul><p><strong>è‡ªå¢ï¼š</strong></p><ul><li>é€šå¸¸ç†è§£ä¸ºè‡ªå¢ï¼Œè‡ªåŠ¨åœ¨ä¸Šä¸€æ¡è®°å½•çš„åŸºç¡€ä¸Š+1ï¼ˆé»˜è®¤ï¼‰</li><li>é€šå¸¸ç”¨æ¥è®¾è®¡å”¯ä¸€çš„é€æ¸~indexï¼Œå¿…é¡»æ˜¯æ•´æ•°ç±»å‹</li><li>å¯ä»¥è‡ªå®šä¹‰è®¾è®¡ä¸»é”®è‡ªå¢çš„</li><li>éç©º NULL NOT NULL</li><li>å‡è®¾è®¾ç½®ä¸ºnot null ï¼Œå¦‚æœä¸ç»™å®ƒèµ‹å€¼ï¼Œå°±ä¼šæŠ¥é”™ï¼</li><li>Null,å¦‚æœä¸å¡«ï¼Œé»˜è®¤ä¸ºç©ºï¼</li></ul><p><strong>é»˜è®¤ï¼š</strong></p><ul><li>è®¾ç½®é»˜è®¤çš„å€¼!</li><li>sexï¼Œé»˜è®¤å€¼ä¸ºç”·ï¼Œè‹¥æœä¸æŒ‡å®šè¯¥åˆ—çš„å€¼ï¼Œåˆ™ä¼šæœ‰é»˜è®¤çš„å€¼!</li></ul><h3 id="2-4-åˆ›å»ºæ•°æ®åº“ï¼ˆé‡ç‚¹ï¼‰"><a href="#2-4-åˆ›å»ºæ•°æ®åº“ï¼ˆé‡ç‚¹ï¼‰" class="headerlink" title="2.4  åˆ›å»ºæ•°æ®åº“ï¼ˆé‡ç‚¹ï¼‰"></a>2.4  åˆ›å»ºæ•°æ®åº“ï¼ˆé‡ç‚¹ï¼‰</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ç›®æ ‡ï¼šåˆ›å»ºä¸€ä¸ªschoolæ•°æ®åº“</span></span><br><span class="line"><span class="comment">-- åˆ›å»ºå­¦ç”Ÿè¡¨ï¼ˆåˆ—ï¼Œå­—æ®µï¼‰ ä½¿ç”¨SQLåˆ›å»º</span></span><br><span class="line"><span class="comment">-- å­¦å·int ç™»é™†å¯†ç varchar(20) å§“åï¼Œæ€§åˆ«varchar(2),å‡ºç”Ÿæ—¥æœŸ(datatime),å®¶åº­ä½å€ï¼Œemail</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ³¨æ„ç‚¹ï¼Œä½¿ç”¨è‹±æ–‡(),è¡¨çš„åç§° å’Œ å­—æ®µ å°½é‡ä½¿ç”¨ ``  æ‹¬èµ·æ¥</span></span><br><span class="line"><span class="comment">-- AUTO_INCREMENT è‡ªå¢</span></span><br><span class="line"><span class="comment">-- å­—ç¬¦ä¸²ä½¿ç”¨ å•å¼•å·æ‹¬èµ·æ¥ï¼</span></span><br><span class="line"><span class="comment">-- æ‰€æœ‰çš„è¯­å¥åé¢åŠ ,(è‹±æ–‡çš„),æœ€åä¸€ä¸ªä¸ç”¨åŠ </span></span><br><span class="line"><span class="comment">-- PRIMARY KEY ä¸»é”®ï¼Œä¸€èˆ¬ä¸€ä¸ªè¡¨åªæœ‰ä¸€ä¸ªå”¯ä¸€çš„ä¸»é”®ï¼</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> `student` (</span><br><span class="line">`id` <span class="type">INT</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;å­¦å·&#x27;</span>,</span><br><span class="line">`name` <span class="type">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;åŒ¿å&#x27;</span> COMMENT <span class="string">&#x27;å§“å&#x27;</span>,</span><br><span class="line">`pwd` <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;123456&#x27;</span> COMMENT <span class="string">&#x27;å¯†ç &#x27;</span>,</span><br><span class="line">`sex` <span class="type">VARCHAR</span>(<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;ç”·&#x27;</span> COMMENT <span class="string">&#x27;æ€§åˆ«&#x27;</span>,</span><br><span class="line">`birthday` DATETIME <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å‡ºç”Ÿæ—¥æœŸ&#x27;</span>,</span><br><span class="line">`address` <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å®¶åº­ä½å€&#x27;</span>,</span><br><span class="line">`email` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é‚®ç®±&#x27;</span>,</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY(`id`)</span><br><span class="line">)ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8</span><br></pre></td></tr></table></figure><p>æ ¼å¼</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] `è¡¨å`(</span><br><span class="line">`å­—æ®µå` åˆ—ç±»å‹ [å±æ€§] [ç´¢å¼•] [æ³¨é‡Š],</span><br><span class="line">    `å­—æ®µå` åˆ—ç±»å‹ [å±æ€§] [ç´¢å¼•] [æ³¨é‡Š],</span><br><span class="line">    `å­—æ®µå` åˆ—ç±»å‹ [å±æ€§] [ç´¢å¼•] [æ³¨é‡Š],</span><br><span class="line">    `å­—æ®µå` åˆ—ç±»å‹ [å±æ€§] [ç´¢å¼•] [æ³¨é‡Š],</span><br><span class="line">    `å­—æ®µå` åˆ—ç±»å‹ [å±æ€§] [ç´¢å¼•] [æ³¨é‡Š]</span><br><span class="line">)[è¡¨ç±»å‹] [å­—ç¬¦è®¾ç½®] [æ³¨é‡Š]</span><br></pre></td></tr></table></figure><p>å¸¸ç”¨å‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SHOW CREATE DATABASE school #æŸ¥çœ‹åˆ›å»ºæ•°æ®åº“çš„è¯­å¥</span><br><span class="line">SHOW CREATE TABLE student #æŸ¥çœ‹studentæ•°æ®è¡¨çš„å®šä¹‰è¯­å¥</span><br><span class="line">DESC student #æ˜¾ç¤ºè¡¨çš„ç»“æ„</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2-5-æ•°æ®è¡¨çš„ç±»å‹"><a href="#2-5-æ•°æ®è¡¨çš„ç±»å‹" class="headerlink" title="2.5 æ•°æ®è¡¨çš„ç±»å‹"></a>2.5 æ•°æ®è¡¨çš„ç±»å‹</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#å…³äºæ•°æ®åº“å¼•æ“</span><br><span class="line">/*</span><br><span class="line">INNODBé»˜è®¤ä½¿ç”¨</span><br><span class="line">MYISAMæ—©äº›å¹´ä½¿ç”¨çš„</span><br><span class="line">*/</span><br></pre></td></tr></table></figure><table><thead><tr><th></th><th>MYISAM</th><th>INNODB</th></tr></thead><tbody><tr><td>äº‹åŠ¡æ”¯æŒ</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒ</td></tr><tr><td>æ•°æ®è¡Œé”å®š</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒ</td></tr><tr><td>å¤–é”®çº¦æŸ</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒ</td></tr><tr><td>å…¨æ–‡ç´¢å¼•</td><td>æ”¯æŒ</td><td>ä¸æ”¯æŒ</td></tr><tr><td>è¡¨ç©ºé—´å¤§å°</td><td>è¾ƒå°</td><td>è¾ƒå¤§ï¼Œçº¦ä¸º2å€</td></tr></tbody></table><p>å¸¸è§„ä½¿ç”¨æ“ä½œï¼š</p><ul><li>MYISAMèŠ‚çº¦ç©ºé—´ï¼Œé€Ÿåº¦è¾ƒå¿«</li><li>INNODB å®‰å…¨æ€§é«˜ï¼Œäº‹åŠ¡çš„å¤„ç†ï¼Œå¤šè¡¨å¤šç”¨æˆ·æ“ä½œ</li></ul><hr><p>åœ¨ç‰©ç†ç©ºé—´å­˜åœ¨çš„ä½ç½®</p><p>æ‰€æœ‰çš„æ•°æ®æ–‡ä»¶éƒ½å­˜åœ¨dataç›®å½•ä¸‹ï¼Œä¸€ä¸ªæ–‡ä»¶å¤¹å°±å¯¹åº”ä¸€ä¸ªæ•°æ®åº“æœ¬è´¨è¿˜æ˜¯æ–‡ä»¶çš„å­˜å‚¨ï¼</p><p>MySQLå¼•æ“åœ¨ç‰©ç†æ–‡ä»¶ä¸Šçš„åŒºåˆ«</p><ul><li><p>INNODBçš„æ•°æ®åº“åªæœ‰ä¸€ä¸ª*.frmæ–‡ä»¶æŒ‰ï¼Œä»¥åŠä¸Šçº§ç›®å½•ä¸‹çš„ibdata1æ–‡ä»¶</p></li><li><p>MYISAMå¯¹åº”æ–‡ä»¶</p><ul><li>*.fimè¡¨ç»“æ„çš„å®šä¹‰æ–‡ä»¶</li><li>*.MYDæ•°æ®æ–‡ä»¶(data)</li><li>*.MYI  ç´¢å¼•æ–‡ä»¶   (index)</li></ul></li></ul><h3 id="2-6-ä¿®æ”¹å’Œåˆ é™¤æ•°æ®è¡¨çš„å­—æ®µ"><a href="#2-6-ä¿®æ”¹å’Œåˆ é™¤æ•°æ®è¡¨çš„å­—æ®µ" class="headerlink" title="2.6 ä¿®æ”¹å’Œåˆ é™¤æ•°æ®è¡¨çš„å­—æ®µ"></a>2.6 ä¿®æ”¹å’Œåˆ é™¤æ•°æ®è¡¨çš„å­—æ®µ</h3><hr><p>ä¿®æ”¹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ä¿®æ”¹è¡¨åï¼šALTER TABLE æ—§è¡¨å RENAME AS æ–°è¡¨å;</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> student2 RENAME <span class="keyword">AS</span> student;</span><br><span class="line"><span class="comment">-- å¢åŠ è¡¨çš„å­—æ®µï¼š ALTER TABLE è¡¨å ADD å­—æ®µå åˆ—å±æ€§</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> student <span class="keyword">ADD</span> age <span class="type">INT</span>(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä¿®æ”¹è¡¨çš„å­—æ®µï¼ˆé‡å‘½åï¼Œçº¦æŸæ¡ä»¶ï¼‰</span></span><br><span class="line"><span class="comment">-- ALTER TABLE è¡¨å MODIFY å­—æ®µå åˆ—å±æ€§[]</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> student MODIFY age <span class="type">VARCHAR</span>(<span class="number">11</span>);<span class="comment">-- ä¿®æ”¹çº¦æŸ</span></span><br><span class="line"><span class="comment">-- ALTER TABLE è¡¨å CHANGE æ—§å­—æ®µå æ–°å­—æ®µå INT(1);</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> student CHANGE age age1 <span class="type">INT</span>(<span class="number">1</span>);<span class="comment">-- å­—æ®µé‡å‘½å</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ é™¤è¡¨çš„å­—æ®µï¼š ALTER TABLE è¡¨å DROP å­—æ®µå</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> student <span class="keyword">DROP</span> age1;</span><br></pre></td></tr></table></figure><hr><p>åˆ é™¤</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- åˆ é™¤è¡¨(å¦‚æœè¡¨å­˜åœ¨çš„è¯)DROP TABLE IF EXISTS è¡¨å</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> student;</span><br></pre></td></tr></table></figure><p><strong>æ‰€æœ‰çš„åˆ›å»ºå’Œåˆ é™¤æ“ä½œå°½é‡åŠ ä¸Šåˆ¤æ–­ï¼Œä»¥å…æŠ¥é”™</strong></p><p>æ³¨æ„ç‚¹ï¼š</p><ul><li>&#96;&#96;å­—æ®µåï¼Œä½¿ç”¨è¿™ä¸ªåŒ…è£¹ï¼</li><li>æ³¨é‡Š â€“ &#x2F;**&#x2F;</li><li>sqlå…³é”®å­—å¤§å°å†™ä¸æ•æ„Ÿ</li><li>æ‰€æœ‰ç¬¦å·ç”¨è‹±æ–‡ï¼</li></ul><h2 id="3ã€MySQLæ•°æ®ç®¡ç†"><a href="#3ã€MySQLæ•°æ®ç®¡ç†" class="headerlink" title="3ã€MySQLæ•°æ®ç®¡ç†"></a>3ã€MySQLæ•°æ®ç®¡ç†</h2><h3 id="3-1-å¤–é”®ï¼ˆäº†è§£å³å¯ï¼‰"><a href="#3-1-å¤–é”®ï¼ˆäº†è§£å³å¯ï¼‰" class="headerlink" title="3.1 å¤–é”®ï¼ˆäº†è§£å³å¯ï¼‰"></a>3.1 å¤–é”®ï¼ˆäº†è§£å³å¯ï¼‰</h3><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220118230935791.png" alt="image-20220118230935791"></p><hr><p>æ–¹å¼ä¸€ã€åœ¨åˆ›å»ºè¡¨çš„æ—¶å€™ï¼Œå¢åŠ çº¦æŸï¼ˆéº»çƒ¦ï¼Œæ¯”è¾ƒå¤æ‚ï¼‰</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `grade`(</span><br><span class="line">`gradeid` <span class="type">INT</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;å¹´çº§id&#x27;</span>,</span><br><span class="line">`gradename` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¹´çº§åç§°&#x27;</span>,</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY(`gradeid`)</span><br><span class="line">)ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- å­¦ç”Ÿè¡¨çš„gradeidå­—æ®µè¦å¼•ç”¨å¹´çº§è¡¨çš„gradeid</span></span><br><span class="line"><span class="comment">-- å®šä¹‰å¤–é”®key</span></span><br><span class="line"><span class="comment">-- ç»™è¿™ä¸ªå¤–é”®æ·»åŠ çº¦æŸ ï¼ˆæ‰§è¡Œå¼•ç”¨ï¼‰ references å¼•ç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> `student` (</span><br><span class="line">`id` <span class="type">INT</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;å­¦å·&#x27;</span>,</span><br><span class="line">`name` <span class="type">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;åŒ¿å&#x27;</span> COMMENT <span class="string">&#x27;å§“å&#x27;</span>,</span><br><span class="line">`pwd` <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;123456&#x27;</span> COMMENT <span class="string">&#x27;å¯†ç &#x27;</span>,</span><br><span class="line">`sex` <span class="type">VARCHAR</span>(<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;ç”·&#x27;</span> COMMENT <span class="string">&#x27;æ€§åˆ«&#x27;</span>,</span><br><span class="line">`birthday` DATETIME <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å‡ºç”Ÿæ—¥æœŸ&#x27;</span>,</span><br><span class="line">`gradeid` <span class="type">INT</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å­¦ç”Ÿçš„å¹´çº§&#x27;</span>,</span><br><span class="line">`address` <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å®¶åº­ä½å€&#x27;</span>,</span><br><span class="line">`email` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é‚®ç®±&#x27;</span>,</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY(`id`),</span><br><span class="line">KEY `FK_gradeid` (`gradeid`),</span><br><span class="line"><span class="keyword">CONSTRAINT</span> `FK_gradeid` <span class="keyword">FOREIGN</span> KEY (`gradeid`) <span class="keyword">REFERENCES</span> `grade` (`gradeid`)</span><br><span class="line">)ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8</span><br></pre></td></tr></table></figure><p>åˆ é™¤æœ‰å¤–é”®å…³ç³»çš„è¡¨çš„æ—¶å€™ï¼Œå¿…é¡»è¦å…ˆåˆ é™¤å¼•ç”¨åˆ«äººçš„è¡¨ï¼ˆä»è¡¨ï¼‰ï¼Œå†åˆ é™¤è¢«å¼•ç”¨çš„è¡¨ï¼ˆä¸»è¡¨ï¼‰</p><hr><p>æ–¹å¼äºŒï¼šåˆ›å»ºè¡¨æˆåŠŸåï¼Œæ·»åŠ å¤–é”®çº¦æŸ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> `student` (</span><br><span class="line">`id` <span class="type">INT</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;å­¦å·&#x27;</span>,</span><br><span class="line">`name` <span class="type">VARCHAR</span>(<span class="number">30</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;åŒ¿å&#x27;</span> COMMENT <span class="string">&#x27;å§“å&#x27;</span>,</span><br><span class="line">`pwd` <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;123456&#x27;</span> COMMENT <span class="string">&#x27;å¯†ç &#x27;</span>,</span><br><span class="line">`sex` <span class="type">VARCHAR</span>(<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;ç”·&#x27;</span> COMMENT <span class="string">&#x27;æ€§åˆ«&#x27;</span>,</span><br><span class="line">`birthday` DATETIME <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å‡ºç”Ÿæ—¥æœŸ&#x27;</span>,</span><br><span class="line">`gradeid` <span class="type">INT</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å­¦ç”Ÿçš„å¹´çº§&#x27;</span>,</span><br><span class="line">`address` <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å®¶åº­ä½å€&#x27;</span>,</span><br><span class="line">`email` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é‚®ç®±&#x27;</span>,</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY(`id`)</span><br><span class="line">)ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ›å»ºè¡¨æ²¡æœ‰å¤–é”®å…³ç³»</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `student` <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> `FK_gradeid` <span class="keyword">FOREIGN</span> KEY(`gradeid`) <span class="keyword">REFERENCES</span> `grade` (`gradeid`);</span><br><span class="line"><span class="comment">-- ALTER TABLE è¡¨ ADD CONSTRAINT çº¦æŸå FOREIGN KEY(ä½œä¸ºå¤–é”®çš„åˆ—) REFERENCES é‚£ä¸ªè¡¨ (é‚£ä¸ªå­—æ®µ)</span></span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šçš„å¤–é”®éƒ½æ˜¯ç‰©ç†å¤–é”®ï¼Œæ•°æ®åº“çº§åˆ«çš„å¤–é”®ï¼Œä¸å»ºè®®ä½¿ç”¨ï¼ï¼ˆé¿å…æ•°æ®åº“è¿‡å¤šé€ æˆå›°æ‰°ï¼Œè¿™é‡Œäº†è§£å³å¯ï¼‰</p><p>æœ€ä½³å®è·µ</p><ul><li>æ•°æ®åº“å°±æ˜¯å•å……çš„è¡¨ï¼Œåªç”¨æ¥å­˜å‚¨æ•°æ®ï¼Œåªæœ‰è¡Œï¼ˆæ•°æ®ï¼‰å’Œåˆ—ï¼ˆå­—æ®µï¼‰</li><li>æˆ‘ä»¬æƒ³ä½¿ç”¨å¤šå¼ è¡¨çš„æ•°æ®ï¼Œæƒ³ä½¿ç”¨å¤–é”®ï¼ˆç¨‹åºå»å®ç°ï¼‰</li></ul><h3 id="3-2-DMLè¯­è¨€ï¼ˆå…¨éƒ¨è®°ä½ï¼‰"><a href="#3-2-DMLè¯­è¨€ï¼ˆå…¨éƒ¨è®°ä½ï¼‰" class="headerlink" title="3.2 DMLè¯­è¨€ï¼ˆå…¨éƒ¨è®°ä½ï¼‰"></a>3.2 DMLè¯­è¨€ï¼ˆå…¨éƒ¨è®°ä½ï¼‰</h3><p><strong>æ•°æ®åº“æ„ä¹‰</strong>ï¼šæ•°æ®å­˜å‚¨ï¼Œæ•°æ®ç®¡ç†</p><p>DML è¯­è¨€ï¼šæ•°æ®æ“ä½œè¯­è¨€</p><ul><li>insert</li><li>update</li><li>delete</li></ul><hr><h3 id="3-3-æ·»åŠ "><a href="#3-3-æ·»åŠ " class="headerlink" title="3.3 æ·»åŠ "></a>3.3 æ·»åŠ </h3><p>insert</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- æ’å…¥è¯­å¥ï¼ˆæ·»åŠ ï¼‰</span></span><br><span class="line"><span class="comment">-- INSERT INTO è¡¨å([å­—æ®µå1ï¼Œå­—æ®µå2ï¼Œå­—æ®µå3])VALUES (&#x27;å€¼1&#x27;)ï¼Œ(&#x27;å€¼2&#x27;)ï¼Œ(&#x27;å€¼3&#x27;,.....)</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `grade`(`gradename`) <span class="keyword">VALUES</span>(<span class="string">&#x27;å¤§å››&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ç”±äºä¸»é”®è‡ªå¢æˆ‘ä»¬å¯ä»¥çœç•¥ï¼ˆå¦‚æœä¸å†™è¡¨çš„å­—æ®µï¼Œä»–å°±ä¼šä¸€ä¸€åŒ¹é…ï¼‰</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `grade` <span class="keyword">VALUES</span>(<span class="string">&#x27;å¤§ä¸‰&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä¸€åŠè¡€æ’å…¥è¯­å¥ï¼Œæˆ‘ä»¬ä¸€å®šè¦æ•°æ®å’Œå­—æ®µä¸€ä¸€å¯¹åº”ï¼</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ’å…¥å¤šä¸ªå­—æ®µ</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `grade`(`gradename`) <span class="keyword">VALUES</span>(<span class="string">&#x27;å¤§äºŒ&#x27;</span>),(<span class="string">&#x27;å¤§ä¸€&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `student`(`name`) <span class="keyword">VALUES</span> (<span class="string">&#x27;å¼ ä¸‰&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `student`(`name`,`pwd`,`sex`) <span class="keyword">VALUES</span> (<span class="string">&#x27;å¼ ä¸‰&#x27;</span>,<span class="string">&#x27;aaaa&#x27;</span>,<span class="string">&#x27;ç”·&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `student`(`name`,`pwd`,`sex`) <span class="keyword">VALUES</span> (<span class="string">&#x27;æå››&#x27;</span>,<span class="string">&#x27;aaaa&#x27;</span>,<span class="string">&#x27;ç”·&#x27;</span>),(<span class="string">&#x27;ç‹äº”&#x27;</span>,<span class="string">&#x27;aaaa&#x27;</span>,<span class="string">&#x27;ç”·&#x27;</span>)</span><br></pre></td></tr></table></figure><p>è¯­æ³•ï¼š </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> è¡¨å([å­—æ®µå<span class="number">1</span>ï¼Œå­—æ®µå<span class="number">2</span>ï¼Œå­—æ®µå<span class="number">3</span>])<span class="keyword">VALUES</span> (<span class="string">&#x27;å€¼1&#x27;</span>)ï¼Œ(<span class="string">&#x27;å€¼2&#x27;</span>)ï¼Œ(<span class="string">&#x27;å€¼3&#x27;</span>,.....)</span><br></pre></td></tr></table></figure><p>æ³¨æ„äº‹é¡¹ï¼š</p><ol><li>å­—æ®µå’Œå­—æ®µä¹‹é—´ä½¿ç”¨è‹±æ–‡é€—å·éš”å¼€</li><li>å­—æ®µæ˜¯å¯ä»¥çœç•¥çš„ï¼Œä½†æ˜¯æ„é¢çš„å€¼å¿…é¡»è¦ä¸€ä¸€å¯¹åº”ï¼Œä¸èƒ½å°‘</li><li>å¯ä»¥åŒæ—¶æ’å…¥å¤šæ¡æ•°æ®ï¼ŒVALUESåé¢çš„å€¼ï¼Œéœ€è¦ä½¿ç”¨ <strong>,</strong> éš”å¼€å³å¯ (),()</li></ol><h3 id="3-4-ä¿®æ”¹"><a href="#3-4-ä¿®æ”¹" class="headerlink" title="3.4 ä¿®æ”¹"></a>3.4 ä¿®æ”¹</h3><hr><p>updateä¿®æ”¹è°(æ¡ä»¶)setåŸæ¥çš„å€¼&#x3D;æ–°å¢</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ä¿®æ”¹å­¦å‘˜åå­—ï¼Œå¸¦äº†ç®€ä»‹</span></span><br><span class="line"><span class="keyword">UPDATE</span> `student` <span class="keyword">SET</span> `name` <span class="operator">=</span> <span class="string">&#x27;çŸ³æ¦´&#x27;</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä¸æŒ‡å®šæ¡ä»¶çš„æƒ…å†µä¸‹ï¼Œä¼šæ”¹åŠ¨æ‰€æœ‰è¡¨ï¼</span></span><br><span class="line"><span class="keyword">UPDATE</span> `student` <span class="keyword">SET</span> `name` <span class="operator">=</span> <span class="string">&#x27;é•¿æ±Ÿä¸ƒå·&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä¿®æ”¹å¤šä¸ªå±æ€§ï¼Œé€—å·éš”å¼€</span></span><br><span class="line"><span class="keyword">UPDATE</span> `student` <span class="keyword">SET</span> `name`<span class="operator">=</span><span class="string">&#x27;çŸ³æ¦´&#x27;</span>,`email`<span class="operator">=</span><span class="string">&#x27;shiliu@gmail.com&#x27;</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- è¯­æ³•</span></span><br><span class="line"><span class="comment">-- UPDATE è¡¨å SET colnum_name = value,[colnum_name = value,....] WHERE [æ¡ä»¶];</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ¡ä»¶ï¼šwhere å­—å¥ è¿ç®—ç¬¦ idç­‰äºæŸä¸ªå€¼ï¼Œæˆ–è€…å¤§äºå°äºæŸä¸ªå€¼ï¼ŒæŸä¸ªåŒºé—´å†…ä¿®æ”¹ã€‚</p><table><thead><tr><th>æ“ä½œç¬¦</th><th>å«ä¹‰</th><th>èŒƒå›´</th><th>ç»“æœ</th></tr></thead><tbody><tr><td>&#x3D;</td><td>ç­‰äº</td><td>5&#x3D;6</td><td>false</td></tr><tr><td>&lt;&gt;æˆ–!&#x3D;</td><td>ä¸ç­‰äº</td><td>5&lt;&gt;6</td><td>true</td></tr><tr><td>&gt;</td><td></td><td></td><td></td></tr><tr><td>&lt;</td><td></td><td></td><td></td></tr><tr><td>&lt;&#x3D;</td><td></td><td></td><td></td></tr><tr><td>&gt;&#x3D;</td><td></td><td></td><td></td></tr><tr><td>BETWEENâ€¦AND..</td><td>åœ¨æŸä¸ªèŒƒå›´å†…</td><td>[2,5]</td><td></td></tr><tr><td>AND</td><td>æˆ‘å’Œä½ &amp;&amp;</td><td>5&gt;1 and 1&gt;2</td><td>false</td></tr><tr><td>OR</td><td>æˆ‘æˆ–ä½ ||</td><td>5&gt;1 or 1&gt;2</td><td>true</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- é€šè¿‡å¤šä¸ªæ¡ä»¶å®šä½æ•°æ®</span></span><br><span class="line"><span class="keyword">UPDATE</span> `student` <span class="keyword">SET</span> `birthday`<span class="operator">=</span><span class="built_in">CURRENT_TIME</span> <span class="keyword">WHERE</span> `name`<span class="operator">=</span><span class="string">&#x27;çŸ³æ¦´&#x27;</span> <span class="keyword">AND</span> `sex` <span class="operator">=</span> <span class="string">&#x27;ç”·&#x27;</span>;</span><br><span class="line"><span class="comment">-- è¯­æ³•ï¼šUPDATE è¡¨å SET colnum_name=value,[colnum_name = value,....] WHERE [æ¡ä»¶]</span></span><br></pre></td></tr></table></figure><h3 id="3-5-åˆ é™¤"><a href="#3-5-åˆ é™¤" class="headerlink" title="3.5 åˆ é™¤"></a>3.5 åˆ é™¤</h3><hr><p>deleteå‘½å</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- åˆ é™¤æ•°æ® ï¼ˆé¿å…è¿™æ ·å†™ï¼‰</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> `student`</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ é™¤æŒ‡å®šæ•°æ®</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> `student` <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure><hr><p>TRUNCATEå‘½å</p><p>ä½œç”¨ï¼šå®Œå…¨æ¸…ç©ºä¸€ä¸ªæ•°æ®åº“è¡¨ï¼Œè¡¨çš„ç»“æ„å’Œç´¢å¼•çº¦æŸä¸ä¼šå˜</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- æ¸…ç©º student è¡¨</span></span><br><span class="line"><span class="keyword">TRUNCATE</span> `student`</span><br></pre></td></tr></table></figure><hr><p>deleteå’ŒTRUNCATEçš„åŒºåˆ«</p><ul><li>ç›¸åŒç‚¹ï¼šéƒ½èƒ½åˆ é™¤æ•°æ®ï¼Œéƒ½ä¸ä¼šåˆ é™¤è¡¨ç»“æ„</li><li>ä¸åŒï¼š<ul><li>TRUNCATEé‡æ–°è®¾ç½®è‡ªå¢åˆ—è®¡æ•°å™¨å›å½’é›¶</li><li>TRUNCATEä¸ä¼šå½±å“äº‹åŠ¡</li></ul></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- æµ‹è¯•deleteå’ŒTRUNCATEåŒºåˆ«</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `test`(</span><br><span class="line">`id` <span class="type">INT</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">`coll` <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY(`id`)</span><br><span class="line">)ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `test` (`coll`) <span class="keyword">VALUES</span>(<span class="string">&#x27;1&#x27;</span>),(<span class="string">&#x27;2&#x27;</span>),(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> `test` <span class="comment">-- ä¸ä¼šå½±å“è‡ªå¢</span></span><br><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> `test` <span class="comment">-- è‡ªåŠ¨å›å½’é›¶</span></span><br></pre></td></tr></table></figure><p>äº†è§£å³å¯ï¼šDELETEåˆ é™¤çš„é—®é¢˜ï¼Œé‡å¯æ•°æ®åº“ï¼Œç°è±¡</p><ul><li>InnoDBè‡ªå¢åˆ—ä¼šä»1å¼€å§‹ï¼ˆå­˜åœ¨å†…å­˜å½“ä¸­ï¼Œæ–­ç”µå³å¤±ï¼‰</li><li>MyISAMç»§ç»­ä»ä¸Šä¸€ä¸ªè‡ªå¢å¼€å§‹ï¼ˆå­˜åœ¨æ–‡ä»¶ä¸­ï¼Œä¸ä¼šä¸¢å¤±ï¼‰</li></ul><h2 id="4ã€DQLæŸ¥è¯¢æ•°æ®ï¼ˆæœ€é‡ç‚¹ï¼‰"><a href="#4ã€DQLæŸ¥è¯¢æ•°æ®ï¼ˆæœ€é‡ç‚¹ï¼‰" class="headerlink" title="4ã€DQLæŸ¥è¯¢æ•°æ®ï¼ˆæœ€é‡ç‚¹ï¼‰"></a>4ã€DQLæŸ¥è¯¢æ•°æ®ï¼ˆæœ€é‡ç‚¹ï¼‰</h2><h3 id="4-1-DQL"><a href="#4-1-DQL" class="headerlink" title="4.1 DQL"></a>4.1 DQL</h3><p>(Data Query Language:æ•°æ®åº“æŸ¥è¯¢è¯­è¨€)</p><ul><li>æ‰€æœ‰çš„æŸ¥è¯¢æ“ä½œéƒ½ç”¨å®ƒ Select</li><li>ç®€å•çš„æŸ¥è¯¢ï¼Œå¤æ‚çš„æŸ¥è¯¢ä»–éƒ½èƒ½åš</li><li><strong>æ•°æ®åº“æœ€æ ¸å¿ƒçš„è¯­è¨€ï¼Œæœ€ç»ˆè¦çš„è¯­å¥</strong></li><li>ä½¿ç”¨é¢‘ç‡æœ€é«˜çš„è¯­å¥</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥è¯¢å…¨éƒ¨çš„å­¦ç”Ÿ SELECT å­—æ®µ FROM è¡¨</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢æŒ‡å®šå­—æ®µ</span></span><br><span class="line"><span class="keyword">SELECT</span> `studentno`,`studentname`<span class="keyword">FROM</span> student</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ«åï¼Œç»™ç»“æœèµ·ä¸€ä¸ªåå­— AS å¯ä»¥ç»™å­—æ®µèµ·åˆ«åï¼Œä¹Ÿå¯ä»¥ç»™è¡¨èµ·åˆ«å</span></span><br><span class="line"><span class="keyword">SELECT</span> `studentno` <span class="keyword">AS</span> å­¦å·,`studentname` <span class="keyword">AS</span> å­¦ç”Ÿå§“å  <span class="keyword">FROM</span> student</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å‡½æ•° Concat(a,b)</span></span><br><span class="line"><span class="keyword">SELECT</span> CONCAT(<span class="string">&#x27;å§“åï¼š&#x27;</span>,studentname) <span class="keyword">AS</span> æ–°åå­— <span class="keyword">FROM</span> student</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- è¯­æ³•ï¼šSELECT å­—æ®µ....FROM è¡¨</span></span><br></pre></td></tr></table></figure><p>æœ‰çš„æ—¶å€™ï¼Œåˆ—åå­—ä¸æ˜¯é‚£ä¹ˆçš„è§åçŸ¥æ„ï¼Œéœ€è¦èµ·åˆ«å</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">AS</span> å­—æ®µå<span class="keyword">as</span> åˆ«å è¡¨å <span class="keyword">as</span> åˆ«å</span><br></pre></td></tr></table></figure><h3 id="4-2åŸºæœ¬çš„selectè¯­å¥å’Œåˆ«åçš„ä½¿ç”¨"><a href="#4-2åŸºæœ¬çš„selectè¯­å¥å’Œåˆ«åçš„ä½¿ç”¨" class="headerlink" title="4.2åŸºæœ¬çš„selectè¯­å¥å’Œåˆ«åçš„ä½¿ç”¨"></a>4.2åŸºæœ¬çš„selectè¯­å¥å’Œåˆ«åçš„ä½¿ç”¨</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> [<span class="keyword">ALL</span> <span class="operator">|</span> <span class="keyword">DISTINCT</span>]</span><br><span class="line">&#123;<span class="operator">*</span> <span class="operator">|</span> table.<span class="operator">*</span> <span class="operator">|</span> [table.field1[<span class="keyword">as</span> alias1][,table.field2[<span class="keyword">as</span> alias2]][,...]]&#125;</span><br><span class="line"><span class="keyword">FROM</span> table_name [<span class="keyword">as</span> table_alias]</span><br><span class="line">    [<span class="keyword">left</span> <span class="operator">|</span> <span class="keyword">right</span> <span class="operator">|</span> <span class="keyword">inner</span> <span class="keyword">join</span> table_name2]  <span class="comment">-- è”åˆæŸ¥è¯¢</span></span><br><span class="line">    [<span class="keyword">WHERE</span> ...]  <span class="comment">-- æŒ‡å®šç»“æœéœ€æ»¡è¶³çš„æ¡ä»¶</span></span><br><span class="line">    [<span class="keyword">GROUP</span> <span class="keyword">BY</span> ...]  <span class="comment">-- æŒ‡å®šç»“æœæŒ‰ç…§å“ªå‡ ä¸ªå­—æ®µæ¥åˆ†ç»„</span></span><br><span class="line">    [<span class="keyword">HAVING</span>]  <span class="comment">-- è¿‡æ»¤åˆ†ç»„çš„è®°å½•å¿…é¡»æ»¡è¶³çš„æ¬¡è¦æ¡ä»¶</span></span><br><span class="line">    [<span class="keyword">ORDER</span> <span class="keyword">BY</span> ...]  <span class="comment">-- æŒ‡å®šæŸ¥è¯¢è®°å½•æŒ‰ä¸€ä¸ªæˆ–å¤šä¸ªæ¡ä»¶æ’åº</span></span><br><span class="line">    [LIMIT &#123;[<span class="keyword">offset</span>,]row_count <span class="operator">|</span> row_countOFFSET <span class="keyword">offset</span>&#125;];</span><br><span class="line">    <span class="comment">--  æŒ‡å®šæŸ¥è¯¢çš„è®°å½•ä»å“ªæ¡è‡³å“ªæ¡</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼š[]æ‹¬å·ä»£è¡¨å¯é€‰çš„ï¼Œ{}æ‹¬å·ä»£è¡¨å¿…é€‰çš„</p><h3 id="4-3-å»é‡ï¼Œæ•°æ®åº“è¡¨è¾¾å¼"><a href="#4-3-å»é‡ï¼Œæ•°æ®åº“è¡¨è¾¾å¼" class="headerlink" title="4.3 å»é‡ï¼Œæ•°æ®åº“è¡¨è¾¾å¼"></a>4.3 å»é‡ï¼Œæ•°æ®åº“è¡¨è¾¾å¼</h3><hr><p><strong>å»é‡     DISTINCT</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥è¯¢ä¸€ä¸‹æœ‰å“ªäº›åŒå­¦å‚åŠ äº†è€ƒè¯•</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="keyword">result</span> <span class="comment">-- æŸ¥è¯¢å…¨éƒ¨çš„è€ƒè¯•æˆç»©</span></span><br><span class="line"><span class="keyword">SELECT</span> `studentno` <span class="keyword">FROM</span> <span class="keyword">result</span> <span class="comment">-- æŸ¥è¯¢é‚£äº›åŒå­¦å‚åŠ äº†è€ƒè¯•</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> `studentno` <span class="keyword">FROM</span> <span class="keyword">result</span> <span class="comment">-- å‘ç°é‡å¤æ•°æ®ï¼Œå»é‡</span></span><br></pre></td></tr></table></figure><hr><p>æ•°æ®åº“çš„åˆ—ï¼ˆè¡¨è¾¾å¼ï¼‰</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> VERSION() <span class="comment">-- æŸ¥è¯¢ç³»ç»Ÿç‰ˆæœ¬ï¼ˆå‡½æ•°ï¼‰</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">100</span><span class="operator">*</span><span class="number">3</span><span class="number">-1</span> <span class="keyword">AS</span> è®¡ç®—ç»“æœ <span class="comment">-- ç”¨æ¥è®¡ç®—ï¼ˆè¡¨è¾¾å¼ï¼‰</span></span><br><span class="line"><span class="keyword">SELECT</span> @<span class="variable">@auto</span>_increment_increment <span class="comment">-- æŸ¥è¯¢è‡ªå¢çš„æ­¥é•¿(å˜é‡)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- å­¦å‘˜çš„è€ƒè¯•æˆç»© +1 åˆ†</span></span><br><span class="line"><span class="keyword">SELECT</span> `studentno`,`studentresult`<span class="operator">+</span><span class="number">1</span> <span class="keyword">AS</span> <span class="string">&#x27;æåˆ†å&#x27;</span> <span class="keyword">FROM</span> <span class="keyword">result</span></span><br></pre></td></tr></table></figure><p>æ•°æ®åº“çš„è¡¨è¾¾å¼ï¼šæ–‡æœ¬å€¼ï¼Œåˆ—ï¼ŒNULLï¼Œå‡½æ•°ï¼Œè®¡ç®—è¡¨è¾¾å¼ï¼Œç³»ç»Ÿå˜é‡â€¦..</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- è¯­æ³•ï¼šSELECT å­—æ®µ....FROM è¡¨</span></span><br></pre></td></tr></table></figure><h3 id="4-4-where-æ¡ä»¶è¯­å¥"><a href="#4-4-where-æ¡ä»¶è¯­å¥" class="headerlink" title="4.4 where æ¡ä»¶è¯­å¥"></a>4.4 where æ¡ä»¶è¯­å¥</h3><p>ä½œç”¨ï¼šæ£€ç´¢æ•°æ®ä¸­ç¬¦åˆæ¡ä»¶çš„å€¼</p><p>æœç´¢æ¡ä»¶ç”±ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨è¾¾å¼ç»„æˆï¼ç»“æœä¸ºå¸ƒå°”å€¼</p><hr><p>é€»è¾‘è¿ç®—ç¬¦</p><table><thead><tr><th>è¿ç®—ç¬¦</th><th>è¯­æ³•</th><th>æè¿°</th></tr></thead><tbody><tr><td>and  &amp;&amp;</td><td>a and b   a&amp;&amp;b</td><td>é€»è¾‘ä¸</td></tr><tr><td>or  ||</td><td>a  or  b    a||b</td><td>é€»è¾‘æˆ–</td></tr><tr><td>not  !</td><td>not a    !a</td><td>é€»è¾‘é</td></tr></tbody></table><p>å°½é‡ä½¿ç”¨è‹±æ–‡å­—æ¯</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>studentno,`studentresult` <span class="keyword">FROM</span> <span class="keyword">result</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢é«˜è€ƒæˆç»©åœ¨95-100åˆ†ä¹‹é—´</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno,`studentresult` <span class="keyword">FROM</span> <span class="keyword">result</span></span><br><span class="line"><span class="keyword">WHERE</span> studentresult<span class="operator">&gt;=</span><span class="number">95</span> <span class="keyword">AND</span> studentresult<span class="operator">&lt;=</span><span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- and &amp;&amp;</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno,`studentresult` <span class="keyword">FROM</span> <span class="keyword">result</span></span><br><span class="line"><span class="keyword">WHERE</span> studentresult<span class="operator">&gt;=</span><span class="number">95</span> <span class="operator">&amp;&amp;</span> studentresult<span class="operator">&lt;=</span><span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ¨¡ç³ŠæŸ¥è¯¢ï¼ˆåŒºé—´ï¼‰</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno,`studentresult` <span class="keyword">FROM</span> <span class="keyword">result</span> </span><br><span class="line"><span class="keyword">WHERE</span> studentresult <span class="keyword">BETWEEN</span> <span class="number">95</span> <span class="keyword">AND</span> <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- é™¤äº†1000å·å­¦ç”Ÿä¹‹å¤–çš„åŒå­¦æˆç»©</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno,`studentresult`  <span class="keyword">FROM</span> <span class="keyword">result</span></span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> studentno<span class="operator">=</span><span class="number">1000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> studentno,`studentresult` <span class="keyword">FROM</span> <span class="keyword">result</span></span><br><span class="line"><span class="keyword">WHERE</span> studentno<span class="operator">!=</span><span class="number">1000</span></span><br></pre></td></tr></table></figure><hr><p>æ¨¡ç³ŠæŸ¥è¯¢ï¼šæ¯”è¾ƒè¿ç®—ç¬¦</p><table><thead><tr><th>è¿ç®—ç¬¦</th><th>è¯­æ³•</th><th>æè¿°</th></tr></thead><tbody><tr><td>IS NULL</td><td>a is null</td><td>å¦‚æœæ“ä½œç¬¦ä¸ºnullï¼Œç»“æœä¸ºçœŸ</td></tr><tr><td>IS NOT NULL</td><td>a is not null</td><td>å¦‚æœæ“ä½œç¬¦ä¸ä¸ºnullï¼Œç»“æœä¸ºçœŸ</td></tr><tr><td>BETWEEN</td><td>a between b and c</td><td>å¦‚æœaåœ¨bå’Œcä¹‹é—´ï¼Œç»“æœä¸ºçœŸ</td></tr><tr><td>LIKE</td><td>a like b</td><td>SQLåŒ¹é…ï¼Œå¦‚æœaåŒ¹é…bï¼Œåˆ™ç»“æœä¸ºçœŸ</td></tr><tr><td>IN</td><td>a in(a1,a2,a3â€¦..)</td><td>å‡è®¾aåœ¨a1,æˆ–è€…a2â€¦å…¶ä¸­ä¸€ä¸ªå€¼ä¸­ï¼Œç»“æœä¸ºçœŸ</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>studentno,`studentresult` <span class="keyword">FROM</span> <span class="keyword">result</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢é«˜è€ƒæˆç»©åœ¨95-100åˆ†ä¹‹é—´</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno,`studentresult` <span class="keyword">FROM</span> <span class="keyword">result</span></span><br><span class="line"><span class="keyword">WHERE</span> studentresult<span class="operator">&gt;=</span><span class="number">95</span> <span class="keyword">AND</span> studentresult<span class="operator">&lt;=</span><span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- and &amp;&amp;</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno,`studentresult` <span class="keyword">FROM</span> <span class="keyword">result</span></span><br><span class="line"><span class="keyword">WHERE</span> studentresult<span class="operator">&gt;=</span><span class="number">95</span> <span class="operator">&amp;&amp;</span> studentresult<span class="operator">&lt;=</span><span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ¨¡ç³ŠæŸ¥è¯¢ï¼ˆåŒºé—´ï¼‰</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno,`studentresult` <span class="keyword">FROM</span> <span class="keyword">result</span> </span><br><span class="line"><span class="keyword">WHERE</span> studentresult <span class="keyword">BETWEEN</span> <span class="number">95</span> <span class="keyword">AND</span> <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- é™¤äº†1000å·å­¦ç”Ÿä¹‹å¤–çš„åŒå­¦æˆç»©</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno,`studentresult`  <span class="keyword">FROM</span> <span class="keyword">result</span></span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> studentno<span class="operator">=</span><span class="number">1000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> studentno,`studentresult` <span class="keyword">FROM</span> <span class="keyword">result</span></span><br><span class="line"><span class="keyword">WHERE</span> studentno<span class="operator">!=</span><span class="number">1000</span></span><br><span class="line"></span><br><span class="line"><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span>æ¨¡ç³ŠæŸ¥è¯¢<span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢å§“åˆ˜çš„åŒå­¦</span></span><br><span class="line"><span class="comment">-- likeç»“åˆ %ï¼ˆä»£è¡¨0åˆ°ä»»æ„ä¸ªå­—ç¬¦ï¼‰ _ï¼ˆä»£è¡¨ä¸€ä¸ªå­—ç¬¦ï¼‰</span></span><br><span class="line"><span class="keyword">SELECT</span> `studentno`,`studentname` <span class="keyword">FROM</span> `student`</span><br><span class="line"><span class="keyword">WHERE</span> studentname <span class="keyword">LIKE</span> <span class="string">&#x27;åˆ˜%&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢å§“åˆ˜çš„åŒå­¦ï¼Œåå­—åé¢åªæœ‰ä¸€ä¸ªå­—çš„</span></span><br><span class="line"><span class="keyword">SELECT</span> `studentno`,`studentname` <span class="keyword">FROM</span> `student`</span><br><span class="line"><span class="keyword">WHERE</span> studentname <span class="keyword">LIKE</span> <span class="string">&#x27;åˆ˜_&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢å§“åˆ˜çš„åŒå­¦ï¼Œåå­—åé¢åªæœ‰ä¸¤ä¸ªå­—çš„</span></span><br><span class="line"><span class="keyword">SELECT</span> `studentno`,`studentname` <span class="keyword">FROM</span> `student`</span><br><span class="line"><span class="keyword">WHERE</span> studentname <span class="keyword">LIKE</span> <span class="string">&#x27;åˆ˜__&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢åå­—ä¸­æœ‰å³°çš„åŒå­¦ %å³°%</span></span><br><span class="line"><span class="keyword">SELECT</span> `studentno`,`studentname` <span class="keyword">FROM</span> `student`</span><br><span class="line"><span class="keyword">WHERE</span> studentname <span class="keyword">LIKE</span> <span class="string">&#x27;%å³°%&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢1001ï¼Œ1002å·å­¦å‘˜</span></span><br><span class="line"><span class="keyword">SELECT</span> `studentno`,`studentname` <span class="keyword">FROM</span> `student`</span><br><span class="line"><span class="keyword">WHERE</span> studentno <span class="keyword">IN</span> (<span class="number">1001</span>,<span class="number">1002</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢åŒ—äº¬çš„å­¦ç”Ÿ</span></span><br><span class="line"><span class="keyword">SELECT</span> `studentno`,`studentname` <span class="keyword">FROM</span> `student`</span><br><span class="line"><span class="keyword">WHERE</span> address <span class="keyword">IN</span> (<span class="string">&#x27;å®‰å¾½&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢åœ°å€ä¸ºç©ºçš„å­¦ç”Ÿ</span></span><br><span class="line"><span class="keyword">SELECT</span> `studentno`,`studentname` <span class="keyword">FROM</span> `student`</span><br><span class="line"><span class="keyword">WHERE</span> address<span class="operator">=</span>&quot;&quot; <span class="keyword">OR</span> address <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢å‡ºç”Ÿæ—¥æœŸä¸ä¸ºç©ºçš„åŒå­¦</span></span><br><span class="line"><span class="keyword">SELECT</span> `studentno`,`studentname` <span class="keyword">FROM</span> `student`</span><br><span class="line"><span class="keyword">WHERE</span> borndate <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢å‡ºç”Ÿæ—¥æœŸä¸ºç©ºçš„åŒå­¦</span></span><br><span class="line"><span class="keyword">SELECT</span> `studentno`,`studentname` <span class="keyword">FROM</span> `student`</span><br><span class="line"><span class="keyword">WHERE</span> borndate <span class="keyword">IS</span>  <span class="keyword">NULL</span></span><br></pre></td></tr></table></figure><h3 id="4-5-è”è¡¨æŸ¥è¯¢"><a href="#4-5-è”è¡¨æŸ¥è¯¢" class="headerlink" title="4.5 è”è¡¨æŸ¥è¯¢"></a>4.5 è”è¡¨æŸ¥è¯¢</h3><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220123111220578.png" alt="image-20220123111220578"></p><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220123111242854.png" alt="image-20220123111242854"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span>è”è¡¨æŸ¥è¯¢<span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span></span><br><span class="line"><span class="comment">/*æ€è·¯</span></span><br><span class="line"><span class="comment">1.åˆ†æéœ€æ±‚ï¼Œåˆ†ææŸ¥è¯¢å­—æ®µæ¥è‡ªé‚£äº›è¡¨ã€‚ï¼ˆè¿æ¥æŸ¥è¯¢ï¼‰</span></span><br><span class="line"><span class="comment">2.ç¡®å®šä½¿ç”¨é‚£ç§è¿æ¥ï¼Ÿ7ç§</span></span><br><span class="line"><span class="comment">ç¡®å®šäº¤å‰ç‚¹ï¼ˆè¿™ä¸¤ä¸ªè¡¨ä¸­é‚£ä¸ªæ•°æ®æ˜¯ç›¸åŒçš„ï¼‰</span></span><br><span class="line"><span class="comment">åˆ¤æ–­çš„æ¡ä»¶ï¼šå­¦ç”Ÿè¡¨ä¸­çš„studentno=æˆç»©è¡¨ä¸­çš„studentno</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno,studentname,subjectno,studentresult</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">ON</span> s.studentno<span class="operator">=</span>r.studentno</span><br><span class="line"></span><br><span class="line"><span class="comment">-- RIGHT JOIN</span></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno,studentname,subjectno,studentresult</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">ON</span> s.studentno<span class="operator">=</span>r.studentno</span><br><span class="line"></span><br><span class="line"><span class="comment">-- LEFT JOIN</span></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno,studentname,subjectno,studentresult</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">ON</span> s.studentno<span class="operator">=</span>r.studentno</span><br></pre></td></tr></table></figure><table><thead><tr><th>æ“ä½œ</th><th>æè¿°</th></tr></thead><tbody><tr><td>INNTER JOIN</td><td>å¦‚æœè¡¨ä¸­è‡³å°‘æœ‰ä¸€ä¸ªåŒ¹é…ï¼Œå°±è¿”å›æ‰§è¡Œ</td></tr><tr><td>LEFT JOIN</td><td>ä¼šä»å·¦è¡¨ä¸­è¿”å›æ‰€æœ‰çš„å€¼ï¼Œå³ä½¿å³è¡¨æ²¡æœ‰åŒ¹é…</td></tr><tr><td>RIGHT JOIN</td><td>ä¼šä»å³è¡¨ä¸­è¿”å›æ‰€æœ‰çš„å€¼ï¼Œå³ä½¿å·¦è¡¨æ²¡æœ‰åŒ¹é…</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- join(è¿æ¥çš„è¡¨) on (åˆ¤æ–­çš„æ¡ä»¶) è¿æ¥æŸ¥è¯¢</span></span><br><span class="line"><span class="comment">-- where ç­‰å€¼æŸ¥è¯¢</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno,studentname,subjectno,studentresult</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">WHERE</span> s.studentno<span class="operator">=</span>r.studentno</span><br><span class="line"></span><br><span class="line"><span class="comment">-- RIGHT JOIN</span></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno,studentname,subjectno,studentresult</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">WHERE</span> s.studentno<span class="operator">=</span>r.studentno</span><br><span class="line"></span><br><span class="line"><span class="comment">-- LEFT JOIN</span></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno,studentname,subjectno,studentresult</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">WHERE</span> s.studentno<span class="operator">=</span>r.studentno</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢ç¼ºè€ƒçš„åŒå­¦</span></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno,studentname,subjectno,studentresult</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">ON</span> s.studentno <span class="operator">=</span> r.studentno</span><br><span class="line"><span class="keyword">WHERE</span> studentresult <span class="keyword">IS</span> <span class="keyword">NULL</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*æ€è·¯(æŸ¥è¯¢å‚åŠ è€ƒè¯•åŒå­¦çš„ä¿¡æ¯ï¼Œå­¦å·ï¼Œå§“åã€‚ç§‘ç›®åï¼Œæˆç»©)</span></span><br><span class="line"><span class="comment">1.åˆ†æéœ€æ±‚ï¼Œåˆ†ææŸ¥è¯¢å­—æ®µæ¥è‡ªé‚£äº›è¡¨ã€‚student result subjectï¼ˆè¿æ¥æŸ¥è¯¢ï¼‰</span></span><br><span class="line"><span class="comment">2.ç¡®å®šä½¿ç”¨é‚£ç§è¿æ¥ï¼Ÿ7ç§</span></span><br><span class="line"><span class="comment">ç¡®å®šäº¤å‰ç‚¹ï¼ˆè¿™ä¸¤ä¸ªè¡¨ä¸­é‚£ä¸ªæ•°æ®æ˜¯ç›¸åŒçš„ï¼‰</span></span><br><span class="line"><span class="comment">åˆ¤æ–­çš„æ¡ä»¶ï¼šå­¦ç”Ÿè¡¨ä¸­çš„studentno=æˆç»©è¡¨ä¸­çš„studentno</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno,studentname,subjectname,studentresult</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">ON</span> r.studentno <span class="operator">=</span> s.studentno</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> subject sub</span><br><span class="line"><span class="keyword">ON</span> r.subjectno <span class="operator">=</span> sub.subjectno</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æˆ‘è¦æŸ¥è¯¢å“ªäº›æ•°æ® select</span></span><br><span class="line"><span class="comment">-- ä»é‚£å‡ ä¸ªè¡¨ä¸­æŸ¥è¯¢ FROM è¡¨ JOIN è¿æ¥çš„è¡¨ ON äº¤å‰æ¡ä»¶</span></span><br><span class="line"><span class="comment">-- å‡è®¾å­˜åœ¨ä¸€ç§å¤šå¼ è¡¨æŸ¥è¯¢ï¼Œæ…¢æ…¢æ¥ï¼Œå…ˆæŸ¥è¯¢ä¸¤å¼ è¡¨ç„¶ååœ¨æ…¢æ…¢å¢åŠ </span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- From a left join b</span></span><br><span class="line"><span class="comment">-- From a right join b</span></span><br></pre></td></tr></table></figure><hr><p>è‡ªè¿æ¥</p><p>è‡ªå·±çš„è¡¨å’Œè‡ªå·±çš„è¡¨ç›¸è¿ï¼Œæ ¸å¿ƒï¼š<strong>ä¸€å¼ è¡¨æ‹†ä¸ºä¸¤å¼ ä¸€æ ·çš„è¡¨å³å¯</strong> </p><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220123171228812.png" alt="image-20220123171228812"></p><p>çˆ¶ç±»</p><table><thead><tr><th>categoryid</th><th>categoryname</th></tr></thead><tbody><tr><td>2</td><td>ä¿¡æ¯æŠ€æœ¯</td></tr><tr><td>3</td><td>è½¯ä»¶å¼€å‘</td></tr><tr><td>5</td><td>ç¾æœ¯è®¾è®¡</td></tr><tr><td></td><td></td></tr></tbody></table><p>å­ç±»</p><table><thead><tr><th>pid</th><th>categoryid</th><th>categoryname</th></tr></thead><tbody><tr><td>3</td><td>4</td><td>æ•°æ®åº“</td></tr><tr><td>2</td><td>8</td><td>åŠå…¬ä¿¡æ¯</td></tr><tr><td>3</td><td>6</td><td>webå¼€å‘</td></tr><tr><td>5</td><td>7</td><td>psæŠ€æœ¯</td></tr></tbody></table><p>æ“ä½œï¼šæŸ¥è¯¢çˆ¶ç±»å¯¹åº”çš„å­ç±»å¯¹è±¡</p><table><thead><tr><th>çˆ¶ç±»</th><th>å­ç±»</th></tr></thead><tbody><tr><td>ä¿¡æ¯æŠ€æœ¯</td><td>åŠå…¬ä¿¡æ¯</td></tr><tr><td>å¦‚é‚£ä»¶å¼€å‘</td><td>æ•°æ®åº“</td></tr><tr><td>è½¯ä»¶å¼€å‘</td><td>webå¼€å‘</td></tr><tr><td>ç¾æœ¯è®¾è®¡</td><td>psæŠ€æœ¯</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥è¯¢çˆ¶å­ä¿¡æ¯ï¼šæŠŠä¸€å¼ è¡¨çœ‹æˆä¸¤ä¸ªä¸€æ¨¡ä¸€æ ·çš„è¡¨</span></span><br><span class="line"><span class="keyword">SELECT</span> a.`categoryname` <span class="keyword">AS</span> <span class="string">&#x27;çˆ¶æ å&#x27;</span>,b.`categoryname` <span class="keyword">AS</span> <span class="string">&#x27;å­æ ç›®&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> `category` <span class="keyword">AS</span> a, `category` <span class="keyword">AS</span> b</span><br><span class="line"><span class="keyword">WHERE</span> a.`categoryid` <span class="operator">=</span> b.`pid`</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢å­¦å‘˜æ‰€å±å¹´çº§ï¼ˆå­¦å·ï¼Œå­¦ç”Ÿçš„å§“åï¼Œå¹´çº§åç§°ï¼‰</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno,studentname,gradename</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> grade g</span><br><span class="line"><span class="keyword">ON</span> s.gradeid <span class="operator">=</span> g.gradeid</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢ç§‘ç›®æ‰€å±å¹´çº§ï¼ˆç§‘ç›®åç§°ï¼Œå¹´çº§åç§°ï¼‰</span></span><br><span class="line"><span class="keyword">SELECT</span> subjectname,gradename</span><br><span class="line"><span class="keyword">FROM</span> `subject` s</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> grade g</span><br><span class="line"><span class="keyword">on</span> s.gradeid <span class="operator">=</span> g.gradeid</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢äº†å‚åŠ  æ•°æ®ç»“æ„ è€ƒè¯•çš„åŒå­¦ä¿¡æ¯ï¼šå­¦å·ï¼Œå§“åï¼Œç§‘ç›®åï¼Œåˆ†æ•°</span></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno,studentname,subjectname,studentresult</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">ON</span> s.studentno <span class="operator">=</span> r.studentno</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> `subject` sub</span><br><span class="line"><span class="keyword">ON</span> r.`subjectno` <span class="operator">=</span> sub.subjectno</span><br><span class="line"><span class="keyword">where</span> subjectname <span class="operator">=</span> <span class="string">&#x27;æ•°æ®åº“ç»“æ„-1&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="4-6-åˆ†é¡µå’Œæ’åº"><a href="#4-6-åˆ†é¡µå’Œæ’åº" class="headerlink" title="4.6 åˆ†é¡µå’Œæ’åº"></a>4.6 åˆ†é¡µå’Œæ’åº</h3><hr><p>ORDER BY</p><p>æ’åº</p><p>å‡åº ASC  é™åº DESC</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span>æ’åº<span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span></span><br><span class="line"><span class="comment">-- æ’åºï¼š å‡åº ASC  é™åº DESC</span></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢çš„ç»“æœæ ¹æ®æˆç»©æ’åº é™åº</span></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno,studentname,subjectname,studentresult</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">ON</span> s.studentno <span class="operator">=</span> r.studentno</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> `subject` sub</span><br><span class="line"><span class="keyword">ON</span> r.`subjectno` <span class="operator">=</span> sub.subjectno</span><br><span class="line"><span class="keyword">where</span> subjectname <span class="operator">=</span> <span class="string">&#x27;æ•°æ®åº“ç»“æ„-1&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> studentresult <span class="keyword">ASC</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><hr><p>åˆ†é¡µ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span>åˆ†é¡µ<span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span></span><br><span class="line"><span class="comment">-- åˆ†é¡µï¼šæ¯é¡µæ˜¾ç¤ºäº”æ¡æ•°æ®</span></span><br><span class="line"><span class="comment">-- è¯­æ³•ï¼šlimit èµ·å§‹å€¼ï¼Œé¡µé¢çš„å¤§å°</span></span><br><span class="line"><span class="comment">-- ç½‘é¡µåº”ç”¨ï¼šå½“å‰ï¼Œæ€»çš„é¡µæ•°ï¼Œé¡µé¢å¤§å°</span></span><br><span class="line"><span class="comment">-- LIMIT 0,51~5</span></span><br><span class="line"><span class="comment">-- LIMIT 2,52~6</span></span><br><span class="line"><span class="comment">-- LIMIT 5,5  6~10</span></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno,studentname,subjectname,studentresult</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">ON</span> s.studentno <span class="operator">=</span> r.studentno</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> `subject` sub</span><br><span class="line"><span class="keyword">ON</span> r.`subjectno` <span class="operator">=</span> sub.subjectno</span><br><span class="line"><span class="keyword">where</span> subjectname <span class="operator">=</span> <span class="string">&#x27;æ•°æ®åº“ç»“æ„-1&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> studentresult <span class="keyword">ASC</span></span><br><span class="line">LIMIT <span class="number">5</span>,<span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- ç¬¬ä¸€é¡µ limit 0ï¼Œ5   ï¼ˆ1-1ï¼‰*5</span></span><br><span class="line"><span class="comment">-- ç¬¬äºŒé¡µ limit 5ï¼Œ5   ï¼ˆ2-1ï¼‰*5</span></span><br><span class="line"><span class="comment">-- ç¬¬ä¸‰é¡µ limit 10ï¼Œ5   ï¼ˆ3-1ï¼‰*5</span></span><br><span class="line"><span class="comment">-- ç¬¬Né¡µ limit    ï¼ˆn-1ï¼‰*pageSize,pageSize</span></span><br><span class="line">pageSize:é¡µé¢å¤§å°</span><br><span class="line">ï¼ˆn<span class="number">-1</span>ï¼‰<span class="operator">*</span>pageSizeï¼šèµ·å§‹å€¼</span><br><span class="line">nï¼šå½“å‰é¡µ</span><br><span class="line">æ•°æ®æ€»æ•°<span class="operator">/</span>é¡µé¢å¤§å°<span class="operator">=</span>æ€»é¡µæ•°</span><br></pre></td></tr></table></figure><hr><p>ä½œä¸š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- æŸ¥è¯¢ Javaç¬¬ä¸€å­¦å¹´ è¯¾ç¨‹æ’åå‰åçš„å­¦ç”Ÿï¼Œå¹¶ä¸”åˆ†æ•°è¦å¤§äº80çš„å­¦ç”Ÿä¿¡æ¯ï¼ˆå­¦å·ã€å§“åã€è¯¾ç¨‹åç§°ã€åˆ†æ•°ï¼‰</span></span><br><span class="line"><span class="keyword">SELECT</span> s.studentno,studentname,subjectname,studentresult</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">ON</span> s.studentno <span class="operator">=</span> r.studentno</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> subject sub</span><br><span class="line"><span class="keyword">ON</span> sub.subjectno <span class="operator">=</span> r.subjectno</span><br><span class="line"><span class="keyword">WHERE</span> subjectname<span class="operator">=</span><span class="string">&#x27;Javaç¬¬ä¸€å­¦å¹´&#x27;</span> <span class="keyword">AND</span> studentresult<span class="operator">&gt;=</span><span class="number">80</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> studentresult <span class="keyword">DESC</span></span><br><span class="line">LIMIT <span class="number">0</span>,<span class="number">10</span></span><br></pre></td></tr></table></figure><h3 id="4-7-å­æŸ¥è¯¢"><a href="#4-7-å­æŸ¥è¯¢" class="headerlink" title="4.7 å­æŸ¥è¯¢"></a>4.7 å­æŸ¥è¯¢</h3><p>whereï¼ˆè¿™ä¸ªå€¼æ˜¯è®¡ç®—å‡ºæ¥çš„ï¼‰</p><p>æœ¬è´¨ï¼šåœ¨whereè¯­å¥ä¸­åµŒå¥—ä¸€ä¸ªå­æŸ¥è¯¢è¯­å¥</p><p>whereï¼ˆselect* fromï¼‰</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 1.æŸ¥è¯¢æ•°æ®åº“ç»“æ„-1 çš„æ‰€æœ‰è€ƒè¯•ç»“æœï¼ˆå­¦å·ï¼Œç§‘ç›®ç¼–å·ï¼Œæˆç»©ï¼‰é™åºæ’åˆ—</span></span><br><span class="line"><span class="comment">-- æ–¹å¼ä¸€ï¼šä½¿ç”¨è”æŸ¥</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno,r.subjectno,studentresult</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> subject sub</span><br><span class="line"><span class="keyword">ON</span> r.subjectno <span class="operator">=</span> sub.subjectno</span><br><span class="line"><span class="keyword">WHERE</span> subjectname <span class="operator">=</span> <span class="string">&#x27;é«˜ç­‰æ•°å­¦-1&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> studentresult <span class="keyword">DESC</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ–¹å¼äºŒï¼šä½¿ç”¨å­æŸ¥è¯¢()</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno,subjectno,studentresult</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">result</span></span><br><span class="line"><span class="keyword">WHERE</span> subjectno<span class="operator">=</span>(</span><br><span class="line"><span class="comment">-- æŸ¥è¯¢æ‰€æœ‰&#x27;é«˜ç­‰æ•°å­¦-1&#x27;åŒå­¦çš„å­¦å·</span></span><br><span class="line"><span class="keyword">SELECT</span> subjectno <span class="keyword">FROM</span> subject <span class="keyword">WHERE</span> subjectname <span class="operator">=</span> <span class="string">&#x27;é«˜ç­‰æ•°å­¦-1&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 2.åˆ†æ•°ä¸ä¸‹é›¨80åˆ†çš„å­¦ç”Ÿçš„å­¦å·å’Œå§“å</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> s.studentno,studentname</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">ON</span> s.studentno<span class="operator">=</span>r.studentno</span><br><span class="line"><span class="keyword">WHERE</span> studentresult<span class="operator">&gt;=</span><span class="number">80</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">-- åœ¨è¿™ä¸ªåŸºç¡€ä¸ŠåŠ ä¸€ä¸ªç§‘ç›®ï¼Œé«˜ç­‰æ•°å­¦-1</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> s.studentno,studentname</span><br><span class="line"><span class="keyword">FROM</span> student s</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">ON</span> s.studentno<span class="operator">=</span>r.studentno</span><br><span class="line"><span class="keyword">WHERE</span> studentresult<span class="operator">&gt;=</span><span class="number">80</span> <span class="keyword">AND</span> subjectno<span class="operator">=</span>(</span><br><span class="line"><span class="keyword">SELECT</span> subjectno <span class="keyword">FROM</span> subject <span class="keyword">WHERE</span> subjectname <span class="operator">=</span> <span class="string">&#x27;é«˜ç­‰æ•°å­¦-1&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åœ¨æ”¹é€ ï¼ˆç”±é‡Œå³å¤–ï¼‰</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno,studentname <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> studentno <span class="keyword">in</span>(</span><br><span class="line"><span class="keyword">SELECT</span> studentno <span class="keyword">FROM</span> <span class="keyword">result</span> <span class="keyword">WHERE</span> studentresult<span class="operator">&gt;</span><span class="number">80</span> <span class="keyword">AND</span> subjectno<span class="operator">=</span>(</span><br><span class="line"><span class="keyword">SELECT</span> subjectno <span class="keyword">FROM</span> subject <span class="keyword">WHERE</span> subjectname <span class="operator">=</span> <span class="string">&#x27;é«˜ç­‰æ•°å­¦-1&#x27;</span></span><br><span class="line">)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="4-8-åˆ†ç»„å’Œè¿‡æ»¤"><a href="#4-8-åˆ†ç»„å’Œè¿‡æ»¤" class="headerlink" title="4.8 åˆ†ç»„å’Œè¿‡æ»¤"></a>4.8 åˆ†ç»„å’Œè¿‡æ»¤</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span>åˆ†ç»„è¿‡æ»¤<span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span></span><br><span class="line"><span class="keyword">SELECT</span> subjectname,<span class="built_in">AVG</span>(studentresult),<span class="built_in">MAX</span>(studentresult),<span class="built_in">MIN</span>(studentresult)</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">result</span> r</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> `subject` sub</span><br><span class="line"><span class="keyword">ON</span> r.subjectno <span class="operator">=</span> sub.subjectno</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> r.subjectno</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">AVG</span>(studentresult)<span class="operator">&gt;</span><span class="number">80</span>;</span><br></pre></td></tr></table></figure><h3 id="4-9-SELECT-æ€»ç»“"><a href="#4-9-SELECT-æ€»ç»“" class="headerlink" title="4.9 SELECT æ€»ç»“"></a>4.9 SELECT æ€»ç»“</h3><p><strong>é¡ºåºå¾ˆé‡è¦</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> å»é‡ è¦æŸ¥è¯¢çš„å­—æ®µ <span class="keyword">from</span> è¡¨ ï¼ˆæ³¨æ„ï¼šè¡¨å’Œå­—æ®µå¯ä»¥å–åˆ«åï¼‰</span><br><span class="line">XXX <span class="keyword">join</span> è¦è¿æ¥çš„è¡¨ <span class="keyword">on</span> ç­‰å€¼åˆ¤æ–­</span><br><span class="line"><span class="keyword">where</span>ï¼ˆå…·ä½“çš„å€¼ï¼Œå­æŸ¥è¯¢è¯­å¥ï¼‰</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> ï¼ˆé€šè¿‡é‚£ä¸ªå­—æ®µæ¥åˆ†ç»„ï¼‰</span><br><span class="line"><span class="keyword">having</span> ï¼ˆè¿‡æ»¤åçš„ä¿¡æ¯ï¼Œæ¡ä»¶å’Œ<span class="keyword">where</span>æ˜¯ä¸€æ ·çš„ï¼Œä½ç½®ä¸åŒï¼‰</span><br><span class="line"><span class="keyword">order</span> by..ï¼ˆé€šè¿‡é‚£ä¸ªå­—æ®µæ’åºï¼‰[å‡åº<span class="operator">/</span>é™åº]</span><br><span class="line">limit startindexï¼Œpagesize</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ä¸šåŠ¡å±‚é¢ï¼š</span><br><span class="line">æŸ¥è¯¢ï¼šè·¨è¡¨ï¼Œè·¨æ•°æ®åº“</span><br></pre></td></tr></table></figure><h2 id="5-ã€MySQLå‡½æ•°"><a href="#5-ã€MySQLå‡½æ•°" class="headerlink" title="5 ã€MySQLå‡½æ•°"></a>5 ã€MySQLå‡½æ•°</h2><h3 id="5-1-å¸¸ç”¨å‡½æ•°"><a href="#5-1-å¸¸ç”¨å‡½æ•°" class="headerlink" title="5.1  å¸¸ç”¨å‡½æ•°"></a>5.1  å¸¸ç”¨å‡½æ•°</h3><p><a href="https://dev.mysql.com/doc/refman/5.7/en/">https://dev.mysql.com/doc/refman/5.7/en/</a></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">ABS</span>(<span class="number">-8</span>); <span class="comment">-- ç»å¯¹å€¼</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">CEILING</span>(<span class="number">9.4</span>) ;<span class="comment">-- å‘ä¸Šå–æ•´</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">FLOOR</span>(<span class="number">9.4</span>);<span class="comment">-- å‘ä¸‹å–æ•´</span></span><br><span class="line"><span class="keyword">SELECT</span> RAND(); <span class="comment">-- è¿”å›ä¸€ä¸ª0~1ä¹‹é—´çš„éšæœºæ•°</span></span><br><span class="line"><span class="keyword">SELECT</span> SIGN(<span class="number">-10</span>); <span class="comment">-- åˆ¤æ–­ä¸€ä¸ªæ•°çš„ç¬¦å·ï¼Œ0 è¿”å›0 è´Ÿæ•°è¿”å›-1 æ­£æ•°è¿”å›1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- å­—ç¬¦ä¸²å‡½æ•°</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">CHAR_LENGTH</span>(<span class="string">&#x27;å“ˆå“ˆ&#x27;</span>); <span class="comment">-- å­—ç¬¦ä¸²é•¿åº¦</span></span><br><span class="line"><span class="keyword">SELECT</span> CONCAT(<span class="string">&#x27;æˆ‘&#x27;</span>,<span class="string">&#x27;çˆ±&#x27;</span>,<span class="string">&#x27;ä½ &#x27;</span>); <span class="comment">-- æ‹¼æ¥å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">INSERT</span>(<span class="string">&#x27;æˆ‘çˆ±ç¼–ç¨‹helloworld&#x27;</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="string">&#x27;è¶…çº§çƒ­çˆ±&#x27;</span>); <span class="comment">-- æ’å…¥ï¼Œæ›¿æ¢</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">LOWER</span>(<span class="string">&#x27;ZYY&#x27;</span>); <span class="comment">-- å°å†™å­—æ¯</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">UPPER</span>(<span class="string">&#x27;zyy&#x27;</span>); <span class="comment">-- å¤§å†™å­—æ¯</span></span><br><span class="line"><span class="keyword">SELECT</span> INSTR(<span class="string">&#x27;zyy&#x27;</span>,<span class="string">&#x27;y&#x27;</span>); <span class="comment">-- è¿”å›ç¬¬ä¸€æ¬¡å‡ºç°çš„å­ä¸²çš„ç´¢å¼•</span></span><br><span class="line"><span class="keyword">SELECT</span> REPLACE(<span class="string">&#x27;åšæŒå°±èƒ½æˆåŠŸ&#x27;</span>,<span class="string">&#x27;åšæŒ&#x27;</span>,<span class="string">&#x27;åŠªåŠ›&#x27;</span>); <span class="comment">-- æ›¿æ¢å‡ºç°çš„æŒ‡å®šå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">SELECT</span> SUBSTR(<span class="string">&#x27;åšæŒå°±èƒ½æˆåŠŸ&#x27;</span>, <span class="number">5</span>, <span class="number">2</span>); <span class="comment">-- è¿”å›æŒ‡å®šçš„å­å­—ç¬¦ä¸²ï¼ˆæºå­—ç¬¦ä¸²ï¼Œæˆªå–çš„ä½ç½®ï¼Œæˆªå–çš„é•¿åº¦ï¼‰</span></span><br><span class="line"><span class="keyword">SELECT</span> REVERSE(<span class="string">&#x27;æ¸…æ™¨æˆ‘ä¸Šé©¬&#x27;</span>); <span class="comment">-- åè½¬</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ—¶é—´å’Œæ—¥æœŸå‡½æ•°ï¼ˆè®°ä½ï¼ï¼‰</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">CURRENT_DATE</span>(); <span class="comment">-- è·å–å½“å‰æ—¥æœŸ</span></span><br><span class="line"><span class="keyword">SELECT</span> CURDATE(); <span class="comment">-- è·å–å½“å‰æ—¥æœŸ</span></span><br><span class="line"><span class="keyword">SELECT</span> NOW(); <span class="comment">-- è·å–å½“å‰çš„æ—¶é—´</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">LOCALTIME</span>(); <span class="comment">-- è·å–æœ¬åœ°æ—¶é—´</span></span><br><span class="line"><span class="keyword">SELECT</span> SYSDATE(); <span class="comment">-- è·å–ç³»ç»Ÿæ—¶é—´</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">YEAR</span>(NOW()); <span class="comment">-- å¹´</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MONTH</span>(NOW()); <span class="comment">-- æœˆ</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DAY</span>(NOW()); <span class="comment">-- æ—¥</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">HOUR</span>(NOW()); <span class="comment">-- æ—¶</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MINUTE</span>(NOW()); <span class="comment">-- åˆ†</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SECOND</span>(NOW()); <span class="comment">-- ç§’</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- ç³»ç»Ÿ</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SYSTEM_USER</span>();</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">USER</span>();</span><br><span class="line"><span class="keyword">SELECT</span> VERSION();</span><br></pre></td></tr></table></figure><h3 id="5-2-èšåˆå‡½æ•°ï¼ˆå¸¸ç”¨ï¼‰"><a href="#5-2-èšåˆå‡½æ•°ï¼ˆå¸¸ç”¨ï¼‰" class="headerlink" title="5.2 èšåˆå‡½æ•°ï¼ˆå¸¸ç”¨ï¼‰"></a>5.2 èšåˆå‡½æ•°ï¼ˆå¸¸ç”¨ï¼‰</h3><table><thead><tr><th>å‡½æ•°åç§°</th><th>æè¿°</th></tr></thead><tbody><tr><td>COUNT()</td><td>æŠ€æœ¯</td></tr><tr><td>SUM()</td><td>æ±‚å’Œ</td></tr><tr><td>AVG()</td><td>å¹³å‡å€¼</td></tr><tr><td>MAX()</td><td>æœ€å¤§å€¼</td></tr><tr><td>MIN()</td><td>æœ€å°å€¼</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- èšåˆå‡½æ•°</span></span><br><span class="line"><span class="comment">-- éƒ½èƒ½ç»Ÿè®¡ è¡¨ä¸­æ•°æ®</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- count(å­—æ®µ) ä¼šå¿½ç•¥æ‰€æœ‰çš„nullå€¼(æƒ³æŸ¥è¯¢ä¸€ä¸ªè¡¨ä¸­æœ‰å¤šå°‘ä¸ªè®°å½•ï¼Œå°±ä½¿ç”¨è¿™ä¸ªcount())</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(student_name) <span class="keyword">FROM</span> student;</span><br><span class="line"><span class="comment">-- COUNT(*) ä¸ä¼šå¿½ç•¥æ‰€æœ‰çš„nullå€¼ æœ¬è´¨è®¡ç®—è¡Œæ•°</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> student;</span><br><span class="line"><span class="comment">-- COUNT(1) ä¸ä¼šå¿½ç•¥æ‰€æœ‰çš„nullå€¼ æœ¬è´¨è®¡ç®—è¡Œæ•°</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="number">1</span>) <span class="keyword">FROM</span> student;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(student_result) <span class="keyword">AS</span> <span class="string">&#x27;æ€»å’Œ&#x27;</span> <span class="keyword">FROM</span> <span class="keyword">result</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(student_result) <span class="keyword">AS</span> <span class="string">&#x27;å¹³å‡åˆ†&#x27;</span> <span class="keyword">FROM</span> <span class="keyword">result</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(student_result) <span class="keyword">AS</span> <span class="string">&#x27;æœ€é«˜åˆ†&#x27;</span> <span class="keyword">FROM</span> <span class="keyword">result</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(student_result) <span class="keyword">AS</span> <span class="string">&#x27;æœ€ä½åˆ†&#x27;</span> <span class="keyword">FROM</span> <span class="keyword">result</span>;</span><br></pre></td></tr></table></figure><h3 id="5-3-æ•°æ®åº“çº§åˆ«çš„MD5åŠ å¯†ï¼ˆæ‹“å±•ï¼‰"><a href="#5-3-æ•°æ®åº“çº§åˆ«çš„MD5åŠ å¯†ï¼ˆæ‹“å±•ï¼‰" class="headerlink" title="5.3 æ•°æ®åº“çº§åˆ«çš„MD5åŠ å¯†ï¼ˆæ‹“å±•ï¼‰"></a>5.3 æ•°æ®åº“çº§åˆ«çš„MD5åŠ å¯†ï¼ˆæ‹“å±•ï¼‰</h3><p>ä»€ä¹ˆæ˜¯MD5?</p><p>ä¸»è¦å¢åŠ ç®—æ³•å¤æ‚åº¦å’Œä¸å¯é€†æ€§ã€‚</p><p>MD5ä¸å¯é€†ï¼Œå…·ä½“çš„å€¼çš„md5æ˜¯ä¸€æ ·çš„</p><p>MD5ç ´è§£ç½‘ç«™çš„åŸç†ï¼ŒèƒŒåæœ‰ä¸€ä¸ªå­—å…¸ï¼ŒMD5åŠ å¯†åçš„å€¼ï¼ŒåŠ å¯†å‰çš„å€¼</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `testmd5`(</span><br><span class="line">  `id` <span class="type">INT</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `name` <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `pwd` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">)ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ˜æ–‡å¯†ç </span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `testmd5`(`id`,`name`,`pwd`)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">1</span>,<span class="string">&#x27;å¼ ä¸‰&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>),</span><br><span class="line">(<span class="number">2</span>,<span class="string">&#x27;æå››&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>),</span><br><span class="line">(<span class="number">3</span>,<span class="string">&#x27;ç‹äº”&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> `testmd5`;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åŠ å¯†</span></span><br><span class="line"><span class="keyword">UPDATE</span> testmd5 <span class="keyword">SET</span> pwd<span class="operator">=</span>MD5(pwd) <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ’å…¥çš„æ—¶å€™åŠ å¯†</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `testmd5`(`id`,`name`,`pwd`)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">4</span>,<span class="string">&#x27;å°æ˜&#x27;</span>,MD5(<span class="string">&#x27;123456&#x27;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å¦‚ä½•æ ¡éªŒï¼Œå°†ç”¨æˆ·ä¼ é€’è¿›æ¥çš„å¯†ç ï¼Œè¿›è¡ŒMD5åŠ å¯†ï¼Œç„¶åæ¯”å¯¹åŠ å¯†åçš„å€¼</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> `testmd5` <span class="keyword">WHERE</span> `name`<span class="operator">=</span><span class="string">&#x27;å°æ˜&#x27;</span> <span class="keyword">AND</span> pwd <span class="operator">=</span> MD5(<span class="string">&#x27;123456&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="6ã€äº‹åŠ¡"><a href="#6ã€äº‹åŠ¡" class="headerlink" title="6ã€äº‹åŠ¡"></a>6ã€äº‹åŠ¡</h2><h3 id="1-ä»€ä¹ˆæ˜¯äº‹åŠ¡"><a href="#1-ä»€ä¹ˆæ˜¯äº‹åŠ¡" class="headerlink" title="1.ä»€ä¹ˆæ˜¯äº‹åŠ¡"></a>1.ä»€ä¹ˆæ˜¯äº‹åŠ¡</h3><p>&#x3D;&#x3D;è¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥&#x3D;&#x3D;</p><p>å°†ä¸€ç»„sqlæ”¾åˆ°ä¸€ä¸ªæ‰¹æ¬¡ä¸­å–æ‰§è¡Œ</p><blockquote><p>äº‹åŠ¡åŸåˆ™ï¼šACIDåŸåˆ™ åŸå­æ€§ ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§ ï¼ˆè„è¯»ï¼Œå¹»è¯»ã€‚ã€‚ã€‚ï¼‰</p></blockquote><p>å‚è€ƒåšå®¢é“¾æ¥ï¼š<a href="https://gitee.com/link?target=https://blog.csdn.net/dengjili/article/details/82468576">äº‹åŠ¡ACIDç†è§£</a></p><p><strong>åŸå­æ€§ï¼ˆAtomicityï¼‰</strong></p><p>è¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥</p><p><strong>ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰</strong></p><p>äº‹åŠ¡å‰åçš„æ•°æ®å®Œæ•´æ€§è¦ä¿æŒä¸€è‡´</p><p>ä¸‹å›¾æ“ä½œå‰å’Œæ“ä½œåçš„æ€»å’Œéƒ½æ˜¯1000</p><p><strong>éš”ç¦»æ€§ï¼ˆIsolationï¼‰</strong></p><p>äº‹åŠ¡çš„éš”ç¦»æ€§æ˜¯å¤šä¸ªç”¨æˆ·å¹¶å‘è®¿é—®æ•°æ®åº“æ—¶ï¼Œæ•°æ®åº“ä¸ºæ¯ä¸€ä¸ªç”¨æˆ·å¼€å¯çš„äº‹åŠ¡ï¼Œä¸èƒ½è¢«å…¶ä»–äº‹åŠ¡çš„æ“ä½œæ•°æ®æ‰€å¹²æ‰°ï¼Œå¤šä¸ªå¹¶å‘äº‹åŠ¡ä¹‹é—´è¦ç›¸äº’éš”ç¦»ã€‚</p><p><strong>æŒä¹…æ€§ï¼ˆDurabilityï¼‰</strong></p><p>äº‹åŠ¡ä¸€æ—¦ç§»äº¤ä¸å¯é€†ï¼Œè¢«æŒä¹…åŒ–åˆ°æ•°æ®åº“ä¸­</p><blockquote><p>éš”ç¦»æ‰€å¯¼è‡´çš„ä¸€äº›é—®é¢˜</p></blockquote><p><strong>è„è¯»ï¼š</strong></p><p><strong>æŒ‡ä¸€ä¸ªäº‹åŠ¡è¯»å–åˆ°å¦ä¸€ä¸ªäº‹åŠ¡æœªæäº¤çš„æ•°æ®ã€‚</strong></p><p><strong>ä¸å¯é‡å¤è¯»ï¼š</strong></p><p>åœ¨ä¸€ä¸ªäº‹åŠ¡å†…è¯»å–è¡¨ä¸­çš„æŸä¸€è¡Œæ•°æ®ï¼Œå¤šæ¬¡è¯»å–ç»“æœä¸åŒã€‚ï¼ˆè¿™ä¸ªä¸ä¸€å®šæ˜¯é”™è¯¯ï¼Œåªæ˜¯æŸäº›åœºåˆä¸å¯¹ï¼‰</p><p><strong>è™šè¯»(å¹»è¯»)</strong></p><p>æ˜¯æŒ‡åœ¨ä¸€ä¸ªäº‹åŠ¡å†…è¯»å–åˆ°åˆ«äººçš„äº‹åŠ¡æ’å…¥çš„æ•°æ®ï¼Œå¯¼è‡´å‰åè¯»å–ä¸ä¸€è‡´ã€‚</p><h3 id="2-æ‰§è¡Œäº‹åŠ¡"><a href="#2-æ‰§è¡Œäº‹åŠ¡" class="headerlink" title="2. æ‰§è¡Œäº‹åŠ¡"></a>2. æ‰§è¡Œäº‹åŠ¡</h3><p>MySQLäº‹åŠ¡</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- äº‹åŠ¡</span></span><br><span class="line"><span class="comment">-- mysql æ˜¯é»˜è®¤å¼€å¯äº‹åŠ¡è‡ªåŠ¨æäº¤</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- å…³é—­</span></span><br><span class="line"><span class="keyword">SET</span> autocommit <span class="operator">=</span> <span class="number">0</span>; </span><br><span class="line"><span class="comment">-- å¼€å¯ï¼ˆé»˜è®¤çš„ï¼‰</span></span><br><span class="line"><span class="keyword">SET</span> autocommit <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ‰‹åŠ¨å¤„ç†äº‹åŠ¡</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> autocommit <span class="operator">=</span> <span class="number">0</span>;  <span class="comment">-- å…³é—­è‡ªåŠ¨æäº¤</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- äº‹åŠ¡å¼€å¯</span></span><br><span class="line"><span class="keyword">START</span> TRANSACTION;  <span class="comment">-- æ ‡è®°ä¸€ä¸ªäº‹åŠ¡çš„å¼€å§‹ï¼Œä»è¿™ä¸ªä¹‹åçš„sqléƒ½åœ¨åŒä¸€ä¸ªäº‹åŠ¡å†…</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> XX</span><br><span class="line"><span class="keyword">INSERT</span> XX</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æäº¤ ï¼š æŒä¹…åŒ–</span></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line"><span class="comment">-- å›æ»š ï¼š å›åˆ°çš„åŸæ¥çš„æ ·å­ï¼ˆå¤±è´¥ï¼‰</span></span><br><span class="line"><span class="keyword">ROLLBACK</span>;</span><br><span class="line"><span class="comment">-- äº‹åŠ¡ç»“æŸ</span></span><br><span class="line"><span class="keyword">SET</span> autocommit <span class="operator">=</span> <span class="number">1</span>; <span class="comment">-- å¼€å¯è‡ªåŠ¨æäº¤</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- äº†è§£</span></span><br><span class="line"><span class="keyword">SAVEPOINT</span> ä¿å­˜ç‚¹å <span class="comment">-- è®¾ç½®ä¸€ä¸ªäº‹åŠ¡çš„ä¿å­˜ç‚¹</span></span><br><span class="line"><span class="keyword">ROLLBACK</span> <span class="keyword">TO</span> <span class="keyword">SAVEPOINT</span> ä¿å­˜ç‚¹å <span class="comment">-- å›æ»šåˆ°ä¿å­˜ç‚¹</span></span><br><span class="line"><span class="keyword">RELEASE</span> <span class="keyword">SAVEPOINT</span> ä¿å­˜ç‚¹å <span class="comment">-- æ’¤é”€ä¿å­˜ç‚¹</span></span><br></pre></td></tr></table></figure><p>æ¡ˆä¾‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- è½¬å¸æ¡ˆä¾‹</span></span><br><span class="line"><span class="keyword">CREATE</span> DATABASE shop <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci</span><br><span class="line">USE shop</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `account`(</span><br><span class="line">`id` <span class="type">INT</span>(<span class="number">3</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">`name` <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`money` <span class="type">DECIMAL</span>(<span class="number">9</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY(`id`)</span><br><span class="line">)ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> account(`name`,`money`)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;A&#x27;</span>,<span class="number">2000.00</span>),(<span class="string">&#x27;B&#x27;</span>,<span class="number">10000.00</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ¨¡æ‹Ÿè½¬è´¦äº‹åŠ¡</span></span><br><span class="line"><span class="keyword">SET</span> autocommit <span class="operator">=</span> <span class="number">0</span>; <span class="comment">-- å…³é—­è‡ªåŠ¨æäº¤</span></span><br><span class="line"><span class="keyword">START</span> TRANSACTION  <span class="comment">-- å¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼ˆä¸€ç»„äº‹åŠ¡ï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> money<span class="operator">=</span>money<span class="number">-500</span> <span class="keyword">WHERE</span> `name`<span class="operator">=</span><span class="string">&#x27;A&#x27;</span> <span class="comment">-- A-500</span></span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> money<span class="operator">=</span>money<span class="operator">+</span><span class="number">500</span> <span class="keyword">WHERE</span> `name`<span class="operator">=</span><span class="string">&#x27;B&#x27;</span> <span class="comment">-- B+500</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COMMIT</span>; <span class="comment">-- æäº¤äº‹åŠ¡</span></span><br><span class="line"><span class="keyword">ROLLBACK</span>; <span class="comment">-- å›æ»š</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> autocommit<span class="operator">=</span><span class="number">1</span>; <span class="comment">-- æ¢å¤é»˜è®¤å€¼</span></span><br></pre></td></tr></table></figure><h2 id="7ã€ç´¢å¼•"><a href="#7ã€ç´¢å¼•" class="headerlink" title="7ã€ç´¢å¼•"></a>7ã€ç´¢å¼•</h2><blockquote><p>Msqlå®˜æ–¹å¯¹ç´¢å¼•çš„å®šä¹‰ä¸ºï¼š<strong>ç´¢å¼•ï¼ˆindexï¼‰æ˜¯å¸®åŠ©MySQLé«˜æ•ˆè·å–æ•°æ®çš„æ•°æ®ç»“æ„</strong>ã€‚</p><p>æå–å¥å­ä¸»å¹²ï¼Œå°±å¯ä»¥å¾—åˆ°ç´¢å¼•çš„æœ¬è´¨ï¼šç´¢å¼•æ˜¯æ•°æ®ç»“æ„ã€‚</p></blockquote><h3 id="1-ç´¢å¼•çš„åˆ†ç±»"><a href="#1-ç´¢å¼•çš„åˆ†ç±»" class="headerlink" title="1.ç´¢å¼•çš„åˆ†ç±»"></a>1.ç´¢å¼•çš„åˆ†ç±»</h3><blockquote><p>åœ¨ä¸€ä¸ªè¡¨ä¸­ï¼Œä¸»é”®ç´¢å¼•åªèƒ½æœ‰ä¸€ä¸ªï¼Œå”¯ä¸€ç´¢å¼•å¯ä»¥æœ‰å¤šä¸ª</p></blockquote><ul><li>ä¸»é”®ç´¢å¼•ï¼ˆprimary keyï¼‰<ul><li>å”¯ä¸€çš„æ ‡è¯†ï¼Œä¸»é”®ä¸å¯é‡å¤ï¼Œåªèƒ½æœ‰ä¸€ä¸ªåˆ—ä½œä¸ºä¸»é”®</li></ul></li><li>å”¯ä¸€ç´¢å¼• ï¼ˆunique keyï¼‰<ul><li>é¿å…é‡å¤çš„åˆ—å‡ºç°ï¼Œå¯ä»¥é‡å¤ï¼Œå¤šä¸ªåˆ—éƒ½å¯ä»¥æ ‡ç¤ºä¸ºå”¯ä¸€ç´¢å¼•</li></ul></li><li>å¸¸è§„ç´¢å¼•ï¼ˆkey&#x2F;indexï¼‰<ul><li>é»˜è®¤çš„ index æˆ–è€…keyå…³é”®å­—æ¥è®¾ç½®</li></ul></li><li>å…¨æ–‡ç´¢å¼•ï¼ˆFullTextï¼‰<ul><li>åœ¨ç‰¹å®šçš„æ•°æ®åº“å¼•æ“ä¸‹æ‰æœ‰ï¼Œmyisam</li><li>å¿«é€Ÿå®šä½æ•°æ®</li></ul></li></ul><p>åŸºç¡€è¯­æ³•</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ç´¢å¼•çš„ä½¿ç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 1.åœ¨åˆ›å»ºè¡¨çš„æ—¶å€™ç»™å­—æ®µå¢åŠ ç´¢å¼•</span></span><br><span class="line"><span class="comment">-- 2.åˆ›å»ºå®Œæ¯•åï¼Œå¢åŠ ç´¢å¼•</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ˜¾ç¤ºæ‰€æœ‰çš„ç´¢å¼•ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">SHOW</span> INDEX <span class="keyword">FROM</span> student;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ–°å¢ä¸€ä¸ªç´¢å¼• (ç´¢å¼•å) åˆ—å</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `student` <span class="keyword">ADD</span> <span class="keyword">UNIQUE</span> KEY `UK_IDENTITY_CARD` (`identity_card`);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `student` <span class="keyword">ADD</span> KEY `K_STUDENT_NAME`(`student_name`);</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> `student`  <span class="keyword">ADD</span> FULLTEXT INDEX `FI_PHONE` (`phone`);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- explain åˆ†æsqlæ‰§è¡Œçš„çŠ¶å†µ</span></span><br><span class="line"></span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student; <span class="comment">-- éå…¨æ–‡ç´¢å¼•</span></span><br><span class="line"></span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> <span class="keyword">MATCH</span>(`phone`) AGAINST(<span class="string">&#x27;138&#x27;</span>); <span class="comment">-- å…¨æ–‡ç´¢å¼•</span></span><br></pre></td></tr></table></figure><p><a href="https://gitee.com/link?target=https://blog.csdn.net/jiadajing267/article/details/81269067">ã€MySQLä¼˜åŒ–ã€‘â€”â€”çœ‹æ‡‚explain_æ¼«æ¼«é•¿é€”ï¼Œç»ˆæœ‰å›è½¬ï¼›ä½™å‘³è‹¦æ¶©ï¼Œç»ˆæœ‰å›ç”˜-CSDNåšå®¢_explain</a></p><h3 id="2-ç´¢å¼•çš„æµ‹è¯•"><a href="#2-ç´¢å¼•çš„æµ‹è¯•" class="headerlink" title="2. ç´¢å¼•çš„æµ‹è¯•"></a>2. ç´¢å¼•çš„æµ‹è¯•</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span>æµ‹è¯•ç´¢å¼•<span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> app_user(</span><br><span class="line">`id` <span class="type">BIGINT</span>(<span class="number">20</span>) UNSIGNED <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ID&#x27;</span>,</span><br><span class="line">`name` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;ç”¨æˆ·æ˜µç§°&#x27;</span>,</span><br><span class="line">`email` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç”¨æˆ·é‚®ç®±&#x27;</span>,</span><br><span class="line">`phone` <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;æ‰‹æœºå·&#x27;</span>,</span><br><span class="line">`gender` TINYINT(<span class="number">4</span>) UNSIGNED <span class="keyword">DEFAULT</span><span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;æ€§åˆ«ï¼ˆ0ï¼šç”· 1ï¼šå¥³ï¼‰&#x27;</span>,</span><br><span class="line">`password` <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¯†ç &#x27;</span>,</span><br><span class="line">`age` TINYINT(<span class="number">4</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;å¹´é¾„&#x27;</span>,</span><br><span class="line">`creat_time` DATETIME <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">`update_time`<span class="type">TIMESTAMP</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line"><span class="keyword">PRIMARY</span> KEY(`id`)</span><br><span class="line">)ENGINE<span class="operator">=</span>INNODB <span class="keyword">DEFAULT</span> CHARSET <span class="operator">=</span> utf8mb4 COMMENT<span class="operator">=</span><span class="string">&#x27;appç”¨æˆ·è¡¨&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span>æ’å…¥ç™¾wæ¡æ•°æ®<span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span></span><br><span class="line">DELIMITER $$ <span class="comment">-- å†™å‡½æ•°ä¹‹å‰å¿…é¡»è¦å†™ï¼Œæ ‡å¿—</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> mock_data()</span><br><span class="line"><span class="keyword">RETURNS</span> <span class="type">INT</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">DECLARE</span> num <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1000000</span>;</span><br><span class="line"><span class="keyword">DECLARE</span> i <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line">WHILE i<span class="operator">&lt;</span>num DO</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> app_user(`name`,`email`,`phone`,`gender`,`password`,`age`)</span><br><span class="line"><span class="keyword">VALUES</span>(concat(<span class="string">&#x27;ç”¨æˆ·&#x27;</span>,i),<span class="string">&#x27;mysql.jiuzhe@gmail.com&#x27;</span>,CONCAT(<span class="string">&#x27;18&#x27;</span>,<span class="built_in">FLOOR</span>(RAND()<span class="operator">*</span>((<span class="number">99999999</span><span class="number">-10000000</span>)<span class="operator">+</span><span class="number">10000000</span>))),<span class="built_in">FLOOR</span>(RAND()<span class="operator">*</span><span class="number">2</span>),UUID(),<span class="built_in">FLOOR</span>(RAND()<span class="operator">*</span><span class="number">100</span>));</span><br><span class="line"><span class="keyword">SET</span> i<span class="operator">=</span>i<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">END</span> WHILE;</span><br><span class="line"><span class="keyword">RETURN</span> i;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ‰§è¡Œå‡½æ•°</span></span><br><span class="line"><span class="keyword">SELECT</span> mock_data();</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> app_user;</span><br><span class="line"></span><br><span class="line"><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span>æµ‹è¯•<span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span></span><br><span class="line"><span class="comment">-- åŠ ç´¢å¼•å‰</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> app_user <span class="keyword">WHERE</span> `name` <span class="operator">=</span> <span class="string">&#x27;ç”¨æˆ·9999&#x27;</span>; <span class="comment">-- 0.5s</span></span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> app_user <span class="keyword">WHERE</span> `name` <span class="operator">=</span> <span class="string">&#x27;ç”¨æˆ·9999&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ›å»ºç´¢å¼•</span></span><br><span class="line"><span class="comment">-- id_è¡¨å_å­—æ®µå ç´¢å¼•å</span></span><br><span class="line"><span class="comment">-- CREATE INDEX ç´¢å¼•å ON è¡¨å(`å­—æ®µå`)</span></span><br><span class="line"><span class="keyword">CREATE</span> INDEX id_app_user_name <span class="keyword">ON</span> app_user(`name`);</span><br><span class="line"><span class="comment">-- åŠ ç´¢å¼•å</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> app_user <span class="keyword">WHERE</span> `name` <span class="operator">=</span> <span class="string">&#x27;ç”¨æˆ·9999&#x27;</span>;</span><br><span class="line">EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> app_user <span class="keyword">WHERE</span> `name` <span class="operator">=</span> <span class="string">&#x27;ç”¨æˆ·9999&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="3-ç´¢å¼•åŸåˆ™"><a href="#3-ç´¢å¼•åŸåˆ™" class="headerlink" title="3. ç´¢å¼•åŸåˆ™"></a>3. ç´¢å¼•åŸåˆ™</h3><ul><li>ç´¢å¼•ä¸æ˜¯è¶Šå¤šè¶Šå¥½</li><li>ä¸è¦å¯¹ç»å¸¸å˜åŠ¨çš„çš„æ•°æ®åŠ ç´¢å¼•</li><li>å°æ•°æ®é‡ä¸éœ€è¦åŠ ç´¢å¼•</li><li>ç´¢å¼•ä¸€èˆ¬åŠ åœ¨å¸¸ç”¨æŸ¥è¯¢çš„å­—æ®µä¸Š</li></ul><blockquote><p>ç´¢å¼•çš„æ•°æ®ç»“æ„</p></blockquote><p>Hashç±»å‹çš„ç´¢å¼•</p><p>Btree:InnoDBçš„é»˜è®¤æ•°æ®ç»“æ„</p><h2 id="8ã€æƒé™ç®¡ç†å’Œå¤‡ä»½"><a href="#8ã€æƒé™ç®¡ç†å’Œå¤‡ä»½" class="headerlink" title="8ã€æƒé™ç®¡ç†å’Œå¤‡ä»½"></a>8ã€æƒé™ç®¡ç†å’Œå¤‡ä»½</h2><h3 id="1-ç”¨æˆ·ç®¡ç†"><a href="#1-ç”¨æˆ·ç®¡ç†" class="headerlink" title="1. ç”¨æˆ·ç®¡ç†"></a>1. ç”¨æˆ·ç®¡ç†</h3><p>å¯è§†åŒ–ç®¡ç†</p><p><img src="https://gitee.com/zhayuyao/img/raw/master/zhayuyao/img/image-20210704145840971.png" alt="img"></p><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220126152641888.png" alt="image-20220126152641888"></p><p>ç”¨æˆ·è¡¨ï¼šmysql.user</p><p>æœ¬è´¨:è¯»è¿™å¼ è¡¨è¿›è¡Œå¢åˆ æ”¹æŸ¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- åˆ›å»ºç”¨æˆ·</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> hrd IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä¿®æ”¹å¯†ç ï¼ˆä¿®æ”¹å½“å‰ç”¨æˆ·å¯†ç ï¼‰</span></span><br><span class="line"><span class="keyword">SET</span> PASSWORD <span class="operator">=</span> PASSWORD(<span class="string">&#x27;123456&#x27;</span>);</span><br><span class="line"><span class="comment">-- ä¿®æ”¹å¯†ç ï¼ˆæŒ‡å®šç”¨æˆ·ï¼‰</span></span><br><span class="line"><span class="keyword">SET</span> PASSWORD <span class="keyword">FOR</span> hrd <span class="operator">=</span> PASSWORD(<span class="string">&#x27;111111&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- é‡å‘½å RENAME åŸåå­ zyy TO æ–°åå­—;</span></span><br><span class="line">RENAME <span class="keyword">USER</span> hrd <span class="keyword">TO</span> newhrd;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ç”¨æˆ·æˆæƒ  ALL PRIVILEGES å…¨éƒ¨çš„æƒé™ï¼Œåº“ï¼Œè¡¨</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- ALL PRIVILEGES é™¤äº†ç»™åˆ«äººæˆæƒä¸è¡Œï¼Œå…¶ä»–éƒ½èƒ½å¹²</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> PRIVILEGES <span class="keyword">ON</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">TO</span> hrd;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æŸ¥è¯¢æƒé™</span></span><br><span class="line"><span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> hrd;<span class="comment">-- æŸ¥çœ‹æŒ‡å®šç”¨æˆ·çš„æƒé™</span></span><br><span class="line"><span class="keyword">SHOW</span> GRANTS <span class="keyword">FOR</span> root<span class="variable">@localhost</span>; <span class="comment">-- æŸ¥çœ‹rootç”¨æˆ·çš„æƒé™</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ’¤é”€æƒé™ REVOKEå“ªäº›æƒé™ï¼Œåœ¨å“ªä¸ªåº“ï¼Œç»™è°æ’¤é”€</span></span><br><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">ALL</span> PRIVILEGES <span class="keyword">ON</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">FROM</span> hrd;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ é™¤ç”¨æˆ·</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">USER</span> hrd;</span><br></pre></td></tr></table></figure><h3 id="2-MySQLå¤‡ä»½"><a href="#2-MySQLå¤‡ä»½" class="headerlink" title="2. MySQLå¤‡ä»½"></a>2. MySQLå¤‡ä»½</h3><p>ä¸ºä»€ä¹ˆè¦å¤‡ä»½ï¼Ÿ</p><ul><li>ä¿è¯é‡è¦çš„æ•°æ®ä¸ä¸¢å¤±</li><li>æ•°æ®è½¬ç§»</li></ul><p>mysqlæ•°æ®åº“å¤‡ä»½çš„æ–¹å¼</p><ul><li>ç›´æ¥æ‹·è´ç‰©ç†æ–‡ä»¶</li><li>åœ¨sqlyogè¿™ç§å¯è§†åŒ–å·¥å…·ä¸­æ‰‹åŠ¨å¯¼å‡º<ul><li>åœ¨æƒ³è¦å¯¼å‡ºçš„è¡¨æˆ–è€…åº“ä¸­ï¼Œå³é”®ï¼Œ</li></ul></li></ul><p><img src="https://gitee.com/zhayuyao/img/raw/master/zhayuyao/img/image-20210704155338509.png" alt="img"></p><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220126171042582.png" alt="image-20220126171042582"></p><p>ä½¿ç”¨å‘½ä»¤è¡Œå¯¼å‡º mysqldump å‘½ä»¤è¡Œä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># ä¸€å¼ è¡¨ mysqldump -hä¸»æœº -uç”¨æˆ·å -på¯†ç  æ•°æ®åº“ è¡¨å &gt;ç‰©ç†ç£ç›˜ä½ç½®/æ–‡ä»¶å</span><br><span class="line">mysqldump -hlocalhost -uroot -p123456 school student &gt;D:/a.sql</span><br><span class="line"></span><br><span class="line"># å¤šå¼ è¡¨ mysqldump -hä¸»æœº -uç”¨æˆ·å -på¯†ç  æ•°æ®åº“ è¡¨å1 è¡¨å2 &gt;ç‰©ç†ç£ç›˜ä½ç½®/æ–‡ä»¶å</span><br><span class="line">mysqldump -hlocalhost -uroot -p123456 school student result &gt;D:/a.sql</span><br><span class="line"></span><br><span class="line"># æ•°æ®åº“ mysqldump -hä¸»æœº -uç”¨æˆ·å -på¯†ç  æ•°æ®åº“ &gt;ç‰©ç†ç£ç›˜ä½ç½®/æ–‡ä»¶å</span><br><span class="line">mysqldump -hlocalhost -uroot -p123456 school &gt;D:/a.sql</span><br><span class="line"></span><br><span class="line"># å¯¼å…¥</span><br><span class="line"># ç™»å½•çš„æƒ…å†µä¸‹ï¼Œåˆ‡æ¢åˆ°æŒ‡å®šçš„æ•°æ®åº“</span><br><span class="line"># source å¤‡ä»½æ–‡ä»¶</span><br><span class="line"># ä¹Ÿå¯ä»¥è¿™æ ·</span><br><span class="line">mysql -uç”¨æˆ·å -på¯†ç  åº“å&lt;å¤‡ä»½æ–‡ä»¶</span><br></pre></td></tr></table></figure><p>å‡è®¾ä½ è¦å¤‡ä»½æ•°æ®åº“ï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±ã€‚</p><p>æŠŠæ•°æ®åº“ç»™åˆ«äººï¼Œç›´æ¥ç»™sqlå³å¯ã€‚</p><h2 id="9ã€è§„èŒƒæ•°æ®åº“è®¾è®¡"><a href="#9ã€è§„èŒƒæ•°æ®åº“è®¾è®¡" class="headerlink" title="9ã€è§„èŒƒæ•°æ®åº“è®¾è®¡"></a>9ã€è§„èŒƒæ•°æ®åº“è®¾è®¡</h2><h3 id="1-é¡¹ç›®æ•°æ®åº“"><a href="#1-é¡¹ç›®æ•°æ®åº“" class="headerlink" title="1.é¡¹ç›®æ•°æ®åº“"></a>1.é¡¹ç›®æ•°æ®åº“</h3><p>å½“æ•°æ®åº“æ¯”è¾ƒå¤æ‚çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦è®¾è®¡äº†ã€‚</p><p><strong>ç³Ÿç³•çš„æ•°æ®åº“è®¾è®¡</strong></p><ul><li>æ•°æ®å†—ä½™ï¼Œæµªè´¹ç©ºé—´</li><li>æ•°æ®åº“æ’å…¥å’Œåˆ é™¤éƒ½ä¼šéº»çƒ¦ã€å¼‚å¸¸ï¼ˆå±è”½ä½¿ç”¨ç‰©ç†å¤–é”®ï¼‰</li><li>ç¨‹åºçš„æ€§èƒ½å·®</li></ul><p><strong>è‰¯å¥½çš„æ•°æ®åº“è®¾è®¡</strong></p><ul><li>èŠ‚çœå†…å­˜ç©ºé—´</li><li>ä¿è¯æ•°æ®åº“çš„å®Œæ•´æ€§</li><li>æ–¹ä¾¿æˆ‘ä»¬å¼€å‘ç³»ç»Ÿ</li></ul><p><strong>è½¯ä»¶å¼€å‘ä¸­ï¼Œå…³äºæ•°æ®åº“çš„è®¾è®¡</strong></p><ul><li>åˆ†æéœ€æ±‚ï¼Œåˆ†æä¸šåŠ¡å’Œéœ€è¦å¤„ç†çš„æ•°æ®åº“çš„éœ€æ±‚</li><li>æ¦‚è¦è®¾è®¡ï¼šè®¾è®¡å…³ç³»å›¾E-Rå›¾</li></ul><p><strong>è®¾è®¡æ•°æ®åº“çš„æ­¥éª¤ï¼ˆä¸ªäººåšå®¢ï¼‰</strong></p><ul><li><p>æ”¶é›†ä¿¡æ¯ï¼Œåˆ†æéœ€æ±‚</p><ul><li><p>ç”¨æˆ·è¡¨ï¼ˆç”¨æˆ·ç™»å½•æ³¨é”€ï¼Œç”¨æˆ·çš„ä¸ªäººä¿¡æ¯ï¼Œå†™åšå®¢ï¼Œåˆ›å»ºåˆ†ç±»ï¼‰</p><p><img src="https://gitee.com/zhayuyao/img/raw/master/zhayuyao/img/image-20210704162821445.png" alt="image-20210704162821445"></p></li><li><p>åˆ†ç±»è¡¨ï¼ˆæ–‡ç« åˆ†ç±»ï¼Œè°åˆ›å»ºçš„ï¼‰</p><p><img src="https://gitee.com/zhayuyao/img/raw/master/zhayuyao/img/image-20210704163120753.png" alt="image-20210704163120753"></p></li><li><p>æ–‡ç« è¡¨ï¼ˆæ–‡ç« ä¿¡æ¯ï¼‰</p><p><img src="https://gitee.com/zhayuyao/img/raw/master/zhayuyao/img/image-20210704164131400.png" alt="image-20210704164131400"></p></li><li><p>è¯„è®ºè¡¨</p><p><img src="https://gitee.com/zhayuyao/img/raw/master/zhayuyao/img/image-20210704164555263.png" alt="image-20210704164555263"></p></li><li><p>å‹é“¾è¡¨ï¼ˆå‹æƒ…é“¾æ¥ä¿¡æ¯ï¼‰</p><p><img src="https://gitee.com/zhayuyao/img/raw/master/zhayuyao/img/image-20210704164938625.png" alt="image-20210704164938625"></p></li><li><p>è‡ªå®šä¹‰è¡¨ï¼ˆç³»ç»Ÿä¿¡æ¯ï¼ŒæŸä¸ªå…³é”®çš„å­—ï¼Œæˆ–è€…ä¸€äº›ä¸»å­—æ®µï¼‰ <code>key:value</code></p></li><li><p>å…³æ³¨è¡¨(ç²‰ä¸æ•°)</p><p><img src="https://gitee.com/zhayuyao/img/raw/master/zhayuyao/img/image-20210704165556127.png" alt="image-20210704165556127"></p></li><li><p>è¯´è¯´è¡¨ï¼ˆå‘è¡¨å¿ƒæƒ…ï¼Œ idâ€¦contentâ€¦create_timeï¼‰</p></li></ul></li><li><p>æ ‡è¯†å®ä½“ï¼ˆæŠŠéœ€æ±‚è½åˆ°æ¯ä¸ªå­—æ®µï¼‰</p></li><li><p>æ ‡è¯†å®ä½“ä¹‹é—´çš„å…³ç³»</p><ul><li>å†™åšå®¢ï¼šuser â€“&gt; blog</li><li>åˆ›å»ºåˆ†ç±»ï¼šuser â€“&gt; category</li><li>å…³æ³¨ï¼šuser â€“&gt; user</li><li>å‹é“¾ï¼šlinks</li><li>è¯„è®ºï¼šuser â€“&gt; user â€“&gt; blog</li></ul></li></ul><p>(bbs &#x2F; crm)</p><h3 id="2-ä¸‰å¤§èŒƒå¼"><a href="#2-ä¸‰å¤§èŒƒå¼" class="headerlink" title="2. ä¸‰å¤§èŒƒå¼"></a>2. ä¸‰å¤§èŒƒå¼</h3><p><strong>ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®è§„èŒƒåŒ–ï¼Ÿ</strong></p><ul><li>ä¿¡æ¯é‡å¤</li><li>æ›´æ–°å¼‚å¸¸</li><li>æ’å…¥å¼‚å¸¸<ul><li>æ— æ³•æ­£å¸¸æ˜¾ç¤ºä¿¡æ¯</li></ul></li><li>åˆ é™¤å¼‚å¸¸<ul><li>ä¸¢å¤±æœ‰æ•ˆçš„ä¿¡æ¯</li></ul></li></ul><blockquote><p>ä¸‰å¤§èŒƒå¼</p></blockquote><p><strong>ç¬¬ä¸€èŒƒå¼ï¼ˆ1NFï¼‰</strong></p><p>åŸå­æ€§ï¼šä¿è¯æ¯ä¸€åˆ—ä¸å¯å†åˆ†</p><p><strong>ç¬¬äºŒèŒƒå¼ï¼ˆ2NFï¼‰</strong></p><p>å‰æï¼šæ»¡è¶³ç¬¬ä¸€èŒƒå¼</p><p>ç¬¬äºŒèŒƒå¼éœ€è¦ç¡®ä¿æ•°æ®åº“è¡¨ä¸­çš„æ¯ä¸€åˆ—éƒ½å’Œä¸»é”®ç›¸å…³ï¼Œè€Œä¸èƒ½åªä¸ä¸»é”®çš„æŸä¸€éƒ¨åˆ†ç›¸å…³ï¼ˆä¸»è¦é’ˆå¯¹è”åˆä¸»é”®è€Œè¨€ï¼‰ã€‚</p><p>æ¯å¼ è¡¨åªæè¿°ä¸€ä»¶äº‹æƒ…</p><p><strong>ç¬¬ä¸‰èŒƒå¼ï¼ˆ3NFï¼‰</strong></p><p>å‰æï¼šæ»¡è¶³ç¬¬ä¸€èŒƒå¼å’Œç¬¬äºŒèŒƒå¼</p><p>ç¬¬ä¸‰èŒƒå¼éœ€è¦ç¡®ä¿æ•°æ®è¡¨ä¸­çš„æ¯ä¸€åˆ—æ•°æ®éƒ½å’Œä¸»é”®ç›´æ¥ç›¸å…³ï¼Œè€Œä¸èƒ½é—´æ¥ç›¸å…³ã€‚</p><p>è§„èŒƒæ•°æ®åº“çš„è®¾è®¡</p><p><strong>è§„èŒƒæ€§å’Œæ€§èƒ½çš„é—®é¢˜</strong></p><p>å…³è”æŸ¥è¯¢çš„è¡¨ä¸å¾—è¶…è¿‡ä¸‰å¼ è¡¨</p><ul><li>è€ƒè™‘å•†ä¸šåŒ–çš„éœ€æ±‚å’Œç›®æ ‡ï¼ˆæˆæœ¬ï¼Œç”¨æˆ·ä½“éªŒï¼‰æ•°æ®åº“çš„æ€§èƒ½æ›´åŠ é‡è¦</li><li>åœ¨è§„èŒƒæ€§èƒ½çš„é—®é¢˜çš„æ—¶å€™ï¼Œéœ€è¦é€‚å½“çš„è€ƒè™‘ä¸€ä¸‹è§„èŒƒæ€§</li><li>æ•…æ„ç»™æŸäº›è¡¨å¢åŠ ä¸€äº›å†—ä½™çš„å­—æ®µã€‚ï¼ˆä»å¤šè¡¨æŸ¥è¯¢ä¸­å˜ä¸ºå•è¡¨æŸ¥è¯¢ï¼‰</li><li>æ•…æ„å¢åŠ ä¸€äº›è®¡ç®—åˆ—ï¼ˆä»å¤§æ•°æ®åº“é™ä½ä¸ºå°æ•°æ®é‡çš„æŸ¥è¯¢ï¼šç´¢å¼•ï¼‰</li></ul><h2 id="10ã€JDBC-é‡ç‚¹"><a href="#10ã€JDBC-é‡ç‚¹" class="headerlink" title="10ã€JDBC(é‡ç‚¹)"></a>10ã€JDBC(é‡ç‚¹)</h2><h3 id="1-æ•°æ®åº“é©±åŠ¨"><a href="#1-æ•°æ®åº“é©±åŠ¨" class="headerlink" title="1.æ•°æ®åº“é©±åŠ¨"></a>1.æ•°æ®åº“é©±åŠ¨</h3><p>é©±åŠ¨ï¼šå£°å¡ï¼Œæ˜¾å¡ï¼Œæ•°æ®åº“</p><p><img src="https://gitee.com/zhayuyao/img/raw/master/zhayuyao/img/image-20210713212553844.png" alt="image-20210713212553844"></p><p>æˆ‘ä»¬çš„ç¨‹åºä¼šé€šè¿‡æ•°æ®åº“é©±åŠ¨ï¼Œå’Œæ•°æ®åº“æ‰“äº¤é“ï¼</p><h3 id="2-JDBC"><a href="#2-JDBC" class="headerlink" title="2.JDBC"></a>2.JDBC</h3><p>SUNå…¬å¸ä¸ºäº†ç®€åŒ–å¼€å‘äººå‘˜çš„ï¼ˆå¯¹æ•°æ®åº“çš„ç»Ÿä¸€ï¼‰æ“ä½œï¼Œæä¾›äº†ä¸€ä¸ªï¼ˆjavaæ“ä½œæ•°æ®åº“çš„ï¼‰è§„èŒƒï¼Œä¿—ç§°JDBC</p><p>è¿™äº›è§„èŒƒçš„å®ç°ç”±å…·ä½“çš„å‚å•†å»åš~</p><p>å¯¹äºå¼€å‘äººå‘˜æ¥è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦æŒæ¡JDBCæ¥å£çš„æ“ä½œå³å¯ï¼</p><p><img src="https://gitee.com/zhayuyao/img/raw/master/zhayuyao/img/image-20210713213250382.png" alt="image-20210713213250382"></p><p>java.sql</p><p>javax.sql</p><p>è¿˜éœ€è¦å¯¼å…¥ä¸€ä¸ªæ•°æ®åº“é©±åŠ¨åŒ… mysql-connector-java-5.1.47.jar</p><h3 id="3-ç¬¬ä¸€ä¸ªJDBCç¨‹åº"><a href="#3-ç¬¬ä¸€ä¸ªJDBCç¨‹åº" class="headerlink" title="3.ç¬¬ä¸€ä¸ªJDBCç¨‹åº"></a>3.ç¬¬ä¸€ä¸ªJDBCç¨‹åº</h3><blockquote><p>åˆ›å»ºæµ‹è¯•æ•°æ®åº“</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE jdbcstudy <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci;</span><br><span class="line"></span><br><span class="line"><span class="keyword">USER</span> jdbcstudy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> users(</span><br><span class="line">  `id` <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">  `name` <span class="type">VARCHAR</span>(<span class="number">40</span>),</span><br><span class="line">  `password` <span class="type">VARCHAR</span>(<span class="number">40</span>),</span><br><span class="line">  `email` <span class="type">VARCHAR</span>(<span class="number">60</span>),</span><br><span class="line">  `birthday` <span class="type">DATE</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> users(`id`,`name`,`password`,`email`,`birthday`)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">1</span>,<span class="string">&#x27;å¼ ä¸‰&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;zs@sina.com&#x27;</span>,<span class="string">&#x27;1980-12-04&#x27;</span>),</span><br><span class="line">(<span class="number">2</span>,<span class="string">&#x27;æå››&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;lisi@sina.com&#x27;</span>,<span class="string">&#x27;1981-12-04&#x27;</span>),</span><br><span class="line">(<span class="number">3</span>,<span class="string">&#x27;ç‹äº”&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;wangwu@sina.com&#x27;</span>,<span class="string">&#x27;1982-12-04&#x27;</span>);</span><br></pre></td></tr></table></figure><ol><li><p>åˆ›å»ºä¸€ä¸ªæ™®é€šé¡¹ç›®</p></li><li><p>å¯¼å…¥æ•°æ®åº“é©±åŠ¨ï¼ˆjaråŒ…ï¼‰</p><p><img src="https://gitee.com/zhayuyao/img/raw/master/zhayuyao/img/image-20210713215804024.png" alt="image-20210713215804024"></p></li></ol><p>3.ç¼–å†™æµ‹è¯•ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lesson1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcFirstDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException, SQLException &#123;</span><br><span class="line">        <span class="comment">//1.åŠ è½½é©±åŠ¨</span></span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);<span class="comment">//å›ºå®šå†™æ³•ï¼ŒåŠ è½½é©±åŠ¨</span></span><br><span class="line">        <span class="comment">//useUnicode=true&amp;characterEncoding=utf8&amp;useSSL=true</span></span><br><span class="line">        <span class="comment">//2.ç”¨æˆ·ä¿¡æ¯å’Œurl</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/jdbcstudy?useUnicode=true&amp;characterEncoding=utf8&amp;useSSL=true&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;xduniversity20&quot;</span>;</span><br><span class="line">        <span class="comment">//3.è¿æ¥æˆåŠŸï¼Œæ•°æ®åº“å¯¹è±¡  Connection ä»£è¡¨æ•°æ®åº“</span></span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url, username, password);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//4.æ‰§è¡ŒSQLçš„å¯¹è±¡ Statement æ‰§è¡Œ SQLå¯¹è±¡</span></span><br><span class="line">        <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//5.æ‰§è¡ŒSQLçš„å¯¹è±¡ å»æ‰§è¡ŒSQL,å¯èƒ½å­˜åœ¨ç»“æœï¼ŒæŸ¥çœ‹è¿”å›ç»“æœ</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT * FROM users&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> statement.executeQuery(sql);<span class="comment">//è¿”å›çš„ç»“æœé›†ï¼Œç»“æœé›†é›†ä¸­å°è£…äº†æˆ‘ä»¬å…¨éƒ¨çš„æŸ¥è¯¢å‡ºæ¥çš„ç»“æœ</span></span><br><span class="line">        <span class="comment">//resultSetæ˜¯ä¸€ä¸ªé“¾è¡¨</span></span><br><span class="line">        <span class="keyword">while</span> (resultSet.next())&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;id=&quot;</span>+resultSet.getObject(<span class="string">&quot;id&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;name=&quot;</span>+resultSet.getObject(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;pwd=&quot;</span>+resultSet.getObject(<span class="string">&quot;password&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;email=&quot;</span>+resultSet.getObject(<span class="string">&quot;email&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;birth=&quot;</span>+resultSet.getObject(<span class="string">&quot;birthday&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;===================&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//6.é‡Šæ”¾è¿æ¥</span></span><br><span class="line">        resultSet.close();</span><br><span class="line">        statement.close();</span><br><span class="line">        connection.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¥éª¤æ€»ç»“ï¼š</p><ol><li>åŠ è½½é©±åŠ¨</li><li>è¿æ¥æ•°æ®åº“DriverManager</li><li>è·å–æ‰§è¡ŒSQLçš„å¯¹è±¡ Statement</li><li>è·å¾—è¿”å›çš„ç»“æœé›†</li><li>é‡Šæ”¾è¿æ¥</li></ol><h3 id="4-ç¬¬ä¸€ä¸ªJDBCç¨‹åºè§£é‡Š"><a href="#4-ç¬¬ä¸€ä¸ªJDBCç¨‹åºè§£é‡Š" class="headerlink" title="4.ç¬¬ä¸€ä¸ªJDBCç¨‹åºè§£é‡Š"></a>4.ç¬¬ä¸€ä¸ªJDBCç¨‹åºè§£é‡Š</h3><blockquote><p>DriverManager</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.åŠ è½½é©±åŠ¨</span></span><br><span class="line"><span class="comment">//DriverManager.registerDriver(new com.mysql.jdbc.Driver()); é™æ€ä»£ç å—æ‰§è¡Œäº†ä¸¤æ¬¡</span></span><br><span class="line"><span class="comment">//æ¨èè¿™ç§å†™æ³•åŠ è½½é©±åŠ¨</span></span><br><span class="line">Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(url, userName, passWord);</span><br><span class="line"><span class="comment">// connectionä»£è¡¨æ•°æ®åº“</span></span><br><span class="line">connection.setAutoCommit(<span class="literal">true</span>);<span class="comment">// æ•°æ®åº“è®¾ç½®è‡ªåŠ¨æäº¤</span></span><br><span class="line">connection.commit();<span class="comment">// äº‹åŠ¡æäº¤</span></span><br><span class="line">connection.rollback();<span class="comment">// äº‹åŠ¡å›æ»š</span></span><br></pre></td></tr></table></figure><blockquote><p>URL</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://localhost:3306/jdbcstudy?useUnicode=true&amp;characterEncoding=utf8&amp;useSSL=false&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// mysqlé»˜è®¤ç«¯å£3306</span></span><br><span class="line"><span class="comment">// åè®®://ä¸»æœºåœ°å€:ç«¯å£å·/æ•°æ®åº“å?å‚æ•°1&amp;å‚æ•°2&amp;å‚æ•°3</span></span><br><span class="line"><span class="comment">// oracleé»˜è®¤ç«¯å£1521</span></span><br><span class="line"><span class="comment">// jdbc:oracle:thin:@localhost:1521:sid</span></span><br></pre></td></tr></table></figure><blockquote><p>Statement æ‰§è¡Œsqlå¯¹è±¡ ã€ PreparedStatement æ‰§è¡Œsqlå¯¹è±¡</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT * FROM users&quot;</span>;<span class="comment">//ç¼–å†™SQLè¯­å¥</span></span><br><span class="line"></span><br><span class="line">statement.executeQuery();<span class="comment">//æ‰§è¡ŒæŸ¥è¯¢ è¿”å›ResultSet</span></span><br><span class="line">statement.executeUpdate();<span class="comment">//æ–°å¢ï¼Œåˆ é™¤ï¼Œä¿®æ”¹ï¼Œéƒ½ç”¨è¿™ä¸ªï¼Œè¿”å›å—å½±å“çš„è¡Œæ•°</span></span><br><span class="line">statement.execute();<span class="comment">//æ‰§è¡Œä»»ä½•SQL</span></span><br></pre></td></tr></table></figure><blockquote><p>ResultSet æŸ¥è¯¢çš„ç»“æœé›†ï¼Œå°è£…äº†æ‰€æœ‰çš„æŸ¥è¯¢ç»“æœ</p></blockquote><p>è·å¾—æŒ‡å®šçš„æ•°æ®ç±»å‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åœ¨ä¸çŸ¥é“åˆ—ç±»å‹çš„æƒ…å†µä¸‹ä½¿ç”¨</span></span><br><span class="line">resultSet.getObject();</span><br><span class="line"><span class="comment">//å¦‚æœçŸ¥é“åˆ—ç±»å‹ï¼Œå°±ä½¿ç”¨æŒ‡å®šçš„ç±»å‹</span></span><br><span class="line">resultSet.getString();</span><br><span class="line">resultSet.getInt();</span><br><span class="line">resultSet.getDouble();</span><br><span class="line">resultSet.getBigDecimal();</span><br><span class="line">resultSet.getFloat();</span><br><span class="line">resultSet.getDate();</span><br><span class="line"><span class="comment">//...</span></span><br></pre></td></tr></table></figure><p>éå†ï¼ŒæŒ‡é’ˆ(ç»“æœé›†æ˜¯ä¸€ä¸ªé“¾è¡¨)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">resultSet.beforeFirst();<span class="comment">//ç§»åŠ¨åˆ°æœ€å‰é¢</span></span><br><span class="line">resultSet.afterLast();<span class="comment">//ç§»åŠ¨åˆ°æœ€åé¢</span></span><br><span class="line">resultSet.next();<span class="comment">//ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªæ•°æ®   é‡ç‚¹ï¼Œå…¶ä»–æ²¡å•¥ç”¨</span></span><br><span class="line">resultSet.previous();<span class="comment">//ç§»åŠ¨åˆ°å‰ä¸€è¡Œ</span></span><br><span class="line">resultSet.absolute(row);<span class="comment">//ç§»åŠ¨åˆ°æŒ‡å®šè¡Œ</span></span><br></pre></td></tr></table></figure><blockquote><p>é‡Šæ”¾èµ„æº</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">resultSet.close();</span><br><span class="line">statement.close();</span><br><span class="line">connection.close();<span class="comment">//æ¶ˆè€—èµ„æº,ç”¨å®Œè¦å…³æ‰ï¼</span></span><br></pre></td></tr></table></figure><h3 id="5-Statementå¯¹è±¡è¯¦æƒ…"><a href="#5-Statementå¯¹è±¡è¯¦æƒ…" class="headerlink" title="5.Statementå¯¹è±¡è¯¦æƒ…"></a>5.Statementå¯¹è±¡è¯¦æƒ…</h3><p>&#x3D;&#x3D;jdbcä¸­çš„statementå¯¹è±¡ç”¨äºå‘æ•°æ®åº“å‘é€SQLè¯­å¥ï¼Œæƒ³å®Œæˆå¯¹æ•°æ®åº“çš„å¢åˆ æ”¹æŸ¥ï¼Œåªéœ€è¦é€šè¿‡è¿™ä¸ªå¯¹è±¡å‘æ•°æ®åº“å‘é€å¢åˆ æ”¹æŸ¥è¯­å¥å³å¯ã€‚&#x3D;&#x3D;</p><p>Statementå¯¹è±¡çš„executeUpdateæ–¹æ³•ï¼Œç”¨äºå‘æ•°æ®åº“å‘é€å¢ã€åˆ ã€æ”¹çš„SQLè¯­å¥ï¼ŒexecuteUpdateæ‰§è¡Œå®Œåï¼Œå°†ä¼šè¿”å›ä¸€ä¸ªæ•´æ•°ï¼ˆå³å¢åˆ æ”¹è¯­å¥å¯¼è‡´äº†æ•°æ®åº“å‡ è¡Œæ•°æ®å‘é€äº†å˜åŒ–ï¼‰ã€‚</p><p>Statement.executeQueryæ–¹æ³•ç”¨äºå‘æ•°æ®åº“å‘é€æŸ¥è¯¢è¯­å¥ï¼ŒexecuteQueryæ–¹æ³•è¿”å›ä»£è¡¨æŸ¥è¯¢ç»“æœçš„ResultSetå¯¹è±¡ã€‚</p><blockquote><p>CRUDæ“ä½œ-create</p></blockquote><p>ä½¿ç”¨executeUpdate(String sql)æ–¹æ³•å®Œæˆæ•°æ®æ·»åŠ æ“ä½œï¼Œç¤ºä¾‹æ“ä½œï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;insert into user(...) values(...)&quot;</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> statement.executeUpdate(sql);</span><br><span class="line"><span class="keyword">if</span> (num &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;æ’å…¥æˆåŠŸ~&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>CRUDæ“ä½œ-delete</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;delete from user where id=1&quot;</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> statement.executeUpdate(sql);</span><br><span class="line"><span class="keyword">if</span> (num &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;åˆ é™¤æˆåŠŸ~&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>CRUDæ“ä½œ-update</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;update user set name=&#x27;&#x27; where name =&#x27;&#x27;&quot;</span>;</span><br><span class="line"><span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> statement.executeUpdate(sql);</span><br><span class="line"><span class="keyword">if</span> (num &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;ä¿®æ”¹æˆåŠŸ~&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>CRUDæ“ä½œ-read</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT * FROM users&quot;</span>;</span><br><span class="line"><span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> statement.executeQuery(sql);</span><br><span class="line"><span class="keyword">while</span> (resultSet.next()) &#123;</span><br><span class="line">    <span class="comment">//æ ¹æ®è·å–åˆ—çš„æ•°æ®ç±»å‹ï¼Œåˆ†åˆ«è°ƒç”¨resultSetçš„ç›¸åº”æ–¹æ³•æ˜ å°„åˆ°javaå¯¹è±¡ä¸­</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä»£ç å®ç°</p></blockquote><p>1.é…ç½®æ–‡ä»¶db.properties</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">driver = com.mysql.jdbc.<span class="type">Driver</span></span><br><span class="line"><span class="variable">url</span> <span class="operator">=</span> jdbc:mysql:<span class="comment">//localhost:3306/jdbcstudy?useUnicode=true&amp;characterEncoding=utf8&amp;useSSL=true</span></span><br><span class="line">username = <span class="type">root</span></span><br><span class="line"><span class="variable">password</span> <span class="operator">=</span> xduniversity20</span><br></pre></td></tr></table></figure><p>2.æå–å·¥å…·ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lesson2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lesson1.JdbcFirstDemo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcUtils</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">driver</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> JdbcUtils.class.getClassLoader().getResourceAsStream(<span class="string">&quot;db.properties&quot;</span>);</span><br><span class="line">            <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">            properties.load(in);</span><br><span class="line"></span><br><span class="line">            driver = properties.getProperty(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line">            url = properties.getProperty(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">            username = properties.getProperty(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">            password = properties.getProperty(<span class="string">&quot;password&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//é©±åŠ¨åªç”¨åŠ è½½ä¸€æ¬¡</span></span><br><span class="line">            Class.forName(driver);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å–è¿æ¥</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="keyword">return</span> DriverManager.getConnection(url,username,password);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é‡Šæ”¾èµ„æº</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">release</span><span class="params">(Connection con, Statement st, ResultSet rs)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (rs != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                rs.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (st != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                st.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (con != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                con.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>3.å¢åˆ æ”¹ æ–¹æ³• ï¼Œ<strong>executeUpdate</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lesson2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestInsert</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">st</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            con = JdbcUtils.getConnection();</span><br><span class="line">            st = con.createStatement();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;INSERT INTO users(`id`,`name`,`password`,`email`,`birthday`)\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;VALUES (4,&#x27;hrd&#x27;,&#x27;123456&#x27;,&#x27;hrd.@gmail.com&#x27;,&#x27;2002-12-26&#x27;);&quot;</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> st.executeUpdate(sql);</span><br><span class="line">            <span class="keyword">if</span> (num&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;æ’å…¥æˆåŠŸï¼&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            JdbcUtils.release(con,st,rs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lesson2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestDelete</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">st</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            con = JdbcUtils.getConnection();</span><br><span class="line">            st = con.createStatement();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;DELETE FROM users WHERE `id`=4&quot;</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> st.executeUpdate(sql);</span><br><span class="line">            <span class="keyword">if</span> (num&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;åˆ é™¤æˆåŠŸï¼&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            JdbcUtils.release(con,st,rs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lesson2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestUpdate</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">st</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            con = JdbcUtils.getConnection();</span><br><span class="line">            st = con.createStatement();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;UPDATE users SET `name`=&#x27;hrd&#x27;,`email`=&#x27;hrd.@gmail.com&#x27; WHERE id =1&quot;</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> st.executeUpdate(sql);</span><br><span class="line">            <span class="keyword">if</span> (num&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;æ›´æ–°æˆåŠŸï¼&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            JdbcUtils.release(con,st,rs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>4.æŸ¥è¯¢  <strong>executeQuery</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lesson2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.plaf.nimbus.State;</span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestSelect</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">st</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            con = JdbcUtils.getConnection();</span><br><span class="line">            st = con.createStatement();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT * FROM users WHERE id=1&quot;</span>;</span><br><span class="line">            rs = st.executeQuery(sql);</span><br><span class="line">            <span class="keyword">while</span> (rs.next())&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;id=&quot;</span>+rs.getInt(<span class="string">&quot;id&quot;</span>));</span><br><span class="line">                System.out.println(<span class="string">&quot;name=&quot;</span>+rs.getString(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">                System.out.println(<span class="string">&quot;email=&quot;</span>+rs.getString(<span class="string">&quot;email&quot;</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException throwables) &#123;</span><br><span class="line">            throwables.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            JdbcUtils.release(con,st,rs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="6-SQLæ³¨å…¥é—®é¢˜"><a href="#6-SQLæ³¨å…¥é—®é¢˜" class="headerlink" title="6.SQLæ³¨å…¥é—®é¢˜"></a>6.SQLæ³¨å…¥é—®é¢˜</h3><p>sqlå­˜åœ¨æ¼æ´ï¼Œä¼šè¢«æ”»å‡»å¯¼è‡´æ•°æ®æ³„éœ²  <strong>SQLä¼šè¢«æ‹¼æ¥</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lesson2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SQLQuestion</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//æ­£å¸¸ç™»å½•</span></span><br><span class="line">        login(<span class="string">&quot;hrd&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//sqlæ³¨å…¥ éæ³•ç™»å½•</span></span><br><span class="line">        login(<span class="string">&quot;&#x27; or &#x27;1=1&quot;</span>,<span class="string">&quot; &#x27;or&#x27;1=1 &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç™»é™†ä¸šåŠ¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">login</span><span class="params">(String userName,String password)</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">Statement</span> <span class="variable">st</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            con = JdbcUtils.getConnection();</span><br><span class="line">            st = con.createStatement();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT * FROM users WHERE name=&#x27;&quot;</span>+userName+<span class="string">&quot;&#x27; AND password=&#x27;&quot;</span>+password+<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">            System.out.println(sql);</span><br><span class="line">            rs = st.executeQuery(sql);</span><br><span class="line">            <span class="keyword">while</span> (rs.next())&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;id=&quot;</span>+rs.getInt(<span class="string">&quot;id&quot;</span>));</span><br><span class="line">                System.out.println(<span class="string">&quot;name=&quot;</span>+rs.getString(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">                System.out.println(<span class="string">&quot;email=&quot;</span>+rs.getString(<span class="string">&quot;email&quot;</span>));</span><br><span class="line">                System.out.println(<span class="string">&quot;==========&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            JdbcUtils.release(con,st,rs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯¼è‡´ç»“æœï¼šé”™è¯¯çš„ç”¨æˆ·åæˆ–è€…å¯†ç å¯ä»¥è·å–åˆ°å…¨éƒ¨çš„ç”¨æˆ·ä¿¡æ¯</p><h3 id="7-PreparedStatementå¯¹è±¡"><a href="#7-PreparedStatementå¯¹è±¡" class="headerlink" title="7.PreparedStatementå¯¹è±¡"></a>7.PreparedStatementå¯¹è±¡</h3><p>PreparedStatementå¯ä»¥é˜²æ­¢SQLæ³¨å…¥ï¼Œæ•ˆç‡æ›´å¥½</p><p>1.æ–°å¢</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lesson3;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lesson2.JdbcUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestInsert</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">st</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            con = JdbcUtils.getConnection();</span><br><span class="line">            <span class="comment">//ä½¿ç”¨ï¼Ÿå ä½ç¬¦ä»£æ›¿å‚æ•°</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;INSERT INTO users(id,name,password,email,birthday) VALUES(?,?,?,?,?)&quot;</span>;</span><br><span class="line">            <span class="comment">//é¢„ç¼–è¯‘SQL å…ˆå†™SQLï¼Œç„¶åä¸æ‰§è¡Œ</span></span><br><span class="line">            st = con.prepareStatement(sql);</span><br><span class="line">            <span class="comment">//æ‰‹åŠ¨ç»™å‚æ•°èµ‹å€¼</span></span><br><span class="line">            st.setInt(<span class="number">1</span>,<span class="number">4</span>);</span><br><span class="line">            st.setString(<span class="number">2</span>,<span class="string">&quot;é»„ç‘å†¬&quot;</span>);</span><br><span class="line">            st.setString(<span class="number">3</span>,<span class="string">&quot;xduniversity20&quot;</span>);</span><br><span class="line">            st.setString(<span class="number">4</span>,<span class="string">&quot;huangruidong.xauat@gmail.com&quot;</span>);</span><br><span class="line">            st.setDate(<span class="number">5</span>,<span class="keyword">new</span> <span class="title class_">java</span>.sql.Date(<span class="keyword">new</span> <span class="title class_">java</span>.util.Date().getTime()));</span><br><span class="line">            <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> st.executeUpdate();</span><br><span class="line">            <span class="keyword">if</span>(num&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;æ’å…¥æˆåŠŸ&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            JdbcUtils.release(con,st,rs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2.åˆ é™¤</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lesson3;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lesson2.JdbcUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TextDelete</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">st</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            con = JdbcUtils.getConnection();</span><br><span class="line">            <span class="comment">//ä½¿ç”¨ï¼Ÿå ä½ç¬¦ä»£æ›¿å‚æ•°</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;DELETE FROM users WHERE id=?&quot;</span>;</span><br><span class="line">            <span class="comment">//é¢„ç¼–è¯‘SQL å…ˆå†™SQLï¼Œç„¶åä¸æ‰§è¡Œ</span></span><br><span class="line">            st = con.prepareStatement(sql);</span><br><span class="line">            <span class="comment">//æ‰‹åŠ¨ç»™å‚æ•°èµ‹å€¼</span></span><br><span class="line">            st.setInt(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> st.executeUpdate();</span><br><span class="line">            <span class="keyword">if</span>(num&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;åˆ é™¤æˆåŠŸ&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            JdbcUtils.release(con,st,rs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>3.æ›´æ–°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lesson3;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lesson2.JdbcUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestUpdate</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">st</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            con = JdbcUtils.getConnection();</span><br><span class="line">            <span class="comment">//ä½¿ç”¨ï¼Ÿå ä½ç¬¦ä»£æ›¿å‚æ•°</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;UPDATE users SET email=? WHERE id=?&quot;</span>;</span><br><span class="line">            <span class="comment">//é¢„ç¼–è¯‘SQL å…ˆå†™SQLï¼Œç„¶åä¸æ‰§è¡Œ</span></span><br><span class="line">            st = con.prepareStatement(sql);</span><br><span class="line">            <span class="comment">//æ‰‹åŠ¨ç»™å‚æ•°èµ‹å€¼</span></span><br><span class="line">            st.setString(<span class="number">1</span>,<span class="string">&quot;jiuzhe@gmail.com&quot;</span>);</span><br><span class="line">            st.setInt(<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> st.executeUpdate();</span><br><span class="line">            <span class="keyword">if</span>(num&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;ä¿®æ”¹æˆåŠŸ&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            JdbcUtils.release(con,st,rs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>4.æŸ¥è¯¢</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lesson3;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lesson2.JdbcUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestSelect</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">st</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            con = JdbcUtils.getConnection();</span><br><span class="line">            <span class="comment">//?å ä½</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT * FROM users WHERE id=?&quot;</span>;</span><br><span class="line">            <span class="comment">//é¢„ç¼–è¯‘</span></span><br><span class="line">            st = con.prepareStatement(sql);</span><br><span class="line">            <span class="comment">//æ‰‹åŠ¨ç»™å‚æ•°èµ‹å€¼</span></span><br><span class="line">            st.setInt(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">            rs = st.executeQuery();</span><br><span class="line">            <span class="keyword">while</span>(rs.next())&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;id=&quot;</span>+rs.getInt(<span class="string">&quot;id&quot;</span>));</span><br><span class="line">                System.out.println(<span class="string">&quot;name=&quot;</span>+rs.getString(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">                System.out.println(<span class="string">&quot;email=&quot;</span>+rs.getString(<span class="string">&quot;email&quot;</span>));</span><br><span class="line">                System.out.println(<span class="string">&quot;birthday=&quot;</span>+rs.getDate(<span class="string">&quot;birthday&quot;</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            JdbcUtils.release(con,st,rs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>5.é˜²æ­¢sqlæ³¨å…¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lesson3;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lesson2.JdbcUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.ParameterizedType;</span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SQLQuestion</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//æ­£å¸¸ç™»å½•</span></span><br><span class="line">        login(<span class="string">&quot;hrd&quot;</span>,<span class="string">&quot;123456&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//sqlæ³¨å…¥ éæ³•ç™»å½•</span></span><br><span class="line">        login(<span class="string">&quot;&#x27; or &#x27;1=1&quot;</span>,<span class="string">&quot; &#x27;or&#x27;1=1 &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç™»é™†ä¸šåŠ¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">login</span><span class="params">(String userName,String password)</span>&#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">st</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            con = JdbcUtils.getConnection();</span><br><span class="line">            <span class="comment">// PreparedStatement é˜²æ­¢SQLæ³¨å…¥çš„æœ¬è´¨ï¼ŒæŠŠä¼ é€’è¿›æ¥çš„å‚æ•°å½“åšå­—ç¬¦</span></span><br><span class="line">            <span class="comment">// å‡è®¾å…¶ä¸­å­˜åœ¨è½¬ä¹‰å­—ç¬¦ï¼Œæ¯”å¦‚è¯´&#x27;ä¼šè¢«ç›´æ¥è½¬ä¹‰</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT * FROM users WHERE name=? AND password=?&quot;</span>;</span><br><span class="line">            st = con.prepareStatement(sql);</span><br><span class="line">            st.setString(<span class="number">1</span>,userName);</span><br><span class="line">            st.setString(<span class="number">2</span>,password);</span><br><span class="line">            rs = st.executeQuery();</span><br><span class="line">            <span class="keyword">while</span> (rs.next())&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;id=&quot;</span>+rs.getInt(<span class="string">&quot;id&quot;</span>));</span><br><span class="line">                System.out.println(<span class="string">&quot;name=&quot;</span>+rs.getString(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">                System.out.println(<span class="string">&quot;email=&quot;</span>+rs.getString(<span class="string">&quot;email&quot;</span>));</span><br><span class="line">                System.out.println(<span class="string">&quot;==========&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            JdbcUtils.release(con,st,rs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="8-ä½¿ç”¨ideaè¿æ¥æ•°æ®åº“"><a href="#8-ä½¿ç”¨ideaè¿æ¥æ•°æ®åº“" class="headerlink" title="8.ä½¿ç”¨ideaè¿æ¥æ•°æ®åº“"></a>8.ä½¿ç”¨ideaè¿æ¥æ•°æ®åº“</h3><p><img src="https://gitee.com/zhayuyao/img/raw/master/zhayuyao/img/image-20210715092417582.png" alt="image-20210715092417582"></p><p>è¿æ¥æˆåŠŸåï¼Œå°±å¯ä»¥é€‰æ‹©æ•°æ®åº“</p><p><img src="https://gitee.com/zhayuyao/img/raw/master/zhayuyao/img/image-20210715095230497.png" alt="image-20210715095230497"></p><p><img src="https://gitee.com/zhayuyao/img/raw/master/zhayuyao/img/image-20210715095449617.png" alt="image-20210715095449617"></p><p>è¿æ¥ä¸ä¸Šçš„è¯ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ä¸‹é¢è¿™é‡Œï¼Œé…ç½®å¯¹åº”çš„mysqlç‰ˆæœ¬</p><p><img src="https://gitee.com/zhayuyao/img/raw/master/zhayuyao/img/image-20210715214953909.png" alt="image-20210715214953909"></p><p>åŒå‡»æ•°æ®åº“</p><p><img src="https://gitee.com/zhayuyao/img/raw/master/zhayuyao/img/image-20210715095953750.png" alt="image-20210715095953750"></p><p>æ›´æ–°æ•°æ®ï¼ˆæäº¤ï¼‰</p><p><img src="https://gitee.com/zhayuyao/img/raw/master/zhayuyao/img/image-20210715100117897.png" alt="image-20210715100117897"></p><p><img src="https://gitee.com/zhayuyao/img/raw/master/zhayuyao/img/image-20210715214142285.png" alt="image-20210715214142285"></p><p>ideaç¼–å†™sql</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> account</span><br><span class="line">(</span><br><span class="line">    id    <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">    name  <span class="type">varchar</span>(<span class="number">40</span>),</span><br><span class="line">    money <span class="type">float</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> account(name, money)</span><br><span class="line"><span class="keyword">values</span> (<span class="string">&#x27;A&#x27;</span>, <span class="number">1000</span>),</span><br><span class="line">       (<span class="string">&#x27;B&#x27;</span>, <span class="number">1000</span>),</span><br><span class="line">       (<span class="string">&#x27;C&#x27;</span>, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/zhayuyao/img/raw/master/zhayuyao/img/image-20210715214803462.png" alt="image-20210715214803462"></p><h3 id="9-JDBCæ“ä½œäº‹åŠ¡"><a href="#9-JDBCæ“ä½œäº‹åŠ¡" class="headerlink" title="9.JDBCæ“ä½œäº‹åŠ¡"></a>9.JDBCæ“ä½œäº‹åŠ¡</h3><p>&#x3D;&#x3D;è¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥&#x3D;&#x3D;</p><blockquote><p>ACIDåŸåˆ™</p></blockquote><p>åŸå­æ€§ï¼šè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥</p><p>ä¸€è‡´æ€§ï¼šæ€»æ•°ä¸å˜</p><p>éš”ç¦»æ€§ï¼šå¤šä¸ªè¿›ç¨‹äº’ä¸å¹²æ‰°</p><p>æŒä¹…æ€§ï¼šä¸€æ—¦æäº¤ä¸å¯é€†ï¼ŒæŒä¹…åŒ–åˆ°æ•°æ®åº“äº†</p><p>éš”ç¦»æ€§çš„é—®é¢˜ï¼š</p><p>è„è¯»ï¼šä¸€ä¸ªäº‹åŠ¡è¯»å–äº†å¦å¤–ä¸€ä¸ªæ²¡æœ‰æäº¤çš„äº‹åŠ¡</p><p>ä¸å¯é‡å¤è¯»ï¼šåœ¨åŒä¸€ä¸ªäº‹åŠ¡å†…ï¼Œé‡å¤è¯»å–è¡¨ä¸­æ•°æ®ï¼Œè¡¨æ•°æ®å‘ç”Ÿäº†æ”¹å˜</p><p>å¹»è¯»ï¼šåœ¨ä¸€ä¸ªäº‹åŠ¡å†…ï¼Œè¯»å–åˆ°äº†åˆ«äººæ’å…¥çš„æ•°æ®ï¼Œå¯¼è‡´å‰åè¯»å‡ºæ¥çš„ç»“æœä¸ä¸€è‡´</p><blockquote><p>ä»£ç å®ç°</p></blockquote><ol><li>å¼€å¯äº‹åŠ¡<code>con.setAutoCommit(false);</code></li><li>ä¸€ç»„ä¸šåŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œæäº¤äº‹åŠ¡</li><li>å¯ä»¥åœ¨catchè¯­å¥ä¸­æ˜¾ç¤ºçš„å®šä¹‰å›æ»šè¯­å¥ï¼Œä½†æ˜¯é»˜è®¤å¤±è´¥å°±ä¼šå›æ»š</li></ol><p>æ­£å¸¸æƒ…å†µ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lesson4;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mysql.jdbc.Connection;</span><br><span class="line"><span class="keyword">import</span> lesson2.JdbcUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestTransaction1</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">st</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            con = (Connection) JdbcUtils.getConnection();</span><br><span class="line">            <span class="comment">//å…³é—­è‡ªåŠ¨æäº¤ è‡ªåŠ¨å¼€å¯äº‹åŠ¡</span></span><br><span class="line">            con.setAutoCommit(<span class="literal">false</span>);<span class="comment">//å¼€å¯äº‹åŠ¡</span></span><br><span class="line">            <span class="comment">//Aè½¬B 100</span></span><br><span class="line">            String sql1=<span class="string">&quot;update account set money=money-100 where name=&#x27;A&#x27;&quot;</span>;</span><br><span class="line">            st = con.prepareStatement(sql1);</span><br><span class="line">            st.executeUpdate();</span><br><span class="line">            String sql2=<span class="string">&quot;update account set money=money+100 where name=&#x27;B&#x27;&quot;</span>;</span><br><span class="line">            st = con.prepareStatement(sql2);</span><br><span class="line">            st.executeUpdate();</span><br><span class="line">            <span class="comment">//ä¸šåŠ¡å®Œæ¯•ï¼Œæäº¤äº‹åŠ¡</span></span><br><span class="line">            con.commit();</span><br><span class="line">            System.out.println(<span class="string">&quot;è½¬è´¦æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                con.rollback();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException ex) &#123;</span><br><span class="line">                ex.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            JdbcUtils.release(con,st,rs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¼‚å¸¸æƒ…å†µ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lesson4;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mysql.jdbc.Connection;</span><br><span class="line"><span class="keyword">import</span> lesson2.JdbcUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestTransaction2</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">st</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            con = (Connection) JdbcUtils.getConnection();</span><br><span class="line">            <span class="comment">//å…³é—­è‡ªåŠ¨æäº¤ è‡ªåŠ¨å¼€å¯äº‹åŠ¡</span></span><br><span class="line">            con.setAutoCommit(<span class="literal">false</span>);<span class="comment">//å¼€å¯äº‹åŠ¡</span></span><br><span class="line">            <span class="comment">//Aè½¬B 100</span></span><br><span class="line">            String sql1=<span class="string">&quot;update account set money=money-100 where name=&#x27;A&#x27;&quot;</span>;</span><br><span class="line">            st = con.prepareStatement(sql1);</span><br><span class="line">            st.executeUpdate();</span><br><span class="line"></span><br><span class="line">            <span class="comment">//ç»™ä¸€ä¸ªå¼‚å¸¸</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> <span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            String sql2=<span class="string">&quot;update account set money=money+100 where name=&#x27;B&#x27;&quot;</span>;</span><br><span class="line">            st = con.prepareStatement(sql2);</span><br><span class="line">            st.executeUpdate();</span><br><span class="line">            <span class="comment">//ä¸šåŠ¡å®Œæ¯•ï¼Œæäº¤äº‹åŠ¡</span></span><br><span class="line">            con.commit();</span><br><span class="line">            System.out.println(<span class="string">&quot;è½¬è´¦æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="comment">//å³ä½¿ä¸å†™å›æ»šï¼Œç³»ç»Ÿæäº¤ä¸ä¸Šå»ï¼Œä¹Ÿä¼šè‡ªåŠ¨å›æ»š</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                con.rollback();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException ex) &#123;</span><br><span class="line">                ex.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            JdbcUtils.release(con,st,rs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="10-DBCP-C3P0è¿æ¥æ± "><a href="#10-DBCP-C3P0è¿æ¥æ± " class="headerlink" title="10.DBCP-C3P0è¿æ¥æ± "></a>10.DBCP-C3P0è¿æ¥æ± </h3><p>æ•°æ®åº“è¿æ¥ â€“ æ‰§è¡Œå®Œæ¯• â€“ é‡Šæ”¾</p><p>è¿æ¥â€“ é‡Šæ”¾ æ˜¯ååˆ†æµªè´¹ç³»ç»Ÿèµ„æºçš„</p><p>æ± åŒ–æŠ€æœ¯ï¼šå‡†å¤‡ä¸€äº›é¢„å…ˆçš„èµ„æºï¼Œè¿‡æ¥å°±è¿æ¥é¢„å…ˆå‡†å¤‡å¥½çš„</p><p>æœ€å°è¿æ¥æ•°ï¼š10(å¸¸ç”¨è¿æ¥)</p><p>æœ€å¤§è¿æ¥æ•°ï¼š100 ï¼ˆä¸šåŠ¡æœ€é«˜æ‰¿è½½ä¸Šçº¿ï¼‰</p><p>ç­‰å¾…è¶…æ—¶ï¼š100ms</p><p>ç¼–å†™è¿æ¥æ± ï¼Œå®ç°ä¸€ä¸ªæ¥å£DataSource</p><blockquote><p>å¼€æºæ•°æ®æºå®ç°</p></blockquote><p>DBCP</p><p>C3p0</p><p>Druid:é˜¿é‡Œå·´å·´</p><p>ä½¿ç”¨äº†è¿™äº›æ•°æ®åº“è¿æ¥æ± ä¹‹åï¼Œæˆ‘ä»¬åœ¨é¡¹ç›®å¼€å‘ä¸­å°±ä¸éœ€è¦ç¼–å†™è¿æ¥æ•°æ®åº“çš„ä»£ç äº†</p><blockquote><p>DBCP</p></blockquote><p>éœ€è¦ç”¨åˆ°çš„jaråŒ…</p><p>commons-dbcp-1.4</p><p>commons-pool-1.6</p><p>é…ç½®æ–‡ä»¶dbcp.properties</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#????</span></span><br><span class="line"><span class="attr">driverClassName</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="attr">url</span>=<span class="string">jdbc:mysql://localhost:3306/jdbcstudy?useUnicode=true&amp;characterEncoding=utf8&amp;useSSL=false</span></span><br><span class="line"><span class="attr">username</span>=<span class="string">root</span></span><br><span class="line"><span class="attr">password</span>=<span class="string">xduniversity20</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#?????</span></span><br><span class="line"><span class="attr">initialSize</span>=<span class="string">10</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#??????</span></span><br><span class="line"><span class="attr">maxActive</span>=<span class="string">50</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#??????</span></span><br><span class="line"><span class="attr">maxIdle</span>=<span class="string">20</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#??????</span></span><br><span class="line"><span class="attr">minIdle</span>=<span class="string">5</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#???????????? 6000??/1000??60?</span></span><br><span class="line"><span class="attr">maxWait</span>=<span class="string">60000</span></span><br><span class="line"><span class="comment">#JDBC?????????????????????????????=property;?</span></span><br><span class="line"><span class="comment">#???user ? password ????????????????????????</span></span><br><span class="line"><span class="attr">connectionProperties</span>=<span class="string">useUnicode=true;characterEncoding=UTF8</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#??????????????????auto-commit????</span></span><br><span class="line"><span class="attr">defaultAutoCommit</span>=<span class="string">true</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#driver default ????????????????read-only????</span></span><br><span class="line"><span class="comment">#???????????setReadOnly?????????????????????????Informix?</span></span><br><span class="line"><span class="attr">defaultReadOnly</span>=<span class="string"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#driver default ??????????????????TransactionIsolation??</span></span><br><span class="line"><span class="comment">#??????????????javadoc??NONE,READ_UNCOMMITTED, READ_COMMITTED, REPEATABLE_READ, SERIALIZABLE</span></span><br><span class="line"><span class="attr">defaultTransactionIsolation</span>=<span class="string">READ_COMMITTED</span></span><br></pre></td></tr></table></figure><p>å·¥å…·ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lesson5;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mysql.jdbc.Connection;</span><br><span class="line"><span class="keyword">import</span> com.mysql.jdbc.Statement;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.dbcp.BasicDataSourceFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JDBCDBCPUtils</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">DataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">in</span> <span class="operator">=</span> JDBCDBCPUtils.class.getClassLoader().getResourceAsStream(<span class="string">&quot;dbcp.properties&quot;</span>);</span><br><span class="line">            <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">            properties.load(in);</span><br><span class="line">            <span class="comment">//åˆ›å»ºæ•°æ®æº å·¥å‚æ¨¡å¼</span></span><br><span class="line">            dataSource = BasicDataSourceFactory.createDataSource(properties);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="comment">//ä»æ•°æ®æºä¸­è·å–è¿æ¥</span></span><br><span class="line">        <span class="keyword">return</span> (Connection) dataSource.getConnection();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é‡Šæ”¾èµ„æº</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">release</span><span class="params">(Connection con, Statement st, ResultSet rs)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (rs != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                rs.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (st != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                st.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (con != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                con.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lesson5;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lesson2.JdbcUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestDBCP</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">st</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            con = JdbcUtils.getConnection();</span><br><span class="line">            <span class="comment">//ä½¿ç”¨ï¼Ÿå ä½ç¬¦ä»£æ›¿å‚æ•°</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;INSERT INTO users(id,name,password,email,birthday) VALUES(?,?,?,?,?)&quot;</span>;</span><br><span class="line">            <span class="comment">//é¢„ç¼–è¯‘SQL å…ˆå†™SQLï¼Œç„¶åä¸æ‰§è¡Œ</span></span><br><span class="line">            st = con.prepareStatement(sql);</span><br><span class="line">            <span class="comment">//æ‰‹åŠ¨ç»™å‚æ•°èµ‹å€¼</span></span><br><span class="line">            st.setInt(<span class="number">1</span>,<span class="number">7</span>);</span><br><span class="line">            st.setString(<span class="number">2</span>,<span class="string">&quot;é»„ç‘å†¬&quot;</span>);</span><br><span class="line">            st.setString(<span class="number">3</span>,<span class="string">&quot;xduniversity20&quot;</span>);</span><br><span class="line">            st.setString(<span class="number">4</span>,<span class="string">&quot;huangruidong.xauat@gmail.com&quot;</span>);</span><br><span class="line">            st.setDate(<span class="number">5</span>,<span class="keyword">new</span> <span class="title class_">java</span>.sql.Date(<span class="keyword">new</span> <span class="title class_">java</span>.util.Date().getTime()));</span><br><span class="line">            <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> st.executeUpdate();</span><br><span class="line">            <span class="keyword">if</span>(num&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;æ’å…¥æˆåŠŸ&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            JdbcUtils.release(con,st,rs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>C3P0</p></blockquote><p>éœ€è¦ç”¨åˆ°çš„jaråŒ…</p><p>c3p0-0.9.5.5.jar</p><p>mchange-commons-java-0.2.19.jar</p><p>é…ç½®æ–‡ä»¶c3p0-config.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">c3p0-config</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    c3p0çš„ç¼ºçœï¼ˆé»˜è®¤ï¼‰é…ç½®</span></span><br><span class="line"><span class="comment">    å¦‚æœåœ¨ä»£ç ä¸­ComboPooledDataSource ds=new ComboPooledDataSource();è¿™æ ·å†™å°±è¡¨ç¤ºä½¿ç”¨çš„æ˜¯c3p0çš„ç¼ºçœï¼ˆé»˜è®¤ï¼‰</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">default-config</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClass&quot;</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcUrl&quot;</span>&gt;</span>jdbc:mysql://localhost:3306/jdbcstudy?useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=utf8<span class="symbol">&amp;amp;</span>useSSL=false<span class="symbol">&amp;amp;</span>serverTimezone=UTC<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span>xduniversity20<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;acquiredIncrement&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;initialPoolSize&quot;</span>&gt;</span>10<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;minPoolSize&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxPoolSize&quot;</span>&gt;</span>20<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">default-config</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">    c3p0çš„å‘½åé…ç½®</span></span><br><span class="line"><span class="comment">    å¦‚æœåœ¨ä»£ç ä¸­ComboPooledDataSource ds=new ComboPooledDataSource(&quot;MySQL&quot;);è¿™æ ·å†™å°±è¡¨ç¤ºä½¿ç”¨çš„æ˜¯nameæ˜¯MySQL</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name-config</span> <span class="attr">name</span>=<span class="string">&quot;MySQL&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClass&quot;</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;jdbcUrl&quot;</span>&gt;</span>jdbc:mysql://localhost:3306/jdbcstudy?useUnicode=true<span class="symbol">&amp;amp;</span>characterEncoding=utf8<span class="symbol">&amp;amp;</span>useSSL=false<span class="symbol">&amp;amp;</span>serverTimezone=UTC<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span>&gt;</span>root<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span>xduniversity20<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;acquiredIncrement&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;initialPoolSize&quot;</span>&gt;</span>10<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;minPoolSize&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxPoolSize&quot;</span>&gt;</span>20<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">name-config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">c3p0-config</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å·¥å…·ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lesson5;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.mchange.v2.c3p0.ComboPooledDataSource;</span><br><span class="line"><span class="keyword">import</span> com.mysql.jdbc.Connection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JDBCC3P0Utils</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">DataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">//private static ComboPooledDataSource dataSource = null;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//ä»£ç æ–¹å¼é…ç½®</span></span><br><span class="line"><span class="comment">//            dataSource = new ComboPooledDataSource();</span></span><br><span class="line"><span class="comment">//            dataSource.setDriverClass();</span></span><br><span class="line"><span class="comment">//            dataSource.setJdbcUrl();</span></span><br><span class="line"><span class="comment">//            dataSource.setUser();</span></span><br><span class="line"><span class="comment">//            dataSource.setPassword();</span></span><br><span class="line"><span class="comment">//            dataSource.setMaxPoolSize();</span></span><br><span class="line"><span class="comment">//            dataSource.setMinPoolSize();</span></span><br><span class="line">            <span class="comment">//é…ç½®æ–‡ä»¶å†™æ³•</span></span><br><span class="line">            dataSource = <span class="keyword">new</span> <span class="title class_">ComboPooledDataSource</span>(<span class="string">&quot;MySQL&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> java.sql.Connection <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="comment">//ä»æ•°æ®æºä¸­è·å–è¿æ¥</span></span><br><span class="line">        <span class="keyword">return</span>  dataSource.getConnection();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é‡Šæ”¾èµ„æº</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">release</span><span class="params">(Connection con, PreparedStatement st, ResultSet rs)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (rs != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                rs.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (st != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                st.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (con != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                con.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æµ‹è¯•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> lesson5;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lesson2.JdbcUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestC3P0</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">con</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">PreparedStatement</span> <span class="variable">st</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            con = JDBCC3P0Utils.getConnection();</span><br><span class="line">            <span class="comment">//ä½¿ç”¨ï¼Ÿå ä½ç¬¦ä»£æ›¿å‚æ•°</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;INSERT INTO users(id,name,password,email,birthday) VALUES(?,?,?,?,?)&quot;</span>;</span><br><span class="line">            <span class="comment">//é¢„ç¼–è¯‘SQL å…ˆå†™SQLï¼Œç„¶åä¸æ‰§è¡Œ</span></span><br><span class="line">            st = con.prepareStatement(sql);</span><br><span class="line">            <span class="comment">//æ‰‹åŠ¨ç»™å‚æ•°èµ‹å€¼</span></span><br><span class="line">            st.setInt(<span class="number">1</span>,<span class="number">8</span>);</span><br><span class="line">            st.setString(<span class="number">2</span>,<span class="string">&quot;é»„ç‘å†¬&quot;</span>);</span><br><span class="line">            st.setString(<span class="number">3</span>,<span class="string">&quot;xduniversity20&quot;</span>);</span><br><span class="line">            st.setString(<span class="number">4</span>,<span class="string">&quot;huangruidong.xauat@gmail.com&quot;</span>);</span><br><span class="line">            st.setDate(<span class="number">5</span>,<span class="keyword">new</span> <span class="title class_">java</span>.sql.Date(<span class="keyword">new</span> <span class="title class_">java</span>.util.Date().getTime()));</span><br><span class="line">            <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> st.executeUpdate();</span><br><span class="line">            <span class="keyword">if</span>(num&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;æ’å…¥æˆåŠŸ&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            JDBCC3P0Utils.release((com.mysql.jdbc.Connection) con,st,rs);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>æ€»ç»“</p></blockquote><p>æ— è®ºç”¨ä»€ä¹ˆæ•°æ®æºï¼Œæœ¬è´¨è¿˜æ˜¯ä¸€æ ·çš„ï¼ŒDataSourceæ¥å£ä¸ä¼šå˜ï¼Œæ–¹æ³•å°±ä¸ä¼šå˜ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è®¡ç®—æœºåŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®åº“ </tag>
            
            <tag> Mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript</title>
      <link href="/2022/11/20/JavaScript/"/>
      <url>/2022/11/20/JavaScript/</url>
      
        <content type="html"><![CDATA[<h1 id="1ã€ä»€ä¹ˆæ˜¯javaScript"><a href="#1ã€ä»€ä¹ˆæ˜¯javaScript" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯javaScript"></a>1ã€ä»€ä¹ˆæ˜¯javaScript</h1><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220206212257251.png" alt="image-20220206212257251"></p><h1 id="2ã€JavaScript-å…¥é—¨"><a href="#2ã€JavaScript-å…¥é—¨" class="headerlink" title="2ã€JavaScript å…¥é—¨"></a>2ã€JavaScript å…¥é—¨</h1><h2 id="2-1-å¼•å…¥JavaScript"><a href="#2-1-å¼•å…¥JavaScript" class="headerlink" title="2.1 å¼•å…¥JavaScript"></a>2.1 å¼•å…¥JavaScript</h2><p>1.å†…éƒ¨æ ‡ç­¾</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">alert</span>(<span class="string">&#x27;hello world!!&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>2.å¤–éƒ¨æ ‡ç­¾</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">alert</span>(<span class="string">&#x27;hello world!&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/qt.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸ç”¨æ˜¾å¼å®šä¹‰type,é»˜è®¤å°±æ˜¯JavaScript</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;javascript&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æµ‹è¯•ä»£ç  </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--    1.å†…éƒ¨æ ‡ç­¾--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;script&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        alert(&#x27;hello world!!&#x27;)--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    &lt;/script&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--    2.å¤–éƒ¨å¼•å…¥--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    scriptæ ‡ç­¾å¿…é¡»æˆå¯¹å‡ºç°--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/qt.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--    ä¸ç”¨æ˜¾å¼å®šä¹‰type,é»˜è®¤å°±æ˜¯JavaScript--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;javascript&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-2-åŸºæœ¬è¯­æ³•å…¥é—¨"><a href="#2-2-åŸºæœ¬è¯­æ³•å…¥é—¨" class="headerlink" title="2.2 åŸºæœ¬è¯­æ³•å…¥é—¨"></a>2.2 åŸºæœ¬è¯­æ³•å…¥é—¨</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//1.å®šä¹‰å˜é‡ å˜é‡ç±»å‹ å˜é‡å = å˜é‡å€¼</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> score = <span class="number">71</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//2.æ¡ä»¶æ§åˆ¶</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span>(score&gt;<span class="number">60</span> &amp;&amp; score&lt;<span class="number">70</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">alert</span>(<span class="string">&#x27;60~70&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(score&gt;<span class="number">70</span> &amp;&amp; score&lt;<span class="number">80</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">alert</span>(<span class="string">&#x27;70~80&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">alert</span>(<span class="string">&#x27;other&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// console.log(score)  åœ¨æµè§ˆå™¨çš„æ§åˆ¶å°æ‰“å°å˜é‡ï¼System.out.println();</span></span></span><br><span class="line"><span class="language-javascript">        </span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220206221243355.png" alt="image-20220206221243355"></p><h2 id="2-3-æ•°æ®ç±»å‹"><a href="#2-3-æ•°æ®ç±»å‹" class="headerlink" title="2.3 æ•°æ®ç±»å‹"></a>2.3 æ•°æ®ç±»å‹</h2><p><strong>å˜é‡</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ç‹è€…è£è€€=<span class="string">&quot;åƒåœ¾&quot;</span>;<span class="comment">//æ”¯æŒä¸­æ–‡</span></span><br></pre></td></tr></table></figure><p><strong>number</strong></p><p>jsä¸åŒºåˆ†å°æ•°å’Œæ•´æ•°ï¼ŒNumber</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">123</span><span class="comment">//æ•´æ•°123</span></span><br><span class="line"><span class="number">123.1</span><span class="comment">//æµ®ç‚¹æ•°123.1</span></span><br><span class="line"><span class="number">1.123e3</span><span class="comment">//ç§‘å­¦è®¡æ•°æ³•</span></span><br><span class="line">-<span class="number">99</span><span class="comment">//å¤æ•°</span></span><br><span class="line"><span class="title class_">NaN</span><span class="comment">// not a number</span></span><br><span class="line"><span class="title class_">Infinty</span><span class="comment">//è¡¨ç¤ºæ— ç©·å¤§</span></span><br></pre></td></tr></table></figure><p><strong>å­—ç¬¦ä¸²</strong></p><p>â€˜abcâ€™ â€œabcâ€</p><p><strong>å¸ƒå°”å€¼</strong></p><p>trueï¼Œfalse</p><p><strong>é€»è¾‘è¿ç®—</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&amp;&amp;</span><br><span class="line">||</span><br><span class="line">!</span><br></pre></td></tr></table></figure><p>æ¯”è¾ƒè¿ç®—ç¬¦</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">=</span><br><span class="line">== ç­‰äºï¼ˆç±»å‹ä¸ä¸€æ ·ï¼Œå€¼ä¸€æ ·ï¼Œä¹Ÿä¼šåˆ¤æ–­ä¸º<span class="literal">true</span>ï¼‰</span><br><span class="line">===ç»å¯¹ç­‰äºï¼ˆåˆ¤æ–­ç±»å‹ï¼‰</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªjsçš„ç¼ºé™·ï¼ŒåšæŒä¸è¦ç”¨&#x3D;&#x3D;æ¯”è¾ƒ</p><p>é¡»çŸ¥ï¼š</p><ul><li>NaN&#x3D;&#x3D;&#x3D;NaN,è¿™ä¸ªä¸æ‰€æœ‰çš„æ•°å€¼éƒ½ä¸ç›¸ç­‰ï¼ŒåŒ…æ‹¬è‡ªå·±</li><li>åªé€šè¿‡isNaN(NaN)æ¥åˆ¤æ–­è¿™ä¸ªæ•°æ˜¯å¦æ˜¯NaN</li></ul><p>æµ®ç‚¹æ•°é—®é¢˜</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>/<span class="number">3</span>)===(<span class="number">1</span>-<span class="number">2</span>/<span class="number">3</span>)</span><br></pre></td></tr></table></figure><p>å°½é‡é¿å…ä½¿ç”¨æµ®ç‚¹æ•°æƒŠé†’è¿ç®—ï¼Œå­˜åœ¨ç²¾åº¦é—®é¢˜ï¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Math</span>.<span class="title function_">abs</span>(<span class="number">1</span>/<span class="number">3</span>-(<span class="number">1</span>-<span class="number">2</span>/<span class="number">3</span>))&lt;<span class="number">0.00000001</span></span><br></pre></td></tr></table></figure><p><strong>nullå’Œunderfined</strong></p><ul><li>null ç©º</li><li>underfined æœªå®šä¹‰</li></ul><p><strong>æ•°ç»„</strong></p><p>Javaçš„æ•°ç»„å¿…é¡»æ˜¯ç›¸åŒç±»å‹çš„å¯¹è±¡ï¼Œjsä¸­ä¸éœ€è¦è¿™æ ·ï¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä¿è¯ä»£ç å¯è¯»æ€§ï¼Œå°½é‡ä½¿ç”¨[]</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="string">&#x27;hello&#x27;</span>,<span class="literal">null</span>,<span class="literal">true</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="string">&#x27;hello&#x27;</span>,<span class="literal">null</span>,<span class="literal">true</span>);</span><br></pre></td></tr></table></figure><p>å–æ•°ç»„ä¸‹æ ‡:å¦‚æœè¶Šç•Œäº†ï¼Œå°±ä¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">underfined</span><br></pre></td></tr></table></figure><p>å¯¹è±¡</p><p>å¯¹è±¡æ˜¯å¤§æ‹¬å·ï¼Œæ•°ç»„æ˜¯ä¸­æ‹¬å·</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// Person person = new Person();</span></span><br><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&#x27;hrd&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="number">3</span>,</span><br><span class="line">    <span class="attr">tags</span>:[<span class="string">&#x27;js&#x27;</span>,<span class="string">&#x27;java&#x27;</span>,<span class="string">&#x27;web&#x27;</span>,<span class="string">&#x27;...&#x27;</span>]</span><br><span class="line">    <span class="comment">//æœ‰ç‚¹åƒsql å­—ç¬¦ä¸²ç”¨&#x27;&#x27; è¯­å¥æœ€åä¸€è¡Œä¸åŠ ,</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å»å¯¹è±¡çš„å€¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">person.<span class="property">age</span></span><br><span class="line">person.<span class="property">name</span></span><br></pre></td></tr></table></figure><h2 id="2-4-ä¸¥æ ¼æ£€æŸ¥æ¨¡å¼"><a href="#2-4-ä¸¥æ ¼æ£€æŸ¥æ¨¡å¼" class="headerlink" title="2.4 ä¸¥æ ¼æ£€æŸ¥æ¨¡å¼"></a>2.4 ä¸¥æ ¼æ£€æŸ¥æ¨¡å¼</h2><p>â€˜use strictâ€™</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//&#x27;use strict&#x27;ä¸¥æ ¼æ£€æŸ¥æ¨¡å¼ï¼Œé¢„é˜²JavaScriptçš„éšæ„æ€§å¯¼è‡´äº§ç”Ÿä¸€äº›é—®é¢˜</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//å¿…é¡»å†™åœ¨JavaScriptä»£ç çš„ç¬¬ä¸€è¡Œ</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//å±€éƒ¨å˜é‡ç”¨letå®šä¹‰</span></span></span><br><span class="line"><span class="language-javascript"><span class="meta">        &#x27;use strict&#x27;</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> i = <span class="number">6</span>;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="3ã€æ•°æ®ç±»å‹"><a href="#3ã€æ•°æ®ç±»å‹" class="headerlink" title="3ã€æ•°æ®ç±»å‹"></a>3ã€æ•°æ®ç±»å‹</h1><h2 id="3-1-å­—ç¬¦ä¸²"><a href="#3-1-å­—ç¬¦ä¸²" class="headerlink" title="3.1 å­—ç¬¦ä¸²"></a>3.1 å­—ç¬¦ä¸²</h2><p>1.æ­£å¸¸å­—ç¬¦ä¸²æˆ‘ä»¬ä½¿ç”¨å•å¼•å·ï¼Œæˆ–è€…åŒå¼•å·åŒ…è£¹</p><p>2.æ³¨æ„è½¬ä¹‰å­—ç¬¦\</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">\&#x27;</span><br><span class="line">\n</span><br><span class="line">\t</span><br><span class="line">\u4e2d   //u#### unicodeå­—ç¬¦</span><br><span class="line">\x41     //ascllå­—ç¬¦</span><br></pre></td></tr></table></figure><p>3.å¤šè¡Œå­—ç¬¦ä¸²ç¼–å†™</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> msg = </span><br><span class="line">            <span class="string">`</span></span><br><span class="line"><span class="string">            hello </span></span><br><span class="line"><span class="string">            world</span></span><br><span class="line"><span class="string">            ä½ å¥½</span></span><br><span class="line"><span class="string">            `</span></span><br><span class="line"><span class="comment">//table ä¸Šçš„`</span></span><br></pre></td></tr></table></figure><p>4.æ¨¡æ¿å­—ç¬¦ä¸²</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = <span class="string">&#x27;huang r d&#x27;</span>;</span><br><span class="line"><span class="keyword">let</span> age = <span class="number">19</span>;</span><br><span class="line"><span class="keyword">let</span> msg = <span class="string">`ä½ å¥½å‘€,<span class="subst">$&#123;name&#125;</span>,<span class="subst">$&#123;age&#125;</span>`</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(msg);</span><br><span class="line">&gt;:<span class="number">1</span> ä½ å¥½å‘€,huang r d,<span class="number">19</span></span><br></pre></td></tr></table></figure><p>5.å­—ç¬¦ä¸²é•¿åº¦</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">str.<span class="property">length</span>;</span><br></pre></td></tr></table></figure><p>6.å­—ç¬¦ä¸²çš„å¯å˜æ€§ï¼Œä¸å˜æ€§</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> name = <span class="string">&#x27;huang r d&#x27;</span>;</span><br><span class="line">name[<span class="number">0</span>] = <span class="string">&#x27;l&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(name)</span><br><span class="line">&gt;:huang r d</span><br></pre></td></tr></table></figure><p>7.å¤§å°å†™è½¬åŒ–ï¼Œå’Œc++ï¼Œjavaä¸€æ ·</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¿™é‡Œæ˜¯æ–¹æ³•ï¼Œä¸æ˜¯å±æ€§</span></span><br><span class="line">str.<span class="title function_">toUpperCase</span>();</span><br><span class="line">str.<span class="title function_">toLowerCase</span>();</span><br></pre></td></tr></table></figure><p>8.è·å–å­—ç¬¦çš„ä½ç½®ï¼Œè¿”å›æœ€å‰é¢çš„ä½ç½®</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name.<span class="title function_">indexOf</span>(<span class="string">&#x27;t&#x27;</span>)</span><br></pre></td></tr></table></figure><p>9.<strong>substring</strong>å­—ç¬¦ä¸²æˆªå–</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æˆªå–æ–¹å¼[)</span></span><br><span class="line">str.<span class="title function_">substring</span>(<span class="number">1</span>)<span class="comment">//ä¸€ä¸ªå­—ç¬¦ä¸²æˆªå–åˆ°æœ€åä¸€ä¸ªå­—ç¬¦ä¸²</span></span><br><span class="line">str.<span class="title function_">substring</span>(<span class="number">1</span>,<span class="number">3</span>)<span class="comment">//[1,3)</span></span><br></pre></td></tr></table></figure><p>10.è®¿é—®å­—ç¬¦ä¸²æŒ‡å®šä½ç½®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c++ : []</span><br><span class="line">java : str.charAt()</span><br><span class="line">javaScript: [] str.charAt() éƒ½å¯ä»¥</span><br></pre></td></tr></table></figure><h2 id="3-2-å­—ç¬¦ä¸²"><a href="#3-2-å­—ç¬¦ä¸²" class="headerlink" title="3.2 å­—ç¬¦ä¸²"></a>3.2 å­—ç¬¦ä¸²</h2><p><strong>Arrayå¯ä»¥åŒ…å«ä»»æ„çš„æ•°æ®ç±»å‹</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>];<span class="comment">//é€šè¿‡ä¸‹æ ‡å–å€¼å’Œèµ‹å€¼</span></span><br><span class="line">arr[<span class="number">0</span>]</span><br><span class="line">arr[<span class="number">0</span>]=<span class="number">1</span></span><br></pre></td></tr></table></figure><p>1.é•¿åº¦</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr.<span class="property">length</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šåŠ å…¥ç»™arr.lengthèµ‹å€¼ï¼Œæ•°å€¼å¤§å°å°±ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå¦‚æœèµ‹å€¼è¿‡å°ï¼Œå…ƒç´ å°±ä¼šä¸¢å¤±</p><p>2.indexOfï¼Œé€šè¿‡å…ƒç´ è·å¾—ä¸‹æ ‡ç´¢å¼•</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">arr.<span class="title function_">indexOf</span>(<span class="number">2</span>)</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure><p>å­—ç¬¦ä¸²çš„â€1â€å’Œæ•°å­—1æ˜¯ä¸åŒçš„</p><p><strong>3.slice()    æˆªå–Arrayçš„ä¸€éƒ¨åˆ†ï¼Œè¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼Œç±»ä¼¼äºStringçš„substring</strong></p><p>4.push(),pop()ç±»ä¼¼äºæ ˆï¼ˆåœ¨å°¾éƒ¨æ“ä½œï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">push:å…¥æ ˆ</span><br><span class="line">pop:å‡ºæ ˆ</span><br></pre></td></tr></table></figure><p>5.unshift(),shift()     ç±»ä¼¼äºæ ˆï¼ˆåœ¨å¤´éƒ¨æ“ä½œï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">unshift:å…¥æ ˆ</span><br><span class="line">shift:å‡ºæ ˆ</span><br></pre></td></tr></table></figure><p>6.æ’åºsort()</p><p>7.å…ƒç´ åè½¬ reverse()</p><p>8.concat()æ•°ç»„æ‹¼æ¥</p><p>æ³¨æ„ï¼šconcat()å¹¶æ²¡æœ‰ä¿®æ”¹æ•°ç»„ï¼Œåªä¼šè¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„</p><p>9.è¿æ¥ç¬¦join</p><p>æ‰“å°æ‹¼æ¥æ•°ç»„ï¼Œä½¿ç”¨ç‰¹å®šçš„å­—ç¬¦ä¸²è¿æ¥</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>]</span><br><span class="line">arr.<span class="title function_">join</span>(<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line"><span class="string">&quot;a-b-c&quot;</span></span><br></pre></td></tr></table></figure><p>10.å¤šç»´æ•°ç»„</p><p>å’ŒJavaï¼Œc++ä¸€æ ·</p><h2 id="3-3-å¯¹è±¡"><a href="#3-3-å¯¹è±¡" class="headerlink" title="3.3 å¯¹è±¡"></a>3.3 å¯¹è±¡</h2><p>è‹¥å¹²ä¸ªé”®å€¼å¯¹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> å¯¹è±¡å = &#123;</span><br><span class="line">å±æ€§å: å±æ€§å€¼,</span><br><span class="line">    å±æ€§å: å±æ€§å€¼,</span><br><span class="line">    å±æ€§å: å±æ€§å€¼</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å®šä¹‰ä¸€ä¸ªpersonå¯¹è±¡</span></span><br><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">    name = <span class="string">&quot;huang r d&quot;</span></span><br><span class="line">    age = <span class="number">3</span>,</span><br><span class="line">    email = <span class="string">&quot;huangruidong.xauat@gmail&quot;</span>,</span><br><span class="line">    <span class="attr">score</span>:<span class="number">100</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>jsä¸­å¯¹è±¡,{â€¦.}è¡¨ç¤ºä¸€ä¸ªå¯¹è±¡ï¼Œé”®å€¼å¯¹æè¿°å±æ€§xxxx:xxxx,å¤šä¸ªå±æ€§ä¹‹é—´ä½¿ç”¨é€—å·æ–­å¼€ï¼Œæœ€åä¸€ä¸ªå±æ€§ä¸åŠ é€—å·ï¼</p><p><strong>jsä¸­æ‰€æœ‰çš„é”®éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œå€¼æ˜¯ä»»æ„å¯¹è±¡ï¼</strong></p><p>1.å¯¹è±¡èµ‹å€¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">person.<span class="property">name</span> = <span class="string">&quot;huang rui dong&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2.ä½¿ç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„å¯¹è±¡å±æ€§ï¼Œä¸ä¼šæŠ¥é”™ï¼undefined</p><p>3.åŠ¨æ€åˆ å‡å±æ€§ï¼Œé€šè¿‡deleteåˆ é™¤å¯¹è±¡çš„å±æ€§ ï¼ˆå¥½éšæ„ï¼‰</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> person.<span class="property">name</span></span><br></pre></td></tr></table></figure><p>4.åŠ¨æ€æ·»åŠ å±æ€§ï¼Œç›´æ¥ç»™æ–°çš„å±æ€§æ·»åŠ å€¼å³å¯</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">person.<span class="property">haha</span> = <span class="string">&quot;haha&quot;</span></span><br></pre></td></tr></table></figure><p>5.åˆ¤æ–­å±æ€§å€¼æ˜¯å¦åœ¨è¿™ä¸ªå¯¹è±¡ä¸­ï¼xxx in  xxx</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;age&#x27;</span> <span class="keyword">in</span> person</span><br><span class="line"><span class="literal">true</span></span><br><span class="line"><span class="comment">//ç»§æ‰¿</span></span><br><span class="line"><span class="string">&#x27;toString&#x27;</span> <span class="keyword">in</span> person</span><br><span class="line"><span class="literal">true</span></span><br></pre></td></tr></table></figure><p>6.åˆ¤æ–­ä¸€ä¸ªå±æ€§æ˜¯å¦æ˜¯è¿™ä¸ªå¯¹è±¡è‡ªèº«æ‹¥æœ‰çš„hasOwnProperty()</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">person.<span class="title function_">hasOwnProperty</span>(<span class="string">&#x27;toString&#x27;</span>)</span><br><span class="line"><span class="literal">false</span></span><br><span class="line">person.<span class="title function_">hasOwnProperty</span>(<span class="string">&#x27;age&#x27;</span>)</span><br><span class="line"><span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="3-4-æµç¨‹æ§åˆ¶"><a href="#3-4-æµç¨‹æ§åˆ¶" class="headerlink" title="3.4 æµç¨‹æ§åˆ¶"></a>3.4 æµç¨‹æ§åˆ¶</h2><p>ifâ€¦else</p><p>while</p><p>do while</p><p>for</p><p>forEashå¾ªç¯     5.1å¼•å…¥</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°</span></span><br><span class="line"><span class="keyword">var</span> age = [<span class="number">12</span>,<span class="number">3</span>,<span class="number">45</span>,<span class="number">15</span>,<span class="number">7</span>,<span class="number">8</span>];</span><br><span class="line">        age.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">value</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(value);</span><br><span class="line">        &#125;)</span><br></pre></td></tr></table></figure><p>for  in</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> age = [<span class="number">12</span>,<span class="number">3</span>,<span class="number">45</span>,<span class="number">15</span>,<span class="number">7</span>,<span class="number">8</span>];</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">var</span> num <span class="keyword">in</span> age) &#123;</span><br><span class="line">          <span class="keyword">if</span>(age.<span class="title function_">hasOwnProperty</span>(num))&#123;</span><br><span class="line">              <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å­˜åœ¨&quot;</span>);</span><br><span class="line">              <span class="variable language_">console</span>.<span class="title function_">log</span>(age[num])</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><h2 id="3-5-Map-å’Œ-Set"><a href="#3-5-Map-å’Œ-Set" class="headerlink" title="3.5 Map å’Œ Set"></a>3.5 Map å’Œ Set</h2><p>ES6æ–°ç‰¹æ€§</p><p>Map</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">Map</span>([[<span class="string">&#x27;tom&#x27;</span>,<span class="number">10</span>],[<span class="string">&#x27;jack&#x27;</span>,<span class="number">20</span>]],[<span class="string">&#x27;jerry&#x27;</span>,<span class="number">50</span>]);</span><br><span class="line">      <span class="keyword">var</span> name = map.<span class="title function_">get</span>(<span class="string">&#x27;tom&#x27;</span>);<span class="comment">//é€šè¿‡keyå€¼è·å–value</span></span><br><span class="line">      map.<span class="title function_">set</span>(<span class="string">&#x27;litiy&#x27;</span>,<span class="number">88</span>);<span class="comment">//æ–°å¢æˆ–å’Œä¿®æ”¹</span></span><br><span class="line">      map.<span class="title function_">delete</span>(<span class="string">&#x27;tom&#x27;</span>);<span class="comment">//åˆ é™¤</span></span><br></pre></td></tr></table></figure><p>Set</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> set = <span class="keyword">new</span> <span class="title class_">Set</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">5</span>]);<span class="comment">//setå¯ä»¥å»é‡</span></span><br><span class="line">        set.<span class="title function_">add</span>(<span class="number">7</span>);</span><br><span class="line">        set.<span class="title function_">delete</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(set.<span class="title function_">has</span>(<span class="number">3</span>));<span class="comment">//æ˜¯å¦åŒ…å«æŸä¸ªå…ƒç´ </span></span><br></pre></td></tr></table></figure><h2 id="3-6-iterator"><a href="#3-6-iterator" class="headerlink" title="3.6 iterator"></a>3.6 iterator</h2><p>es6æ–°ç‰¹æ€§</p><p>éå†æ•°ç»„</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> x <span class="keyword">of</span> arr)&#123;</span><br><span class="line">   <span class="variable language_">console</span>.<span class="title function_">log</span>(x)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éå†map</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="title class_">Map</span>([[<span class="string">&#x27;tom&#x27;</span>,<span class="number">10</span>],[<span class="string">&#x27;jack&#x27;</span>,<span class="number">20</span>],[<span class="string">&#x27;jerry&#x27;</span>,<span class="number">50</span>]]);</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> x <span class="keyword">of</span> map) &#123;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(x)</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><p>éå†set</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> set = <span class="keyword">new</span> <span class="title class_">Set</span>([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">5</span>]);</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">let</span> x <span class="keyword">of</span> set)&#123;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(x)</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><h1 id="4ã€å‡½æ•°"><a href="#4ã€å‡½æ•°" class="headerlink" title="4ã€å‡½æ•°"></a>4ã€å‡½æ•°</h1><h2 id="4-1-å®šä¹‰å‡½æ•°"><a href="#4-1-å®šä¹‰å‡½æ•°" class="headerlink" title="4.1 å®šä¹‰å‡½æ•°"></a>4.1 å®šä¹‰å‡½æ•°</h2><blockquote><p>å®šä¹‰æ–¹å¼ä¸€</p></blockquote><p>ç»å¯¹å€¼å‡½æ•°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">abs</span>(<span class="params">x</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(x&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> -x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å®šä¹‰æ–¹å¼äºŒ</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> abs = <span class="keyword">function</span> (<span class="params">x</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(x&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> -x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>function(x){â€¦.}è¿™æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œä½†æ˜¯å¯ä»¥æŠŠå€¼èµ‹ç»™abs,é€šè¿‡abså¯ä»¥è°ƒç”¨å‡½æ•°ï¼Œæ–¹å¼ä¸€ã€æ–¹å¼äºŒç­‰ä»·ã€‚</p><blockquote><p>è°ƒç”¨å‡½æ•°</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">abs</span>(<span class="number">10</span>)</span><br><span class="line"><span class="title function_">abs</span>(-<span class="number">10</span>)</span><br></pre></td></tr></table></figure><p>å‚æ•°é—®é¢˜ï¼šjavaScriptå¯ä»¥ç©¿ä»»æ„ä¸ªå‚æ•°ï¼Œä¹Ÿå¯ä»¥ä¸ä¼ é€’å‚æ•°</p><p>å‚æ•°è¿›æ¥æ˜¯å¦å­˜åœ¨é—®é¢˜ï¼Ÿå‡è®¾ä¸å­˜åœ¨å‚æ•°ï¼Œå¦‚ä½•è§„é¿ï¼Ÿ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> abs = <span class="keyword">function</span> (<span class="params">x</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> x !== <span class="string">&#x27;number&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="string">&#x27;not a number&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(x&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> -x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>arguments</p></blockquote><p>argumentsæ˜¯ä¸€ä¸ªjså…è´¹èµ é€çš„å…³é”®å­—ï¼›</p><p>ä»£è¡¨ï¼Œä¼ é€’è¿›æ¥æ˜¯ä¸€ä¸ªæ•°ç»„ï¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> abs = <span class="keyword">function</span> (<span class="params">x</span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;x=&gt;&quot;</span>+x);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">arguments</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">arguments</span>[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(x&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> -x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é—®é¢˜ï¼šargumentså·²ç»åŒ…å«æ‰€æœ‰çš„å‚æ•°ï¼Œæˆ‘ä»¬æœ‰æ—¶å€™æƒ³ä½¿ç”¨å¤šä½™çš„å‚æ•°æ¥è­¦é†’é™„åŠ æ“ä½œï¼Œéœ€è¦æ’é™¤å·²ç»æœ‰çš„å‚æ•°</p><blockquote><p>rest</p></blockquote><p>ä»¥å‰</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable language_">arguments</span>.<span class="property">length</span>&gt;<span class="number">2</span>)&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">arguments</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        <span class="comment">//.......</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç°åœ¨</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> abs = <span class="keyword">function</span> (<span class="params">x,...rest</span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;x=&gt;&quot;</span>+x);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(rest)</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>restå‚æ•°åªèƒ½å†™åœ¨æœ€åé¢ï¼Œå¿…é¡»ç”¨â€¦æ ‡è¯†</p><h2 id="4-2-å˜é‡çš„ä½œç”¨åŸŸ"><a href="#4-2-å˜é‡çš„ä½œç”¨åŸŸ" class="headerlink" title="4.2 å˜é‡çš„ä½œç”¨åŸŸ"></a>4.2 å˜é‡çš„ä½œç”¨åŸŸ</h2><p>åœ¨jsä¸­ï¼Œvarå®šä¹‰å˜é‡å®é™…æ˜¯æœ‰ä½œç”¨åŸŸçš„ã€‚</p><p>å‡è®¾å‡½æ•°ä½“ä¸­å£°æ˜ï¼Œåˆ™å‡½æ•°ä½“å¤–ä¸å¯ä½¿ç”¨~ï¼ˆé—­åŒ…ï¼‰</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">haha</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> x = <span class="number">1</span>;</span><br><span class="line">    x= x+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">x = x+<span class="number">2</span>;<span class="comment">//Uncaught ReferenceError: x is not defined</span></span><br></pre></td></tr></table></figure><p>å¦‚æœä¸¤ä¸ªå‡½æ•°ä½¿ç”¨äº†ç›¸åŒçš„å˜é‡åï¼Œåªè¦åœ¨å‡½æ•°å‘¢ä¸å°±ä¸å†²çª</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">f1</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> x = <span class="number">1</span>;</span><br><span class="line">    x = x+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">f2</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> x =<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">    x = x+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†…éƒ¨å‡½æ•°å¯ä»¥è®¿é—®å¤–éƒ¨å‡½æ•°çš„æˆå‘˜ï¼Œåä¹‹ä¸è¡Œ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> x = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">f1</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> y = x+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> z = y+<span class="number">1</span>;<span class="comment">//Uncaught ReferenceError: y is not defined</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‡è®¾ï¼Œå†…éƒ¨å‡½æ•°å’Œå¤–éƒ¨å‡½æ•°çš„å˜é‡ï¼Œé‡åï¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> x =<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">f1</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> x =<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;in&quot;</span>+x);<span class="comment">//é‡Œè¾¹</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;out&quot;</span>+x)<span class="comment">//å¤–è¾¹</span></span><br><span class="line">    <span class="title function_">f1</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨JavaScriptä¸­ï¼Œå‡½æ•°æŸ¥æ‰¾å˜é‡ä»è‡ªèº«å‡½æ•°å¼€å§‹ï¼Œç”±å†…åˆ°å¤–æŸ¥æ‰¾ï¼Œå¦‚æœå¤–éƒ¨å­˜åœ¨è¿™ä¸ªåŒåçš„å‡½æ•°å˜é‡ï¼Œåˆ™å†…éƒ¨å‡½æ•°ä¼šå±è”½å¤–éƒ¨å‡½æ•°çš„å˜é‡ã€‚</p><blockquote><p>æå‡å˜é‡çš„ä½œç”¨åŸŸ</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> x = <span class="string">&quot;x&quot;</span>+y;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x);</span><br><span class="line">    <span class="keyword">var</span> y = <span class="string">&quot;y&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœï¼šx undefind</p><p>è¯´æ˜ï¼šjsæ‰§è¡Œå¼•æ“ï¼Œè‡ªåŠ¨æå‡äº†yçš„å£°æ˜ï¼Œä½†æ˜¯ä¸ä¼šæå‡yçš„èµ‹å€¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> y;</span><br><span class="line">    <span class="keyword">var</span> x = <span class="string">&quot;x&quot;</span>+y;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯JavaScriptå»ºç«‹ä¹‹åˆå°±å­˜åœ¨çš„ç‰¹æ€§ã€‚å…»æˆè§„èŒƒï¼šæ‰€æœ‰å˜é‡å®šä¹‰éƒ½æ”¾åœ¨å‡½æ•°çš„å¤´éƒ¨ï¼Œä¸è¦ä¹±æ”¾ï¼Œä¾¿äºä»£ç ç»´æŠ¤ï¼›</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> x=<span class="number">1</span>,</span><br><span class="line">        y=x+<span class="number">1</span>,</span><br><span class="line">        z,i,a;<span class="comment">//undefined</span></span><br><span class="line">    <span class="comment">//ä¹‹åéšä¾¿ä½¿ç”¨</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å…¨å±€å‡½æ•°</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å…¨å±€å˜é‡</span></span><br><span class="line">x = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">f</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(x);</span><br></pre></td></tr></table></figure><p>å…¨å±€å˜é‡window</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="string">&quot;xxx&quot;</span>;</span><br><span class="line"><span class="title function_">alert</span>(x);</span><br><span class="line"><span class="title function_">alert</span>(<span class="variable language_">window</span>.<span class="property">x</span>);<span class="comment">//é»˜è®¤æ‰€æœ‰çš„å…¨å±€å˜é‡ï¼Œéƒ½ä¼šè‡ªåŠ¨ç»‘å®šåœ¨windowçš„å¯¹è±¡ä¸‹</span></span><br></pre></td></tr></table></figure><p>alert()è¿™ä¸ªå‡½æ•°æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ª<strong>window</strong>å˜é‡</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x =<span class="string">&quot;xxxx&quot;</span>;</span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">alert</span>(x);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> old_alert = <span class="variable language_">window</span>.<span class="property">alert</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//alertå¤±æ•ˆäº†</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">alert</span>(<span class="number">123</span>);</span><br><span class="line"><span class="comment">//æ¢å¤</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">alert</span> = old_alert;</span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">alert</span>(<span class="number">456</span>);</span><br></pre></td></tr></table></figure><p>JavaScriptå®é™…ä¸Šåªæœ‰ä¸€ä¸ªå…¨å±€ä½œç”¨åŸŸï¼Œä»»ä½•å˜é‡ï¼ˆå‡½æ•°ä¹Ÿå¯ä»¥è§†ä¸ºå˜é‡ï¼‰ï¼Œå‡è®¾æ²¡æœ‰åœ¨å‡½æ•°ä½œç”¨èŒƒå›´å†…æ‰¾åˆ°ï¼Œå°±ä¼šå‘å¤–æŸ¥æ‰¾ï¼Œå¦‚æœå…¨å±€ä½œç”¨åŸŸéƒ½æ²¡æœ‰æ‰¾åˆ°ï¼ŒæŠ¥é”™    RefrenceError</p><blockquote><p>è§„èŒƒ</p></blockquote><p>ç”±äºæˆ‘é—®æ‰€æœ‰çš„å…¨å±€å˜é‡éƒ½ä¼šç»‘å®šåˆ°æˆ‘ä»¬çš„windowä¸Šã€‚å¦‚æœä¸åŒçš„jsæ–‡ä»¶ï¼Œä½¿ç”¨äº†ç›¸åŒçš„å…¨å±€å˜é‡ï¼Œå°±ä¼šå‘ç”Ÿå†²çªã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å”¯ä¸€çš„å…¨å±€å˜é‡</span></span><br><span class="line"><span class="keyword">var</span> hrd = &#123;&#125;;</span><br><span class="line"><span class="comment">//å®šä¹‰å…¨å±€å˜é‡</span></span><br><span class="line">hrd.<span class="property">name</span> = <span class="string">&quot;haung rui dong&quot;</span>;</span><br><span class="line">hrd.<span class="property">add</span>=<span class="keyword">function</span> (<span class="params">a,b</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŠŠè‡ªå·±çš„ä»£ç å…¨éƒ¨æ”¾å…¥è‡ªå·±å®šä¹‰çš„å”¯ä¸€ç©ºé—´åå­—ä¸­ï¼Œé™ä½å…¨å±€å‘½åå†²çªçš„é—®é¢˜~</p><p>jQuery</p><blockquote><p>å±€éƒ¨ä½œç”¨åŸŸ let</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt;<span class="number">100</span>; i++) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i+<span class="number">1</span>);<span class="comment">//å‡ºé—®é¢˜ï¼Œiå‡ºäº†ä½œç”¨åŸŸè¿˜èƒ½ä½¿ç”¨</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ES6 letå…³é”®å­—ï¼Œè§£å†³å±€éƒ¨ä½œç”¨åŸŸå†²çªé—®é¢˜ï¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">f</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt;<span class="number">100</span>; i++) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i+<span class="number">1</span>);<span class="comment">//Uncaught ReferenceError: i is not defined</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å»ºè®®ä½¿ç”¨<strong>let</strong>å®šä¹‰å±€éƒ¨ä½œç”¨åŸŸçš„å˜é‡ã€‚</p><blockquote><p>å¸¸é‡const</p></blockquote><p>ES6ä¹‹å‰ï¼Œè®¤ä¸ºè§„å®šï¼Œå…¨éƒ¨ä¸ºå¤§å†™å­—æ¯åˆ™ä¸ºå¸¸é‡ï¼Œå»ºè®®ä¸è¦ä¿®æ”¹è¿™æ ·çš„å€¼ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="variable constant_">PI</span> =<span class="number">3.14</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable constant_">PI</span>);</span><br><span class="line"><span class="variable constant_">PI</span> = <span class="number">5.18</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable constant_">PI</span>);<span class="comment">//piå¯ä»¥è¢«ä¿®æ”¹</span></span><br></pre></td></tr></table></figure><p>ES6 è§£å†³å¸¸é‡é—®é¢˜ï¼Œå¼•å…¥å…³é”®å­— <strong>const</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">PI</span> =<span class="number">3.14</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable constant_">PI</span>);</span><br><span class="line"><span class="variable constant_">PI</span> = <span class="number">5.18</span>;<span class="comment">//constä¸å¯ä»¥è¢«ä¿®æ”¹</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable constant_">PI</span>);</span><br></pre></td></tr></table></figure><h2 id="4-3-æ–¹æ³•"><a href="#4-3-æ–¹æ³•" class="headerlink" title="4.3 æ–¹æ³•"></a>4.3 æ–¹æ³•</h2><blockquote><p>å®šä¹‰æ–¹æ³•</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> hrd =&#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&#x27;huang rui dong&#x27;</span>,</span><br><span class="line">    <span class="attr">birthday</span>:<span class="number">2002</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">//ä»Šå¹´-å‡ºç”Ÿçš„å¹´</span></span><br><span class="line">        <span class="keyword">var</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getFullYear</span>();</span><br><span class="line">        <span class="keyword">return</span> now-<span class="variable language_">this</span>.<span class="property">birthday</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å±æ€§</span></span><br><span class="line">hrd.<span class="property">name</span></span><br><span class="line"><span class="comment">//æ–¹æ³•ï¼Œä¸€å®šè¦å¸¦()</span></span><br><span class="line">hrd.<span class="title function_">age</span>()</span><br></pre></td></tr></table></figure><p>thisè¡¨ç¤ºä»€ä¹ˆï¼Ÿ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">function <span class="title function_">f</span> <span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//ä»Šå¹´-å‡ºç”Ÿçš„å¹´</span></span><br><span class="line">    <span class="type">var</span> <span class="variable">now</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Date</span>().getFullYear();</span><br><span class="line">    <span class="keyword">return</span> now-<span class="built_in">this</span>.birthday;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">var</span> <span class="variable">hrd</span> <span class="operator">=</span>&#123;</span><br><span class="line">    name:<span class="string">&#x27;huang rui dong&#x27;</span>,</span><br><span class="line">    birthday:<span class="number">2002</span>,</span><br><span class="line">    age:f</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//hrd.age()</span></span><br><span class="line"><span class="comment">//f()Nan å› ä¸ºwindowæ²¡æœ‰age</span></span><br></pre></td></tr></table></figure><p>thisæ˜¯æ— æ³•æŒ‡å‘çš„ï¼Œæ˜¯é»˜è®¤æŒ‡å‘è°ƒç”¨å®ƒçš„é‚£ä¸ªå¯¹è±¡</p><blockquote><p>apply</p></blockquote><p>åœ¨JavaScriptä¸­å¯ä»¥æ§åˆ¶thisçš„æŒ‡å‘ï¼</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">f</span> () &#123;</span><br><span class="line">    <span class="comment">//ä»Šå¹´-å‡ºç”Ÿçš„å¹´</span></span><br><span class="line">    <span class="keyword">var</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getFullYear</span>();</span><br><span class="line">    <span class="keyword">return</span> now-<span class="variable language_">this</span>.<span class="property">birthday</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> hrd =&#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&#x27;huang rui dong&#x27;</span>,</span><br><span class="line">    <span class="attr">birthday</span>:<span class="number">2002</span>,</span><br><span class="line">    <span class="attr">age</span>:f</span><br><span class="line">&#125;</span><br><span class="line">f.<span class="title function_">apply</span>(hrd,[]);<span class="comment">//thisï¼ŒæŒ‡å‘äº†hrdï¼Œå‚æ•°ä¸ºç©º</span></span><br></pre></td></tr></table></figure><h1 id="5ã€-å†…éƒ¨å¯¹è±¡"><a href="#5ã€-å†…éƒ¨å¯¹è±¡" class="headerlink" title="5ã€ å†…éƒ¨å¯¹è±¡"></a>5ã€ å†…éƒ¨å¯¹è±¡</h1><blockquote><p>æ ‡å‡†å¯¹è±¡</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typeof</span> <span class="number">123</span></span><br><span class="line"><span class="string">&#x27;number&#x27;</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="string">&#x27;1230&#x27;</span></span><br><span class="line"><span class="string">&#x27;string&#x27;</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="literal">true</span></span><br><span class="line"><span class="string">&#x27;boolean&#x27;</span></span><br><span class="line"><span class="keyword">typeof</span> []</span><br><span class="line"><span class="string">&#x27;object&#x27;</span></span><br><span class="line"><span class="keyword">typeof</span> <span class="title class_">NaN</span></span><br><span class="line"><span class="string">&#x27;number&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="5-1-Date"><a href="#5-1-Date" class="headerlink" title="5.1 Date"></a>5.1 Date</h2><p>åŸºæœ¬ä½¿ç”¨</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">now.<span class="title function_">getFullYear</span>();<span class="comment">//å¹´</span></span><br><span class="line">now.<span class="title function_">getMonth</span>();</span><br><span class="line">now.<span class="title function_">getDay</span>();<span class="comment">//æ˜ŸæœŸå‡ </span></span><br><span class="line">now.<span class="title function_">getDate</span>();<span class="comment">//å¤©</span></span><br><span class="line">now.<span class="title function_">getHours</span>();</span><br><span class="line">now.<span class="title function_">getMinutes</span>();</span><br><span class="line">now.<span class="title function_">getSeconds</span>();</span><br><span class="line"></span><br><span class="line">now.<span class="title function_">getTime</span>();<span class="comment">//è·å¾—å½“å‰æ—¶é—´æˆ³            å…¨ä¸–ç•Œç»Ÿä¸€ï¼Œ1970 1.1 0ï¼š00ï¼š00 æ¯«ç§’æ•°</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">new</span> <span class="title class_">Date</span>(<span class="number">1644567496458</span>));<span class="comment">//æ—¶é—´æˆ³ï¼Œè½¬æ—¶é—´</span></span><br></pre></td></tr></table></figure><p>è½¬æ¢</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">now.<span class="title function_">toLocaleString</span>()</span><br><span class="line"><span class="string">&#x27;1975/3/19 18:25:49&#x27;</span></span><br><span class="line">now.<span class="title function_">toGMTString</span>()</span><br><span class="line"><span class="string">&#x27;Wed, 19 Mar 1975 10:25:49 GMT&#x27;</span></span><br><span class="line"><span class="comment">//æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œä¸æ˜¯å±æ€§ï¼Œéœ€è¦åŠ ()</span></span><br></pre></td></tr></table></figure><h2 id="5-2-json"><a href="#5-2-json" class="headerlink" title="5.2 json"></a>5.2 json</h2><blockquote><p>jsonæ˜¯ä»€ä¹ˆ</p></blockquote><ul><li><a href="https://baike.baidu.com/item/JSON">JSON</a>(<a href="https://baike.baidu.com/item/JavaScript">JavaScript</a> Object Notation, JS å¯¹è±¡ç®€è°±) æ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼ï¼›</li><li>ç®€æ´å’Œæ¸…æ™°çš„å±‚æ¬¡ç»“æ„ä½¿å¾— JSON æˆä¸ºç†æƒ³çš„æ•°æ®äº¤æ¢è¯­è¨€ï¼›</li><li>æ˜“äºäººé˜…è¯»å’Œç¼–å†™ï¼ŒåŒæ—¶ä¹Ÿæ˜“äºæœºå™¨è§£æå’Œç”Ÿæˆï¼Œå¹¶æœ‰æ•ˆåœ°æå‡ç½‘ç»œä¼ è¾“æ•ˆç‡ã€‚</li></ul><p>åœ¨JavaScriptä¸€åˆ‡çš†å¯¹è±¡ï¼Œä»»ä½•jsæ”¯æŒçš„ç±»å‹éƒ½å¯ä»¥ç”¨jsonæ¥è¡¨ç¤ºï¼›</p><p>æ ¼å¼ï¼š</p><ul><li>å¯¹è±¡ç”¨{}</li><li>æ•°ç»„ç”¨[]</li><li>æ‰€æœ‰é”®å€¼å¯¹ éƒ½æ˜¯ç”¨ key:value</li></ul><p>JSONå­—ç¬¦ä¸²å’ŒJSå¯¹è±¡çš„è½¬åŒ–</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> user = &#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&quot;huangruidong&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="number">3</span>,</span><br><span class="line">    <span class="attr">sex</span>:<span class="string">&quot;ç”·&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å¯¹è±¡è½¬åŒ–ä¸ºjsonå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">var</span> jsonUser = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(user);<span class="comment">//&#x27;&#123;&quot;name&quot;:&quot;huangruidong&quot;,&quot;age&quot;:3,&quot;sex&quot;:&quot;ç”·&quot;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//json å­—ç¬¦ä¸²è½¬ä¸ºå¯¹è±¡ å‚æ•°ä¸ºjsonå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="keyword">var</span> obj = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&#x27;&#123;&quot;name&quot;:&quot;huangruidong&quot;,&quot;age&quot;:3,&quot;sex&quot;:&quot;ç”·&quot;&#125;&#x27;</span>);</span><br></pre></td></tr></table></figure><p>å¾ˆå¤šäººæä¸æ¸…æ¥šï¼ŒJSONå’ŒJSå¯¹è±¡çš„åŒºåˆ«</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">a</span>:<span class="string">&#x27;hello&#x27;</span>,<span class="attr">b</span>:<span class="string">&#x27;hellob&#x27;</span>&#125;;<span class="comment">//js</span></span><br><span class="line"><span class="keyword">var</span> json =<span class="string">&#x27;&#123;&quot;a&quot;:&quot;hello&quot;,&quot;b&quot;:&quot;hellob&quot;&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="5-3-Ajax"><a href="#5-3-Ajax" class="headerlink" title="5.3 Ajax"></a>5.3 Ajax</h2><ul><li>åŸç”Ÿçš„jså†™æ³•ï¼Œxhrå¼‚æ­¥è¯·æ±‚</li><li>jQueyå°è£…å¥½çš„æ–¹æ³• $(â€œ#nameâ€).ajax(â€œâ€)</li><li>axiosè¯·æ±‚</li></ul><h1 id="6ã€é¢å‘å¯¹è±¡ç¼–ç¨‹"><a href="#6ã€é¢å‘å¯¹è±¡ç¼–ç¨‹" class="headerlink" title="6ã€é¢å‘å¯¹è±¡ç¼–ç¨‹"></a>6ã€é¢å‘å¯¹è±¡ç¼–ç¨‹</h1><h2 id="6-1-ä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡"><a href="#6-1-ä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡" class="headerlink" title="6.1 ä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡"></a>6.1 ä»€ä¹ˆæ˜¯é¢å‘å¯¹è±¡</h2><p>JavaScriptã€Javaã€C#â€¦</p><p>é¢å‘å¯¹è±¡ï¼šJavaScriptæœ‰äº›åŒºåˆ«</p><ul><li>ç±»ï¼šæ¨¡æ¿ åŸå‹å¯¹è±¡</li><li>å¯¹è±¡ï¼šå…·ä½“çš„å®ä¾‹</li></ul><p>åœ¨JavaScriptè¿™ä¸ªéœ€è¦æ¢ä¸€ä¸‹æ€ç»´æ–¹å¼ï¼</p><blockquote><p>åŸå‹ï¼š</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> student =&#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&quot;hrd&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>:<span class="number">3</span>,</span><br><span class="line">    <span class="attr">run</span>:<span class="keyword">function</span> (<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>+<span class="string">&quot;run....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> xiaoming = &#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&quot;xiaoming&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åŸå‹å¯¹è±¡</span></span><br><span class="line">xiaoming.<span class="property">__proro__</span> = student;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">Bird</span> = &#123;</span><br><span class="line">    <span class="attr">fly</span>:<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>+<span class="string">&quot;fly...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">xiaoming.<span class="property">__proro__</span> = <span class="title class_">Bird</span>;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">student</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ç»™studnetæ–°å¢ä¸€ä¸ªæ–¹æ³•</span></span><br><span class="line">student.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">hello</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>class ç»§æ‰¿</p></blockquote><p>class  å…³é”®è¯ï¼Œæ˜¯ES6ä»¥åå¼•å…¥çš„</p><p>1.å®šä¹‰ä¸€ä¸ªç±»ï¼Œå±æ€§ï¼Œæ–¹æ³•</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>&#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">hello</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> xiaoming = <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;xiaomimng&quot;</span>);</span><br><span class="line">xiaoming.<span class="title function_">hello</span>();</span><br></pre></td></tr></table></figure><p>2.ç»§æ‰¿</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>&#123;</span><br><span class="line">        <span class="title function_">constructor</span>(<span class="params">name</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">hello</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">alert</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">XiaoStudent</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Student</span>&#123;</span><br><span class="line">        <span class="title function_">constructor</span>(<span class="params">name,grade</span>) &#123;</span><br><span class="line">            <span class="variable language_">super</span>();</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">grade</span> = grade;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">myGrade</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">alert</span>(<span class="string">&quot;æˆ‘æ˜¯å°å­¦ç”Ÿ&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> xiaoming = <span class="keyword">new</span> <span class="title class_">XiaoStudent</span>(<span class="string">&quot;xiaoming&quot;</span>,<span class="number">2</span>);</span><br></pre></td></tr></table></figure><p>æœ¬è´¨ï¼šæŸ¥çœ‹å¯¹è±¡åŸå‹</p><blockquote><p>åŸå‹é“¾</p></blockquote><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220211233810494.png" alt="image-20220211233810494"></p><h1 id="7ã€æ“ä½œBOMå¯¹è±¡-é‡ç‚¹"><a href="#7ã€æ“ä½œBOMå¯¹è±¡-é‡ç‚¹" class="headerlink" title="7ã€æ“ä½œBOMå¯¹è±¡(é‡ç‚¹)"></a>7ã€æ“ä½œBOMå¯¹è±¡(é‡ç‚¹)</h1><blockquote><p>æµè§ˆå™¨ä»‹ç»</p></blockquote><p>JavaScript å’Œæµè§ˆå™¨çš„å…³ç³»ï¼Ÿ</p><p>JavaScript è¯ç”Ÿå°±æ˜¯ä¸ºäº†èƒ½å¤Ÿè®©ä»–åœ¨æµè§ˆå™¨ä¸­è¿è¡Œã€‚</p><p>BOM:æµè§ˆå™¨å¯¹è±¡æ¨¡å‹</p><ul><li>IE 6~11</li><li>Chrome</li><li>Safari</li><li>FireFox</li></ul><p>ä¸‰æ–¹</p><ul><li>qqæµè§ˆå™¨</li><li>360æµè§ˆå™¨</li></ul><blockquote><p>window</p></blockquote><p>window ä»£è¡¨ æµè§ˆå™¨çª—å£</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="title function_">alert</span>(<span class="number">222</span>)</span><br><span class="line"><span class="literal">undefined</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">innerHeight</span></span><br><span class="line"><span class="number">254</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">innerWidth</span></span><br><span class="line"><span class="number">1536</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">outerHeight</span></span><br><span class="line"><span class="number">816</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">outerWidth</span></span><br><span class="line"><span class="number">1536</span></span><br></pre></td></tr></table></figure><blockquote><p>Navigatorï¼ˆä¸å»ºè®®ä½¿ç”¨ï¼‰</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">navigator.<span class="property">appName</span></span><br><span class="line"><span class="string">&#x27;Netscape&#x27;</span></span><br><span class="line">navigator.<span class="property">appVersion</span></span><br><span class="line"><span class="string">&#x27;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36&#x27;</span></span><br><span class="line">navigator.<span class="property">userAgent</span></span><br><span class="line"><span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36&#x27;</span></span><br><span class="line">navigator.<span class="property">platform</span></span><br><span class="line"><span class="string">&#x27;Win32&#x27;</span></span><br></pre></td></tr></table></figure><p>å¤§å¤šæ•°æ—¶å€™ï¼Œæˆ‘ä»¬ä¸ä¼šä½¿ç”¨ navigator å¯¹è±¡ï¼Œå› ä¸ºä¼šè¢«äººä¸ºä¿®æ”¹ï¼</p><p>ä¸å»ºè®®ä½¿ç”¨è¿™äº›å±æ€§æ¥åˆ¤æ–­å’Œç¼–å†™ä»£ç </p><blockquote><p>screen</p></blockquote><p>ä»£è¡¨å±å¹•å°ºå¯¸</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">screen.<span class="property">width</span></span><br><span class="line"><span class="number">1536</span></span><br><span class="line">screen.<span class="property">height</span></span><br><span class="line"><span class="number">864</span></span><br></pre></td></tr></table></figure><blockquote><p>location(é‡è¦)</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">host</span>: <span class="string">&quot;www.baidu.com&quot;</span></span><br><span class="line"><span class="attr">hostname</span>: <span class="string">&quot;www.baidu.com&quot;</span></span><br><span class="line"><span class="attr">href</span>: <span class="string">&quot;https://www.baidu.com/&quot;</span></span><br><span class="line"><span class="attr">protocol</span>: <span class="string">&quot;https:&quot;</span></span><br><span class="line">loaction.<span class="title function_">reload</span>() <span class="comment">//åˆ·æ–°ç½‘é¡µ</span></span><br><span class="line"><span class="comment">//è®¾ç½®æ–°åœ°å€</span></span><br><span class="line">location.<span class="title function_">assign</span>(<span class="string">&#x27;www.goolge.com&#x27;</span>)</span><br></pre></td></tr></table></figure><blockquote><p>documentï¼ˆå†…å®¹ DOM ä¸»è¦ï¼‰</p></blockquote><p>documentä»£è¡¨å½“å‰é¡µé¢ï¼ŒHTML DOMæ–‡æ¡£æ ‘</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">title</span></span><br><span class="line"><span class="string">&#x27;ç™¾åº¦ä¸€ä¸‹ï¼Œä½ å°±çŸ¥é“&#x27;</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">title</span>=<span class="string">&#x27;ç™¾åº¦ yyds&#x27;</span></span><br><span class="line"><span class="string">&#x27;ç™¾åº¦ yyds&#x27;</span></span><br></pre></td></tr></table></figure><p>è·å¾—å…·ä½“çš„æ–‡æ¡£æ ‘</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dl</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dt</span>&gt;</span>java<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dd</span>&gt;</span>java se<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dd</span>&gt;</span>java ee<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> dl = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;app&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è·å–cookie</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">cookie</span></span><br><span class="line"><span class="string">&#x27;BIDUPSID=EA88B02EA42C5BA7A8B949DDF6572E26; PSTM=1638001843; BAIDUID=2DC45B058C88918ECF33BCCCC7AC255A:FG=1; BAIDUID_BFESS=4FA403B87348552A3BB1D0C9F870404B:FG=1; COOKIE_SESSION=0_0_0_0_5_0_1_0_0_0_0_0_5_0_397_0_1638002466_0_1638002069%7C1%230_0_1638002069%7C1; BD_UPN=12314753; BD_HOME=1; H_PS_PSSID=35414_35104_31254_35768_35489_35774_34584_35490_35872_35541_35797_35323_26350_35881_35879_35746; sugstore=0; BA_HECTOR=a0a0252h002000ahp21h0fjsh0r&#x27;</span></span><br></pre></td></tr></table></figure><p>åŠ«æŒcookieåŸç†</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;aa.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">-- è€Œå·²äººå‘˜ï¼šè·å–ä½ çš„cookieä¸Šä¼ åˆ°ä»–çš„æœåŠ¡å™¨</span><br></pre></td></tr></table></figure><p>æœåŠ¡å™¨æ®µå¯ä»¥è®¾ç½®cookie:httpOnly</p><blockquote><p>history</p></blockquote><p>historyä»£è¡¨æµè§ˆå™¨å†å²</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">history.<span class="title function_">back</span>()<span class="comment">//åé€€</span></span><br><span class="line">history.<span class="title function_">forward</span>()<span class="comment">//å‰è¿›</span></span><br></pre></td></tr></table></figure><h1 id="8ã€æ“ä½œDOMå¯¹è±¡ï¼ˆé‡ç‚¹ï¼‰"><a href="#8ã€æ“ä½œDOMå¯¹è±¡ï¼ˆé‡ç‚¹ï¼‰" class="headerlink" title="8ã€æ“ä½œDOMå¯¹è±¡ï¼ˆé‡ç‚¹ï¼‰"></a>8ã€æ“ä½œDOMå¯¹è±¡ï¼ˆé‡ç‚¹ï¼‰</h1><blockquote><p>æ ¸å¿ƒ</p></blockquote><p>æµè§ˆç½‘é¡µå°±æ˜¯ä¸€ä¸ªDOMæ ‘å½¢ç»“æ„ï¼</p><ul><li>æ›´æ–°ï¼šæ›´æ–°DOMèŠ‚ç‚¹</li><li>éå†DOMèŠ‚ç‚¹ï¼šå¾—åˆ°DOMèŠ‚ç‚¹</li><li>åˆ é™¤ï¼šåˆ é™¤ä¸€ä¸ªDOMèŠ‚ç‚¹</li><li>å¢åŠ ï¼šæ·»åŠ ä¸€ä¸ªæ–°çš„èŠ‚ç‚¹</li></ul><p>å¦‚æœè¦æ“ä½œä¸€ä¸ªDOMèŠ‚ç‚¹ï¼Œå°±å¿…é¡»è¦é²œæ´»çš„è¿™ä¸ªDOMèŠ‚ç‚¹</p><blockquote><p>è·å¾—domèŠ‚ç‚¹</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> h1 = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;h1&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> p1 = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;p1&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> p2 = <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;p2&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> father = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;father&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> children = father.<span class="property">children</span>;<span class="comment">//è·å–çˆ¶èŠ‚ç‚¹ä¸‹æ‰€æœ‰çš„å­èŠ‚ç‚¹</span></span><br><span class="line">father.<span class="property">firstChild</span>;</span><br><span class="line">father.<span class="property">lastChild</span>;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯åŸç”Ÿä»£ç ï¼Œä¹‹åä½¿ç”¨jQuery();</p><blockquote><p>æ›´æ–°èŠ‚ç‚¹</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;id1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> id1 = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;id1&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ“ä½œæ–‡æœ¬</p><ul><li>id1.innerText&#x3D;â€™dhakhdkhakâ€™ ä¿®æ”¹æ–‡æœ¬çš„å€¼</li><li>id1.innerHTML &#x3D; â€˜<strong>æˆ‘æœ€å¸…</strong>â€˜ å¯ä»¥è§£æHTMLæ–‡æœ¬æ–‡æ¡£</li></ul><p>æ“ä½œcss</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">id1.<span class="property">style</span>.<span class="property">color</span> = <span class="string">&#x27;red&#x27;</span> <span class="comment">//å±æ€§ä½¿ç”¨å­—ç¬¦ä¸²åŒ…è£¹</span></span><br><span class="line">id1.<span class="property">style</span>.<span class="property">fontSize</span>=<span class="string">&#x27;20px&#x27;</span><span class="comment">//é©¼å³°å‘½åæ³•</span></span><br><span class="line">id1.<span class="property">style</span>.<span class="property">padding</span>=<span class="string">&#x27;2em&#x27;</span></span><br></pre></td></tr></table></figure><blockquote><p>åˆ é™¤èŠ‚ç‚¹</p></blockquote><p>åˆ é™¤èŠ‚ç‚¹çš„æ­¥éª¤ï¼šå…ˆè·å–çˆ¶èŠ‚ç‚¹ï¼Œå†é€šè¿‡çˆ¶èŠ‚ç‚¹æ¥åˆ é™¤è‡ªå·±</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;father&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>java<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;p1&quot;</span>&gt;</span>p1--<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;p2&quot;</span>&gt;</span>p2--<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> self = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;p1&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">var</span> father = <span class="variable language_">document</span>.<span class="property">parentElement</span>;</span></span><br><span class="line"><span class="language-javascript">  father.<span class="title function_">removeChild</span>(self)</span></span><br><span class="line"><span class="language-javascript">  </span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//åˆ é™¤æ˜¯ä¸€ä¸ªåŠ¨æ€çš„è¿‡ç¨‹</span></span></span><br><span class="line"><span class="language-javascript">  father.<span class="title function_">removeChild</span>(father.<span class="property">children</span>[<span class="number">0</span>]);</span></span><br><span class="line"><span class="language-javascript">  father.<span class="title function_">removeChild</span>(father.<span class="property">children</span>[<span class="number">1</span>]);</span></span><br><span class="line"><span class="language-javascript">  father.<span class="title function_">removeChild</span>(father.<span class="property">children</span>[<span class="number">2</span>]);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šåˆ é™¤å¤šä¸ªèŠ‚ç‚¹çš„æ—¶å€™ï¼Œchildrenæ˜¯æ—¶åˆ»å˜åŒ–çš„ï¼Œåˆ é™¤èŠ‚ç‚¹çš„æ—¶å€™ä¸€å®šè¦æ³¨æ„ï¼Ÿ</p><blockquote><p>æ’å…¥èŠ‚ç‚¹</p></blockquote><p>æˆ‘ä»¬è·å¾—äº†æŸä¸ªDOMèŠ‚ç‚¹ï¼Œå‡è®¾è¿™ä¸ªDOMèŠ‚ç‚¹æ˜¯ç©ºçš„ï¼Œæˆ‘ä»¬é€šè¿‡innerHTMLå°±å¯ä»¥å¢åŠ ä¸€ä¸ªå…ƒç´ äº†ï¼Œä½†æ˜¯è¿™ä¸ªDOMèŠ‚ç‚¹å·²ç»å­˜åœ¨å…ƒç´ äº†ï¼Œæˆ‘ä»¬ä¸èƒ½è¿™ä¹ˆå¹²äº†ï¼ä¼šäº§ç”Ÿè¦†ç›–ã€‚</p><p>è¿½åŠ </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;se&quot;</span>&gt;</span>javaSE<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;ee&quot;</span>&gt;</span>javaEE<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;me&quot;</span>&gt;</span>javaME<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> js = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;js&#x27;</span>);<span class="comment">//å·²ç»å­˜åœ¨çš„èŠ‚ç‚¹</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> list = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;list&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    list.<span class="title function_">appendChild</span>(js);<span class="comment">//è¿½åŠ åˆ°åé¢</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220213234428496.png" alt="image-20220213234428496"></p><blockquote><p>åˆ›å»ºä¸€ä¸ªæ–°æ ‡ç­¾ï¼Œå®ç°æ’å…¥</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> newP = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;p&#x27;</span>);<span class="comment">//åˆ›å»ºä¸€ä¸ªpæ ‡ç­¾</span></span><br><span class="line">newP.<span class="property">id</span> = <span class="string">&#x27;newP&#x27;</span>;</span><br><span class="line">newP.<span class="property">innerText</span> = <span class="string">&#x27;hello,new word&#x27;</span></span><br><span class="line">list.<span class="title function_">append</span>(newP);</span><br><span class="line"><span class="comment">//åˆ›å»ºä¸€ä¸ªæ ‡ç­¾èŠ‚ç‚¹(é€šè¿‡è¿™ä¸ªå±æ€§ï¼Œå¯ä»¥è®¾ç½®ä»»æ„çš„å€¼)</span></span><br><span class="line"><span class="keyword">var</span> myScript = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">myScript.<span class="title function_">setAttribute</span>(<span class="string">&#x27;type&#x27;</span>,<span class="string">&#x27;text/javascript&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¯ä»¥åˆ›å»ºä¸€ä¸ªstyleæ ‡ç­¾</span></span><br><span class="line"><span class="keyword">var</span> myStyle = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;style&#x27;</span>);</span><br><span class="line">myStyle.<span class="title function_">setAttribute</span>(<span class="string">&#x27;type&#x27;</span>,<span class="string">&#x27;text/css&#x27;</span>);</span><br><span class="line">myStyle.<span class="property">innerHTML</span>=<span class="string">&#x27;body&#123;    background-color: wheatw;&#125;&#x27;</span>;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;head&#x27;</span>)[<span class="number">0</span>].<span class="title function_">appendChild</span>(myStyle)</span><br><span class="line"></span><br><span class="line"><span class="comment">//body</span></span><br><span class="line"><span class="keyword">var</span> body = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;body&#x27;</span>);</span><br><span class="line">body[<span class="number">0</span>].<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">&#x27;wheat&#x27;</span>;</span><br></pre></td></tr></table></figure><blockquote><p>insert before</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ee = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;ee&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> js = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;js&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> list = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;list&#x27;</span>);</span><br><span class="line">list.<span class="title function_">insertBefore</span>(js,ee);</span><br></pre></td></tr></table></figure><h1 id="9ã€æ“ä½œè¡¨å•ï¼ˆéªŒè¯ï¼‰"><a href="#9ã€æ“ä½œè¡¨å•ï¼ˆéªŒè¯ï¼‰" class="headerlink" title="9ã€æ“ä½œè¡¨å•ï¼ˆéªŒè¯ï¼‰"></a>9ã€æ“ä½œè¡¨å•ï¼ˆéªŒè¯ï¼‰</h1><blockquote><p>è¡¨å•æ˜¯ä»€ä¹ˆ from DOM æ ‘</p></blockquote><ul><li>æ–‡æœ¬æ¡† text</li><li>ä¸‹æ‹‰æ¡† <select></li><li>å•é€‰æ¡† radio</li><li>å¤šé€‰æ¡† checkbox</li><li>éšè—åŸŸ hidden</li><li>å¯†ç æ¡† password</li><li>â€¦.</li></ul><p>è¡¨å•çš„ç›®çš„ï¼šæäº¤ä¿¡æ¯</p><blockquote><p>è·å¾—éœ€è¦æäº¤çš„ä¿¡æ¯</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>ç”¨æˆ·å:<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;username&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å¤šé€‰æ¡†çš„å€¼è®¾ç½®å¥½value--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>æ€§åˆ«:<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;man&quot;</span> <span class="attr">id</span>=<span class="string">&quot;boy&quot;</span>&gt;</span>ç”·</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;women&quot;</span> <span class="attr">id</span>=<span class="string">&quot;girl&quot;</span>&gt;</span>å¥³</span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> inpurt_text = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;username&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> boy_radio = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;boy&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> girl_radio = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;girl&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//å¾—åˆ°è¾“å…¥æ¡†çš„å€¼</span></span></span><br><span class="line"><span class="language-javascript">    inpurt_text.<span class="property">value</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//ä¿®æ”¹è¾“å…¥æ¡†çš„å€¼</span></span></span><br><span class="line"><span class="language-javascript">    inpurt_text.<span class="property">value</span> = <span class="string">&#x27;122&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//å¯¹äºå•é€‰æ¡†ï¼Œå¤šé€‰æ¡†ç­‰å›ºå®šçš„å€¼,boy_radio.valueåªèƒ½æå–å½“å‰çš„å€¼</span></span></span><br><span class="line"><span class="language-javascript">    boy_radio.<span class="property">checked</span>;<span class="comment">//æŸ¥çœ‹è¿”å›å€¼çš„ç»“æœï¼Œæ˜¯å¦ä¸ºtrue,å¦‚æœä½true,åˆ™è¢«é€‰æ‹©</span></span></span><br><span class="line"><span class="language-javascript">    girl_radio.<span class="property">checked</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>æäº¤è¡¨å•   MD5åŠ å¯†å¯†ç ï¼Œè¡¨å•ä¼˜åŒ–</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">è¡¨å•ç»‘å®šæäº¤äº‹ä»¶</span></span><br><span class="line"><span class="comment">onsubmit = ç»‘å®šä¸€ä¸ªæäº¤æ£€æµ‹å‡½æ•°ï¼Œtrue,false</span></span><br><span class="line"><span class="comment">å°†è¿™ä¸ªç»“æœè¿”å›ç»™è¡¨å•ï¼Œä½¿ç”¨onsubmitæ¥æ”¶ï¼</span></span><br><span class="line"><span class="comment">onsubmit=&quot;return aaa()</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;https://www.baidu.com/&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">onsubmit</span>=<span class="string">&quot;return aaa()&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>ç”¨æˆ·å<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;username&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>å¯†ç <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">id</span>=<span class="string">&quot;input-password&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">id</span>=<span class="string">&quot;md5-password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span></span><br><span class="line">    //éšè—çš„æäº¤æ–¹å¼</span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--ç»‘å®šäº‹ä»¶ onclickè¢«ç‚¹å‡»--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>æäº¤<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">aaa</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">alert</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> uname = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;username&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> pwd = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;input-password&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> md5pwd = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;md5-password&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//pwd.value = md5(pwd.value); ä¸è¿™æ ·å¹²</span></span></span><br><span class="line"><span class="language-javascript">       </span></span><br><span class="line"><span class="language-javascript">        md5pwd.<span class="property">value</span> = <span class="title function_">md5</span>(pwd.<span class="property">value</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//å¯ä»¥æ ¡éªŒåˆ¤æ–­è¡¨å•å†…å®¹ï¼Œtrueå°±æ˜¯é€šè¿‡æäº¤ï¼Œfalse é˜»æ­¢æäº¤</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="10ã€jQuery"><a href="#10ã€jQuery" class="headerlink" title="10ã€jQuery"></a>10ã€jQuery</h1><p>jQueryåº“ï¼Œé‡Œè¾¹å­˜åœ¨å¤§é‡JavaScriptå‡½æ•°</p><blockquote><p>è·å–jQuery</p></blockquote><ol><li>cdn</li><li>å¯¼åŒ…</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--  &lt;script src=&quot;https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.js&quot;&gt;&lt;/script&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;lib/jquery-3.6.0.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;test-jquery&quot;</span>&gt;</span>ç‚¹æˆ‘<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;id&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//åˆ©ç”¨jqueryå®ç°</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// å…¬å¼ $(selector).action()</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//é€‰æ‹©å™¨å°±æ˜¯csssçš„é€‰æ‹©å™¨</span></span></span><br><span class="line"><span class="language-javascript">    $(<span class="string">&#x27;#test-jquery&#x27;</span>).<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">alert</span>(<span class="string">&#x27;hello,jquery&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>jQuery å…¬å¼ $(selector).action()</strong></p><blockquote><p>é€‰æ‹©å™¨</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åŸç”Ÿjsï¼Œé€‰æ‹©å™¨å°‘ï¼Œéº»çƒ¦ä¸å¥½è®°</span></span><br><span class="line"><span class="comment">//æ ‡ç­¾</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>();</span><br><span class="line"><span class="comment">//id</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>();</span><br><span class="line"><span class="comment">//ç±»</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//jQuery cssä¸­çš„é€‰æ‹©å™¨ä»–å…¨éƒ¨éƒ½èƒ½ä½¿ç”¨</span></span><br><span class="line">$(<span class="string">&#x27;p&#x27;</span>).<span class="title function_">click</span>();<span class="comment">//æ ‡ç­¾é€‰æ‹©å™¨</span></span><br><span class="line">$(<span class="string">&#x27;#id&#x27;</span>).<span class="title function_">click</span>();<span class="comment">//idé€‰æ‹©å™¨</span></span><br><span class="line">$(<span class="string">&#x27;.class&#x27;</span>).<span class="title function_">click</span>();<span class="comment">//ç±»é€‰æ‹©å™¨</span></span><br></pre></td></tr></table></figure><p><a href="https://jquery.cuishifeng.cn/">https://jquery.cuishifeng.cn/</a>    æ–‡æ¡£</p><blockquote><p>äº‹ä»¶</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#divMove</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">500px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--è¦æ±‚ï¼šè·å–é¼ æ ‡å½“å‰çš„ä¸€ä¸ªåæ ‡--&gt;</span></span><br><span class="line">mouse : <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;mouseMove&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;divMove&quot;</span>&gt;</span></span><br><span class="line">    åœ¨è¿™ç§»åŠ¨é¼ æ ‡è¯•è¯•</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//å½“ç½‘é¡µå…ƒç´ åŠ è½½å®Œæ¯•åï¼Œå“åº”äº‹ä»¶</span></span></span><br><span class="line"><span class="language-javascript">    $(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&#x27;#divMove&#x27;</span>).<span class="title function_">mousemove</span>(<span class="keyword">function</span> (<span class="params">e</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            $(<span class="string">&#x27;#mouseMove&#x27;</span>).<span class="title function_">text</span>(<span class="string">&#x27;x:&#x27;</span>+e.<span class="property">pageX</span> + <span class="string">&#x27;y:&#x27;</span>+e.<span class="property">pageY</span>)</span></span><br><span class="line"><span class="language-javascript">        &#125;)</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>æ“ä½œDOM</p></blockquote><p>èŠ‚ç‚¹æ–‡æœ¬æ“ä½œ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#test-ul li[name=py]&#x27;</span>).<span class="title function_">text</span>();<span class="comment">//è·å¾—å€¼</span></span><br><span class="line">$(<span class="string">&#x27;#test-ul li[name=py]&#x27;</span>).<span class="title function_">text</span>(<span class="string">&#x27;è®¾ç½®å€¼&#x27;</span>);<span class="comment">//è®¾ç½®å€¼</span></span><br><span class="line">$(<span class="string">&#x27;#test-ul li[name=py]&#x27;</span>).<span class="title function_">html</span>();<span class="comment">//è·å¾—å€¼</span></span><br><span class="line">$(<span class="string">&#x27;#test-ul li[name=py]&#x27;</span>).<span class="title function_">html</span>(<span class="string">&#x27;è®¾ç½®å€¼&#x27;</span>);<span class="comment">//è®¾ç½®å€¼</span></span><br></pre></td></tr></table></figure><p>cssæ“ä½œ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#test-ul li[name=py]&#x27;</span>).<span class="title function_">css</span>(&#123;<span class="string">&quot;color&quot;</span>:<span class="string">&quot;red&quot;</span>&#125;)</span><br></pre></td></tr></table></figure><p>å…ƒç´ çš„æ˜¾ç¤ºå’Œéšè—ï¼šæœ¬è´¨ <strong>display: none</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&#x27;#test-ul li[name=py]&#x27;</span>).<span class="title function_">show</span>();</span><br><span class="line">$(<span class="string">&#x27;#test-ul li[name=py]&#x27;</span>).<span class="title function_">hidden</span>();</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSS</title>
      <link href="/2022/11/20/css/"/>
      <url>/2022/11/20/css/</url>
      
        <content type="html"><![CDATA[<h1 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h1><h2 id="1-CSSä»‹ç»"><a href="#1-CSSä»‹ç»" class="headerlink" title="1.CSSä»‹ç»"></a>1.CSSä»‹ç»</h2><h3 id="1-1ä»€ä¹ˆæ˜¯CSS"><a href="#1-1ä»€ä¹ˆæ˜¯CSS" class="headerlink" title="1.1ä»€ä¹ˆæ˜¯CSS"></a>1.1ä»€ä¹ˆæ˜¯CSS</h3><p><strong>å±‚å æ ·å¼è¡¨</strong> (Cascading Style Sheetsï¼Œç¼©å†™ä¸º <strong>CSS</strong>ï¼‰</p><p>CSS:è¡¨ç°ï¼ˆç¾åŒ–ç½‘é¡µï¼‰</p><p>å­—ä½“ï¼Œé¢œè‰²ï¼Œç¼–å‰§ï¼Œé«˜åº¦ï¼Œå®½åº¦ï¼ŒèƒŒæ™¯å›¾ç‰‡ï¼Œç½‘é¡µå®šä½ï¼Œç½‘é¡µæµ®åŠ¨â€¦</p><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220130231708471.png" alt="image-20220130231708471"></p><h3 id="1-2CSSå‘å±•å²"><a href="#1-2CSSå‘å±•å²" class="headerlink" title="1.2CSSå‘å±•å²"></a>1.2CSSå‘å±•å²</h3><p>CSS1.0</p><p>CSS2.0DIV(å—)+CSS,HTMLä¸CSSç»“æ„åˆ†ç¦»çš„æ€æƒ³ï¼Œç½‘é¡µå˜å¾—ç®€å•ï¼ŒSEO</p><p>CSS2.1æµ®åŠ¨ã€å®šä½</p><p>CSS3.0åœ†è§’ï¼Œé˜´å½±ï¼ŒåŠ¨ç”»â€¦æµè§ˆå™¨çš„å…¼å®¹æ€§~</p><h3 id="1-3CSSå¿«é€Ÿå…¥é—¨"><a href="#1-3CSSå¿«é€Ÿå…¥é—¨" class="headerlink" title="1.3CSSå¿«é€Ÿå…¥é—¨"></a>1.3CSSå¿«é€Ÿå…¥é—¨</h3><p>CSS 1.0:style CSSä»£ç </p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--è§„èŒƒ&lt;style&gt; å¯ä»¥ç¼–å†™cssä»£ç ,æ¯ä¸€ä¸ªå£°æ˜æœ€å¥½ç”¨åˆ†å·ç»“å°¾</span></span><br><span class="line"><span class="comment">    è¯­æ³•ï¼š</span></span><br><span class="line"><span class="comment">        é€‰æ‹©å™¨&#123;</span></span><br><span class="line"><span class="comment">            å£°æ˜1ï¼›</span></span><br><span class="line"><span class="comment">            å£°æ˜2ï¼›</span></span><br><span class="line"><span class="comment">            ...</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">h1</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">color</span>: blanchedalmond;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>æ ‡é¢˜<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>css 3.0åˆ†ç¦»</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--è§„èŒƒ&lt;style&gt; å¯ä»¥ç¼–å†™cssä»£ç ,æ¯ä¸€ä¸ªå£°æ˜æœ€å¥½ç”¨åˆ†å·ç»“å°¾</span></span><br><span class="line"><span class="comment">    è¯­æ³•ï¼š</span></span><br><span class="line"><span class="comment">        é€‰æ‹©å™¨&#123;</span></span><br><span class="line"><span class="comment">            å£°æ˜1ï¼›</span></span><br><span class="line"><span class="comment">            å£°æ˜2ï¼›</span></span><br><span class="line"><span class="comment">            ...</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;css/style.css&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>æ ‡é¢˜<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">h1</span>&#123;</span><br><span class="line">    <span class="attribute">color</span>: blanchedalmond;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>ä»£ç åˆ†ç¦»ï¼Œcssé€šè¿‡é“¾æ¥linkåˆ°htmlä»£ç ä¸­ã€‚</strong></p><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220130232851037.png" alt="image-20220130232851037"></p><p><strong>cssä¼˜åŠ¿ï¼š</strong></p><ol><li>å†…å®¹å’Œå˜ç°åˆ†ç¦»</li><li>ç½‘é¡µç»“æ„è¡¨ç°ç»Ÿä¸€ï¼Œå¯ä»¥å®ç°å¤ç”¨</li><li>æ ·å¼ååˆ†ä¸°å¯Œ</li><li>å»ºè®®ä½¿ç”¨ç‹¬ç«‹äºhtmlçš„cssæ–‡ä»¶</li><li>åˆ©ç”¨SEOï¼Œæ›´å®¹æ˜“è¢«æœç´¢å¼•æ“æ”¶å½•</li></ol><h3 id="1-4CSSçš„3ç§å¯¼å…¥æ–¹å¼"><a href="#1-4CSSçš„3ç§å¯¼å…¥æ–¹å¼" class="headerlink" title="1.4CSSçš„3ç§å¯¼å…¥æ–¹å¼"></a>1.4CSSçš„3ç§å¯¼å…¥æ–¹å¼</h3><p>ä¸‰ç§å¯¼å…¥æ–¹å¼ï¼š</p><ol><li><p>è¡Œå†…æ ·å¼ï¼›</p></li><li><p>å†…éƒ¨æ ·å¼ï¼›</p></li><li><p>å¤–éƒ¨æ ·å¼ï¼›</p></li></ol><p>å¤–éƒ¨æ ·å¼çš„ä¸¤ç§å†™æ³•ï¼š</p><ul><li><p>é“¾æ¥æ³• ï¼ˆå¸¸ç”¨ï¼‰</p></li><li><p>å¯¼å…¥æ³•    ï¼ˆCSS 2.1ç‰¹æœ‰ï¼Œä¸å¸¸ç”¨ï¼‰</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å†…éƒ¨æ ·å¼--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">h1</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">color</span>: darkgreen;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¤–éƒ¨1.é“¾æ¥æ–¹å¼--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;css/style.css&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¤–éƒ¨2.å¼•ç”¨æ–¹å¼ ä¸å¸¸ç”¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="keyword">@import</span> <span class="string">&quot;css/style.css&quot;</span>;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">è¡Œå†…æœ€é«˜ï¼Œå¤–è¾¹å°±è¿‘åŸåˆ™;</span></span><br><span class="line"><span class="comment">å…¶å®æ˜¯è¦†ç›–åŸåˆ™ï¼Œå¤–è¾¹ä¾æ¬¡è¦†ç›–ï¼Œè¡Œå†…æœ€åæ‰§è¡Œï¼Œæ‰€ä»¥æœ€åæ˜¾ç¤ºï¼Œä¼˜å…ˆçº§æœ€é«˜ï¼›</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--è¡Œå†…æ ·å¼--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">style</span>=<span class="string">&quot;color:deepskyblue&quot;</span>&gt;</span>æ ‡é¢˜<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*å¤–éƒ¨æ ·å¼*/</span></span><br><span class="line"><span class="selector-tag">h1</span>&#123;</span><br><span class="line">    <span class="attribute">color</span>: brown;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-CSSé€‰æ‹©å™¨ï¼ˆé‡ç‚¹ï¼‰"><a href="#2-CSSé€‰æ‹©å™¨ï¼ˆé‡ç‚¹ï¼‰" class="headerlink" title="2.CSSé€‰æ‹©å™¨ï¼ˆé‡ç‚¹ï¼‰"></a>2.CSSé€‰æ‹©å™¨ï¼ˆé‡ç‚¹ï¼‰</h2><blockquote><p>ä½œç”¨ï¼šé€‰æ‹©é¡µé¢ä¸Šçš„æŸä¸€ä¸ªæˆ–è€…æŸä¸€ç±»å…ƒç´ </p></blockquote><h3 id="2-1-åŸºæœ¬é€‰æ‹©å™¨"><a href="#2-1-åŸºæœ¬é€‰æ‹©å™¨" class="headerlink" title="2.1 åŸºæœ¬é€‰æ‹©å™¨"></a>2.1 åŸºæœ¬é€‰æ‹©å™¨</h3><ol><li><p>æ ‡ç­¾é€‰æ‹©å™¨ï¼šé€‰æ‹©ä¸€ç±»æ ‡ç­¾æ ‡ç­¾{}</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="comment">/*æ ‡ç­¾é€‰æ‹©å™¨ï¼Œä¼šé€‰æ‹©åˆ°é¡µé¢ä¸Šæ‰€æœ‰çš„è¿™ä¸ªæ ‡ç­¾çš„å…ƒç´ */</span></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">h1</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">color</span>: coral;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>æ ‡ç­¾é€‰æ‹©å™¨<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>æ ‡ç­¾é€‰æ‹©å™¨<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Java<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>ç±»é€‰æ‹©å™¨ class:é€‰æ‹©æ‰€æœ‰classå±æ€§ä¸€è‡´çš„æ ‡ç­¾ï¼Œè·¨æ ‡ç­¾ï¼Œç±»å{}</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="comment">/*ç±»é€‰æ‹©å™¨ï¼š</span></span></span><br><span class="line"><span class="comment"><span class="language-css">    .classçš„æ–¹å¼ä½¿ç”¨</span></span></span><br><span class="line"><span class="comment"><span class="language-css">    ä¸åŒçš„æ ‡ç­¾å¯ä»¥å½’ä¸ºä¸€ç±»</span></span></span><br><span class="line"><span class="comment"><span class="language-css">    ä¸€ä¸ªç±»å¯ä»¥æœ‰å¤šä¸ªæ ‡ç­¾ï¼Œä¹Ÿå¯ä»¥æœ‰å¤šç§æ ‡ç­¾ï¼Œå¯ä»¥å¤ç”¨</span></span></span><br><span class="line"><span class="comment"><span class="language-css">    */</span></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.style</span>&#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: aqua;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;style&quot;</span>&gt;</span>ç±»é€‰æ‹©å™¨1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>ç±»é€‰æ‹©å™¨<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;style&quot;</span>&gt;</span>java<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>idé€‰æ‹©å™¨ï¼šå…¨å±€å”¯ä¸€ï¼ #idå{}</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="comment">/*idé€‰æ‹©å™¨ï¼š</span></span></span><br><span class="line"><span class="comment"><span class="language-css"></span></span></span><br><span class="line"><span class="comment"><span class="language-css">        é€‰æ‹©ç‰¹æœ‰çš„æ ‡ç­¾æ“ä½œ</span></span></span><br><span class="line"><span class="comment"><span class="language-css">        ä¸€ä¸ªæ ‡ç­¾åªæœ‰ä¸€ä¸ªid</span></span></span><br><span class="line"><span class="comment"><span class="language-css">        */</span></span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#style1</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="comment">/*æµ‹è¯•*/</span></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.lala</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">color</span>: deepskyblue;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">id</span>=<span class="string">&quot;style1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;lala&quot;</span>&gt;</span>idé€‰æ‹©å™¨1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>idé€‰æ‹©å™¨2<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Java<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å­˜åœ¨ä¼˜å…ˆçº§é—®é¢˜ï¼š</p><p><strong>id&gt;ç±»&gt;æ ‡ç­¾</strong></p></li></ol><h3 id="2-2-å±‚æ¬¡é€‰æ‹©å™¨"><a href="#2-2-å±‚æ¬¡é€‰æ‹©å™¨" class="headerlink" title="2.2 å±‚æ¬¡é€‰æ‹©å™¨"></a>2.2 å±‚æ¬¡é€‰æ‹©å™¨</h3><ol><li><p>åä»£é€‰æ‹©å™¨ï¼šåœ¨æŸä¸ªå…ƒç´ çš„åé¢       ç¥–çˆ·çˆ·   çˆ·çˆ·   çˆ¸çˆ¸    ä½ </p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*åä»£é€‰æ‹©å™¨*/</span></span><br><span class="line">        <span class="selector-tag">body</span> <span class="selector-tag">p</span>&#123;</span><br><span class="line">            <span class="attribute">background</span>: aqua;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></li><li><p>å­é€‰æ‹©å™¨ï¼šä¸€ä»£ï¼Œå„¿å­</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*å­é€‰æ‹©å™¨ï¼Œä¸€ä»£ï¼Œå„¿å­*/</span></span><br><span class="line">        <span class="selector-tag">body</span>&gt;<span class="selector-tag">p</span>&#123;</span><br><span class="line">            <span class="attribute">background</span>: red;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></li><li><p>ç›¸é‚»å…„å¼Ÿé€‰æ‹©å™¨ï¼šåŒè¾ˆ  åªæœ‰ä¸€ä¸ªï¼Œå‘ä¸‹</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*ç›¸é‚»å…„å¼Ÿé€‰æ‹©å™¨ï¼Œåªæœ‰ä¸€ä¸ªï¼Œç›¸é‚»çš„ï¼ˆå‘ä¸‹ï¼‰*/</span></span><br><span class="line">        <span class="selector-class">.text</span>+<span class="selector-tag">p</span>&#123;</span><br><span class="line">            <span class="attribute">background</span>: fuchsia;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></li><li><p>é€šç”¨é€‰æ‹©å™¨ï¼šå½“å‰å…ƒç´ å‘ä¸‹çš„æ‰€æœ‰å…„å¼Ÿå…ƒç´ </p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*é€šç”¨é€‰æ‹©å™¨*/</span></span><br><span class="line">        <span class="selector-class">.text</span>~<span class="selector-tag">p</span>&#123;</span><br><span class="line">            <span class="attribute">background</span>: greenyellow;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><h3 id="2-3ä¼ªç±»é€‰æ‹©å™¨"><a href="#2-3ä¼ªç±»é€‰æ‹©å™¨" class="headerlink" title="2.3ä¼ªç±»é€‰æ‹©å™¨"></a>2.3ä¼ªç±»é€‰æ‹©å™¨</h3><p>ä¼ªç±»ï¼šæ¡ä»¶</p><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220202224406586.png" alt="image-20220202224406586"></p></li></ol><h3 id="2-4-å±æ€§é€‰æ‹©å™¨-é‡ç‚¹"><a href="#2-4-å±æ€§é€‰æ‹©å™¨-é‡ç‚¹" class="headerlink" title="2.4 å±æ€§é€‰æ‹©å™¨(é‡ç‚¹)"></a>2.4 å±æ€§é€‰æ‹©å™¨(é‡ç‚¹)</h3><p>å¯å®ç°åŒæ—¶ä½¿ç”¨class+id</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.demo</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">float</span>: left;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">display</span>: block;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background</span>: greenyellow;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">text-decoration</span>: none;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin-right</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">font</span>: bold <span class="number">20px</span>/<span class="number">50px</span> Arial;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="comment">/*å±æ€§åï¼Œå±æ€§å=å±æ€§å€¼ï¼ˆæ­£åˆ™ï¼‰*/</span></span></span><br><span class="line"><span class="language-css">        <span class="comment">/*å­˜åœ¨idå±æ€§çš„å…ƒç´   a[]&#123;&#125;*/</span></span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="comment">/*é€‰ä¸­idä¸ºfirstå…ƒç´ */</span></span></span><br><span class="line"><span class="language-css">        <span class="comment">/*a[id=first]&#123;*/</span></span></span><br><span class="line"><span class="language-css">        <span class="comment">/*    background: fuchsia;*/</span></span></span><br><span class="line"><span class="language-css">        <span class="comment">/*&#125;*/</span></span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="comment">/*é€‰ä¸­ç±»ä¸­å«linksçš„å…ƒç´ */</span></span></span><br><span class="line"><span class="language-css">        <span class="comment">/*a[class*=&quot;links&quot;]&#123;*/</span></span></span><br><span class="line"><span class="language-css">        <span class="comment">/*    background: blue;*/</span></span></span><br><span class="line"><span class="language-css">        <span class="comment">/*&#125;*/</span></span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="comment">/*!*é€‰ä¸­ä»¥hrefä¸­ä»¥httpå¼€å¤´çš„å…ƒç´ *!*/</span></span></span><br><span class="line"><span class="language-css">        <span class="comment">/*a[href^=http]&#123;*/</span></span></span><br><span class="line"><span class="language-css">        <span class="comment">/*    background: coral;*/</span></span></span><br><span class="line"><span class="language-css">        <span class="comment">/*&#125;*/</span></span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="comment">/*é€‰ä¸­ä»¥pdfç»“å°¾çš„*/</span></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">a</span><span class="selector-attr">[href$=pdf]</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background</span>: red;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;demo&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://www.baidu.com&quot;</span> <span class="attr">class</span>=<span class="string">&quot;links item first&quot;</span> <span class="attr">id</span>=<span class="string">&quot;first&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;links item first&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span> <span class="attr">title</span>=<span class="string">&quot;test&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;images/123.html&quot;</span> <span class="attr">class</span>=<span class="string">&quot;links item&quot;</span>&gt;</span>3<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;images/123.png&quot;</span> <span class="attr">class</span>=<span class="string">&quot;links item&quot;</span>&gt;</span>4<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;images/123.jpg&quot;</span> <span class="attr">class</span>=<span class="string">&quot;links item&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;abc&quot;</span> <span class="attr">class</span>=<span class="string">&quot;links item&quot;</span>&gt;</span>6<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/a.pdf&quot;</span> <span class="attr">class</span>=<span class="string">&quot;links item&quot;</span>&gt;</span>7<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/abc.pdf&quot;</span> <span class="attr">class</span>=<span class="string">&quot;links item&quot;</span>&gt;</span>8<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;abc.doc&quot;</span> <span class="attr">class</span>=<span class="string">&quot;links item&quot;</span>&gt;</span>9<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>&#x3D; å®Œå…¨ç­‰äº</li><li>*&#x3D; åŒ…å«</li><li>^&#x3D; ä»¥ä»€ä¹ˆå¼€å¤´</li><li>$&#x3D; ä»¥ä»€ä¹ˆç»“å°¾</li></ul><h2 id="3-ç¾åŒ–ç½‘é¡µå…ƒç´ "><a href="#3-ç¾åŒ–ç½‘é¡µå…ƒç´ " class="headerlink" title="3.ç¾åŒ–ç½‘é¡µå…ƒç´ "></a>3.ç¾åŒ–ç½‘é¡µå…ƒç´ </h2><h3 id="3-1-ä¸ºä»€ä¹ˆç¾åŒ–ç½‘é¡µ"><a href="#3-1-ä¸ºä»€ä¹ˆç¾åŒ–ç½‘é¡µ" class="headerlink" title="3.1 ä¸ºä»€ä¹ˆç¾åŒ–ç½‘é¡µ"></a>3.1 ä¸ºä»€ä¹ˆç¾åŒ–ç½‘é¡µ</h3><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220203214321307.png" alt="image-20220203214321307"></p><p>spanæ ‡ç­¾</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#title1</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">font-size</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">æ¬¢è¿å­¦ä¹  <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;title1&quot;</span>&gt;</span>java<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-2-å­—ä½“æ ·å¼"><a href="#3-2-å­—ä½“æ ·å¼" class="headerlink" title="3.2 å­—ä½“æ ·å¼"></a>3.2 å­—ä½“æ ·å¼</h3><ul><li>font-familyå­—ä½“</li><li>font-sizeå­—ä½“å¤§å°</li><li>font-weightå­—ä½“ç²—ç»†</li><li>colorå­—ä½“é¢œè‰²</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">    <span class="selector-tag">body</span>&#123;</span><br><span class="line">        <span class="attribute">font-family</span>: <span class="string">&quot;Arial Black&quot;</span>,æ¥·ä½“;</span><br><span class="line">        <span class="attribute">color</span>: coral;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">h1</span>&#123;</span><br><span class="line">        <span class="attribute">font-size</span>: large;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-class">.p1</span>&#123;</span><br><span class="line">        <span class="attribute">font-weight</span>: bolder;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h3 id="3-3-æ–‡å­—æ ·å¼"><a href="#3-3-æ–‡å­—æ ·å¼" class="headerlink" title="3.3 æ–‡å­—æ ·å¼"></a>3.3 æ–‡å­—æ ·å¼</h3><p>1.é¢œè‰²</p><ul><li>è‹±è¯­å•è¯</li><li>RGB ä¸‰åŸè‰² 0~f</li><li>RGBA Aè¡¨ç¤ºé€æ˜åº¦ 0~1</li></ul><p>2.æ–‡å­—å¯¹é½çš„æ–¹å¼</p><p>text-align: æ’ç‰ˆã€å‰§ä¸­ã€é å·¦</p><p>3.é¦–è¡Œç¼©è¿›</p><p>text-indent: 2em é¦–è¡Œç¼©è¿›ä¸¤ä¸ªå­—ç¬¦</p><p>4.è¡Œé«˜</p><p>è¡Œé«˜å’Œå—é«˜ä¸€æ ·ï¼Œå°±å¯ä»¥ä¸Šä¸‹å±…ä¸­line-height&#x3D;height</p><p>5.è£…é¥°</p><ul><li>underline   ä¸‹åˆ’çº¿</li><li>line-through    ä¸­åˆ’çº¿</li><li>overline    ä¸Šåˆ’çº¿</li></ul><p>6.æ–‡å­—å›¾ç‰‡æ°´å¹³å¯¹é½</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="comment">/*é¢œè‰²ï¼š</span></span></span><br><span class="line"><span class="comment"><span class="language-css">        è‹±è¯­å•è¯</span></span></span><br><span class="line"><span class="comment"><span class="language-css">        RGB ä¸‰åŸè‰² 0~f</span></span></span><br><span class="line"><span class="comment"><span class="language-css">        RGBA Aè¡¨ç¤ºé€æ˜åº¦ 0~1</span></span></span><br><span class="line"><span class="comment"><span class="language-css">        */</span></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">h1</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.9</span>);</span></span><br><span class="line"><span class="language-css">            <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="comment">/*text-align: æ’ç‰ˆã€å‰§ä¸­ã€é å·¦..*/</span></span></span><br><span class="line"><span class="language-css">        <span class="comment">/*text-indent: 2em é¦–è¡Œç¼©è¿›ä¸¤ä¸ªå­—ç¬¦*/</span></span></span><br><span class="line"><span class="language-css">        <span class="comment">/*è¡Œé«˜å’Œå—é«˜ä¸€æ ·ï¼Œå°±å¯ä»¥ä¸Šä¸‹å±…ä¸­line-height=height*/</span></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.p1</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">text-indent</span>: <span class="number">2em</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.p2</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background</span>: coral;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">600px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">line-height</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-css">        underline   ä¸‹åˆ’çº¿</span></span></span><br><span class="line"><span class="comment"><span class="language-css">        line-through    ä¸­åˆ’çº¿</span></span></span><br><span class="line"><span class="comment"><span class="language-css">        overline    ä¸Šåˆ’çº¿</span></span></span><br><span class="line"><span class="comment"><span class="language-css">        */</span></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.t1</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">text-decoration</span>: underline;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.t2</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">text-decoration</span>: line-through;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.t3</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">text-decoration</span>: overline;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="comment">/*å›¾ç‰‡æ–‡å­—å±…ä¸­*/</span></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">img</span>,<span class="selector-tag">span</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">vertical-align</span>: middle;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../image/a.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;t1&quot;</span>&gt;</span>12456<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;t2&quot;</span>&gt;</span>11111<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;t3&quot;</span>&gt;</span>55555<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>ç«å½±å¿è€…<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;p1&quot;</span>&gt;</span></span><br><span class="line">    ã€Šç«å½±å¿è€…ã€‹ï¼ˆæ—¥è¯­ï¼šNARUTO -ãƒŠãƒ«ãƒˆ-ï¼‰ï¼Œé€šå¸¸ç®€ç§°ä¸ºâ€œç«å½±â€ï¼Œä¸ºæ—¥æœ¬æ¼«ç”»å®¶å²¸æœ¬é½å²åˆ›ä½œçš„å°‘å¹´æ¼«ç”»ï¼Œè®²è¿°å¿è€…ä¸–ç•Œé‡Œå›´ç»•ç€èº«ä¸ºå¯¹æ‰‹çš„æ¼©æ¶¡é¸£äººä¸å®‡æ™ºæ³¢ä½åŠ©ä¸¤äººï¼Œä¸å…¶ä»–è§’è‰²çš„ç»å†ã€‚</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;p2&quot;</span>&gt;</span></span><br><span class="line">    æ¼«ç”»è‡ª1999å¹´å¼€å§‹åœ¨æ—¥æœ¬é›†è‹±ç¤¾æ——ä¸‹çš„å°‘å¹´æ¼«ç”»æ‚å¿—ã€Šå‘¨åˆŠå°‘å¹´Jumpã€‹ä¸Šè¿è½½ã€‚2002å¹´ï¼Œç”±æ—¥æœ¬åŠ¨ç”»å·¥ä½œå®¤Studio Pierrotæ ¹æ®æ¼«ç”»åŸä½œæ‰€æ”¹ç¼–åˆ¶ä½œçš„ç”µè§†åŠ¨ç”»ç‰ˆã€Šç«å½±å¿è€…ã€‹å¼€å§‹åœ¨æ—¥æœ¬ä¸œäº¬ç”µè§†å°æ’­å‡ºã€‚2004å¹´ï¼Œæ¼«ç”»è¿›è€Œæ”¹ç¼–æˆç”µå½±ã€‚2006å¹´ï¼Œæ¼©æ¶¡é¸£äººå…¥é€‰ç¾å›½ã€Šæ–°é—»å‘¨åˆŠã€‹æ—¥æ–‡ç‰ˆäº10æœˆ18æ—¥å‘è¡Œçš„ç‰¹é›†ä¸­é€‰å‡ºçš„â€œå…¨ä¸–ç•Œæœ€å—å°Šæ•¬çš„100ä½æ—¥æœ¬äººâ€ã€‚[1]</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-4-é˜´å½±"><a href="#3-4-é˜´å½±" class="headerlink" title="3.4 é˜´å½±"></a>3.4 é˜´å½±</h3><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220203224114207.png" alt="image-20220203224114207"></p><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220203224134771.png" alt="image-20220203224134771"></p><h3 id="3-5-è¶…é“¾æ¥ä¼ªç±»"><a href="#3-5-è¶…é“¾æ¥ä¼ªç±»" class="headerlink" title="3.5 è¶…é“¾æ¥ä¼ªç±»"></a>3.5 è¶…é“¾æ¥ä¼ªç±»</h3><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220203223957899.png" alt="image-20220203223957899"></p><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220203224210624.png" alt="image-20220203224210624"></p><h3 id="3-6-åˆ—è¡¨"><a href="#3-6-åˆ—è¡¨" class="headerlink" title="3.6 åˆ—è¡¨"></a>3.6 åˆ—è¡¨</h3><p>list-style:</p><ul><li>â€‹    none å»æ‰åŸç‚¹</li><li>â€‹    circle ç©ºå¿ƒåœ†</li><li>â€‹    decimal æ•°å­—</li><li>â€‹    square æ­£æ–¹å½¢</li></ul><p>å•†åŸæ¡ˆä¾‹</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;css/style.css&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;nav&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>å…¨éƒ¨å•†å“åˆ†ç±»<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>å›¾ä¹¦<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>éŸ³åƒ<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>æ•°å­—å•†å“<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>å®¶ç”¨ç”µå™¨<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>æ‰‹æœº<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>æ•°ç <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>ç”µè„‘<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>åŠå…¬<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>å®¶å±…<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>å®¶è£…<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>å¨å…·<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>æœé¥°é‹å¸½<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>ä¸ªæ€§åŒ–å¦†<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>ç¤¼å“ç®±åŒ…<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>é’Ÿè¡¨<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>ç å®<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>é£Ÿå“é¥®æ–™<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>ä¿å¥é£Ÿå“<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>å½©ç¥¨<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>æ—…è¡Œ<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>å……å€¼<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>ç¥¨åŠ¡<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#nav</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">background</span>: beige;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.title</span>&#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: bold;</span><br><span class="line">    <span class="attribute">text-indent</span>: <span class="number">1em</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">30px</span>;</span><br><span class="line">    <span class="attribute">background</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">ul</span>&#123;</span><br><span class="line">    <span class="attribute">background</span>: beige;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">list-style:</span></span><br><span class="line"><span class="comment">    none å»æ‰åŸç‚¹</span></span><br><span class="line"><span class="comment">    circle ç©ºå¿ƒåœ†</span></span><br><span class="line"><span class="comment">    decimal æ•°å­—</span></span><br><span class="line"><span class="comment">    square æ­£æ–¹å½¢</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="selector-tag">ul</span> <span class="selector-tag">li</span>&#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">30px</span>;</span><br><span class="line">    <span class="attribute">list-style</span>: none;</span><br><span class="line">    <span class="attribute">text-indent</span>: <span class="number">1em</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">a</span>&#123;</span><br><span class="line">    <span class="attribute">text-decoration</span>: none;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">    <span class="attribute">color</span>: black;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>&#123;</span><br><span class="line">    <span class="attribute">color</span>: orange;</span><br><span class="line">    <span class="attribute">text-decoration</span>: underline;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220203230651354.png" alt="image-20220203230651354"></p><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220203230659490.png" alt="image-20220203230659490"></p><p>ä¿®æ”¹æ ·å¼</p><h3 id="3-7-èƒŒæ™¯"><a href="#3-7-èƒŒæ™¯" class="headerlink" title="3.7 èƒŒæ™¯"></a>3.7 èƒŒæ™¯</h3><p>èƒŒæ™¯é¢œè‰²</p><p>èƒŒæ™¯å›¾ç‰‡</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">div&#123;</span><br><span class="line">          width: <span class="number">1000</span>px;</span><br><span class="line">          height: <span class="number">700</span>px;</span><br><span class="line">          border: <span class="number">1</span>px solid red;</span><br><span class="line">          background-image: url(<span class="string">&quot;../image/a.png&quot;</span>);</span><br><span class="line">          <span class="comment">/*é»˜è®¤æ˜¯å…¨éƒ¨å¹³é“ºçš„*/</span></span><br><span class="line">      &#125;</span><br><span class="line">      .div1&#123;</span><br><span class="line">          background-repeat: repeat-x;</span><br><span class="line">      &#125;</span><br><span class="line">      .div2&#123;</span><br><span class="line">          background-repeat: repeat-y;</span><br><span class="line">      &#125;</span><br><span class="line">      .div3&#123;</span><br><span class="line">          background-repeat: no-repeat;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><h3 id="3-8-æ¸å˜"><a href="#3-8-æ¸å˜" class="headerlink" title="3.8 æ¸å˜"></a>3.8 æ¸å˜</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">background-image</span>: <span class="built_in">linear-gradient</span>(<span class="number">131deg</span>, <span class="number">#ffffff</span> <span class="number">0%</span>, <span class="number">#62daff</span> <span class="number">50%</span>, <span class="number">#FF0000</span> <span class="number">100%</span>);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>grabient æ‰¾ cssä»£ç </p><h2 id="4-ç›’å­æ¨¡å‹"><a href="#4-ç›’å­æ¨¡å‹" class="headerlink" title="4.ç›’å­æ¨¡å‹"></a>4.ç›’å­æ¨¡å‹</h2><h3 id="1-ä»€ä¹ˆæ˜¯ç›’å­æ¨¡å‹"><a href="#1-ä»€ä¹ˆæ˜¯ç›’å­æ¨¡å‹" class="headerlink" title="1. ä»€ä¹ˆæ˜¯ç›’å­æ¨¡å‹"></a>1. ä»€ä¹ˆæ˜¯ç›’å­æ¨¡å‹</h3><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220204231504389.png" alt="image-20220204231504389"></p><p>margin:å¤–è¾¹æ¡†</p><p>padding:å†…è¾¹æ¡†</p><p>border:è¾¹æ¡†</p><h3 id="2-è¾¹æ¡†"><a href="#2-è¾¹æ¡†" class="headerlink" title="2.è¾¹æ¡†"></a>2.è¾¹æ¡†</h3><p>1.è¾¹æ¡†çš„ç²—ç»†</p><p>2.è¾¹æ¡†çš„æ ·å¼</p><p>3.è¾¹æ¡†çš„é¢œè‰²</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">body</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="comment">/*bodyæ€»æœ‰ä¸€ä¸ªé»˜è®¤çš„å¤–è¾¹è·*/</span></span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">text-decoration</span>: none;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="comment">/*border:ç²—ç»† æ ·å¼ é¢œè‰²*/</span></span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#box</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">h2</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">font-size</span>: <span class="number">16px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background</span>: coral;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">line-height</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">form</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background</span>: <span class="number">#62daff</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">div</span><span class="selector-pseudo">:nth-of-type</span>(<span class="number">1</span>)&gt;<span class="selector-tag">input</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">3px</span> solid blue;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">div</span><span class="selector-pseudo">:nth-of-type</span>(<span class="number">2</span>)&gt;<span class="selector-tag">input</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">3px</span> solid <span class="number">#0ae648</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">div</span><span class="selector-pseudo">:nth-of-type</span>(<span class="number">3</span>)&gt;<span class="selector-tag">input</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">3px</span> solid <span class="number">#ff6600</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>ä¼šå‘˜ç™»å½•<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;#&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>ç”¨æˆ·åï¼š<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>å¯†ç ï¼š<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>é‚®ç®±ï¼š<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-å†…å¤–è¾¹è·"><a href="#3-å†…å¤–è¾¹è·" class="headerlink" title="3.å†…å¤–è¾¹è·"></a>3.å†…å¤–è¾¹è·</h3><p>ç›’å­çš„è®¡ç®—æ–¹å¼ï¼šä½ è¿™ä¸ªå…ƒç´ åˆ°åº•æœ‰å¤šå¤§</p><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220205121530667.png" alt="image-20220205121530667"></p><p>margin+border+padding+å†…å®¹å®½åº¦</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*margin+border+paddingçš„å‚æ•°*/</span></span><br><span class="line"><span class="comment">/*ä¸¤ä¸ªå‚æ•° ä¸Šä¸‹ å·¦å³*/</span></span><br><span class="line"><span class="comment">/*ä¸€ä¸ªå‚æ•°ï¼Œä¸Šä¸‹å·¦å³*/</span></span><br><span class="line"><span class="comment">/*ä¸‰ä¸ªå‚æ•° ä¸Š ä¸‹ å·¦å³*/</span></span><br><span class="line"><span class="comment">/*å››ä¸ªå‚æ•° ä¸Š å³ ä¸‹ å·¦  é¡ºæ—¶é’ˆ*/</span></span><br></pre></td></tr></table></figure><h3 id="4-åœ†è§’è¾¹æ¡†"><a href="#4-åœ†è§’è¾¹æ¡†" class="headerlink" title="4.åœ†è§’è¾¹æ¡†"></a>4.åœ†è§’è¾¹æ¡†</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">ä¸€ä¸ªå‚æ•°ï¼Œâ˜æ¯ä¸ªè§’</span></span><br><span class="line"><span class="comment">å·¦ä¸Š å³ä¸Š å³ä¸‹ å·¦ä¸‹ é¡ºæ—¶é’ˆ</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="attribute">border-radius</span>: <span class="number">50px</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure><h3 id="5-é˜´å½±"><a href="#5-é˜´å½±" class="headerlink" title="5.é˜´å½±"></a>5.é˜´å½±</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">box-shadow</span>: <span class="number">#62daff</span> <span class="number">10px</span> <span class="number">10px</span> <span class="number">100px</span>;</span><br><span class="line"><span class="comment">/*é¢œè‰² æ°´å¹³åç§» å‚ç›´åç§» é˜´å½±åŠå¾„ */</span></span><br></pre></td></tr></table></figure><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220205131856990.png" alt="image-20220205131856990"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">img</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-radius</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">box-shadow</span>: <span class="number">#62daff</span> <span class="number">10px</span> <span class="number">10px</span> <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../../image/a.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="5-æµ®åŠ¨"><a href="#5-æµ®åŠ¨" class="headerlink" title="5.æµ®åŠ¨"></a>5.æµ®åŠ¨</h2><h3 id="5-1-æ ‡å‡†æ–‡æ¡£æµ"><a href="#5-1-æ ‡å‡†æ–‡æ¡£æµ" class="headerlink" title="5.1 æ ‡å‡†æ–‡æ¡£æµ"></a>5.1 æ ‡å‡†æ–‡æ¡£æµ</h3><p>å—çº§å…ƒç´ ï¼šç‹¬å ä¸€è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">h1~h6 p div åˆ—è¡¨..</span><br></pre></td></tr></table></figure><p>è¡Œå†…å…ƒç´ ï¼šä¸ç‹¬å ä¸€è¡Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">span a img strong</span><br></pre></td></tr></table></figure><p>è¡Œå†…å…ƒç´  å¯ä»¥è¢«åŒ…æ‹¬åœ¨å—çº§å…ƒç´ ä¸­ï¼Œåä¹‹ï¼Œåˆ™ä¸å¯ä»¥ã€‚</p><h3 id="5-2-display"><a href="#5-2-display" class="headerlink" title="5.2 display"></a>5.2 display</h3><ol><li>blockå—å…ƒç´ </li><li>inlineè¡Œå†…å…ƒç´ </li><li>inline-block æ˜¯å—å…ƒç´ ï¼Œä½†å¯ä»¥å†…è”ï¼Œåœ¨ä¸€è¡Œï¼</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="comment">/*</span></span></span><br><span class="line"><span class="comment"><span class="language-css">        blockå—å…ƒç´ </span></span></span><br><span class="line"><span class="comment"><span class="language-css">        inlineè¡Œå†…å…ƒç´ </span></span></span><br><span class="line"><span class="comment"><span class="language-css">        inline-block æ˜¯å—å…ƒç´ ï¼Œä½†å¯ä»¥å†…è”ï¼Œåœ¨ä¸€è¡Œï¼</span></span></span><br><span class="line"><span class="comment"><span class="language-css">        */</span></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">div</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">#FF0000</span> <span class="number">1px</span> solid;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">span</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">#FF0000</span> <span class="number">1px</span> solid;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>divå—å…ƒç´ <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>spanè¡Œå†…å…ƒç´ <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>1.è¿™ä¸ªä¹Ÿæ˜¯ä¸€ç§å®ç°è¡Œå†…å…ƒç´ æ’åˆ—çš„æ–¹å¼ï¼Œå½“æ—¶å¾ˆå¤šæƒ…å†µä½¿ç”¨float </p><h3 id="5-3-float"><a href="#5-3-float" class="headerlink" title="5.3 float"></a>5.3 float</h3><p>1.å·¦å³æµ®åŠ¨</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">div</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">padding</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#father</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">1px</span> <span class="number">#000</span> solid;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.layer1</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">1px</span> <span class="number">#F00</span> dashed;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">float</span>: right;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.layer2</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">1px</span> <span class="number">#00f</span> dashed;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">float</span>: right;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.layer3</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">1px</span> <span class="number">#060</span> dashed;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">float</span>: right;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.layer4</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">1px</span> <span class="number">#62daff</span> dashed;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">font-size</span>: <span class="number">12px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">line-height</span>: <span class="number">23px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">float</span>: right;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">clear</span>: both;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;father&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layer1&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../../image/a.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layer2&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../../image/a.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layer3&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../../image/a.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layer4&quot;</span>&gt;</span></span><br><span class="line">        æµ®åŠ¨çš„ç›’å­å¯ä»¥å‘å·¦ï¼Œä¹Ÿå¯ä»¥å‘å³æµ®åŠ¨ï¼Œç›´åˆ°å®ƒçš„å¤–è¾¹ç¼˜ç¢°åˆ°åŒ…å«æ¡†æˆ–è€…å¦ä¸€ä¸ªæµ®åŠ¨ç›’å­ä¸ºæ­¢ã€‚</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="5-4-çˆ¶çº§è¾¹æ¡†å¡Œé™·"><a href="#5-4-çˆ¶çº§è¾¹æ¡†å¡Œé™·" class="headerlink" title="5.4 çˆ¶çº§è¾¹æ¡†å¡Œé™·"></a>5.4 çˆ¶çº§è¾¹æ¡†å¡Œé™·</h3><p>clear</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">      clear: both;ä¸¤ä¾§ä¸å…è®¸æœ‰æµ®åŠ¨å…ƒç´ </span></span><br><span class="line"><span class="comment">      clear: right;å³ä¾§ä¸å…è®¸æœ‰æµ®åŠ¨å…ƒç´ </span></span><br><span class="line"><span class="comment">      clear: left;å·¦ä¾§ä¸å…è®¸æœ‰æµ®åŠ¨å…ƒç´ </span></span><br><span class="line"><span class="comment">      clear: none;</span></span><br><span class="line"><span class="comment">      */</span></span><br></pre></td></tr></table></figure><p>è§£å†³æ–¹æ¡ˆï¼š</p><p>1.å¢åŠ çˆ¶çº§å…ƒç´ çš„é«˜åº¦</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*1.å¢åŠ çˆ¶çº§å…ƒç´ é«˜åº¦*/</span></span><br><span class="line"><span class="selector-id">#father</span>&#123;</span><br><span class="line">            <span class="attribute">border</span>: <span class="number">1px</span> <span class="number">#000</span> solid;</span><br><span class="line">            <span class="attribute">height</span>: <span class="number">800px</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>2.å¢åŠ ä¸€ä¸ªdivæ ‡ç­¾ï¼Œæ¸…é™¤æµ®åŠ¨</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="selector-tag">div</span> class=&quot;<span class="attribute">clear</span>&quot;&gt;&lt;/<span class="selector-tag">div</span>&gt;</span><br><span class="line">   <span class="selector-class">.clear</span>&#123;</span><br><span class="line">        <span class="attribute">clear</span>: both;</span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>3.overflow</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*3.çˆ¶ç±»å¢åŠ ä¸€ä¸ªoverflow*/</span></span><br><span class="line">            <span class="attribute">overflow</span>: hidden;</span><br></pre></td></tr></table></figure><p>4.çˆ¶ç±»å¢åŠ ä¸€ä¸ªä¼ªç±»</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#father</span><span class="selector-pseudo">:after</span>&#123;</span><br><span class="line">            <span class="comment">/*4.å¢åŠ ä¸€ä¸ªä¼ªç±»*/</span></span><br><span class="line">            <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="attribute">display</span>: block;</span><br><span class="line">            <span class="attribute">clear</span>: both;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p><strong>å°ç»“ï¼š</strong></p><ol><li>æµ®åŠ¨å…ƒç´ åé¢å¢åŠ ç©ºdivç®€å•ï¼Œä»£ç å°½é‡é¿å…ç©ºçš„div</li><li>è®¾ç½®çˆ¶ç±»çš„é«˜åº¦ç®€å•ï¼Œå…ƒç´ å‡è®¾æœ‰äº†å›ºå®šçš„é«˜åº¦ï¼Œå°±ä¼šè¢«é™åˆ¶</li><li>overflowç®€å•ï¼Œä¸‹æ‹‰çš„åœºæ™¯é¿å…ä½¿ç”¨</li><li>çˆ¶ç±»å¢åŠ ä¸€ä¸ªä¼ªç±»ï¼šafterï¼ˆæ¨èï¼‰æ— å‰¯ä½œç”¨</li></ol><h3 id="5-5-å¯¹æ¯”"><a href="#5-5-å¯¹æ¯”" class="headerlink" title="5.5 å¯¹æ¯”"></a>5.5 å¯¹æ¯”</h3><p>display</p><p>æ–¹å‘ä¸èƒ½æ§åˆ¶</p><p>float</p><p>æµ®åŠ¨èµ·æ¥çš„è¯ä¼šè„±ç¦»æ ‡å‡†æ–‡æ¡£æµï¼Œæ‰€ä»¥è¦è§£å†³çˆ¶çº§è¾¹æ¡†å¡Œé™·</p><h2 id="6-å®šä½"><a href="#6-å®šä½" class="headerlink" title="6.å®šä½"></a>6.å®šä½</h2><h3 id="6-1ç›¸å¯¹å®šä½"><a href="#6-1ç›¸å¯¹å®šä½" class="headerlink" title="6.1ç›¸å¯¹å®šä½"></a>6.1ç›¸å¯¹å®šä½</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">div</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">padding</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">font-size</span>: <span class="number">12px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">line-height</span>: <span class="number">25px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#father</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">#62daff</span> <span class="number">1px</span> solid;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#first</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: fuchsia <span class="number">1px</span> dashed;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background</span>: <span class="number">#e64c38</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#second</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">#56dfbf</span> <span class="number">1px</span> dashed;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background</span>: aquamarine;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>: relative;<span class="comment">/*ç›¸å¯¹å®šä½*/</span></span></span><br><span class="line"><span class="language-css">            <span class="attribute">top</span>: -<span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">left</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-id">#third</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border</span>: <span class="number">#e64c38</span> <span class="number">1px</span> dashed;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background</span>: brown;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">bottom</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">right</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;father&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;first&quot;</span>&gt;</span>ç¬¬ä¸€ä¸ªç›’å­<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;second&quot;</span>&gt;</span>ç¬¬äºŒä¸ªç›’å­<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;third&quot;</span>&gt;</span>ç¬¬ä¸‰ä¸ªç›’å­<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç›¸å¯¹å®šä½ï¼šposition: relativeï¼›</p><p>ç›¸å¯¹äºåŸæ¥çš„ä½ç½®ï¼Œç»è¡ŒæŒ‡å®šçš„åç§»ï¼Œç›¸å¯¹å®šä½çš„è¯ï¼Œä»–ä»»ç„¶åœ¨æ ‡å‡†æ–‡æ¡£æµä¸­ï¼ŒåŸæ¥çš„ä½ç½®ä¼šè¢«ä¿ç•™ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">top</span>: -<span class="number">10px</span>;ä¸Š</span><br><span class="line"><span class="attribute">left</span>: <span class="number">20px</span>;å·¦</span><br><span class="line"><span class="attribute">bottom</span>: <span class="number">20px</span>;ä¸‹</span><br><span class="line"><span class="attribute">right</span>: <span class="number">30px</span>;å³</span><br><span class="line">æ•°å€¼è¡¨ç¤ºè·ç¦»</span><br></pre></td></tr></table></figure><h3 id="6-2-æµ‹è¯•"><a href="#6-2-æµ‹è¯•" class="headerlink" title="6.2 æµ‹è¯•"></a>6.2 æµ‹è¯•</h3><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220205225313089.png" alt="image-20220205225313089"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-id">#box</span>&#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">height</span>: <span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">padding</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">border</span>: <span class="number">#e64c38</span> solid <span class="number">3px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">a</span>&#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">text-decoration</span>: none;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background</span>: <span class="number">#e086ee</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">color</span>: white;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">display</span>: block;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">line-height</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>&#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background</span>: <span class="number">#62daff</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-id">#a2</span>,<span class="selector-id">#a4</span>&#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">left</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">top</span>: -<span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-id">#a5</span>&#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">left</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">top</span>: -<span class="number">300px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;a1&quot;</span>&gt;</span>é“¾æ¥1<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;a2&quot;</span>&gt;</span>é“¾æ¥2<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;a3&quot;</span>&gt;</span>é“¾æ¥3<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;a4&quot;</span>&gt;</span>é“¾æ¥4<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;a5&quot;</span>&gt;</span>é“¾æ¥5<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="6-3-ç»å¯¹å®šä½"><a href="#6-3-ç»å¯¹å®šä½" class="headerlink" title="6.3 ç»å¯¹å®šä½"></a>6.3 ç»å¯¹å®šä½</h3><p>å®šä½ï¼šåŸºäºxxxxå®šä½ï¼Œä¸Šä¸‹å·¦å³</p><ol><li>æ²¡æœ‰çˆ¶çº§å…ƒç´ çš„å‰æä¸‹ï¼Œç›¸è¾ƒäºæµè§ˆå™¨å®šä½</li><li>å‡è®¾çˆ¶çº§å…ƒç´ å­˜åœ¨å®šä½ï¼Œæˆ‘ä»¬é€šå¸¸ç›¸å¯¹äºçˆ¶çº§å…ƒç´ è¿›è¡Œåç§»</li></ol><p>ç›¸å¯¹äºçˆ¶çº§æˆ–è€…æµè§ˆå™¨çš„ä½ç½®ï¼Œç»è¡ŒæŒ‡å®šçš„åç§»ï¼Œç›¸å¯¹å®šä½çš„è¯ï¼Œä»–ä¸åœ¨æ ‡å‡†æ–‡æ¡£æµä¸­ï¼ŒåŸæ¥çš„ä½ç½®ä¸ä¼šè¢«ä¿ç•™ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">div</span>&#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">padding</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">font-size</span>: <span class="number">12px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">line-height</span>: <span class="number">25px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-id">#father</span>&#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">border</span>: <span class="number">#62daff</span> <span class="number">1px</span> solid;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">padding</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">      <span class="comment">/*çˆ¶çº§å®šä½*/</span></span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-id">#first</span>&#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">border</span>: fuchsia <span class="number">1px</span> dashed;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background</span>: <span class="number">#e64c38</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-id">#second</span>&#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">border</span>: <span class="number">#56dfbf</span> <span class="number">1px</span> dashed;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background</span>: aquamarine;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-id">#third</span>&#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">border</span>: <span class="number">#e64c38</span> <span class="number">1px</span> dashed;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background</span>: brown;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">left</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;father&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;first&quot;</span>&gt;</span>ç¬¬ä¸€ä¸ªç›’å­<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;second&quot;</span>&gt;</span>ç¬¬äºŒä¸ªç›’å­<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;third&quot;</span>&gt;</span>ç¬¬ä¸‰ä¸ªç›’å­<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="6-4-å›ºå®šå®šä½"><a href="#6-4-å›ºå®šå®šä½" class="headerlink" title="6.4 å›ºå®šå®šä½"></a>6.4 å›ºå®šå®šä½</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE <span class="selector-tag">html</span>&gt;</span><br><span class="line">&lt;<span class="selector-tag">html</span> lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-<span class="number">8</span>&quot;&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line"></span><br><span class="line">  &lt;style&gt;</span><br><span class="line">    <span class="selector-tag">body</span>&#123;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">1000px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">div</span><span class="selector-pseudo">:nth-of-type</span>(<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="comment">/*ç»å¯¹å®šä½ï¼Œç›¸å¯¹äºæµè§ˆå™¨*/</span></span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">        <span class="attribute">background</span>: red;</span><br><span class="line">        <span class="attribute">position</span>: absolute;</span><br><span class="line">        <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-tag">div</span><span class="selector-pseudo">:nth-of-type</span>(<span class="number">2</span>)&#123;</span><br><span class="line">        <span class="comment">/*fixed å›ºå®šå®šä½*/</span></span><br><span class="line">        <span class="attribute">width</span>: <span class="number">50px</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">        <span class="attribute">background</span>: yellow;</span><br><span class="line">        <span class="attribute">position</span>: fixed;</span><br><span class="line">        <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &lt;/style&gt;</span><br><span class="line"></span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;<span class="selector-tag">body</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="selector-tag">div</span>&gt;div1&lt;/<span class="selector-tag">div</span>&gt;</span><br><span class="line">&lt;<span class="selector-tag">div</span>&gt;div2&lt;/<span class="selector-tag">div</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;/<span class="selector-tag">body</span>&gt;</span><br><span class="line">&lt;/<span class="selector-tag">html</span>&gt;</span><br></pre></td></tr></table></figure><h3 id="6-5-z-index"><a href="#6-5-z-index" class="headerlink" title="6.5 z-index"></a>6.5 z-index</h3><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220205231753979.png" alt="image-20220205231753979"></p><h2 id="8-æ€»ç»“"><a href="#8-æ€»ç»“" class="headerlink" title="8.æ€»ç»“"></a>8.æ€»ç»“</h2><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220205235511888.png" alt="image-20220205235511888"></p><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220205235600771.png" alt="image-20220205235600771"></p><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220205235627831.png" alt="image-20220205235627831"></p><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220205235713500.png" alt="image-20220205235713500"></p><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220205235736349.png" alt="image-20220205235736349"></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTML</title>
      <link href="/2022/11/20/html/"/>
      <url>/2022/11/20/html/</url>
      
        <content type="html"><![CDATA[<h1 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h1><h2 id="1ã€åˆè¯†HTML"><a href="#1ã€åˆè¯†HTML" class="headerlink" title="1ã€åˆè¯†HTML"></a>1ã€åˆè¯†HTML</h2><h3 id="1-html"><a href="#1-html" class="headerlink" title="1.html"></a>1.html</h3><p><strong>è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€</strong>ï¼ˆè‹±è¯­ï¼š<strong>H</strong>yper<strong>T</strong>ext <strong>M</strong>arkup <strong>L</strong>anguageï¼Œç®€ç§°ï¼š<strong>HTML</strong>ï¼‰æ˜¯ä¸€ç§ç”¨äºåˆ›å»º<a href="https://zh.wikipedia.org/wiki/%E7%BD%91%E9%A1%B5">ç½‘é¡µ</a>çš„æ ‡å‡†<a href="https://zh.wikipedia.org/wiki/%E6%A0%87%E8%AE%B0%E8%AF%AD%E8%A8%80">æ ‡è®°è¯­è¨€</a>ã€‚</p><p>HTMLæ˜¯ä¸€ç§åŸºç¡€æŠ€æœ¯ï¼Œå¸¸ä¸<a href="https://zh.wikipedia.org/wiki/CSS">CSS</a>ã€<a href="https://zh.wikipedia.org/wiki/JavaScript">JavaScript</a>ä¸€èµ·è¢«ä¼—å¤šç½‘ç«™ç”¨äºè®¾è®¡ç½‘é¡µã€ç½‘é¡µåº”ç”¨ç¨‹åºä»¥åŠç§»åŠ¨åº”ç”¨ç¨‹åºçš„ç”¨æˆ·ç•Œé¢[<a href="https://zh.wikipedia.org/wiki/HTML#cite_note-3">3]</a>ã€‚</p><h3 id="2-htmlã€cssã€JavaScript"><a href="#2-htmlã€cssã€JavaScript" class="headerlink" title="2.htmlã€cssã€JavaScript"></a>2.htmlã€cssã€JavaScript</h3><p>html:åŸºç¡€ç½‘é¡µhtml5</p><p>css:æ ·å¼ç¾åŒ–  css3</p><p>javaScriptï¼šåŠ¨æ€æ¸²æŸ“</p><h3 id="3-ç½‘é¡µçš„åŸºæœ¬ä¿¡æ¯"><a href="#3-ç½‘é¡µçš„åŸºæœ¬ä¿¡æ¯" class="headerlink" title="3. ç½‘é¡µçš„åŸºæœ¬ä¿¡æ¯"></a>3. ç½‘é¡µçš„åŸºæœ¬ä¿¡æ¯</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- DOCTYPE:å‘Šè¯‰æµè§ˆå™¨ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨ä»€ä¹ˆè§„èŒƒ --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- head:ç½‘é¡µçš„å¤´éƒ¨ --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--mate:æè¿°æ€§æ ‡ç­¾ï¼Œæè¿°ç½‘ç«™çš„ä¸€äº›ä¿¡æ¯--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--mate ä¸€èˆ¬ç”¨æ¥åšSEO--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- titleï¼šç½‘é¡µæ ‡é¢˜ --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- body:ç½‘é¡µä¸»ä½“ ä»£ç ä¸»è¦å†™åœ¨è¿™--&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- DOCTYPE:å‘Šè¯‰æµè§ˆå™¨ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨ä»€ä¹ˆè§„èŒƒ --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- head:ç½‘é¡µçš„å¤´éƒ¨ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--mate:æè¿°æ€§æ ‡ç­¾ï¼Œæè¿°ç½‘ç«™çš„ä¸€äº›ä¿¡æ¯--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--mate ä¸€èˆ¬ç”¨æ¥åšSEO--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;keywords&quot;</span> <span class="attr">content</span>=<span class="string">&quot;è·³åŠ¨çš„çŒª&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;description&quot;</span> <span class="attr">content</span>=<span class="string">&quot;è¿™æ˜¯ä¸€ä¸ªå¯ä»¥è·³çš„ğŸ–&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- titleï¼šç½‘é¡µæ ‡é¢˜ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>æˆ‘çš„ç¬¬ä¸€ä¸ªç½‘é¡µ<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- body:ç½‘é¡µä¸»ä½“--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">ğŸ–åœ¨è·³åŠ¨ï¼ï¼ï¼</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2ã€ç½‘é¡µçš„åŸºæœ¬æ ‡ç­¾"><a href="#2ã€ç½‘é¡µçš„åŸºæœ¬æ ‡ç­¾" class="headerlink" title="2ã€ç½‘é¡µçš„åŸºæœ¬æ ‡ç­¾"></a>2ã€ç½‘é¡µçš„åŸºæœ¬æ ‡ç­¾</h2><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220128153751776.png" alt="image-20220128153751776"></p><table><thead><tr><th>æ ‡é¢˜æ ‡ç­¾</th><th><h1>ä¸€çº§æ ‡é¢˜</h1>   <h2>äºŒçº§æ ‡é¢˜</h2></th></tr></thead><tbody><tr><td>æ®µè½æ ‡ç­¾</td><td><p>ä¸¤åªè€è™ï¼Œ</p></td></tr><tr><td>æ°´å¹³çº¿æ ‡ç­¾</td><td><hr/></td></tr><tr><td>æ¢è¡Œæ ‡ç­¾</td><td><br/></td></tr><tr><td>ç²—ä½“</td><td><strong>i love you</strong></td></tr><tr><td>æ–œä½“</td><td><em>i love you</em></td></tr><tr><td>ç©ºæ ¼</td><td>&amp;nbsp</td></tr><tr><td>å¤§äº</td><td>&amp;gt</td></tr><tr><td>å°äº</td><td>&amp;lt</td></tr><tr><td>ç‰ˆæƒ</td><td>&amp;copy</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>åŸºæœ¬æ ‡ç­¾å­¦ä¹ <span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--æ ‡é¢˜æ ‡ç­¾--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>ä¸€çº§æ ‡é¢˜<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>äºŒçº§æ ‡é¢˜<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>ä¸‰çº§æ ‡é¢˜<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h4</span>&gt;</span>å››çº§æ ‡é¢˜<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h5</span>&gt;</span>äº”çº§æ ‡é¢˜<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h6</span>&gt;</span>å…­çº§æ ‡é¢˜<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--æ®µè½æ ‡ç­¾--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>ä¸¤åªè€è™ï¼Œ<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>ä¸¤åªè€è™ï¼Œ<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>è·‘å¾—å¿«ï¼Œ<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>è·‘å¾—å¿«ï¼Œ<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>ä¸€åªæ²¡æœ‰çœ¼ç›<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>ä¸€åªæ²¡æœ‰å°¾å·´<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>çœŸå¥‡æ€ª,çœŸå¥‡æ€ª<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--æ°´å¹³çº¿æ ‡ç­¾--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!--æ¢è¡Œæ ‡ç­¾--&gt;</span></span><br><span class="line">ä¸¤åªè€è™ï¼Œ<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">ä¸¤åªè€è™<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">è·‘å¾—å¿«,<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">è·‘å¾—å¿«,<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">ä¸€åªæ²¡æœ‰çœ¼ç›,<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">ä¸€åªæ²¡æœ‰å°¾å·´,<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">çœŸå¥‡æ€ª,çœŸå¥‡æ€ª.<span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--ç²—ä½“ï¼Œæ–œä½“--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>å­—ä½“æ ·å¼æ ‡ç­¾<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line">ç²—ä½“ï¼ši love you    <span class="tag">&lt;<span class="name">strong</span>&gt;</span>i love you<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line">æ–œä½“ï¼ši love you    <span class="tag">&lt;<span class="name">em</span>&gt;</span>i love you<span class="tag">&lt;/<span class="name">em</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--ç‰¹æ®Šç¬¦å·--&gt;</span></span><br><span class="line">ç©ºæ ¼</span><br><span class="line">ç©º<span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span>æ ¼</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">&amp;gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line"><span class="symbol">&amp;lt;</span></span><br><span class="line"></span><br><span class="line"><span class="symbol">&amp;copy;</span>ç‰ˆæƒ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="3ã€å›¾åƒã€è¶…é“¾æ¥ã€ç½‘é¡µå¸ƒå±€"><a href="#3ã€å›¾åƒã€è¶…é“¾æ¥ã€ç½‘é¡µå¸ƒå±€" class="headerlink" title="3ã€å›¾åƒã€è¶…é“¾æ¥ã€ç½‘é¡µå¸ƒå±€"></a>3ã€å›¾åƒã€è¶…é“¾æ¥ã€ç½‘é¡µå¸ƒå±€</h2><h3 id="1-å›¾åƒæ ‡ç­¾"><a href="#1-å›¾åƒæ ‡ç­¾" class="headerlink" title="1.å›¾åƒæ ‡ç­¾"></a>1.å›¾åƒæ ‡ç­¾</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">src:å›¾ç‰‡åœ°å€ï¼ˆå¿…å¡«ï¼‰</span><br><span class="line">    ç›¸å¯¹åœ°å€ï¼ˆæ¨èï¼‰ï¼Œç»å¯¹åœ°å€</span><br><span class="line">    ../  -- ä¸Šä¸€çº§ç›®å½•</span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span> <span class="attr">title</span>=<span class="string">&quot;&quot;</span> <span class="attr">width</span>=<span class="string">&quot;&quot;</span> <span class="attr">height</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>å›¾åƒæ ‡ç­¾<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">src:å›¾ç‰‡åœ°å€ï¼ˆå¿…å¡«ï¼‰</span></span><br><span class="line"><span class="comment">    ç›¸å¯¹åœ°å€ï¼ˆæ¨èï¼‰ï¼Œç»å¯¹åœ°å€ D:\JAVAé¡¹ç›®\HTML\resources\image\1.png</span></span><br><span class="line"><span class="comment">    ../  -- ä¸Šä¸€çº§ç›®å½•</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../resources/image/1.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;é£æ™¯&quot;</span> <span class="attr">title</span>=<span class="string">&quot;é£æ™¯&quot;</span> <span class="attr">width</span>=<span class="string">&quot;384&quot;</span> <span class="attr">height</span>=<span class="string">&quot;245&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-é“¾æ¥æ ‡ç­¾å­¦ä¹ "><a href="#2-é“¾æ¥æ ‡ç­¾å­¦ä¹ " class="headerlink" title="2.é“¾æ¥æ ‡ç­¾å­¦ä¹ "></a>2.é“¾æ¥æ ‡ç­¾å­¦ä¹ </h3><ul><li><p>aæ ‡ç­¾</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">href:å¿…å¡«ï¼Œè¡¨ç¤ºè¦è·³è½¬åˆ°é‚£ä¸ªç•Œé¢</span><br><span class="line">target:è¡¨ç¤ºçª—å£åœ¨å“ªæ‰“å¼€</span><br><span class="line">        _blank  åœ¨æ–°æ ‡ç­¾æ‰“å¼€</span><br><span class="line">        _self   åœ¨è‡ªå·±çš„ç½‘é¡µä¸­æ‰“å¼€</span><br></pre></td></tr></table></figure></li><li><p>é”šé“¾æ¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">é”šé“¾æ¥</span><br><span class="line">1.éœ€è¦ä¸€ä¸ªé”šæ ‡è®°</span><br><span class="line">2.è·³è½¬åˆ°æ ‡è®°</span><br></pre></td></tr></table></figure></li><li><p>åŠŸèƒ½é“¾æ¥</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">åŠŸèƒ½é“¾æ¥</span><br><span class="line"></span><br><span class="line">é‚®ä»¶é“¾æ¥ï¼šmailto</span><br></pre></td></tr></table></figure></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>é“¾æ¥æ ‡ç­¾å­¦ä¹ <span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--ä½¿ç”¨nameæ ‡è®°--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">name</span>=<span class="string">&quot;top&quot;</span>&gt;</span>é¡¶éƒ¨<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--aæ ‡ç­¾</span></span><br><span class="line"><span class="comment">href:å¿…å¡«ï¼Œè¡¨ç¤ºè¦è·³è½¬åˆ°é‚£ä¸ªç•Œé¢</span></span><br><span class="line"><span class="comment">target:è¡¨ç¤ºçª—å£åœ¨å“ªæ‰“å¼€</span></span><br><span class="line"><span class="comment">        _blank  åœ¨æ–°æ ‡ç­¾æ‰“å¼€</span></span><br><span class="line"><span class="comment">        _self   åœ¨è‡ªå·±çš„ç½‘é¡µä¸­æ‰“å¼€</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;1.æˆ‘çš„ç¬¬ä¸€ä¸ªhtmlæ–‡ä»¶.html&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span>&gt;</span>ç‚¹è®°æˆ‘è·³è½¬åˆ°ç¬¬ä¸€ä¸ªç•Œé¢<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;http://www.baidu.com&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span>&gt;</span>ç™¾åº¦<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;2.åŸºæœ¬æ ‡ç­¾å­¦ä¹ .html&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../resources/image/1.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;é£æ™¯&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;2.åŸºæœ¬æ ‡ç­¾å­¦ä¹ .html&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../resources/image/1.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;é£æ™¯&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;2.åŸºæœ¬æ ‡ç­¾å­¦ä¹ .html&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../resources/image/1.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;é£æ™¯&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;2.åŸºæœ¬æ ‡ç­¾å­¦ä¹ .html&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../resources/image/1.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;é£æ™¯&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;2.åŸºæœ¬æ ‡ç­¾å­¦ä¹ .html&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../resources/image/1.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;é£æ™¯&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--é”šé“¾æ¥</span></span><br><span class="line"><span class="comment">1.éœ€è¦ä¸€ä¸ªé”šæ ‡è®°</span></span><br><span class="line"><span class="comment">2.è·³è½¬åˆ°æ ‡è®°</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#top&quot;</span>&gt;</span>å›åˆ°é¡¶éƒ¨<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">name</span>=<span class="string">&quot;down&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--åŠŸèƒ½é“¾æ¥</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">é‚®ä»¶é“¾æ¥ï¼šmailto</span></span><br><span class="line"><span class="comment">qqæ¨å¹¿</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;mailto:huangruidong.xauat@gmail.com&quot;</span>&gt;</span>ç‚¹å‡»è”ç³»æˆ‘<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-è¡Œå…ƒç´ ï¼Œå—å…ƒç´ "><a href="#3-è¡Œå…ƒç´ ï¼Œå—å…ƒç´ " class="headerlink" title="3.è¡Œå…ƒç´ ï¼Œå—å…ƒç´ "></a>3.è¡Œå…ƒç´ ï¼Œå—å…ƒç´ </h3><p>å—å…ƒç´ ï¼šæ— è®ºå†…å®¹å¤šå°‘ï¼Œè¯¥å…ƒç´ ç‹¬å ä¸€è¡Œï¼ˆpã€h1-h6ï¼‰</p><p>è¡Œå†…å…ƒç´ ï¼šå†…å®¹æ’‘å¼€å®½åº¦ï¼Œå·¦å³éƒ½æ˜¯è¡Œå†…å…ƒç´ çš„å¯ä»¥æ’åœ¨ä¸€è¡Œï¼ˆa.strong.emâ€¦ï¼‰</p><h2 id="4ã€åˆ—è¡¨ã€è¡¨æ ¼ã€åª’ä½“å…ƒç´ "><a href="#4ã€åˆ—è¡¨ã€è¡¨æ ¼ã€åª’ä½“å…ƒç´ " class="headerlink" title="4ã€åˆ—è¡¨ã€è¡¨æ ¼ã€åª’ä½“å…ƒç´ "></a>4ã€åˆ—è¡¨ã€è¡¨æ ¼ã€åª’ä½“å…ƒç´ </h2><h3 id="1-åˆ—è¡¨"><a href="#1-åˆ—è¡¨" class="headerlink" title="1.åˆ—è¡¨"></a>1.åˆ—è¡¨</h3><ul><li>æœ‰åºåˆ—è¡¨ol</li><li>æ— åºåˆ—è¡¨     ul</li><li>è‡ªå®šä¹‰åˆ—è¡¨   dl</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>åˆ—è¡¨<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--æœ‰åºåˆ—è¡¨</span></span><br><span class="line"><span class="comment">åº”ç”¨èŒƒå›´ï¼šè¯•å·ï¼Œé—®ç­”...</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>java<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>python<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>cpp<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>golang<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>rust<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--æ— åºåˆ—è¡¨</span></span><br><span class="line"><span class="comment">åº”ç”¨èŒƒå›´ï¼šå¯¼èˆªæ ï¼Œä¾§è¾¹æ ...</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>java<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>python<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>cpp<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>golang<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>rust<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--è‡ªå®šä¹‰åˆ—è¡¨</span></span><br><span class="line"><span class="comment">dl:æ ‡ç­¾</span></span><br><span class="line"><span class="comment">dt:åˆ—è¡¨åç§°</span></span><br><span class="line"><span class="comment">dd:åˆ—è¡¨å†…å®¹</span></span><br><span class="line"><span class="comment">åº”ç”¨èŒƒå›´:å…¬å¸ç½‘ç«™åº•éƒ¨</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dt</span>&gt;</span>è¯­è¨€<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>java<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>python<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>cpp<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>golang<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dd</span>&gt;</span>rust<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-è¡¨æ ¼"><a href="#2-è¡¨æ ¼" class="headerlink" title="2.è¡¨æ ¼"></a>2.è¡¨æ ¼</h3><p>colspan è·¨åˆ—</p><p>rowspanè·¨è¡Œ</p><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220128224929843.png" alt="image-20220128224929843"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>è¡¨æ ¼<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--è¡¨æ ¼table</span></span><br><span class="line"><span class="comment">è¡Œ tr rows</span></span><br><span class="line"><span class="comment">åˆ— td</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1px&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--colspan è·¨åˆ—--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">colspan</span>=<span class="string">&quot;4&quot;</span>&gt;</span>1-1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--rowspanè·¨è¡Œ--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">rowspan</span>=<span class="string">&quot;2&quot;</span>&gt;</span>2-1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>2-2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>2-3<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>2-4<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>3-1<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>3-2<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>3-3<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-åª’ä½“"><a href="#3-åª’ä½“" class="headerlink" title="3.åª’ä½“"></a>3.åª’ä½“</h3><p>éŸ³é¢‘å’Œè§†é¢‘</p><ul><li>src:èµ„æºè·¯å¾„</li><li>controls:æ§åˆ¶æ¡</li><li>autoplay:è‡ªåŠ¨æ’­æ”¾</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>åª’ä½“<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--éŸ³é¢‘å’Œè§†é¢‘</span></span><br><span class="line"><span class="comment">src:èµ„æºè·¯å¾„</span></span><br><span class="line"><span class="comment">controls:æ§åˆ¶æ¡</span></span><br><span class="line"><span class="comment">autoplay:è‡ªåŠ¨æ’­æ”¾</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--&lt;video src=&quot;../resources/video/xxx.mp4&quot; controls autoplay&gt;&lt;/video&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">audio</span> <span class="attr">src</span>=<span class="string">&quot;../resources/audio/æš—æ %20-%20èµ°æ­Œäºº.mp3&quot;</span> <span class="attr">controls</span> <span class="attr">autoplay</span>&gt;</span><span class="tag">&lt;/<span class="name">audio</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="4-é¡µé¢ç»“æ„åˆ†æ"><a href="#4-é¡µé¢ç»“æ„åˆ†æ" class="headerlink" title="4.é¡µé¢ç»“æ„åˆ†æ"></a>4.é¡µé¢ç»“æ„åˆ†æ</h3><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220128230608569.png" alt="image-20220128230608569"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>é¡µé¢ç»“æ„<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>ç½‘é¡µå¤´éƒ¨<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">section</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>ç½‘é¡µä¸»é¢˜<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">footer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>ç½‘é¡µè„šéƒ¨<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="5-iframeå†…è”æ¡†æ¶"><a href="#5-iframeå†…è”æ¡†æ¶" class="headerlink" title="5.iframeå†…è”æ¡†æ¶"></a>5.iframeå†…è”æ¡†æ¶</h3><p>iframeå†…è”æ¡†æ¶</p><ul><li>srcï¼šå¼•ç”¨é¡µé¢åœ°å€ </li><li>w-h:å®½åº¦é«˜åº¦</li><li>name:æ¡†æ¶æ ‡è¯†ç¬¦</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>å†…è”æ¡†æ¶iframe<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--iframeå†…è”æ¡†æ¶</span></span><br><span class="line"><span class="comment">srcï¼šåœ°å€</span></span><br><span class="line"><span class="comment">w-h:å®½åº¦é«˜åº¦</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;1.æˆ‘çš„ç¬¬ä¸€ä¸ªhtmlæ–‡ä»¶.html&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hello&quot;</span> <span class="attr">width</span>=<span class="string">&quot;1000px&quot;</span> <span class="attr">height</span>=<span class="string">&quot;800px0&quot;</span> <span class="attr">frameborder</span>=<span class="string">&quot;0&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://blog.kuangstudy.com&quot;</span>&gt;</span>ç‹‚ç¥<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--&lt;iframe src=&quot;//player.bilibili.com/player.html?aid=55631961&amp;bvid=BV1x4411V75C&amp;cid=97257967&amp;page=11&quot;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        scrolling=&quot;no&quot; border=&quot;0&quot; frameborder=&quot;no&quot; framespacing=&quot;0&quot; allowfullscreen=&quot;true&quot;&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--&lt;/iframe&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="5ã€åˆ—è¡¨åŠè¡¨å•åº”ç”¨"><a href="#5ã€åˆ—è¡¨åŠè¡¨å•åº”ç”¨" class="headerlink" title="5ã€åˆ—è¡¨åŠè¡¨å•åº”ç”¨"></a>5ã€åˆ—è¡¨åŠè¡¨å•åº”ç”¨</h2><h3 id="1-fromè¡¨å•"><a href="#1-fromè¡¨å•" class="headerlink" title="1.fromè¡¨å•"></a>1.fromè¡¨å•</h3><p>formè¡¨å•</p><p>action:è¡¨å•æäº¤çš„ä½ç½®ï¼Œå¯ä»¥æ˜¯ç½‘ç«™ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªè¯·æ±‚å¤„ç†çš„åœ°å€</p><p>method:post,get æäº¤æ–¹å¼</p><ul><li><p>â€‹    getæ–¹å¼æäº¤ï¼šæˆ‘ä»¬å¯ä»¥åœ¨urlä¸­çœ‹åˆ°æˆ‘ä»¬æäº¤çš„ä¿¡æ¯ï¼Œä¸å®‰å…¨ï¼Œé«˜æ•ˆ</p><p>åœ¨æµè§ˆå™¨å®¡æŸ¥å…ƒç´ è·å–è¾“å…¥</p><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220129212305053.png" alt="image-20220129212305053"></p></li><li><p>â€‹    post:æ¯”è¾ƒå®‰å…¨ï¼Œä¸èƒ½ä¼ è¾“å¤§æ–‡ä»¶</p><p>useråç¼€</p><p><a href="http://localhost:63342/HTML/html/1.%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AAhtml%E6%96%87%E4%BB%B6.html?username=2005010112&amp;pwd=123456">http://localhost:63342/HTML/html/1.%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AAhtml%E6%96%87%E4%BB%B6.html?username=2005010112&amp;pwd=123456</a></p><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220129212425873.png" alt="image-20220129212425873"></p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>ç™»é™†æ³¨å†Œ<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>ç™»å½•<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--formè¡¨å•</span></span><br><span class="line"><span class="comment">action:è¡¨å•æäº¤çš„ä½ç½®ï¼Œå¯ä»¥æ˜¯ç½‘ç«™ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªè¯·æ±‚å¤„ç†çš„åœ°å€</span></span><br><span class="line"><span class="comment">method:post,get æäº¤æ–¹å¼</span></span><br><span class="line"><span class="comment">    getæ–¹å¼æäº¤ï¼šæˆ‘ä»¬å¯ä»¥åœ¨urlä¸­çœ‹åˆ°æˆ‘ä»¬æäº¤çš„ä¿¡æ¯ï¼Œä¸å®‰å…¨ï¼Œé«˜æ•ˆ</span></span><br><span class="line"><span class="comment">    post:æ¯”è¾ƒå®‰å…¨ï¼Œä¸èƒ½ä¼ è¾“å¤§æ–‡ä»¶</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;1.æˆ‘çš„ç¬¬ä¸€ä¸ªhtmlæ–‡ä»¶.html&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--æ–‡æœ¬è¾“å…¥æ¡†input type=&quot;text&quot;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>åå­—ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¯†ç æ¡†ï¼šinput type=&quot;password&quot;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>å¯†ç æ¡†:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;pwd&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;reset&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-æ–‡æœ¬æ¡†å•é€‰æ¡†"><a href="#2-æ–‡æœ¬æ¡†å•é€‰æ¡†" class="headerlink" title="2.æ–‡æœ¬æ¡†å•é€‰æ¡†"></a>2.æ–‡æœ¬æ¡†å•é€‰æ¡†</h3><p><strong>æ–‡æœ¬æ¡†é€‰æ‹©æ ‡ç­¾</strong>ï¼šå¯ä»¥æ²¡æœ‰</p><ul><li>value&#x3D;â€è·³åŠ¨çš„çŒªâ€    é»˜è®¤æ˜¯åˆå§‹å€¼</li><li>maxlength&#x3D;â€8â€      æœ€å¤§å­—ç¬¦é•¿åº¦</li><li>size&#x3D;â€30â€           æ–‡æœ¬æ¡†é•¿åº¦</li></ul><p><strong>å•é€‰æ¡†æ ‡ç­¾</strong>ï¼šè‡³å°‘æœ‰çš„ä¸‰ä¸ªå€¼</p><ul><li>input type&#x3D;â€radioâ€  radioæ˜¯å•é€‰æ¡†</li><li>value&#x3D;â€boyâ€     å•é€‰æ¡†çš„å€¼</li><li>name&#x3D;â€sexâ€       è¡¨ç¤ºç»„ï¼šåªæœ‰å€¼åœ¨ä¸€ä¸ªç»„æ‰å¯ä»¥å•é€‰</li></ul><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220129212725281.png" alt="image-20220129212725281"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>ç™»é™†æ³¨å†Œ<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>ç™»å½•<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--formè¡¨å•</span></span><br><span class="line"><span class="comment">action:è¡¨å•æäº¤çš„ä½ç½®ï¼Œå¯ä»¥æ˜¯ç½‘ç«™ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªè¯·æ±‚å¤„ç†çš„åœ°å€</span></span><br><span class="line"><span class="comment">method:post,get æäº¤æ–¹å¼</span></span><br><span class="line"><span class="comment">    getæ–¹å¼æäº¤ï¼šæˆ‘ä»¬å¯ä»¥åœ¨urlä¸­çœ‹åˆ°æˆ‘ä»¬æäº¤çš„ä¿¡æ¯ï¼Œä¸å®‰å…¨ï¼Œé«˜æ•ˆ</span></span><br><span class="line"><span class="comment">    post:æ¯”è¾ƒå®‰å…¨ï¼Œä¸èƒ½ä¼ è¾“å¤§æ–‡ä»¶</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;1.æˆ‘çš„ç¬¬ä¸€ä¸ªhtmlæ–‡ä»¶.html&quot;</span> <span class="attr">method</span>=<span class="string">&quot;get&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--æ–‡æœ¬è¾“å…¥æ¡†input type=&quot;text&quot;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">value=&quot;è·³åŠ¨çš„çŒª&quot;    é»˜è®¤æ˜¯åˆå§‹å€¼</span></span><br><span class="line"><span class="comment">maxlength=&quot;8&quot;      æœ€å¤§å­—ç¬¦é•¿åº¦</span></span><br><span class="line"><span class="comment">size=&quot;30&quot;           æ–‡æœ¬æ¡†é•¿åº¦--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>åå­—ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;è·³åŠ¨çš„çŒª&quot;</span> <span class="attr">maxlength</span>=<span class="string">&quot;8&quot;</span> <span class="attr">size</span>=<span class="string">&quot;30&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¯†ç æ¡†ï¼šinput type=&quot;password&quot;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>å¯†ç æ¡†:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;pwd&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="comment">&lt;!--å•é€‰æ¡†æ ‡ç­¾</span></span><br><span class="line"><span class="comment">input type=&quot;radio&quot;  radioæ˜¯å•é€‰æ¡†</span></span><br><span class="line"><span class="comment">value=&quot;boy&quot;     å•é€‰æ¡†çš„å€¼</span></span><br><span class="line"><span class="comment">name=&quot;sex&quot;       è¡¨ç¤ºç»„ï¼šåªæœ‰å€¼åœ¨ä¸€ä¸ªç»„æ‰å¯ä»¥å•é€‰</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        æ€§åˆ«ï¼š</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">value</span>=<span class="string">&quot;boy&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span>&gt;</span>ç”·</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">value</span>=<span class="string">&quot;girl&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span>&gt;</span>å¥³</span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;reset&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-æŒ‰é’®å¤šé€‰æ¡†"><a href="#3-æŒ‰é’®å¤šé€‰æ¡†" class="headerlink" title="3.æŒ‰é’®å¤šé€‰æ¡†"></a>3.æŒ‰é’®å¤šé€‰æ¡†</h3><p><strong>å¤šé€‰æ¡†</strong></p><ul><li>input type&#x3D;â€checkboxâ€   å¤šé€‰æ¡†</li><li>value&#x3D;â€sleepâ€            å€¼</li><li>name&#x3D;â€hobbyâ€            åˆ†ç»„</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">value</span>=<span class="string">&quot;chat&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span>&gt;</span>èŠå¤©</span><br></pre></td></tr></table></figure><p><strong>æ˜¾ç¤ºçš„æ˜¯åè¾¹çš„æ–‡å­—ï¼Œæäº¤çš„å€¼æ˜¯value</strong></p><p><strong>æŒ‰é’®</strong>ï¼š</p><ul><li>input type&#x3D;â€buttonâ€ æ™®é€šæŒ‰é’®</li><li>input type&#x3D;â€imageâ€  å›¾åƒæŒ‰é’®    æäº¤</li><li>input type&#x3D;â€submitâ€ æäº¤æŒ‰é’®</li><li>input type&#x3D;â€resetâ€  é‡ç½®</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>ç™»é™†æ³¨å†Œ<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>ç™»å½•<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--formè¡¨å•</span></span><br><span class="line"><span class="comment">action:è¡¨å•æäº¤çš„ä½ç½®ï¼Œå¯ä»¥æ˜¯ç½‘ç«™ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªè¯·æ±‚å¤„ç†çš„åœ°å€</span></span><br><span class="line"><span class="comment">method:post,get æäº¤æ–¹å¼</span></span><br><span class="line"><span class="comment">    getæ–¹å¼æäº¤ï¼šæˆ‘ä»¬å¯ä»¥åœ¨urlä¸­çœ‹åˆ°æˆ‘ä»¬æäº¤çš„ä¿¡æ¯ï¼Œä¸å®‰å…¨ï¼Œé«˜æ•ˆ</span></span><br><span class="line"><span class="comment">    post:æ¯”è¾ƒå®‰å…¨ï¼Œä¸èƒ½ä¼ è¾“å¤§æ–‡ä»¶</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;1.æˆ‘çš„ç¬¬ä¸€ä¸ªhtmlæ–‡ä»¶.html&quot;</span> <span class="attr">method</span>=<span class="string">&quot;get&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--æ–‡æœ¬è¾“å…¥æ¡†input type=&quot;text&quot;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">value=&quot;è·³åŠ¨çš„çŒª&quot;    é»˜è®¤æ˜¯åˆå§‹å€¼</span></span><br><span class="line"><span class="comment">maxlength=&quot;8&quot;      æœ€å¤§å­—ç¬¦é•¿åº¦</span></span><br><span class="line"><span class="comment">size=&quot;30&quot;           æ–‡æœ¬æ¡†é•¿åº¦--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>åå­—ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;è·³åŠ¨çš„çŒª&quot;</span> <span class="attr">maxlength</span>=<span class="string">&quot;8&quot;</span> <span class="attr">size</span>=<span class="string">&quot;30&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--å¯†ç æ¡†ï¼šinput type=&quot;password&quot;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>å¯†ç æ¡†:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;pwd&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--å•é€‰æ¡†æ ‡ç­¾</span></span><br><span class="line"><span class="comment">input type=&quot;radio&quot;  radioæ˜¯å•é€‰æ¡†</span></span><br><span class="line"><span class="comment">value=&quot;boy&quot;     å•é€‰æ¡†çš„å€¼</span></span><br><span class="line"><span class="comment">name=&quot;sex&quot;       è¡¨ç¤ºç»„ï¼šåªæœ‰å€¼åœ¨ä¸€ä¸ªç»„æ‰å¯ä»¥å•é€‰</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        æ€§åˆ«ï¼š</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">value</span>=<span class="string">&quot;boy&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span>&gt;</span>ç”·</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">value</span>=<span class="string">&quot;girl&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span>&gt;</span>å¥³</span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="comment">&lt;!--å¤šé€‰æ¡†</span></span><br><span class="line"><span class="comment">input type=&quot;checkbox&quot;   å¤šé€‰æ¡†</span></span><br><span class="line"><span class="comment">value=&quot;sleep&quot;            å€¼</span></span><br><span class="line"><span class="comment">name=&quot;hobby&quot;            åˆ†ç»„</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>å¤šé€‰æ¡†:çˆ±å¥½</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">value</span>=<span class="string">&quot;sleep&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span>&gt;</span>ç¡è§‰</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">value</span>=<span class="string">&quot;code&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span>&gt;</span>æ•²ä»£ç </span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">value</span>=<span class="string">&quot;chat&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span>&gt;</span>èŠå¤©</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">value</span>=<span class="string">&quot;game&quot;</span> <span class="attr">name</span>=<span class="string">&quot;hobby&quot;</span>&gt;</span>æ¸¸æˆ</span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="comment">&lt;!--æŒ‰é’®ï¼š</span></span><br><span class="line"><span class="comment">input type=&quot;button&quot; æ™®é€šæŒ‰é’®</span></span><br><span class="line"><span class="comment">input type=&quot;image&quot;  å›¾åƒæŒ‰é’®    æäº¤</span></span><br><span class="line"><span class="comment">input type=&quot;submit&quot; æäº¤æŒ‰é’®</span></span><br><span class="line"><span class="comment">input type=&quot;reset&quot;  é‡ç½®</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>æŒ‰é’®ï¼š</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">name</span>=<span class="string">&quot;btn&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ä½ ä¹Ÿæƒ³è·³åŠ¨å—&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;image&quot;</span> <span class="attr">src</span>=<span class="string">&quot;../resources/image/1.png&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;reset&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="4-æ–‡æœ¬åŸŸã€æ–‡ä»¶åŸŸã€ä¸‹æ‹‰æ¡†"><a href="#4-æ–‡æœ¬åŸŸã€æ–‡ä»¶åŸŸã€ä¸‹æ‹‰æ¡†" class="headerlink" title="4.æ–‡æœ¬åŸŸã€æ–‡ä»¶åŸŸã€ä¸‹æ‹‰æ¡†"></a>4.æ–‡æœ¬åŸŸã€æ–‡ä»¶åŸŸã€ä¸‹æ‹‰æ¡†</h3><p><strong>æ–‡æœ¬åŸŸï¼š</strong></p><ul><li>cols&#x3D;â€30â€åˆ—</li><li>rows&#x3D;â€10â€ è¡Œ</li></ul><p><strong>æ–‡ä»¶åŸŸ</strong></p><ul><li>input type&#x3D;â€fileâ€</li><li>name&#x3D;â€filesâ€</li></ul><p><strong>ä¸‹æ‹‰æ¡†ï¼Œåˆ—è¡¨æ¡†</strong>    </p><ul><li>select åˆ—è¡¨</li><li>option å€¼</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ–‡æœ¬åŸŸï¼š</span></span><br><span class="line"><span class="comment">cols=&quot;30&quot;åˆ—</span></span><br><span class="line"><span class="comment">rows=&quot;10&quot; è¡Œ</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>åé¦ˆï¼ˆæ–‡æœ¬åŸŸï¼‰ï¼š</span><br><span class="line">        <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">name</span>=<span class="string">&quot;textarea&quot;</span> <span class="attr">cols</span>=<span class="string">&quot;30&quot;</span> <span class="attr">rows</span>=<span class="string">&quot;10&quot;</span>&gt;</span>æ–‡æœ¬å†…å®¹<span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--æ–‡ä»¶åŸŸ</span></span><br><span class="line"><span class="comment">input type=&quot;file&quot;</span></span><br><span class="line"><span class="comment">name=&quot;files&quot;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>ä¸Šä¼ æ–‡ä»¶ï¼ˆæ–‡ä»¶åŸŸï¼‰</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;files&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;ä¸Šä¼ &quot;</span> <span class="attr">name</span>=<span class="string">&quot;upload&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">&lt;!--ä¸‹æ‹‰æ¡†ï¼Œåˆ—è¡¨æ¡†    </span></span><br><span class="line"><span class="comment">select åˆ—è¡¨</span></span><br><span class="line"><span class="comment">option å€¼</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>å›½å®¶ï¼ˆä¸‹æ‹‰æ¡†ï¼Œåˆ—è¡¨æ¡†ï¼‰ï¼š</span><br><span class="line">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">&quot;åˆ—è¡¨åç§°&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;china&quot;</span>&gt;</span>ä¸­å›½<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;us&quot;</span>&gt;</span>ç¾å›½<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;eth&quot;</span>&gt;</span>ç‘å£«<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="5-å…¶ä»–ç›¸å…³æ¡†"><a href="#5-å…¶ä»–ç›¸å…³æ¡†" class="headerlink" title="5.å…¶ä»–ç›¸å…³æ¡†"></a>5.å…¶ä»–ç›¸å…³æ¡†</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--    é‚®ç®±éªŒè¯--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>é‚®ç®±ï¼š</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;email&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    url--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;url&quot;</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    æ•°å­—--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>å•†å“æ•°é‡</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> <span class="attr">name</span>=<span class="string">&quot;num&quot;</span> <span class="attr">max</span>=<span class="string">&quot;10&quot;</span> <span class="attr">min</span>=<span class="string">&quot;0&quot;</span> <span class="attr">step</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    æ»‘å—--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>éŸ³é‡ï¼š</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;range&quot;</span> <span class="attr">name</span>=<span class="string">&quot;voice&quot;</span> <span class="attr">min</span>=<span class="string">&quot;0&quot;</span> <span class="attr">max</span>=<span class="string">&quot;100&quot;</span> <span class="attr">step</span>=<span class="string">&quot;10&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--    æœç´¢æ¡†--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>æœç´¢ï¼š</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;search&quot;</span> <span class="attr">name</span>=<span class="string">&quot;search&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="6-è¡¨å•çš„åº”ç”¨"><a href="#6-è¡¨å•çš„åº”ç”¨" class="headerlink" title="6.è¡¨å•çš„åº”ç”¨"></a>6.è¡¨å•çš„åº”ç”¨</h3><ul><li>éšè—åŸŸ hidden</li><li>åªè¯» readonly</li><li>ç¦ç”¨ disabled</li><li>é»˜è®¤ selected</li><li>æç¤º placeholder</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--    å¢å¼ºé¼ æ ‡å¯è¯»æ€§--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;mark&quot;</span>&gt;</span>ä½ ç‚¹æˆ‘è¯•è¯•<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="6ã€è¡¨å•åˆçº§éªŒè¯"><a href="#6ã€è¡¨å•åˆçº§éªŒè¯" class="headerlink" title="6ã€è¡¨å•åˆçº§éªŒè¯"></a>6ã€è¡¨å•åˆçº§éªŒè¯</h2><ul><li>placeholder æç¤ºä¿¡æ¯</li><li>required éç©ºåˆ¤æ–­</li><li>pattern æ­£åˆ™è¡¨è¾¾å¼</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">p</span>&gt;</span>åå­—ï¼š<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;è¯·è¾“å…¥ç”¨æˆ·å&quot;</span> <span class="attr">required</span> &gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>è‡ªå®šä¹‰é‚®ç®±:</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;diy email&quot;</span> <span class="attr">pattern</span>=<span class="string">&quot;^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="7-æ€»ç»“"><a href="#7-æ€»ç»“" class="headerlink" title="7.æ€»ç»“"></a>7.æ€»ç»“</h2><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220129230412584.png" alt="image-20220129230412584"></p><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220129230443469.png" alt="image-20220129230443469"></p><p><img src="C:\Users\huangruidong\AppData\Roaming\Typora\typora-user-images\image-20220129230347184.png" alt="image-20220129230347184"></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rabbit MQ</title>
      <link href="/2022/11/20/RabbitMQ/"/>
      <url>/2022/11/20/RabbitMQ/</url>
      
        <content type="html"><![CDATA[<h1 id="Rabbit-MQ"><a href="#Rabbit-MQ" class="headerlink" title="Rabbit MQ"></a>Rabbit MQ</h1><h2 id="MQåŸºæœ¬æ¦‚å¿µ"><a href="#MQåŸºæœ¬æ¦‚å¿µ" class="headerlink" title="MQåŸºæœ¬æ¦‚å¿µ"></a>MQåŸºæœ¬æ¦‚å¿µ</h2><h3 id="MQæ¦‚è¿°"><a href="#MQæ¦‚è¿°" class="headerlink" title="MQæ¦‚è¿°"></a>MQæ¦‚è¿°</h3><p>MQå…¨ç§° Message Queueï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ï¼‰ï¼Œæ˜¯åœ¨<code>æ¶ˆæ¯çš„ä¼ è¾“è¿‡ç¨‹ä¸­ä¿å­˜æ¶ˆæ¯çš„å®¹å™¨</code>ã€‚å¤šç”¨äº<code>åˆ†å¸ƒå¼ç³»ç»Ÿä¹‹é—´è¿›è¡Œé€šä¿¡</code>ã€‚</p><p>ç›´æ¥è°ƒç”¨ï¼š</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171023027.png" alt="image-20221017102354985"></p><p>æ”¹è¿›ä¸ºï¼š</p><p>å€ŸåŠ©ç¬¬ä¸‰æ–¹å®Œæˆé€šä¿¡</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171024464.png" alt="image-20221017102411430"></p><ul><li>MQï¼Œæ¶ˆæ¯é˜Ÿåˆ—ï¼Œå­˜å‚¨æ¶ˆæ¯çš„ä¸­é—´ä»¶</li><li>åˆ†å¸ƒå¼ç³»ç»Ÿé€šä¿¡ä¸¤ç§æ–¹å¼ï¼šç›´æ¥è¿œç¨‹è°ƒç”¨ å’Œ å€ŸåŠ©ç¬¬ä¸‰æ–¹ å®Œæˆé—´æ¥é€šä¿¡</li><li>å‘é€æ–¹ç§°ä¸ºç”Ÿäº§è€…ï¼Œæ¥æ”¶æ–¹ç§°ä¸ºæ¶ˆè´¹è€…</li></ul><h3 id="MQçš„ä¼˜åŠ£"><a href="#MQçš„ä¼˜åŠ£" class="headerlink" title="MQçš„ä¼˜åŠ£"></a>MQçš„ä¼˜åŠ£</h3><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171026966.png" alt="image-20221017102603930"></p><h4 id="MQçš„ä¼˜åŠ¿"><a href="#MQçš„ä¼˜åŠ¿" class="headerlink" title="MQçš„ä¼˜åŠ¿"></a>MQçš„ä¼˜åŠ¿</h4><h5 id="åº”ç”¨è§£è€¦"><a href="#åº”ç”¨è§£è€¦" class="headerlink" title="åº”ç”¨è§£è€¦"></a>åº”ç”¨è§£è€¦</h5><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171026208.png" alt="image-20221017102635168"></p><p>å¯¹äºä¿®æ”¹ç›¸å…³è¿çš„å­ç³»ç»Ÿï¼Œéœ€è¦å¯¹æ•´ä¸ªç³»ç»Ÿè¿›è¡Œä¿®æ”¹ã€‚ç³»ç»Ÿè€¦åˆåº¦é«˜ã€‚</p><p><strong>ç³»ç»Ÿçš„è€¦åˆæ€§è¶Šé«˜ï¼Œå®¹é”™æ€§å°±è¶Šä½ï¼Œå¯ç»´æŠ¤æ€§å°±è¶Šä½</strong></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171027077.png" alt="image-20221017102753030"></p><p>ä½¿ç”¨MQï¼Œè®¢å•ç³»ç»Ÿçš„ä¿¡æ¯ç›´æ¥å­˜å…¥MQï¼Œåç»­çš„ç›¸å…³ä¸šåŠ¡ç³»ç»Ÿé€šè¿‡è®¿é—®MQæ¥è·å–ä¿¡æ¯ã€‚</p><p><strong>ä½¿ç”¨ MQ ä½¿å¾—åº”ç”¨é—´è§£è€¦ï¼Œæå‡å®¹é”™æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</strong></p><h5 id="å¼‚æ­¥æé€Ÿ"><a href="#å¼‚æ­¥æé€Ÿ" class="headerlink" title="å¼‚æ­¥æé€Ÿ"></a>å¼‚æ­¥æé€Ÿ</h5><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171029229.png" alt="image-20221017102929182"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171029493.png" alt="image-20221017102951445"></p><p>åˆ©ç”¨MQï¼Œç”¨æˆ·è¾“å…¥ä¿¡æ¯åï¼Œå…ˆå­˜åœ¨MQï¼Œç›´æ¥å¯¹ç”¨æˆ·è¿›è¡Œç›¸åº”ï¼Œé™ä½å»¶è¿Ÿã€‚åç»­ä¸šåŠ¡å¯ä»¥åˆ©ç”¨å¤šçº¿ç¨‹å®Œæˆã€‚</p><h5 id="å‰Šå³°å¡«è°·"><a href="#å‰Šå³°å¡«è°·" class="headerlink" title="å‰Šå³°å¡«è°·"></a>å‰Šå³°å¡«è°·</h5><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171031679.png" alt="image-20221017103158632"></p><p>å¦‚æœç³»ç»Ÿå¯æ¥å—çš„è¯·æ±‚æ•°é‡å°äºå‘é€çš„è¯·æ±‚æ•°é‡ï¼Œç³»ç»Ÿå°±ä¼šç›´æ¥å´©æ‰ã€‚åˆ©ç”¨MQæ¥ç¼“å­˜è¯·æ±‚ä¿¡æ¯ï¼Œå¯ä»¥ä¿è¯æœåŠ¡å™¨çš„ç¨³å®šï¼Œä¿è¯å…¶æ­£å¸¸è¿è¡Œã€‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171033114.png" alt="image-20221017103321069"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171033709.png" alt="image-20221017103337658"></p><ul><li>åº”ç”¨è§£è€¦ï¼šæé«˜ç³»ç»Ÿå®¹é”™æ€§å’Œå¯ç»´æŠ¤æ€§</li><li>å¼‚æ­¥æé€Ÿï¼šæå‡ç”¨æˆ·ä½“éªŒå’Œç³»ç»Ÿååé‡</li><li>å‰Šå³°å¡«è°·ï¼šæé«˜ç³»ç»Ÿç¨³å®šæ€§</li></ul><h4 id="MQçš„åŠ£åŠ¿"><a href="#MQçš„åŠ£åŠ¿" class="headerlink" title="MQçš„åŠ£åŠ¿"></a>MQçš„åŠ£åŠ¿</h4><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171035406.png" alt="image-20221017103519369"></p><h5 id="ç³»ç»Ÿå¯ç”¨æ€§é™ä½"><a href="#ç³»ç»Ÿå¯ç”¨æ€§é™ä½" class="headerlink" title="ç³»ç»Ÿå¯ç”¨æ€§é™ä½"></a>ç³»ç»Ÿå¯ç”¨æ€§é™ä½</h5><p>ç³»ç»Ÿå¼•å…¥çš„å¤–éƒ¨ä¾èµ–è¶Šå¤šï¼Œç³»ç»Ÿç¨³å®šæ€§è¶Šå·®ã€‚ä¸€æ—¦ MQ å®•æœºï¼Œå°±ä¼šå¯¹ä¸šåŠ¡é€ æˆå½±å“ã€‚å¦‚ä½•ä¿è¯MQçš„é«˜å¯ç”¨ï¼Ÿ</p><h5 id="ç³»ç»Ÿå¤æ‚åº¦é™ä½"><a href="#ç³»ç»Ÿå¤æ‚åº¦é™ä½" class="headerlink" title="ç³»ç»Ÿå¤æ‚åº¦é™ä½"></a>ç³»ç»Ÿå¤æ‚åº¦é™ä½</h5><p>MQ çš„åŠ å…¥å¤§å¤§å¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦ï¼Œä»¥å‰ç³»ç»Ÿé—´æ˜¯åŒæ­¥çš„è¿œç¨‹è°ƒç”¨ï¼Œç°åœ¨æ˜¯é€šè¿‡ MQ è¿›è¡Œå¼‚æ­¥è°ƒç”¨ã€‚å¦‚ä½•ä¿è¯æ¶ˆæ¯æ²¡æœ‰è¢«é‡å¤æ¶ˆè´¹ï¼Ÿæ€ä¹ˆå¤„ç†æ¶ˆæ¯ä¸¢å¤±æƒ…å†µï¼Ÿé‚£ä¹ˆä¿è¯æ¶ˆæ¯ä¼ é€’çš„é¡ºåºæ€§ï¼Ÿ</p><h5 id="ä¸€è‡´æ€§é—®é¢˜"><a href="#ä¸€è‡´æ€§é—®é¢˜" class="headerlink" title="ä¸€è‡´æ€§é—®é¢˜"></a>ä¸€è‡´æ€§é—®é¢˜</h5><p>A ç³»ç»Ÿå¤„ç†å®Œä¸šåŠ¡ï¼Œé€šè¿‡ MQ ç»™Bã€Cã€Dä¸‰ä¸ªç³»ç»Ÿå‘æ¶ˆæ¯æ•°æ®ï¼Œå¦‚æœ B ç³»ç»Ÿã€C ç³»ç»Ÿå¤„ç†æˆåŠŸï¼ŒD ç³»ç»Ÿå¤„ç†å¤±è´¥ã€‚å¦‚ä½•ä¿è¯æ¶ˆæ¯æ•°æ®å¤„ç†çš„ä¸€è‡´æ€§ï¼Ÿ</p><hr><p>å¯¹äºMQçš„ä¼˜åŠ£ï¼ŒMQ éœ€è¦æ»¡è¶³ä»€ä¹ˆæ¡ä»¶ï¼š</p><p>â‘  ç”Ÿäº§è€…ä¸éœ€è¦ä»æ¶ˆè´¹è€…å¤„è·å¾—åé¦ˆã€‚å¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—ä¹‹å‰çš„ç›´æ¥è°ƒç”¨ï¼Œå…¶æ¥å£çš„è¿”å›å€¼åº”è¯¥ä¸ºç©ºï¼Œè¿™æ‰è®©æ˜</p><p>æ˜ä¸‹å±‚çš„åŠ¨ä½œè¿˜æ²¡åšï¼Œä¸Šå±‚å´å½“æˆåŠ¨ä½œåšå®Œäº†ç»§ç»­å¾€åèµ°ï¼Œå³æ‰€è°“å¼‚æ­¥æˆä¸ºäº†å¯èƒ½ã€‚</p><p>â‘¡ å®¹è®¸çŸ­æš‚çš„ä¸ä¸€è‡´æ€§ã€‚</p><p>â‘¢ ç¡®å®æ˜¯ç”¨äº†æœ‰æ•ˆæœã€‚å³è§£è€¦ã€æé€Ÿã€å‰Šå³°è¿™äº›æ–¹é¢çš„æ”¶ç›Šï¼Œè¶…è¿‡åŠ å…¥MQï¼Œç®¡ç†MQè¿™äº›æˆæœ¬</p><h3 id="å¸¸è§çš„MQäº§å“"><a href="#å¸¸è§çš„MQäº§å“" class="headerlink" title="å¸¸è§çš„MQäº§å“"></a>å¸¸è§çš„MQäº§å“</h3><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171039420.png" alt="image-20221017103935360"></p><h3 id="Rabbit-MQç®€ä»‹"><a href="#Rabbit-MQç®€ä»‹" class="headerlink" title="Rabbit MQç®€ä»‹"></a>Rabbit MQç®€ä»‹</h3><p><strong>AMQP</strong>ï¼Œå³ Advanced Message Queuing Protocolï¼ˆ<code>é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®</code>ï¼‰ï¼Œæ˜¯ä¸€ä¸ªç½‘ç»œåè®®ï¼Œæ˜¯åº”ç”¨å±‚åè®®çš„ä¸€ä¸ªå¼€æ”¾æ ‡å‡†ï¼Œä¸ºé¢å‘æ¶ˆæ¯çš„ä¸­é—´ä»¶è®¾è®¡ã€‚åŸºäºæ­¤åè®®çš„å®¢æˆ·ç«¯ä¸æ¶ˆæ¯ä¸­é—´ä»¶å¯ä¼ é€’æ¶ˆæ¯ï¼Œå¹¶ä¸å—å®¢æˆ·ç«¯&#x2F;ä¸­é—´ä»¶ä¸åŒäº§å“ï¼Œä¸åŒçš„å¼€å‘è¯­è¨€ç­‰æ¡ä»¶çš„é™åˆ¶ã€‚2006å¹´ï¼ŒAMQP è§„èŒƒå‘å¸ƒã€‚ç±»æ¯”HTTPã€‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171040287.png" alt="image-20221017104038246"></p><p>2007å¹´ï¼ŒRabbit æŠ€æœ¯å…¬å¸åŸºäº AMQP æ ‡å‡†å¼€å‘çš„ RabbitMQ 1.0 å‘å¸ƒã€‚RabbitMQ é‡‡ç”¨ Erlang è¯­è¨€å¼€å‘ã€‚</p><p>Erlang è¯­è¨€ç”± Ericson è®¾è®¡ï¼Œä¸“é—¨ä¸ºå¼€å‘<code>é«˜å¹¶å‘å’Œåˆ†å¸ƒå¼ç³»ç»Ÿ</code>çš„ä¸€ç§è¯­è¨€ï¼Œåœ¨ç”µä¿¡é¢†åŸŸä½¿ç”¨å¹¿æ³›ã€‚</p><p>RabbitMQ åŸºç¡€æ¶æ„å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171041216.png" alt="image-20221017104125171"></p><hr><p>RabbitMQ ä¸­çš„ç›¸å…³æ¦‚å¿µï¼š</p><ul><li><p>Brokerï¼šæ¥æ”¶å’Œåˆ†å‘æ¶ˆæ¯çš„åº”ç”¨ï¼ŒRabbitMQ Serverå°±æ˜¯ Message Broker</p></li><li><p>Virtual hostï¼ˆè™šæ‹Ÿæœºï¼‰ï¼šå‡ºäºå¤šç§Ÿæˆ·å’Œå®‰å…¨å› ç´ è®¾è®¡çš„ï¼ŒæŠŠ AMQP çš„åŸºæœ¬ç»„ä»¶åˆ’åˆ†åˆ°ä¸€ä¸ªè™šæ‹Ÿçš„åˆ†ç»„ä¸­ï¼Œç±»ä¼¼äºç½‘ç»œä¸­çš„ namespace æ¦‚å¿µã€‚å½“å¤šä¸ªä¸åŒçš„ç”¨æˆ·ä½¿ç”¨åŒä¸€ä¸ª RabbitMQ server æä¾›çš„æœåŠ¡æ—¶ï¼Œå¯ä»¥åˆ’åˆ†å‡ºå¤šä¸ªvhostï¼Œæ¯ä¸ªç”¨æˆ·åœ¨è‡ªå·±çš„ vhost åˆ›å»º exchangeï¼queue ç­‰</p></li><li><p>Connectionï¼špublisherï¼consumer å’Œ broker ä¹‹é—´çš„ TCP è¿æ¥</p></li><li><p>Channelï¼šå¦‚æœæ¯ä¸€æ¬¡è®¿é—® RabbitMQ éƒ½å»ºç«‹ä¸€ä¸ª Connectionï¼Œåœ¨æ¶ˆæ¯é‡å¤§çš„æ—¶å€™å»ºç«‹ TCP Connectionçš„å¼€é”€å°†æ˜¯å·¨å¤§çš„ï¼Œæ•ˆç‡ä¹Ÿè¾ƒä½ã€‚Channel æ˜¯åœ¨ <code>connection å†…éƒ¨å»ºç«‹çš„é€»è¾‘è¿æ¥</code>ï¼Œå¦‚æœåº”ç”¨ç¨‹åºæ”¯æŒå¤šçº¿ç¨‹ï¼Œé€šå¸¸æ¯ä¸ªthreadåˆ›å»ºå•ç‹¬çš„ channel è¿›è¡Œé€šè®¯ï¼ŒAMQP method åŒ…å«äº†channel id å¸®åŠ©å®¢æˆ·ç«¯å’Œmessage broker è¯†åˆ« channelï¼Œæ‰€ä»¥ channel ä¹‹é—´æ˜¯å®Œå…¨éš”ç¦»çš„ã€‚<strong>Channel ä½œä¸ºè½»é‡çº§çš„ Connection æå¤§å‡å°‘äº†æ“ä½œç³»ç»Ÿå»ºç«‹ TCP connection çš„å¼€é”€</strong></p></li><li><p>Exchange(äº¤æ¢æœº)ï¼šmessage åˆ°è¾¾ broker çš„ç¬¬ä¸€ç«™ï¼Œæ ¹æ®åˆ†å‘è§„åˆ™ï¼ŒåŒ¹é…æŸ¥è¯¢è¡¨ä¸­çš„ routing keyï¼Œåˆ†å‘æ¶ˆæ¯åˆ°queue ä¸­å»ã€‚å¸¸ç”¨çš„ç±»å‹æœ‰ï¼šdirect (point-to-point), topic (publish-subscribe) and fanout (multicast)</p></li><li><p>Queueï¼ˆé˜Ÿåˆ—ï¼‰ï¼šæ¶ˆæ¯æœ€ç»ˆè¢«é€åˆ°è¿™é‡Œç­‰å¾… consumer å–èµ°</p></li><li><p>Bindingï¼ˆç»‘å®šï¼‰ï¼šexchange å’Œ queue ä¹‹é—´çš„è™šæ‹Ÿè¿æ¥ï¼Œbinding ä¸­å¯ä»¥åŒ…å« routing keyã€‚Binding ä¿¡æ¯è¢«ä¿å­˜åˆ° exchange ä¸­çš„æŸ¥è¯¢è¡¨ä¸­ï¼Œç”¨äº message çš„åˆ†å‘ä¾æ®</p></li></ul><hr><p>RabbitMQ æä¾›äº† 6 ç§<strong>å·¥ä½œæ¨¡å¼</strong>ï¼šç®€å•æ¨¡å¼ã€work queuesã€Publish&#x2F;Subscribe å‘å¸ƒä¸è®¢é˜…æ¨¡å¼ã€Routingè·¯ç”±å¼ã€Topics ä¸»é¢˜æ¨¡å¼ã€RPC è¿œç¨‹è°ƒç”¨æ¨¡å¼ï¼ˆè¿œç¨‹è°ƒç”¨ï¼Œä¸å¤ªç®— MQï¼›æš‚ä¸ä½œä»‹ç»ï¼‰ã€‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171046024.png" alt="image-20221017104656973"></p><h3 id="JMS"><a href="#JMS" class="headerlink" title="JMS"></a>JMS</h3><ul><li><p>JMS å³ Java æ¶ˆæ¯æœåŠ¡ï¼ˆJavaMessage Serviceï¼‰åº”ç”¨ç¨‹åºæ¥å£ï¼Œæ˜¯ä¸€ä¸ª Java å¹³å°ä¸­å…³äºé¢å‘æ¶ˆæ¯ä¸­é—´ä»¶çš„API</p></li><li><p>JMS æ˜¯ JavaEE è§„èŒƒä¸­çš„ä¸€ç§ï¼Œç±»æ¯”JDBC</p></li><li><p>å¾ˆå¤šæ¶ˆæ¯ä¸­é—´ä»¶éƒ½å®ç°äº†JMSè§„èŒƒï¼Œä¾‹å¦‚ï¼šActiveMQã€‚RabbitMQ å®˜æ–¹æ²¡æœ‰æä¾› JMS çš„å®ç°åŒ…ï¼Œä½†æ˜¯å¼€æºç¤¾åŒºæœ‰</p></li></ul><p><strong>å°ç»“</strong></p><ol><li><p>RabbitMQ æ˜¯åŸºäº AMQP åè®®ä½¿ç”¨ Erlang è¯­è¨€å¼€å‘çš„ä¸€æ¬¾æ¶ˆæ¯é˜Ÿåˆ—äº§å“ã€‚</p></li><li><p>RabbitMQæä¾›äº†6ç§å·¥ä½œæ¨¡å¼ï¼Œæˆ‘ä»¬å­¦ä¹ 5ç§ã€‚è¿™æ˜¯ä»Šå¤©çš„é‡ç‚¹ã€‚</p></li><li><p>AMQP æ˜¯åè®®ï¼Œç±»æ¯”HTTPã€‚</p></li><li><p>JMS æ˜¯ API è§„èŒƒæ¥å£ï¼Œç±»æ¯” JDBCã€‚</p></li></ol><h2 id="MQå¿«é€Ÿå…¥é—¨"><a href="#MQå¿«é€Ÿå…¥é—¨" class="headerlink" title="MQå¿«é€Ÿå…¥é—¨"></a>MQå¿«é€Ÿå…¥é—¨</h2><p>éœ€æ±‚ï¼šä½¿ç”¨ç®€å•æ¨¡å¼å®Œæˆæ¶ˆæ¯ä¼ é€’</p><p>æ­¥éª¤ï¼š</p><p>â‘  åˆ›å»ºå·¥ç¨‹ï¼ˆç”Ÿæˆè€…ã€æ¶ˆè´¹è€…ï¼‰</p><p>â‘¡ åˆ†åˆ«æ·»åŠ ä¾èµ–</p><p>â‘¢ ç¼–å†™ç”Ÿäº§è€…å‘é€æ¶ˆæ¯</p><p>â‘£ ç¼–å†™æ¶ˆè´¹è€…æ¥æ”¶æ¶ˆæ¯</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171050480.png" alt="image-20221017105000425"></p><p>å’ŒJDBCæ“ä½œæ•°æ®åº“ç±»ä¼¼</p><p>ç”Ÿäº§è€…ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">    <span class="comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span></span><br><span class="line">    <span class="type">ConnectionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConnectionFactory</span>();</span><br><span class="line">    <span class="comment">//2.è®¾ç½®å‚æ•°</span></span><br><span class="line">    factory.setHost(<span class="string">&quot;192.168.184.100&quot;</span>);<span class="comment">//ip é»˜è®¤å€¼ localhost</span></span><br><span class="line">    factory.setPort(<span class="number">5672</span>);<span class="comment">//ç«¯å£ é»˜è®¤å€¼5672</span></span><br><span class="line">    factory.setVirtualHost(<span class="string">&quot;/itcast&quot;</span>);<span class="comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span></span><br><span class="line">    factory.setUsername(<span class="string">&quot;dong&quot;</span>);<span class="comment">//ç”¨æˆ·å é»˜è®¤ guest</span></span><br><span class="line">    factory.setPassword(<span class="string">&quot;dong&quot;</span>);<span class="comment">//å¯†ç  é»˜è®¤ guest</span></span><br><span class="line">    <span class="comment">//3.åˆ›å»ºè¿æ¥ Connection</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> factory.newConnection();</span><br><span class="line">    <span class="comment">//4.åˆ›å»ºChannel</span></span><br><span class="line">    <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5.åˆ›å»ºé˜Ÿåˆ—Queue</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * queueDeclare(String queue, boolean durable, boolean exclusive, boolean autoDelete, Map&lt;String, Object&gt; arguments)</span></span><br><span class="line"><span class="comment">        * 1.queueï¼š é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">        * 2.durableï¼š æ˜¯å¦æŒä¹…åŒ–ï¼Œå½“mqé‡å¯åï¼Œè¿˜åœ¨</span></span><br><span class="line"><span class="comment">        * 3.exclusiveï¼š</span></span><br><span class="line"><span class="comment">        *   æ˜¯å¦ç‹¬å ï¼Œåªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…èƒ½å¤Ÿç›‘å¬è¿™ä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">        *   å½“Connectionå…³é—­æ—¶ï¼Œæ˜¯å¦åˆ é™¤é˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">        * 4.autoDeleteï¼š æ˜¯å¦è‡ªåŠ¨åˆ é™¤ã€‚å½“æ²¡æœ‰Consumeræ—¶ï¼Œè‡ªåŠ¨åˆ é™¤æ‰</span></span><br><span class="line"><span class="comment">        * 5.argumentsï¼š å‚æ•°</span></span><br><span class="line"><span class="comment">        * */</span></span><br><span class="line">    <span class="comment">//å¦‚æœæ²¡æœ‰ä¸€ä¸ªå«hello_worldçš„é˜Ÿåˆ—ï¼Œåˆ™åˆ›å»ºè¯¥é˜Ÿåˆ—ï¼Œå¦‚æœæœ‰è¯¥é˜Ÿåˆ—ï¼Œåˆ™ä¸åˆ›å»º</span></span><br><span class="line">    channel.queueDeclare(<span class="string">&quot;hello_world&quot;</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//6.å‘é€æ¶ˆæ¯</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * basicPublish(String exchange, String routingKey, BasicProperties props, byte[] body)</span></span><br><span class="line"><span class="comment">        * 1.exchangeï¼š äº¤æ¢æœºçš„åç§°ã€‚ç®€å•æ¨¡å¼äº¤æ¢æœºä¼šä½¿ç”¨é»˜è®¤çš„ã€‚</span></span><br><span class="line"><span class="comment">        * 2.routingKeyï¼š è·¯ç”±åç§°</span></span><br><span class="line"><span class="comment">        * 3.propsï¼š é…ç½®ä¿¡æ¯</span></span><br><span class="line"><span class="comment">        * 4.bodyï¼š å‘é€æ¶ˆæ¯æ•°æ®</span></span><br><span class="line"><span class="comment">        * */</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">body</span> <span class="operator">=</span> <span class="string">&quot;hello rabbit_mq!!!&quot;</span>;</span><br><span class="line">    channel.basicPublish(<span class="string">&quot;&quot;</span>, <span class="string">&quot;hello_world&quot;</span>, <span class="literal">null</span>, body.getBytes());</span><br><span class="line"></span><br><span class="line">    <span class="comment">//7.é‡Šæ”¾èµ„æº</span></span><br><span class="line">    channel.close();</span><br><span class="line">    connection.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¶ˆè´¹è€…ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">    <span class="comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span></span><br><span class="line">    <span class="type">ConnectionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConnectionFactory</span>();</span><br><span class="line">    <span class="comment">//2.è®¾ç½®å‚æ•°</span></span><br><span class="line">    factory.setHost(<span class="string">&quot;192.168.184.100&quot;</span>);<span class="comment">//ip é»˜è®¤å€¼ localhost</span></span><br><span class="line">    factory.setPort(<span class="number">5672</span>);<span class="comment">//ç«¯å£ é»˜è®¤å€¼5672</span></span><br><span class="line">    factory.setVirtualHost(<span class="string">&quot;/itcast&quot;</span>);<span class="comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span></span><br><span class="line">    factory.setUsername(<span class="string">&quot;dong&quot;</span>);<span class="comment">//ç”¨æˆ·å é»˜è®¤ guest</span></span><br><span class="line">    factory.setPassword(<span class="string">&quot;dong&quot;</span>);<span class="comment">//å¯†ç  é»˜è®¤ guest</span></span><br><span class="line">    <span class="comment">//3.åˆ›å»ºè¿æ¥ Connection</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> factory.newConnection();</span><br><span class="line">    <span class="comment">//4.åˆ›å»ºChannel</span></span><br><span class="line">    <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5.åˆ›å»ºé˜Ÿåˆ—Queue</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * queueDeclare(String queue, boolean durable, boolean exclusive, boolean autoDelete, Map&lt;String, Object&gt; arguments)</span></span><br><span class="line"><span class="comment">         * 1.queueï¼š é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">         * 2.durableï¼š æ˜¯å¦æŒä¹…åŒ–ï¼Œå½“mqé‡å¯åï¼Œè¿˜åœ¨</span></span><br><span class="line"><span class="comment">         * 3.exclusiveï¼š</span></span><br><span class="line"><span class="comment">         *   æ˜¯å¦ç‹¬å ï¼Œåªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…èƒ½å¤Ÿç›‘å¬è¿™ä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">         *   å½“Connectionå…³é—­æ—¶ï¼Œæ˜¯å¦åˆ é™¤é˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">         * 4.autoDeleteï¼š æ˜¯å¦è‡ªåŠ¨åˆ é™¤ã€‚å½“æ²¡æœ‰Consumeræ—¶ï¼Œè‡ªåŠ¨åˆ é™¤æ‰</span></span><br><span class="line"><span class="comment">         * 5.argumentsï¼š å‚æ•°</span></span><br><span class="line"><span class="comment">         * */</span></span><br><span class="line">    <span class="comment">//å¦‚æœæ²¡æœ‰ä¸€ä¸ªå«hello_worldçš„é˜Ÿåˆ—ï¼Œåˆ™åˆ›å»ºè¯¥é˜Ÿåˆ—ï¼Œå¦‚æœæœ‰è¯¥é˜Ÿåˆ—ï¼Œåˆ™ä¸åˆ›å»º</span></span><br><span class="line">    channel.queueDeclare(<span class="string">&quot;hello_world&quot;</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//6.æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * basicConsume(String queue, boolean autoAck, Consumer callback)</span></span><br><span class="line"><span class="comment">        * 1.queue: é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">        * 2.autoAckï¼š æ˜¯å¦è‡ªåŠ¨ç¡®è®¤</span></span><br><span class="line"><span class="comment">        * 3.callbackï¼š å›è°ƒå¯¹è±¡</span></span><br><span class="line"><span class="comment">        * */</span></span><br><span class="line">    <span class="type">Consumer</span> <span class="variable">consumer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultConsumer</span>(channel)&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            * å›è°ƒæ–¹æ³•ï¼Œå½“æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œè¯¥æ–¹æ³•</span></span><br><span class="line"><span class="comment">            *</span></span><br><span class="line"><span class="comment">            * 1.consumerTagï¼š æ ‡è¯†</span></span><br><span class="line"><span class="comment">            * 2.envelopeï¼š è·å–ä¸€äº›ä¿¡æ¯ï¼Œäº¤æ¢æœºï¼Œè·¯ç”±key...</span></span><br><span class="line"><span class="comment">            * 3.properties: é…ç½®ä¿¡æ¯</span></span><br><span class="line"><span class="comment">            * 4.bodyï¼š æ•°æ®</span></span><br><span class="line"><span class="comment">            * */</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleDelivery</span><span class="params">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class="type">byte</span>[] body)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;consumerTagï¼š&quot;</span> + consumerTag);</span><br><span class="line">            System.out.println(<span class="string">&quot;Exchangeï¼š&quot;</span> + envelope.getExchange());</span><br><span class="line">            System.out.println(<span class="string">&quot;RoutingKeyï¼š&quot;</span> + envelope.getRoutingKey());</span><br><span class="line">            System.out.println(<span class="string">&quot;propertiesï¼š&quot;</span> + properties);</span><br><span class="line">            System.out.println(<span class="string">&quot;bodyï¼š&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(body));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    channel.basicConsume(<span class="string">&quot;hello_world&quot;</span>, <span class="literal">true</span>, consumer);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å…³é—­èµ„æºï¼Ÿæ¶ˆè´¹è€…æ˜¯ç›‘å¬ç¨‹åºï¼Œä¸éœ€è¦å…³é—­</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="MQçš„å·¥ä½œæ¨¡å¼"><a href="#MQçš„å·¥ä½œæ¨¡å¼" class="headerlink" title="MQçš„å·¥ä½œæ¨¡å¼"></a>MQçš„å·¥ä½œæ¨¡å¼</h2><h3 id="Work-Queueå·¥ä½œé˜Ÿåˆ—æ¨¡å¼"><a href="#Work-Queueå·¥ä½œé˜Ÿåˆ—æ¨¡å¼" class="headerlink" title="Work Queueå·¥ä½œé˜Ÿåˆ—æ¨¡å¼"></a>Work Queueå·¥ä½œé˜Ÿåˆ—æ¨¡å¼</h3><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171052332.png" alt="image-20221017105234298"></p><ul><li><p><strong>Work Queuesï¼š</strong>ä¸å…¥é—¨ç¨‹åºçš„ç®€å•æ¨¡å¼ç›¸æ¯”ï¼Œå¤šäº†ä¸€ä¸ªæˆ–ä¸€äº›æ¶ˆè´¹ç«¯ï¼Œå¤šä¸ªæ¶ˆè´¹ç«¯å…±åŒæ¶ˆè´¹åŒä¸€ä¸ªé˜Ÿåˆ—ä¸­çš„æ¯ã€‚</p></li><li><p><strong>åº”ç”¨åœºæ™¯</strong>ï¼šå¯¹äºä»»åŠ¡è¿‡é‡æˆ–ä»»åŠ¡è¾ƒå¤šæƒ…å†µä½¿ç”¨å·¥ä½œé˜Ÿåˆ—å¯ä»¥æé«˜ä»»åŠ¡å¤„ç†çš„é€Ÿåº¦</p></li></ul><p>ç”Ÿäº§è€…ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">    <span class="comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span></span><br><span class="line">    <span class="type">ConnectionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConnectionFactory</span>();</span><br><span class="line">    <span class="comment">//2.è®¾ç½®å‚æ•°</span></span><br><span class="line">    factory.setHost(<span class="string">&quot;192.168.184.100&quot;</span>);<span class="comment">//ip é»˜è®¤å€¼ localhost</span></span><br><span class="line">    factory.setPort(<span class="number">5672</span>);<span class="comment">//ç«¯å£ é»˜è®¤å€¼5672</span></span><br><span class="line">    factory.setVirtualHost(<span class="string">&quot;/itcast&quot;</span>);<span class="comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span></span><br><span class="line">    factory.setUsername(<span class="string">&quot;dong&quot;</span>);<span class="comment">//ç”¨æˆ·å é»˜è®¤ guest</span></span><br><span class="line">    factory.setPassword(<span class="string">&quot;dong&quot;</span>);<span class="comment">//å¯†ç  é»˜è®¤ guest</span></span><br><span class="line">    <span class="comment">//3.åˆ›å»ºè¿æ¥ Connection</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> factory.newConnection();</span><br><span class="line">    <span class="comment">//4.åˆ›å»ºChannel</span></span><br><span class="line">    <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5.åˆ›å»ºé˜Ÿåˆ—Queue</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * queueDeclare(String queue, boolean durable, boolean exclusive, boolean autoDelete, Map&lt;String, Object&gt; arguments)</span></span><br><span class="line"><span class="comment">    * 1.queueï¼š é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">    * 2.durableï¼š æ˜¯å¦æŒä¹…åŒ–ï¼Œå½“mqé‡å¯åï¼Œè¿˜åœ¨</span></span><br><span class="line"><span class="comment">    * 3.exclusiveï¼š</span></span><br><span class="line"><span class="comment">    *   æ˜¯å¦ç‹¬å ï¼Œåªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…èƒ½å¤Ÿç›‘å¬è¿™ä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">    *   å½“Connectionå…³é—­æ—¶ï¼Œæ˜¯å¦åˆ é™¤é˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">    * 4.autoDeleteï¼š æ˜¯å¦è‡ªåŠ¨åˆ é™¤ã€‚å½“æ²¡æœ‰Consumeræ—¶ï¼Œè‡ªåŠ¨åˆ é™¤æ‰</span></span><br><span class="line"><span class="comment">    * 5.argumentsï¼š å‚æ•°</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="comment">//å¦‚æœæ²¡æœ‰ä¸€ä¸ªå«hello_worldçš„é˜Ÿåˆ—ï¼Œåˆ™åˆ›å»ºè¯¥é˜Ÿåˆ—ï¼Œå¦‚æœæœ‰è¯¥é˜Ÿåˆ—ï¼Œåˆ™ä¸åˆ›å»º</span></span><br><span class="line">    channel.queueDeclare(<span class="string">&quot;work_queues&quot;</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//6.å‘é€æ¶ˆæ¯</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * basicPublish(String exchange, String routingKey, BasicProperties props, byte[] body)</span></span><br><span class="line"><span class="comment">    * 1.exchangeï¼š äº¤æ¢æœºçš„åç§°ã€‚ç®€å•æ¨¡å¼äº¤æ¢æœºä¼šä½¿ç”¨é»˜è®¤çš„ã€‚</span></span><br><span class="line"><span class="comment">    * 2.routingKeyï¼š è·¯ç”±åç§°</span></span><br><span class="line"><span class="comment">    * 3.propsï¼š é…ç½®ä¿¡æ¯</span></span><br><span class="line"><span class="comment">    * 4.bodyï¼š å‘é€æ¶ˆæ¯æ•°æ®</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">body</span> <span class="operator">=</span> i + <span class="string">&quot;hello rabbit_mq!!!&quot;</span>;</span><br><span class="line">        channel.basicPublish(<span class="string">&quot;&quot;</span>, <span class="string">&quot;work_queues&quot;</span>, <span class="literal">null</span>, body.getBytes());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//7.é‡Šæ”¾èµ„æº</span></span><br><span class="line">    channel.close();</span><br><span class="line">    connection.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¶ˆè´¹è€…1ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">    <span class="comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span></span><br><span class="line">    <span class="type">ConnectionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConnectionFactory</span>();</span><br><span class="line">    <span class="comment">//2.è®¾ç½®å‚æ•°</span></span><br><span class="line">    factory.setHost(<span class="string">&quot;192.168.184.100&quot;</span>);<span class="comment">//ip é»˜è®¤å€¼ localhost</span></span><br><span class="line">    factory.setPort(<span class="number">5672</span>);<span class="comment">//ç«¯å£ é»˜è®¤å€¼5672</span></span><br><span class="line">    factory.setVirtualHost(<span class="string">&quot;/itcast&quot;</span>);<span class="comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span></span><br><span class="line">    factory.setUsername(<span class="string">&quot;dong&quot;</span>);<span class="comment">//ç”¨æˆ·å é»˜è®¤ guest</span></span><br><span class="line">    factory.setPassword(<span class="string">&quot;dong&quot;</span>);<span class="comment">//å¯†ç  é»˜è®¤ guest</span></span><br><span class="line">    <span class="comment">//3.åˆ›å»ºè¿æ¥ Connection</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> factory.newConnection();</span><br><span class="line">    <span class="comment">//4.åˆ›å»ºChannel</span></span><br><span class="line">    <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5.åˆ›å»ºé˜Ÿåˆ—Queue</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * queueDeclare(String queue, boolean durable, boolean exclusive, boolean autoDelete, Map&lt;String, Object&gt; arguments)</span></span><br><span class="line"><span class="comment">     * 1.queueï¼š é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">     * 2.durableï¼š æ˜¯å¦æŒä¹…åŒ–ï¼Œå½“mqé‡å¯åï¼Œè¿˜åœ¨</span></span><br><span class="line"><span class="comment">     * 3.exclusiveï¼š</span></span><br><span class="line"><span class="comment">     *   æ˜¯å¦ç‹¬å ï¼Œåªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…èƒ½å¤Ÿç›‘å¬è¿™ä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     *   å½“Connectionå…³é—­æ—¶ï¼Œæ˜¯å¦åˆ é™¤é˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     * 4.autoDeleteï¼š æ˜¯å¦è‡ªåŠ¨åˆ é™¤ã€‚å½“æ²¡æœ‰Consumeræ—¶ï¼Œè‡ªåŠ¨åˆ é™¤æ‰</span></span><br><span class="line"><span class="comment">     * 5.argumentsï¼š å‚æ•°</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="comment">//å¦‚æœæ²¡æœ‰ä¸€ä¸ªå«hello_worldçš„é˜Ÿåˆ—ï¼Œåˆ™åˆ›å»ºè¯¥é˜Ÿåˆ—ï¼Œå¦‚æœæœ‰è¯¥é˜Ÿåˆ—ï¼Œåˆ™ä¸åˆ›å»º</span></span><br><span class="line">    channel.queueDeclare(<span class="string">&quot;work_queues&quot;</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//6.æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * basicConsume(String queue, boolean autoAck, Consumer callback)</span></span><br><span class="line"><span class="comment">    * 1.queue: é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">    * 2.autoAckï¼š æ˜¯å¦è‡ªåŠ¨ç¡®è®¤</span></span><br><span class="line"><span class="comment">    * 3.callbackï¼š å›è°ƒå¯¹è±¡</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="type">Consumer</span> <span class="variable">consumer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultConsumer</span>(channel)&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * å›è°ƒæ–¹æ³•ï¼Œå½“æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œè¯¥æ–¹æ³•</span></span><br><span class="line"><span class="comment">        *</span></span><br><span class="line"><span class="comment">        * 1.consumerTagï¼š æ ‡è¯†</span></span><br><span class="line"><span class="comment">        * 2.envelopeï¼š è·å–ä¸€äº›ä¿¡æ¯ï¼Œäº¤æ¢æœºï¼Œè·¯ç”±key...</span></span><br><span class="line"><span class="comment">        * 3.properties: é…ç½®ä¿¡æ¯</span></span><br><span class="line"><span class="comment">        * 4.bodyï¼š æ•°æ®</span></span><br><span class="line"><span class="comment">        * */</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleDelivery</span><span class="params">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class="type">byte</span>[] body)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">            <span class="comment">/*System.out.println(&quot;consumerTagï¼š&quot; + consumerTag);</span></span><br><span class="line"><span class="comment">            System.out.println(&quot;Exchangeï¼š&quot; + envelope.getExchange());</span></span><br><span class="line"><span class="comment">            System.out.println(&quot;RoutingKeyï¼š&quot; + envelope.getRoutingKey());</span></span><br><span class="line"><span class="comment">            System.out.println(&quot;propertiesï¼š&quot; + properties);*/</span></span><br><span class="line">            System.out.println(<span class="string">&quot;bodyï¼š&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(body));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    channel.basicConsume(<span class="string">&quot;work_queues&quot;</span>, <span class="literal">true</span>, consumer);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å…³é—­èµ„æºï¼Ÿæ¶ˆè´¹è€…æ˜¯ç›‘å¬ç¨‹åºï¼Œä¸éœ€è¦å…³é—­</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¶ˆè´¹è€…2ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">    <span class="comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span></span><br><span class="line">    <span class="type">ConnectionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConnectionFactory</span>();</span><br><span class="line">    <span class="comment">//2.è®¾ç½®å‚æ•°</span></span><br><span class="line">    factory.setHost(<span class="string">&quot;192.168.184.100&quot;</span>);<span class="comment">//ip é»˜è®¤å€¼ localhost</span></span><br><span class="line">    factory.setPort(<span class="number">5672</span>);<span class="comment">//ç«¯å£ é»˜è®¤å€¼5672</span></span><br><span class="line">    factory.setVirtualHost(<span class="string">&quot;/itcast&quot;</span>);<span class="comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span></span><br><span class="line">    factory.setUsername(<span class="string">&quot;dong&quot;</span>);<span class="comment">//ç”¨æˆ·å é»˜è®¤ guest</span></span><br><span class="line">    factory.setPassword(<span class="string">&quot;dong&quot;</span>);<span class="comment">//å¯†ç  é»˜è®¤ guest</span></span><br><span class="line">    <span class="comment">//3.åˆ›å»ºè¿æ¥ Connection</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> factory.newConnection();</span><br><span class="line">    <span class="comment">//4.åˆ›å»ºChannel</span></span><br><span class="line">    <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5.åˆ›å»ºé˜Ÿåˆ—Queue</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * queueDeclare(String queue, boolean durable, boolean exclusive, boolean autoDelete, Map&lt;String, Object&gt; arguments)</span></span><br><span class="line"><span class="comment">     * 1.queueï¼š é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">     * 2.durableï¼š æ˜¯å¦æŒä¹…åŒ–ï¼Œå½“mqé‡å¯åï¼Œè¿˜åœ¨</span></span><br><span class="line"><span class="comment">     * 3.exclusiveï¼š</span></span><br><span class="line"><span class="comment">     *   æ˜¯å¦ç‹¬å ï¼Œåªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…èƒ½å¤Ÿç›‘å¬è¿™ä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     *   å½“Connectionå…³é—­æ—¶ï¼Œæ˜¯å¦åˆ é™¤é˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     * 4.autoDeleteï¼š æ˜¯å¦è‡ªåŠ¨åˆ é™¤ã€‚å½“æ²¡æœ‰Consumeræ—¶ï¼Œè‡ªåŠ¨åˆ é™¤æ‰</span></span><br><span class="line"><span class="comment">     * 5.argumentsï¼š å‚æ•°</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="comment">//å¦‚æœæ²¡æœ‰ä¸€ä¸ªå«hello_worldçš„é˜Ÿåˆ—ï¼Œåˆ™åˆ›å»ºè¯¥é˜Ÿåˆ—ï¼Œå¦‚æœæœ‰è¯¥é˜Ÿåˆ—ï¼Œåˆ™ä¸åˆ›å»º</span></span><br><span class="line">    channel.queueDeclare(<span class="string">&quot;work_queues&quot;</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//6.æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * basicConsume(String queue, boolean autoAck, Consumer callback)</span></span><br><span class="line"><span class="comment">    * 1.queue: é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">    * 2.autoAckï¼š æ˜¯å¦è‡ªåŠ¨ç¡®è®¤</span></span><br><span class="line"><span class="comment">    * 3.callbackï¼š å›è°ƒå¯¹è±¡</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="type">Consumer</span> <span class="variable">consumer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultConsumer</span>(channel)&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * å›è°ƒæ–¹æ³•ï¼Œå½“æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œè¯¥æ–¹æ³•</span></span><br><span class="line"><span class="comment">        *</span></span><br><span class="line"><span class="comment">        * 1.consumerTagï¼š æ ‡è¯†</span></span><br><span class="line"><span class="comment">        * 2.envelopeï¼š è·å–ä¸€äº›ä¿¡æ¯ï¼Œäº¤æ¢æœºï¼Œè·¯ç”±key...</span></span><br><span class="line"><span class="comment">        * 3.properties: é…ç½®ä¿¡æ¯</span></span><br><span class="line"><span class="comment">        * 4.bodyï¼š æ•°æ®</span></span><br><span class="line"><span class="comment">        * */</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleDelivery</span><span class="params">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class="type">byte</span>[] body)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">            <span class="comment">/*System.out.println(&quot;consumerTagï¼š&quot; + consumerTag);</span></span><br><span class="line"><span class="comment">            System.out.println(&quot;Exchangeï¼š&quot; + envelope.getExchange());</span></span><br><span class="line"><span class="comment">            System.out.println(&quot;RoutingKeyï¼š&quot; + envelope.getRoutingKey());</span></span><br><span class="line"><span class="comment">            System.out.println(&quot;propertiesï¼š&quot; + properties);*/</span></span><br><span class="line">            System.out.println(<span class="string">&quot;bodyï¼š&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(body));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    channel.basicConsume(<span class="string">&quot;work_queues&quot;</span>, <span class="literal">true</span>, consumer);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å…³é—­èµ„æºï¼Ÿæ¶ˆè´¹è€…æ˜¯ç›‘å¬ç¨‹åºï¼Œä¸éœ€è¦å…³é—­</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å°ç»“</strong></p><ol><li><p>åœ¨ä¸€ä¸ªé˜Ÿåˆ—ä¸­å¦‚æœæœ‰å¤šä¸ªæ¶ˆè´¹è€…ï¼Œé‚£ä¹ˆæ¶ˆè´¹è€…ä¹‹é—´å¯¹äºåŒä¸€ä¸ªæ¶ˆæ¯çš„å…³ç³»æ˜¯<strong>ç«äº‰</strong>çš„å…³ç³»ã€‚</p></li><li><p><strong>Work Queues</strong> å¯¹äºä»»åŠ¡è¿‡é‡æˆ–ä»»åŠ¡è¾ƒå¤šæƒ…å†µä½¿ç”¨å·¥ä½œé˜Ÿåˆ—å¯ä»¥æé«˜ä»»åŠ¡å¤„ç†çš„é€Ÿåº¦ã€‚ä¾‹å¦‚ï¼šçŸ­ä¿¡æœåŠ¡éƒ¨ç½²å¤šä¸ªï¼Œåªéœ€è¦æœ‰ä¸€ä¸ªèŠ‚ç‚¹æˆåŠŸå‘é€å³ã€‚</p></li></ol><h3 id="Pub-x2F-Sub-è®¢é˜…æ¨¡å¼"><a href="#Pub-x2F-Sub-è®¢é˜…æ¨¡å¼" class="headerlink" title="Pub&#x2F;Sub è®¢é˜…æ¨¡å¼"></a>Pub&#x2F;Sub è®¢é˜…æ¨¡å¼</h3><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171055713.png" alt="image-20221017105524673"></p><p>å¤šäº†ä¸€å°äº¤æ¢æœº</p><p>åœ¨è®¢é˜…æ¨¡å‹ä¸­ï¼Œå¤šäº†ä¸€ä¸ª Exchange è§’è‰²ï¼Œè€Œä¸”è¿‡ç¨‹ç•¥æœ‰å˜åŒ–ï¼š</p><ul><li><p>Pï¼šç”Ÿäº§è€…ï¼Œä¹Ÿå°±æ˜¯è¦å‘é€æ¶ˆæ¯çš„ç¨‹åºï¼Œä½†æ˜¯ä¸å†å‘é€åˆ°é˜Ÿåˆ—ä¸­ï¼Œè€Œæ˜¯å‘ç»™Xï¼ˆäº¤æ¢æœºï¼‰</p></li><li><p>Cï¼šæ¶ˆè´¹è€…ï¼Œæ¶ˆæ¯çš„æ¥æ”¶è€…ï¼Œä¼šä¸€ç›´ç­‰å¾…æ¶ˆæ¯åˆ°æ¥</p></li><li><p>Queueï¼šæ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ¥æ”¶æ¶ˆæ¯ã€ç¼“å­˜æ¶ˆæ¯</p></li><li><p>Exchangeï¼šäº¤æ¢æœºï¼ˆXï¼‰ã€‚ä¸€æ–¹é¢ï¼Œæ¥æ”¶ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯ã€‚å¦ä¸€æ–¹é¢ï¼ŒçŸ¥é“å¦‚ä½•å¤„ç†æ¶ˆæ¯ï¼Œä¾‹å¦‚é€’äº¤ç»™æŸä¸ªç‰¹åˆ«é˜Ÿåˆ—ã€é€’äº¤ç»™æ‰€æœ‰é˜Ÿåˆ—ã€æˆ–æ˜¯å°†æ¶ˆæ¯ä¸¢å¼ƒã€‚åˆ°åº•å¦‚ä½•æ“ä½œï¼Œå–å†³äºExchangeçš„ç±»å‹ã€‚Exchangeæœ‰å¸¸è§ä»¥ä¸‹3ç§å‹ï¼š</p></li></ul><p>â¢ Fanoutï¼šå¹¿æ’­ï¼Œå°†æ¶ˆæ¯äº¤ç»™æ‰€æœ‰ç»‘å®šåˆ°äº¤æ¢æœºçš„é˜Ÿåˆ—</p><p>â¢ Directï¼šå®šå‘ï¼ŒæŠŠæ¶ˆæ¯äº¤ç»™ç¬¦åˆæŒ‡å®šrouting key çš„é˜Ÿåˆ—</p><p>â¢ Topicï¼šé€šé…ç¬¦ï¼ŒæŠŠæ¶ˆæ¯äº¤ç»™ç¬¦åˆrouting patternï¼ˆè·¯ç”±æ¨¡å¼ï¼‰ çš„é˜Ÿåˆ—</p><p><strong>Exchange</strong>ï¼ˆäº¤æ¢æœºï¼‰åªè´Ÿè´£è½¬å‘æ¶ˆæ¯ï¼Œä¸å…·å¤‡å­˜å‚¨æ¶ˆæ¯çš„èƒ½åŠ›ï¼Œå› æ­¤å¦‚æœæ²¡æœ‰ä»»ä½•é˜Ÿåˆ—ä¸ Exchange ç»‘å®šï¼Œæˆ–è€…æ²¡æœ‰ç¬¦åˆè·¯ç”±è§„åˆ™çš„é˜Ÿåˆ—ï¼Œé‚£ä¹ˆæ¶ˆæ¯ä¼šä¸¢å¤±ï¼</p><p>ç”Ÿäº§è€…:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">    <span class="comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span></span><br><span class="line">    <span class="type">ConnectionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConnectionFactory</span>();</span><br><span class="line">    <span class="comment">//2.è®¾ç½®å‚æ•°</span></span><br><span class="line">    factory.setHost(<span class="string">&quot;192.168.184.100&quot;</span>);<span class="comment">//ip é»˜è®¤å€¼ localhost</span></span><br><span class="line">    factory.setPort(<span class="number">5672</span>);<span class="comment">//ç«¯å£ é»˜è®¤å€¼5672</span></span><br><span class="line">    factory.setVirtualHost(<span class="string">&quot;/itcast&quot;</span>);<span class="comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span></span><br><span class="line">    factory.setUsername(<span class="string">&quot;dong&quot;</span>);<span class="comment">//ç”¨æˆ·å é»˜è®¤ guest</span></span><br><span class="line">    factory.setPassword(<span class="string">&quot;dong&quot;</span>);<span class="comment">//å¯†ç  é»˜è®¤ guest</span></span><br><span class="line">    <span class="comment">//3.åˆ›å»ºè¿æ¥ Connection</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> factory.newConnection();</span><br><span class="line">    <span class="comment">//4.åˆ›å»ºChannel</span></span><br><span class="line">    <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5.åˆ›å»ºäº¤æ¢æœº</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * exchangeDeclare(String exchange, BuiltinExchangeType type, boolean durable, boolean autoDelete, boolean internal, Map&lt;String, Object&gt; arguments)</span></span><br><span class="line"><span class="comment">    * 1.exchange:äº¤æ¢æœºåç§°</span></span><br><span class="line"><span class="comment">    * 2.typeï¼šäº¤æ¢æœºç±»å‹</span></span><br><span class="line"><span class="comment">    *   DIRECT(&quot;direct&quot;),å®šå‘</span></span><br><span class="line"><span class="comment">        FANOUT(&quot;fanout&quot;),æ‰‡å½¢ï¼ˆå¹¿æ’­ï¼‰ï¼Œå‘é€æ¶ˆæ¯åˆ°æ¯ä¸€ä¸ªä¸ä¹‹ç»‘å®šçš„é˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">        TOPIC(&quot;topic&quot;),é€šé…ç¬¦çš„æ–¹å¼</span></span><br><span class="line"><span class="comment">        HEADERS(&quot;headers&quot;);å‚æ•°åŒ¹é…</span></span><br><span class="line"><span class="comment">     3.durableï¼šæ˜¯å¦æŒä¹…åŒ–</span></span><br><span class="line"><span class="comment">     4.autoDeleteï¼šæ˜¯å¦è‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">     5.internalï¼šå†…éƒ¨ä½¿ç”¨ã€‚ä¸€èˆ¬false</span></span><br><span class="line"><span class="comment">     6.arguments:å‚æ•°</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">exchangeName</span> <span class="operator">=</span> <span class="string">&quot;test_fanout&quot;</span>;</span><br><span class="line">    channel.exchangeDeclare(exchangeName, BuiltinExchangeType.FANOUT, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">    <span class="comment">//6.åˆ›å»ºé˜Ÿåˆ—</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">queue1Name</span> <span class="operator">=</span> <span class="string">&quot;test_fanout_queue1&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">queue2Name</span> <span class="operator">=</span> <span class="string">&quot;test_fanout_queue2&quot;</span>;</span><br><span class="line">    channel.queueDeclare(queue1Name, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">    channel.queueDeclare(queue2Name, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">    <span class="comment">//7.ç»‘å®šé˜Ÿåˆ—å’Œäº¤æ¢æœº</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * queueBind(String queue, String exchange, String routingKey)</span></span><br><span class="line"><span class="comment">    * 1.queueï¼šé˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">    * 2.exchangeï¼šäº¤æ¢æœºåç§°</span></span><br><span class="line"><span class="comment">    * 3.routingKeyï¼šè·¯ç”±é”®ï¼Œç»‘å®šè§„åˆ™     å¦‚æœäº¤æ¢æœºçš„ç±»å‹ä¸ºfanout,routingKeyè®¾ç½®ä¸º&quot;&quot;</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    channel.queueBind(queue1Name, exchangeName, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    channel.queueBind(queue2Name, exchangeName, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="comment">//8.å‘é€æ¶ˆæ¯</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">body</span> <span class="operator">=</span> <span class="string">&quot;æ—¥å¿—ä¿¡æ¯ï¼šå¼ ä¸‰è°ƒç”¨äº†finaAllæ–¹æ³•...æ—¥å¿—çº§åˆ«ï¼šinfo...&quot;</span>;</span><br><span class="line">    channel.basicPublish(exchangeName, <span class="string">&quot;&quot;</span>, <span class="literal">null</span>, body.getBytes());</span><br><span class="line">    <span class="comment">//9.é‡Šæ”¾èµ„æº</span></span><br><span class="line">    channel.close();</span><br><span class="line">    connection.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¶ˆè´¹è€…1ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">    <span class="comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span></span><br><span class="line">    <span class="type">ConnectionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConnectionFactory</span>();</span><br><span class="line">    <span class="comment">//2.è®¾ç½®å‚æ•°</span></span><br><span class="line">    factory.setHost(<span class="string">&quot;192.168.184.100&quot;</span>);<span class="comment">//ip é»˜è®¤å€¼ localhost</span></span><br><span class="line">    factory.setPort(<span class="number">5672</span>);<span class="comment">//ç«¯å£ é»˜è®¤å€¼5672</span></span><br><span class="line">    factory.setVirtualHost(<span class="string">&quot;/itcast&quot;</span>);<span class="comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span></span><br><span class="line">    factory.setUsername(<span class="string">&quot;dong&quot;</span>);<span class="comment">//ç”¨æˆ·å é»˜è®¤ guest</span></span><br><span class="line">    factory.setPassword(<span class="string">&quot;dong&quot;</span>);<span class="comment">//å¯†ç  é»˜è®¤ guest</span></span><br><span class="line">    <span class="comment">//3.åˆ›å»ºè¿æ¥ Connection</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> factory.newConnection();</span><br><span class="line">    <span class="comment">//4.åˆ›å»ºChannel</span></span><br><span class="line">    <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5.åˆ›å»ºé˜Ÿåˆ—Queue</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * queueDeclare(String queue, boolean durable, boolean exclusive, boolean autoDelete, Map&lt;String, Object&gt; arguments)</span></span><br><span class="line"><span class="comment">     * 1.queueï¼š é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">     * 2.durableï¼š æ˜¯å¦æŒä¹…åŒ–ï¼Œå½“mqé‡å¯åï¼Œè¿˜åœ¨</span></span><br><span class="line"><span class="comment">     * 3.exclusiveï¼š</span></span><br><span class="line"><span class="comment">     *   æ˜¯å¦ç‹¬å ï¼Œåªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…èƒ½å¤Ÿç›‘å¬è¿™ä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     *   å½“Connectionå…³é—­æ—¶ï¼Œæ˜¯å¦åˆ é™¤é˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     * 4.autoDeleteï¼š æ˜¯å¦è‡ªåŠ¨åˆ é™¤ã€‚å½“æ²¡æœ‰Consumeræ—¶ï¼Œè‡ªåŠ¨åˆ é™¤æ‰</span></span><br><span class="line"><span class="comment">     * 5.argumentsï¼š å‚æ•°</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="comment">//å¦‚æœæ²¡æœ‰ä¸€ä¸ªå«hello_worldçš„é˜Ÿåˆ—ï¼Œåˆ™åˆ›å»ºè¯¥é˜Ÿåˆ—ï¼Œå¦‚æœæœ‰è¯¥é˜Ÿåˆ—ï¼Œåˆ™ä¸åˆ›å»º</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">queue1Name</span> <span class="operator">=</span> <span class="string">&quot;test_fanout_queue1&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">queue2Name</span> <span class="operator">=</span> <span class="string">&quot;test_fanout_queue2&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//6.æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * basicConsume(String queue, boolean autoAck, Consumer callback)</span></span><br><span class="line"><span class="comment">    * 1.queue: é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">    * 2.autoAckï¼š æ˜¯å¦è‡ªåŠ¨ç¡®è®¤</span></span><br><span class="line"><span class="comment">    * 3.callbackï¼š å›è°ƒå¯¹è±¡</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="type">Consumer</span> <span class="variable">consumer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultConsumer</span>(channel)&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * å›è°ƒæ–¹æ³•ï¼Œå½“æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œè¯¥æ–¹æ³•</span></span><br><span class="line"><span class="comment">        *</span></span><br><span class="line"><span class="comment">        * 1.consumerTagï¼š æ ‡è¯†</span></span><br><span class="line"><span class="comment">        * 2.envelopeï¼š è·å–ä¸€äº›ä¿¡æ¯ï¼Œäº¤æ¢æœºï¼Œè·¯ç”±key...</span></span><br><span class="line"><span class="comment">        * 3.properties: é…ç½®ä¿¡æ¯</span></span><br><span class="line"><span class="comment">        * 4.bodyï¼š æ•°æ®</span></span><br><span class="line"><span class="comment">        * */</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleDelivery</span><span class="params">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class="type">byte</span>[] body)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">            <span class="comment">/*System.out.println(&quot;consumerTagï¼š&quot; + consumerTag);</span></span><br><span class="line"><span class="comment">            System.out.println(&quot;Exchangeï¼š&quot; + envelope.getExchange());</span></span><br><span class="line"><span class="comment">            System.out.println(&quot;RoutingKeyï¼š&quot; + envelope.getRoutingKey());</span></span><br><span class="line"><span class="comment">            System.out.println(&quot;propertiesï¼š&quot; + properties);*/</span></span><br><span class="line">            System.out.println(<span class="string">&quot;body:&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(body));</span><br><span class="line">            System.out.println(<span class="string">&quot;å°†æ—¥å¿—ä¿¡æ¯æ‰“å°åˆ°æ§åˆ¶å°....&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    channel.basicConsume(queue1Name, <span class="literal">true</span>, consumer);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å…³é—­èµ„æºï¼Ÿæ¶ˆè´¹è€…æ˜¯ç›‘å¬ç¨‹åºï¼Œä¸éœ€è¦å…³é—­</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¶ˆè´¹è€…2ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">    <span class="comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span></span><br><span class="line">    <span class="type">ConnectionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConnectionFactory</span>();</span><br><span class="line">    <span class="comment">//2.è®¾ç½®å‚æ•°</span></span><br><span class="line">    factory.setHost(<span class="string">&quot;192.168.184.100&quot;</span>);<span class="comment">//ip é»˜è®¤å€¼ localhost</span></span><br><span class="line">    factory.setPort(<span class="number">5672</span>);<span class="comment">//ç«¯å£ é»˜è®¤å€¼5672</span></span><br><span class="line">    factory.setVirtualHost(<span class="string">&quot;/itcast&quot;</span>);<span class="comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span></span><br><span class="line">    factory.setUsername(<span class="string">&quot;dong&quot;</span>);<span class="comment">//ç”¨æˆ·å é»˜è®¤ guest</span></span><br><span class="line">    factory.setPassword(<span class="string">&quot;dong&quot;</span>);<span class="comment">//å¯†ç  é»˜è®¤ guest</span></span><br><span class="line">    <span class="comment">//3.åˆ›å»ºè¿æ¥ Connection</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> factory.newConnection();</span><br><span class="line">    <span class="comment">//4.åˆ›å»ºChannel</span></span><br><span class="line">    <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5.åˆ›å»ºé˜Ÿåˆ—Queue</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * queueDeclare(String queue, boolean durable, boolean exclusive, boolean autoDelete, Map&lt;String, Object&gt; arguments)</span></span><br><span class="line"><span class="comment">     * 1.queueï¼š é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">     * 2.durableï¼š æ˜¯å¦æŒä¹…åŒ–ï¼Œå½“mqé‡å¯åï¼Œè¿˜åœ¨</span></span><br><span class="line"><span class="comment">     * 3.exclusiveï¼š</span></span><br><span class="line"><span class="comment">     *   æ˜¯å¦ç‹¬å ï¼Œåªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…èƒ½å¤Ÿç›‘å¬è¿™ä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     *   å½“Connectionå…³é—­æ—¶ï¼Œæ˜¯å¦åˆ é™¤é˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     * 4.autoDeleteï¼š æ˜¯å¦è‡ªåŠ¨åˆ é™¤ã€‚å½“æ²¡æœ‰Consumeræ—¶ï¼Œè‡ªåŠ¨åˆ é™¤æ‰</span></span><br><span class="line"><span class="comment">     * 5.argumentsï¼š å‚æ•°</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="comment">//å¦‚æœæ²¡æœ‰ä¸€ä¸ªå«hello_worldçš„é˜Ÿåˆ—ï¼Œåˆ™åˆ›å»ºè¯¥é˜Ÿåˆ—ï¼Œå¦‚æœæœ‰è¯¥é˜Ÿåˆ—ï¼Œåˆ™ä¸åˆ›å»º</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">queue1Name</span> <span class="operator">=</span> <span class="string">&quot;test_fanout_queue1&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">queue2Name</span> <span class="operator">=</span> <span class="string">&quot;test_fanout_queue2&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//6.æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * basicConsume(String queue, boolean autoAck, Consumer callback)</span></span><br><span class="line"><span class="comment">    * 1.queue: é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">    * 2.autoAckï¼š æ˜¯å¦è‡ªåŠ¨ç¡®è®¤</span></span><br><span class="line"><span class="comment">    * 3.callbackï¼š å›è°ƒå¯¹è±¡</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="type">Consumer</span> <span class="variable">consumer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultConsumer</span>(channel)&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * å›è°ƒæ–¹æ³•ï¼Œå½“æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œè¯¥æ–¹æ³•</span></span><br><span class="line"><span class="comment">        *</span></span><br><span class="line"><span class="comment">        * 1.consumerTagï¼š æ ‡è¯†</span></span><br><span class="line"><span class="comment">        * 2.envelopeï¼š è·å–ä¸€äº›ä¿¡æ¯ï¼Œäº¤æ¢æœºï¼Œè·¯ç”±key...</span></span><br><span class="line"><span class="comment">        * 3.properties: é…ç½®ä¿¡æ¯</span></span><br><span class="line"><span class="comment">        * 4.bodyï¼š æ•°æ®</span></span><br><span class="line"><span class="comment">        * */</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleDelivery</span><span class="params">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class="type">byte</span>[] body)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">            <span class="comment">/*System.out.println(&quot;consumerTagï¼š&quot; + consumerTag);</span></span><br><span class="line"><span class="comment">            System.out.println(&quot;Exchangeï¼š&quot; + envelope.getExchange());</span></span><br><span class="line"><span class="comment">            System.out.println(&quot;RoutingKeyï¼š&quot; + envelope.getRoutingKey());</span></span><br><span class="line"><span class="comment">            System.out.println(&quot;propertiesï¼š&quot; + properties);*/</span></span><br><span class="line">            System.out.println(<span class="string">&quot;body:&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(body));</span><br><span class="line">            System.out.println(<span class="string">&quot;å°†æ—¥å¿—ä¿¡æ¯ä¿å­˜æ•°æ®åº“....&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    channel.basicConsume(queue2Name, <span class="literal">true</span>, consumer);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å…³é—­èµ„æºï¼Ÿæ¶ˆè´¹è€…æ˜¯ç›‘å¬ç¨‹åºï¼Œä¸éœ€è¦å…³é—­</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> <strong>å°ç»“</strong></p><ol><li><p>äº¤æ¢æœºéœ€è¦ä¸é˜Ÿåˆ—è¿›è¡Œç»‘å®šï¼Œç»‘å®šä¹‹åï¼›ä¸€ä¸ªæ¶ˆæ¯å¯ä»¥è¢«å¤šä¸ªæ¶ˆè´¹è€…éƒ½æ”¶åˆ°ã€‚</p></li><li><p>å‘å¸ƒè®¢é˜…æ¨¡å¼ä¸å·¥ä½œé˜Ÿåˆ—æ¨¡å¼çš„åŒºåˆ«ï¼š</p><ul><li><p>å·¥ä½œé˜Ÿåˆ—æ¨¡å¼ä¸ç”¨å®šä¹‰äº¤æ¢æœºï¼Œè€Œå‘å¸ƒ&#x2F;è®¢é˜…æ¨¡å¼éœ€è¦å®šä¹‰äº¤æ¢æœº</p></li><li><p>å‘å¸ƒ&#x2F;è®¢é˜…æ¨¡å¼çš„ç”Ÿäº§æ–¹æ˜¯é¢å‘äº¤æ¢æœºå‘é€æ¶ˆæ¯ï¼Œå·¥ä½œé˜Ÿåˆ—æ¨¡å¼çš„ç”Ÿäº§æ–¹æ˜¯é¢å‘é˜Ÿåˆ—å‘é€æ¶ˆæ¯(åº•å±‚ä½¿ç”¨é»˜è®¤äº¤æ¢æœº)</p></li><li><p>å‘å¸ƒ&#x2F;è®¢é˜…æ¨¡å¼éœ€è¦è®¾ç½®é˜Ÿåˆ—å’Œäº¤æ¢æœºçš„ç»‘å®šï¼Œå·¥ä½œé˜Ÿåˆ—æ¨¡å¼ä¸éœ€è¦è®¾ç½®ï¼Œå®é™…ä¸Šå·¥ä½œé˜Ÿåˆ—æ¨¡å¼ä¼šå°†é˜Ÿåˆ—ç»‘å®šåˆ°é»˜è®¤çš„äº¤æ¢æœº</p></li></ul></li></ol><h3 id="Routingè·¯ç”±æ¨¡å¼"><a href="#Routingè·¯ç”±æ¨¡å¼" class="headerlink" title="Routingè·¯ç”±æ¨¡å¼"></a>Routingè·¯ç”±æ¨¡å¼</h3><ul><li><p>é˜Ÿåˆ—ä¸äº¤æ¢æœºçš„ç»‘å®šï¼Œä¸èƒ½æ˜¯ä»»æ„ç»‘å®šäº†ï¼Œè€Œæ˜¯è¦æŒ‡å®šä¸€ä¸ª RoutingKeyï¼ˆè·¯ç”±keyï¼‰</p></li><li><p>æ¶ˆæ¯çš„å‘é€æ–¹åœ¨å‘ Exchange å‘é€æ¶ˆæ¯æ—¶ï¼Œä¹Ÿå¿…é¡»æŒ‡å®šæ¶ˆæ¯çš„ RoutingKey</p></li><li><p>Exchange ä¸å†æŠŠæ¶ˆæ¯äº¤ç»™æ¯ä¸€ä¸ªç»‘å®šçš„é˜Ÿåˆ—ï¼Œè€Œæ˜¯æ ¹æ®æ¶ˆæ¯çš„ Routing Key è¿›è¡Œåˆ¤æ–­ï¼Œ<code>åªæœ‰é˜Ÿåˆ—çš„Routingkey ä¸æ¶ˆæ¯çš„ Routing key å®Œå…¨ä¸€è‡´</code>ï¼Œæ‰ä¼šæ¥æ”¶åˆ°æ¶ˆæ¯</p></li></ul><p>å›¾è§£ï¼š<img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171101955.png" alt="image-20221017110151906"></p><ul><li><p>Pï¼šç”Ÿäº§è€…ï¼Œå‘ Exchange å‘é€æ¶ˆæ¯ï¼Œå‘é€æ¶ˆæ¯æ—¶ï¼Œä¼šæŒ‡å®šä¸€ä¸ªrouting key</p></li><li><p>Xï¼šExchangeï¼ˆäº¤æ¢æœºï¼‰ï¼Œæ¥æ”¶ç”Ÿäº§è€…çš„æ¶ˆæ¯ï¼Œç„¶åæŠŠæ¶ˆæ¯é€’äº¤ç»™ä¸ routing key å®Œå…¨åŒ¹é…çš„é˜Ÿåˆ—</p></li><li><p>C1ï¼šæ¶ˆè´¹è€…ï¼Œå…¶æ‰€åœ¨é˜Ÿåˆ—æŒ‡å®šäº†éœ€è¦ routing key ä¸º error çš„æ¶ˆæ¯</p></li><li><p>C2ï¼šæ¶ˆè´¹è€…ï¼Œå…¶æ‰€åœ¨é˜Ÿåˆ—æŒ‡å®šäº†éœ€è¦ routing key ä¸º infoã€errorã€warning çš„æ¶ˆæ¯</p></li></ul><p>ç”Ÿäº§è€…:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">    <span class="comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span></span><br><span class="line">    <span class="type">ConnectionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConnectionFactory</span>();</span><br><span class="line">    <span class="comment">//2.è®¾ç½®å‚æ•°</span></span><br><span class="line">    factory.setHost(<span class="string">&quot;192.168.184.100&quot;</span>);<span class="comment">//ip é»˜è®¤å€¼ localhost</span></span><br><span class="line">    factory.setPort(<span class="number">5672</span>);<span class="comment">//ç«¯å£ é»˜è®¤å€¼5672</span></span><br><span class="line">    factory.setVirtualHost(<span class="string">&quot;/itcast&quot;</span>);<span class="comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span></span><br><span class="line">    factory.setUsername(<span class="string">&quot;dong&quot;</span>);<span class="comment">//ç”¨æˆ·å é»˜è®¤ guest</span></span><br><span class="line">    factory.setPassword(<span class="string">&quot;dong&quot;</span>);<span class="comment">//å¯†ç  é»˜è®¤ guest</span></span><br><span class="line">    <span class="comment">//3.åˆ›å»ºè¿æ¥ Connection</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> factory.newConnection();</span><br><span class="line">    <span class="comment">//4.åˆ›å»ºChannel</span></span><br><span class="line">    <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5.åˆ›å»ºäº¤æ¢æœº</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * exchangeDeclare(String exchange, BuiltinExchangeType type, boolean durable, boolean autoDelete, boolean internal, Map&lt;String, Object&gt; arguments)</span></span><br><span class="line"><span class="comment">    * 1.exchange:äº¤æ¢æœºåç§°</span></span><br><span class="line"><span class="comment">    * 2.typeï¼šäº¤æ¢æœºç±»å‹</span></span><br><span class="line"><span class="comment">    *   DIRECT(&quot;direct&quot;),å®šå‘</span></span><br><span class="line"><span class="comment">        FANOUT(&quot;fanout&quot;),æ‰‡å½¢ï¼ˆå¹¿æ’­ï¼‰ï¼Œå‘é€æ¶ˆæ¯åˆ°æ¯ä¸€ä¸ªä¸ä¹‹ç»‘å®šçš„é˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">        TOPIC(&quot;topic&quot;),é€šé…ç¬¦çš„æ–¹å¼</span></span><br><span class="line"><span class="comment">        HEADERS(&quot;headers&quot;);å‚æ•°åŒ¹é…</span></span><br><span class="line"><span class="comment">     3.durableï¼šæ˜¯å¦æŒä¹…åŒ–</span></span><br><span class="line"><span class="comment">     4.autoDeleteï¼šæ˜¯å¦è‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">     5.internalï¼šå†…éƒ¨ä½¿ç”¨ã€‚ä¸€èˆ¬false</span></span><br><span class="line"><span class="comment">     6.arguments:å‚æ•°</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">exchangeName</span> <span class="operator">=</span> <span class="string">&quot;test_direct&quot;</span>;</span><br><span class="line">    channel.exchangeDeclare(exchangeName, BuiltinExchangeType.DIRECT, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">    <span class="comment">//6.åˆ›å»ºé˜Ÿåˆ—</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">queue1Name</span> <span class="operator">=</span> <span class="string">&quot;test_direct_queue1&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">queue2Name</span> <span class="operator">=</span> <span class="string">&quot;test_direct_queue2&quot;</span>;</span><br><span class="line">    channel.queueDeclare(queue1Name, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">    channel.queueDeclare(queue2Name, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">    <span class="comment">//7.ç»‘å®šé˜Ÿåˆ—å’Œäº¤æ¢æœº</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * queueBind(String queue, String exchange, String routingKey)</span></span><br><span class="line"><span class="comment">    * 1.queueï¼šé˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">    * 2.exchangeï¼šäº¤æ¢æœºåç§°</span></span><br><span class="line"><span class="comment">    * 3.routingKeyï¼šè·¯ç”±é”®ï¼Œç»‘å®šè§„åˆ™     å¦‚æœäº¤æ¢æœºçš„ç±»å‹ä¸ºfanout,routingKeyè®¾ç½®ä¸º&quot;&quot;</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="comment">//é˜Ÿåˆ—1çš„ç»‘å®šerror</span></span><br><span class="line">    channel.queueBind(queue1Name, exchangeName, <span class="string">&quot;error&quot;</span>);</span><br><span class="line">    <span class="comment">//é˜Ÿåˆ—2çš„ç»‘å®šinfo error warning</span></span><br><span class="line">    channel.queueBind(queue2Name, exchangeName, <span class="string">&quot;info&quot;</span>);</span><br><span class="line">    channel.queueBind(queue2Name, exchangeName, <span class="string">&quot;error&quot;</span>);</span><br><span class="line">    channel.queueBind(queue2Name, exchangeName, <span class="string">&quot;warning&quot;</span>);</span><br><span class="line">    <span class="comment">//8.å‘é€æ¶ˆæ¯</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">body</span> <span class="operator">=</span> <span class="string">&quot;æ—¥å¿—ä¿¡æ¯ï¼šå¼ ä¸‰è°ƒç”¨äº†deleteæ–¹æ³•...å‡ºé”™äº†...æ—¥å¿—çº§åˆ«ï¼šerror...&quot;</span>;</span><br><span class="line">    channel.basicPublish(exchangeName, <span class="string">&quot;error&quot;</span>, <span class="literal">null</span>, body.getBytes());</span><br><span class="line">    <span class="comment">//9.é‡Šæ”¾èµ„æº</span></span><br><span class="line">    channel.close();</span><br><span class="line">    connection.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¶ˆè´¹è€…1</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">    <span class="comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span></span><br><span class="line">    <span class="type">ConnectionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConnectionFactory</span>();</span><br><span class="line">    <span class="comment">//2.è®¾ç½®å‚æ•°</span></span><br><span class="line">    factory.setHost(<span class="string">&quot;192.168.184.100&quot;</span>);<span class="comment">//ip é»˜è®¤å€¼ localhost</span></span><br><span class="line">    factory.setPort(<span class="number">5672</span>);<span class="comment">//ç«¯å£ é»˜è®¤å€¼5672</span></span><br><span class="line">    factory.setVirtualHost(<span class="string">&quot;/itcast&quot;</span>);<span class="comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span></span><br><span class="line">    factory.setUsername(<span class="string">&quot;dong&quot;</span>);<span class="comment">//ç”¨æˆ·å é»˜è®¤ guest</span></span><br><span class="line">    factory.setPassword(<span class="string">&quot;dong&quot;</span>);<span class="comment">//å¯†ç  é»˜è®¤ guest</span></span><br><span class="line">    <span class="comment">//3.åˆ›å»ºè¿æ¥ Connection</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> factory.newConnection();</span><br><span class="line">    <span class="comment">//4.åˆ›å»ºChannel</span></span><br><span class="line">    <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5.åˆ›å»ºé˜Ÿåˆ—Queue</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * queueDeclare(String queue, boolean durable, boolean exclusive, boolean autoDelete, Map&lt;String, Object&gt; arguments)</span></span><br><span class="line"><span class="comment">     * 1.queueï¼š é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">     * 2.durableï¼š æ˜¯å¦æŒä¹…åŒ–ï¼Œå½“mqé‡å¯åï¼Œè¿˜åœ¨</span></span><br><span class="line"><span class="comment">     * 3.exclusiveï¼š</span></span><br><span class="line"><span class="comment">     *   æ˜¯å¦ç‹¬å ï¼Œåªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…èƒ½å¤Ÿç›‘å¬è¿™ä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     *   å½“Connectionå…³é—­æ—¶ï¼Œæ˜¯å¦åˆ é™¤é˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     * 4.autoDeleteï¼š æ˜¯å¦è‡ªåŠ¨åˆ é™¤ã€‚å½“æ²¡æœ‰Consumeræ—¶ï¼Œè‡ªåŠ¨åˆ é™¤æ‰</span></span><br><span class="line"><span class="comment">     * 5.argumentsï¼š å‚æ•°</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="comment">//å¦‚æœæ²¡æœ‰ä¸€ä¸ªå«hello_worldçš„é˜Ÿåˆ—ï¼Œåˆ™åˆ›å»ºè¯¥é˜Ÿåˆ—ï¼Œå¦‚æœæœ‰è¯¥é˜Ÿåˆ—ï¼Œåˆ™ä¸åˆ›å»º</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">queue1Name</span> <span class="operator">=</span> <span class="string">&quot;test_direct_queue1&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">queue2Name</span> <span class="operator">=</span> <span class="string">&quot;test_direct_queue2&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//6.æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * basicConsume(String queue, boolean autoAck, Consumer callback)</span></span><br><span class="line"><span class="comment">    * 1.queue: é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">    * 2.autoAckï¼š æ˜¯å¦è‡ªåŠ¨ç¡®è®¤</span></span><br><span class="line"><span class="comment">    * 3.callbackï¼š å›è°ƒå¯¹è±¡</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="type">Consumer</span> <span class="variable">consumer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultConsumer</span>(channel)&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * å›è°ƒæ–¹æ³•ï¼Œå½“æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œè¯¥æ–¹æ³•</span></span><br><span class="line"><span class="comment">        *</span></span><br><span class="line"><span class="comment">        * 1.consumerTagï¼š æ ‡è¯†</span></span><br><span class="line"><span class="comment">        * 2.envelopeï¼š è·å–ä¸€äº›ä¿¡æ¯ï¼Œäº¤æ¢æœºï¼Œè·¯ç”±key...</span></span><br><span class="line"><span class="comment">        * 3.properties: é…ç½®ä¿¡æ¯</span></span><br><span class="line"><span class="comment">        * 4.bodyï¼š æ•°æ®</span></span><br><span class="line"><span class="comment">        * */</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleDelivery</span><span class="params">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class="type">byte</span>[] body)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">            <span class="comment">/*System.out.println(&quot;consumerTagï¼š&quot; + consumerTag);</span></span><br><span class="line"><span class="comment">            System.out.println(&quot;Exchangeï¼š&quot; + envelope.getExchange());</span></span><br><span class="line"><span class="comment">            System.out.println(&quot;RoutingKeyï¼š&quot; + envelope.getRoutingKey());</span></span><br><span class="line"><span class="comment">            System.out.println(&quot;propertiesï¼š&quot; + properties);*/</span></span><br><span class="line">            System.out.println(<span class="string">&quot;body:&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(body));</span><br><span class="line">            System.out.println(<span class="string">&quot;å°†æ—¥å¿—ä¿¡æ¯å­˜å‚¨åœ¨æ•°æ®åº“....&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    channel.basicConsume(queue1Name, <span class="literal">true</span>, consumer);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å…³é—­èµ„æºï¼Ÿæ¶ˆè´¹è€…æ˜¯ç›‘å¬ç¨‹åºï¼Œä¸éœ€è¦å…³é—­</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¶ˆè´¹è€…2</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">    <span class="comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span></span><br><span class="line">    <span class="type">ConnectionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConnectionFactory</span>();</span><br><span class="line">    <span class="comment">//2.è®¾ç½®å‚æ•°</span></span><br><span class="line">    factory.setHost(<span class="string">&quot;192.168.184.100&quot;</span>);<span class="comment">//ip é»˜è®¤å€¼ localhost</span></span><br><span class="line">    factory.setPort(<span class="number">5672</span>);<span class="comment">//ç«¯å£ é»˜è®¤å€¼5672</span></span><br><span class="line">    factory.setVirtualHost(<span class="string">&quot;/itcast&quot;</span>);<span class="comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span></span><br><span class="line">    factory.setUsername(<span class="string">&quot;dong&quot;</span>);<span class="comment">//ç”¨æˆ·å é»˜è®¤ guest</span></span><br><span class="line">    factory.setPassword(<span class="string">&quot;dong&quot;</span>);<span class="comment">//å¯†ç  é»˜è®¤ guest</span></span><br><span class="line">    <span class="comment">//3.åˆ›å»ºè¿æ¥ Connection</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> factory.newConnection();</span><br><span class="line">    <span class="comment">//4.åˆ›å»ºChannel</span></span><br><span class="line">    <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5.åˆ›å»ºé˜Ÿåˆ—Queue</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * queueDeclare(String queue, boolean durable, boolean exclusive, boolean autoDelete, Map&lt;String, Object&gt; arguments)</span></span><br><span class="line"><span class="comment">     * 1.queueï¼š é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">     * 2.durableï¼š æ˜¯å¦æŒä¹…åŒ–ï¼Œå½“mqé‡å¯åï¼Œè¿˜åœ¨</span></span><br><span class="line"><span class="comment">     * 3.exclusiveï¼š</span></span><br><span class="line"><span class="comment">     *   æ˜¯å¦ç‹¬å ï¼Œåªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…èƒ½å¤Ÿç›‘å¬è¿™ä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     *   å½“Connectionå…³é—­æ—¶ï¼Œæ˜¯å¦åˆ é™¤é˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     * 4.autoDeleteï¼š æ˜¯å¦è‡ªåŠ¨åˆ é™¤ã€‚å½“æ²¡æœ‰Consumeræ—¶ï¼Œè‡ªåŠ¨åˆ é™¤æ‰</span></span><br><span class="line"><span class="comment">     * 5.argumentsï¼š å‚æ•°</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="comment">//å¦‚æœæ²¡æœ‰ä¸€ä¸ªå«hello_worldçš„é˜Ÿåˆ—ï¼Œåˆ™åˆ›å»ºè¯¥é˜Ÿåˆ—ï¼Œå¦‚æœæœ‰è¯¥é˜Ÿåˆ—ï¼Œåˆ™ä¸åˆ›å»º</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">queue1Name</span> <span class="operator">=</span> <span class="string">&quot;test_direct_queue1&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">queue2Name</span> <span class="operator">=</span> <span class="string">&quot;test_direct_queue2&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//6.æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * basicConsume(String queue, boolean autoAck, Consumer callback)</span></span><br><span class="line"><span class="comment">    * 1.queue: é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">    * 2.autoAckï¼š æ˜¯å¦è‡ªåŠ¨ç¡®è®¤</span></span><br><span class="line"><span class="comment">    * 3.callbackï¼š å›è°ƒå¯¹è±¡</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="type">Consumer</span> <span class="variable">consumer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultConsumer</span>(channel)&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * å›è°ƒæ–¹æ³•ï¼Œå½“æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œè¯¥æ–¹æ³•</span></span><br><span class="line"><span class="comment">        *</span></span><br><span class="line"><span class="comment">        * 1.consumerTagï¼š æ ‡è¯†</span></span><br><span class="line"><span class="comment">        * 2.envelopeï¼š è·å–ä¸€äº›ä¿¡æ¯ï¼Œäº¤æ¢æœºï¼Œè·¯ç”±key...</span></span><br><span class="line"><span class="comment">        * 3.properties: é…ç½®ä¿¡æ¯</span></span><br><span class="line"><span class="comment">        * 4.bodyï¼š æ•°æ®</span></span><br><span class="line"><span class="comment">        * */</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleDelivery</span><span class="params">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class="type">byte</span>[] body)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">            <span class="comment">/*System.out.println(&quot;consumerTagï¼š&quot; + consumerTag);</span></span><br><span class="line"><span class="comment">            System.out.println(&quot;Exchangeï¼š&quot; + envelope.getExchange());</span></span><br><span class="line"><span class="comment">            System.out.println(&quot;RoutingKeyï¼š&quot; + envelope.getRoutingKey());</span></span><br><span class="line"><span class="comment">            System.out.println(&quot;propertiesï¼š&quot; + properties);*/</span></span><br><span class="line">            System.out.println(<span class="string">&quot;body:&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(body));</span><br><span class="line">            System.out.println(<span class="string">&quot;å°†æ—¥å¿—ä¿¡æ¯æ‰“å°åˆ°æ§åˆ¶å°....&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    channel.basicConsume(queue2Name, <span class="literal">true</span>, consumer);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å…³é—­èµ„æºï¼Ÿæ¶ˆè´¹è€…æ˜¯ç›‘å¬ç¨‹åºï¼Œä¸éœ€è¦å…³é—­</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Routing</strong> æ¨¡å¼è¦æ±‚é˜Ÿåˆ—åœ¨ç»‘å®šäº¤æ¢æœºæ—¶è¦æŒ‡å®š <strong>routing key</strong>ï¼Œæ¶ˆæ¯ä¼šè½¬å‘åˆ°ç¬¦åˆ routing key çš„é˜Ÿåˆ—ã€‚</p><h3 id="Topicsé€šé…ç¬¦æ¨¡å¼"><a href="#Topicsé€šé…ç¬¦æ¨¡å¼" class="headerlink" title="Topicsé€šé…ç¬¦æ¨¡å¼"></a>Topicsé€šé…ç¬¦æ¨¡å¼</h3><ul><li><p>Topic ç±»å‹ä¸ Direct ç›¸æ¯”ï¼Œéƒ½æ˜¯å¯ä»¥æ ¹æ® RoutingKey æŠŠæ¶ˆæ¯è·¯ç”±åˆ°ä¸åŒçš„é˜Ÿåˆ—ã€‚åªä¸è¿‡ Topic ç±»å‹Exchange å¯ä»¥è®©é˜Ÿåˆ—åœ¨ç»‘å®š Routing key çš„æ—¶å€™ä½¿ç”¨<strong>é€šé…ç¬¦</strong>ï¼</p></li><li><p>Routingkey ä¸€èˆ¬éƒ½æ˜¯æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå•è¯ç»„æˆï¼Œå¤šä¸ªå•è¯ä¹‹é—´ä»¥â€.â€åˆ†å‰²ï¼Œä¾‹å¦‚ï¼š item.insert </p></li><li><p>é€šé…ç¬¦è§„åˆ™ï¼š# åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªè¯ï¼Œ* åŒ¹é…ä¸å¤šä¸å°‘æ°å¥½1ä¸ªè¯ï¼Œä¾‹å¦‚ï¼šitem.# èƒ½å¤ŸåŒ¹é… item.insert.abc æˆ–è€… item.insertï¼Œitem.* åªèƒ½åŒ¹é… item.insert</p></li></ul><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171106259.png" alt="image-20221017110625191"></p><ul><li><p>çº¢è‰² Queueï¼šç»‘å®šçš„æ˜¯ usa.# ï¼Œå› æ­¤å‡¡æ˜¯ä»¥ usa. å¼€å¤´çš„ routing key éƒ½ä¼šè¢«åŒ¹é…åˆ°</p></li><li><p>é»„è‰² Queueï¼šç»‘å®šçš„æ˜¯ #.news ï¼Œå› æ­¤å‡¡æ˜¯ä»¥ .news ç»“å°¾çš„ routing key éƒ½ä¼šè¢«åŒ¹é…</p></li></ul><p>ç”Ÿäº§è€…ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">    <span class="comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span></span><br><span class="line">    <span class="type">ConnectionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConnectionFactory</span>();</span><br><span class="line">    <span class="comment">//2.è®¾ç½®å‚æ•°</span></span><br><span class="line">    factory.setHost(<span class="string">&quot;192.168.184.100&quot;</span>);<span class="comment">//ip é»˜è®¤å€¼ localhost</span></span><br><span class="line">    factory.setPort(<span class="number">5672</span>);<span class="comment">//ç«¯å£ é»˜è®¤å€¼5672</span></span><br><span class="line">    factory.setVirtualHost(<span class="string">&quot;/itcast&quot;</span>);<span class="comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span></span><br><span class="line">    factory.setUsername(<span class="string">&quot;dong&quot;</span>);<span class="comment">//ç”¨æˆ·å é»˜è®¤ guest</span></span><br><span class="line">    factory.setPassword(<span class="string">&quot;dong&quot;</span>);<span class="comment">//å¯†ç  é»˜è®¤ guest</span></span><br><span class="line">    <span class="comment">//3.åˆ›å»ºè¿æ¥ Connection</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> factory.newConnection();</span><br><span class="line">    <span class="comment">//4.åˆ›å»ºChannel</span></span><br><span class="line">    <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5.åˆ›å»ºäº¤æ¢æœº</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * exchangeDeclare(String exchange, BuiltinExchangeType type, boolean durable, boolean autoDelete, boolean internal, Map&lt;String, Object&gt; arguments)</span></span><br><span class="line"><span class="comment">    * 1.exchange:äº¤æ¢æœºåç§°</span></span><br><span class="line"><span class="comment">    * 2.typeï¼šäº¤æ¢æœºç±»å‹</span></span><br><span class="line"><span class="comment">    *   DIRECT(&quot;direct&quot;),å®šå‘</span></span><br><span class="line"><span class="comment">        FANOUT(&quot;fanout&quot;),æ‰‡å½¢ï¼ˆå¹¿æ’­ï¼‰ï¼Œå‘é€æ¶ˆæ¯åˆ°æ¯ä¸€ä¸ªä¸ä¹‹ç»‘å®šçš„é˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">        TOPIC(&quot;topic&quot;),é€šé…ç¬¦çš„æ–¹å¼</span></span><br><span class="line"><span class="comment">        HEADERS(&quot;headers&quot;);å‚æ•°åŒ¹é…</span></span><br><span class="line"><span class="comment">     3.durableï¼šæ˜¯å¦æŒä¹…åŒ–</span></span><br><span class="line"><span class="comment">     4.autoDeleteï¼šæ˜¯å¦è‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="comment">     5.internalï¼šå†…éƒ¨ä½¿ç”¨ã€‚ä¸€èˆ¬false</span></span><br><span class="line"><span class="comment">     6.arguments:å‚æ•°</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">exchangeName</span> <span class="operator">=</span> <span class="string">&quot;test_topic&quot;</span>;</span><br><span class="line">    channel.exchangeDeclare(exchangeName, BuiltinExchangeType.TOPIC, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">    <span class="comment">//6.åˆ›å»ºé˜Ÿåˆ—</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">queue1Name</span> <span class="operator">=</span> <span class="string">&quot;test_topic_queue1&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">queue2Name</span> <span class="operator">=</span> <span class="string">&quot;test_topic_queue2&quot;</span>;</span><br><span class="line">    channel.queueDeclare(queue1Name, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">    channel.queueDeclare(queue2Name, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">null</span>);</span><br><span class="line">    <span class="comment">//7.ç»‘å®šé˜Ÿåˆ—å’Œäº¤æ¢æœº</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * queueBind(String queue, String exchange, String routingKey)</span></span><br><span class="line"><span class="comment">    * 1.queueï¼šé˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">    * 2.exchangeï¼šäº¤æ¢æœºåç§°</span></span><br><span class="line"><span class="comment">    * 3.routingKeyï¼šè·¯ç”±é”®ï¼Œç»‘å®šè§„åˆ™     å¦‚æœäº¤æ¢æœºçš„ç±»å‹ä¸ºfanout,routingKeyè®¾ç½®ä¸º&quot;&quot;</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="comment">//routing key ç³»ç»Ÿçš„åç§° æ—¥å¿—çš„çº§åˆ«</span></span><br><span class="line">    <span class="comment">//éœ€æ±‚ï¼šæ‰€æœ‰errorçº§åˆ«çš„æ—¥å¿—å­˜åœ¨æ•°æ®åº“ï¼Œæ‰€æœ‰orderç³»ç»Ÿçš„æ—¥å¿—å­˜åœ¨æ•°æ®åº“</span></span><br><span class="line">    channel.queueBind(queue1Name, exchangeName, <span class="string">&quot;#.error&quot;</span>);</span><br><span class="line">    channel.queueBind(queue1Name, exchangeName, <span class="string">&quot;order.*&quot;</span>);</span><br><span class="line">    channel.queueBind(queue2Name, exchangeName, <span class="string">&quot;*.*&quot;</span>);</span><br><span class="line">    <span class="comment">//8.å‘é€æ¶ˆæ¯</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">body</span> <span class="operator">=</span> <span class="string">&quot;æ—¥å¿—ä¿¡æ¯ï¼šå¼ ä¸‰è°ƒç”¨äº†finaAllæ–¹æ³•...æ—¥å¿—çº§åˆ«ï¼šinfo...&quot;</span>;</span><br><span class="line">    channel.basicPublish(exchangeName, <span class="string">&quot;.error&quot;</span>, <span class="literal">null</span>, body.getBytes());</span><br><span class="line">    <span class="comment">//9.é‡Šæ”¾èµ„æº</span></span><br><span class="line">    channel.close();</span><br><span class="line">    connection.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¶ˆè´¹è€…1ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">    <span class="comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span></span><br><span class="line">    <span class="type">ConnectionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConnectionFactory</span>();</span><br><span class="line">    <span class="comment">//2.è®¾ç½®å‚æ•°</span></span><br><span class="line">    factory.setHost(<span class="string">&quot;192.168.184.100&quot;</span>);<span class="comment">//ip é»˜è®¤å€¼ localhost</span></span><br><span class="line">    factory.setPort(<span class="number">5672</span>);<span class="comment">//ç«¯å£ é»˜è®¤å€¼5672</span></span><br><span class="line">    factory.setVirtualHost(<span class="string">&quot;/itcast&quot;</span>);<span class="comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span></span><br><span class="line">    factory.setUsername(<span class="string">&quot;dong&quot;</span>);<span class="comment">//ç”¨æˆ·å é»˜è®¤ guest</span></span><br><span class="line">    factory.setPassword(<span class="string">&quot;dong&quot;</span>);<span class="comment">//å¯†ç  é»˜è®¤ guest</span></span><br><span class="line">    <span class="comment">//3.åˆ›å»ºè¿æ¥ Connection</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> factory.newConnection();</span><br><span class="line">    <span class="comment">//4.åˆ›å»ºChannel</span></span><br><span class="line">    <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5.åˆ›å»ºé˜Ÿåˆ—Queue</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * queueDeclare(String queue, boolean durable, boolean exclusive, boolean autoDelete, Map&lt;String, Object&gt; arguments)</span></span><br><span class="line"><span class="comment">     * 1.queueï¼š é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">     * 2.durableï¼š æ˜¯å¦æŒä¹…åŒ–ï¼Œå½“mqé‡å¯åï¼Œè¿˜åœ¨</span></span><br><span class="line"><span class="comment">     * 3.exclusiveï¼š</span></span><br><span class="line"><span class="comment">     *   æ˜¯å¦ç‹¬å ï¼Œåªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…èƒ½å¤Ÿç›‘å¬è¿™ä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     *   å½“Connectionå…³é—­æ—¶ï¼Œæ˜¯å¦åˆ é™¤é˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     * 4.autoDeleteï¼š æ˜¯å¦è‡ªåŠ¨åˆ é™¤ã€‚å½“æ²¡æœ‰Consumeræ—¶ï¼Œè‡ªåŠ¨åˆ é™¤æ‰</span></span><br><span class="line"><span class="comment">     * 5.argumentsï¼š å‚æ•°</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="comment">//å¦‚æœæ²¡æœ‰ä¸€ä¸ªå«hello_worldçš„é˜Ÿåˆ—ï¼Œåˆ™åˆ›å»ºè¯¥é˜Ÿåˆ—ï¼Œå¦‚æœæœ‰è¯¥é˜Ÿåˆ—ï¼Œåˆ™ä¸åˆ›å»º</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">queue1Name</span> <span class="operator">=</span> <span class="string">&quot;test_topic_queue1&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">queue2Name</span> <span class="operator">=</span> <span class="string">&quot;test_topic_queue2&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//6.æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * basicConsume(String queue, boolean autoAck, Consumer callback)</span></span><br><span class="line"><span class="comment">    * 1.queue: é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">    * 2.autoAckï¼š æ˜¯å¦è‡ªåŠ¨ç¡®è®¤</span></span><br><span class="line"><span class="comment">    * 3.callbackï¼š å›è°ƒå¯¹è±¡</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="type">Consumer</span> <span class="variable">consumer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultConsumer</span>(channel)&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * å›è°ƒæ–¹æ³•ï¼Œå½“æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œè¯¥æ–¹æ³•</span></span><br><span class="line"><span class="comment">        *</span></span><br><span class="line"><span class="comment">        * 1.consumerTagï¼š æ ‡è¯†</span></span><br><span class="line"><span class="comment">        * 2.envelopeï¼š è·å–ä¸€äº›ä¿¡æ¯ï¼Œäº¤æ¢æœºï¼Œè·¯ç”±key...</span></span><br><span class="line"><span class="comment">        * 3.properties: é…ç½®ä¿¡æ¯</span></span><br><span class="line"><span class="comment">        * 4.bodyï¼š æ•°æ®</span></span><br><span class="line"><span class="comment">        * */</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleDelivery</span><span class="params">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class="type">byte</span>[] body)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">            <span class="comment">/*System.out.println(&quot;consumerTagï¼š&quot; + consumerTag);</span></span><br><span class="line"><span class="comment">            System.out.println(&quot;Exchangeï¼š&quot; + envelope.getExchange());</span></span><br><span class="line"><span class="comment">            System.out.println(&quot;RoutingKeyï¼š&quot; + envelope.getRoutingKey());</span></span><br><span class="line"><span class="comment">            System.out.println(&quot;propertiesï¼š&quot; + properties);*/</span></span><br><span class="line">            System.out.println(<span class="string">&quot;body:&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(body));</span><br><span class="line">            System.out.println(<span class="string">&quot;å°†æ—¥å¿—ä¿¡æ¯å­˜å…¥æ•°æ®åº“....&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    channel.basicConsume(queue1Name, <span class="literal">true</span>, consumer);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å…³é—­èµ„æºï¼Ÿæ¶ˆè´¹è€…æ˜¯ç›‘å¬ç¨‹åºï¼Œä¸éœ€è¦å…³é—­</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¶ˆè´¹è€…2ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, TimeoutException &#123;</span><br><span class="line">    <span class="comment">//1.åˆ›å»ºè¿æ¥å·¥å‚</span></span><br><span class="line">    <span class="type">ConnectionFactory</span> <span class="variable">factory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ConnectionFactory</span>();</span><br><span class="line">    <span class="comment">//2.è®¾ç½®å‚æ•°</span></span><br><span class="line">    factory.setHost(<span class="string">&quot;192.168.184.100&quot;</span>);<span class="comment">//ip é»˜è®¤å€¼ localhost</span></span><br><span class="line">    factory.setPort(<span class="number">5672</span>);<span class="comment">//ç«¯å£ é»˜è®¤å€¼5672</span></span><br><span class="line">    factory.setVirtualHost(<span class="string">&quot;/itcast&quot;</span>);<span class="comment">//è™šæ‹Ÿæœº é»˜è®¤å€¼/</span></span><br><span class="line">    factory.setUsername(<span class="string">&quot;dong&quot;</span>);<span class="comment">//ç”¨æˆ·å é»˜è®¤ guest</span></span><br><span class="line">    factory.setPassword(<span class="string">&quot;dong&quot;</span>);<span class="comment">//å¯†ç  é»˜è®¤ guest</span></span><br><span class="line">    <span class="comment">//3.åˆ›å»ºè¿æ¥ Connection</span></span><br><span class="line">    <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> factory.newConnection();</span><br><span class="line">    <span class="comment">//4.åˆ›å»ºChannel</span></span><br><span class="line">    <span class="type">Channel</span> <span class="variable">channel</span> <span class="operator">=</span> connection.createChannel();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5.åˆ›å»ºé˜Ÿåˆ—Queue</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * queueDeclare(String queue, boolean durable, boolean exclusive, boolean autoDelete, Map&lt;String, Object&gt; arguments)</span></span><br><span class="line"><span class="comment">     * 1.queueï¼š é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">     * 2.durableï¼š æ˜¯å¦æŒä¹…åŒ–ï¼Œå½“mqé‡å¯åï¼Œè¿˜åœ¨</span></span><br><span class="line"><span class="comment">     * 3.exclusiveï¼š</span></span><br><span class="line"><span class="comment">     *   æ˜¯å¦ç‹¬å ï¼Œåªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…èƒ½å¤Ÿç›‘å¬è¿™ä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     *   å½“Connectionå…³é—­æ—¶ï¼Œæ˜¯å¦åˆ é™¤é˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">     * 4.autoDeleteï¼š æ˜¯å¦è‡ªåŠ¨åˆ é™¤ã€‚å½“æ²¡æœ‰Consumeræ—¶ï¼Œè‡ªåŠ¨åˆ é™¤æ‰</span></span><br><span class="line"><span class="comment">     * 5.argumentsï¼š å‚æ•°</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="comment">//å¦‚æœæ²¡æœ‰ä¸€ä¸ªå«hello_worldçš„é˜Ÿåˆ—ï¼Œåˆ™åˆ›å»ºè¯¥é˜Ÿåˆ—ï¼Œå¦‚æœæœ‰è¯¥é˜Ÿåˆ—ï¼Œåˆ™ä¸åˆ›å»º</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">queue1Name</span> <span class="operator">=</span> <span class="string">&quot;test_topic_queue1&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">queue2Name</span> <span class="operator">=</span> <span class="string">&quot;test_topic_queue2&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//6.æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * basicConsume(String queue, boolean autoAck, Consumer callback)</span></span><br><span class="line"><span class="comment">    * 1.queue: é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="comment">    * 2.autoAckï¼š æ˜¯å¦è‡ªåŠ¨ç¡®è®¤</span></span><br><span class="line"><span class="comment">    * 3.callbackï¼š å›è°ƒå¯¹è±¡</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="type">Consumer</span> <span class="variable">consumer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultConsumer</span>(channel)&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        * å›è°ƒæ–¹æ³•ï¼Œå½“æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œè¯¥æ–¹æ³•</span></span><br><span class="line"><span class="comment">        *</span></span><br><span class="line"><span class="comment">        * 1.consumerTagï¼š æ ‡è¯†</span></span><br><span class="line"><span class="comment">        * 2.envelopeï¼š è·å–ä¸€äº›ä¿¡æ¯ï¼Œäº¤æ¢æœºï¼Œè·¯ç”±key...</span></span><br><span class="line"><span class="comment">        * 3.properties: é…ç½®ä¿¡æ¯</span></span><br><span class="line"><span class="comment">        * 4.bodyï¼š æ•°æ®</span></span><br><span class="line"><span class="comment">        * */</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleDelivery</span><span class="params">(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, <span class="type">byte</span>[] body)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">            <span class="comment">/*System.out.println(&quot;consumerTagï¼š&quot; + consumerTag);</span></span><br><span class="line"><span class="comment">            System.out.println(&quot;Exchangeï¼š&quot; + envelope.getExchange());</span></span><br><span class="line"><span class="comment">            System.out.println(&quot;RoutingKeyï¼š&quot; + envelope.getRoutingKey());</span></span><br><span class="line"><span class="comment">            System.out.println(&quot;propertiesï¼š&quot; + properties);*/</span></span><br><span class="line">            System.out.println(<span class="string">&quot;body:&quot;</span> + <span class="keyword">new</span> <span class="title class_">String</span>(body));</span><br><span class="line">            System.out.println(<span class="string">&quot;å°†æ—¥å¿—ä¿¡æ¯æ‰“å°æ§åˆ¶å°....&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    channel.basicConsume(queue2Name, <span class="literal">true</span>, consumer);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å…³é—­èµ„æºï¼Ÿæ¶ˆè´¹è€…æ˜¯ç›‘å¬ç¨‹åºï¼Œä¸éœ€è¦å…³é—­</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å°ç»“</strong></p><p>Topic ä¸»é¢˜æ¨¡å¼å¯ä»¥å®ç° Pub&#x2F;Sub å‘å¸ƒä¸è®¢é˜…æ¨¡å¼å’Œ Routing è·¯ç”±æ¨¡å¼çš„åŠŸèƒ½ï¼Œåªæ˜¯ Topic åœ¨é…ç½®routing key çš„æ—¶å€™å¯ä»¥ä½¿ç”¨é€šé…ç¬¦ï¼Œæ˜¾å¾—æ›´åŠ çµæ´»ã€‚</p><h3 id="å·¥ä½œæ¨¡å¼æ€»ç»“"><a href="#å·¥ä½œæ¨¡å¼æ€»ç»“" class="headerlink" title="å·¥ä½œæ¨¡å¼æ€»ç»“"></a>å·¥ä½œæ¨¡å¼æ€»ç»“</h3><ol><li>ç®€å•æ¨¡å¼ HelloWorld</li></ol><p>ä¸€ä¸ªç”Ÿäº§è€…ã€ä¸€ä¸ªæ¶ˆè´¹è€…ï¼Œä¸éœ€è¦è®¾ç½®äº¤æ¢æœºï¼ˆä½¿ç”¨é»˜è®¤çš„äº¤æ¢æœºï¼‰ã€‚</p><ol start="2"><li>å·¥ä½œé˜Ÿåˆ—æ¨¡å¼ Work Queue</li></ol><p>ä¸€ä¸ªç”Ÿäº§è€…ã€å¤šä¸ªæ¶ˆè´¹è€…ï¼ˆç«äº‰å…³ç³»ï¼‰ï¼Œä¸éœ€è¦è®¾ç½®äº¤æ¢æœºï¼ˆä½¿ç”¨é»˜è®¤çš„äº¤æ¢æœºï¼‰ã€‚</p><ol start="3"><li>å‘å¸ƒè®¢é˜…æ¨¡å¼ Publish&#x2F;subscribe</li></ol><p>éœ€è¦è®¾ç½®ç±»å‹ä¸º fanout çš„äº¤æ¢æœºï¼Œå¹¶ä¸”äº¤æ¢æœºå’Œé˜Ÿåˆ—è¿›è¡Œç»‘å®šï¼Œå½“å‘é€æ¶ˆæ¯åˆ°äº¤æ¢æœºåï¼Œäº¤æ¢æœºä¼šå°†æ¶ˆæ¯å‘é€åˆ°ç»‘å®šçš„é˜Ÿåˆ—ã€‚</p><ol start="4"><li>è·¯ç”±æ¨¡å¼ Routing</li></ol><p>éœ€è¦è®¾ç½®ç±»å‹ä¸º direct çš„äº¤æ¢æœºï¼Œäº¤æ¢æœºå’Œé˜Ÿåˆ—è¿›è¡Œç»‘å®šï¼Œå¹¶ä¸”æŒ‡å®š routing keyï¼Œå½“å‘é€æ¶ˆæ¯åˆ°äº¤æ¢æœº</p><p>åï¼Œäº¤æ¢æœºä¼šæ ¹æ® routing key å°†æ¶ˆæ¯å‘é€åˆ°å¯¹åº”çš„é˜Ÿåˆ—ã€‚</p><ol start="5"><li>é€šé…ç¬¦æ¨¡å¼ Topic</li></ol><p>éœ€è¦è®¾ç½®ç±»å‹ä¸º topic çš„äº¤æ¢æœºï¼Œäº¤æ¢æœºå’Œé˜Ÿåˆ—è¿›è¡Œç»‘å®šï¼Œå¹¶ä¸”æŒ‡å®šé€šé…ç¬¦æ–¹å¼çš„ routing keyï¼Œå½“å‘é€</p><p>æ¶ˆæ¯åˆ°äº¤æ¢æœºåï¼Œäº¤æ¢æœºä¼šæ ¹æ® routing key å°†æ¶ˆæ¯å‘é€åˆ°å¯¹åº”çš„é˜Ÿåˆ—ã€‚</p><h2 id="Spring-Bootæ•´åˆRabbit-MQ"><a href="#Spring-Bootæ•´åˆRabbit-MQ" class="headerlink" title="Spring Bootæ•´åˆRabbit MQ"></a>Spring Bootæ•´åˆRabbit MQ</h2><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171110248.png" alt="image-20221017111012195"></p><h3 id="åˆ›å»ºBootå·¥ç¨‹"><a href="#åˆ›å»ºBootå·¥ç¨‹" class="headerlink" title="åˆ›å»ºBootå·¥ç¨‹"></a>åˆ›å»ºBootå·¥ç¨‹</h3><h3 id="æ·»åŠ ä¾èµ–"><a href="#æ·»åŠ ä¾èµ–" class="headerlink" title="æ·»åŠ ä¾èµ–"></a>æ·»åŠ ä¾èµ–</h3><p>éœ€è¦çš„ä¾èµ–æ˜¯springbootæ•´åˆrabbitmq, spring-boot-starter-amqpæ˜¯springbootæ•´åˆrabbitmqçš„åŒ…ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="é…ç½®Rabbit-MQçš„åŸºæœ¬ä¿¡æ¯"><a href="#é…ç½®Rabbit-MQçš„åŸºæœ¬ä¿¡æ¯" class="headerlink" title="é…ç½®Rabbit MQçš„åŸºæœ¬ä¿¡æ¯"></a>é…ç½®Rabbit MQçš„åŸºæœ¬ä¿¡æ¯</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="number">192.168</span><span class="number">.184</span><span class="number">.100</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">dong</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">dong</span></span><br><span class="line">    <span class="attr">virtual-host:</span> <span class="string">/itcast</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">5672</span></span><br></pre></td></tr></table></figure><h3 id="ç¼–å†™ä»£ç "><a href="#ç¼–å†™ä»£ç " class="headerlink" title="ç¼–å†™ä»£ç "></a>ç¼–å†™ä»£ç </h3><p>ç”Ÿäº§è€…ç¼–å†™ä»£ç å‘é€ä¿¡æ¯ã€‚</p><p>ç”Ÿäº§è€…ç¼–å†™Rabbit MQçš„é…ç½®ä¿¡æ¯ã€‚é…ç½®äº¤æ¢æœºã€é˜Ÿåˆ—ä»¥åŠé˜Ÿåˆ—å’Œäº¤æ¢æœºçš„ç»‘å®šã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RabbitMQConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;boot_topic_exchange&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;boot_queue&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.äº¤æ¢æœº</span></span><br><span class="line">    <span class="meta">@Bean(&quot;bootExchange&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Exchange <span class="title function_">bootExchange</span><span class="params">()</span>&#123;</span><br><span class="line">       <span class="keyword">return</span> ExchangeBuilder.topicExchange(EXCHANGE_NAME).durable(<span class="literal">true</span>).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.é˜Ÿåˆ—</span></span><br><span class="line">    <span class="meta">@Bean(&quot;bootQueue&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">bootQueue</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> QueueBuilder.durable(QUEUE_NAME).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.é˜Ÿåˆ—äº¤æ¢æœºç»‘å®šå…³ç³» Binding</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * 1.çŸ¥é“é‚£ä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">    * 2.çŸ¥é“é‚£ä¸ªäº¤æ¢æœº</span></span><br><span class="line"><span class="comment">    * 3.routing key</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">bindingQueueExchange</span><span class="params">(<span class="meta">@Qualifier(&quot;bootQueue&quot;)</span> Queue queue, <span class="meta">@Qualifier(&quot;bootExchange&quot;)</span> Exchange exchange)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(queue).to(exchange).with(<span class="string">&quot;boot.#&quot;</span>).noargs();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”Ÿäº§è€…åˆ©ç”¨<code>RabbitTemplate</code>æ¥å‘é€ä¿¡æ¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProducerTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.æ³¨å…¥RabbitTemplate</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSend</span><span class="params">()</span> &#123;</span><br><span class="line">        rabbitTemplate.convertAndSend(RabbitMQConfig.EXCHANGE_NAME, <span class="string">&quot;boot.haha&quot;</span>, <span class="string">&quot;boot mq hello!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¶ˆè´¹è€…ç¼–å†™æ¶ˆæ¯ç›‘å¬å™¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RabbitMQListener</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;boot_queue&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">ListenerQueue</span><span class="params">(Message message)</span>&#123;</span><br><span class="line">        <span class="comment">//System.out.println(message);</span></span><br><span class="line">        System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(message.getBody()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°ç»“ï¼š</p><ul><li><p>ä½¿ç”¨ Spring æ•´åˆ RabbitMQ å°†ç»„ä»¶å…¨éƒ¨ä½¿ç”¨é…ç½®æ–¹å¼å®ç°ï¼Œç®€åŒ–ç¼–ç </p></li><li><p>Spring æä¾› RabbitTemplate ç®€åŒ–å‘é€æ¶ˆæ¯ API</p></li><li><p>ä½¿ç”¨ç›‘å¬æœºåˆ¶ç®€åŒ–æ¶ˆè´¹è€…ç¼–ç </p></li></ul><h2 id="Rabbit-MQé«˜çº§ç‰¹æ€§"><a href="#Rabbit-MQé«˜çº§ç‰¹æ€§" class="headerlink" title="Rabbit MQé«˜çº§ç‰¹æ€§"></a>Rabbit MQé«˜çº§ç‰¹æ€§</h2><h3 id="æ¶ˆæ¯çš„å¯é æŠ•é€’"><a href="#æ¶ˆæ¯çš„å¯é æŠ•é€’" class="headerlink" title="æ¶ˆæ¯çš„å¯é æŠ•é€’"></a>æ¶ˆæ¯çš„å¯é æŠ•é€’</h3><p>åœ¨ä½¿ç”¨ RabbitMQ çš„æ—¶å€™ï¼Œä½œä¸ºæ¶ˆæ¯å‘é€æ–¹å¸Œæœ›æœç»ä»»ä½•æ¶ˆæ¯ä¸¢å¤±æˆ–è€…æŠ•é€’å¤±è´¥åœºæ™¯ã€‚RabbitMQ ä¸ºæˆ‘ä»¬æä¾›äº†ä¸¤ç§æ–¹å¼ç”¨æ¥æ§åˆ¶æ¶ˆæ¯çš„æŠ•é€’å¯é æ€§æ¨¡å¼ã€‚</p><ul><li><p>confirm ç¡®è®¤æ¨¡å¼</p></li><li><p>return é€€å›æ¨¡å¼</p></li></ul><p>rabbitmq æ•´ä¸ªæ¶ˆæ¯æŠ•é€’çš„è·¯å¾„ä¸ºï¼š</p><p>producerâ€”&gt;rabbitmq brokerâ€”&gt;exchangeâ€”&gt;queueâ€”&gt;consumer</p><ul><li><p>æ¶ˆæ¯ä» producer åˆ° exchange åˆ™ä¼šè¿”å›ä¸€ä¸ª confirmCallback(confirm ç¡®è®¤æ¨¡å¼) ã€‚</p></li><li><p>æ¶ˆæ¯ä» exchangeâ€“&gt;queue æŠ•é€’å¤±è´¥åˆ™ä¼šè¿”å›ä¸€ä¸ª returnCallback(return é€€å›æ¨¡å¼) ã€‚</p></li></ul><p>æˆ‘ä»¬å°†åˆ©ç”¨è¿™ä¸¤ä¸ª callback æ§åˆ¶æ¶ˆæ¯çš„å¯é æ€§æŠ•é€’</p><p>ç¼–å†™é…ç½®ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RabbitMQConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;test_exchange_confirm&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;test_queue_confirm&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.äº¤æ¢æœº</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Exchange <span class="title function_">confirmExchange</span><span class="params">()</span>&#123;</span><br><span class="line">       <span class="keyword">return</span> ExchangeBuilder.directExchange(EXCHANGE_NAME).durable(<span class="literal">true</span>).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.é˜Ÿåˆ—</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">confirmQueue</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> QueueBuilder.durable(QUEUE_NAME).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.é˜Ÿåˆ—äº¤æ¢æœºç»‘å®šå…³ç³» Binding</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * 1.çŸ¥é“é‚£ä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">    * 2.çŸ¥é“é‚£ä¸ªäº¤æ¢æœº</span></span><br><span class="line"><span class="comment">    * 3.routing key</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">bindingQueueExchange</span><span class="params">(<span class="meta">@Qualifier(&quot;confirmQueue&quot;)</span> Queue queue, <span class="meta">@Qualifier(&quot;confirmExchange&quot;)</span> Exchange exchange)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(queue).to(exchange).with(<span class="string">&quot;confirm&quot;</span>).noargs();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>application.yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é…ç½®RabbitMQçš„åŸºæœ¬ä¿¡æ¯ ipç«¯å£</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="number">192.168</span><span class="number">.184</span><span class="number">.100</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">dong</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">dong</span></span><br><span class="line">    <span class="attr">virtual-host:</span> <span class="string">/itcast</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">5672</span></span><br><span class="line">    <span class="comment"># ç¡®è®¤æ¨¡å¼å¼€å¯</span></span><br><span class="line">    <span class="attr">publisher-confirm-type:</span> <span class="string">correlated</span></span><br><span class="line">    <span class="comment"># å›é€€æ¨¡å¼å¼€å¯</span></span><br><span class="line">    <span class="attr">publisher-returns:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h4 id="confirmç¡®è®¤æ¨¡å¼"><a href="#confirmç¡®è®¤æ¨¡å¼" class="headerlink" title="confirmç¡®è®¤æ¨¡å¼"></a>confirmç¡®è®¤æ¨¡å¼</h4><p>ç¡®è®¤æ¨¡å¼ï¼š</p><ul><li>æ­¥éª¤ï¼š<ul><li><ol><li>ç¡®è®¤æ¨¡å¼å¼€å¯ï¼špublisher-confirm-type: correlated</li></ol></li><li><ol start="2"><li>åœ¨rabbitTemplateå®šä¹‰confirmCallBackå›è°ƒå‡½æ•°</li></ol></li></ul></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç¡®è®¤æ¨¡å¼ï¼š</span></span><br><span class="line"><span class="comment">     *  æ­¥éª¤ï¼š</span></span><br><span class="line"><span class="comment">     *      1. ç¡®è®¤æ¨¡å¼å¼€å¯ï¼špublisher-confirm-type: correlated</span></span><br><span class="line"><span class="comment">     *      2. åœ¨rabbitTemplateå®šä¹‰confirmCallBackå›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testConfirm</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. å®šä¹‰å›è°ƒ</span></span><br><span class="line">        rabbitTemplate.setConfirmCallback(<span class="keyword">new</span> <span class="title class_">RabbitTemplate</span>.ConfirmCallback()&#123;</span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * <span class="doctag">@param</span> correlationData ç›¸å…³çš„é…ç½®ä¿¡æ¯</span></span><br><span class="line"><span class="comment">             * <span class="doctag">@param</span> ack exchangeäº¤æ¢æœº æ˜¯å¦æˆåŠŸæ”¶åˆ°äº†æ¶ˆæ¯ã€‚true æˆåŠŸï¼Œ false å¤±è´¥</span></span><br><span class="line"><span class="comment">             * <span class="doctag">@param</span> cause å¤±è´¥åŸå› </span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">confirm</span><span class="params">(CorrelationData correlationData, <span class="type">boolean</span> ack, String cause)</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;confirm running...&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span> (ack) &#123;</span><br><span class="line">                    <span class="comment">//æ¥æ”¶æˆåŠŸ</span></span><br><span class="line">                    System.out.println(<span class="string">&quot;accepting success:&quot;</span> + cause);</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">//æ¥æ”¶å¤±è´¥</span></span><br><span class="line">                    System.out.println(<span class="string">&quot;accepting fail:&quot;</span> + cause);</span><br><span class="line">                    <span class="comment">//åšä¸€äº›å¤„ç†ï¼Œè®©æ¶ˆæ¯å†æ¬¡å‘é€</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. å‘é€æ¶ˆæ¯</span></span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">&quot;test_exchange_confirm&quot;</span>, <span class="string">&quot;confirm&quot;</span>, <span class="string">&quot;message confirm&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="returné€€å›æ¨¡å¼"><a href="#returné€€å›æ¨¡å¼" class="headerlink" title="returné€€å›æ¨¡å¼"></a>returné€€å›æ¨¡å¼</h4><p>å›é€€æ¨¡å¼ï¼š å½“æ¶ˆæ¯å‘é€ç»™ Exchange åï¼ŒExchange è·¯ç”±åˆ° Queue å¤±è´¥åæ‰ä¼šæ‰§è¡Œ ReturnCallBack</p><ul><li>æ­¥éª¤ï¼š<ol><li>å¼€å¯å›é€€æ¨¡å¼ publisher-returns: true</li><li>è®¾ç½®ReturnCallBack</li><li>è®¾ç½®Exchangeå¤„ç†æ¶ˆæ¯çš„æ¨¡å¼ï¼š<ol><li>å¦‚æœæ¶ˆæ¯æ²¡æœ‰è·¯ç”±åˆ°Queue,åˆ™ä¸¢å¼ƒæ¶ˆæ¯ï¼ˆé»˜è®¤ï¼‰</li><li>å¦‚æœæ¶ˆæ¯æ²¡æœ‰è·¯ç”±åˆ°Queue,è¿”å›ç»™æ¶ˆæ¯å‘é€æ–¹ReturnCallBack</li></ol></li></ol></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å›é€€æ¨¡å¼ï¼š å½“æ¶ˆæ¯å‘é€ç»™ Exchange åï¼ŒExchange è·¯ç”±åˆ° Queue å¤±è´¥åæ‰ä¼šæ‰§è¡Œ ReturnCallBack</span></span><br><span class="line"><span class="comment">     *  æ­¥éª¤ï¼š</span></span><br><span class="line"><span class="comment">     *      1. å¼€å¯å›é€€æ¨¡å¼ publisher-returns: true</span></span><br><span class="line"><span class="comment">     *      2. è®¾ç½®ReturnCallBack</span></span><br><span class="line"><span class="comment">     *      3. è®¾ç½®Exchangeå¤„ç†æ¶ˆæ¯çš„æ¨¡å¼ï¼š</span></span><br><span class="line"><span class="comment">     *         3.1 å¦‚æœæ¶ˆæ¯æ²¡æœ‰è·¯ç”±åˆ°Queue,åˆ™ä¸¢å¼ƒæ¶ˆæ¯ï¼ˆé»˜è®¤ï¼‰</span></span><br><span class="line"><span class="comment">     *         3.2 å¦‚æœæ¶ˆæ¯æ²¡æœ‰è·¯ç”±åˆ°Queue,è¿”å›ç»™æ¶ˆæ¯å‘é€æ–¹ReturnCallBack</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testReturn</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¾ç½®äº¤æ¢æœºå¤„ç†å¤±è´¥æ¶ˆæ¯çš„æ¨¡å¼</span></span><br><span class="line">    rabbitTemplate.setMandatory(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2. è®¾ç½®ReturnCallBack</span></span><br><span class="line">    rabbitTemplate.setReturnCallback(<span class="keyword">new</span> <span class="title class_">RabbitTemplate</span>.ReturnCallback()&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * <span class="doctag">@param</span> message æ¶ˆæ¯å¯¹è±¡</span></span><br><span class="line"><span class="comment">             * <span class="doctag">@param</span> replyCode é”™è¯¯ç </span></span><br><span class="line"><span class="comment">             * <span class="doctag">@param</span> replyText é”™è¯¯ä¿¡æ¯</span></span><br><span class="line"><span class="comment">             * <span class="doctag">@param</span> exchange äº¤æ¢æœº</span></span><br><span class="line"><span class="comment">             * <span class="doctag">@param</span> routingKey è·¯ç”±å™¨</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">returnedMessage</span><span class="params">(Message message, <span class="type">int</span> replyCode, String replyText, String exchange, String routingKey)</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;return running...&quot;</span>);</span><br><span class="line">            System.out.println(message);</span><br><span class="line">            System.out.println(replyCode);</span><br><span class="line">            System.out.println(replyText);</span><br><span class="line">            System.out.println(exchange);</span><br><span class="line">            System.out.println(routingKey);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3. å‘é€æ¶ˆæ¯</span></span><br><span class="line">    rabbitTemplate.convertAndSend(<span class="string">&quot;test_exchange_confirm&quot;</span>, <span class="string">&quot;confirm2&quot;</span>, <span class="string">&quot;message confirm&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ¶ˆæ¯çš„å¯é æŠ•é€’å°ç»“"><a href="#æ¶ˆæ¯çš„å¯é æŠ•é€’å°ç»“" class="headerlink" title="æ¶ˆæ¯çš„å¯é æŠ•é€’å°ç»“"></a>æ¶ˆæ¯çš„å¯é æŠ•é€’å°ç»“</h4><p>â¢ é…ç½®application.ymlçš„publisher-confirm-type: correlated å¼€å¯ç¡®è®¤æ¨¡å¼ã€‚</p><p>â¢ ä½¿ç”¨rabbitTemplate.setConfirmCallbackè®¾ç½®å›è°ƒå‡½æ•°ã€‚å½“æ¶ˆæ¯å‘é€åˆ°exchangeåå›è°ƒconfirmæ–¹æ³•ã€‚åœ¨æ–¹æ³•ä¸­åˆ¤æ–­ackï¼Œå¦‚æœä¸ºtrueï¼Œåˆ™å‘é€æˆåŠŸï¼Œå¦‚æœä¸ºfalseï¼Œåˆ™å‘é€å¤±è´¥ï¼Œéœ€è¦å¤„ç†ã€‚</p><p>â¢ é…ç½®application.ymlçš„publisher-returns: trueå¼€å¯ é€€å›æ¨¡å¼ã€‚</p><p>â¢ ä½¿ç”¨rabbitTemplate.setReturnCallbackè®¾ç½®é€€å›å‡½æ•°ï¼Œå½“æ¶ˆæ¯ä»exchangeè·¯ç”±åˆ°queueå¤±è´¥åï¼Œå¦‚æœè®¾ç½®äº†rabbitTemplate.setMandatory(true)å‚æ•°ï¼Œåˆ™ä¼šå°†æ¶ˆæ¯é€€å›ç»™producerã€‚å¹¶æ‰§è¡Œå›è°ƒå‡½æ•°returnedMessageã€‚</p><p>â¢ åœ¨RabbitMQä¸­ä¹Ÿæä¾›äº†äº‹åŠ¡æœºåˆ¶ï¼Œä½†æ˜¯æ€§èƒ½è¾ƒå·®ï¼Œæ­¤å¤„ä¸åšè®²è§£ã€‚</p><p>ä½¿ç”¨channelä¸‹åˆ—æ–¹æ³•ï¼Œå®Œæˆäº‹åŠ¡æ§åˆ¶ï¼š</p><p>txSelect(), ç”¨äºå°†å½“å‰channelè®¾ç½®æˆtransactionæ¨¡å¼</p><p>txCommit()ï¼Œç”¨äºæäº¤äº‹åŠ¡</p><p>txRollback(),ç”¨äºå›æ»šäº‹åŠ¡</p><h3 id="Consumer-Ack"><a href="#Consumer-Ack" class="headerlink" title="Consumer Ack"></a>Consumer Ack</h3><p>ackæŒ‡Acknowledgeï¼Œç¡®è®¤ã€‚ è¡¨ç¤ºæ¶ˆè´¹ç«¯æ”¶åˆ°æ¶ˆæ¯åçš„ç¡®è®¤æ–¹å¼ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ç±»æ¯”confirm</span><br><span class="line">confirmæ˜¯consumeråˆ°broker</span><br><span class="line">ackæ˜¯brokeråˆ°consumer</span><br></pre></td></tr></table></figure><p>æœ‰ä¸‰ç§ç¡®è®¤æ–¹å¼ï¼š</p><ul><li><p>è‡ªåŠ¨ç¡®è®¤ï¼šacknowledge&#x3D;â€noneâ€</p></li><li><p>æ‰‹åŠ¨ç¡®è®¤ï¼šacknowledge&#x3D;â€manualâ€</p></li><li><p>æ ¹æ®å¼‚å¸¸æƒ…å†µç¡®è®¤ï¼šacknowledge&#x3D;â€autoâ€ï¼ˆè¿™ç§æ–¹å¼ä½¿ç”¨éº»çƒ¦ï¼Œä¸ä½œè®²è§£ï¼‰</p></li></ul><p>å…¶ä¸­è‡ªåŠ¨ç¡®è®¤æ˜¯æŒ‡ï¼Œå½“æ¶ˆæ¯ä¸€æ—¦è¢«Consumeræ¥æ”¶åˆ°ï¼Œåˆ™è‡ªåŠ¨ç¡®è®¤æ”¶åˆ°ï¼Œå¹¶å°†ç›¸åº” message ä» RabbitMQ çš„æ¶ˆæ¯ç¼“å­˜ä¸­ç§»é™¤ã€‚ä½†æ˜¯åœ¨å®é™…ä¸šåŠ¡å¤„ç†ä¸­ï¼Œå¾ˆå¯èƒ½æ¶ˆæ¯æ¥æ”¶åˆ°ï¼Œä¸šåŠ¡å¤„ç†å‡ºç°å¼‚å¸¸ï¼Œé‚£ä¹ˆè¯¥æ¶ˆæ¯å°±ä¼šä¸¢å¤±ã€‚</p><p>å¦‚æœè®¾ç½®äº†æ‰‹åŠ¨ç¡®è®¤æ–¹å¼ï¼Œåˆ™éœ€è¦åœ¨ä¸šåŠ¡å¤„ç†æˆåŠŸåï¼Œè°ƒç”¨channel.basicAck()ï¼Œæ‰‹åŠ¨ç­¾æ”¶ã€‚</p><p>å¦‚æœå‡ºç°å¼‚å¸¸ï¼Œåˆ™è°ƒç”¨channel.basicNack()æ–¹æ³•ï¼Œè®©å…¶è‡ªåŠ¨é‡æ–°å‘é€æ¶ˆæ¯ã€‚</p><h4 id="æ¶ˆè´¹è€…"><a href="#æ¶ˆè´¹è€…" class="headerlink" title="æ¶ˆè´¹è€…"></a>æ¶ˆè´¹è€…</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * Consumer ACKæœºåˆ¶ï¼š</span></span><br><span class="line"><span class="comment"> *   1. è®¾ç½®æ‰‹åŠ¨ç­¾æ”¶ acknowledge-mode: manual</span></span><br><span class="line"><span class="comment"> *   2. è®©ç›‘å¬å™¨å®ç° ChannelAwareMessageListener</span></span><br><span class="line"><span class="comment"> *   3. å¦‚æœæ¶ˆæ¯æˆåŠŸå¤„ç†ï¼Œåˆ™è°ƒç”¨channelçš„basicAck()ç­¾æ”¶</span></span><br><span class="line"><span class="comment"> *   4. å¦‚æœæ¶ˆæ¯å¤„ç†å¤±è´¥ï¼Œåˆ™è°ƒç”¨channelçš„basicNck()æ‹’ç»ç­¾æ”¶ï¼Œbrokeré‡æ–°å‘ç»™consumer</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AckListener</span> <span class="keyword">implements</span> <span class="title class_">ChannelAwareMessageListener</span> &#123;</span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;test_queue_confirm&quot;)</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onMessage</span><span class="params">(Message message, Channel channel)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        <span class="type">long</span> <span class="variable">deliveryTag</span> <span class="operator">=</span> message.getMessageProperties().getDeliveryTag();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//1. æ¥å—è½¬æ¢æ¶ˆæ¯</span></span><br><span class="line">            System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(message.getBody()));</span><br><span class="line"></span><br><span class="line">            <span class="comment">//2. å¤„ç†ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">            System.out.println(<span class="string">&quot;handle business logic&quot;</span>);</span><br><span class="line">            <span class="comment">//int i = 3 / 0;</span></span><br><span class="line">            <span class="comment">//3. æ‰‹åŠ¨ç­¾æ”¶</span></span><br><span class="line">            channel.basicAck(deliveryTag, <span class="literal">true</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">//4. æ‹’ç»ç­¾æ”¶</span></span><br><span class="line">            <span class="comment">/***</span></span><br><span class="line"><span class="comment">             * ç¬¬ä¸‰ä¸ªå‚æ•°requeueï¼šé‡å›é˜Ÿåˆ—ã€‚å¦‚æœè®¾ç½®ä¸ºtrue,åˆ™é‡å›queueï¼Œbrokerä¼šé‡æ–°å‘é€è¯¥æ¶ˆæ¯ç»™æ¶ˆè´¹ç«¯</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            channel.basicNack(deliveryTag, <span class="literal">true</span>, <span class="literal">true</span>);</span><br><span class="line">            <span class="comment">//channel.basicReject(deliveryTag, true);</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>application.yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é…ç½®RabbitMQçš„åŸºæœ¬ä¿¡æ¯ ipç«¯å£</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="number">192.168</span><span class="number">.184</span><span class="number">.100</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">dong</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">dong</span></span><br><span class="line">    <span class="attr">virtual-host:</span> <span class="string">/itcast</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">5672</span></span><br><span class="line">    <span class="attr">listener:</span></span><br><span class="line">      <span class="attr">direct:</span></span><br><span class="line">        <span class="attr">acknowledge-mode:</span> <span class="string">manual</span></span><br></pre></td></tr></table></figure><h4 id="Consumer-Ack-å°ç»“"><a href="#Consumer-Ack-å°ç»“" class="headerlink" title="Consumer Ack å°ç»“"></a>Consumer Ack å°ç»“</h4><p>â¢ åœ¨appliacation.ymlæ ‡ç­¾ä¸­è®¾ç½®acknowledge-modeå±æ€§ï¼Œè®¾ç½®ackæ–¹å¼ noneï¼šè‡ªåŠ¨ç¡®è®¤ï¼Œmanualï¼šæ‰‹åŠ¨ç¡®è®¤</p><p>â¢ å¦‚æœåœ¨æ¶ˆè´¹ç«¯æ²¡æœ‰å‡ºç°å¼‚å¸¸ï¼Œåˆ™è°ƒç”¨channel.basicAck(deliveryTag,false);æ–¹æ³•ç¡®è®¤ç­¾æ”¶æ¶ˆæ¯</p><p>â¢ å¦‚æœå‡ºç°å¼‚å¸¸ï¼Œåˆ™åœ¨catchä¸­è°ƒç”¨ basicNackæˆ– basicRejectï¼Œæ‹’ç»æ¶ˆæ¯ï¼Œè®©MQé‡æ–°å‘é€æ¶ˆæ¯ã€‚</p><h3 id="æ¶ˆè´¹ç«¯é™æµ"><a href="#æ¶ˆè´¹ç«¯é™æµ" class="headerlink" title="æ¶ˆè´¹ç«¯é™æµ"></a>æ¶ˆè´¹ç«¯é™æµ</h3><p>è¯·æ±‚ç¬é—´å¢å¤šï¼Œæ¯ç§’5000ä¸ªè¯·æ±‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210180831992.png" alt="image-20221018083146873"></p><h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * Consumer é™æµæœºåˆ¶ï¼š</span></span><br><span class="line"><span class="comment"> * 1. ç¡®ä¿ackæœºåˆ¶ä¸ºæ‰‹åŠ¨ç¡®è®¤ã€‚</span></span><br><span class="line"><span class="comment"> * 2. é…ç½®å±æ€§</span></span><br><span class="line"><span class="comment"> *  perfetch = 1ï¼Œè¡¨ç¤ºæ¶ˆè´¹ç«¯æ¯æ¬¡ä»mqæ‹‰å–ä¸€å¤©æ¶ˆæ¯æ¥æ¶ˆè´¹ï¼Œç›´åˆ°æ‰‹åŠ¨ç¡®è®¤æ¶ˆè´¹å®Œæ¯•åï¼Œæ‰ä¼šç»§ç»­æ‹‰å–ä¸‹ä¸€æ¡æ¶ˆæ¯ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">QosListener</span> <span class="keyword">implements</span> <span class="title class_">ChannelAwareMessageListener</span> &#123;</span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;test_queue_confirm&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onMessage</span><span class="params">(Message message, Channel channel)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        <span class="comment">//1. è·å–æ¶ˆæ¯</span></span><br><span class="line">        System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(message.getBody()));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//2. å¤„ç†ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//3. ç­¾æ”¶</span></span><br><span class="line">        <span class="comment">//channel.basicAck(message.getMessageProperties().getDeliveryTag(), true);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#é…ç½®RabbitMQçš„åŸºæœ¬ä¿¡æ¯ ipç«¯å£</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="number">192.168</span><span class="number">.184</span><span class="number">.100</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">dong</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">dong</span></span><br><span class="line">    <span class="attr">virtual-host:</span> <span class="string">/itcast</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">5672</span></span><br><span class="line">    <span class="attr">listener:</span></span><br><span class="line">      <span class="attr">simple:</span></span><br><span class="line">        <span class="attr">acknowledge-mode:</span> <span class="string">manual</span></span><br><span class="line">        <span class="attr">prefetch:</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><h4 id="æ¶ˆè´¹ç«¯é™æµå°ç»“"><a href="#æ¶ˆè´¹ç«¯é™æµå°ç»“" class="headerlink" title="æ¶ˆè´¹ç«¯é™æµå°ç»“"></a>æ¶ˆè´¹ç«¯é™æµå°ç»“</h4><p>â¢ åœ¨alllication.yml ä¸­é…ç½® prefetchå±æ€§è®¾ç½®æ¶ˆè´¹ç«¯ä¸€æ¬¡æ‹‰å–å¤šå°‘æ¶ˆæ¯</p><p>â¢ æ¶ˆè´¹ç«¯çš„ç¡®è®¤æ¨¡å¼ä¸€å®šä¸ºæ‰‹åŠ¨ç¡®è®¤ã€‚acknowledge&#x3D;â€manualâ€</p><h3 id="TTL"><a href="#TTL" class="headerlink" title="TTL"></a>TTL</h3><h4 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h4><p>â¢ TTL å…¨ç§° Time To Liveï¼ˆå­˜æ´»æ—¶é—´&#x2F;è¿‡æœŸæ—¶é—´ï¼‰ã€‚</p><p>â¢ å½“æ¶ˆæ¯åˆ°è¾¾å­˜æ´»æ—¶é—´åï¼Œè¿˜æ²¡æœ‰è¢«æ¶ˆè´¹ï¼Œä¼šè¢«è‡ªåŠ¨æ¸…é™¤ã€‚</p><p>â¢ RabbitMQå¯ä»¥å¯¹æ¶ˆæ¯è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä¹Ÿå¯ä»¥å¯¹æ•´ä¸ªé˜Ÿåˆ—ï¼ˆQueueï¼‰è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210181832870.png" alt="image-20221018183210610"></p><h4 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h4><p>é…ç½®ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RabbitMQConfigTTL</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_NAME</span> <span class="operator">=</span> <span class="string">&quot;test_exchange_ttl&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_NAME</span> <span class="operator">=</span> <span class="string">&quot;test_queue_ttl&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//1.äº¤æ¢æœº</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Exchange <span class="title function_">ttlExchange</span><span class="params">()</span>&#123;</span><br><span class="line">       <span class="comment">// è®¾ç½®queueçš„è¿‡æœŸæ—¶é—´</span></span><br><span class="line">        <span class="keyword">return</span> ExchangeBuilder.topicExchange(EXCHANGE_NAME).durable(<span class="literal">true</span>).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.é˜Ÿåˆ—</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">ttlQueue</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> QueueBuilder.durable(QUEUE_NAME).ttl(<span class="number">10000</span>).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.é˜Ÿåˆ—äº¤æ¢æœºç»‘å®šå…³ç³» Binding</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * 1.çŸ¥é“é‚£ä¸ªé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment">    * 2.çŸ¥é“é‚£ä¸ªäº¤æ¢æœº</span></span><br><span class="line"><span class="comment">    * 3.routing key</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">bindingQueueExchange</span><span class="params">(<span class="meta">@Qualifier(&quot;ttlQueue&quot;)</span> Queue queue, <span class="meta">@Qualifier(&quot;ttlExchange&quot;)</span> Exchange exchange)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(queue).to(exchange).with(<span class="string">&quot;ttl.*&quot;</span>).noargs();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æµ‹è¯•</p><ol><li><p>é˜Ÿåˆ—çš„ç»Ÿä¸€è¿‡æœŸæ—¶é—´</p></li><li><p>æ¶ˆæ¯å•ç‹¬è¿‡æœŸ</p></li></ol><ul><li>å¦‚æœè®¾ç½®äº†æ¶ˆæ¯çš„è¿‡æœŸæ—¶é—´ï¼Œä¹Ÿè®¾ç½®äº†é˜Ÿåˆ—çš„è¿‡æœŸæ—¶é—´ï¼Œä»¥æ—¶é—´çŸ­çš„ä¸ºå‡†ã€‚</li><li>é˜Ÿåˆ—è¿‡æœŸåï¼Œä¼šå°†é˜Ÿåˆ—æ‰€æœ‰ä¿¡æ¯å…¨éƒ¨ç§»é™¤ã€‚</li><li>æ¶ˆæ¯è¿‡æœŸåï¼Œåªæœ‰æ¶ˆæ¯åœ¨é˜Ÿåˆ—é¡¶ç«¯ï¼Œæ‰ä¼šåˆ¤æ–­å…¶æ˜¯å¦è¿‡æœŸäº†ï¼ˆç§»é™¤æ‰ï¼‰</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * TTL:è¿‡æœŸæ—¶é—´</span></span><br><span class="line"><span class="comment"> * 1. é˜Ÿåˆ—çš„ç»Ÿä¸€è¿‡æœŸæ—¶é—´</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 2. æ¶ˆæ¯å•ç‹¬è¿‡æœŸ</span></span><br><span class="line"><span class="comment"> * å¦‚æœè®¾ç½®äº†æ¶ˆæ¯çš„è¿‡æœŸæ—¶é—´ï¼Œä¹Ÿè®¾ç½®äº†é˜Ÿåˆ—çš„è¿‡æœŸæ—¶é—´ï¼Œä»¥æ—¶é—´çŸ­çš„ä¸ºå‡†ã€‚</span></span><br><span class="line"><span class="comment"> * é˜Ÿåˆ—è¿‡æœŸåï¼Œä¼šå°†é˜Ÿåˆ—æ‰€æœ‰ä¿¡æ¯å…¨éƒ¨ç§»é™¤ã€‚</span></span><br><span class="line"><span class="comment"> * æ¶ˆæ¯è¿‡æœŸåï¼Œåªæœ‰æ¶ˆæ¯åœ¨é˜Ÿåˆ—é¡¶ç«¯ï¼Œæ‰ä¼šåˆ¤æ–­å…¶æ˜¯å¦è¿‡æœŸäº†ï¼ˆç§»é™¤æ‰ï¼‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testTtl</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">/*// é˜Ÿåˆ—çš„ç»Ÿä¸€è¿‡æœŸæ—¶é—´</span></span><br><span class="line"><span class="comment">    for (int i = 0; i &lt; 10; i++) &#123;</span></span><br><span class="line"><span class="comment">        //å‘é€æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">        rabbitTemplate.convertAndSend(&quot;test_exchange_ttl&quot;, &quot;ttl.haha&quot;, &quot;message ttl....&quot;);</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¶ˆæ¯å•ç‹¬è¿‡æœŸ</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¶ˆæ¯çš„åå¤„ç†å¯¹è±¡ï¼Œè®¾ç½®ä¸€äº›ä¿¡æ¯çš„å‚æ•°ä¿¡æ¯</span></span><br><span class="line">    <span class="type">MessagePostProcessor</span> <span class="variable">messagePostProcessor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MessagePostProcessor</span>() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> Message <span class="title function_">postProcessMessage</span><span class="params">(Message message)</span> <span class="keyword">throws</span> AmqpException &#123;</span><br><span class="line">            <span class="comment">//1. è®¾ç½®messageçš„ä¿¡æ¯</span></span><br><span class="line">            message.getMessageProperties().setExpiration(<span class="string">&quot;5000&quot;</span>);<span class="comment">//æ¶ˆæ¯è¿‡æœŸæ—¶é—´</span></span><br><span class="line">            <span class="comment">//2. è¿”å›è¯¥æ¶ˆæ¯</span></span><br><span class="line">            <span class="keyword">return</span> message;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">//rabbitTemplate.convertAndSend(&quot;test_exchange_ttl&quot;, &quot;ttl.haha&quot;, &quot;message ttl....&quot;, messagePostProcessor);</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i == <span class="number">5</span>) &#123;</span><br><span class="line">            <span class="comment">//æ¶ˆæ¯å•ç‹¬è¿‡æœŸ</span></span><br><span class="line">            rabbitTemplate.convertAndSend(<span class="string">&quot;test_exchange_ttl&quot;</span>, <span class="string">&quot;ttl.haha&quot;</span>, <span class="string">&quot;message ttl....&quot;</span>, messagePostProcessor);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//ä¸è¿‡æœŸçš„æ¶ˆæ¯</span></span><br><span class="line">            rabbitTemplate.convertAndSend(<span class="string">&quot;test_exchange_ttl&quot;</span>, <span class="string">&quot;ttl.haha&quot;</span>, <span class="string">&quot;message ttl....&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="TTL-å°ç»“"><a href="#TTL-å°ç»“" class="headerlink" title="TTL å°ç»“"></a>TTL å°ç»“</h4><p>â¢ è®¾ç½®é˜Ÿåˆ—è¿‡æœŸæ—¶é—´ä½¿ç”¨å‚æ•°ï¼šx-message-ttlï¼Œå•ä½ï¼šms(æ¯«ç§’)ï¼Œä¼šå¯¹æ•´ä¸ªé˜Ÿåˆ—æ¶ˆæ¯ç»Ÿä¸€è¿‡æœŸã€‚</p><p>â¢ è®¾ç½®æ¶ˆæ¯è¿‡æœŸæ—¶é—´ä½¿ç”¨å‚æ•°ï¼šexpirationã€‚å•ä½ï¼šms(æ¯«ç§’)ï¼Œå½“è¯¥æ¶ˆæ¯åœ¨é˜Ÿåˆ—å¤´éƒ¨æ—¶ï¼ˆæ¶ˆè´¹æ—¶ï¼‰ï¼Œä¼šå•ç‹¬åˆ¤æ–­è¿™ä¸€æ¶ˆæ¯æ˜¯å¦è¿‡æœŸã€‚</p><p>â¢ å¦‚æœä¸¤è€…éƒ½è¿›è¡Œäº†è®¾ç½®ï¼Œä»¥æ—¶é—´çŸ­çš„ä¸ºå‡†ã€‚</p><h3 id="æ­»ä¿¡é˜Ÿåˆ—"><a href="#æ­»ä¿¡é˜Ÿåˆ—" class="headerlink" title="æ­»ä¿¡é˜Ÿåˆ—"></a><strong>æ­»ä¿¡é˜Ÿåˆ—</strong></h3><h4 id="æ¦‚è¿°-1"><a href="#æ¦‚è¿°-1" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h4><p>æ­»ä¿¡é˜Ÿåˆ—ï¼Œè‹±æ–‡ç¼©å†™ï¼šDLX ã€‚Dead Letter Exchangeï¼ˆæ­»ä¿¡äº¤æ¢æœºï¼‰ï¼Œå½“æ¶ˆæ¯æˆä¸ºDead messageåï¼Œå¯ä»¥è¢«é‡æ–°å‘é€åˆ°å¦ä¸€ä¸ªäº¤æ¢æœºï¼Œè¿™ä¸ªäº¤æ¢æœºå°±æ˜¯DLXã€‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210181917671.png" alt="image-20221018191726586"></p><h4 id="æ¶ˆæ¯æˆä¸ºæ­»ä¿¡çš„ä¸‰ç§æƒ…å†µ"><a href="#æ¶ˆæ¯æˆä¸ºæ­»ä¿¡çš„ä¸‰ç§æƒ…å†µ" class="headerlink" title="æ¶ˆæ¯æˆä¸ºæ­»ä¿¡çš„ä¸‰ç§æƒ…å†µ"></a>æ¶ˆæ¯æˆä¸ºæ­»ä¿¡çš„ä¸‰ç§æƒ…å†µ</h4><ol><li><p>é˜Ÿåˆ—æ¶ˆæ¯é•¿åº¦åˆ°è¾¾é™åˆ¶ï¼›</p></li><li><p>æ¶ˆè´¹è€…æ‹’æ¥æ¶ˆè´¹æ¶ˆæ¯ï¼ŒbasicNack&#x2F;basicReject,å¹¶ä¸”ä¸æŠŠæ¶ˆæ¯é‡æ–°æ”¾å…¥åŸç›®æ ‡é˜Ÿåˆ—,requeue&#x3D;falseï¼›</p></li><li><p>åŸé˜Ÿåˆ—å­˜åœ¨æ¶ˆæ¯è¿‡æœŸè®¾ç½®ï¼Œæ¶ˆæ¯åˆ°è¾¾è¶…æ—¶æ—¶é—´æœªè¢«æ¶ˆè´¹ï¼›</p></li></ol><h4 id="é˜Ÿåˆ—ç»‘å®šæ­»ä¿¡äº¤æ¢æœº"><a href="#é˜Ÿåˆ—ç»‘å®šæ­»ä¿¡äº¤æ¢æœº" class="headerlink" title="é˜Ÿåˆ—ç»‘å®šæ­»ä¿¡äº¤æ¢æœº"></a>é˜Ÿåˆ—ç»‘å®šæ­»ä¿¡äº¤æ¢æœº</h4><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210181920148.png" alt="image-20221018192015082"></p><p>ç»™é˜Ÿåˆ—è®¾ç½®å‚æ•°ï¼š x-dead-letter-exchange å’Œ x-dead-letter-routing-key</p><h4 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h4><p>é…ç½®ç±»é…ç½®</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RabbitMQConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ­»ä¿¡äº¤æ¢æœºå’Œæ­»ä¿¡é˜Ÿåˆ—</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_DLX_NAME</span> <span class="operator">=</span> <span class="string">&quot;queue_dlx&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_DLX_NAME</span> <span class="operator">=</span> <span class="string">&quot;exchange_dlx&quot;</span>;</span><br><span class="line">    <span class="comment">//æ­£å¸¸äº¤æ¢æœºå’Œæ­£å¸¸é˜Ÿåˆ—</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_NORMAL_NAME</span> <span class="operator">=</span> <span class="string">&quot;the_queue_dlx&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_NORMAL_NAME</span> <span class="operator">=</span> <span class="string">&quot;the_exchange_dlx&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ­£å¸¸äº¤æ¢æœº</span></span><br><span class="line">    <span class="meta">@Bean(&quot;normalExchange&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Exchange <span class="title function_">normalExchange</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ExchangeBuilder.topicExchange(EXCHANGE_NORMAL_NAME).durable(<span class="literal">true</span>).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ­»ä¿¡äº¤æ¢æœº</span></span><br><span class="line">    <span class="meta">@Bean(&quot;dlxExchange&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Exchange <span class="title function_">dlxExchange</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ExchangeBuilder.topicExchange(EXCHANGE_DLX_NAME).durable(<span class="literal">true</span>).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ­£å¸¸é˜Ÿåˆ—</span></span><br><span class="line">    <span class="meta">@Bean(&quot;normalQueue&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">normalQueue</span><span class="params">()</span>&#123;</span><br><span class="line">        Map&lt;String, Object&gt; args = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">16</span>);</span><br><span class="line">        <span class="comment">//x-dead-letter-exchange    è¿™é‡Œå£°æ˜å½“å‰é˜Ÿåˆ—ç»‘å®šçš„æ­»ä¿¡äº¤æ¢æœº</span></span><br><span class="line">        args.put(<span class="string">&quot;x-dead-letter-exchange&quot;</span>, EXCHANGE_DLX_NAME);</span><br><span class="line">        <span class="comment">//x-dead-letter-routing-key  è¿™é‡Œå£°æ˜å½“å‰é˜Ÿåˆ—çš„æ­»ä¿¡è·¯ç”±key</span></span><br><span class="line">        args.put(<span class="string">&quot;x-dead-letter-routing-key&quot;</span>, <span class="string">&quot;dlx.hehe&quot;</span>);</span><br><span class="line">        <span class="comment">//è¿‡æœŸæ—¶é—´</span></span><br><span class="line">        args.put(<span class="string">&quot;x-message-ttl&quot;</span>,<span class="number">10000</span>);</span><br><span class="line">        <span class="comment">//æœ€å¤§é•¿åº¦</span></span><br><span class="line">        args.put(<span class="string">&quot;x-max-length&quot;</span>,<span class="number">10</span>);</span><br><span class="line">        <span class="keyword">return</span> QueueBuilder.durable(QUEUE_NORMAL_NAME).withArguments(args).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ­»ä¿¡é˜Ÿåˆ—</span></span><br><span class="line">    <span class="meta">@Bean(&quot;dlxQueue&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">dlxQueue</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> QueueBuilder.durable(QUEUE_DLX_NAME).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5.æ­£å¸¸é˜Ÿåˆ—äº¤æ¢æœºç»‘å®š</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">bindingQueueExchangeNormal</span><span class="params">(<span class="meta">@Qualifier(&quot;normalQueue&quot;)</span> Queue queue, <span class="meta">@Qualifier(&quot;normalExchange&quot;)</span> Exchange exchange)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(queue).to(exchange).with(<span class="string">&quot;the.dlx.*&quot;</span>).noargs();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//6.æ­»ä¿¡é˜Ÿåˆ—äº¤æ¢æœºç»‘å®š</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">bindingQueueExchangeDlx</span><span class="params">(<span class="meta">@Qualifier(&quot;dlxQueue&quot;)</span> Queue queue, <span class="meta">@Qualifier(&quot;dlxExchange&quot;)</span> Exchange exchange)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(queue).to(exchange).with(<span class="string">&quot;dlx.*&quot;</span>).noargs();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//6.æ­£å¸¸é˜Ÿåˆ—ç»‘å®šæ­»ä¿¡äº¤æ¢æœº</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">bindingQueueExchangeDlxNormal</span><span class="params">(<span class="meta">@Qualifier(&quot;dlxQueue&quot;)</span> Queue queue, <span class="meta">@Qualifier(&quot;normalExchange&quot;)</span> Exchange exchange)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(queue).to(exchange).with(<span class="string">&quot;dlx.hehe&quot;</span>).noargs();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”Ÿäº§è€…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">     * å‘é€æµ‹è¯•æ­»ä¿¡æ¶ˆæ¯ï¼š</span></span><br><span class="line"><span class="comment">     * 1.è¿‡æœŸæ—¶é—´</span></span><br><span class="line"><span class="comment">     * 2.é•¿åº¦é™åˆ¶</span></span><br><span class="line"><span class="comment">     * 3.æ¶ˆæ¯æ‹’æ”¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testDlx</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//1. æµ‹è¯•è¿‡æœŸæ—¶é—´ï¼Œæ­»ä¿¡æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">//        rabbitTemplate.convertAndSend(&quot;the_exchange_dlx&quot;, &quot;the.dlx.haha&quot;, &quot;message dlx??....&quot;);</span></span><br><span class="line">        <span class="comment">//2. æµ‹è¯•é•¿åº¦é™åˆ¶ï¼Œæ¶ˆæ¯æ­»ä¿¡</span></span><br><span class="line"><span class="comment">//        for (int i = 0; i &lt; 20; i++) &#123;</span></span><br><span class="line"><span class="comment">//            rabbitTemplate.convertAndSend(&quot;the_exchange_dlx&quot;, &quot;the.dlx.haha&quot;, &quot;message dlx??....&quot;);</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line">        <span class="comment">//3. æµ‹è¯•æ¶ˆæ¯ç»æ”¶</span></span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">&quot;the_exchange_dlx&quot;</span>, <span class="string">&quot;the.dlx.haha&quot;</span>, <span class="string">&quot;message dlx??....&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>æ¶ˆè´¹è€…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DlxListener</span> <span class="keyword">implements</span> <span class="title class_">ChannelAwareMessageListener</span> &#123;</span><br><span class="line">    <span class="comment">//å®šä¹‰ç›‘å¬å™¨ï¼Œç›‘å¬æ­£å¸¸é˜Ÿåˆ—</span></span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;the_queue_dlx&quot;)</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onMessage</span><span class="params">(Message message, Channel channel)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        <span class="type">long</span> <span class="variable">deliveryTag</span> <span class="operator">=</span> message.getMessageProperties().getDeliveryTag();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//1. æ¥å—è½¬æ¢æ¶ˆæ¯</span></span><br><span class="line">            System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(message.getBody()));</span><br><span class="line"></span><br><span class="line">            <span class="comment">//2. å¤„ç†ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">            System.out.println(<span class="string">&quot;handle business logic&quot;</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">3</span> / <span class="number">0</span>;</span><br><span class="line">            <span class="comment">//3. æ‰‹åŠ¨ç­¾æ”¶</span></span><br><span class="line">            channel.basicAck(deliveryTag, <span class="literal">true</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">/***</span></span><br><span class="line"><span class="comment">             * ç¬¬ä¸‰ä¸ªå‚æ•°requeueï¼šé‡å›é˜Ÿåˆ—ã€‚å¦‚æœè®¾ç½®ä¸ºtrue,åˆ™é‡å›queueï¼Œbrokerä¼šé‡æ–°å‘é€è¯¥æ¶ˆæ¯ç»™æ¶ˆè´¹ç«¯</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            System.out.println(<span class="string">&quot;å‡ºç°å¼‚å¸¸ï¼Œæ‹’ç»æ¥å—&quot;</span>);</span><br><span class="line">            <span class="comment">//4. æ‹’ç»ç­¾æ”¶ï¼Œä¸é‡å›é˜Ÿåˆ—ï¼Œrequeue=false</span></span><br><span class="line">            channel.basicNack(deliveryTag, <span class="literal">true</span>, <span class="literal">false</span>);</span><br><span class="line">            <span class="comment">//channel.basicReject(deliveryTag, true);</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ­»ä¿¡é˜Ÿåˆ—å°ç»“"><a href="#æ­»ä¿¡é˜Ÿåˆ—å°ç»“" class="headerlink" title="æ­»ä¿¡é˜Ÿåˆ—å°ç»“"></a>æ­»ä¿¡é˜Ÿåˆ—å°ç»“</h4><ol><li>æ­»ä¿¡äº¤æ¢æœºå’Œæ­»ä¿¡é˜Ÿåˆ—å’Œæ™®é€šçš„æ²¡æœ‰åŒºåˆ«</li><li>å½“æ¶ˆæ¯æˆä¸ºæ­»ä¿¡åï¼Œå¦‚æœè¯¥é˜Ÿåˆ—ç»‘å®šäº†æ­»ä¿¡äº¤æ¢æœºï¼Œåˆ™æ¶ˆæ¯ä¼šè¢«æ­»ä¿¡äº¤æ¢æœºé‡æ–°è·¯ç”±åˆ°æ­»ä¿¡é˜Ÿåˆ—</li><li>æ¶ˆæ¯æˆä¸ºæ­»ä¿¡çš„ä¸‰ç§æƒ…å†µï¼š<ol><li>é˜Ÿåˆ—æ¶ˆæ¯é•¿åº¦åˆ°è¾¾é™åˆ¶ï¼›</li><li>æ¶ˆè´¹è€…æ‹’æ¥æ¶ˆè´¹æ¶ˆæ¯ï¼Œå¹¶ä¸”ä¸é‡å›é˜Ÿåˆ—ï¼›</li><li>åŸé˜Ÿåˆ—å­˜åœ¨æ¶ˆæ¯è¿‡æœŸè®¾ç½®ï¼Œæ¶ˆæ¯åˆ°è¾¾è¶…æ—¶æ—¶é—´æœªè¢«æ¶ˆè´¹ï¼›</li></ol></li></ol><h3 id="å»¶è¿Ÿé˜Ÿåˆ—"><a href="#å»¶è¿Ÿé˜Ÿåˆ—" class="headerlink" title="å»¶è¿Ÿé˜Ÿåˆ—"></a><strong>å»¶è¿Ÿé˜Ÿåˆ—</strong></h3><h4 id="æ¦‚è¿°-2"><a href="#æ¦‚è¿°-2" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h4><p>å»¶è¿Ÿé˜Ÿåˆ—ï¼Œå³æ¶ˆæ¯è¿›å…¥é˜Ÿåˆ—åä¸ä¼šç«‹å³è¢«æ¶ˆè´¹ï¼Œåªæœ‰åˆ°è¾¾æŒ‡å®šæ—¶é—´åï¼Œæ‰ä¼šè¢«æ¶ˆè´¹ã€‚</p><p>éœ€æ±‚ï¼š</p><ol><li><p>ä¸‹å•åï¼Œ30åˆ†é’Ÿæœªæ”¯ä»˜ï¼Œå–æ¶ˆè®¢å•ï¼Œå›æ»šåº“å­˜ã€‚</p></li><li><p>æ–°ç”¨æˆ·æ³¨å†ŒæˆåŠŸ7å¤©åï¼Œå‘é€çŸ­ä¿¡é—®å€™ã€‚</p></li></ol><p>å®ç°æ–¹å¼ï¼š</p><ol><li><p>å®šæ—¶å™¨ï¼ˆä¸å¥½ï¼Œä¸ä¼˜é›…ï¼Œå¼€é”€å¤§ï¼‰</p></li><li><p>å»¶è¿Ÿé˜Ÿåˆ—</p></li></ol><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210191032656.png" alt="image-20221019103248546"></p><p>å¾ˆå¯æƒœï¼Œåœ¨RabbitMQä¸­å¹¶æœªæä¾›å»¶è¿Ÿé˜Ÿåˆ—åŠŸèƒ½ã€‚</p><p>ä½†æ˜¯å¯ä»¥ä½¿ç”¨ï¼šTTL+æ­»ä¿¡é˜Ÿåˆ— ç»„åˆå®ç°å»¶è¿Ÿé˜Ÿåˆ—çš„æ•ˆæœã€‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210191036225.png" alt="image-20221019103614158"></p><h4 id="Code-2"><a href="#Code-2" class="headerlink" title="Code"></a>Code</h4><p>é…ç½®ç±»ï¼š</p><ul><li>é…å€¼æ­»ä¿¡é˜Ÿåˆ—ã€æ­»ä¿¡äº¤æ¢æœº</li><li>é…ç½®æ­£å¸¸é˜Ÿåˆ—ã€æ­£å¸¸äº¤æ¢æœº</li><li>æ­£å¸¸é˜Ÿåˆ—ç»‘å®šæ­£å¸¸äº¤æ¢æœº</li><li>æ­»ä¿¡é˜Ÿåˆ—ç»‘å®šæ­»ä¿¡äº¤æ¢æœº</li><li>æ­£å¸¸é˜Ÿåˆ—ç»‘å®šæ­»ä¿¡äº¤æ¢æœº</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">     * å»¶è¿Ÿé˜Ÿåˆ—ï¼š</span></span><br><span class="line"><span class="comment">     * 1. å®šä¹‰æ­£å¸¸äº¤æ¢æœºorder_exchangeå’Œé˜Ÿåˆ—order_queue</span></span><br><span class="line"><span class="comment">     * 2. å®šä¹‰æ­»ä¿¡äº¤æ¢æœºexchange_order_dlxå’Œé˜Ÿåˆ—queue_order_dlx</span></span><br><span class="line"><span class="comment">     * 3. ç»‘å®šï¼Œè®¾ç½®æ­£å¸¸é˜Ÿåˆ—è¿‡æœŸæ—¶é—´ä¸º30min</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="comment">//æ­»ä¿¡äº¤æ¢æœºå’Œæ­»ä¿¡é˜Ÿåˆ—</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_ORDER_DLX_NAME</span> <span class="operator">=</span> <span class="string">&quot;queue_order_dlx&quot;</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_ORDER_DLX_NAME</span> <span class="operator">=</span> <span class="string">&quot;exchange_order_dlx&quot;</span>;</span><br><span class="line"><span class="comment">//æ­£å¸¸äº¤æ¢æœºå’Œæ­£å¸¸é˜Ÿåˆ—</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE_ORDER_NAME</span> <span class="operator">=</span> <span class="string">&quot;order_queue&quot;</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE_ORDER_NAME</span> <span class="operator">=</span> <span class="string">&quot;order_exchange&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ­£å¸¸äº¤æ¢æœº</span></span><br><span class="line"><span class="meta">@Bean(&quot;orderExchange&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Exchange <span class="title function_">orderExchange</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ExchangeBuilder.topicExchange(EXCHANGE_ORDER_NAME).durable(<span class="literal">true</span>).build();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ­»ä¿¡äº¤æ¢æœº</span></span><br><span class="line"><span class="meta">@Bean(&quot;exchangeOrderDlx&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Exchange <span class="title function_">exchangeOrderDlx</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ExchangeBuilder.topicExchange(EXCHANGE_ORDER_DLX_NAME).durable(<span class="literal">true</span>).build();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ­£å¸¸é˜Ÿåˆ—</span></span><br><span class="line"><span class="meta">@Bean(&quot;orderQueue&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Queue <span class="title function_">orderQueue</span><span class="params">()</span>&#123;</span><br><span class="line">    Map&lt;String, Object&gt; args = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">16</span>);</span><br><span class="line">    <span class="comment">//x-dead-letter-exchange    è¿™é‡Œå£°æ˜å½“å‰é˜Ÿåˆ—ç»‘å®šçš„æ­»ä¿¡äº¤æ¢æœº</span></span><br><span class="line">    args.put(<span class="string">&quot;x-dead-letter-exchange&quot;</span>, EXCHANGE_ORDER_DLX_NAME);</span><br><span class="line">    <span class="comment">//x-dead-letter-routing-key  è¿™é‡Œå£°æ˜å½“å‰é˜Ÿåˆ—çš„æ­»ä¿¡è·¯ç”±key</span></span><br><span class="line">    args.put(<span class="string">&quot;x-dead-letter-routing-key&quot;</span>, <span class="string">&quot;dlx.order.cancel&quot;</span>);</span><br><span class="line">    <span class="comment">//è¿‡æœŸæ—¶é—´</span></span><br><span class="line">    args.put(<span class="string">&quot;x-message-ttl&quot;</span>,<span class="number">10000</span>);</span><br><span class="line">    <span class="keyword">return</span> QueueBuilder.durable(QUEUE_ORDER_NAME).withArguments(args).build();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ­»ä¿¡é˜Ÿåˆ—</span></span><br><span class="line"><span class="meta">@Bean(&quot;queueOrderDlx&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Queue <span class="title function_">queueOrderDlx</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> QueueBuilder.durable(QUEUE_ORDER_DLX_NAME).build();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ­£å¸¸é˜Ÿåˆ—äº¤æ¢æœºç»‘å®š</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> Binding <span class="title function_">bindingQueueExchangePOrderNormal</span><span class="params">(<span class="meta">@Qualifier(&quot;orderQueue&quot;)</span> Queue queue, <span class="meta">@Qualifier(&quot;orderExchange&quot;)</span> Exchange exchange)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> BindingBuilder.bind(queue).to(exchange).with(<span class="string">&quot;order.*&quot;</span>).noargs();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ­»ä¿¡é˜Ÿåˆ—äº¤æ¢æœºç»‘å®š</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> Binding <span class="title function_">bindingQueueExchangeOrderDlx</span><span class="params">(<span class="meta">@Qualifier(&quot;queueOrderDlx&quot;)</span> Queue queue, <span class="meta">@Qualifier(&quot;exchangeOrderDlx&quot;)</span> Exchange exchange)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> BindingBuilder.bind(queue).to(exchange).with(<span class="string">&quot;dlx.order.*&quot;</span>).noargs();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ­£å¸¸é˜Ÿåˆ—ç»‘å®šæ­»ä¿¡äº¤æ¢æœº</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> Binding <span class="title function_">bindingQueueExchangeOrderDlxNormal</span><span class="params">(<span class="meta">@Qualifier(&quot;orderQueue&quot;)</span> Queue queue, <span class="meta">@Qualifier(&quot;exchangeOrderDlx&quot;)</span> Exchange exchange)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> BindingBuilder.bind(queue).to(exchange).with(<span class="string">&quot;&quot;</span>).noargs();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”Ÿäº§è€…æµ‹è¯•å‘é€æ¶ˆæ¯ï¼šå‘æ­£å¸¸äº¤æ¢æœºå‘é€æ¶ˆæ¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å»¶è¿Ÿé˜Ÿåˆ—</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> InterruptedException</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testDelay</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">    <span class="comment">//1. å‘é€è®¢å•æ¶ˆæ¯ã€‚å°†æ¥æ˜¯åœ¨è®¢å•ç³»ç»Ÿä¸­ï¼Œä¸‹å•å®Œæˆï¼Œå‘é€æ¶ˆæ¯</span></span><br><span class="line">    rabbitTemplate.convertAndSend(<span class="string">&quot;order_exchange&quot;</span>, <span class="string">&quot;order.msg&quot;</span>, <span class="string">&quot;è®¢å•ï¼šid=1;name=huang&quot;</span>);</span><br><span class="line">    <span class="comment">//2. æ‰“å°å€’è®¡æ—¶</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">10</span>; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">        System.out.println(i + <span class="string">&quot;...&quot;</span>);</span><br><span class="line">        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¶ˆè´¹è€…ï¼šç›‘å¬æ­»ä¿¡é˜Ÿåˆ—</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderListener</span> <span class="keyword">implements</span> <span class="title class_">ChannelAwareMessageListener</span> &#123;</span><br><span class="line">    <span class="comment">//å»¶æ—¶é˜Ÿåˆ—ï¼šå®šä¹‰ç›‘å¬å™¨ï¼Œç›‘å¬æ­»ä¿¡é˜Ÿåˆ—</span></span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;queue_order_dlx&quot;)</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onMessage</span><span class="params">(Message message, Channel channel)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        <span class="type">long</span> <span class="variable">deliveryTag</span> <span class="operator">=</span> message.getMessageProperties().getDeliveryTag();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//1. æ¥å—è½¬æ¢æ¶ˆæ¯</span></span><br><span class="line">            System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(message.getBody()));</span><br><span class="line"></span><br><span class="line">            <span class="comment">//2. å¤„ç†ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">            System.out.println(<span class="string">&quot;handle business logic&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;æ ¹æ®è®¢å•idæŸ¥è¯¢å…¶çŠ¶æ€...&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;åˆ¤æ–­è®¢å•æ˜¯å¦æ”¯ä»˜æˆåŠŸ...&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;å–æ¶ˆè®¢å•ï¼Œå›æ»šåº“å­˜...&quot;</span>);</span><br><span class="line">            <span class="comment">//3. æ‰‹åŠ¨ç­¾æ”¶</span></span><br><span class="line">            channel.basicAck(deliveryTag, <span class="literal">true</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">/***</span></span><br><span class="line"><span class="comment">             * ç¬¬ä¸‰ä¸ªå‚æ•°requeueï¼šé‡å›é˜Ÿåˆ—ã€‚å¦‚æœè®¾ç½®ä¸ºtrue,åˆ™é‡å›queueï¼Œbrokerä¼šé‡æ–°å‘é€è¯¥æ¶ˆæ¯ç»™æ¶ˆè´¹ç«¯</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            System.out.println(<span class="string">&quot;å‡ºç°å¼‚å¸¸ï¼Œæ‹’ç»æ¥å—&quot;</span>);</span><br><span class="line">            <span class="comment">//4. æ‹’ç»ç­¾æ”¶ï¼Œä¸é‡å›é˜Ÿåˆ—ï¼Œrequeue=false</span></span><br><span class="line">            channel.basicNack(deliveryTag, <span class="literal">true</span>, <span class="literal">true</span>);</span><br><span class="line">            <span class="comment">//channel.basicReject(deliveryTag, true);</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ•ˆæœï¼š10ç§’åç›‘å¬æ­»ä¿¡é˜Ÿåˆ—çš„ç›‘å¬å™¨å“åº”ã€‚</p><h4 id="å»¶è¿Ÿé˜Ÿåˆ—å°ç»“"><a href="#å»¶è¿Ÿé˜Ÿåˆ—å°ç»“" class="headerlink" title="å»¶è¿Ÿé˜Ÿåˆ—å°ç»“"></a>å»¶è¿Ÿé˜Ÿåˆ—å°ç»“</h4><ol><li><p>å»¶è¿Ÿé˜Ÿåˆ— æŒ‡æ¶ˆæ¯è¿›å…¥é˜Ÿåˆ—åï¼Œå¯ä»¥è¢«å»¶è¿Ÿä¸€å®šæ—¶é—´ï¼Œå†è¿›è¡Œæ¶ˆè´¹ã€‚</p></li><li><p>RabbitMQæ²¡æœ‰æä¾›å»¶è¿Ÿé˜Ÿåˆ—åŠŸèƒ½ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨ ï¼š TTL + DLX æ¥å®ç°å»¶è¿Ÿé˜Ÿåˆ—æ•ˆæœã€‚</p></li></ol><h3 id="æ—¥å¿—ä¸ç›‘æ§"><a href="#æ—¥å¿—ä¸ç›‘æ§" class="headerlink" title="æ—¥å¿—ä¸ç›‘æ§"></a>æ—¥å¿—ä¸ç›‘æ§</h3><h4 id="RabbitMQæ—¥å¿—"><a href="#RabbitMQæ—¥å¿—" class="headerlink" title="RabbitMQæ—¥å¿—"></a>RabbitMQæ—¥å¿—</h4><p>RabbitMQé»˜è®¤æ—¥å¿—å­˜æ”¾è·¯å¾„ï¼š &#x2F;var&#x2F;log&#x2F;rabbitmq&#x2F;<a href="mailto:&#114;&#97;&#x62;&#98;&#x69;&#x74;&#64;&#x78;&#x78;&#120;&#x2e;&#108;&#111;&#x67;">&#114;&#97;&#x62;&#98;&#x69;&#x74;&#64;&#x78;&#x78;&#120;&#x2e;&#108;&#111;&#x67;</a></p><p>æ—¥å¿—åŒ…å«äº†RabbitMQçš„ç‰ˆæœ¬å·ã€Erlangçš„ç‰ˆæœ¬å·ã€RabbitMQæœåŠ¡èŠ‚ç‚¹åç§°ã€cookieçš„hashå€¼ã€RabbitMQé…ç½®æ–‡ä»¶åœ°å€ã€å†…å­˜é™åˆ¶ã€ç£ç›˜é™åˆ¶ã€é»˜è®¤è´¦æˆ·guestçš„åˆ›å»ºä»¥åŠæƒé™é…ç½®ç­‰ç­‰ã€‚</p><h4 id="webç®¡æ§å°ç›‘æ§"><a href="#webç®¡æ§å°ç›‘æ§" class="headerlink" title="webç®¡æ§å°ç›‘æ§"></a>webç®¡æ§å°ç›‘æ§</h4><h4 id="rabbitmqctlç®¡ç†å’Œç›‘æ§"><a href="#rabbitmqctlç®¡ç†å’Œç›‘æ§" class="headerlink" title="rabbitmqctlç®¡ç†å’Œç›‘æ§"></a>rabbitmqctlç®¡ç†å’Œç›‘æ§</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥çœ‹é˜Ÿåˆ—</span><br><span class="line"># rabbitmqctl list_queues</span><br><span class="line">æŸ¥çœ‹exchanges</span><br><span class="line"># rabbitmqctl list_exchanges</span><br><span class="line">æŸ¥çœ‹ç”¨æˆ·</span><br><span class="line"># rabbitmqctl list_users</span><br><span class="line">æŸ¥çœ‹è¿æ¥</span><br><span class="line"># rabbitmqctl list_connections</span><br><span class="line">æŸ¥çœ‹æ¶ˆè´¹è€…ä¿¡æ¯</span><br><span class="line"># rabbitmqctl list_consumers</span><br><span class="line">æŸ¥çœ‹ç¯å¢ƒå˜é‡</span><br><span class="line"># rabbitmqctl environment</span><br><span class="line">æŸ¥çœ‹æœªè¢«ç¡®è®¤çš„é˜Ÿåˆ—</span><br><span class="line"># rabbitmqctl list_queues name messages_unacknowledged</span><br><span class="line">æŸ¥çœ‹å•ä¸ªé˜Ÿåˆ—çš„å†…å­˜ä½¿ç”¨</span><br><span class="line"># rabbitmqctl list_queues name memory</span><br><span class="line">æŸ¥çœ‹å‡†å¤‡å°±ç»ªçš„é˜Ÿåˆ—</span><br><span class="line"># rabbitmqctl list_queues name messages_ready</span><br></pre></td></tr></table></figure><h3 id="æ¶ˆæ¯è¿½è¸ª"><a href="#æ¶ˆæ¯è¿½è¸ª" class="headerlink" title="æ¶ˆæ¯è¿½è¸ª"></a>æ¶ˆæ¯è¿½è¸ª</h3><p>åœ¨ä½¿ç”¨ä»»ä½•æ¶ˆæ¯ä¸­é—´ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œéš¾å…ä¼šå‡ºç°æŸæ¡æ¶ˆæ¯å¼‚å¸¸ä¸¢å¤±çš„æƒ…å†µã€‚å¯¹äºRabbitMQè€Œè¨€ï¼Œå¯èƒ½æ˜¯å› ä¸ºç”Ÿäº§è€…æˆ–æ¶ˆè´¹è€…ä¸RabbitMQæ–­å¼€äº†è¿æ¥ï¼Œè€Œå®ƒä»¬ä¸RabbitMQåˆé‡‡ç”¨äº†ä¸åŒçš„ç¡®è®¤æœºåˆ¶ï¼›ä¹Ÿæœ‰å¯èƒ½æ˜¯å› ä¸ºäº¤æ¢å™¨ä¸é˜Ÿåˆ—ä¹‹é—´ä¸åŒçš„è½¬å‘ç­–ç•¥ï¼›ç”šè‡³æ˜¯äº¤æ¢å™¨å¹¶æ²¡æœ‰ä¸ä»»ä½•é˜Ÿåˆ—è¿›è¡Œç»‘å®šï¼Œç”Ÿäº§è€…åˆä¸æ„ŸçŸ¥æˆ–è€…æ²¡æœ‰é‡‡å–ç›¸åº”çš„æªæ–½ï¼›å¦å¤–RabbitMQæœ¬èº«çš„é›†ç¾¤ç­–ç•¥ä¹Ÿå¯èƒ½å¯¼è‡´æ¶ˆæ¯çš„ä¸¢å¤±ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦æœ‰ä¸€ä¸ªè¾ƒå¥½çš„æœºåˆ¶è·Ÿè¸ªè®°å½•æ¶ˆæ¯çš„æŠ•é€’è¿‡ç¨‹ï¼Œä»¥æ­¤ååŠ©å¼€å‘å’Œè¿ç»´äººå‘˜è¿›è¡Œé—®é¢˜çš„å®šä½ã€‚</p><p>åœ¨RabbitMQä¸­å¯ä»¥ä½¿ç”¨Firehoseå’Œrabbitmq_tracingæ’ä»¶åŠŸèƒ½æ¥å®ç°æ¶ˆæ¯è¿½è¸ªã€‚</p><h4 id="æ¶ˆæ¯è¿½è¸ª-Firehose"><a href="#æ¶ˆæ¯è¿½è¸ª-Firehose" class="headerlink" title="æ¶ˆæ¯è¿½è¸ª-Firehose"></a>æ¶ˆæ¯è¿½è¸ª-Firehose</h4><p>firehoseçš„æœºåˆ¶æ˜¯å°†ç”Ÿäº§è€…æŠ•é€’ç»™rabbitmqçš„æ¶ˆæ¯ï¼ŒrabbitmqæŠ•é€’ç»™æ¶ˆè´¹è€…çš„æ¶ˆæ¯æŒ‰ç…§æŒ‡å®šçš„æ ¼å¼å‘é€åˆ°é»˜è®¤çš„exchangeä¸Šã€‚è¿™ä¸ªé»˜è®¤çš„exchangeçš„åç§°ä¸ºamq.rabbitmq.traceï¼Œå®ƒæ˜¯ä¸€ä¸ªtopicç±»å‹çš„exchangeã€‚å‘é€åˆ°è¿™ä¸ªexchangeä¸Šçš„æ¶ˆæ¯çš„routing keyä¸º publish.exchangename å’Œdeliver.queuenameã€‚å…¶ä¸­exchangenameå’Œqueuenameä¸ºå®é™…exchangeå’Œqueueçš„åç§°ï¼Œåˆ†åˆ«å¯¹åº”ç”Ÿäº§è€…æŠ•é€’åˆ°exchangeçš„æ¶ˆæ¯ï¼Œå’Œæ¶ˆè´¹è€…ä»queueä¸Šè·å–çš„æ¶ˆæ¯ã€‚</p><p>æ³¨æ„ï¼šæ‰“å¼€ trace ä¼šå½±å“æ¶ˆæ¯å†™å…¥åŠŸèƒ½ï¼Œé€‚å½“æ‰“å¼€åè¯·å…³é—­ã€‚</p><p>rabbitmqctl trace_onï¼šå¼€å¯Firehoseå‘½ä»¤</p><p>rabbitmqctl trace_offï¼šå…³é—­Firehoseå‘½ä»¤</p><p>æŒ‡å®šè™šæ‹Ÿæœºå¼€å¯ï¼šrabbitmqctl trace_on -p &#x2F;itcast</p><h4 id="æ¶ˆæ¯è¿½è¸ª-rabbitmq-tracing"><a href="#æ¶ˆæ¯è¿½è¸ª-rabbitmq-tracing" class="headerlink" title="æ¶ˆæ¯è¿½è¸ª-rabbitmq_tracing"></a>æ¶ˆæ¯è¿½è¸ª-rabbitmq_tracing</h4><p>rabbitmq_tracingå’ŒFirehoseåœ¨å®ç°ä¸Šå¦‚å‡ºä¸€è¾™ï¼Œåªä¸è¿‡rabbitmq_tracingçš„æ–¹å¼æ¯”Firehoseå¤šäº†ä¸€å±‚GUIçš„åŒ…è£…ï¼Œæ›´å®¹æ˜“ä½¿ç”¨å’Œç®¡ç†ã€‚</p><p>å¯ç”¨æ’ä»¶ï¼šrabbitmq-plugins enable rabbitmq_tracing</p><p>å…³é—­æ’ä»¶ï¼šrabbitmq-plugins disable rabbitmq_tracing</p><h2 id="Rabbit-MQåº”ç”¨é—®é¢˜"><a href="#Rabbit-MQåº”ç”¨é—®é¢˜" class="headerlink" title="Rabbit MQåº”ç”¨é—®é¢˜"></a>Rabbit MQåº”ç”¨é—®é¢˜</h2><h3 id="æ¶ˆæ¯å¯é æ€§ä¿éšœ"><a href="#æ¶ˆæ¯å¯é æ€§ä¿éšœ" class="headerlink" title="æ¶ˆæ¯å¯é æ€§ä¿éšœ"></a><strong>æ¶ˆæ¯å¯é æ€§ä¿éšœ</strong></h3><p>éœ€æ±‚ï¼š</p><p>100%ç¡®ä¿æ¶ˆæ¯å‘é€æˆåŠŸ</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210191246843.png" alt="image-20221019124645756"></p><h3 id="æ¶ˆæ¯å¹‚ç­‰æ€§ä¿éšœ"><a href="#æ¶ˆæ¯å¹‚ç­‰æ€§ä¿éšœ" class="headerlink" title="æ¶ˆæ¯å¹‚ç­‰æ€§ä¿éšœ"></a><strong>æ¶ˆæ¯å¹‚ç­‰æ€§ä¿éšœ</strong></h3><p>å¹‚ç­‰æ€§æŒ‡ä¸€æ¬¡å’Œå¤šæ¬¡è¯·æ±‚æŸä¸€ä¸ªèµ„æºï¼Œå¯¹äºèµ„æºæœ¬èº«åº”è¯¥å…·æœ‰åŒæ ·çš„ç»“æœã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶ä»»æ„å¤šæ¬¡æ‰§è¡Œå¯¹èµ„æºæœ¬èº«æ‰€äº§ç”Ÿçš„å½±å“å‡ä¸ä¸€æ¬¡æ‰§è¡Œçš„å½±å“ç›¸åŒã€‚</p><p>åœ¨MQä¸­æŒ‡ï¼Œæ¶ˆè´¹å¤šæ¡ç›¸åŒçš„æ¶ˆæ¯ï¼Œå¾—åˆ°ä¸æ¶ˆè´¹è¯¥æ¶ˆæ¯ä¸€æ¬¡ç›¸åŒçš„ç»“æœ</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210191256721.png" alt="image-20221019125631634"></p><h2 id="Rabbit-MQé›†ç¾¤æ­å»º"><a href="#Rabbit-MQé›†ç¾¤æ­å»º" class="headerlink" title="Rabbit MQé›†ç¾¤æ­å»º"></a>Rabbit MQé›†ç¾¤æ­å»º</h2><h2 id="Spring-Booté…ç½®Rabbit-MQ"><a href="#Spring-Booté…ç½®Rabbit-MQ" class="headerlink" title="Spring Booté…ç½®Rabbit MQ"></a>Spring Booté…ç½®Rabbit MQ</h2><ol><li>å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®å±æ€§ï¼ˆå…¨å±€ï¼‰</li><li>åœ¨@RabbitListeneré…ç½®contanierFactoryå±æ€§</li></ol><p>inuxç³»ç»Ÿï¼šcentos7<br>1.å¯åŠ¨å‰ï¼ŒæŸ¥çœ‹mqçŠ¶æ€</p><p>systemctl status rabbitmq-server<br>2.å¯åŠ¨</p><p>systemctl start rabbitmq-server<br>3.åœæ­¢</p><p>systemctl stop rabbitmq-server<br>4.é‡å¯</p><p>restart<br>5.æ‰“å¼€æµè§ˆå™¨ç®¡ç†é¡µé¢ï¼šé»˜è®¤ç«¯å£å·15672</p><p>systemctl status firewalld<br>&#x2F;&#x2F;å…³é—­é˜²ç«å¢™<br>systemctl disable firewalld<br>systemctl stop firewalld<br>6.ç™»é™†<br>ç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯guest</p><p>7.æ’ä»¶ç®¡ç†ç›¸å…³å‘½ä»¤</p><p>rabbitmq-plugins enable|list|disable</p>]]></content>
      
      
      <categories>
          
          <category> ä¸­é—´ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¶ˆæ¯é˜Ÿåˆ— </tag>
            
            <tag> Rabbit MQ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ“ä½œç³»ç»Ÿ</title>
      <link href="/2022/11/20/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
      <url>/2022/11/20/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<h1 id="æ“ä½œç³»ç»Ÿ"><a href="#æ“ä½œç³»ç»Ÿ" class="headerlink" title="æ“ä½œç³»ç»Ÿ"></a>æ“ä½œç³»ç»Ÿ</h1><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><h3 id="ä»€ä¹ˆæ˜¯æ“ä½œç³»ç»Ÿ"><a href="#ä»€ä¹ˆæ˜¯æ“ä½œç³»ç»Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯æ“ä½œç³»ç»Ÿ"></a>ä»€ä¹ˆæ˜¯æ“ä½œç³»ç»Ÿ</h3><p>ç»™ç”¨æˆ·æä¾›æœåŠ¡ã€å¯¹ç¨‹åºè¿›è¡Œç®¡ç†ã€å¯¹èµ„æºè¿›è¡Œåˆ†é…ã€‚</p><ul><li>æ“ä½œç³»ç»Ÿæ˜¯ä¸€ä¸ªæ§åˆ¶è½¯ä»¶ï¼Œç®¡ç†åº”ç”¨ç¨‹åº</li><li>æ“ä½œç³»ç»Ÿä¸ºåº”ç”¨ç¨‹åºæä¾›æœåŠ¡ï¼Œæ€æ­»åº”ç”¨ç¨‹åº</li><li>æ“ä½œç³»ç»Ÿè¿›è¡Œèµ„æºç®¡ç†ï¼Œç®¡ç†å¤–è®¾ã€åˆ†é…èµ„æº</li></ul><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210161917251.png" alt="image-20221016191756140" style="zoom: 50%;" /><h4 id="æ“ä½œç³»ç»Ÿçš„æ¶å±‚æ¬¡ç»“æ„"><a href="#æ“ä½œç³»ç»Ÿçš„æ¶å±‚æ¬¡ç»“æ„" class="headerlink" title="æ“ä½œç³»ç»Ÿçš„æ¶å±‚æ¬¡ç»“æ„"></a>æ“ä½œç³»ç»Ÿçš„æ¶å±‚æ¬¡ç»“æ„</h4><blockquote><p>ç¡¬ä»¶ä¹‹ä¸Šï¼Œåº”ç”¨ç¨‹åºä¹‹ä¸‹ã€‚å¤„äºä¸­é—´ä½ç½®</p></blockquote><p>æ“ä½œç³»ç»Ÿä½äºåº”ç”¨è½¯ä»¶ä¹‹ä¸‹ï¼Œä¸ºåº”ç”¨è½¯ä»¶æä¾›æœåŠ¡æ”¯æ’‘ã€‚</p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210161922006.png" alt="image-20221016192204876" style="zoom: 50%;" /><p>æ“ä½œç³»ç»Ÿç»™å¤–éƒ¨æä¾›çš„æœåŠ¡shell</p><h4 id="æ“ä½œç³»ç»Ÿçš„åŠŸèƒ½"><a href="#æ“ä½œç³»ç»Ÿçš„åŠŸèƒ½" class="headerlink" title="æ“ä½œç³»ç»Ÿçš„åŠŸèƒ½"></a>æ“ä½œç³»ç»Ÿçš„åŠŸèƒ½</h4><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210161927344.png" alt="image-20221016192700234" style="zoom:50%;" /><ol><li>CPUçš„è°ƒåº¦</li><li>ç‰©ç†å†…å­˜çš„ç®¡ç†</li><li>è™šæ‹Ÿå†…å­˜çš„ç®¡ç†</li><li>æ–‡ä»¶ç³»ç»Ÿçš„ç®¡ç†</li><li>ä¸­æ–­å¤„ç†å’Œè®¾å¤‡é©±åŠ¨</li></ol><h4 id="æ“ä½œç³»ç»Ÿçš„ç‰¹å¾"><a href="#æ“ä½œç³»ç»Ÿçš„ç‰¹å¾" class="headerlink" title="æ“ä½œç³»ç»Ÿçš„ç‰¹å¾"></a>æ“ä½œç³»ç»Ÿçš„ç‰¹å¾</h4><ol><li><p>å¹¶å‘</p><p>è®¡ç®—æœºç³»ç»Ÿä¸­åŒæ—¶å­˜åœ¨å¤šä¸ªè¿è¡Œçš„ç¨‹åºï¼Œéœ€è¦OSç®¡ç†å’Œè°ƒåº¦</p><p><code>å¹¶å‘å’Œå¹¶è¡Œçš„åŒºåˆ«</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å¹¶å‘ï¼šåœ¨ä¸€æ®µæ—¶é—´å†…ï¼Œæœ‰å¤šä¸ªç¨‹åºå¯ä»¥è¿è¡Œã€‚</span><br><span class="line">å¹¶è¡Œï¼šåœ¨ä¸€ä¸ªæ—¶é—´ç‚¹ä¸Šï¼Œæœ‰å¤šä¸ªç¨‹åºå¯ä»¥è¿è¡Œã€‚</span><br><span class="line">å¹¶è¡Œä¸€èˆ¬è¦æ±‚è®¡ç®—æœºç³»ç»Ÿå­˜åœ¨å¤šä¸ªCPUï¼Œè¿™æ ·æ‰èƒ½ä½¿OSåœ¨ä¸€ä¸ªæ—¶é—´åŒæ—¶æ‰§è¡Œå¤šä¸ªç¨‹åºã€‚åªæœ‰ä¸€ä¸ªCPUï¼Œåˆ™ä¸èƒ½å¹¶è¡Œã€‚</span><br></pre></td></tr></table></figure></li><li><p>å…±äº«</p><ul><li>â€åŒæ—¶â€œè®¿é—®</li><li>äº’æ–¥è®¿é—®</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">äº’æ–¥è®¿é—®ï¼šå¯¹äºåŒä¸€ä¸ªå†…å­˜ç©ºé—´ï¼ŒåŒä¸€ä¸ªæ—¶é—´ç‚¹åªæœ‰ä¸€ä¸ªç¨‹åºèƒ½å¤Ÿè®¿é—®ã€‚</span><br><span class="line">åŒæ—¶è®¿é—®ï¼šä¸€ä¸ªç¨‹åºå¯ä»¥åœ¨åŒä¸€ä¸ªæ—¶é—´ç‚¹è®¿é—®å¤šå—ä¸åŒçš„å†…å­˜ã€‚</span><br></pre></td></tr></table></figure></li><li><p>è™šæ‹Ÿ</p><ul><li>åˆ©ç”¨å¤šé“ç¨‹åºè®¾è®¡ï¼Œè®©æ¯ä¸ªç”¨æˆ·éƒ½è§‰å¾—æœ‰ä¸€ä¸ªè®¡ç®—æœºä¸“é—¨ä¸ºä»–æœåŠ¡</li></ul></li><li><p>å¼‚æ­¥</p><ul><li>ç¨‹åºæ‰§è¡Œä¸æ˜¯ä¸€è´¯åˆ°åº•ï¼Œè€Œæ˜¯èµ°èµ°åœåœï¼Œå‘å‰æ¨è¿›çš„é€Ÿåº¦ä¸å¯é¢„çŸ¥</li><li>ä½†åªè¦è¿è¡Œç¯å¢ƒç›¸åŒï¼ŒOSéœ€è¦ä¿è¯ç¨‹åºè¿è¡Œçš„ç»“æœä¹Ÿè¦ç›¸åŒ</li></ul></li></ol><h3 id="ä¸ºä»€ä¹ˆå­¦ä¹ æ“ä½œç³»ç»Ÿ"><a href="#ä¸ºä»€ä¹ˆå­¦ä¹ æ“ä½œç³»ç»Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆå­¦ä¹ æ“ä½œç³»ç»Ÿ"></a>ä¸ºä»€ä¹ˆå­¦ä¹ æ“ä½œç³»ç»Ÿ</h3><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210161958530.png" alt="image-20221016195802432"></p><h4 id="æ“ä½œç³»ç»Ÿéœ€è¦æƒè¡¡"><a href="#æ“ä½œç³»ç»Ÿéœ€è¦æƒè¡¡" class="headerlink" title="æ“ä½œç³»ç»Ÿéœ€è¦æƒè¡¡"></a>æ“ä½œç³»ç»Ÿéœ€è¦æƒè¡¡</h4><ul><li>ç©ºé—´å’Œæ—¶é—´</li><li>æ€§èƒ½å’Œå¯é¢„æµ‹æ€§</li><li>å…¬å¹³å’Œæ€§èƒ½</li></ul><h3 id="æ“ä½œç³»ç»Ÿå®ä¾‹"><a href="#æ“ä½œç³»ç»Ÿå®ä¾‹" class="headerlink" title="æ“ä½œç³»ç»Ÿå®ä¾‹"></a>æ“ä½œç³»ç»Ÿå®ä¾‹</h3><ul><li>UNIX</li><li>LINUX</li><li>WINDOWS</li></ul><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210162009726.png" alt="image-20221016200900650"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210162010103.png" alt="image-20221016201051018"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210162011766.png" alt="image-20221016201153666"></p><h3 id="æ“ä½œç³»ç»Ÿçš„å‘å±•"><a href="#æ“ä½œç³»ç»Ÿçš„å‘å±•" class="headerlink" title="æ“ä½œç³»ç»Ÿçš„å‘å±•"></a>æ“ä½œç³»ç»Ÿçš„å‘å±•</h3><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210162013743.png" alt="image-20221016201341616"></p><ol><li>çº¸å¸¦æœºï¼ˆç›‘è§†å™¨ï¼‰</li></ol><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210162014261.png" alt="image-20221016201450137"></p><ol start="2"><li>CPUç­‰ç¡¬ä»¶å¿«é€Ÿå‘å±•ï¼Œè®¡ç®—æœºé€Ÿåº¦æå‡ï¼Œæ€§èƒ½æœªå¾—åˆ°å……åˆ†åˆ©ç”¨ã€‚</li></ol><p>æµæ°´çº¿ç¨‹åºè®¾è®¡</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210162016585.png" alt="image-20221016201617502"></p><ol start="3"><li>å†…å­˜å®¹é‡è¶Šæ¥è¶Šå¤§ï¼ŒCPUæ‰§è¡Œå¤šä¸ªç¨‹åºã€‚</li></ol><p>å¤šé“ç¨‹åºè®¾è®¡ï¼Œcpuåœ¨IOæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ‰§è¡Œå…¶ä»–çš„ç¨‹åºã€‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210162017166.png" alt="image-20221016201704115"></p><p>å¤šé“ç¨‹åºè®¾è®¡æé«˜äº†CPUçš„åˆ©ç”¨æ•ˆç‡ï¼Œä½†æ˜¯äº¤äº’æ€§ä¸å¥½ã€‚</p><ol start="4"><li>ä¸ºäº†æ›´å¥½çš„åˆ©ç”¨è®¡ç®—æœºèµ„æºï¼Œå¹¶ä¸”æ›´å¥½çš„å’Œç”¨æˆ·è¿›è¡Œäº¤äº’ï¼Œå‡ºç°äº†åˆ†æ—¶ç³»ç»Ÿã€‚</li></ol><p>CPUå°†æ—¶é—´ç‰‡åˆ†ä¸º1&#x2F;1000Sï¼Œ1&#x2F;1000æ‰§è¡Œç¨‹åº1ï¼Œä¹‹åæ‰§è¡Œç¨‹åº2ï¼Œå†æ¥å›åˆ‡æ¢ã€‚</p><ol start="5"><li><p>ä¸ªäººç”µè„‘æ“ä½œç³»ç»ŸPC</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210162026243.png" alt="image-20221016202656160"></p></li><li><p>ç½‘ç»œçš„å¿«é€Ÿå‘å±•ï¼Œå‡ºç°äº†åˆ†å¸ƒå¼çš„æ“ä½œç³»ç»Ÿ</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210162028707.png" alt="image-20221016202830643"></p></li><li><p>äº‘è®¡ç®—</p><p>äººçš„å‘¨å›´å‡ºç°å¤§é‡åµŒå…¥å¼ç³»ç»Ÿï¼Œç»™äººä¸ªæ€§åŒ–æœåŠ¡ã€‚</p></li></ol><h3 id="æ“ä½œç³»ç»Ÿçš„ç»“æ„"><a href="#æ“ä½œç³»ç»Ÿçš„ç»“æ„" class="headerlink" title="æ“ä½œç³»ç»Ÿçš„ç»“æ„"></a>æ“ä½œç³»ç»Ÿçš„ç»“æ„</h3><p>å¾®å†…æ ¸çš„è®¾è®¡ï¼Œå°½å¯èƒ½æŠŠå†…æ ¸åŠŸèƒ½ç†™ä¸œåˆ°ç”¨æˆ·ç©ºé—´</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210162038032.png" alt="image-20221016203805979"></p><p>VMM</p><p>ä½äºæ“ä½œç³»ç»Ÿä¹‹ä¸‹ï¼Œè®©OSè§‰å¾—è‡ªå·±ç›´æ¥åœ¨æ“çºµç¡¬ä»¶ã€‚ï¼ˆè™šæ‹ŸåŒ–ï¼‰</p><p>å……åˆ†å‘æŒ¥ç¡¬ä»¶èµ„æºï¼Œé˜²æ­¢èµ„æºè¿‡å‰©ã€‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210162040832.png" alt="image-20221016204023743"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210162041321.png" alt="image-20221016204103221"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210162041559.png" alt="image-20221016204115441"></p><h2 id="æ“ä½œç³»ç»Ÿçš„åŸºæœ¬æ“ä½œ"><a href="#æ“ä½œç³»ç»Ÿçš„åŸºæœ¬æ“ä½œ" class="headerlink" title="æ“ä½œç³»ç»Ÿçš„åŸºæœ¬æ“ä½œ"></a>æ“ä½œç³»ç»Ÿçš„åŸºæœ¬æ“ä½œ</h2><h3 id="å¯åŠ¨ã€ä¸­æ–­ã€å¼‚å¸¸å’Œç³»ç»Ÿè°ƒç”¨"><a href="#å¯åŠ¨ã€ä¸­æ–­ã€å¼‚å¸¸å’Œç³»ç»Ÿè°ƒç”¨" class="headerlink" title="å¯åŠ¨ã€ä¸­æ–­ã€å¼‚å¸¸å’Œç³»ç»Ÿè°ƒç”¨"></a>å¯åŠ¨ã€ä¸­æ–­ã€å¼‚å¸¸å’Œç³»ç»Ÿè°ƒç”¨</h3><h4 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h4><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171640102.png" alt="image-20221017164000023" style="zoom:50%;" /><p>DISK:å­˜æ”¾OS</p><p>BIOS:åŸºæœ¬çš„I&#x2F;Oå¤„ç†ç³»ç»Ÿ</p><p>Bootloader:åŠ è½½OS</p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171641326.png" alt="image-20221017164154259" style="zoom:50%;" /><p>POSTï¼ˆåŠ ç”µè‡ªæ£€ï¼‰ï¼šå¯»æ‰¾æ˜¾å¡å’Œæ‰§è¡ŒBIOS</p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171646179.png" alt="image-20221017164622111" style="zoom: 80%;" /><h4 id="ä¸­æ–­ã€å¼‚å¸¸å’Œç³»ç»Ÿè°ƒç”¨"><a href="#ä¸­æ–­ã€å¼‚å¸¸å’Œç³»ç»Ÿè°ƒç”¨" class="headerlink" title="ä¸­æ–­ã€å¼‚å¸¸å’Œç³»ç»Ÿè°ƒç”¨"></a>ä¸­æ–­ã€å¼‚å¸¸å’Œç³»ç»Ÿè°ƒç”¨</h4><p>æ“ä½œç³»ç»Ÿæ€æ ·ç®¡ç†å¤–è®¾ï¼Œæ€ä¹ˆç»™åº”ç”¨ç¨‹åºæä¾›æœåŠ¡?</p><ul><li><p>ç³»ç»Ÿè°ƒç”¨ï¼ˆæ¥æºäºåº”ç”¨ç¨‹åºï¼‰ï¼šç³»ç»Ÿç¨‹åºä¸»åŠ¨å‘æ“ä½œç³»ç»Ÿå‘å‡ºæœåŠ¡è¯·æ±‚ã€‚</p></li><li><p>å¼‚å¸¸ï¼ˆæ¥æºäºä¸è‰¯çš„åº”ç”¨ç¨‹åºï¼‰ï¼šéæ³•æŒ‡ä»¤æˆ–è€…å…¶ä»–åçš„å¤„ç†çŠ¶æ€ï¼ˆå¦‚ï¼šå†…å­˜å‡ºé”™ï¼‰</p></li><li><p>ä¸­æ–­ï¼ˆæ¥æºäºå¤–è®¾ï¼‰ï¼šæ¥è‡ªä¸åŒçš„ç¡¬ä»¶è®¾å¤‡çš„è®¡æ—¶å™¨å’Œç½‘ç»œä¸­æ–­</p></li></ul><p>ä¸ºä»€ä¹ˆåº”ç”¨ç¨‹åºè¦é€šè¿‡æ“ä½œç³»ç»Ÿæ¥ç®¡ç†ç¡¬ä»¶ï¼Ÿ</p><ul><li>æ“ä½œç³»ç»Ÿæ˜¯ä¸€ç§ç‰¹æ®Šçš„è½¯ä»¶ï¼Œåœ¨è®¡ç®—æœºè¿è¡Œä¸­ï¼Œå†…æ ¸æ˜¯è¢«ä¿¡ä»»çš„ç¬¬ä¸‰æ–¹ï¼Œè®¡ç®—æœºè®¤ä¸ºæ“ä½œç³»ç»Ÿæ˜¯å®‰å…¨çš„ï¼Œè€Œè½¯ä»¶å¹¶ä¸éƒ½æ˜¯å®‰å…¨çš„ã€‚</li><li>å› æ­¤ï¼Œåªæœ‰å†…æ ¸å¯ä»¥æ‰§è¡Œç‰¹æƒå‘½ä»¤ã€‚</li><li>æŠŠè®¡ç®—æœºçš„ç¡¬ä»¶èµ„æºå…¨éƒ¨äº¤ç»™æ“ä½œç³»ç»Ÿè¿›è¡Œç®¡ç†ï¼Œæœ‰åˆ©äºè½¯ä»¶è®¾è®¡æ—¶ä¾¿æ·ï¼Œè½¯ä»¶çš„å¯ç§»æ¤æ€§è¾ƒé«˜ã€‚</li></ul><p>æ“ä½œç³»ç»Ÿå¦‚ä½•å®ç°ä¸­æ–­ã€å¼‚å¸¸å’Œç³»ç»Ÿè°ƒç”¨ï¼Ÿ</p><p>è¿™ä¸‰è€…æœ‰ä»€ä¹ˆè”ç³»å’Œå·®å¼‚ï¼Ÿ</p><p>æºå¤´ï¼š</p><ul><li>ä¸­æ–­ï¼šå¤–è®¾</li><li>å¼‚å¸¸ï¼šåº”ç”¨ç¨‹åºæ„æƒ³ä¸åˆ°çš„è¡Œä¸º</li><li>ç³»ç»Ÿè°ƒç”¨ï¼šåº”ç”¨ç¨‹åºè¯·æ±‚æ“ä½œæä¾›æœåŠ¡ï¼ˆä¸»åŠ¨çš„ï¼‰</li></ul><p>å¤„ç†æ—¶é—´ï¼š</p><ul><li><p>ä¸­æ–­ï¼šå¼‚æ­¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">  å¼‚æ­¥æ—¶é—´ï¼šå½“ä¸­æ–­äº§ç”Ÿæ—¶ï¼Œåº”ç”¨ç¨‹åºå¹¶ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™äº§ç”Ÿçš„</span><br><span class="line"></span><br><span class="line">- å¼‚å¸¸ï¼šåŒæ­¥</span><br><span class="line"></span><br><span class="line">- ç³»ç»Ÿè°ƒç”¨ï¼šå¼‚æ­¥æˆ–åŒæ­¥</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç³»ç»Ÿè°ƒç”¨å‘å‡ºè¯·æ±‚æ—¶ï¼Œè¿”å›çš„æ—¶é—´å¯èƒ½æ˜¯å¼‚æ­¥çš„ï¼Œå½“ç³»ç»Ÿè°ƒç”¨å‘é€è¯·æ±‚åï¼Œå¦‚æœæ‰§è¡Œå…¶ä»–ç¨‹åºï¼Œåˆ™è¿”å›æ•°æ®æ˜¯å¼‚æ­¥çš„ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">å“åº”ï¼š</span><br><span class="line"></span><br><span class="line">- ä¸­æ–­ï¼šæŒç»­ï¼Œå¯¹ç”¨æˆ·åº”ç”¨ç¨‹åºæ˜¯é€æ˜çš„ï¼ˆåº”ç”¨ç¨‹åºä¸çŸ¥é“æœ‰æ²¡æœ‰å‘ç”Ÿä¸­æ–­ï¼‰ã€‚</span><br><span class="line">- å¼‚å¸¸ï¼šæ€æ­»æˆ–è€…é‡æ–°æ‰§è¡Œæ„æƒ³ä¸åˆ°çš„åº”ç”¨ç¨‹åºæŒ‡ä»¤ã€‚</span><br><span class="line">- ç³»ç»Ÿè°ƒç”¨ï¼šç­‰å¾…å’ŒæŒç»­ã€‚</span><br><span class="line"></span><br><span class="line">##### ä¸­æ–­çš„å¤„ç†è¿‡ç¨‹</span><br><span class="line"></span><br><span class="line">ç¡¬ä»¶ï¼š</span><br><span class="line"></span><br><span class="line">1. å°†å†…éƒ¨ã€å¤–éƒ¨äº‹ä»¶è®¾ç½®ä¸­æ–­æ ‡è®°</span><br><span class="line">2. ä¸­æ–­äº‹ä»¶çš„ID</span><br><span class="line"></span><br><span class="line">ç¡¬ä»¶ï¼š</span><br><span class="line"></span><br><span class="line">1. ä¿å­˜å½“å‰çŠ¶æ€</span><br><span class="line">2. ä¸­æ–­æœåŠ¡ç¨‹åºå¤„ç†</span><br><span class="line">3. æ¸…æ¥šä¸­æ–­æ ‡è®°</span><br><span class="line">4. æ¢å¤ä¹‹å‰ä¿å­˜çš„å¤„ç†çŠ¶æ€</span><br><span class="line"></span><br><span class="line">##### å¼‚å¸¸çš„å¤„ç†è¿‡ç¨‹</span><br><span class="line"></span><br><span class="line">å¼‚å¸¸ä¼šäº§ç”Ÿç›¸åº”çš„å¼‚å¸¸ç¼–å·:</span><br><span class="line"></span><br><span class="line">1. ä¿å­˜ç°åœº</span><br><span class="line">2. å¼‚å¸¸å¤„ç†</span><br><span class="line">   - æ€æ­»äº§ç”Ÿå¼‚å¸¸çš„ç¨‹åº</span><br><span class="line">   - é‡æ–°æ‰§è¡Œå¼‚å¸¸çš„æŒ‡ä»¤</span><br><span class="line">3. æ¢å¤ç°å¸¸</span><br><span class="line"></span><br><span class="line">##### ç³»ç»Ÿè°ƒç”¨çš„å¤„ç†</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171915550.png&quot; alt=&quot;image-20221017191542503&quot; style=&quot;zoom:50%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">ç¨‹åºè®¿é—®ä¸»è¦é€šè¿‡é«˜å±‚æ¬¡çš„APIæ¥å£è€Œä¸æ˜¯ç›´æ¥è¿›è¡Œç³»ç»Ÿè°ƒç”¨ã€‚</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171919724.png&quot; alt=&quot;image-20221017191919661&quot; style=&quot;zoom:50%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;https://gitee.com/messi-study-java/pic_go/raw/master/img/202210171920439.png&quot; alt=&quot;image-20221017192013385&quot; style=&quot;zoom:50%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">å½“åº”ç”¨ç¨‹åºè¿›è¡Œç³»ç»Ÿè°ƒç”¨æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šä»ç”¨æˆ·æ€åˆ°å†…æ ¸æ€çš„è½¬åŒ–ï¼Œæ“ä½œæƒä»åº”ç”¨ç¨‹åºè½¬ä¸ºæ“ä½œç³»ç»Ÿã€‚æ“ä½œç³»ç»Ÿå¯¹åº”ç”¨ç¨‹åºçš„ç³»ç»Ÿè°ƒç”¨çš„idå·è¿›è¡Œæ ‡è¯†ã€‚</span><br><span class="line"></span><br><span class="line">ç³»ç»Ÿè°ƒç”¨å’Œç¨‹åºè°ƒç”¨çš„åŒºåˆ«ï¼Ÿ</span><br><span class="line"></span><br><span class="line">ç¨‹åºè°ƒç”¨æ˜¯ä¸€ä¸ªæ ˆç©ºé—´å®Œæˆçš„</span><br><span class="line"></span><br><span class="line">ç³»ç»Ÿè°ƒç”¨ï¼Œåœ¨åº”ç”¨ç¨‹åºè°ƒç”¨ç³»ç»Ÿè°ƒç”¨æ—¶ä¼šåˆ‡æ¢å †æ ˆï¼Œè¿˜è¦å®Œæˆç”¨æˆ·æ€çš„è½¬æ¢ï¼Œå› æ­¤ç³»ç»Ÿè°ƒç”¨çš„å¼€é”€æ¯”è¾ƒå¤§ï¼Œä½†æ˜¯å®‰å…¨æ€§é«˜ã€‚</span><br><span class="line"></span><br><span class="line">##### è·¨è¶Šæ“ä½œç³»ç»Ÿè¾¹ç•Œçš„å¼€é”€</span><br><span class="line"></span><br><span class="line">- åœ¨æ‰§è¡Œæ—¶é—´ä¸Šçš„å¼€é”€è¶…è¿‡ç¨‹åºè°ƒç”¨</span><br><span class="line">- å¼€é”€ï¼š</span><br><span class="line">  - å»ºç«‹ä¸­æ–­ã€å¼‚å¸¸ã€ç³»ç»Ÿè°ƒç”¨å·ä¸å¯¹åº”æœåŠ¡ä¾‹ç¨‹æ˜ å°„å…³ç³»çš„åˆå§‹åŒ–å¼€é”€</span><br><span class="line">  - å»ºç«‹å†…æ ¸å †æ ˆ</span><br><span class="line">  - éªŒè¯å‚æ•°</span><br><span class="line">  - å†…æ ¸æ€æ˜ å°„åˆ°ç”¨æˆ·æ€çš„åœ°å€ç©ºé—´ï¼Œæ›´æ–°é¡µé¢æ˜ å°„æƒé™</span><br><span class="line">  - å†…æ ¸æ€ç‹¬ç«‹åœ°å€ç©ºé—´ TLB</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">&gt; æ“ä½œç³»ç»Ÿå¦‚ä½•ç®¡ç†ç‰©ç†å†…å­˜</span><br><span class="line"></span><br><span class="line">## è¿ç»­å†…å­˜åˆ†é…</span><br><span class="line"></span><br><span class="line">### è®¡ç®—æœºä½“ç³»ç»“æ„ã€å†…å­˜åˆ†å±‚ä½“ç³»</span><br><span class="line"></span><br><span class="line">![image-20221018211705744](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210182117488.png)</span><br><span class="line"></span><br><span class="line">å†…å­˜çš„å±‚æ¬¡ç»“æ„ï¼š</span><br><span class="line"></span><br><span class="line">![image-20221018211801644](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210182118723.png)</span><br><span class="line"></span><br><span class="line">é€šè¿‡æ“ä½œç³»ç»Ÿæ¥ç®¡ç†å†…å­˜ï¼Œè¾¾åˆ°ç¨³å®šå¿«é€Ÿã€‚</span><br><span class="line"></span><br><span class="line">![image-20221018212040398](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210182120477.png)</span><br><span class="line"></span><br><span class="line">æ“ä½œç³»ç»Ÿè¿˜èƒ½éš”ç¦»è¿›ç¨‹ä¹‹é—´çš„åœ°å€ç©ºé—´ï¼Œä¹Ÿèƒ½åœ¨è¿›ç¨‹é—´è¿›è¡Œä¿æŠ¤ã€‚</span><br><span class="line"></span><br><span class="line">1. æŠ½è±¡(å¯¹é€»è¾‘åœ°å€ç©ºé—´)</span><br><span class="line">2. ä¿æŠ¤(è¿›ç¨‹çš„ç‹¬ç«‹åœ°å€ç©ºé—´)</span><br><span class="line">3. å…±äº«</span><br><span class="line">4. è™šæ‹ŸåŒ–(æ›´å¤šçš„åœ°å€ç©ºé—´ è™šæ‹Ÿå†…å­˜ï¼šç¡¬ç›˜)</span><br><span class="line"></span><br><span class="line">æ“ä½œç³»ç»Ÿç®¡ç†å†…å­˜çš„æ–¹æ³•ï¼š</span><br><span class="line"></span><br><span class="line">- ç¨‹åºé‡å®šä½</span><br><span class="line">- åˆ†æ®µ</span><br><span class="line">- åˆ†é¡µ</span><br><span class="line">- è™šæ‹Ÿå†…å­˜</span><br><span class="line">- æŒ‰éœ€åˆ†é…å†…å­˜</span><br><span class="line"></span><br><span class="line">ä»¥ä¸Šçš„æ–¹æ³•é«˜åº¦ä¾èµ–äºç¡¬ä»¶ï¼š</span><br><span class="line"></span><br><span class="line">- å¿…é¡»ç›´åˆ°å†…å­˜æ¶æ„</span><br><span class="line">- MMUï¼ˆå†…å­˜ç®¡ç†å•å…ƒï¼‰ï¼šç¡¬ä»¶ç»„ä»¶è´Ÿè´£å¤„ç†CPUçš„å†…å­˜è®¿é—®è¯·æ±‚ã€‚</span><br><span class="line"></span><br><span class="line">### åœ°å€ç©ºé—´ã€åœ°å€ç”Ÿæˆ</span><br><span class="line"></span><br><span class="line">#### åœ°å€ç©ºé—´</span><br><span class="line"></span><br><span class="line">![image-20221018212807441](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210182128534.png)</span><br><span class="line"></span><br><span class="line">ç‰©ç†åœ°å€ç©ºé—´ï¼šå†…å­˜æ¡ã€ç¡¬ç›˜</span><br><span class="line"></span><br><span class="line">é€»è¾‘åœ°å€ç©ºé—´ï¼šä¸€ä¸ªè¿è¡Œçš„ç¨‹åºå¯¹åº”çš„åœ°å€ç©ºé—´</span><br><span class="line"></span><br><span class="line">é€»è¾‘åœ°å€ç©ºé—´å®é™…ä¸Šæ˜¯è½è„šåœ¨å®é™…çš„ç‰©ç†åœ°å€ç©ºé—´çš„ï¼Œéœ€è¦æ“ä½œç³»ç»Ÿçš„ç®¡ç†ã€‚</span><br><span class="line"></span><br><span class="line">#### åœ°å€ç”Ÿæˆ</span><br><span class="line"></span><br><span class="line">é€»è¾‘åœ°å€æ€ä¹ˆç”Ÿæˆçš„ï¼Ÿ</span><br><span class="line"></span><br><span class="line">![image-20221018213031811](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210182130906.png)</span><br><span class="line"></span><br><span class="line">ä¸€æ­¥ä¸€æ­¥çš„ç¼–è¯‘ï¼Œæœ€åé€šè¿‡loaderï¼ˆåº”ç”¨ç¨‹åºï¼‰æŠŠæ‰§è¡Œç¨‹åºçš„é€»è¾‘åœ°å€åˆ†é…åœ¨ç‰©ç†åœ°å€ã€‚</span><br><span class="line"></span><br><span class="line">![image-20221018213334501](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210182133589.png)</span><br><span class="line"></span><br><span class="line">CPUä¸­çš„MMUä¿å­˜äº†é€»è¾‘åœ°å€åˆ°ç‰©ç†åœ°å€çš„æ˜ å°„å…³ç³»ã€‚æ¥è®©æˆ‘ä»¬é€šè¿‡æ˜ å°„è®¿é—®åˆ°å®é™…çš„ç‰©ç†åœ°å€ã€‚</span><br><span class="line"></span><br><span class="line">1. CPUæ‰§è¡ŒæŸæ¡æŒ‡ä»¤ï¼ŒALUè¯·æ±‚é€»è¾‘åœ°å€</span><br><span class="line">2. CPUçš„MMUæŸ¥æ‰¾é€»è¾‘åœ°å€çš„æ˜ å°„è¡¨mapæ˜¯å¦å­˜åœ¨å¯¹åº”ç‰©ç†åœ°å€ï¼Œæ‰¾åˆ°ï¼Œè¿”å›ã€‚æ²¡æœ‰ï¼Œå»å†…å­˜æ‰¾ã€‚</span><br><span class="line">3. å¦‚æœæœ‰ï¼Œç»™ä¸»å­˜å‘é€è¯·æ±‚ï¼Œéœ€è¦ç‰©ç†åœ°å€çš„å†…å®¹ã€‚</span><br><span class="line">4. ä¸»å­˜é€šè¿‡æ€»çº¿ï¼ŒæŠŠå†…å®¹ä¼ ç»™CPUã€‚</span><br><span class="line">5. CPUæ‹¿åˆ°æ•°æ®åï¼Œç»§ç»­æŒ‡ä»¤çš„æ‰§è¡Œã€‚</span><br><span class="line"></span><br><span class="line">æ“ä½œç³»ç»Ÿå®é™…ä¸Šæ˜¯å®Œæˆäº†ä»é€»è¾‘åœ°å€åˆ°ç‰©ç†åœ°å€å…³ç³»çš„æ˜ å°„ã€‚</span><br><span class="line"></span><br><span class="line">![image-20221018214110531](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210182142610.png)</span><br><span class="line"></span><br><span class="line">- ç¼–è¯‘å™¨ä¼šæŠŠåŸºäºç¬¦å·çš„åœ°å€ç©ºé—´åˆ°é€»è¾‘åœ°å€ç©ºé—´ã€‚</span><br><span class="line">- æ“ä½œç³»ç»Ÿä¼šæŠŠé€»è¾‘åœ°å€ç©ºé—´æ˜ å°„åˆ°ç‰©ç†åœ°å€ç©ºé—´ã€‚åŒæ—¶ä¿è¯ç¨‹åºç‹¬ç«‹åˆ†é…åœ°å€ç©ºé—´ï¼Œä¿è¯ç¨‹åºçš„æ­£å¸¸è¿è¡Œã€‚</span><br><span class="line"></span><br><span class="line">### è¿ç»­å†…å­˜åˆ†é…</span><br><span class="line"></span><br><span class="line">#### å†…å­˜ç¢ç‰‡é—®é¢˜</span><br><span class="line"></span><br><span class="line">![image-20221018214320476](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210182143566.png)</span><br><span class="line"></span><br><span class="line">å¸Œæœ›é€šè¿‡ä¸€ç§æœ‰æ•ˆçš„åˆ†é…æ–¹æ³•ï¼Œæ¥å‡å°‘å†…ç¢ç‰‡ã€å¤–ç¢ç‰‡çš„é—®é¢˜ã€‚</span><br><span class="line"></span><br><span class="line">#### åˆ†åŒºçš„åŠ¨æ€åˆ†é…</span><br><span class="line"></span><br><span class="line">![image-20221018214531315](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210182145391.png)</span><br><span class="line"></span><br><span class="line">æ“ä½œç³»ç»Ÿéœ€è¦ç®¡ç†åˆ†é…äº†å’Œæœªåˆ†é…çš„ç©ºé—´ã€‚</span><br><span class="line"></span><br><span class="line">#### åˆ†é…ç­–ç•¥</span><br><span class="line"></span><br><span class="line">##### é¦–æ¬¡é€‚é…</span><br><span class="line"></span><br><span class="line">![image-20221018214653040](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210182147966.png)</span><br><span class="line"></span><br><span class="line">å®ç°ï¼šä»ç¬¬ä¸€å—å¼€å§‹åˆ†é… 0åœ°å€</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;https://gitee.com/messi-study-java/pic_go/raw/master/img/202210182149601.png&quot; alt=&quot;image-20221018214916478&quot; style=&quot;zoom: 67%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">##### æœ€ä¼˜é€‚é…</span><br><span class="line"></span><br><span class="line">å¯»æ‰¾æœ€åŒ¹é…çš„ç©ºé—´å—ã€‚å†…å­˜å·®æœ€å°ã€‚</span><br><span class="line"></span><br><span class="line">![image-20221018215023254](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210182150373.png)</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;https://gitee.com/messi-study-java/pic_go/raw/master/img/202210182150929.png&quot; alt=&quot;image-20221018215046854&quot; style=&quot;zoom:67%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">##### æœ€å·®é€‚é…</span><br><span class="line"></span><br><span class="line">![image-20221018215205253](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210182152368.png)</span><br><span class="line"></span><br><span class="line">å’Œæœ€ä¼˜é€‚é…å¯¹åº”ï¼Œæ‰¾åˆ°å†…å­˜å·®æœ€å¤§çš„å†…å­˜å—ã€‚</span><br><span class="line"></span><br><span class="line">![image-20221018215253220](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210182152296.png)</span><br><span class="line"></span><br><span class="line">ä¸­å¤§å‹è¯·æ±‚ï¼Œæœ€å·®é€‚é…è¿˜æ˜¯æ¯”è¾ƒåˆé€‚çš„ã€‚</span><br><span class="line"></span><br><span class="line">åº”å¯¹ä¸åŒçš„æƒ…å†µï¼Œé€‰æ‹©ä¸åŒçš„åˆ†é…ç­–ç•¥ã€‚</span><br><span class="line"></span><br><span class="line">#### å‹ç¼©å¼å’Œäº¤æ¢å¼ç¢ç‰‡å¤„ç†</span><br><span class="line"></span><br><span class="line">å¦‚ä½•æŠŠç¢ç‰‡è”åˆèµ·æ¥ï¼Œç»„æˆå¤§çš„è¿ç»­çš„ç¢ç‰‡ï¼Ÿ</span><br><span class="line"></span><br><span class="line">##### å‹ç¼©å¼ç¢ç‰‡å¤„ç†</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;https://gitee.com/messi-study-java/pic_go/raw/master/img/202210182158695.png&quot; alt=&quot;image-20221018215857582&quot; style=&quot;zoom:50%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">æŠŠä¹‹å‰çš„å†…å­˜è¿›è¡Œæ‹·è´ã€‚</span><br><span class="line"></span><br><span class="line">é—®é¢˜ï¼š</span><br><span class="line"></span><br><span class="line">- ä»€ä¹ˆæ—¶å€™è¿›è¡Œæ‹·è´ï¼Ÿ(æ—¶æœºï¼šå¯ä»¥åœ¨ç¨‹åºç­‰å¾…çš„è¿‡ç¨‹ä¸­)</span><br><span class="line">- å¼€é”€å¤§ä¸å¤§ï¼Ÿï¼ˆæ—¶é—´çš„å¼€é”€ï¼Œä¼šä¸ä¼šå½±å“ç¨‹åºçš„æ‰§è¡Œï¼‰</span><br><span class="line"></span><br><span class="line">##### äº¤æ¢å¼ç¢ç‰‡æ•´ç†</span><br><span class="line"></span><br><span class="line">![image-20221018220200392](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210182202473.png)</span><br><span class="line"></span><br><span class="line">æ²¡æœ‰ç©ºé—²ç©ºé—´äº†ï¼Œä¸èƒ½ä½¿ç”¨ç´§è‡´(å‹ç¼©å¼)ã€‚</span><br><span class="line"></span><br><span class="line">é€šè¿‡æŠŠç¨‹åºè€—è´¹çš„å†…å­˜ç§»åˆ°ç¡¬ç›˜ä¸­ã€‚</span><br><span class="line"></span><br><span class="line">é—®é¢˜ï¼š</span><br><span class="line"></span><br><span class="line">- é€‰æ‹©å“ªä¸€ä¸ªç¨‹åºè¿›è¡Œç§»åŠ¨ï¼Ÿ</span><br><span class="line">- åœ¨ä»€ä¹ˆæ—¶æœºè¿›è¡Œç§»åŠ¨ï¼Ÿ</span><br><span class="line">- å¼€é”€çš„å¤§å°ï¼Ÿ</span><br><span class="line"></span><br><span class="line">## éè¿ç»­å†…å­˜åˆ†é…</span><br><span class="line"></span><br><span class="line">### ä¸ºä»€ä¹ˆéœ€è¦éè¿ç»­å†…å­˜åˆ†é…è¿™ç§ç®¡ç†æ–¹å¼ï¼Ÿ</span><br><span class="line"></span><br><span class="line">è¿ç»­å†…å­˜åˆ†é…çš„ç¼ºç‚¹ï¼š</span><br><span class="line"></span><br><span class="line">- åˆ†é…ç»™ä¸€ä¸ªç¨‹åºçš„ç‰©ç†å†…å­˜æ˜¯è¿ç»­çš„</span><br><span class="line">- å†…å­˜åˆ©ç”¨ç‡è¾ƒä½</span><br><span class="line">- æœ‰å¤–ç¢ç‰‡ã€å†…ç¢ç‰‡é—®é¢˜</span><br><span class="line"></span><br><span class="line">éè¿ç»­åˆ†é…çš„ä¼˜ç‚¹ï¼š</span><br><span class="line"></span><br><span class="line">- ä¸€ä¸ªç¨‹åºçš„ç‰©ç†åœ°å€ç©ºé—´æ˜¯è¿ç»­çš„</span><br><span class="line">- æ›´å¥½çš„å†…å­˜åˆ©ç”¨å’Œç®¡ç†</span><br><span class="line">- å…è®¸å…±äº«ä»£ç ä¸æ•°æ®ï¼ˆè´¡çŒ®åº“ç­‰...ï¼‰</span><br><span class="line">- æ”¯æŒåŠ¨æ€åŠ è½½å’ŒåŠ¨æ€é“¾æ¥</span><br><span class="line"></span><br><span class="line">éè¿ç»­åˆ†é…çš„ç¼ºç‚¹ï¼š</span><br><span class="line"></span><br><span class="line">å»ºç«‹è™šæ‹Ÿåœ°å€å’Œç‰©ç†åœ°å€ä¹‹é—´è½¬æ¢çš„å¼€é”€</span><br><span class="line"></span><br><span class="line">- ç¡¬ä»¶æ–¹æ¡ˆ</span><br><span class="line">  - åˆ†é¡µ</span><br><span class="line">  - åˆ†æ®µ</span><br><span class="line">- è½¯ä»¶æ–¹æ¡ˆ</span><br><span class="line"></span><br><span class="line">### éè¿ç»­å†…å­˜åˆ†é…çš„æ–¹æ³•</span><br><span class="line"></span><br><span class="line">- åˆ†æ®µ(Segmentation)</span><br><span class="line">- åˆ†é¡µ(Paging)</span><br><span class="line"></span><br><span class="line">#### åˆ†æ®µ</span><br><span class="line"></span><br><span class="line">- ç¨‹åºçš„åˆ†æ®µåœ°å€ç©ºé—´</span><br><span class="line">- åˆ†æ®µå¯»å€æ–¹æ¡ˆ</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;C:/Users/huangruidong/AppData/Roaming/Typora/typora-user-images/image-20221021112201543.png&quot; alt=&quot;image-20221021112201543&quot; style=&quot;zoom:50%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">![image-20221021112305222](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210211123316.png)</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;https://gitee.com/messi-study-java/pic_go/raw/master/img/202210211124935.png&quot; alt=&quot;image-20221021112415866&quot; style=&quot;zoom:67%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">å°†è¿ç»­çš„é€»è¾‘åœ°å€ç©ºé—´åˆ†æ®µä¸ºéè¿ç»­çš„ç‰©ç†åœ°å€ç©ºé—´</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;https://gitee.com/messi-study-java/pic_go/raw/master/img/202210211125905.png&quot; alt=&quot;image-20221021112538821&quot; style=&quot;zoom:67%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">![image-20221021112646245](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210211126339.png)</span><br><span class="line"></span><br><span class="line">åˆ†æ®µåœ°å€é€‰å€ï¼šæ®µå·+æ®µçš„åç§»</span><br><span class="line"></span><br><span class="line">#### åˆ†é¡µ</span><br><span class="line"></span><br><span class="line">é¡µåœ°å€é€‰å€ï¼šé¡µå·+é¡µçš„åç§»</span><br><span class="line"></span><br><span class="line">åˆ†é¡µå’Œåˆ†æ®µçš„åŒºåˆ«ï¼š</span><br><span class="line"></span><br><span class="line">- åœ¨åˆ†æ®µé‡Œè¾¹ï¼Œæ®µçš„å°ºå¯¸æ˜¯å¯å˜çš„</span><br><span class="line">- åœ¨åˆ†é¡µé‡Œè¾¹ï¼Œé¡µçš„å°ºå¯¸å¤§å°æ˜¯ä¸å˜çš„</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;https://gitee.com/messi-study-java/pic_go/raw/master/img/202210211140279.png&quot; alt=&quot;image-20221021114022106&quot; style=&quot;zoom:50%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;https://gitee.com/messi-study-java/pic_go/raw/master/img/202210211141715.png&quot; alt=&quot;image-20221021114130624&quot; style=&quot;zoom: 80%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;https://gitee.com/messi-study-java/pic_go/raw/master/img/202210211144516.png&quot; alt=&quot;image-20221021114456415&quot; style=&quot;zoom:80%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;C:/Users/huangruidong/AppData/Roaming/Typora/typora-user-images/image-20221021114907052.png&quot; alt=&quot;image-20221021114907052&quot; style=&quot;zoom:80%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;https://gitee.com/messi-study-java/pic_go/raw/master/img/202210211153061.png&quot; alt=&quot;image-20221021115234290&quot; style=&quot;zoom:80%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">é€šè¿‡é¡µå·æŸ¥å¸§å·</span><br><span class="line"></span><br><span class="line">![image-20221021115635068](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210211156179.png)</span><br><span class="line"></span><br><span class="line">#### é¡µè¡¨</span><br><span class="line"></span><br><span class="line">![image-20221021132609864](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210211326985.png)</span><br><span class="line"></span><br><span class="line">![image-20221021132637568](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210211326654.png)</span><br><span class="line"></span><br><span class="line">![image-20221021150916315](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210211509423.png)</span><br><span class="line"></span><br><span class="line">![image-20221021151523105](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210211515167.png)</span><br><span class="line"></span><br><span class="line">- é¡µè¡¨å¯èƒ½å çš„ç©ºé—´å¾ˆå¤§</span><br><span class="line">- é¡µè¡¨å¦‚æœæ”¾åœ¨å†…å­˜ä¸Šï¼Œæ—¶é—´ä¸Šçš„å¼€é”€å¾ˆå¤§ã€‚</span><br><span class="line"></span><br><span class="line">##### åº”å¯¹æ—¶é—´å¼€é”€ï¼šTLB</span><br><span class="line"></span><br><span class="line">![image-20221021151553493](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210211515561.png)</span><br><span class="line"></span><br><span class="line">##### åº”å¯¹å†…å­˜å¼€é”€ï¼šå¤šçº§é¡µè¡¨</span><br><span class="line"></span><br><span class="line">![image-20221021152354583](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210211523651.png)</span><br><span class="line"></span><br><span class="line">![image-20221021152404907](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210211524984.png)</span><br><span class="line"></span><br><span class="line">åƒB+æ ‘ä¸€æ ·</span><br><span class="line"></span><br><span class="line">##### åå‘é¡µè¡¨</span><br><span class="line"></span><br><span class="line">![image-20221021152622306](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210211526374.png)</span><br><span class="line"></span><br><span class="line">åè½¬ï¼šä»¥ç‰©ç†é¡µå·æŸ¥æ‰¾é€»è¾‘é¡µå·</span><br><span class="line"></span><br><span class="line">![image-20221021152808496](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210211528561.png)</span><br><span class="line"></span><br><span class="line">![image-20221021152930397](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210211529460.png)</span><br><span class="line"></span><br><span class="line">![image-20221021153115447](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210211531525.png)</span><br><span class="line"></span><br><span class="line">![image-20221021153208185](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210211532275.png)</span><br><span class="line"></span><br><span class="line">## è™šæ‹Ÿå†…å­˜ç®¡ç†æŠ€æœ¯</span><br><span class="line"></span><br><span class="line">### è™šæ‹Ÿå†…å­˜çš„èµ·å› </span><br><span class="line"></span><br><span class="line">ç¨‹åºè§„æ¨¡çš„å¢é•¿é€Ÿåº¦è¿œå¤§äºå­˜å‚¨å™¨å®¹é‡çš„å¢é•¿é€Ÿåº¦ã€‚</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">ç†æƒ³ä¸­çš„å­˜å‚¨å™¨ï¼š</span><br><span class="line"></span><br><span class="line">- æ›´å¤§</span><br><span class="line">- æ›´å¿«</span><br><span class="line">- æ›´ä¾¿å®œ</span><br><span class="line">- éå¼‚å¤±æ€§</span><br><span class="line">- &lt;img src=&quot;C:/Users/huangruidong/AppData/Roaming/Typora/typora-user-images/image-20221024183501918.png&quot; alt=&quot;image-20221024183501918&quot; style=&quot;zoom:50%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">ç¡¬ç›˜æ¯”å†…å­˜å®¹é‡å¤§ï¼Œä½†æ˜¯é€Ÿåº¦æ…¢ã€‚</span><br><span class="line"></span><br><span class="line">èƒ½ä¸èƒ½è®©æ“ä½œç³»ç»Ÿé€šè¿‡ä¸€ç§æ“ä½œï¼Œè¾¾åˆ°ç†æƒ³ä¸­çš„å­˜å‚¨å™¨ï¼Ÿ</span><br><span class="line"></span><br><span class="line">**è‡ªåŠ¨çš„è™šæ‹Ÿå­˜å‚¨æŠ€æœ¯**</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;https://gitee.com/messi-study-java/pic_go/raw/master/img/202210241839139.png&quot; alt=&quot;image-20221024183954026&quot; style=&quot;zoom: 67%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">ä½†æ˜¯ç›®å‰è¿˜è¾¾ä¸åˆ°æ‰ç”µä¸ä¸¢å¤±çš„æƒ…å†µã€‚</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œå°¤å…¶æ˜¯å¤šé“ç¨‹åºè¿è¡Œçš„ç¯å¢ƒä¸‹ï¼Œå¯èƒ½ä¼šå‡ºç°å†…å­˜ä¸å¤Ÿç”¨çš„æƒ…å†µï¼Œæ€ä¹ˆåŠï¼Ÿ</span><br><span class="line"></span><br><span class="line">- æ‰‹åŠ¨çš„è¦†ç›–æŠ€æœ¯(overlay)ï¼šç¨‹åºå¤ªå¤§ï¼Œè¶…è¿‡äº†å†…å­˜é™åˆ¶ï¼ŒåªæŠŠéœ€è¦çš„æŒ‡ä»¤å’Œæ•°æ®ä¿å­˜åœ¨å†…å­˜å½“ä¸­ã€‚</span><br><span class="line">- è‡ªåŠ¨çš„äº¤æ¢æŠ€æœ¯(swapping)ï¼šç¨‹åºå¤ªå¤šï¼Œè¶…è¿‡äº†å†…å­˜çš„å®¹é‡ï¼ŒæŠŠæš‚æ—¶ä¸èƒ½æ‰§è¡Œçš„ç¨‹åºé€åˆ°å¤–å­˜ä¸­ã€‚</span><br><span class="line">- è‡ªåŠ¨çš„è™šæ‹Ÿå­˜å‚¨æŠ€æœ¯ï¼šåœ¨æœ‰é™å®¹é‡çš„å†…å­˜ä¸­ï¼Œä»¥æ›´å°çš„é¡µç²’åº¦ä¸ºå•ä½è£…å…¥æ›´å¤šæ›´å¤§çš„ç¨‹åºã€‚</span><br><span class="line"></span><br><span class="line">### è¦†ç›–æŠ€æœ¯</span><br><span class="line"></span><br><span class="line">![image-20221024185954398](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210241859499.png)</span><br><span class="line"></span><br><span class="line">â€‹ç®€å•ç†è§£ä¸ºï¼šåˆ†æ—¶å…±äº«</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;https://gitee.com/messi-study-java/pic_go/raw/master/img/202210241903462.png&quot; alt=&quot;image-20221024190350386&quot; style=&quot;zoom:80%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">![image-20221024190904279](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210241909327.png)</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;https://gitee.com/messi-study-java/pic_go/raw/master/img/202210241910196.png&quot; alt=&quot;image-20221024191028116&quot; style=&quot;zoom:80%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### äº¤æ¢æŠ€æœ¯</span><br><span class="line"></span><br><span class="line">![image-20221024191237043](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210241912140.png)</span><br><span class="line"></span><br><span class="line">å¯¼å…¥ã€å¯¼å‡ºçš„å¼€é”€æ¯”è¾ƒå¤§ã€‚</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;https://gitee.com/messi-study-java/pic_go/raw/master/img/202210241915532.png&quot; alt=&quot;image-20221024191546453&quot; style=&quot;zoom: 80%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">![image-20221024191939005](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210241919082.png)</span><br><span class="line"></span><br><span class="line">![image-20221024192038504](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210241920570.png)</span><br><span class="line"></span><br><span class="line">&gt;è¦†ç›–å‘ç”Ÿåœ¨ç¨‹åºå†…éƒ¨ï¼Œéœ€è¦æˆéœ€è¦è‡ªå·±æ“ä½œï¼Œå¯æ“ä½œæ€§å¼ºã€‚</span><br><span class="line">&gt;</span><br><span class="line">&gt;äº¤æ¢æ˜¯ç¨‹åºå’Œç¨‹åºä¹‹é—´çš„äº¤æ¢ï¼Œå¯¹ç¨‹åºå‘˜æ˜¯é€æ˜çš„ï¼Œä½†æ˜¯å¼€é”€è¾ƒå¤§ã€‚</span><br><span class="line"></span><br><span class="line">### è™šå­˜æŠ€æœ¯</span><br><span class="line"></span><br><span class="line">#### ç›®æ ‡</span><br><span class="line"></span><br><span class="line">![image-20221024200008723](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210242000811.png)</span><br><span class="line"></span><br><span class="line">è§£å†³æ–¹æ³•ï¼š**è™šå­˜æŠ€æœ¯**</span><br><span class="line"></span><br><span class="line">![image-20221024200233396](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210242002491.png)</span><br><span class="line"></span><br><span class="line">#### ç¨‹åºå±€éƒ¨æ€§åŸç†</span><br><span class="line"></span><br><span class="line">![image-20221024200412708](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210242004817.png)</span><br><span class="line"></span><br><span class="line">![image-20221024200625532](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210242006623.png)</span><br><span class="line"></span><br><span class="line">![image-20221024201256673](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210242012746.png)</span><br><span class="line"></span><br><span class="line">#### åŸºæœ¬æ¦‚å¿µ</span><br><span class="line"></span><br><span class="line">![image-20221024201349772](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210242013872.png)</span><br><span class="line"></span><br><span class="line">#### åŸºæœ¬ç‰¹æ€§</span><br><span class="line"></span><br><span class="line">![image-20221024202147848](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210242021943.png)</span><br><span class="line"></span><br><span class="line">#### è™šæ‹Ÿé¡µæ°å†…å­˜ç®¡ç†</span><br><span class="line"></span><br><span class="line">![image-20221024202349935](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210242023031.png)</span><br><span class="line"></span><br><span class="line">![image-20221024203504348](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210242035433.png)</span><br><span class="line"></span><br><span class="line">![image-20221024203607559](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210242036655.png)</span><br><span class="line"></span><br><span class="line">![image-20221024203826351](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210242038440.png)</span><br><span class="line"></span><br><span class="line">![image-20221024204539674](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210242045765.png)</span><br><span class="line"></span><br><span class="line">![image-20221024204835527](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210242048614.png)</span><br><span class="line"></span><br><span class="line">1+qæ¢å…¥æ¢å‡ºæ¯”ä¾‹</span><br><span class="line"></span><br><span class="line">å¦‚æœPè¶³å¤Ÿå°ï¼ŒEATæ¥è¿‘10nsã€‚</span><br><span class="line"></span><br><span class="line">å› ä¸ºç¨‹åºå…·æœ‰å±€éƒ¨æ€§çš„ç‰¹ç‚¹ï¼Œæ‰€ä»¥å¯ä»¥ä¿è¯æ¥è¿‘10nsã€‚</span><br><span class="line"></span><br><span class="line">## é¡µé¢ç½®æ¢ç®—æ³•</span><br><span class="line"></span><br><span class="line">### åŠŸèƒ½è®¾ç½®</span><br><span class="line"></span><br><span class="line">![image-20221026185719787](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210261900658.png)</span><br><span class="line"></span><br><span class="line">### å±€éƒ¨é¡µé¢ç½®æ¢ç®—æ³•</span><br><span class="line"></span><br><span class="line">#### æœ€ä¼˜é¡µé¢ç½®æ¢ç®—æ³•</span><br><span class="line"></span><br><span class="line">&gt; æ€è·¯ï¼šæŠŠå°†æ¥æœ€å°‘ç”¨åˆ°çš„é¡µé¢ç½®æ¢å‡ºå»</span><br><span class="line"></span><br><span class="line">![image-20221026190240689](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210261902822.png)</span><br><span class="line"></span><br><span class="line">![image-20221026190611852](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210261906943.png)</span><br><span class="line"></span><br><span class="line">dåœ¨å°†æ¥ç”¨çš„è·ç¦»æœ€çŸ­ï¼Œå…ˆç½®æ¢å‡ºå»ã€‚</span><br><span class="line"></span><br><span class="line">#### å…ˆè¿›å…ˆå‡ºç®—æ³•ï¼ˆFIFOï¼‰</span><br><span class="line"></span><br><span class="line">&gt; æ€è·¯ï¼šåƒé˜Ÿåˆ—ä¸€æ ·ï¼ŒæŠŠå…ˆè¿›å…¥çš„å…ˆç½®æ¢å‡ºå»ã€‚</span><br><span class="line"></span><br><span class="line">![image-20221026190744628](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210261907776.png)</span><br><span class="line"></span><br><span class="line">![image-20221026191335866](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210261913970.png)</span><br><span class="line"></span><br><span class="line">#### æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨ç®—æ³•ï¼ˆLRUï¼‰</span><br><span class="line"></span><br><span class="line">&gt; æ€è·¯ï¼šæ›¿æ¢å‡ºæœ€è¿‘ä¸€æ®µæ—¶é—´æ²¡æœ‰ä½¿ç”¨çš„é¡µé¢ï¼Œé€šè¿‡è¿‡å»æ¨æµ‹ç½®æ¢é¡µé¢ï¼Œå¯¹æœ€ä¼˜ç½®æ¢ç®—æ³•çš„æ”¹å†™ã€‚</span><br><span class="line">&gt;</span><br><span class="line">&gt; åˆ©ç”¨äº†ç¨‹åºçš„æ—¶é—´å±€éƒ¨æ€§ã€‚</span><br><span class="line"></span><br><span class="line">&gt; ç¨‹åºå±€éƒ¨æ€§ï¼š</span><br><span class="line">&gt;</span><br><span class="line">&gt; - æ—¶é—´å±€éƒ¨æ€§ï¼šæœ€è¿‘è®¿é—®è¿‡çš„æ•°æ®ï¼Œä¹‹åè¿˜è¦è®¿é—®ã€‚</span><br><span class="line">&gt; - ç©ºé—´å±€éƒ¨æ€§ï¼šæ•°æ®å†…èšåœ¨ä¸€èµ·ã€‚</span><br><span class="line"></span><br><span class="line">![image-20221026191553571](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210261915707.png)</span><br><span class="line"></span><br><span class="line">![image-20221026192608208](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210261926322.png)</span><br><span class="line"></span><br><span class="line">![image-20221026192831635](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210261928790.png)</span><br><span class="line"></span><br><span class="line">![image-20221026193048348](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210261930470.png)</span><br><span class="line"></span><br><span class="line">#### æ—¶é’Ÿé¡µé¢ç½®æ¢ç®—æ³•ï¼ˆClockï¼‰</span><br><span class="line"></span><br><span class="line">&gt; æ€è·¯</span><br><span class="line">&gt;</span><br><span class="line">&gt; å½“è®¿é—®ä¸€ä¸ªé¡µæ—¶ï¼Œç¡¬ä»¶ä¼šæŠŠè¯¥é¡µçš„access bitç½®1ï¼Œè¿‡ä¸€æ®µæ—¶é—´ï¼ŒOSä¼šæŠŠaccess bitç½®0ã€‚</span><br><span class="line">&gt;</span><br><span class="line">&gt; Clockç®—æ³•å°±æ˜¯å¯¹FIFOçš„æ”¹è¿›ï¼Œè®©ä»–æ‰¾ä¸€ä¸ªç›¸å¯¹æ¯”è¾ƒâ€œè€â€çš„æ•°æ®ç½®æ¢å‡ºå»ã€‚</span><br><span class="line"></span><br><span class="line">![image-20221026193337321](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210261933471.png)</span><br><span class="line"></span><br><span class="line">![image-20221026193846449](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210261938558.png)</span><br><span class="line"></span><br><span class="line">æ„å»ºä¸€ä¸ªç¯å½¢é“¾è¡¨ï¼Œé‡åˆ°è¦ç½®æ¢çš„æƒ…å†µï¼Œä»å½“å‰æŒ‡é’ˆå¼€å§‹éå†é“¾è¡¨ã€‚</span><br><span class="line"></span><br><span class="line">- å…ˆçœ‹ä¼šä¸ä¼šå‘ç”Ÿç¼ºé¡µï¼Œç¼ºé¡µå°±æ˜¯æŸ¥è¯¢çš„è¿‡ç¨‹ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œaccess byte å…ˆç½®1ï¼Œè¡¨ç¤ºæœ€è¿‘è®¿é—®è¿‡ã€‚</span><br><span class="line">- ä¸‹æ¥æ‰ä¼šè¿›è¡ŒClockç®—æ³•ã€‚</span><br><span class="line"></span><br><span class="line">- é‡åˆ°access bitä¸º1ï¼Œç½®0ï¼Œè®©ä»–&quot;è€&quot;ä¸€æ­¥ï¼Œè·³åˆ°ä¸‹ä¸€ä¸ªä½ç½®ã€‚</span><br><span class="line">- é‡åˆ°access bitä¸º0ï¼Œæ›¿æ¢ï¼ŒæŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚</span><br><span class="line"></span><br><span class="line">#### äºŒæ¬¡æœºä¼šæ³•</span><br><span class="line"></span><br><span class="line">å¦‚æœæ˜¯å†™æ“ä½œï¼Œdirty bitä¼šä¸º1</span><br><span class="line"></span><br><span class="line">![image-20221026201351687](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262013789.png)</span><br><span class="line"></span><br><span class="line">![image-20221026202258814](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262022938.png)</span><br><span class="line"></span><br><span class="line">#### æœ€ä¸å¸¸ç”¨ç®—æ³•ï¼ˆLFUï¼‰</span><br><span class="line"></span><br><span class="line">&gt; æ€è·¯ï¼šé€‰æ‹©è®¿é—®æ¬¡æ•°æœ€å°‘çš„é¡µé¢</span><br><span class="line"></span><br><span class="line">![image-20221026202410800](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262024919.png)</span><br><span class="line"></span><br><span class="line">![image-20221026202548885](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262025948.png)</span><br><span class="line"></span><br><span class="line">#### Beladyç°è±¡</span><br><span class="line"></span><br><span class="line">![image-20221026202918485](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262029595.png)</span><br><span class="line"></span><br><span class="line">![image-20221026203200127](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262032255.png)</span><br><span class="line"></span><br><span class="line">![image-20221026203310691](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262033818.png)</span><br><span class="line"></span><br><span class="line">![image-20221026203420381](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262034483.png)</span><br><span class="line"></span><br><span class="line">- LRUæ»¡è¶³æ ˆç®—æ³•</span><br><span class="line">- FIFOä¸æ»¡è¶³æ ˆç®—æ³•</span><br><span class="line"></span><br><span class="line">#### LRUã€FIFOã€Clockçš„æ¯”è¾ƒ</span><br><span class="line"></span><br><span class="line">![image-20221026203539653](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262035833.png)</span><br><span class="line"></span><br><span class="line">![image-20221026203815501](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262038624.png)</span><br><span class="line"></span><br><span class="line">Clockå’ŒLRUå¦‚æœä¸å…·å¤‡å±€éƒ¨æ€§ï¼Œä¼šé€€åŒ–ä¸ºFIFO</span><br><span class="line"></span><br><span class="line">### å…¨å±€é¡µé¢ç½®æ¢ç®—æ³•</span><br><span class="line"></span><br><span class="line">#### å±€éƒ¨é¡µæ›¿æ¢ç®—æ³•çš„é—®é¢˜</span><br><span class="line"></span><br><span class="line">![image-20221026203937206](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262039313.png)</span><br><span class="line"></span><br><span class="line">- å›ºå®šåˆ†é…çš„é¡µå¸§å¤§å°æ²¡æœ‰è€ƒè™‘å®é™…çš„åŠ¨æ€å˜åŒ–ï¼Œå¯èƒ½ä¼šå‘ç”Ÿè¾ƒå¤šç¼ºå¤±ï¼Œèƒ½ä¸èƒ½åŠ¨æ€åœ°åˆ†é…é¡µå¸§å¤§å°ï¼Ÿ</span><br><span class="line"></span><br><span class="line">#### å·¥ä½œé›†æ¨¡å¼</span><br><span class="line"></span><br><span class="line">![image-20221026204100955](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262041114.png)</span><br><span class="line"></span><br><span class="line">![image-20221026204303245](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262043366.png)</span><br><span class="line"></span><br><span class="line">![image-20221026204515932](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262045042.png)</span><br><span class="line"></span><br><span class="line">![image-20221026204614633](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262046727.png)</span><br><span class="line"></span><br><span class="line">![image-20221026204658421](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262046569.png)</span><br><span class="line"></span><br><span class="line">#### å·¥ä½œé›†é¡µç½®æ¢ç®—æ³•</span><br><span class="line"></span><br><span class="line">![image-20221026205054584](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262050687.png)</span><br><span class="line"></span><br><span class="line">![image-20221026205539898](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262055025.png)</span><br><span class="line"></span><br><span class="line">å¦‚æœæ•°æ®çš„æ—¶é—´å¤§äºå·¥ä½œé›†å¤§å°ï¼Œå³ä½¿ç©ºé—´è¿˜æœ‰ï¼Œä¹Ÿä¼šæ¢å‡ºã€‚</span><br><span class="line"></span><br><span class="line">#### ç¼ºé¡µç‡ç½®æ¢ç®—æ³•</span><br><span class="line"></span><br><span class="line">![image-20221026205626748](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262056906.png)</span><br><span class="line"></span><br><span class="line">![image-20221026205706623](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262057721.png)</span><br><span class="line"></span><br><span class="line">![image-20221026205747759](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262057843.png)</span><br><span class="line"></span><br><span class="line">![image-20221026205843873](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262058975.png)</span><br><span class="line"></span><br><span class="line">![image-20221026210411888](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262104019.png)</span><br><span class="line"></span><br><span class="line">æ—¶åˆ»4æ—¶ï¼Œä¸¤æ¬¡ä¸­æ–­çš„æ—¶é—´å¤§äºé¢„å®šæ—¶é—´Tï¼Œè®¤ä¸ºè·‘çš„æ¯”è¾ƒå¥½ï¼Œå‡å°‘å·¥ä½œé›†ï¼ŒæŠŠ1-4è®¿é—®çš„é¡µç»§ç»­ç•™åœ¨è¿™ï¼Œå…¶ä»–çš„é¡µç§»é™¤ã€‚</span><br><span class="line"></span><br><span class="line">#### æŠ–åŠ¨é—®é¢˜</span><br><span class="line"></span><br><span class="line">![image-20221026210658924](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262106107.png)</span><br><span class="line"></span><br><span class="line">![image-20221026211027063](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210262110155.png)</span><br><span class="line"></span><br><span class="line">## è¿›ç¨‹ç®¡ç†</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### è¿›ç¨‹(process)æè¿°</span><br><span class="line"></span><br><span class="line">#### è¿›ç¨‹çš„å®šä¹‰</span><br><span class="line"></span><br><span class="line">**è¿›ç¨‹ï¼š**ä¸€ä¸ªå…·æœ‰ä¸€å®šç‹¬ç«‹åŠŸèƒ½çš„ç¨‹åºåœ¨ä¸€ä¸ªæ•°æ®é›†åˆä¸Šçš„ä¸€æ¬¡åŠ¨æ€æ‰§è¡Œè¿‡ç¨‹ã€‚</span><br><span class="line"></span><br><span class="line">![image-20221028191536744](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210281915900.png)</span><br><span class="line"></span><br><span class="line">#### è¿›ç¨‹çš„ç»„æˆ</span><br><span class="line"></span><br><span class="line">![image-20221031163515491](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210311635633.png)</span><br><span class="line"></span><br><span class="line">![image-20221031163602283](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210311636358.png)</span><br><span class="line"></span><br><span class="line">è¿›ç¨‹ä¸ç­‰äºç¨‹åºï¼Œè¿›ç¨‹æ˜¯cpuçš„ä¾æ¬¡æ‰§è¡Œè¿‡ç¨‹ï¼Œç¨‹åºåªæ˜¯é™æ€çš„ä»£ç ã€‚</span><br><span class="line"></span><br><span class="line">![ ](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312249680.png)</span><br><span class="line"></span><br><span class="line">![image-20221031225136685](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312251791.png)</span><br><span class="line"></span><br><span class="line">#### è¿›ç¨‹çš„ç‰¹ç‚¹</span><br><span class="line"></span><br><span class="line">&gt; å¹¶å‘ï¼Œä¸€æ®µæ—¶é—´å†…å¤šä¸ªè¿›ç¨‹åŒæ—¶æ‰§è¡Œ</span><br><span class="line">&gt;</span><br><span class="line">&gt; å¹¶è¡Œï¼Œä¸€ä¸ªæ—¶åˆ»å¤šä¸ªè¿›ç¨‹åŒæ—¶æ‰§è¡Œ</span><br><span class="line"></span><br><span class="line">![image-20221031225850239](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312258326.png)</span><br><span class="line"></span><br><span class="line">å¦‚ä½•è®¾è®¡ä¸€ä¸ªOSæ¥ä¿è¯ä»¥ä¸Šç‰¹ç‚¹ï¼Ÿ</span><br><span class="line"></span><br><span class="line">![image-20221031230021117](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312300208.png)</span><br><span class="line"></span><br><span class="line">é€šè¿‡è¿›ç¨‹æ§åˆ¶å—æ¥ä¿è¯è¿›ç¨‹çš„ç‰¹ç‚¹ã€‚</span><br><span class="line"></span><br><span class="line">#### è¿›ç¨‹æ§åˆ¶ç»“æ„</span><br><span class="line"></span><br><span class="line">![image-20221031231749475](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312317566.png)</span><br><span class="line"></span><br><span class="line">![image-20221031231826227](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312318331.png)</span><br><span class="line"></span><br><span class="line">![image-20221031231912491](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312319603.png)</span><br><span class="line"></span><br><span class="line">![image-20221031232033815](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312320922.png)</span><br><span class="line"></span><br><span class="line">![image-20221031232310314](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312323409.png)</span><br><span class="line"></span><br><span class="line">### è¿›ç¨‹çŠ¶æ€(State)</span><br><span class="line"></span><br><span class="line">#### è¿›ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ</span><br><span class="line"></span><br><span class="line">1. è¿›ç¨‹åˆ›å»º</span><br><span class="line"></span><br><span class="line">   ![image-20221031232557255](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312325340.png)</span><br><span class="line"></span><br><span class="line">2. è¿›ç¨‹è¿è¡Œ</span><br><span class="line"></span><br><span class="line">   ![image-20221031232657201](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312326280.png)</span><br><span class="line"></span><br><span class="line">3. è¿›ç¨‹ç­‰å¾…</span><br><span class="line"></span><br><span class="line">   ![image-20221031232730351](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312327433.png)</span><br><span class="line"></span><br><span class="line">4. è¿›ç¨‹å”¤é†’</span><br><span class="line"></span><br><span class="line">   ![image-20221031232852501](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312328585.png)</span><br><span class="line"></span><br><span class="line">5. è¿›ç¨‹ç»“æŸ</span><br><span class="line"></span><br><span class="line">   ![image-20221031232928822](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312329921.png)</span><br><span class="line"></span><br><span class="line">#### è¿›ç¨‹çš„çŠ¶æ€å˜åŒ–</span><br><span class="line"></span><br><span class="line">![image-20221031233057933](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312330026.png)</span><br><span class="line"></span><br><span class="line">![image-20221031233140734](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312331823.png)</span><br><span class="line"></span><br><span class="line">![image-20221031233207784](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312332877.png)</span><br><span class="line"></span><br><span class="line">![image-20221031233414083](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312334156.png)</span><br><span class="line"></span><br><span class="line">![image-20221031233525168](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312335248.png)</span><br><span class="line"></span><br><span class="line">![image-20221031233601720](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312336793.png)</span><br><span class="line"></span><br><span class="line">#### è¿›ç¨‹æŒ‚èµ·æ¨¡å‹</span><br><span class="line"></span><br><span class="line">![image-20221031233731185](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312337280.png)</span><br><span class="line"></span><br><span class="line">![image-20221031234050492](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312340601.png)</span><br><span class="line"></span><br><span class="line">![image-20221031234142922](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312341015.png)</span><br><span class="line"></span><br><span class="line">&gt; OSå¦‚ä½•ç®¡ç†PCD?</span><br><span class="line"></span><br><span class="line">![image-20221031234233017](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312342090.png)</span><br><span class="line"></span><br><span class="line">![image-20221031234319915](https://gitee.com/messi-study-java/pic_go/raw/master/img/202210312343000.png)</span><br><span class="line"></span><br><span class="line">### çº¿ç¨‹(Thread)</span><br><span class="line"></span><br><span class="line">#### çº¿ç¨‹çš„æ¥æº</span><br><span class="line"></span><br><span class="line">![image-20221104192636095](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211041927546.png)</span><br><span class="line"></span><br><span class="line">![image-20221104192758934](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211041928477.png)</span><br><span class="line"></span><br><span class="line">![image-20221104193022595](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211041930805.png)</span><br><span class="line"></span><br><span class="line">å¦‚ä½•è§£å†³ä»¥ä¸Šé—®é¢˜ï¼Ÿ</span><br><span class="line"></span><br><span class="line">éœ€è¦ä¸€ç§æ–°çš„å®ä½“ï¼ˆçº¿ç¨‹ï¼‰ï¼Œæ»¡è¶³ä»¥ä¸‹ç‰¹æ€§ï¼š</span><br><span class="line"></span><br><span class="line">1. å®ä½“ä¹‹é—´å¯ä»¥å¹¶å‘çš„æ‰§è¡Œã€‚</span><br><span class="line">2. å®ä½“ä¹‹é—´å…±äº«ç›¸åŒçš„åœ°å€ç©ºé—´ã€‚ï¼ˆè¿›ç¨‹æ˜¯ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼‰</span><br><span class="line"></span><br><span class="line">#### ä»€ä¹ˆæ˜¯çº¿ç¨‹</span><br><span class="line"></span><br><span class="line">![image-20221104193428409](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211041934423.png)</span><br><span class="line"></span><br><span class="line">**çº¿ç¨‹æˆä¸ºè¿›ç¨‹çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚**</span><br><span class="line"></span><br><span class="line">ä¸€ä¸ªè¿›ç¨‹å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹ä¹‹é—´å…±äº«è¿›ç¨‹çš„èµ„æºï¼Œç›´æ¥è®¿é—®è¿›ç¨‹çš„ä»£ç ã€æ•°æ®ã€ç©ºé—´ã€æ–‡ä»¶ç­‰ã€‚</span><br><span class="line"></span><br><span class="line">![image-20221104193820117](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211041938411.png)</span><br><span class="line"></span><br><span class="line">![image-20221104194344117](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211041943117.png)</span><br><span class="line"></span><br><span class="line">![image-20221104194448694](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211041944162.png)</span><br><span class="line"></span><br><span class="line">#### çº¿ç¨‹ä¸è¿›ç¨‹çš„æ¯”è¾ƒ</span><br><span class="line"></span><br><span class="line">- è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„å•ä½ï¼Œçº¿ç¨‹æ˜¯CPUè°ƒåº¦å•ä½ã€‚</span><br><span class="line"></span><br><span class="line">  &gt; CPUæ˜¯ä¸€ç§ç‰¹æ®Šçš„èµ„æºï¼Œä¼šç»™çº¿ç¨‹åˆ†é…æ‰€éœ€è¦çš„å¯„å­˜å™¨å’Œæ ˆã€‚</span><br><span class="line"></span><br><span class="line">- è¿›ç¨‹æ‹¥æœ‰ä¸€ä¸ªå®Œæ•´çš„èµ„æºå¹³å°ï¼Œè€Œçº¿ç¨‹åªç‹¬äº«å¿…ä¸å¯å°‘çš„èµ„æºï¼Œå¦‚å¯„å­˜å™¨å’Œæ ˆã€‚</span><br><span class="line"></span><br><span class="line">- çº¿ç¨‹åŒæ ·å…·æœ‰å°±ç»ªã€é˜»å¡å’Œæ‰§è¡Œä¸‰ç§åŸºæœ¬çŠ¶æ€ï¼ŒåŒæ ·å…·æœ‰çŠ¶æ€ä¹‹é—´çš„è½¬æ¢å…³ç³»ã€‚</span><br><span class="line"></span><br><span class="line">- çº¿ç¨‹èƒ½å‡å°‘å¹¶å‘æ‰§è¡Œçš„æ—¶é—´å’Œç©ºé—´å¼€é”€ã€‚</span><br><span class="line"></span><br><span class="line">  - çº¿ç¨‹çš„åˆ›å»ºæ—¶é—´æ¯”è¿›ç¨‹æ®µï¼›</span><br><span class="line">  - çº¿ç¨‹çš„ç»ˆæ­¢æ—¶é—´æ¯”è¿›ç¨‹çŸ­ï¼›</span><br><span class="line">  - åŒä¸€è¿›ç¨‹å†…çš„çº¿ç¨‹åˆ‡æ¢æ—¶é—´æ¯”è¿›ç¨‹çŸ­ï¼›</span><br><span class="line">  - ç”±äºåŒä¸€è¿›ç¨‹çš„å„çº¿ç¨‹é—´å…±äº«å†…å­˜å’Œæ–‡ä»¶èµ„æºï¼Œå¯ç›´æ¥è¿›è¡Œä¸é€šè¿‡å†…æ ¸çš„é€šä¿¡ã€‚</span><br><span class="line"></span><br><span class="line">#### çº¿ç¨‹çš„å®ç°</span><br><span class="line"></span><br><span class="line">ä¸»è¦çš„ä¸‰ç§çº¿ç¨‹çš„å®ç°æ–¹å¼ï¼š</span><br><span class="line"></span><br><span class="line">1. ç”¨æˆ·çº¿ç¨‹ï¼šåœ¨ç”¨æˆ·ç©ºé—´å®ç°`POSIX Pthreads`,`Mach C-threads`ï¼Œ`Solaris threads`</span><br><span class="line">2. å†…æ ¸çº¿ç¨‹ï¼šåœ¨å†…æ ¸ä¸­å®ç°`Windows`,`Solaris`,`Linux`</span><br><span class="line">3. è½»é‡çº§è¿›ç¨‹ï¼šåœ¨å†…æ ¸ä¸­å®ç°ï¼Œæ”¯æŒç”¨æˆ·çº¿ç¨‹`Solaris`</span><br><span class="line"></span><br><span class="line">ç”¨æˆ·çº¿ç¨‹å’Œå†…æ ¸çº¿ç¨‹çš„å…³ç³»ï¼š</span><br><span class="line"></span><br><span class="line">- å¤šå¯¹ä¸€</span><br><span class="line">- ä¸€å¯¹ä¸€</span><br><span class="line">- å¤šå¯¹å¤š</span><br><span class="line"></span><br><span class="line">![image-20221104202842607](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211042028802.png)</span><br><span class="line"></span><br><span class="line">![image-20221104202904428](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211042029726.png)</span><br><span class="line"></span><br><span class="line">![image-20221104203207570](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211042032135.png)</span><br><span class="line"></span><br><span class="line">![image-20221104203244373](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211042032847.png)</span><br><span class="line"></span><br><span class="line">![image-20221104203541357](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211042035853.png)</span><br><span class="line"></span><br><span class="line">### ä¸Šä¸‹æ–‡åˆ‡æ¢</span><br><span class="line"></span><br><span class="line">![image-20221104203632771](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211042036676.png)</span><br><span class="line"></span><br><span class="line">![image-20221104203950516](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211042039221.png)</span><br><span class="line"></span><br><span class="line">![image-20221104204600381](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211042046492.png)</span><br><span class="line"></span><br><span class="line">### è¿›ç¨‹æ§åˆ¶</span><br><span class="line"></span><br><span class="line">#### åŠ è½½æ‰§è¡Œè¿›ç¨‹</span><br><span class="line"></span><br><span class="line">![image-20221104204728497](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211042047592.png)</span><br><span class="line"></span><br><span class="line">![image-20221104205018688](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211042050789.png)</span><br><span class="line"></span><br><span class="line">![image-20221104205229519](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211042052610.png)</span><br><span class="line"></span><br><span class="line">![image-20221104205306761](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211042053855.png)</span><br><span class="line"></span><br><span class="line">#### ç­‰å¾…å’Œç»ˆæ­¢è¿›ç¨‹</span><br><span class="line"></span><br><span class="line">![image-20221104205727684](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211042057809.png)</span><br><span class="line"></span><br><span class="line">çˆ¶è¿›ç¨‹è¦ç­‰å¾…å­è¿›ç¨‹çš„exit()ï¼Œåæ¥å›æ”¶è¿›ç¨‹æ§åˆ¶å—PCBï¼Œè¿™ä¸€å—å¼€é”€ï¼Œå­è¿›ç¨‹è‡ªå·±é‡Šæ”¾ä¸æ‰ã€‚</span><br><span class="line"></span><br><span class="line">![image-20221104210247662](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211042102757.png)</span><br><span class="line"></span><br><span class="line">è¿˜æœ‰ä¸€ç§æƒ…å†µï¼Œå­è¿›ç¨‹æ‰§è¡Œexit()åï¼Œçˆ¶è¿›ç¨‹è¿˜æ²¡æ¥å¾—åŠé‡Šæ”¾å­è¿›ç¨‹çš„PCBï¼Œè¿™ä¸ªæ—¶å€™å­è¿›ç¨‹å¤„äºåƒµå°¸æ€ã€‚(zombie)</span><br><span class="line"></span><br><span class="line">å¦‚æœçˆ¶è¿›ç¨‹å·²ç»æ­»äº†ï¼Œå­è¿›ç¨‹çš„PCBè¿˜æ²¡æ¥å¾—åŠé‡Šæ”¾ï¼Œå¤„äºåƒµå°¸æ€ã€‚æ“ä½œç³»ç»Ÿä¼šæ‰«ææ ¹è¿›ç¨‹æ¥é‡Šæ”¾åƒµå°¸æ€çš„è¿›ç¨‹ï¼Œæ¸…ç†ç©ºé—´ã€‚</span><br><span class="line"></span><br><span class="line">![image-20221104210710818](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211042107922.png)</span><br><span class="line"></span><br><span class="line">æ‰§è¡Œexec()ç³»ç»Ÿå¯ä»¥å¤„äºä¸åŒçŠ¶æ€ã€‚</span><br><span class="line"></span><br><span class="line">- è¢«è°ƒåº¦</span><br><span class="line">- è¢«é˜»å¡</span><br><span class="line"></span><br><span class="line">## è°ƒåº¦</span><br><span class="line"></span><br><span class="line">### èƒŒæ™¯</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171317139.png&quot; alt=&quot;image-20221117131753050&quot; style=&quot;zoom:67%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">![image-20221117131903172](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171319253.png)</span><br><span class="line"></span><br><span class="line">&lt;img src=&quot;https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171320607.png&quot; alt=&quot;image-20221117132008510&quot; style=&quot;zoom:80%;&quot; /&gt;</span><br><span class="line"></span><br><span class="line">**CPUè°ƒåº¦æ–¹å¼**</span><br><span class="line"></span><br><span class="line">(1)ä¸å¯æŠ¢å </span><br><span class="line"></span><br><span class="line">è°ƒåº¦ç¨‹åºå¿…é¡»ç­‰å¾…äº‹ä»¶ç»“æŸ(æ•ˆç‡ä½ï¼Œä¸é‡‡ç”¨)ï¼›</span><br><span class="line"></span><br><span class="line">(2)å¯ä»¥æŠ¢å </span><br><span class="line"></span><br><span class="line">- è°ƒåº¦ç¨‹åºåœ¨ä¸­æ–­è¢«å“åº”åæ‰§è¡Œï¼›</span><br><span class="line">- å½“å‰çš„è¿›ç¨‹ä»è¿è¡Œåˆ‡æ¢åˆ°å°±ç»ªï¼Œæˆ–è€…ä¸€ä¸ªè¿›ç¨‹ä»ç­‰å¾…åˆ‡æ¢åˆ°å°±ç»ªï¼›</span><br><span class="line">- å½“å‰è¿è¡Œçš„è¿›ç¨‹å¯ä»¥è¢«æ¢å‡ºã€‚</span><br><span class="line"></span><br><span class="line">æ³¨æ„ï¼Œä»¥ä¸Šä¸€èˆ¬æŒ‡ç”¨æˆ·æ€ï¼›å†…æ ¸æ€ä¹Ÿå¯èƒ½æ¶‰åŠåˆ°æ˜¯å¦æŠ¢å ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ç°åœ¨æ“ä½œç³»ç»Ÿå¸¸ç”¨çš„å°±æ˜¯æŠ¢å å¼çš„è°ƒåº¦ç­–ç•¥ã€‚</span><br><span class="line"></span><br><span class="line">### è°ƒåº¦åŸåˆ™</span><br><span class="line"></span><br><span class="line">![image-20221117161918259](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171619394.png)</span><br><span class="line"></span><br><span class="line">#### è¯„ä»·æŒ‡æ ‡</span><br><span class="line"></span><br><span class="line">![image-20221117161935593](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171619680.png)</span><br><span class="line"></span><br><span class="line">![image-20221117162309343](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171623440.png)</span><br><span class="line"></span><br><span class="line">#### ç†æƒ³çš„è°ƒåº¦åŸåˆ™</span><br><span class="line"></span><br><span class="line">![image-20221117162517231](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171625329.png)</span><br><span class="line"></span><br><span class="line">![image-20221117162602080](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171626155.png)</span><br><span class="line"></span><br><span class="line">#### è°ƒåº¦å…¬å¹³æ€§</span><br><span class="line"></span><br><span class="line">![image-20221117162715043](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171627116.png)</span><br><span class="line"></span><br><span class="line">### è°ƒåº¦ç®—æ³•</span><br><span class="line"></span><br><span class="line">![image-20221117162827019](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171628102.png)</span><br><span class="line"></span><br><span class="line">#### å…ˆæ¥å…ˆæœåŠ¡</span><br><span class="line"></span><br><span class="line">![image-20221117162939645](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171629729.png)</span><br><span class="line"></span><br><span class="line">![image-20221117163158967](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171631052.png)</span><br><span class="line"></span><br><span class="line">![image-20221117163301181](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171633276.png)</span><br><span class="line"></span><br><span class="line">![image-20221117163433581](https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171634675.png)</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><p>ç›¸å½“äºP4å’ŒP5å„å°‘ç­‰ä¸€ä¸ªP3çš„æ‰§è¡Œæ—¶é—´ï¼Œä½†æ˜¯P3è¦å¤šç­‰ä¸€ä¸ªP4+P5çš„æ‰§è¡Œæ—¶é—´ï¼Œæ€»çš„ç®—ä¸‹æ¥è¿˜æ˜¯äºäº†</p><p>&#96;&#96;&#96;</p><p>ä¼˜ç‚¹ï¼šå¹³å‡ç­‰å¾…æ—¶é—´æœ€çŸ­</p><p>ç¼ºç‚¹ï¼š</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171637733.png" alt="image-20221117163741644"></p><p>é¢„ä¼°ç¨‹åºçš„æ‰§è¡Œæ—¶é—´ï¼ˆé€šè¿‡å½“å‰æ—¶é—´ï¼Œé¢„ä¼°æœªæ¥çš„æ‰§è¡Œæ—¶é—´ï¼Œç±»ä¼¼TCP rttï¼‰</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171639859.png" alt="image-20221117163951772"></p><h4 id="æœ€é«˜å“åº”æ¯”ä¼˜å…ˆ"><a href="#æœ€é«˜å“åº”æ¯”ä¼˜å…ˆ" class="headerlink" title="æœ€é«˜å“åº”æ¯”ä¼˜å…ˆ"></a>æœ€é«˜å“åº”æ¯”ä¼˜å…ˆ</h4><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171641316.png" alt="image-20221117164131232"></p><p>Rè¶Šå¤§ï¼Œç­‰å¾…çš„å æ¯”è¶Šé«˜ï¼Œè¶Šéœ€è¦ä¼˜å…ˆç›¸åº”ã€‚</p><p>ç¼ºç‚¹ï¼šè¦ä¸è¦è€ƒè™‘æŠ¢å é—®é¢˜</p><p>ä¼˜ç‚¹ï¼šé¥¥é¥¿é—®é¢˜å¾—åˆ°æœ‰æ•ˆç¼“è§£ã€‚</p><h4 id="è½®è¯¢"><a href="#è½®è¯¢" class="headerlink" title="è½®è¯¢"></a>è½®è¯¢</h4><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171647555.png" alt="image-20221117164737470"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171647069.png" alt="image-20221117164758981"></p><p>è®¾å®šä¸€ä¸ªå›ºå®šçš„æ—¶é—´ç‰‡ï¼Œè¾¾åˆ°æ—¶é—´ç‰‡å°±æŠŠCPUè®©å‡ºæ¥ã€‚</p><p>æ¯ä¸€ä¸ªè¿›ç¨‹éƒ½æœ‰æœºä¼šè¢«æ‰§è¡Œã€‚ï¼ˆå…¬å¹³ï¼‰</p><p>é€šè¿‡ç­‰å¾…æ—¶é—´æ¥è¡¡é‡è½®è¯¢è°ƒåº¦ç®—æ³•æ•ˆç‡ã€‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171649040.png" alt="image-20221117164956958"></p><p>æ—¶é—´ç‰‡çš„é€‰æ‹©å°¤ä¸ºé‡è¦ã€‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171651274.png" alt="image-20221117165118170"></p><h4 id="å¤šçº§åé¦ˆé˜Ÿåˆ—"><a href="#å¤šçº§åé¦ˆé˜Ÿåˆ—" class="headerlink" title="å¤šçº§åé¦ˆé˜Ÿåˆ—"></a>å¤šçº§åé¦ˆé˜Ÿåˆ—</h4><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171653183.png" alt="image-20221117165308096"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171653187.png" alt="image-20221117165356096"></p><p>æ ¹æ®ä¼˜å…ˆçº§æ¥è¿›è¡Œè°ƒåº¦</p><blockquote><p>æ›´æ­£ï¼šæ—¶é—´é‡å­å¤§å°éšä¼˜å…ˆçº§å¢åŠ çº§åˆ«é™ä½</p></blockquote><h4 id="å…¬å¹³å…±äº«"><a href="#å…¬å¹³å…±äº«" class="headerlink" title="å…¬å¹³å…±äº«"></a>å…¬å¹³å…±äº«</h4><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171657927.png" alt="image-20221117165710833"></p><h4 id="å¦‚ä½•è¯„ä»·"><a href="#å¦‚ä½•è¯„ä»·" class="headerlink" title="å¦‚ä½•è¯„ä»·"></a>å¦‚ä½•è¯„ä»·</h4><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171658746.png" alt="image-20221117165839658"></p><p>æ€»ç»“ï¼š</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171659439.png" alt="image-20221117165936369"></p><h3 id="å®æ—¶è°ƒåº¦"><a href="#å®æ—¶è°ƒåº¦" class="headerlink" title="å®æ—¶è°ƒåº¦"></a>å®æ—¶è°ƒåº¦</h3><h4 id="å®æ—¶ç³»ç»Ÿ"><a href="#å®æ—¶ç³»ç»Ÿ" class="headerlink" title="å®æ—¶ç³»ç»Ÿ"></a>å®æ—¶ç³»ç»Ÿ</h4><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171701049.png" alt="image-20221117170145971"></p><h4 id="å®æ—¶ç³»ç»Ÿçš„åˆ†ç±»"><a href="#å®æ—¶ç³»ç»Ÿçš„åˆ†ç±»" class="headerlink" title="å®æ—¶ç³»ç»Ÿçš„åˆ†ç±»"></a>å®æ—¶ç³»ç»Ÿçš„åˆ†ç±»</h4><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171702398.png" alt="image-20221117170233321"></p><h4 id="å®æ—¶è°ƒåº¦çš„æè¿°"><a href="#å®æ—¶è°ƒåº¦çš„æè¿°" class="headerlink" title="å®æ—¶è°ƒåº¦çš„æè¿°"></a>å®æ—¶è°ƒåº¦çš„æè¿°</h4><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171703382.png" alt="image-20221117170332299"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171704945.png" alt="image-20221117170431859"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171705236.png" alt="image-20221117170510147"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171705050.png" alt="image-20221117170545971"></p><p>é™æ€ä¼˜å…ˆçº§è°ƒåº¦ï¼šä»»åŠ¡å¼€å§‹ä¹‹å‰å·²ç»å®šä¹‰å¥½äº†ä¼˜å…ˆçº§ã€‚</p><p>åŠ¨æ€ä¼˜å…ˆçº§è°ƒåº¦ï¼šä»»åŠ¡å¼€å§‹åï¼Œæ ¹æ®ä»»åŠ¡çš„è¿è¡Œæƒ…å†µï¼Œå®šä¹‰ä¼˜å…ˆçº§ã€‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171706243.png" alt="image-20221117170652159"></p><h3 id="å¤šå¤„ç†å™¨è°ƒåº¦"><a href="#å¤šå¤„ç†å™¨è°ƒåº¦" class="headerlink" title="å¤šå¤„ç†å™¨è°ƒåº¦"></a>å¤šå¤„ç†å™¨è°ƒåº¦</h3><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171708865.png" alt="image-20221117170841772"></p><p>é’ˆå¯¹å¤šå¤„ç†å™¨ç³»ç»Ÿï¼Œèƒ½å¦è¾¾åˆ°è´Ÿè½½å‡è¡¡ã€‚</p><h3 id="ä¼˜å…ˆçº§åè½¬"><a href="#ä¼˜å…ˆçº§åè½¬" class="headerlink" title="ä¼˜å…ˆçº§åè½¬"></a>ä¼˜å…ˆçº§åè½¬</h3><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171711099.png" alt="image-20221117171118959"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171713649.png" alt="image-20221117171300574"></p><p>é—®é¢˜ï¼šä¼˜å…ˆçº§ï¼šT1&gt;T2&gt;T3ï¼›T1å’ŒT3å…±äº«æŸä¸€å—èµ„æºï¼Œè€Œæ­£è¢«T3å ç”¨ï¼ŒT1ç­‰å¾…ï¼ŒT2æŠ¢å T3ï¼Œäºæ˜¯T3ç­‰å¾…ï¼Œè¿›è€Œå¯¼è‡´T1ç­‰å¾…ï¼Œè€ŒT1ä¼˜å…ˆçº§é«˜äºT3ï¼Œäº§ç”ŸçŸ›ç›¾ï¼Œç§°ä¸ºä¼˜å…ˆçº§åè½¬ã€‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171715763.png" alt="image-20221117171508686"></p><p>è§£å†³æ–¹æ³•ï¼šä¼˜å…ˆçº§ç»§æ‰¿</p><p>å½“T3æ‹¿äº†T1çš„è´¡çŒ®èµ„æºæ—¶ï¼Œè®©T3çš„ä¼˜å…ˆçº§&#x3D;T1ä¼˜å…ˆçº§ï¼Œå…ˆæ‰§è¡Œå®ŒT3ï¼Œå°±å¯ä»¥æ¥ç€æ‰§è¡ŒT1äº†ï¼Œè€Œä¸”ä¸ä¼šè¢«T2æ‰“æ–­ã€‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171717098.png" alt="image-20221117171708021"></p><h2 id="åŒæ­¥"><a href="#åŒæ­¥" class="headerlink" title="åŒæ­¥"></a>åŒæ­¥</h2><h3 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h3><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192018022.png" alt="image-20221119201800034"></p><blockquote><p>ç‹¬ç«‹çš„çº¿ç¨‹ï¼š</p><ul><li>ä¸å’Œå…¶ä»–çº¿ç¨‹å…±äº«èµ„æºæˆ–çŠ¶æ€</li><li>ç¡®å®šæ€§ï¼šè¾“å…¥çŠ¶æ€å†³å®šç»“æœ</li><li>å¯é‡ç°ï¼šèƒ½å¤Ÿé‡ç°èµ·å§‹æ¡ä»¶I&#x2F;O</li><li>è°ƒåº¦é¡ºåºä¸é‡è¦</li></ul><p>åˆä½œçº¿ç¨‹ï¼š</p><ul><li>åœ¨å¤šä¸ªçº¿ç¨‹ä¸­å…±äº«çŠ¶æ€</li><li>ä¸ç¡®å®šæ€§</li><li>ä¸å¯é‡ç°</li></ul><p>ä¸ç¡®å®šæ€§å’Œä¸å¯é‡ç°æ„å‘³ç€bugå¯èƒ½æ˜¯é—´æ­‡æ€§å‘ç”Ÿçš„ã€‚</p></blockquote><p>åˆä½œçš„ä¼˜ç‚¹ï¼š</p><ol><li>å…±äº«èµ„æº</li><li>åŠ é€Ÿ</li><li>æ¨¡å—åŒ–</li></ol><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192023554.png" alt="image-20221119202302449"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192024235.png" alt="image-20221119202433106"></p><p>next_pidç³»ç»Ÿå½“å‰æœ€é«˜çš„è¿›ç¨‹idå·</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192028424.png" alt="image-20221119202811321"></p><blockquote><p>åœ¨åˆ‡æ¢åˆ°è¿›ç¨‹2æ—¶ï¼Œä¼šä¿å­˜è¿›ç¨‹1çš„çŠ¶æ€å€¼ï¼Œæ‰€ä»¥åœ¨åˆ‡å›æ¥æ—¶ï¼Œreg1 &#x3D; 1</p></blockquote><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192030861.png" alt="image-20221119203053757"></p><h3 id="ä¸€äº›æ¦‚å¿µ"><a href="#ä¸€äº›æ¦‚å¿µ" class="headerlink" title="ä¸€äº›æ¦‚å¿µ"></a>ä¸€äº›æ¦‚å¿µ</h3><h4 id="ç«æ€æ¡ä»¶"><a href="#ç«æ€æ¡ä»¶" class="headerlink" title="ç«æ€æ¡ä»¶"></a>ç«æ€æ¡ä»¶</h4><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192032302.png" alt="image-20221119203254209"></p><h4 id="åŸå­æ“ä½œ"><a href="#åŸå­æ“ä½œ" class="headerlink" title="åŸå­æ“ä½œ"></a>åŸå­æ“ä½œ</h4><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192033523.png" alt="image-20221119203325393"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192036893.png" alt="image-20221119203640782"> </p><h4 id="ä¸€äº›æ¦‚å¿µ-1"><a href="#ä¸€äº›æ¦‚å¿µ-1" class="headerlink" title="ä¸€äº›æ¦‚å¿µ"></a>ä¸€äº›æ¦‚å¿µ</h4><p> <img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192040419.png" alt="image-20221119204019305"></p><h4 id="ä¸¾ä¾‹"><a href="#ä¸¾ä¾‹" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h4><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192044785.png" alt="image-20221119204455657"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192046358.png" alt="image-20221119204637236"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192048908.png" alt="image-20221119204827809"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192051717.png" alt="image-20221119205101608"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192052003.png" alt="image-20221119205201899"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192053889.png" alt="image-20221119205327759"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192056245.png" alt="image-20221119205609145"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192056089.png" alt="image-20221119205656972"></p><p>å¯ä»¥è§£å†³è´­ä¹°é¢åŒ…çš„æƒ…å†µã€‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192059252.png" alt="image-20221119205938148"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192104204.png" alt="image-20221119210332907"></p><h3 id="ä¸´ç•ŒåŒº"><a href="#ä¸´ç•ŒåŒº" class="headerlink" title="ä¸´ç•ŒåŒº"></a>ä¸´ç•ŒåŒº</h3><p>  <img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192104103.png"></p><h3 id="æ–¹æ³•ä¸€ï¼šç¦ç”¨ç¡¬ä»¶ä¸­æ–­"><a href="#æ–¹æ³•ä¸€ï¼šç¦ç”¨ç¡¬ä»¶ä¸­æ–­" class="headerlink" title="æ–¹æ³•ä¸€ï¼šç¦ç”¨ç¡¬ä»¶ä¸­æ–­"></a>æ–¹æ³•ä¸€ï¼šç¦ç”¨ç¡¬ä»¶ä¸­æ–­</h3><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192106028.png" alt="image-20221119210623922"></p><ul><li><p>è¿›å…¥ä¸´ç•ŒåŒºï¼š<strong>å±è”½ä¸­æ–­</strong></p></li><li><p>å‡ºä¸´ç•ŒåŒºï¼š<strong>å¼€å¯ä¸­æ–­</strong></p></li></ul><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192107696.png" alt="image-20221119210747586"></p><p>å¤šCPUå±è”½ä¸€ä¸ªä¸­æ–­ï¼Œæ— æ³•è§£å†³äº’æ–¥é—®é¢˜ã€‚è€Œä¸”å±è”½ä¸­æ–­çš„è¯ï¼Œæœ‰å…¶ä»–è¯·æ±‚å°±è¦ç­‰å¾…ï¼Œå½±å“é€Ÿåº¦ã€‚</p><h3 id="æ–¹æ³•äºŒï¼šåŸºäºè½¯ä»¶çš„è§£å†³æ–¹æ³•"><a href="#æ–¹æ³•äºŒï¼šåŸºäºè½¯ä»¶çš„è§£å†³æ–¹æ³•" class="headerlink" title="æ–¹æ³•äºŒï¼šåŸºäºè½¯ä»¶çš„è§£å†³æ–¹æ³•"></a>æ–¹æ³•äºŒï¼šåŸºäºè½¯ä»¶çš„è§£å†³æ–¹æ³•</h3><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192110670.png" alt="image-20221119211028598"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192111800.png" alt="image-20221119211126722"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192119000.png" alt="image-20221119211913913"></p><p>â€‹                                                                        </p><p>æ— æ³•ä¿è¯äº’æ–¥ï¼Œå­˜åœ¨æ­»é”ã€‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192120672.png" alt="image-20221119212056573"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192122493.png" alt="image-20221119212250411"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192129641.png" alt="image-20221119212907562"></p><p>é’ˆå¯¹Nä¸ªè¿›ç¨‹å®ç°äº’æ–¥ï¼š</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192129732.png" alt="image-20221119212956649"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192130418.png" alt="image-20221119213030329"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192131833.png" alt="image-20221119213150737"></p><h3 id="æ–¹æ³•ä¸‰ï¼šæ›´é«˜çš„æŠ½è±¡"><a href="#æ–¹æ³•ä¸‰ï¼šæ›´é«˜çš„æŠ½è±¡" class="headerlink" title="æ–¹æ³•ä¸‰ï¼šæ›´é«˜çš„æŠ½è±¡"></a>æ–¹æ³•ä¸‰ï¼šæ›´é«˜çš„æŠ½è±¡</h3><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192132295.png" alt="image-20221119213254200"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192133891.png" alt="image-20221119213314802"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192133611.png" alt="image-20221119213354336"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192134728.png" alt="image-20221119213455651"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192140003.png" alt="image-20221119214007913"></p><p>å¦‚æœé”è¢«é‡Šæ”¾ï¼Œè¿”å›å€¼æ˜¯0ï¼Œè®¾ç½®targetä¸º1ï¼Œè·³å‡ºå¾ªç¯ï¼Œè¿›å…¥ç­‰å¾…åŒºã€‚</p><p>å¦‚æœé”æ²¡è¢«é‡Šæ”¾ï¼Œè¿”å›å€¼æ˜¯1ï¼Œè®¾ç½®targetä¸º1ï¼ŒæŒç»­å¾ªç¯ï¼Œå¿™ç­‰ï¼Œç­‰å¾…é‡Šæ”¾é”ã€‚</p><p>ä¸ç®¡å¯ä»¥æ”¯æŒ2çº¿ç¨‹ï¼Œè¿˜å¯ä»¥æ”¯æŒnçº¿ç¨‹ã€‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192142681.png" alt="image-20221119214206586"></p><p>æ€ä¹ˆæ ·èƒ½ä¸å¿™ç­‰ï¼Ÿ</p><p>è®©ä»–è¿›è¡Œç¡çœ ï¼Œé‡Šæ”¾èµ„æºã€‚</p><p>ä¸»è¦æ˜¯çœ‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€å’Œå¿™ç­‰çš„å¼€é”€ã€‚ç¡çœ çš„è¯ï¼Œå”¤é†’æ—¶ï¼Œä¼šè¿›è¡Œè¿›ç¨‹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192142564.png" alt="image-20221119214247477"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192144370.png" alt="image-20221119214441291"></p><p>å¦‚æœé”è¢«é‡Šæ”¾ï¼Œlockæ˜¯0ï¼Œkeyä¸º1ï¼Œexchange, lock &#x3D; 1ï¼Œè¿›å…¥ç­‰å¾…åŒºã€‚</p><p>å¦‚æœé”æ²¡è¢«é‡Šæ”¾,lockæ˜¯1ï¼ŒæŒç»­å¾ªç¯ï¼Œå¿™ç­‰ï¼Œç­‰å¾…é‡Šæ”¾é”lock &#x3D; 0ã€‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192147000.png" alt="image-20221119214733923"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211231916054.png" alt="image-20221119214749866"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211192148796.png" alt="image-20221119214851711"></p>]]></content>
      
      
      <categories>
          
          <category> è®¡ç®—æœºåŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ“ä½œç³»ç»Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®—æ³•æ€»ç»“</title>
      <link href="/2022/11/20/%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/"/>
      <url>/2022/11/20/%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<blockquote><p>éƒ¨åˆ†æ¥æºäºï¼š</p><p>åŠ›æ‰£Krahetsï¼Œé“¾æ¥ï¼š<a href="https://leetcode.cn/leetbook/read/illustration-of-algorithm/5dj09d/">https://leetcode.cn/leetbook/read/illustration-of-algorithm/5dj09d/</a></p><p>ä»£ç éšæƒ³å½•</p></blockquote><h1 id="ç®—æ³•æ€»ç»“"><a href="#ç®—æ³•æ€»ç»“" class="headerlink" title="ç®—æ³•æ€»ç»“"></a>ç®—æ³•æ€»ç»“</h1><h2 id="äºŒåˆ†æœç´¢"><a href="#äºŒåˆ†æœç´¢" class="headerlink" title="äºŒåˆ†æœç´¢"></a>äºŒåˆ†æœç´¢</h2><p>Binary Search</p><p>å¯¹äºå·²ç»æœ‰åºçš„æ•°ç»„ï¼Œä½¿ç”¨äºŒåˆ†æœç´¢åŠ å¿«æœç´¢é€Ÿåº¦ã€‚</p><p>æ—¶é—´å¤æ‚åº¦O(logN)</p><p>äºŒåˆ†æ³•çš„ä¸¤ç§å†™æ³•ï¼š</p><ul><li>å·¦é—­å³é—­[left,right]</li><li>å·¦é—­å³å¼€[left,right)</li></ul><h3 id="å·¦é—­å³é—­"><a href="#å·¦é—­å³é—­" class="headerlink" title="å·¦é—­å³é—­"></a>å·¦é—­å³é—­</h3><p> target æ˜¯åœ¨ä¸€ä¸ªåœ¨å·¦é—­å³é—­çš„åŒºé—´é‡Œï¼Œ[left, right] ã€‚</p><p>å¯¹äºå·¦é—­å³é—­çš„å†™æ³•ï¼š</p><ul><li>while (left &lt;&#x3D; right) è¦ä½¿ç”¨ &lt;&#x3D; ï¼Œå› ä¸ºleft &#x3D;&#x3D; rightæ˜¯æœ‰æ„ä¹‰çš„ï¼Œæ‰€ä»¥ä½¿ç”¨ &lt;&#x3D;</li><li>if (nums[middle] &gt; target) right è¦èµ‹å€¼ä¸º middle - 1ï¼Œå› ä¸ºå½“å‰è¿™ä¸ªnums[middle]ä¸€å®šä¸æ˜¯targetï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥è¦æŸ¥æ‰¾çš„å·¦åŒºé—´ç»“æŸä¸‹æ ‡ä½ç½®å°±æ˜¯ middle - 1</li></ul><img src="https://img-blog.csdnimg.cn/20210311153055723.jpg" alt="704.äºŒåˆ†æŸ¥æ‰¾" style="zoom:100%;" /><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å·¦é—­å³é—­</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">binarySearch1</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> nums.length - <span class="number">1</span>;<span class="comment">//åŒºé—´[leftï¼Œright]è¦æœ‰æ„ä¹‰</span></span><br><span class="line">    <span class="keyword">while</span> (left &lt;= right) &#123;<span class="comment">//æ³¨æ„ç‚¹1</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> left + ((right - left) / <span class="number">2</span>);<span class="comment">//é˜²æ­¢æº¢å‡º</span></span><br><span class="line">        <span class="keyword">if</span> (nums[mid] &lt; target) &#123;</span><br><span class="line">            left = mid + <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nums[mid] &gt; target) &#123;</span><br><span class="line">            right = mid - <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">return</span> mid;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å·¦é—­å³å¼€"><a href="#å·¦é—­å³å¼€" class="headerlink" title="å·¦é—­å³å¼€"></a>å·¦é—­å³å¼€</h3><p>å®šä¹‰ target æ˜¯åœ¨ä¸€ä¸ªåœ¨å·¦é—­å³å¼€çš„åŒºé—´é‡Œï¼Œä¹Ÿå°±æ˜¯[left, right)ã€‚</p><p>å¯¹äºå·¦é—­å³å¼€çš„å†™æ³•ï¼š</p><ul><li>while (left &lt; right)ï¼Œè¿™é‡Œä½¿ç”¨ &lt; ,å› ä¸ºleft &#x3D;&#x3D; rightåœ¨åŒºé—´[left, right)æ˜¯æ²¡æœ‰æ„ä¹‰çš„</li><li>if (nums[middle] &gt; target) right æ›´æ–°ä¸º middleï¼Œå› ä¸ºå½“å‰nums[middle]ä¸ç­‰äºtargetï¼Œå»å·¦åŒºé—´ç»§ç»­å¯»æ‰¾ï¼Œè€Œå¯»æ‰¾åŒºé—´æ˜¯å·¦é—­å³å¼€åŒºé—´ï¼Œæ‰€ä»¥rightæ›´æ–°ä¸ºmiddleï¼Œå³ï¼šä¸‹ä¸€ä¸ªæŸ¥è¯¢åŒºé—´ä¸ä¼šå»æ¯”è¾ƒnums[middle]</li></ul><p><img src="https://img-blog.csdnimg.cn/20210311153123632.jpg"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å·¦é—­å³å¼€</span></span><br><span class="line"><span class="comment"> * */</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">binarySearch2</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> nums.length;<span class="comment">//åŒºé—´[left,right)</span></span><br><span class="line">    <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> left + ((right - left) / <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">if</span> (nums[mid] &lt; target) &#123;<span class="comment">//å·¦é—­</span></span><br><span class="line">            left = mid + <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nums[mid] &gt; target) &#123;<span class="comment">//å³å¼€</span></span><br><span class="line">            right = mid;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">return</span> mid;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="LC69-x-çš„å¹³æ–¹æ ¹"><a href="#LC69-x-çš„å¹³æ–¹æ ¹" class="headerlink" title="LC69 x çš„å¹³æ–¹æ ¹"></a>LC69 x çš„å¹³æ–¹æ ¹</h3><p>ç»™ä½ ä¸€ä¸ªéè´Ÿæ•´æ•° <code>x</code> ï¼Œè®¡ç®—å¹¶è¿”å› <code>x</code> çš„ <strong>ç®—æœ¯å¹³æ–¹æ ¹</strong> ã€‚</p><p>ç”±äºè¿”å›ç±»å‹æ˜¯æ•´æ•°ï¼Œç»“æœåªä¿ç•™ <strong>æ•´æ•°éƒ¨åˆ†</strong> ï¼Œå°æ•°éƒ¨åˆ†å°†è¢« <strong>èˆå» ã€‚</strong></p><p><strong>æ³¨æ„ï¼š</strong>ä¸å…è®¸ä½¿ç”¨ä»»ä½•å†…ç½®æŒ‡æ•°å‡½æ•°å’Œç®—ç¬¦ï¼Œä¾‹å¦‚ <code>pow(x, 0.5)</code> æˆ–è€… <code>x ** 0.5</code> ã€‚</p><p>åˆ©ç”¨äºŒåˆ†æ³•çš„æ€è·¯ï¼Œåœ¨0~x-1ä¸­æœç´¢å‡ºä»–çš„å¹³æ–¹æ ¹ï¼Œæ’é™¤ç‰¹ä¾‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">mySqrt</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * äºŒåˆ†æŸ¥æ‰¾</span></span><br><span class="line"><span class="comment">     * [left,right)</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="comment">//å› ä¸ºå®šä¹‰çš„åŒºé—´ä¸ºå·¦é—­å³å¼€ï¼Œå¯¹äºxï¼Œå½“x &lt; 2çš„æ—¶å€™ï¼Œxæ‰ä¼šå–0 or x å³ 0 1</span></span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">2</span>) <span class="keyword">return</span> x;</span><br><span class="line">    <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> x;</span><br><span class="line">    <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> left + ((right - left) / <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">if</span> (mid &gt; x / mid) &#123;</span><br><span class="line">            <span class="comment">//mid &gt; x / midé˜²æ­¢æº¢å‡º</span></span><br><span class="line">            right = mid;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mid &lt; x / mid) &#123;</span><br><span class="line">            left = mid + <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">return</span> mid;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> right - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="LC367-æœ‰æ•ˆçš„å®Œå…¨å¹³æ–¹æ•°"><a href="#LC367-æœ‰æ•ˆçš„å®Œå…¨å¹³æ–¹æ•°" class="headerlink" title="LC367 æœ‰æ•ˆçš„å®Œå…¨å¹³æ–¹æ•°"></a>LC367 æœ‰æ•ˆçš„å®Œå…¨å¹³æ–¹æ•°</h3><p>ç»™å®šä¸€ä¸ª <strong>æ­£æ•´æ•°</strong> <code>num</code> ï¼Œç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œå¦‚æœ <code>num</code> æ˜¯ä¸€ä¸ªå®Œå…¨å¹³æ–¹æ•°ï¼Œåˆ™è¿”å› <code>true</code> ï¼Œå¦åˆ™è¿”å› <code>false</code> ã€‚</p><p><strong>è¿›é˜¶ï¼šä¸è¦</strong> ä½¿ç”¨ä»»ä½•å†…ç½®çš„åº“å‡½æ•°ï¼Œå¦‚ <code>sqrt</code> ã€‚</p><p>é˜²æ­¢è¶Šç•Œï¼Œç”¨longè¡¨ç¤ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* äºŒåˆ†æ³•</span></span><br><span class="line"><span class="comment">* [left,right]å·¦é—­å³é—­</span></span><br><span class="line"><span class="comment">* */</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isPerfectSquare</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> num;</span><br><span class="line">    <span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> left + ((right - left) / <span class="number">2</span>);</span><br><span class="line">        <span class="type">long</span> <span class="variable">square</span> <span class="operator">=</span> (<span class="type">long</span>) mid * mid;</span><br><span class="line">        <span class="keyword">if</span> (square &gt; num) &#123;</span><br><span class="line">            right = mid - <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (square &lt; num) &#123;</span><br><span class="line">            left = mid + <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åŒæŒ‡é’ˆæ³•"><a href="#åŒæŒ‡é’ˆæ³•" class="headerlink" title="åŒæŒ‡é’ˆæ³•"></a>åŒæŒ‡é’ˆæ³•</h2><p>åŒæŒ‡é’ˆæ³•ï¼ˆå¿«æ…¢æŒ‡é’ˆæ³•ï¼‰ï¼š <strong>é€šè¿‡ä¸€ä¸ªå¿«æŒ‡é’ˆå’Œæ…¢æŒ‡é’ˆåœ¨ä¸€ä¸ªforå¾ªç¯ä¸‹å®Œæˆä¸¤ä¸ªforå¾ªç¯çš„å·¥ä½œã€‚</strong></p><p><strong>åŒæŒ‡é’ˆæ³•ï¼ˆå¿«æ…¢æŒ‡é’ˆæ³•ï¼‰åœ¨æ•°ç»„å’Œé“¾è¡¨çš„æ“ä½œä¸­æ˜¯éå¸¸å¸¸è§çš„ï¼Œå¾ˆå¤šè€ƒå¯Ÿæ•°ç»„ã€é“¾è¡¨ã€å­—ç¬¦ä¸²ç­‰æ“ä½œçš„é¢è¯•é¢˜ï¼Œéƒ½ä½¿ç”¨åŒæŒ‡é’ˆæ³•ã€‚</strong></p><h3 id="ç§»é™¤æ•°ç»„å…ƒç´ "><a href="#ç§»é™¤æ•°ç»„å…ƒç´ " class="headerlink" title="ç§»é™¤æ•°ç»„å…ƒç´ "></a>ç§»é™¤æ•°ç»„å…ƒç´ </h3><p>å®šä¹‰å¿«æ…¢æŒ‡é’ˆ</p><ul><li>å¿«æŒ‡é’ˆï¼šå¯»æ‰¾æ–°æ•°ç»„çš„å…ƒç´  ï¼Œæ–°æ•°ç»„å°±æ˜¯ä¸å«æœ‰ç›®æ ‡å…ƒç´ çš„æ•°ç»„</li><li>æ…¢æŒ‡é’ˆï¼šæŒ‡å‘æ›´æ–° æ–°æ•°ç»„ä¸‹æ ‡çš„ä½ç½®</li></ul><p><img src="https://tva1.sinaimg.cn/large/008eGmZEly1gntrds6r59g30du09mnpd.gif" alt="27.ç§»é™¤å…ƒç´ -åŒæŒ‡é’ˆæ³•"></p><h3 id="LC11-ç››æœ€å¤šæ°´çš„å®¹å™¨"><a href="#LC11-ç››æœ€å¤šæ°´çš„å®¹å™¨" class="headerlink" title="LC11. ç››æœ€å¤šæ°´çš„å®¹å™¨"></a>LC11. ç››æœ€å¤šæ°´çš„å®¹å™¨</h3><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º <code>n</code> çš„æ•´æ•°æ•°ç»„ <code>height</code> ã€‚æœ‰ <code>n</code> æ¡å‚çº¿ï¼Œç¬¬ <code>i</code> æ¡çº¿çš„ä¸¤ä¸ªç«¯ç‚¹æ˜¯ <code>(i, 0)</code> å’Œ <code>(i, height[i])</code> ã€‚</p><p>æ‰¾å‡ºå…¶ä¸­çš„ä¸¤æ¡çº¿ï¼Œä½¿å¾—å®ƒä»¬ä¸ <code>x</code> è½´å…±åŒæ„æˆçš„å®¹å™¨å¯ä»¥å®¹çº³æœ€å¤šçš„æ°´ã€‚</p><p>è¿”å›å®¹å™¨å¯ä»¥å‚¨å­˜çš„æœ€å¤§æ°´é‡ã€‚</p><p><strong>è¯´æ˜ï¼š</strong>ä½ ä¸èƒ½å€¾æ–œå®¹å™¨ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://aliyun-lc-upload.oss-cn-hangzhou.aliyuncs.com/aliyun-lc-upload/uploads/2018/07/25/question_11.jpg" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼š[1,8,6,2,5,4,8,3,7]</span><br><span class="line">è¾“å‡ºï¼š49 </span><br><span class="line">è§£é‡Šï¼šå›¾ä¸­å‚ç›´çº¿ä»£è¡¨è¾“å…¥æ•°ç»„ [1,8,6,2,5,4,8,3,7]ã€‚åœ¨æ­¤æƒ…å†µä¸‹ï¼Œå®¹å™¨èƒ½å¤Ÿå®¹çº³æ°´ï¼ˆè¡¨ç¤ºä¸ºè“è‰²éƒ¨åˆ†ï¼‰çš„æœ€å¤§å€¼ä¸º 49ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šheight = [1,1]</span><br><span class="line">è¾“å‡ºï¼š1</span><br></pre></td></tr></table></figure><p>é¢ç§¯ï¼šé«˜*å®½ min(height[left], height[right]) * (right - left)</p><ol><li><p>åˆå§‹åŒ–ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸¤ä¸ªè¾¹ï¼Œè¿™ä¸ªæ—¶å€™å®½æ˜¯æœ€å¤§çš„ã€‚</p></li><li><p>å½“ä¸¤ä¸ªè¾¹å‘å†…ç¼©å°çš„æ—¶å€™,å¦‚æœé«˜æ˜¯å¢å¤§çš„è¯ï¼Œæ‰æœ‰å¯èƒ½ä¼šå¢å¤§ï¼Œå¦‚æœé«˜æ˜¯å‡å°çš„å°±ä¸èƒ½å¢å¤§ã€‚</p></li><li><p>å› æ­¤åœ¨ç¼©å°çš„æ—¶å€™ï¼Œè®©é«˜å°½å¯èƒ½å˜å¤§ï¼Œå³ç¼©å°é«˜å°çš„ä¸€è¾¹ã€‚ç›¸ç­‰çš„è¯ï¼Œä»»æ„ã€‚ï¼ˆæœ‰å¯èƒ½å­˜åœ¨å±±å³°çš„å½¢çŠ¶ï¼‰</p></li><li><p>è¿™æ ·ä¿è¯äº†åœ¨æ¯ä¸€æ¬¡é€‰æ‹©æ—¶éƒ½æ˜¯é€‰æ‹©æœ€å¤§çš„ï¼Œåœ¨éå†è¿‡ç¨‹ä¸­ç”¨resultè®°å½•æœ€å¤§å€¼è¿”å›ã€‚</p></li></ol><p>åªè¿›è¡Œäº†ä¸€æ¬¡éå†ã€‚<br>æ—¶é—´å¤æ‚åº¦O(N)<br>ç©ºé—´å¤æ‚åº¦O(1)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŒæŒ‡é’ˆ</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">maxArea</span><span class="params">(<span class="type">int</span>[] height)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> height.length - <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> (Math.min(height[left], height[right]) * (right - left));</span><br><span class="line">            result = Math.max(sum, result);</span><br><span class="line">            <span class="keyword">if</span> (height[left] &lt; height[right]) &#123;</span><br><span class="line">                left++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                right--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="LC141-ç¯å½¢é“¾è¡¨"><a href="#LC141-ç¯å½¢é“¾è¡¨" class="headerlink" title="LC141. ç¯å½¢é“¾è¡¨"></a>LC141. ç¯å½¢é“¾è¡¨</h3><p>ç»™ä½ ä¸€ä¸ªé“¾è¡¨çš„å¤´èŠ‚ç‚¹ <code>head</code> ï¼Œåˆ¤æ–­é“¾è¡¨ä¸­æ˜¯å¦æœ‰ç¯ã€‚</p><p>å¦‚æœé“¾è¡¨ä¸­æœ‰æŸä¸ªèŠ‚ç‚¹ï¼Œå¯ä»¥é€šè¿‡è¿ç»­è·Ÿè¸ª <code>next</code> æŒ‡é’ˆå†æ¬¡åˆ°è¾¾ï¼Œåˆ™é“¾è¡¨ä¸­å­˜åœ¨ç¯ã€‚ ä¸ºäº†è¡¨ç¤ºç»™å®šé“¾è¡¨ä¸­çš„ç¯ï¼Œè¯„æµ‹ç³»ç»Ÿå†…éƒ¨ä½¿ç”¨æ•´æ•° <code>pos</code> æ¥è¡¨ç¤ºé“¾è¡¨å°¾è¿æ¥åˆ°é“¾è¡¨ä¸­çš„ä½ç½®ï¼ˆç´¢å¼•ä» 0 å¼€å§‹ï¼‰ã€‚<strong>æ³¨æ„ï¼š<code>pos</code> ä¸ä½œä¸ºå‚æ•°è¿›è¡Œä¼ é€’</strong> ã€‚ä»…ä»…æ˜¯ä¸ºäº†æ ‡è¯†é“¾è¡¨çš„å®é™…æƒ…å†µã€‚</p><p><em>å¦‚æœé“¾è¡¨ä¸­å­˜åœ¨ç¯</em> ï¼Œåˆ™è¿”å› <code>true</code> ã€‚ å¦åˆ™ï¼Œè¿”å› <code>false</code> ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/07/circularlinkedlist.png" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šhead = [3,2,0,-4], pos = 1</span><br><span class="line">è¾“å‡ºï¼štrue</span><br><span class="line">è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œå…¶å°¾éƒ¨è¿æ¥åˆ°ç¬¬äºŒä¸ªèŠ‚ç‚¹ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/07/circularlinkedlist_test2.png" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šhead = [1,2], pos = 0</span><br><span class="line">è¾“å‡ºï¼štrue</span><br><span class="line">è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œå…¶å°¾éƒ¨è¿æ¥åˆ°ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/07/circularlinkedlist_test3.png" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šhead = [1], pos = -1</span><br><span class="line">è¾“å‡ºï¼šfalse</span><br><span class="line">è§£é‡Šï¼šé“¾è¡¨ä¸­æ²¡æœ‰ç¯ã€‚</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li>é“¾è¡¨ä¸­èŠ‚ç‚¹çš„æ•°ç›®èŒƒå›´æ˜¯ <code>[0, 104]</code></li><li><code>-105 &lt;= Node.val &lt;= 105</code></li><li><code>pos</code> ä¸º <code>-1</code> æˆ–è€…é“¾è¡¨ä¸­çš„ä¸€ä¸ª <strong>æœ‰æ•ˆç´¢å¼•</strong> ã€‚</li></ul><p><strong>è¿›é˜¶ï¼š</strong>ä½ èƒ½ç”¨ <code>O(1)</code>ï¼ˆå³ï¼Œå¸¸é‡ï¼‰å†…å­˜è§£å†³æ­¤é—®é¢˜å—ï¼Ÿ</p><p>åˆ¤æ–­é“¾è¡¨æœ‰æ²¡æœ‰ç¯</p><ol><li>å®šä¹‰å¿«æ…¢æŒ‡é’ˆï¼Œå¿«æŒ‡é’ˆæ¯æ¬¡èµ°ä¸¤æ­¥ï¼Œæ…¢æŒ‡é’ˆæ¯æ¬¡èµ°ä¸€æ­¥ã€‚</li><li>å¦‚æœå¿«æŒ‡é’ˆå…ˆåˆ°è¾¾äº†nullè¯æ˜æ²¡æœ‰ç¯ã€‚</li><li>å¦‚æœæ…¢æŒ‡é’ˆè¿½ä¸Šå¿«æŒ‡é’ˆï¼Œåˆ™è¯´æ˜æœ‰ç¯ã€‚</li><li>å½“å¿«æ…¢æŒ‡é’ˆç›¸é‡åï¼Œè®©å¿«æŒ‡é’ˆå¼€å§‹æ¯æ¬¡èµ°ä¸€æ­¥ï¼Œæ…¢æŒ‡é’ˆå›åˆ°åŸç‚¹ï¼Œå†æ¬¡è®©ä»–ä»¬ç›¸é‡å°±æ˜¯ç¯çš„å…¥å£èŠ‚</li><li><ol start="5"><li>æ•°å­¦è¯æ˜</li></ol></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŒæŒ‡é’ˆ</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasCycle</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(head == <span class="literal">null</span> || head.next == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">slow</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">fast</span> <span class="operator">=</span> head.next;</span><br><span class="line">        <span class="keyword">while</span> (slow != fast) &#123;</span><br><span class="line">            <span class="keyword">if</span> (fast == <span class="literal">null</span> || fast.next == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            fast = fast.next.next;</span><br><span class="line">            slow = slow.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="LC142-ç¯å½¢é“¾è¡¨II"><a href="#LC142-ç¯å½¢é“¾è¡¨II" class="headerlink" title="LC142. ç¯å½¢é“¾è¡¨II"></a>LC142. ç¯å½¢é“¾è¡¨II</h3><p>ç»™å®šä¸€ä¸ªé“¾è¡¨çš„å¤´èŠ‚ç‚¹ <code>head</code> ï¼Œè¿”å›é“¾è¡¨å¼€å§‹å…¥ç¯çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚ <em>å¦‚æœé“¾è¡¨æ— ç¯ï¼Œåˆ™è¿”å› <code>null</code>ã€‚</em></p><p>å¦‚æœé“¾è¡¨ä¸­æœ‰æŸä¸ªèŠ‚ç‚¹ï¼Œå¯ä»¥é€šè¿‡è¿ç»­è·Ÿè¸ª <code>next</code> æŒ‡é’ˆå†æ¬¡åˆ°è¾¾ï¼Œåˆ™é“¾è¡¨ä¸­å­˜åœ¨ç¯ã€‚ ä¸ºäº†è¡¨ç¤ºç»™å®šé“¾è¡¨ä¸­çš„ç¯ï¼Œè¯„æµ‹ç³»ç»Ÿå†…éƒ¨ä½¿ç”¨æ•´æ•° <code>pos</code> æ¥è¡¨ç¤ºé“¾è¡¨å°¾è¿æ¥åˆ°é“¾è¡¨ä¸­çš„ä½ç½®ï¼ˆ<strong>ç´¢å¼•ä» 0 å¼€å§‹</strong>ï¼‰ã€‚å¦‚æœ <code>pos</code> æ˜¯ <code>-1</code>ï¼Œåˆ™åœ¨è¯¥é“¾è¡¨ä¸­æ²¡æœ‰ç¯ã€‚<strong>æ³¨æ„ï¼š<code>pos</code> ä¸ä½œä¸ºå‚æ•°è¿›è¡Œä¼ é€’</strong>ï¼Œä»…ä»…æ˜¯ä¸ºäº†æ ‡è¯†é“¾è¡¨çš„å®é™…æƒ…å†µã€‚</p><p><strong>ä¸å…è®¸ä¿®æ”¹</strong> é“¾è¡¨ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://assets.leetcode.com/uploads/2018/12/07/circularlinkedlist.png" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šhead = [3,2,0,-4], pos = 1</span><br><span class="line">è¾“å‡ºï¼šè¿”å›ç´¢å¼•ä¸º 1 çš„é“¾è¡¨èŠ‚ç‚¹</span><br><span class="line">è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œå…¶å°¾éƒ¨è¿æ¥åˆ°ç¬¬äºŒä¸ªèŠ‚ç‚¹ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/07/circularlinkedlist_test2.png" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šhead = [1,2], pos = 0</span><br><span class="line">è¾“å‡ºï¼šè¿”å›ç´¢å¼•ä¸º 0 çš„é“¾è¡¨èŠ‚ç‚¹</span><br><span class="line">è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œå…¶å°¾éƒ¨è¿æ¥åˆ°ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/07/circularlinkedlist_test3.png" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šhead = [1], pos = -1</span><br><span class="line">è¾“å‡ºï¼šè¿”å› null</span><br><span class="line">è§£é‡Šï¼šé“¾è¡¨ä¸­æ²¡æœ‰ç¯ã€‚</span><br></pre></td></tr></table></figure><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210181732061.png" alt="image-20221018173023802" style="zoom:50%;" /><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> ListNode <span class="title function_">detectCycle</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="literal">null</span> || head.next == <span class="literal">null</span> || head.next.next == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">fast</span> <span class="operator">=</span> head.next.next;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">slow</span> <span class="operator">=</span> head.next;</span><br><span class="line">    <span class="keyword">while</span> (fast != <span class="literal">null</span> &amp;&amp; fast.next != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (slow == fast) &#123; <span class="comment">//æœ‰ç¯</span></span><br><span class="line">            slow = head;</span><br><span class="line">            <span class="keyword">while</span> (slow != fast) &#123;</span><br><span class="line">                slow = slow.next;</span><br><span class="line">                fast = fast.next;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> slow;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            slow = slow.next;</span><br><span class="line">            fast = fast.next.next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ»‘åŠ¨çª—å£"><a href="#æ»‘åŠ¨çª—å£" class="headerlink" title="æ»‘åŠ¨çª—å£"></a>æ»‘åŠ¨çª—å£</h2><p>æ»‘åŠ¨çª—å£ï¼Œ<strong>å°±æ˜¯ä¸æ–­çš„è°ƒèŠ‚å­åºåˆ—çš„èµ·å§‹ä½ç½®å’Œç»ˆæ­¢ä½ç½®ï¼Œä»è€Œå¾—å‡ºæˆ‘ä»¬è¦æƒ³çš„ç»“æœ</strong>ã€‚</p><p>åœ¨éå†ä¸€ä¸ªæ•°ç»„çš„è¿‡ç¨‹ä¸­ï¼š</p><p>åœ¨æš´åŠ›è§£æ³•ä¸­ï¼Œæ˜¯ä¸€ä¸ªforå¾ªç¯æ»‘åŠ¨çª—å£çš„èµ·å§‹ä½ç½®ï¼Œä¸€ä¸ªforå¾ªç¯ä¸ºæ»‘åŠ¨çª—å£çš„ç»ˆæ­¢ä½ç½®ï¼Œç”¨ä¸¤ä¸ªforå¾ªç¯å®Œæˆäº†ä¸€ä¸ªä¸æ–­æœç´¢åŒºé—´çš„è¿‡ç¨‹ã€‚</p><p>é‚£ä¹ˆæ»‘åŠ¨çª—å£å¦‚ä½•ç”¨ä¸€ä¸ªforå¾ªç¯æ¥å®Œæˆè¿™ä¸ªæ“ä½œå‘¢ã€‚</p><p>é¦–å…ˆè¦æ€è€ƒ å¦‚æœç”¨ä¸€ä¸ªforå¾ªç¯ï¼Œé‚£ä¹ˆåº”è¯¥è¡¨ç¤º æ»‘åŠ¨çª—å£çš„èµ·å§‹ä½ç½®ï¼Œè¿˜æ˜¯ç»ˆæ­¢ä½ç½®ã€‚</p><p>å¦‚æœåªç”¨ä¸€ä¸ªforå¾ªç¯æ¥è¡¨ç¤º æ»‘åŠ¨çª—å£çš„èµ·å§‹ä½ç½®ï¼Œé‚£ä¹ˆå¦‚ä½•éå†å‰©ä¸‹çš„ç»ˆæ­¢ä½ç½®ï¼Ÿæ­¤æ—¶éš¾å…å†æ¬¡é™·å…¥ æš´åŠ›è§£æ³•çš„æ€ªåœˆã€‚</p><p>æ‰€ä»¥åªç”¨ä¸€ä¸ªforå¾ªç¯ï¼Œé‚£ä¹ˆ<strong>è¿™ä¸ªå¾ªç¯çš„ç´¢å¼•ï¼Œä¸€å®šæ˜¯è¡¨ç¤ºæ»‘åŠ¨çª—å£çš„ç»ˆæ­¢ä½ç½®ã€‚</strong></p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œ æ»‘åŠ¨çª—å£çš„èµ·å§‹ä½ç½®å¦‚ä½•ç§»åŠ¨å‘¢ï¼Ÿ</p><p>è¿™é‡Œè¿˜æ˜¯ä»¥<code>é•¿åº¦æœ€å°çš„å­æ•°ç»„</code>ä¸­çš„ç¤ºä¾‹æ¥ä¸¾ä¾‹ï¼Œs&#x3D;7ï¼Œ æ•°ç»„æ˜¯ 2ï¼Œ3ï¼Œ1ï¼Œ2ï¼Œ4ï¼Œ3ï¼Œæ¥çœ‹ä¸€ä¸‹æŸ¥æ‰¾çš„è¿‡ç¨‹ï¼š</p><p><img src="https://code-thinking.cdn.bcebos.com/gifs/209.%E9%95%BF%E5%BA%A6%E6%9C%80%E5%B0%8F%E7%9A%84%E5%AD%90%E6%95%B0%E7%BB%84.gif" alt="209.é•¿åº¦æœ€å°çš„å­æ•°ç»„"></p><p>æœ€åæ‰¾åˆ° 4ï¼Œ3 æ˜¯æœ€çŸ­è·ç¦»ã€‚</p><p>å…¶å®ä»åŠ¨ç”»ä¸­å¯ä»¥å‘ç°<strong>æ»‘åŠ¨çª—å£ä¹Ÿå¯ä»¥ç†è§£ä¸ºåŒæŒ‡é’ˆæ³•çš„ä¸€ç§ï¼åªä¸è¿‡è¿™ç§è§£æ³•æ›´åƒæ˜¯ä¸€ä¸ªçª—å£çš„ç§»åŠ¨ï¼Œæ‰€ä»¥å«åšæ»‘åŠ¨çª—å£æ›´é€‚åˆä¸€äº›ã€‚</strong></p><p>å®ç°æ»‘åŠ¨çª—å£ï¼Œä¸»è¦ç¡®å®šå¦‚ä¸‹ä¸‰ç‚¹ï¼š</p><ul><li>çª—å£å†…æ˜¯ä»€ä¹ˆï¼Ÿ</li><li>å¦‚ä½•ç§»åŠ¨çª—å£çš„èµ·å§‹ä½ç½®ï¼Ÿ</li><li>å¦‚ä½•ç§»åŠ¨çª—å£çš„ç»“æŸä½ç½®ï¼Ÿ</li></ul><p><strong>æ»‘åŠ¨çª—å£çš„ç²¾å¦™ä¹‹å¤„åœ¨äºæ ¹æ®å½“å‰å­åºåˆ—å’Œå¤§å°çš„æƒ…å†µï¼Œä¸æ–­è°ƒèŠ‚å­åºåˆ—çš„èµ·å§‹ä½ç½®ã€‚ä»è€Œå°†O(n^2)æš´åŠ›è§£æ³•é™ä¸ºO(n)ã€‚</strong></p><h3 id="LC209-é•¿åº¦æœ€å°çš„å­æ•°ç»„"><a href="#LC209-é•¿åº¦æœ€å°çš„å­æ•°ç»„" class="headerlink" title="LC209. é•¿åº¦æœ€å°çš„å­æ•°ç»„"></a>LC209. é•¿åº¦æœ€å°çš„å­æ•°ç»„</h3><p>ç»™å®šä¸€ä¸ªå«æœ‰ <code>n</code> ä¸ªæ­£æ•´æ•°çš„æ•°ç»„å’Œä¸€ä¸ªæ­£æ•´æ•° <code>target</code> <strong>ã€‚</strong></p><p>æ‰¾å‡ºè¯¥æ•°ç»„ä¸­æ»¡è¶³å…¶å’Œ <code>â‰¥ target</code> çš„é•¿åº¦æœ€å°çš„ <strong>è¿ç»­å­æ•°ç»„</strong> <code>[numsl, numsl+1, ..., numsr-1, numsr]</code> ï¼Œå¹¶è¿”å›å…¶é•¿åº¦<strong>ã€‚</strong>å¦‚æœä¸å­˜åœ¨ç¬¦åˆæ¡ä»¶çš„å­æ•°ç»„ï¼Œè¿”å› <code>0</code> ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼štarget = 7, nums = [2,3,1,2,4,3]</span><br><span class="line">è¾“å‡ºï¼š2</span><br><span class="line">è§£é‡Šï¼šå­æ•°ç»„ [4,3] æ˜¯è¯¥æ¡ä»¶ä¸‹çš„é•¿åº¦æœ€å°çš„å­æ•°ç»„ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼štarget = 4, nums = [1,4,4]</span><br><span class="line">è¾“å‡ºï¼š1</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼štarget = 11, nums = [1,1,1,1,1,1,1,1]</span><br><span class="line">è¾“å‡ºï¼š0</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= target &lt;= 109</code></li><li><code>1 &lt;= nums.length &lt;= 105</code></li><li><code>1 &lt;= nums[i] &lt;= 105</code></li></ul><p><strong>è¿›é˜¶ï¼š</strong></p><ul><li>å¦‚æœä½ å·²ç»å®ç° <code>O(n)</code> æ—¶é—´å¤æ‚åº¦çš„è§£æ³•, è¯·å°è¯•è®¾è®¡ä¸€ä¸ª <code>O(n log(n))</code> æ—¶é—´å¤æ‚åº¦çš„è§£æ³•ã€‚</li></ul><p>åœ¨æœ¬é¢˜ä¸­å®ç°æ»‘åŠ¨çª—å£ï¼Œä¸»è¦ç¡®å®šå¦‚ä¸‹ä¸‰ç‚¹ï¼š</p><ul><li>çª—å£å†…æ˜¯ä»€ä¹ˆï¼Ÿ</li><li>å¦‚ä½•ç§»åŠ¨çª—å£çš„èµ·å§‹ä½ç½®ï¼Ÿ</li><li>å¦‚ä½•ç§»åŠ¨çª—å£çš„ç»“æŸä½ç½®ï¼Ÿ</li></ul><p>çª—å£å°±æ˜¯ æ»¡è¶³å…¶å’Œ â‰¥ s çš„é•¿åº¦æœ€å°çš„ è¿ç»­ å­æ•°ç»„ã€‚</p><p>çª—å£çš„èµ·å§‹ä½ç½®å¦‚ä½•ç§»åŠ¨ï¼šå¦‚æœå½“å‰çª—å£çš„å€¼å¤§äºsäº†ï¼Œçª—å£å°±è¦å‘å‰ç§»åŠ¨äº†ï¼ˆä¹Ÿå°±æ˜¯è¯¥ç¼©å°äº†ï¼‰ã€‚</p><p>çª—å£çš„ç»“æŸä½ç½®å¦‚ä½•ç§»åŠ¨ï¼šçª—å£çš„ç»“æŸä½ç½®å°±æ˜¯éå†æ•°ç»„çš„æŒ‡é’ˆï¼Œä¹Ÿå°±æ˜¯forå¾ªç¯é‡Œçš„ç´¢å¼•ã€‚</p><p>è§£é¢˜çš„å…³é”®åœ¨äº çª—å£çš„èµ·å§‹ä½ç½®å¦‚ä½•ç§»åŠ¨ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="https://img-blog.csdnimg.cn/20210312160441942.png" alt="leetcode_209"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ»‘åŠ¨çª—å£</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">minSubArrayLen</span><span class="params">(<span class="type">int</span> target, <span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> Integer.MAX_VALUE;</span><br><span class="line">        <span class="comment">//æ»‘åŠ¨çª—å£ for iéå†çš„æ˜¯ç»“æŸçš„ä½ç½® jæ˜¯èµ·å§‹çš„ä½ç½®</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;<span class="comment">//æ»‘åŠ¨çª—å£çš„å¤§å°</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">            sum += nums[i];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (sum &gt;= target) &#123; <span class="comment">//çª—å£çš„å¤§å°å¤§äºè¦æ±‚çš„å€¼ èµ·å§‹ä½ç½®å‘å‰ ç¼©çª—å£</span></span><br><span class="line">                <span class="type">int</span> <span class="variable">subLength</span> <span class="operator">=</span> i - j + <span class="number">1</span>;</span><br><span class="line">                res = Math.min(subLength, res);</span><br><span class="line">                sum -= nums[j++];<span class="comment">//å°±ç›¸å½“äºä¹‹å‰çš„å’Œå‡å»äº†èµ·å§‹ä½ç½®çš„å€¼ èµ·å§‹ä½ç½®++</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (res == Integer.MAX_VALUE) &#123; <span class="comment">//æ•°ç»„ä¸­çš„å’Œä¸å¤§äºtarget</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="LC904-æ°´æœæˆç¯®"><a href="#LC904-æ°´æœæˆç¯®" class="headerlink" title="LC904. æ°´æœæˆç¯®"></a>LC904. æ°´æœæˆç¯®</h3><p>ä½ æ­£åœ¨æ¢è®¿ä¸€å®¶å†œåœºï¼Œå†œåœºä»å·¦åˆ°å³ç§æ¤äº†ä¸€æ’æœæ ‘ã€‚è¿™äº›æ ‘ç”¨ä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>fruits</code> è¡¨ç¤ºï¼Œå…¶ä¸­ <code>fruits[i]</code> æ˜¯ç¬¬ <code>i</code> æ£µæ ‘ä¸Šçš„æ°´æœ <strong>ç§ç±»</strong> ã€‚</p><p>ä½ æƒ³è¦å°½å¯èƒ½å¤šåœ°æ”¶é›†æ°´æœã€‚ç„¶è€Œï¼Œå†œåœºçš„ä¸»äººè®¾å®šäº†ä¸€äº›ä¸¥æ ¼çš„è§„çŸ©ï¼Œä½ å¿…é¡»æŒ‰ç…§è¦æ±‚é‡‡æ‘˜æ°´æœï¼š</p><ul><li>ä½ åªæœ‰ <strong>ä¸¤ä¸ª</strong> ç¯®å­ï¼Œå¹¶ä¸”æ¯ä¸ªç¯®å­åªèƒ½è£… <strong>å•ä¸€ç±»å‹</strong> çš„æ°´æœã€‚æ¯ä¸ªç¯®å­èƒ½å¤Ÿè£…çš„æ°´æœæ€»é‡æ²¡æœ‰é™åˆ¶ã€‚</li><li>ä½ å¯ä»¥é€‰æ‹©ä»»æ„ä¸€æ£µæ ‘å¼€å§‹é‡‡æ‘˜ï¼Œä½ å¿…é¡»ä» <strong>æ¯æ£µ</strong> æ ‘ï¼ˆåŒ…æ‹¬å¼€å§‹é‡‡æ‘˜çš„æ ‘ï¼‰ä¸Š <strong>æ°å¥½æ‘˜ä¸€ä¸ªæ°´æœ</strong> ã€‚é‡‡æ‘˜çš„æ°´æœåº”å½“ç¬¦åˆç¯®å­ä¸­çš„æ°´æœç±»å‹ã€‚æ¯é‡‡æ‘˜ä¸€æ¬¡ï¼Œä½ å°†ä¼šå‘å³ç§»åŠ¨åˆ°ä¸‹ä¸€æ£µæ ‘ï¼Œå¹¶ç»§ç»­é‡‡æ‘˜ã€‚</li><li>ä¸€æ—¦ä½ èµ°åˆ°æŸæ£µæ ‘å‰ï¼Œä½†æ°´æœä¸ç¬¦åˆç¯®å­çš„æ°´æœç±»å‹ï¼Œé‚£ä¹ˆå°±å¿…é¡»åœæ­¢é‡‡æ‘˜ã€‚</li></ul><p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ <code>fruits</code> ï¼Œè¿”å›ä½ å¯ä»¥æ”¶é›†çš„æ°´æœçš„ <strong>æœ€å¤§</strong> æ•°ç›®ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šfruits = [1,2,1]</span><br><span class="line">è¾“å‡ºï¼š3</span><br><span class="line">è§£é‡Šï¼šå¯ä»¥é‡‡æ‘˜å…¨éƒ¨ 3 æ£µæ ‘ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šfruits = [0,1,2,2]</span><br><span class="line">è¾“å‡ºï¼š3</span><br><span class="line">è§£é‡Šï¼šå¯ä»¥é‡‡æ‘˜ [1,2,2] è¿™ä¸‰æ£µæ ‘ã€‚</span><br><span class="line">å¦‚æœä»ç¬¬ä¸€æ£µæ ‘å¼€å§‹é‡‡æ‘˜ï¼Œåˆ™åªèƒ½é‡‡æ‘˜ [0,1] è¿™ä¸¤æ£µæ ‘ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šfruits = [1,2,3,2,2]</span><br><span class="line">è¾“å‡ºï¼š4</span><br><span class="line">è§£é‡Šï¼šå¯ä»¥é‡‡æ‘˜ [2,3,2,2] è¿™å››æ£µæ ‘ã€‚</span><br><span class="line">å¦‚æœä»ç¬¬ä¸€æ£µæ ‘å¼€å§‹é‡‡æ‘˜ï¼Œåˆ™åªèƒ½é‡‡æ‘˜ [1,2] è¿™ä¸¤æ£µæ ‘ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 4ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šfruits = [3,3,3,1,2,1,1,2,3,3,4]</span><br><span class="line">è¾“å‡ºï¼š5</span><br><span class="line">è§£é‡Šï¼šå¯ä»¥é‡‡æ‘˜ [1,2,1,1,2] è¿™äº”æ£µæ ‘ã€‚</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= fruits.length &lt;= 105</code></li><li><code>0 &lt;= fruits[i] &lt; fruits.length</code></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ»‘åŠ¨çª—å£ + hashmap</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">totalFruit</span><span class="params">(<span class="type">int</span>[] fruits)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">1</span>;<span class="comment">//è¿”å›çš„æœ€å¤šæ”¶é›†ä¸ªæ•°</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>;<span class="comment">//èµ·å§‹ä½ç½®</span></span><br><span class="line">        HashMap&lt;Integer, Integer&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">3</span>);<span class="comment">//ç¯®å­</span></span><br><span class="line">        <span class="comment">//éå†ç»ˆæ­¢ä½ç½®i</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; fruits.length; i++) &#123;</span><br><span class="line">            map.put(fruits[i], map.getOrDefault(fruits[i], <span class="number">0</span>) + <span class="number">1</span>);<span class="comment">//åˆ©ç”¨mapä¸å«é‡å¤å…ƒç´ </span></span><br><span class="line">            <span class="keyword">while</span> (map.size() &gt; <span class="number">2</span>) &#123;<span class="comment">//å½“ç¯®å­æ•°å¤§äº2æ—¶ï¼Œç¼©çŸ­çª—å£</span></span><br><span class="line">                <span class="keyword">if</span> (map.get(fruits[j]) - <span class="number">1</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                    map.remove(fruits[j]);</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    map.put(fruits[j], map.get(fruits[j]) - <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> <span class="variable">subLength</span> <span class="operator">=</span> i - j + <span class="number">1</span>;</span><br><span class="line">            res = Math.max(res, subLength);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®«æ°´ä¸‰å¶ï¼ˆæ•°ç»„å¸¦æ›¿mapï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">totalFruit</span><span class="params">(<span class="type">int</span>[] fs)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> fs.length, res = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//cntsç”¨æ¥ç»Ÿè®¡æ¯ç§æ°´æœæ ‘çš„æ•°é‡</span></span><br><span class="line">    <span class="type">int</span>[] cnts = <span class="keyword">new</span> <span class="title class_">int</span>[len + <span class="number">10</span>];</span><br><span class="line">    <span class="comment">//iæ˜¯çª—å£çš„å³è¾¹ï¼Œjæ˜¯å·¦è¾¹ï¼Œtotè¡¨ç¤ºå½“å‰ç¯®å­é‡Œæ°´æœçš„ç§ç±»ï¼ˆè‡³å¤šæœ‰ä¸¤ç§æ°´æœï¼‰ï¼Œä¹Ÿè¡¨ç¤ºçª—å£ä¸­çš„æ°´æœç§ç±»æ•°é‡</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>, j = <span class="number">0</span>, tot = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        cnts[fs[i]]++;</span><br><span class="line">        <span class="keyword">if</span> (cnts[fs[i]] == <span class="number">1</span>) tot++;<span class="comment">//ç¬¬ä¸€æ¬¡å‡ºç° ç¯®å­çš„ç§ç±»++</span></span><br><span class="line">        <span class="comment">//å½“ç§ç±»æ•°é‡å¤§äº2æ—¶ï¼Œä½¿çª—å£å·¦ä¾§æ”¶ç¼©ï¼Œå¹¶ä¸”é™¤å»å¯¹åº”çš„æ°´æœç§ç±»åœ¨cntsä¸­çš„æ•°é‡</span></span><br><span class="line">        <span class="comment">//å½“ä¸º0æ—¶åˆ™å½»åº•åœ¨çª—å£ä¸­é™¤å»è¯¥ç§æ°´æœ</span></span><br><span class="line">        <span class="keyword">while</span> (tot &gt; <span class="number">2</span>) &#123;</span><br><span class="line">            cnts[fs[j]]--;<span class="comment">//ç¼©çª—å£</span></span><br><span class="line">            <span class="keyword">if</span> (cnts[fs[j]] == <span class="number">0</span>) tot--;<span class="comment">//ç¯®å­ç§ç±»æ•°--</span></span><br><span class="line">            j++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å³æ—¶æ¯”è¾ƒåˆ¤æ–­çª—å£ä¸­æ°´æœæ ‘çš„æ•°é‡ï¼Œç»è¿‡å‰ä¸¤æ­¥çª—å£ä¸­çš„ä¸œè¥¿ä¸€å®šæ˜¯æ»¡è¶³é¢˜ä¹‰çš„</span></span><br><span class="line">        res = Math.max(res, i - j + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="LC76-æœ€å°è¦†ç›–å­—ä¸²"><a href="#LC76-æœ€å°è¦†ç›–å­—ä¸²" class="headerlink" title="LC76. æœ€å°è¦†ç›–å­—ä¸²"></a>LC76. æœ€å°è¦†ç›–å­—ä¸²</h3><p>ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² <code>s</code> ã€ä¸€ä¸ªå­—ç¬¦ä¸² <code>t</code> ã€‚è¿”å› <code>s</code> ä¸­æ¶µç›– <code>t</code> æ‰€æœ‰å­—ç¬¦çš„æœ€å°å­ä¸²ã€‚å¦‚æœ <code>s</code> ä¸­ä¸å­˜åœ¨æ¶µç›– <code>t</code> æ‰€æœ‰å­—ç¬¦çš„å­ä¸²ï¼Œåˆ™è¿”å›ç©ºå­—ç¬¦ä¸² <code>&quot;&quot;</code> ã€‚</p><p><strong>æ³¨æ„ï¼š</strong></p><ul><li>å¯¹äº <code>t</code> ä¸­é‡å¤å­—ç¬¦ï¼Œæˆ‘ä»¬å¯»æ‰¾çš„å­å­—ç¬¦ä¸²ä¸­è¯¥å­—ç¬¦æ•°é‡å¿…é¡»ä¸å°‘äº <code>t</code> ä¸­è¯¥å­—ç¬¦æ•°é‡ã€‚</li><li>å¦‚æœ <code>s</code> ä¸­å­˜åœ¨è¿™æ ·çš„å­ä¸²ï¼Œæˆ‘ä»¬ä¿è¯å®ƒæ˜¯å”¯ä¸€çš„ç­”æ¡ˆã€‚</li></ul><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šs = &quot;ADOBECODEBANC&quot;, t = &quot;ABC&quot;</span><br><span class="line">è¾“å‡ºï¼š&quot;BANC&quot;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šs = &quot;a&quot;, t = &quot;a&quot;</span><br><span class="line">è¾“å‡ºï¼š&quot;a&quot;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: s = &quot;a&quot;, t = &quot;aa&quot;</span><br><span class="line">è¾“å‡º: &quot;&quot;</span><br><span class="line">è§£é‡Š: t ä¸­ä¸¤ä¸ªå­—ç¬¦ &#x27;a&#x27; å‡åº”åŒ…å«åœ¨ s çš„å­ä¸²ä¸­ï¼Œ</span><br><span class="line">å› æ­¤æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„å­å­—ç¬¦ä¸²ï¼Œè¿”å›ç©ºå­—ç¬¦ä¸²ã€‚</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= s.length, t.length &lt;= 105</code></li><li><code>s</code> å’Œ <code>t</code> ç”±è‹±æ–‡å­—æ¯ç»„æˆ</li></ul><p><strong>è¿›é˜¶ï¼š</strong>ä½ èƒ½è®¾è®¡ä¸€ä¸ªåœ¨ <code>o(n)</code> æ—¶é—´å†…è§£å†³æ­¤é—®é¢˜çš„ç®—æ³•å—ï¼Ÿ</p><p>Related Topics</p><p>å“ˆå¸Œè¡¨</p><p>å­—ç¬¦ä¸²</p><p>æ»‘åŠ¨çª—å£</p><p><strong>è§£æ³•æ€è·¯ï¼š</strong></p><ol><li>åˆ›å»ºä¸¤ä¸ªmapï¼Œåˆ†åˆ«è¡¨ç¤ºéœ€è¦çš„å­—ç¬¦sonMapåŠå…¶ä¸ªæ•°å’Œå½“å‰çš„å­—ç¬¦(åªç»Ÿè®¡å­ä¸²å«æœ‰çš„å­—ç¬¦)matherMapåŠå…¶ä¸ªæ•°ã€‚</li><li>åˆ©ç”¨æ»‘åŠ¨çª—å£çš„æ€æƒ³ï¼Œéå†å³æŒ‡é’ˆã€‚</li><li>å³æŒ‡é’ˆéå†è¿‡çš„å­—ç¬¦å¦‚æœæœ‰è¦åŒ¹é…çš„å­—ç¬¦ï¼ŒåŠ åˆ°mapä¸­å»ã€‚ç»Ÿè®¡å·²ç»åŒ¹é…å­—ç¬¦çš„è®¡æ•°å™¨ã€‚</li><li>å¦‚æœå·²ç»åŒ¹é…ä¸Šäº†ï¼Œæ›´æ–°åŒ¹é…çš„å­—ä¸²ï¼ŒæŠŠå·¦æŒ‡é’ˆå¼€å§‹å³ç§»ï¼Œçª—å£æ”¶ç¼©ï¼Œæ›´æ–°matherMapçš„æ•°æ®ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">minWindow</span><span class="params">(String s, String t)</span> &#123;</span><br><span class="line">    <span class="comment">//ä¸¤ä¸ªmap,ä¸€ä¸ªå­˜æ”¾éœ€è¦çš„å­—ç¬¦ï¼Œä¸€ä¸ªå­˜æ”¾å½“å‰çš„å­—ç¬¦</span></span><br><span class="line">    Map&lt;Character, Integer&gt; sonMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    Map&lt;Character, Integer&gt; matherMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//éå†åŒ¹é…çš„å­—ä¸²</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; t.length(); i++) &#123;</span><br><span class="line">        <span class="type">char</span> <span class="variable">cur</span> <span class="operator">=</span> t.charAt(i);</span><br><span class="line">        sonMap.put(cur, sonMap.getOrDefault(cur, <span class="number">0</span>) + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> <span class="number">0</span>;<span class="comment">//èµ·å§‹</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> <span class="number">0</span>;<span class="comment">//ç»ˆæ­¢</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">finishCount</span> <span class="operator">=</span> <span class="number">0</span>;<span class="comment">//è®¡æ•°å™¨</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">res</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">minLen</span> <span class="operator">=</span> s.length();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (right &lt; s.length()) &#123;</span><br><span class="line">        <span class="type">char</span> <span class="variable">cur</span> <span class="operator">=</span> s.charAt(right);</span><br><span class="line">        <span class="keyword">if</span> (sonMap.containsKey(cur)) &#123; <span class="comment">//å­—ä¸²ä¸­éœ€è¦è¿™ä¸ªå­—ç¬¦</span></span><br><span class="line">            matherMap.put(cur, matherMap.getOrDefault(cur, <span class="number">0</span>) + <span class="number">1</span>);</span><br><span class="line">            <span class="comment">// ä¸¤ä¸ªIntegerå¯¹è±¡æ¯”è¾ƒæ—¶ï¼Œä¸èƒ½ä½¿ç”¨ == ï¼Œè¦ä½¿ç”¨equalsï¼Œå¦‚æœä½¿ç”¨ == ï¼Œåœ¨[-128,127]èŒƒå›´å†…æ­£å¸¸ï¼ŒèŒƒå›´å¤–ä¸æ­£å¸¸</span></span><br><span class="line">            <span class="keyword">if</span> (sonMap.get(cur).equals(matherMap.get(cur))) &#123; <span class="comment">//ä¸€é¡¹å·²ç»åŒ¹é…äº†</span></span><br><span class="line">                finishCount++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        right++;</span><br><span class="line">        <span class="comment">//è®¡æ•°å™¨æ»¡è¶³è¦æ±‚ï¼Œç¼©å°çª—å£</span></span><br><span class="line">        <span class="keyword">while</span> (finishCount == sonMap.size()) &#123;</span><br><span class="line">            <span class="type">char</span> <span class="variable">leftCur</span> <span class="operator">=</span> s.charAt(left);</span><br><span class="line">            <span class="keyword">if</span> (matherMap.containsKey(leftCur) &amp;&amp; matherMap.get(leftCur) &gt;= sonMap.get(leftCur)) &#123;</span><br><span class="line">                <span class="comment">//è®°å½•æ»¡è¶³æ¡ä»¶çš„æœ€å°å­—ä¸²</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">temp</span> <span class="operator">=</span> s.substring(left, right);</span><br><span class="line">                <span class="keyword">if</span> (temp.length() &lt;= minLen) &#123;</span><br><span class="line">                    res = temp;</span><br><span class="line">                    minLen = temp.length();</span><br><span class="line">                &#125;</span><br><span class="line">                matherMap.put(leftCur, matherMap.get(leftCur) - <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span> (sonMap.get(leftCur) &gt; matherMap.get(leftCur)) &#123;</span><br><span class="line">                    finishCount--;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            left++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ¨¡æ‹Ÿï¼ˆèºæ—‹çŸ©é˜µï¼‰"><a href="#æ¨¡æ‹Ÿï¼ˆèºæ—‹çŸ©é˜µï¼‰" class="headerlink" title="æ¨¡æ‹Ÿï¼ˆèºæ—‹çŸ©é˜µï¼‰"></a>æ¨¡æ‹Ÿï¼ˆèºæ—‹çŸ©é˜µï¼‰</h2><p>å¾ªç¯ä¸å˜é‡ï¼šåœ¨å¾ªç¯è¿‡ç¨‹ä¸­ä¿æŒä¸å˜çš„æ€§è´¨ã€‚</p><h3 id="LC54-èºæ—‹çŸ©é˜µ"><a href="#LC54-èºæ—‹çŸ©é˜µ" class="headerlink" title="LC54. èºæ—‹çŸ©é˜µ"></a>LC54. èºæ—‹çŸ©é˜µ</h3><p>ä»å¤–éƒ¨å‘å†…éƒ¨é€å±‚éå†æ‰“å°çŸ©é˜µï¼Œæœ€å¤–é¢ä¸€åœˆæ‰“å°å®Œï¼Œé‡Œé¢ä»ç„¶æ˜¯ä¸€ä¸ªçŸ©é˜µ</p><p>ç»Ÿè®¡çŸ©é˜µçš„å±‚æ•°ï¼Œæ¯ä¸€å±‚æœ€å¤šä¼šå æ®ä¸¤è¡Œæˆ–è€…ä¸¤åˆ—ï¼Œæœ€å°‘ä¼šå æ®ä¸€è¡Œæˆ–è€…ä¸€åˆ—å…ƒç´ ï¼Œåªæœ‰ä¸€å±‚æˆ–è€…ä¸€åˆ—ï¼Œä¹Ÿç®—ä¸€å±‚ï¼Œåˆ†å±‚å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://pic.leetcode-cn.com/6936cb00971072cf40e96462e782aa47563fa4b24831d72749699c8fd9af7255-%E8%9E%BA%E6%97%8B%E7%9F%A9%E9%98%B5.JPG" alt="èºæ—‹çŸ©é˜µ.JPG"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210261749987.jpeg" alt="èºæ—‹çŸ©é˜µ1.JPG"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> matrix.length;</span><br><span class="line"><span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> matrix[<span class="number">0</span>].length;</span><br><span class="line"><span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> (Math.min(m, n)+<span class="number">1</span>)/<span class="number">2</span>;</span><br></pre></td></tr></table></figure><p><strong>å·¦é—­å³é—­</strong></p><p>å¼€å§‹æ‰“å°ç¬¬ <code>i</code> å±‚çš„çŸ©é˜µå…ƒç´ </p><p><img src="https://pic.leetcode-cn.com/a2e0022203893856ec9baa3fa3db6b0b1e6e49b4f3955e086f437852ec88a31d-%E8%9E%BA%E6%97%8B%E7%9F%A9%E9%98%B52.JPG" alt="èºæ—‹çŸ©é˜µ2.JPG"></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå†æ‰“å°ç¬¬iå±‚çš„çŸ©é˜µæ—¶ï¼Œè¦ç»å†4ä¸ªå¾ªç¯ï¼š</p><p>ç¬¬ 1 ä¸ªï¼šä»å·¦å‘å³</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for (int j = i; j &lt; n-i; j++) &#123;</span><br><span class="line">    list.add(matrix[i][j]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ 2 ä¸ªï¼šä»ä¸Šå¾€ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for (int j = i+1; j &lt; m-i; j++) &#123;</span><br><span class="line">    list.add(matrix[j][(n-1)-i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ 3 ä¸ªï¼šä»å³å¾€å·¦ï¼Œå¦‚æœè¿™ä¸€å±‚åªæœ‰1è¡Œï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªå¾ªç¯å·²ç»å°†è¯¥è¡Œæ‰“å°äº†ï¼Œè¿™é‡Œå°±ä¸éœ€è¦æ‰“å°äº†ï¼Œå³ <code>ï¼ˆm-1-i ï¼‰!= i</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for (int j = (n-1)-(i+1); j &gt;= i &amp;&amp; (m-1-i != i); j--) &#123;</span><br><span class="line">    list.add(matrix[(m-1)-i][j]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬4ä¸ªï¼šä»ä¸‹å¾€ä¸Šï¼Œå¦‚æœè¿™ä¸€å±‚åªæœ‰1åˆ—ï¼Œé‚£ä¹ˆç¬¬2ä¸ªå¾ªç¯å·²ç»å°†è¯¥åˆ—æ‰“å°äº†ï¼Œè¿™é‡Œä¸éœ€è¦æ‰“å°ï¼Œå³<code>(n-1-i) != i</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for (int j = (m-1)-(i+1); j &gt;= i+1 &amp;&amp; (n-1-i) != i; j--) &#123;</span><br><span class="line">    list.add(matrix[j][i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title function_">spiralOrder</span><span class="params">(<span class="type">int</span>[][] matrix)</span> &#123;</span><br><span class="line">    <span class="comment">//ä¿æŒå·¦é—­å³å¼€</span></span><br><span class="line">    List&lt;Integer&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;<span class="comment">//å¾ªç¯çš„æ¬¡æ•°</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> matrix.length;</span><br><span class="line">    <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> matrix[<span class="number">0</span>].length;</span><br><span class="line">    <span class="comment">//ç»Ÿè®¡çŸ©é˜µä»å¤–å‘å†…çš„å±‚æ•°ï¼Œå¦‚æœçŸ©é˜µéç©ºï¼Œé‚£ä¹ˆå®ƒçš„å±‚æ•°è‡³å°‘ä¸º1å±‚</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> (Math.min(m, n)+<span class="number">1</span>)/<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (i &lt; count) &#123;</span><br><span class="line">        <span class="comment">//ä¸Šä¾§ å·¦-&gt;å³</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i; j &lt; n - i; j++) &#123;</span><br><span class="line">            res.add(matrix[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å³ä¾§ ä¸Š-&gt;ä¸‹</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i + <span class="number">1</span>; j &lt; m - i; j++) &#123;</span><br><span class="line">            res.add(matrix[j][(n - <span class="number">1</span>) - i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//ä¸‹å†Œ å³-&gt;å·¦</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> (n - <span class="number">1</span>) - (i + <span class="number">1</span>); j &gt;= i &amp;&amp; (m - <span class="number">1</span> - i != i); j--) &#123;</span><br><span class="line">            res.add(matrix[(m - <span class="number">1</span>) - i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å·¦ä¾§ ä¸‹-&gt;ä¸Š</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> (m - <span class="number">1</span>) - (i + <span class="number">1</span>); j &gt;= i + <span class="number">1</span> &amp;&amp; (n - <span class="number">1</span> - i) != i; j--) &#123;</span><br><span class="line">            res.add(matrix[j][i]);</span><br><span class="line">        &#125;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="LC59-èºæ—‹çŸ©é˜µII"><a href="#LC59-èºæ—‹çŸ©é˜µII" class="headerlink" title="LC59. èºæ—‹çŸ©é˜µII"></a>LC59. èºæ—‹çŸ©é˜µII</h3><ul><li>å¡«å……ä¸Šè¡Œä»å·¦åˆ°å³</li><li>å¡«å……å³åˆ—ä»ä¸Šåˆ°ä¸‹</li><li>å¡«å……ä¸‹è¡Œä»å³åˆ°å·¦</li><li>å¡«å……å·¦åˆ—ä»ä¸‹åˆ°ä¸Š</li></ul><p><img src="https://code-thinking-1253855093.file.myqcloud.com/pics/20220922102236.png" alt="img"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span>[][] generateMatrix(<span class="type">int</span> n) &#123;</span><br><span class="line">    <span class="type">int</span>[][] res = <span class="keyword">new</span> <span class="title class_">int</span>[n][n];</span><br><span class="line">    <span class="type">int</span> <span class="variable">loop</span> <span class="operator">=</span> <span class="number">0</span>;<span class="comment">//æ§åˆ¶å¾ªç¯æ¬¡æ•°</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">start</span> <span class="operator">=</span> <span class="number">0</span>;<span class="comment">//æ¯ä¸€æ¬¡å¼€å§‹çš„ç‚¹(start,start)</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">1</span>;<span class="comment">//å¡«å……çš„æ•°å­—</span></span><br><span class="line">    <span class="type">int</span> i,j;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (loop++ &lt; n / <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="comment">// æ¨¡æ‹Ÿä¸Šä¾§ä»å·¦åˆ°å³</span></span><br><span class="line">        <span class="keyword">for</span> (j = start; j &lt; n - loop; j++) &#123;</span><br><span class="line">            res[start][j] = count++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ¨¡æ‹Ÿå³ä¾§ä»ä¸Šåˆ°ä¸‹</span></span><br><span class="line">        <span class="keyword">for</span> (i = start; i &lt; n - loop; i++) &#123;</span><br><span class="line">            res[i][j] = count++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ¨¡æ‹Ÿä¸‹ä¾§ä»å³åˆ°å·¦</span></span><br><span class="line">        <span class="keyword">for</span> (; j &gt;= loop; j--) &#123;</span><br><span class="line">            res[i][j] = count++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ¨¡æ‹Ÿå·¦ä¾§ä»ä¸‹åˆ°ä¸Š</span></span><br><span class="line">        <span class="keyword">for</span> (; i &gt;= loop; i--) &#123;</span><br><span class="line">            res[i][j] = count++;</span><br><span class="line">        &#125;</span><br><span class="line">        start++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (n % <span class="number">2</span> == <span class="number">1</span>) &#123; <span class="comment">//ä¸­é—´ä½ç½®</span></span><br><span class="line">        res[start][start] = count;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡Offer29-é¡ºæ—¶é’ˆæ‰“å°çŸ©é˜µ"><a href="#å‰‘æŒ‡Offer29-é¡ºæ—¶é’ˆæ‰“å°çŸ©é˜µ" class="headerlink" title="å‰‘æŒ‡Offer29. é¡ºæ—¶é’ˆæ‰“å°çŸ©é˜µ"></a>å‰‘æŒ‡Offer29. é¡ºæ—¶é’ˆæ‰“å°çŸ©é˜µ</h3><p>è¾“å…¥ä¸€ä¸ªçŸ©é˜µï¼ŒæŒ‰ç…§ä»å¤–å‘é‡Œä»¥é¡ºæ—¶é’ˆçš„é¡ºåºä¾æ¬¡æ‰“å°å‡ºæ¯ä¸€ä¸ªæ•°å­—ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šmatrix = [[1,2,3],[4,5,6],[7,8,9]]</span><br><span class="line">è¾“å‡ºï¼š[1,2,3,6,9,8,7,4,5]</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šmatrix = [[1,2,3,4],[5,6,7,8],[9,10,11,12]]</span><br><span class="line">è¾“å‡ºï¼š[1,2,3,4,8,12,11,10,9,5,6,7]</span><br></pre></td></tr></table></figure><p><strong>é™åˆ¶ï¼š</strong></p><ul><li><code>0 &lt;= matrix.length &lt;= 100</code></li><li><code>0 &lt;= matrix[i].length &lt;= 100</code></li></ul><p>æ³¨æ„ï¼šæœ¬é¢˜ä¸ä¸»ç«™ 54 é¢˜ç›¸åŒï¼š<a href="https://leetcode-cn.com/problems/spiral-matrix/">https://leetcode-cn.com/problems/spiral-matrix/</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span>[] spiralOrder(<span class="type">int</span>[][] matrix) &#123;</span><br><span class="line">    <span class="keyword">if</span> (matrix.length == <span class="number">0</span> || matrix[<span class="number">0</span>].length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    List&lt;Integer&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;<span class="comment">//æ§åˆ¶å¾ªç¯åœˆæ•°</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> matrix.length;</span><br><span class="line">    <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> matrix[<span class="number">0</span>].length;</span><br><span class="line">    <span class="type">int</span> <span class="variable">loop</span> <span class="operator">=</span> (Math.min(m, n) + <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (i &lt; loop) &#123;</span><br><span class="line">        <span class="comment">//ä¸Š ä»å·¦åˆ°å³</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i; j &lt; n - i; j++) &#123;</span><br><span class="line">            res.add(matrix[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å³ ä»ä¸Šåˆ°ä¸‹</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i + <span class="number">1</span>; j &lt; m - i; j++) &#123;</span><br><span class="line">            res.add(matrix[j][(n - <span class="number">1</span>) - i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//ä¸‹ ä»å³åˆ°å·¦</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> n - <span class="number">1</span> - i - <span class="number">1</span>; j &gt;= i &amp;&amp; m - <span class="number">1</span> - i != i; j--) &#123;</span><br><span class="line">            res.add(matrix[(m - <span class="number">1</span> - i)][j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å·¦ ä»ä¸‹åˆ°ä¸Š</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> m - <span class="number">1</span> - <span class="number">1</span> - i; j &gt;= i + <span class="number">1</span> &amp;&amp; n - <span class="number">1</span> - i != i; j--) &#123;</span><br><span class="line">            res.add(matrix[j][i]);</span><br><span class="line">        &#125;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res.stream().mapToInt(Integer::valueOf).toArray();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ•°æ®ç»“æ„ç¯‡"><a href="#æ•°æ®ç»“æ„ç¯‡" class="headerlink" title="æ•°æ®ç»“æ„ç¯‡"></a>æ•°æ®ç»“æ„ç¯‡</h2><h3 id="å‰‘æŒ‡-Offer05-æ›¿æ¢ç©ºæ ¼"><a href="#å‰‘æŒ‡-Offer05-æ›¿æ¢ç©ºæ ¼" class="headerlink" title="å‰‘æŒ‡ Offer05. æ›¿æ¢ç©ºæ ¼"></a>å‰‘æŒ‡ Offer05. æ›¿æ¢ç©ºæ ¼</h3><p>è¯·å®ç°ä¸€ä¸ªå‡½æ•°ï¼ŒæŠŠå­—ç¬¦ä¸² <code>s</code> ä¸­çš„æ¯ä¸ªç©ºæ ¼æ›¿æ¢æˆâ€%20â€ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šs = &quot;We are happy.&quot;</span><br><span class="line">è¾“å‡ºï¼š&quot;We%20are%20happy.&quot;</span><br></pre></td></tr></table></figure><p><strong>é™åˆ¶ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 &lt;= s çš„é•¿åº¦ &lt;= 10000</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">replaceSpace</span><span class="params">(String s)</span> &#123;</span><br><span class="line">    <span class="comment">//StringBuilder å•çº¿ç¨‹ä½¿ç”¨ï¼Œæ¯”è¾ƒå¿«</span></span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; s.length(); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (s.charAt(i) == <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">            sb.append(<span class="string">&quot;%20&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            sb.append(s.charAt(i));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> sb.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡-Offer-06-ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨"><a href="#å‰‘æŒ‡-Offer-06-ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨" class="headerlink" title="å‰‘æŒ‡ Offer 06. ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨"></a>å‰‘æŒ‡ Offer 06. ä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨</h3><p>è¾“å…¥ä¸€ä¸ªé“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼Œä»å°¾åˆ°å¤´åè¿‡æ¥è¿”å›æ¯ä¸ªèŠ‚ç‚¹çš„å€¼ï¼ˆç”¨æ•°ç»„è¿”å›ï¼‰ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šhead = [1,3,2]</span><br><span class="line">è¾“å‡ºï¼š[2,3,1]</span><br></pre></td></tr></table></figure><p><strong>é™åˆ¶ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 &lt;= é“¾è¡¨é•¿åº¦ &lt;= 10000</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span>[] reversePrint(ListNode head) &#123;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">cur</span> <span class="operator">=</span> head;</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (cur != <span class="literal">null</span>) &#123;</span><br><span class="line">        count++;</span><br><span class="line">        cur = cur.next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cur = head;</span><br><span class="line">    <span class="type">int</span>[] res = <span class="keyword">new</span> <span class="title class_">int</span>[count];</span><br><span class="line">    count--;</span><br><span class="line">    <span class="keyword">while</span> (cur != <span class="literal">null</span>) &#123;</span><br><span class="line">        res[count--] = cur.val;</span><br><span class="line">        cur = cur.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span>[] reversePrint2(ListNode head) &#123;</span><br><span class="line">    Stack&lt;ListNode&gt; stack = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">temp</span> <span class="operator">=</span> head;</span><br><span class="line">    <span class="keyword">while</span> (temp != <span class="literal">null</span>) &#123;</span><br><span class="line">        stack.push(temp);</span><br><span class="line">        temp = temp.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> stack.size();</span><br><span class="line">    <span class="type">int</span>[] res = <span class="keyword">new</span> <span class="title class_">int</span>[size];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">        res[i] = stack.pop().val;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡-Offer-09-ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—"><a href="#å‰‘æŒ‡-Offer-09-ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—" class="headerlink" title="å‰‘æŒ‡ Offer 09. ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—"></a>å‰‘æŒ‡ Offer 09. ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—</h3><p>ç”¨ä¸¤ä¸ªæ ˆå®ç°ä¸€ä¸ªé˜Ÿåˆ—ã€‚é˜Ÿåˆ—çš„å£°æ˜å¦‚ä¸‹ï¼Œè¯·å®ç°å®ƒçš„ä¸¤ä¸ªå‡½æ•° <code>appendTail</code> å’Œ <code>deleteHead</code> ï¼Œåˆ†åˆ«å®Œæˆåœ¨é˜Ÿåˆ—å°¾éƒ¨æ’å…¥æ•´æ•°å’Œåœ¨é˜Ÿåˆ—å¤´éƒ¨åˆ é™¤æ•´æ•°çš„åŠŸèƒ½ã€‚(è‹¥é˜Ÿåˆ—ä¸­æ²¡æœ‰å…ƒç´ ï¼Œ<code>deleteHead</code> æ“ä½œè¿”å› -1 )</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼š</span><br><span class="line">[&quot;CQueue&quot;,&quot;appendTail&quot;,&quot;deleteHead&quot;,&quot;deleteHead&quot;,&quot;deleteHead&quot;]</span><br><span class="line">[[],[3],[],[],[]]</span><br><span class="line">è¾“å‡ºï¼š[null,null,3,-1,-1]</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼š</span><br><span class="line">[&quot;CQueue&quot;,&quot;deleteHead&quot;,&quot;appendTail&quot;,&quot;appendTail&quot;,&quot;deleteHead&quot;,&quot;deleteHead&quot;]</span><br><span class="line">[[],[],[5],[2],[],[]]</span><br><span class="line">è¾“å‡ºï¼š[null,-1,null,null,5,2]</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= values &lt;= 10000</code></li><li>æœ€å¤šä¼šå¯¹<code>appendTailã€deleteHead</code>è¿›è¡Œ<code> 10000</code> æ¬¡è°ƒç”¨</li></ul><p>Related Topics</p><p>æ ˆ</p><p>è®¾è®¡</p><p>é˜Ÿåˆ—</p><h4 id="æ€è·¯ä¸€"><a href="#æ€è·¯ä¸€" class="headerlink" title="æ€è·¯ä¸€"></a>æ€è·¯ä¸€</h4><p>Aæ ˆç”¨æ¥ä¿æŒåŸæœ‰æ•°æ®ï¼ŒBæ ˆç”¨æ¥è¾“å‡ºæ•°æ®æ—¶å¯¹æ ˆé€†åºï¼Œåœ¨Bä¸­è¾“å‡ºé˜Ÿå¤´ä¹‹åå†æ”¾å…¥Aæ ˆã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">CQueue</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Stack&lt;Integer&gt; stack1;</span><br><span class="line">    <span class="keyword">public</span> Stack&lt;Integer&gt; stack2;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">CQueue</span><span class="params">()</span> &#123;</span><br><span class="line">        stack1 = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">        stack2 = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">appendTail</span><span class="params">(<span class="type">int</span> value)</span> &#123;</span><br><span class="line">        stack1.push(value);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">deleteHead</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (stack1.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (!stack1.isEmpty()) &#123;</span><br><span class="line">                <span class="type">Integer</span> <span class="variable">i</span> <span class="operator">=</span> stack1.pop();</span><br><span class="line">                stack2.push(i);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> <span class="variable">head</span> <span class="operator">=</span> stack2.pop();</span><br><span class="line">            <span class="keyword">while</span> (!stack2.isEmpty()) &#123;</span><br><span class="line">                <span class="type">Integer</span> <span class="variable">i</span> <span class="operator">=</span> stack2.pop();</span><br><span class="line">                stack1.push(i);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ€è·¯äºŒ"><a href="#æ€è·¯äºŒ" class="headerlink" title="æ€è·¯äºŒ"></a>æ€è·¯äºŒ</h4><p><img src="https://pic.leetcode-cn.com/1599286207-HnnMhX-Picture1.png" alt="Picture1.png"></p><p>å¯¹æ€è·¯ä¸€è¿›è¡Œä¼˜åŒ–ï¼Œå½“Bæ ˆè¾“å‡ºå®Œå¯¹å¤´æ—¶ä¸å†é‡æ–°æ”¾å…¥Aæ ˆï¼Œè€Œæ˜¯ä¿ç•™ï¼Œå› ä¸ºæ˜¯é¡ºåºåŠ å…¥çš„ï¼Œä»–ä¼šä¿ç•™åŸæœ‰çš„é¡ºåºã€‚</p><p>é¢˜ç›®è¦æ±‚å®ç° åŠ å…¥é˜Ÿå°¾appendTail() å’Œ åˆ é™¤é˜Ÿé¦–deleteHead() ä¸¤ä¸ªå‡½æ•°çš„æ­£å¸¸å·¥ä½œã€‚å› æ­¤ï¼Œå¯ä»¥è®¾è®¡æ ˆ A ç”¨äºåŠ å…¥é˜Ÿå°¾æ“ä½œï¼Œæ ˆ B ç”¨äºå°†å…ƒç´ å€’åºï¼Œä»è€Œå®ç°åˆ é™¤é˜Ÿé¦–å…ƒç´ ã€‚</p><p>å‡½æ•°è®¾è®¡ï¼š</p><ol><li>åŠ å…¥é˜Ÿå°¾ appendTail() ï¼š å°†æ•°å­— val åŠ å…¥æ ˆ A å³å¯ã€‚</li><li>åˆ é™¤é˜Ÿé¦–deleteHead() ï¼š æœ‰ä»¥ä¸‹ä¸‰ç§æƒ…å†µã€‚<ul><li>å½“æ ˆ B ä¸ä¸ºç©ºï¼š Bä¸­ä»æœ‰å·²å®Œæˆå€’åºçš„å…ƒç´ ï¼Œå› æ­¤ç›´æ¥è¿”å› B çš„æ ˆé¡¶å…ƒç´ ã€‚</li><li>å¦åˆ™ï¼Œå½“ A ä¸ºç©ºï¼š å³ä¸¤ä¸ªæ ˆéƒ½ä¸ºç©ºï¼Œæ— å…ƒç´ ï¼Œå› æ­¤è¿”å› -1 ã€‚</li><li>å¦åˆ™ï¼š å°†æ ˆ A å…ƒç´ å…¨éƒ¨è½¬ç§»è‡³æ ˆ B ä¸­ï¼Œå®ç°å…ƒç´ å€’åºï¼Œå¹¶è¿”å›æ ˆ B çš„æ ˆé¡¶å…ƒç´ ã€‚</li></ul></li></ol><p><img src="https://pic.leetcode-cn.com/1599286207-iyRyBk-Picture2.png" alt="img"></p><p>å¤æ‚åº¦åˆ†æï¼š</p><blockquote><p>ä»¥ä¸‹åˆ†æä»…æ»¡è¶³æ·»åŠ  N ä¸ªå…ƒç´ å¹¶åˆ é™¤ N ä¸ªå…ƒç´ ï¼Œå³æ ˆåˆå§‹å’Œç»“æŸçŠ¶æ€ä¸‹éƒ½ä¸ºç©ºçš„æƒ…å†µã€‚</p></blockquote><ul><li>æ—¶é—´å¤æ‚åº¦ï¼š appendTail()å‡½æ•°ä¸ºO(1) ï¼›deleteHead() å‡½æ•°åœ¨ N æ¬¡é˜Ÿé¦–å…ƒç´ åˆ é™¤æ“ä½œä¸­æ€»å…±éœ€å®Œæˆ N ä¸ªå…ƒç´ çš„å€’åºã€‚</li><li>ç©ºé—´å¤æ‚åº¦ O(N)O(N) ï¼š æœ€å·®æƒ…å†µä¸‹ï¼Œæ ˆ A å’Œ B å…±ä¿å­˜ NN ä¸ªå…ƒç´ ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">CQueue</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Stack&lt;Integer&gt; stack1;</span><br><span class="line">    <span class="keyword">public</span> Stack&lt;Integer&gt; stack2;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">CQueue</span><span class="params">()</span> &#123;</span><br><span class="line">        stack1 = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">        stack2 = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">appendTail</span><span class="params">(<span class="type">int</span> value)</span> &#123;</span><br><span class="line">        stack1.push(value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">deleteHead</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!stack2.isEmpty()) &#123; <span class="comment">// æƒ…å†µä¸€Bæ ˆä¸ç©º</span></span><br><span class="line">            <span class="keyword">return</span> stack2.pop();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (stack1.isEmpty()) &#123; <span class="comment">// æƒ…å†µäºŒABéƒ½ä¸ºç©º</span></span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123; <span class="comment">// æƒ…å†µä¸‰Aä¸ä¸ºç©º Bä¸ºç©º</span></span><br><span class="line">            <span class="keyword">while</span> (!stack1.isEmpty()) &#123;</span><br><span class="line">                stack2.push(stack1.pop());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> stack2.pop();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡-Offer-24-åè½¬é“¾è¡¨"><a href="#å‰‘æŒ‡-Offer-24-åè½¬é“¾è¡¨" class="headerlink" title="å‰‘æŒ‡ Offer 24. åè½¬é“¾è¡¨"></a>å‰‘æŒ‡ Offer 24. åè½¬é“¾è¡¨</h3><p>ç»™å®šå•é“¾è¡¨çš„å¤´èŠ‚ç‚¹ <code>head</code> ï¼Œè¯·åè½¬é“¾è¡¨ï¼Œå¹¶è¿”å›åè½¬åçš„é“¾è¡¨çš„å¤´èŠ‚ç‚¹ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://assets.leetcode.com/uploads/2021/02/19/rev1ex1.jpg" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šhead = [1,2,3,4,5]</span><br><span class="line">è¾“å‡ºï¼š[5,4,3,2,1]</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><p><img src="https://assets.leetcode.com/uploads/2021/02/19/rev1ex2.jpg" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šhead = [1,2]</span><br><span class="line">è¾“å‡ºï¼š[2,1]</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šhead = []</span><br><span class="line">è¾“å‡ºï¼š[]</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li>é“¾è¡¨ä¸­èŠ‚ç‚¹çš„æ•°ç›®èŒƒå›´æ˜¯ <code>[0, 5000]</code></li><li><code>-5000 &lt;= Node.val &lt;= 5000</code></li></ul><p><strong>è¿›é˜¶ï¼š</strong>é“¾è¡¨å¯ä»¥é€‰ç”¨è¿­ä»£æˆ–é€’å½’æ–¹å¼å®Œæˆåè½¬ã€‚ä½ èƒ½å¦ç”¨ä¸¤ç§æ–¹æ³•è§£å†³è¿™é“é¢˜ï¼Ÿ</p><h4 id="è¿­ä»£"><a href="#è¿­ä»£" class="headerlink" title="è¿­ä»£"></a>è¿­ä»£</h4><p>åŒæŒ‡é’ˆ</p><p><img src="https://pic.leetcode-cn.com/1604779288-jExDGV-Picture3.png" alt="img"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è¿­ä»£ï¼šåŒæŒ‡é’ˆ</span></span><br><span class="line"><span class="comment"> * */</span></span><br><span class="line"><span class="keyword">public</span> ListNode <span class="title function_">reverseList</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="literal">null</span>) <span class="keyword">return</span> head;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">cur</span> <span class="operator">=</span> head, pre = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">while</span> (cur != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">temp</span> <span class="operator">=</span> cur.next;<span class="comment">// æš‚å­˜åç»§èŠ‚ç‚¹ cur.next</span></span><br><span class="line">        cur.next = pre;<span class="comment">// ä¿®æ”¹ next å¼•ç”¨æŒ‡å‘</span></span><br><span class="line">        pre = cur;<span class="comment">// pre æš‚å­˜ cur</span></span><br><span class="line">        cur = temp; <span class="comment">// cur è®¿é—®ä¸‹ä¸€èŠ‚ç‚¹</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> pre;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ ˆ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è¿­ä»£ï¼šåˆ©ç”¨æ ˆ</span></span><br><span class="line"><span class="comment"> * */</span></span><br><span class="line"><span class="keyword">public</span> ListNode <span class="title function_">reverseList</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="literal">null</span>) <span class="keyword">return</span> head;</span><br><span class="line">    Stack&lt;ListNode&gt; stack = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">newHead</span> <span class="operator">=</span> head;</span><br><span class="line">    <span class="keyword">while</span> (newHead != <span class="literal">null</span>) &#123;</span><br><span class="line">        stack.push(newHead);</span><br><span class="line">        newHead = newHead.next;</span><br><span class="line">    &#125;</span><br><span class="line">    head = stack.pop();</span><br><span class="line">    newHead = head;</span><br><span class="line">    <span class="keyword">while</span> (!stack.isEmpty()) &#123;</span><br><span class="line">        newHead.next = stack.pop();</span><br><span class="line">        newHead = newHead.next;</span><br><span class="line">    &#125;</span><br><span class="line">    newHead.next = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="é€’å½’"><a href="#é€’å½’" class="headerlink" title="é€’å½’"></a>é€’å½’</h4><p>è€ƒè™‘ä½¿ç”¨é€’å½’æ³•éå†é“¾è¡¨ï¼Œå½“è¶Šè¿‡å°¾èŠ‚ç‚¹åç»ˆæ­¢é€’å½’ï¼Œåœ¨å›æº¯æ—¶ä¿®æ”¹å„èŠ‚ç‚¹çš„ next å¼•ç”¨æŒ‡å‘ã€‚</p><p><strong>recur(cur, pre) é€’å½’å‡½æ•°ï¼š</strong></p><ol><li>ç»ˆæ­¢æ¡ä»¶ï¼šå½“ cur ä¸ºç©ºï¼Œåˆ™è¿”å›å°¾èŠ‚ç‚¹ pre ï¼ˆå³åè½¬é“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼‰ï¼›</li><li>é€’å½’åç»§èŠ‚ç‚¹ï¼Œè®°å½•è¿”å›å€¼ï¼ˆå³åè½¬é“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼‰ä¸º res ï¼›</li><li>ä¿®æ”¹å½“å‰èŠ‚ç‚¹ cur å¼•ç”¨æŒ‡å‘å‰é©±èŠ‚ç‚¹ pre ï¼›</li><li>è¿”å›åè½¬é“¾è¡¨çš„å¤´èŠ‚ç‚¹ res ï¼›</li></ol><p><strong>reverseList(head) å‡½æ•°ï¼š</strong><br>è°ƒç”¨å¹¶è¿”å› recur(head, null) ã€‚ä¼ å…¥ null æ˜¯å› ä¸ºåè½¬é“¾è¡¨åï¼Œ head èŠ‚ç‚¹æŒ‡å‘ null ï¼›</p><p>å¤æ‚åº¦åˆ†æï¼š</p><ul><li>æ—¶é—´å¤æ‚åº¦ O(N)O(N) ï¼š éå†é“¾è¡¨ä½¿ç”¨çº¿æ€§å¤§å°æ—¶é—´ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ O(N)O(N) ï¼š éå†é“¾è¡¨çš„é€’å½’æ·±åº¦è¾¾åˆ° NN ï¼Œç³»ç»Ÿä½¿ç”¨ O(N)O(N) å¤§å°é¢å¤–ç©ºé—´ã€‚</li></ul><p><img src="https://pic.leetcode-cn.com/1604779700-APVBqI-Picture24.png" alt="img"></p><h3 id="å‰‘æŒ‡-Offer-30-åŒ…å«-min-å‡½æ•°çš„æ ˆ"><a href="#å‰‘æŒ‡-Offer-30-åŒ…å«-min-å‡½æ•°çš„æ ˆ" class="headerlink" title="å‰‘æŒ‡ Offer 30. åŒ…å« min å‡½æ•°çš„æ ˆ"></a>å‰‘æŒ‡ Offer 30. åŒ…å« min å‡½æ•°çš„æ ˆ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è¿­ä»£</span></span><br><span class="line"><span class="comment"> * */</span></span><br><span class="line"><span class="keyword">public</span> ListNode <span class="title function_">reverseList</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> recur(head,<span class="literal">null</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> ListNode <span class="title function_">recur</span><span class="params">(ListNode cur, ListNode pre)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (cur == <span class="literal">null</span>) &#123; <span class="comment">// ç»ˆæ­¢æ¡ä»¶</span></span><br><span class="line">        <span class="keyword">return</span> pre;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">res</span> <span class="operator">=</span> recur(cur.next, cur);<span class="comment">//é€’å½’åç»­èŠ‚ç‚¹</span></span><br><span class="line"></span><br><span class="line">    cur.next = pre;              <span class="comment">// ä¿®æ”¹èŠ‚ç‚¹å¼•ç”¨æŒ‡å‘</span></span><br><span class="line">    <span class="keyword">return</span> res;                  <span class="comment">// è¿”å›åè½¬é“¾è¡¨çš„å¤´èŠ‚ç‚¹</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰æ ˆçš„æ•°æ®ç»“æ„ï¼Œè¯·åœ¨è¯¥ç±»å‹ä¸­å®ç°ä¸€ä¸ªèƒ½å¤Ÿå¾—åˆ°æ ˆçš„æœ€å°å…ƒç´ çš„ min å‡½æ•°åœ¨è¯¥æ ˆä¸­ï¼Œè°ƒç”¨ minã€push åŠ pop çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ O(1)ã€‚</p><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">MinStack minStack = new MinStack();</span><br><span class="line">minStack.push(-2);</span><br><span class="line">minStack.push(0);</span><br><span class="line">minStack.push(-3);</span><br><span class="line">minStack.min();   --&gt; è¿”å› -3.</span><br><span class="line">minStack.pop();</span><br><span class="line">minStack.top();      --&gt; è¿”å› 0.</span><br><span class="line">minStack.min();   --&gt; è¿”å› -2.</span><br></pre></td></tr></table></figure><p><strong>è§£é¢˜æ€è·¯:</strong><br>æ™®é€šæ ˆçš„ push() å’Œ pop() å‡½æ•°çš„å¤æ‚åº¦ O(1) ï¼›è€Œè·å–æ ˆæœ€å°å€¼ min() å‡½æ•°éœ€è¦éå†æ•´ä¸ªæ ˆï¼Œå¤æ‚åº¦ä¸º O(N) ã€‚</p><p><strong>æœ¬é¢˜éš¾ç‚¹ï¼š</strong> å°† min() å‡½æ•°å¤æ‚åº¦é™ä¸º&#x3D;O(1) ã€‚å¯å€ŸåŠ©è¾…åŠ©æ ˆå®ç°ï¼š</p><ul><li>æ•°æ®æ ˆ A ï¼š æ ˆ A ç”¨äºå­˜å‚¨æ‰€æœ‰å…ƒç´ ï¼Œä¿è¯å…¥æ ˆ push() å‡½æ•°ã€å‡ºæ ˆ pop() å‡½æ•°ã€è·å–æ ˆé¡¶ top() å‡½æ•°çš„æ­£å¸¸è¾‘ã€‚</li><li>è¾…åŠ©æ ˆ B ï¼š æ ˆ B ä¸­å­˜å‚¨æ ˆ A ä¸­æ‰€æœ‰ éä¸¥æ ¼é™åº å…ƒç´ çš„å­åºåˆ—ï¼Œåˆ™æ ˆ A ä¸­çš„æœ€å°å…ƒç´ å§‹ç»ˆå¯¹åº”æ ˆ B çš„æ ˆé¡¶å…ƒç´ .æ­¤æ—¶ï¼Œ min() å‡½æ•°åªéœ€è¿”å›æ ˆ B çš„æ ˆé¡¶å…ƒç´ å³å¯ã€‚</li></ul><p>å› æ­¤ï¼Œåªéœ€è®¾æ³•ç»´æŠ¤å¥½ æ ˆ B çš„å…ƒç´ ï¼Œä½¿å…¶ä¿æŒæ˜¯æ ˆ A çš„éä¸¥æ ¼é™åºå…ƒç´ çš„å­åºåˆ—ï¼Œå³å¯å®ç° min() å‡½æ•°çš„ O(1) å¤æ‚åº¦ã€‚</p><p><strong>å‡½æ•°è®¾è®¡ï¼š</strong><br>push(x) å‡½æ•°ï¼š é‡ç‚¹ä¸ºä¿æŒæ ˆ B çš„å…ƒç´ æ˜¯ <strong>éä¸¥æ ¼é™åº</strong> çš„ï¼›</p><ol><li>æ‰§è¡Œã€Œå…ƒç´  x å‹å…¥æ ˆ Aã€ ï¼›</li><li>è‹¥ã€Œæ ˆ B ä¸ºç©ºã€æˆ–ã€Œx \leqâ‰¤ æ ˆ B çš„æ ˆé¡¶å…ƒç´ ã€ï¼Œåˆ™æ‰§è¡Œã€Œå…ƒç´  x å‹å…¥æ ˆ Bã€ ï¼›</li></ol><p>pop() å‡½æ•°ï¼š é‡ç‚¹ä¸ºä¿æŒæ ˆ A , B çš„ å…ƒç´ ä¸€è‡´æ€§ ï¼›</p><ol><li>æ‰§è¡Œã€Œæ ˆ A å…ƒç´ å‡ºæ ˆã€ï¼Œå°†å‡ºæ ˆå…ƒç´ è®°ä¸º y ï¼›</li><li>è‹¥ ã€Œy ç­‰äºæ ˆ B çš„æ ˆé¡¶å…ƒç´ ã€ï¼Œåˆ™æ‰§è¡Œã€Œæ ˆ B å…ƒç´ å‡ºæ ˆã€ï¼›</li></ol><p>top() å‡½æ•°ï¼š ç›´æ¥è¿”å›æ ˆ A çš„æ ˆé¡¶å…ƒç´ ï¼Œå³è¿”å› A.peek() ï¼›</p><p>min() å‡½æ•°ï¼š ç›´æ¥è¿”å›æ ˆ B çš„æ ˆé¡¶å…ƒç´ ï¼Œå³è¿”å› B.peek() ï¼›</p><p><strong>é‡‡ç”¨ â€œéä¸¥æ ¼â€ é™åºåŸå› </strong>ï¼š<br>åœ¨æ ˆ A å…·æœ‰ é‡å¤ æœ€å°å€¼å…ƒç´ æ—¶ï¼Œéä¸¥æ ¼é™åºå¯é˜²æ­¢æ ˆ B æå‰å¼¹å‡ºæœ€å°å€¼å…ƒç´ ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p><p><img src="https://pic.leetcode-cn.com/1600086305-BSfBJu-Picture2.png" alt="Picture2.png"></p><p><strong>å¤æ‚åº¦åˆ†æï¼š</strong><br>æ—¶é—´å¤æ‚åº¦ O(1) ï¼š push(), pop(), top(), min() å››ä¸ªå‡½æ•°çš„æ—¶é—´å¤æ‚åº¦å‡ä¸ºå¸¸æ•°çº§åˆ«ã€‚<br>ç©ºé—´å¤æ‚åº¦ O(N) ï¼š å½“å…±æœ‰ N ä¸ªå¾…å…¥æ ˆå…ƒç´ æ—¶ï¼Œè¾…åŠ©æ ˆ B æœ€å·®æƒ…å†µä¸‹å­˜å‚¨ N ä¸ªå…ƒç´ ï¼Œä½¿ç”¨ O(N) é¢å¤–ç©ºé—´ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MinStack</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** initialize your data structure here. */</span></span><br><span class="line">    Stack&lt;Integer&gt; stack1;<span class="comment">//æ­£å¸¸çš„æ ˆåºåˆ—</span></span><br><span class="line">    Stack&lt;Integer&gt; stack2;<span class="comment">//å¯¹äºAæ ˆçš„å…ƒç´ ï¼ŒBæ ˆä¿è¯æ•°æ®ä»å°åˆ°å¤§</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MinStack</span><span class="params">()</span> &#123;</span><br><span class="line">        stack1 = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">        stack2 = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">        stack1.push(x);</span><br><span class="line">        <span class="keyword">if</span> (stack2.isEmpty() || stack2.peek() &gt;= x) &#123; <span class="comment">// å°äºæ ˆé¡¶æ‰å…¥æ ˆ</span></span><br><span class="line">            stack2.push(x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">i</span> <span class="operator">=</span> stack1.pop();</span><br><span class="line">        <span class="keyword">if</span> (i.equals(stack2.peek())) &#123;</span><br><span class="line">            stack2.pop();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">top</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stack1.peek();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">min</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stack2.peek();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡-Offer-35-å¤æ‚é“¾è¡¨çš„å¤åˆ¶"><a href="#å‰‘æŒ‡-Offer-35-å¤æ‚é“¾è¡¨çš„å¤åˆ¶" class="headerlink" title="å‰‘æŒ‡ Offer 35. å¤æ‚é“¾è¡¨çš„å¤åˆ¶"></a>å‰‘æŒ‡ Offer 35. å¤æ‚é“¾è¡¨çš„å¤åˆ¶</h3><p>è¯·å®ç° <code>copyRandomList</code> å‡½æ•°ï¼Œå¤åˆ¶ä¸€ä¸ªå¤æ‚é“¾è¡¨ã€‚åœ¨å¤æ‚é“¾è¡¨ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹é™¤äº†æœ‰ä¸€ä¸ª <code>next</code> æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¿˜æœ‰ä¸€ä¸ª <code>random</code> æŒ‡é’ˆæŒ‡å‘é“¾è¡¨ä¸­çš„ä»»æ„èŠ‚ç‚¹æˆ–è€… <code>null</code>ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2020/01/09/e1.png" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šhead = [[7,null],[13,0],[11,4],[10,2],[1,0]]</span><br><span class="line">è¾“å‡ºï¼š[[7,null],[13,0],[11,4],[10,2],[1,0]]</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2020/01/09/e2.png" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šhead = [[1,1],[2,1]]</span><br><span class="line">è¾“å‡ºï¼š[[1,1],[2,1]]</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><p><strong><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2020/01/09/e3.png" alt="img"></strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šhead = [[3,null],[3,0],[3,null]]</span><br><span class="line">è¾“å‡ºï¼š[[3,null],[3,0],[3,null]]</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 4ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šhead = []</span><br><span class="line">è¾“å‡ºï¼š[]</span><br><span class="line">è§£é‡Šï¼šç»™å®šçš„é“¾è¡¨ä¸ºç©ºï¼ˆç©ºæŒ‡é’ˆï¼‰ï¼Œå› æ­¤è¿”å› nullã€‚</span><br></pre></td></tr></table></figure><h4 id="å“ˆå¸Œè¡¨è®°å½•æ³•"><a href="#å“ˆå¸Œè¡¨è®°å½•æ³•" class="headerlink" title="å“ˆå¸Œè¡¨è®°å½•æ³•"></a>å“ˆå¸Œè¡¨è®°å½•æ³•</h4><p>åˆ©ç”¨å“ˆå¸Œè¡¨çš„æŸ¥è¯¢ç‰¹ç‚¹ï¼Œè€ƒè™‘æ„å»º åŸé“¾è¡¨èŠ‚ç‚¹ å’Œ æ–°é“¾è¡¨å¯¹åº”èŠ‚ç‚¹ çš„é”®å€¼å¯¹æ˜ å°„å…³ç³»ï¼Œå†éå†æ„å»ºæ–°é“¾è¡¨å„èŠ‚ç‚¹çš„ next å’Œ random å¼•ç”¨æŒ‡å‘å³å¯ã€‚</p><p><strong>ç®—æ³•æµç¨‹ï¼š</strong></p><ol><li><p>è‹¥å¤´èŠ‚ç‚¹ head ä¸ºç©ºèŠ‚ç‚¹ï¼Œç›´æ¥è¿”å› null ï¼›</p></li><li><p>åˆå§‹åŒ–ï¼š å“ˆå¸Œè¡¨ dic ï¼Œ èŠ‚ç‚¹ cur æŒ‡å‘å¤´èŠ‚ç‚¹ï¼›</p></li><li><p>å¤åˆ¶é“¾è¡¨ï¼š</p><ol><li>å»ºç«‹æ–°èŠ‚ç‚¹ï¼Œå¹¶å‘ dic æ·»åŠ é”®å€¼å¯¹ (åŸ cur èŠ‚ç‚¹, æ–° cur èŠ‚ç‚¹ï¼‰ ï¼›</li><li>cur éå†è‡³åŸé“¾è¡¨ä¸‹ä¸€èŠ‚ç‚¹ï¼›</li></ol></li><li><p>æ„å»ºæ–°é“¾è¡¨çš„å¼•ç”¨æŒ‡å‘ï¼š</p><ol><li>æ„å»ºæ–°èŠ‚ç‚¹çš„ next å’Œ random å¼•ç”¨æŒ‡å‘ï¼›</li><li>cur éå†è‡³åŸé“¾è¡¨ä¸‹ä¸€èŠ‚ç‚¹ï¼›</li></ol></li><li><p>è¿”å›å€¼ï¼š æ–°é“¾è¡¨çš„å¤´èŠ‚ç‚¹ map.get(head) ï¼›</p></li></ol><p><strong>å¤æ‚åº¦åˆ†æï¼š</strong><br>æ—¶é—´å¤æ‚åº¦ O(N) ï¼š ä¸¤è½®éå†é“¾è¡¨ï¼Œä½¿ç”¨ O(N) æ—¶é—´ã€‚<br>ç©ºé—´å¤æ‚åº¦ O(N) ï¼š å“ˆå¸Œè¡¨ dic ä½¿ç”¨çº¿æ€§å¤§å°çš„é¢å¤–ç©ºé—´ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å“ˆå¸Œè¡¨</span></span><br><span class="line"><span class="comment"> * */</span></span><br><span class="line"><span class="keyword">public</span> Node <span class="title function_">copyRandomList1</span><span class="params">(Node head)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    Map&lt;Node, Node&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="type">Node</span> <span class="variable">cur</span> <span class="operator">=</span> head;</span><br><span class="line">    <span class="keyword">while</span> (cur != <span class="literal">null</span>) &#123; <span class="comment">//æ„é€ èŠ‚ç‚¹</span></span><br><span class="line">        map.put(cur, <span class="keyword">new</span> <span class="title class_">Node</span>(cur.val));</span><br><span class="line">        cur = cur.next;</span><br><span class="line">    &#125;</span><br><span class="line">    cur = head;</span><br><span class="line">    <span class="keyword">while</span> (cur != <span class="literal">null</span>) &#123; <span class="comment">//å¤åˆ¶å¼•ç”¨ å¤åˆ¶æ–°èŠ‚ç‚¹çš„å¼•ç”¨</span></span><br><span class="line">        map.get(cur).next = map.get(cur.next);</span><br><span class="line">        map.get(cur).random = map.get(cur.random);</span><br><span class="line">        cur = cur.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> map.get(head);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ‹¼æ¥æ‹†åˆ†"><a href="#æ‹¼æ¥æ‹†åˆ†" class="headerlink" title="æ‹¼æ¥æ‹†åˆ†"></a>æ‹¼æ¥æ‹†åˆ†</h4><p>è€ƒè™‘æ„å»º åŸèŠ‚ç‚¹ 1 -&gt; æ–°èŠ‚ç‚¹ 1 -&gt; åŸèŠ‚ç‚¹ 2 -&gt; æ–°èŠ‚ç‚¹ 2 -&gt; â€¦â€¦ çš„æ‹¼æ¥é“¾è¡¨ï¼Œå¦‚æ­¤ä¾¿å¯åœ¨è®¿é—®åŸèŠ‚ç‚¹çš„ random æŒ‡å‘èŠ‚ç‚¹çš„åŒæ—¶æ‰¾åˆ°æ–°å¯¹åº”æ–°èŠ‚ç‚¹çš„ random æŒ‡å‘èŠ‚ç‚¹ã€‚</p><p><strong>ç®—æ³•æµç¨‹ï¼š</strong></p><ol><li><p>å¤åˆ¶å„èŠ‚ç‚¹ï¼Œæ„å»ºæ‹¼æ¥é“¾è¡¨:</p><ul><li>è®¾åŸé“¾è¡¨ä¸º node1-&gt;node2-&gt;â‹¯ ï¼Œæ„å»ºçš„æ‹¼æ¥é“¾è¡¨å¦‚ä¸‹æ‰€ç¤ºï¼š<br>node1 -&gt;node1{new}-&gt;node2-&gt;node2{new}-&gt;â€¦.</li></ul></li><li><p>æ„å»ºæ–°é“¾è¡¨å„èŠ‚ç‚¹çš„ random æŒ‡å‘ï¼š</p><ul><li>å½“è®¿é—®åŸèŠ‚ç‚¹ cur çš„éšæœºæŒ‡å‘èŠ‚ç‚¹ cur.random æ—¶ï¼Œå¯¹åº”æ–°èŠ‚ç‚¹ cur.next çš„éšæœºæŒ‡å‘èŠ‚ç‚¹ä¸ºcur.random.nextã€‚</li></ul></li><li><p>æ‹†åˆ†åŸ &#x2F; æ–°é“¾è¡¨ï¼š</p></li></ol><ul><li>è®¾ç½® pre &#x2F; cur åˆ†åˆ«æŒ‡å‘åŸ &#x2F; æ–°é“¾è¡¨å¤´èŠ‚ç‚¹ï¼Œéå†æ‰§è¡Œ pre.next &#x3D; pre.next.next å’Œ cur.next &#x3D; cur.next.next å°†ä¸¤é“¾è¡¨æ‹†åˆ†å¼€ã€‚</li></ul><ol start="4"><li>è¿”å›æ–°é“¾è¡¨çš„å¤´èŠ‚ç‚¹ res å³å¯ã€‚</li></ol><p><strong>å¤æ‚åº¦åˆ†æï¼š</strong><br>æ—¶é—´å¤æ‚åº¦ O(N)O(N) ï¼š ä¸‰è½®éå†é“¾è¡¨ï¼Œä½¿ç”¨ O(N)O(N) æ—¶é—´ã€‚<br>ç©ºé—´å¤æ‚åº¦ O(1)O(1) ï¼š èŠ‚ç‚¹å¼•ç”¨å˜é‡ä½¿ç”¨å¸¸æ•°å¤§å°çš„é¢å¤–ç©ºé—´ã€‚</p><p><img src="https://pic.leetcode-cn.com/1604747285-LidbfG-Picture16.png" alt="img"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‹¼æ¥ + æ‹†åˆ†</span></span><br><span class="line"><span class="comment"> * */</span></span><br><span class="line"><span class="keyword">public</span> Node <span class="title function_">copyRandomList2</span><span class="params">(Node head)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¤åˆ¶å„èŠ‚ç‚¹ï¼Œæ„å»ºæ‹¼æ¥é“¾è¡¨</span></span><br><span class="line">    <span class="type">Node</span> <span class="variable">cur</span> <span class="operator">=</span> head;</span><br><span class="line">    <span class="keyword">while</span> (cur != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">temp</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>(cur.val);</span><br><span class="line">        temp.next = cur.next;</span><br><span class="line">        cur.next = temp;</span><br><span class="line">        cur = temp.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ„å»ºæ–°é“¾è¡¨å„èŠ‚ç‚¹çš„ random æŒ‡å‘</span></span><br><span class="line">    cur = head;</span><br><span class="line">    <span class="keyword">while</span> (cur != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (cur.random != <span class="literal">null</span>)</span><br><span class="line">            cur.next.random = cur.random.next;</span><br><span class="line">        cur  = cur.next.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ‹†åˆ†ä¸¤é“¾è¡¨</span></span><br><span class="line">    cur = head.next;</span><br><span class="line">    <span class="type">Node</span> <span class="variable">pre</span> <span class="operator">=</span> head, res = head.next;</span><br><span class="line">    <span class="keyword">while</span> (cur.next != <span class="literal">null</span>) &#123;</span><br><span class="line">        pre.next = pre.next.next;</span><br><span class="line">        cur.next = cur.next.next;</span><br><span class="line">        pre = pre.next;</span><br><span class="line">        cur = cur.next;</span><br><span class="line">    &#125;</span><br><span class="line">    pre.next = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡-Offer-58-II-å·¦æ—‹è½¬å­—ç¬¦ä¸²"><a href="#å‰‘æŒ‡-Offer-58-II-å·¦æ—‹è½¬å­—ç¬¦ä¸²" class="headerlink" title="å‰‘æŒ‡ Offer 58 - II. å·¦æ—‹è½¬å­—ç¬¦ä¸²"></a>å‰‘æŒ‡ Offer 58 - II. å·¦æ—‹è½¬å­—ç¬¦ä¸²</h3><p>å­—ç¬¦ä¸²çš„å·¦æ—‹è½¬æ“ä½œæ˜¯æŠŠå­—ç¬¦ä¸²å‰é¢çš„è‹¥å¹²ä¸ªå­—ç¬¦è½¬ç§»åˆ°å­—ç¬¦ä¸²çš„å°¾éƒ¨ã€‚è¯·å®šä¹‰ä¸€ä¸ªå‡½æ•°å®ç°å­—ç¬¦ä¸²å·¦æ—‹è½¬æ“ä½œçš„åŠŸèƒ½ã€‚æ¯”å¦‚ï¼Œè¾“å…¥å­—ç¬¦ä¸²â€abcdefgâ€å’Œæ•°å­—2ï¼Œè¯¥å‡½æ•°å°†è¿”å›å·¦æ—‹è½¬ä¸¤ä½å¾—åˆ°çš„ç»“æœâ€cdefgabâ€ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: s = &quot;abcdefg&quot;, k = 2</span><br><span class="line">è¾“å‡º: &quot;cdefgab&quot;</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: s = &quot;lrloseumgh&quot;, k = 6</span><br><span class="line">è¾“å‡º: &quot;umghlrlose&quot;</span><br></pre></td></tr></table></figure><p><strong>é™åˆ¶ï¼š</strong></p><ul><li><code>1 &lt;= k &lt; s.length &lt;= 10000</code></li></ul><p>Related Topics</p><p>æ•°å­¦</p><p>åŒæŒ‡é’ˆ</p><p>å­—ç¬¦ä¸²</p><h4 id="å­—ç¬¦ä¸²åˆ‡ç‰‡"><a href="#å­—ç¬¦ä¸²åˆ‡ç‰‡" class="headerlink" title="å­—ç¬¦ä¸²åˆ‡ç‰‡"></a>å­—ç¬¦ä¸²åˆ‡ç‰‡</h4><blockquote><p>åº”ç”¨å­—ç¬¦ä¸²åˆ‡ç‰‡å‡½æ•°ï¼Œå¯æ–¹ä¾¿å®ç°å·¦æ—‹è½¬å­—ç¬¦ä¸²ã€‚</p></blockquote><p>è·å–å­—ç¬¦ä¸² s[n:] åˆ‡ç‰‡å’Œ s[:n] åˆ‡ç‰‡ï¼Œä½¿ç”¨ â€œ+â€ è¿ç®—ç¬¦æ‹¼æ¥å¹¶è¿”å›å³å¯ã€‚</p><p><strong>å¤æ‚åº¦åˆ†æï¼š</strong><br>æ—¶é—´å¤æ‚åº¦ O(N)ï¼š å…¶ä¸­ NN ä¸ºå­—ç¬¦ä¸² s çš„é•¿åº¦ï¼Œå­—ç¬¦ä¸²åˆ‡ç‰‡å‡½æ•°ä¸ºçº¿æ€§æ—¶é—´å¤æ‚åº¦ï¼ˆå‚è€ƒèµ„æ–™ï¼‰ã€‚<br>ç©ºé—´å¤æ‚åº¦ O(N)ï¼š ä¸¤ä¸ªå­—ç¬¦ä¸²åˆ‡ç‰‡çš„æ€»é•¿åº¦ä¸º Nã€‚</p><p><img src="https://pic.leetcode-cn.com/1600793170-eyvDTJ-Picture1.png" alt="Picture1.png"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">reverseLeftWords</span><span class="params">(String s, <span class="type">int</span> n)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> s.substring(n, s.length()) + s.substring(<span class="number">0</span>, n);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åˆ—è¡¨éå†æ‹¼æ¥"><a href="#åˆ—è¡¨éå†æ‹¼æ¥" class="headerlink" title="åˆ—è¡¨éå†æ‹¼æ¥"></a>åˆ—è¡¨éå†æ‹¼æ¥</h4><blockquote><p>è‹¥é¢è¯•è§„å®šä¸å…è®¸ä½¿ç”¨ åˆ‡ç‰‡å‡½æ•° ï¼Œåˆ™ä½¿ç”¨æ­¤æ–¹æ³•ã€‚</p></blockquote><p><strong>ç®—æ³•æµç¨‹ï¼š</strong></p><ol><li>æ–°å»ºä¸€ä¸ª StringBuilderï¼Œè®°ä¸º res ï¼›</li><li>å…ˆå‘ res æ·»åŠ  â€œç¬¬ n+1 ä½è‡³æœ«ä½çš„å­—ç¬¦â€ ï¼›</li><li>å†å‘ res æ·»åŠ  â€œé¦–ä½è‡³ç¬¬ n ä½çš„å­—ç¬¦â€ ï¼›</li><li>å°† res è½¬åŒ–ä¸ºå­—ç¬¦ä¸²å¹¶è¿”å›ï¼›</li></ol><p><strong>å¤æ‚åº¦åˆ†æï¼š</strong><br>æ—¶é—´å¤æ‚åº¦ O(N)O(N) ï¼š çº¿æ€§éå† s å¹¶æ·»åŠ ï¼Œä½¿ç”¨çº¿æ€§æ—¶é—´ã€‚<br>ç©ºé—´å¤æ‚åº¦ O(N)O(N) ï¼š æ–°å»ºçš„è¾…åŠ© res ä½¿ç”¨ O(N)O(N) å¤§å°çš„é¢å¤–ç©ºé—´ã€‚</p><p><img src="https://pic.leetcode-cn.com/1600793170-ViWBNV-Picture2.png" alt="Picture2.png"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">reverseLeftWords</span><span class="params">(String s, <span class="type">int</span> n)</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">res</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> n; i &lt; s.length(); i++)</span><br><span class="line">            res.append(s.charAt(i));</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            res.append(s.charAt(i));</span><br><span class="line">        <span class="keyword">return</span> res.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ±‚ä½™è¿ç®—åŠ é€Ÿ</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">reverseLeftWords</span><span class="params">(String s, <span class="type">int</span> n)</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">res</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> n; i &lt; n + s.length(); i++)</span><br><span class="line">            res.append(s.charAt(i % s.length()));</span><br><span class="line">        <span class="keyword">return</span> res.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å­—ç¬¦ä¸²éå†æ‹¼æ¥"><a href="#å­—ç¬¦ä¸²éå†æ‹¼æ¥" class="headerlink" title="å­—ç¬¦ä¸²éå†æ‹¼æ¥"></a>å­—ç¬¦ä¸²éå†æ‹¼æ¥</h4><blockquote><p>è‹¥è§„å®š Java åªèƒ½ç”¨ String ï¼Œåˆ™ä½¿ç”¨æ­¤æ–¹æ³•ã€‚</p></blockquote><p>æ­¤æ–¹æ³•ä¸ æ–¹æ³•äºŒ æ€è·¯ä¸€è‡´ï¼ŒåŒºåˆ«æ˜¯ä½¿ç”¨å­—ç¬¦ä¸²ä»£æ›¿åˆ—è¡¨ã€‚</p><p><strong>å¤æ‚åº¦åˆ†æï¼š</strong><br>æ—¶é—´å¤æ‚åº¦ O(N)ï¼š çº¿æ€§éå† s å¹¶æ·»åŠ ï¼Œä½¿ç”¨çº¿æ€§æ—¶é—´ã€‚<br>ç©ºé—´å¤æ‚åº¦ O(N) ï¼š å‡è®¾å¾ªç¯è¿‡ç¨‹ä¸­å†…å­˜ä¼šè¢«åŠæ—¶å›æ”¶ï¼Œå†…å­˜ä¸­è‡³å°‘åŒæ—¶å­˜åœ¨é•¿åº¦ä¸º N å’Œ Nâˆ’1 çš„ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼ˆæ–°å»ºé•¿åº¦ä¸º N çš„ res éœ€è¦ä½¿ç”¨å‰ä¸€ä¸ªé•¿åº¦ Nâˆ’1 çš„ res ï¼‰ï¼Œå› æ­¤è‡³å°‘ä½¿ç”¨ O(N) çš„é¢å¤–ç©ºé—´ã€‚</p><p><img src="https://pic.leetcode-cn.com/1600793170-uasqXO-Picture3.png" alt="Picture3.png"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">reverseLeftWords</span><span class="params">(String s, <span class="type">int</span> n)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">res</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> n; i &lt; s.length(); i++)</span><br><span class="line">            res += s.charAt(i);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            res += s.charAt(i);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ±‚ä½™è¿ç®—åŠ é€Ÿ</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">reverseLeftWords</span><span class="params">(String s, <span class="type">int</span> n)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">res</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> n; i &lt; n + s.length(); i++)</span><br><span class="line">            res += s.charAt(i % s.length());</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡-Offer-59-I-æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼"><a href="#å‰‘æŒ‡-Offer-59-I-æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼" class="headerlink" title="å‰‘æŒ‡ Offer 59 - I. æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼"></a>å‰‘æŒ‡ Offer 59 - I. æ»‘åŠ¨çª—å£çš„æœ€å¤§å€¼</h3><p>ç»™å®šä¸€ä¸ªæ•°ç»„ <code>nums</code> å’Œæ»‘åŠ¨çª—å£çš„å¤§å° <code>k</code>ï¼Œè¯·æ‰¾å‡ºæ‰€æœ‰æ»‘åŠ¨çª—å£é‡Œçš„æœ€å¤§å€¼ã€‚</p><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: nums = [1,3,-1,-3,5,3,6,7], å’Œ k = 3</span><br><span class="line">è¾“å‡º: [3,3,5,5,6,7] </span><br><span class="line">è§£é‡Š: </span><br><span class="line"></span><br><span class="line">  æ»‘åŠ¨çª—å£çš„ä½ç½®                æœ€å¤§å€¼</span><br><span class="line">---------------               -----</span><br><span class="line">[1  3  -1] -3  5  3  6  7       3</span><br><span class="line"> 1 [3  -1  -3] 5  3  6  7       3</span><br><span class="line"> 1  3 [-1  -3  5] 3  6  7       5</span><br><span class="line"> 1  3  -1 [-3  5  3] 6  7       5</span><br><span class="line"> 1  3  -1  -3 [5  3  6] 7       6</span><br><span class="line"> 1  3  -1  -3  5 [3  6  7]      7</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><p>ä½ å¯ä»¥å‡è®¾ <em>k</em> æ€»æ˜¯æœ‰æ•ˆçš„ï¼Œåœ¨è¾“å…¥æ•°ç»„ <strong>ä¸ä¸ºç©º</strong> çš„æƒ…å†µä¸‹ï¼Œ<code>1 â‰¤ k â‰¤ nums.length</code>ã€‚</p><p>é˜Ÿåˆ—</p><p>æ»‘åŠ¨çª—å£</p><p>å•è°ƒé˜Ÿåˆ—</p><p>å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰</p><hr><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>è®¾çª—å£åŒºé—´ä¸º [i, j] ï¼Œæœ€å¤§å€¼ä¸º x j ã€‚å½“çª—å£å‘å‰ç§»åŠ¨ä¸€æ ¼ï¼Œåˆ™åŒºé—´å˜ä¸º [i+1,j+1]ï¼Œå³æ·»åŠ äº† nums[j + 1] ï¼Œåˆ é™¤äº†nums[i] ã€‚</p><p>è‹¥åªå‘çª—å£ [i, j]å³è¾¹æ·»åŠ æ•°å­— nums[j + 1]ï¼Œåˆ™æ–°çª—å£æœ€å¤§å€¼å¯ä»¥ é€šè¿‡ä¸€æ¬¡å¯¹æ¯” ä½¿ç”¨O(1) æ—¶é—´å¾—åˆ°ï¼Œå³ï¼š<code>x&#123;j+1&#125; = max(x&#123;j&#125;, nums[j + 1])</code>è€Œç”±äºåˆ é™¤çš„ nums[i]å¯èƒ½æ°å¥½æ˜¯çª—å£å†…å”¯ä¸€çš„æœ€å¤§å€¼ x jï¼Œå› æ­¤ä¸èƒ½é€šè¿‡ä»¥ä¸Šæ–¹æ³•è®¡ç®— x j+1ï¼Œè€Œå¿…é¡»ä½¿ç”¨O(jâˆ’i) æ—¶é—´ï¼Œ éå†æ•´ä¸ªçª—å£åŒºé—´ è·å–æœ€å¤§å€¼ï¼Œå³ï¼šx{j+1} &#x3D; max(nums(i+1),â€¦â€¦. , num(j+1))</p><p>æ ¹æ®ä»¥ä¸Šåˆ†æï¼Œå¯å¾— æš´åŠ›æ³• çš„æ—¶é—´å¤æ‚åº¦ä¸º O((n-k+1)k)â‰ˆO(nk) ã€‚</p><ul><li>è®¾æ•°ç»„ numsçš„é•¿åº¦ä¸º nn ï¼Œåˆ™å…±æœ‰ (n-k+1)ä¸ªçª—å£ï¼›</li><li>è·å–æ¯ä¸ªçª—å£æœ€å¤§å€¼éœ€çº¿æ€§éå†ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(k)ã€‚</li></ul><p><img src="https://pic.leetcode-cn.com/1600878237-pBiBdf-Picture1.png" alt="Picture1.png"></p><blockquote><p><strong>æœ¬é¢˜éš¾ç‚¹ï¼š</strong> å¦‚ä½•åœ¨æ¯æ¬¡çª—å£æ»‘åŠ¨åï¼Œå°† â€œè·å–çª—å£å†…æœ€å¤§å€¼â€ çš„æ—¶é—´å¤æ‚åº¦ä» O(k) é™ä½è‡³ O(1)ã€‚</p></blockquote><p>å›å¿† å‰‘æŒ‡Offer 30. åŒ…å« min å‡½æ•°çš„æ ˆ ï¼Œå…¶ä½¿ç”¨ <strong>å•è°ƒæ ˆ</strong> å®ç°äº†éšæ„å…¥æ ˆã€å‡ºæ ˆæƒ…å†µä¸‹çš„ O(1)æ—¶é—´è·å– â€œæ ˆå†…æœ€å°å€¼â€ ã€‚æœ¬é¢˜åŒç†ï¼Œä¸åŒç‚¹åœ¨äº â€œå‡ºæ ˆæ“ä½œâ€ åˆ é™¤çš„æ˜¯ â€œåˆ—è¡¨å°¾éƒ¨å…ƒç´ â€ ï¼Œè€Œ â€œçª—å£æ»‘åŠ¨â€ åˆ é™¤çš„æ˜¯ â€œåˆ—è¡¨é¦–éƒ¨å…ƒç´ â€ã€‚</p><p>çª—å£å¯¹åº”çš„æ•°æ®ç»“æ„ä¸º <strong>åŒç«¯é˜Ÿåˆ—</strong> ï¼Œæœ¬é¢˜ä½¿ç”¨ <strong>å•è°ƒé˜Ÿåˆ—</strong> å³å¯è§£å†³ä»¥ä¸Šé—®é¢˜ã€‚éå†æ•°ç»„æ—¶ï¼Œæ¯è½®ä¿è¯å•è°ƒé˜Ÿåˆ— dequeï¼š</p><ol><li>deque å†… <strong>ä»…åŒ…å«çª—å£å†…çš„å…ƒç´ </strong> â‡’ æ¯è½®çª—å£æ»‘åŠ¨ç§»é™¤äº†å…ƒç´ nums[iâˆ’1] ï¼Œéœ€å°† dequeå†…çš„å¯¹åº”å…ƒç´ ä¸€èµ·åˆ é™¤ã€‚</li><li>deque å†…çš„å…ƒç´  <strong>éä¸¥æ ¼é€’å‡</strong> â‡’ æ¯è½®çª—å£æ»‘åŠ¨æ·»åŠ äº†å…ƒç´  nums[j + 1]ï¼Œéœ€å°† dequeå†…æ‰€æœ‰ &lt; nums[j + 1]çš„å…ƒç´ åˆ é™¤ã€‚</li></ol><p><strong>ç®—æ³•æµç¨‹ï¼š</strong></p><ol><li>åˆå§‹åŒ–ï¼š åŒç«¯é˜Ÿåˆ— deque ï¼Œç»“æœåˆ—è¡¨ res ï¼Œæ•°ç»„é•¿åº¦ n ï¼›</li><li>æ»‘åŠ¨çª—å£ï¼š å·¦è¾¹ç•ŒèŒƒå›´iâˆˆ[1âˆ’k,nâˆ’k] ï¼Œå³è¾¹ç•ŒèŒƒå›´ jâˆˆ[0,nâˆ’1] ï¼›<ol><li>è‹¥ i &gt; 0 ä¸” é˜Ÿé¦–å…ƒç´  deque[0] &#x3D;&#x3D; è¢«åˆ é™¤å…ƒç´  nums[iâˆ’1] ï¼šåˆ™é˜Ÿé¦–å…ƒç´ å‡ºé˜Ÿï¼›</li><li>åˆ é™¤ deque å†…æ‰€æœ‰ &lt;nums[j] çš„å…ƒç´ ï¼Œä»¥ä¿æŒ deque é€’å‡ï¼›</li><li>å°† nums[j]æ·»åŠ è‡³deque å°¾éƒ¨ï¼›</li><li>è‹¥å·²å½¢æˆçª—å£ï¼ˆå³ iâ‰¥0 ï¼‰ï¼šå°†çª—å£æœ€å¤§å€¼ï¼ˆå³é˜Ÿé¦–å…ƒç´  deque[0] ï¼‰æ·»åŠ è‡³åˆ—è¡¨ res ï¼›</li></ol></li><li>è¿”å›å€¼ï¼š è¿”å›ç»“æœåˆ—è¡¨ resres ï¼›</li></ol><p><img src="https://pic.leetcode-cn.com/1600878237-YoQeRX-Picture4.png" alt="img"></p><p><img src="https://pic.leetcode-cn.com/1600878237-cFWnrv-Picture5.png" alt="img"></p><p><img src="https://pic.leetcode-cn.com/1600878237-jrguEx-Picture6.png" alt="img"></p><p><img src="https://pic.leetcode-cn.com/1600878237-KPnHbt-Picture8.png" alt="img"></p><p><strong>å¤æ‚åº¦åˆ†æï¼š</strong><br>æ—¶é—´å¤æ‚åº¦ O(n) ï¼š å…¶ä¸­ nn ä¸ºæ•°ç»„ nums é•¿åº¦ï¼›çº¿æ€§éå†nums å ç”¨O(n) ï¼›æ¯ä¸ªå…ƒç´ æœ€å¤šä»…å…¥é˜Ÿå’Œå‡ºé˜Ÿä¸€æ¬¡ï¼Œå› æ­¤å•è°ƒé˜Ÿåˆ— dequeå ç”¨ O(2n) ã€‚<br>ç©ºé—´å¤æ‚åº¦ O(k)ï¼š åŒç«¯é˜Ÿåˆ—deque ä¸­æœ€å¤šåŒæ—¶å­˜å‚¨ kä¸ªå…ƒç´ ï¼ˆå³çª—å£å¤§å°ï¼‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span>[] maxSlidingWindow2(<span class="type">int</span>[] nums, <span class="type">int</span> k) &#123;</span><br><span class="line">    <span class="keyword">if</span>(nums.length == <span class="number">0</span> || k == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">0</span>];</span><br><span class="line">    Deque&lt;Integer&gt; deque = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    <span class="type">int</span>[] res = <span class="keyword">new</span> <span class="title class_">int</span>[nums.length - k + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>, i = <span class="number">1</span> - k; j &lt; nums.length; i++, j++) &#123;</span><br><span class="line">        <span class="comment">// åˆ é™¤ deque ä¸­å¯¹åº”çš„ nums[i-1]</span></span><br><span class="line">        <span class="keyword">if</span>(i &gt; <span class="number">0</span> &amp;&amp; deque.peekFirst() == nums[i - <span class="number">1</span>])</span><br><span class="line">            deque.removeFirst();</span><br><span class="line">        <span class="comment">// ä¿æŒ deque é€’å‡</span></span><br><span class="line">        <span class="keyword">while</span>(!deque.isEmpty() &amp;&amp; deque.peekLast() &lt; nums[j])</span><br><span class="line">            deque.removeLast();</span><br><span class="line">        deque.addLast(nums[j]);</span><br><span class="line">        <span class="comment">// è®°å½•çª—å£æœ€å¤§å€¼</span></span><br><span class="line">        <span class="keyword">if</span>(i &gt;= <span class="number">0</span>)</span><br><span class="line">            res[i] = deque.peekFirst();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡-Offer-59-II-é˜Ÿåˆ—çš„æœ€å¤§å€¼"><a href="#å‰‘æŒ‡-Offer-59-II-é˜Ÿåˆ—çš„æœ€å¤§å€¼" class="headerlink" title="å‰‘æŒ‡ Offer 59 - II. é˜Ÿåˆ—çš„æœ€å¤§å€¼"></a>å‰‘æŒ‡ Offer 59 - II. é˜Ÿåˆ—çš„æœ€å¤§å€¼</h3><p>è¯·å®šä¹‰ä¸€ä¸ªé˜Ÿåˆ—å¹¶å®ç°å‡½æ•° <code>max_value</code> å¾—åˆ°é˜Ÿåˆ—é‡Œçš„æœ€å¤§å€¼ï¼Œè¦æ±‚å‡½æ•°<code>max_value</code>ã€<code>push_back</code> å’Œ <code>pop_front</code> çš„<strong>å‡æ‘Š</strong>æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(1)ã€‚</p><p>è‹¥é˜Ÿåˆ—ä¸ºç©ºï¼Œ<code>pop_front</code> å’Œ <code>max_value</code> éœ€è¦è¿”å› -1</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: </span><br><span class="line">[&quot;MaxQueue&quot;,&quot;push_back&quot;,&quot;push_back&quot;,&quot;max_value&quot;,&quot;pop_front&quot;,&quot;max_value&quot;]</span><br><span class="line">[[],[1],[2],[],[],[]]</span><br><span class="line">è¾“å‡º: [null,null,null,2,1,2]</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: </span><br><span class="line">[&quot;MaxQueue&quot;,&quot;pop_front&quot;,&quot;max_value&quot;]</span><br><span class="line">[[],[],[]]</span><br><span class="line">è¾“å‡º: [null,-1,-1]</span><br></pre></td></tr></table></figure><p><strong>é™åˆ¶ï¼š</strong></p><ul><li><code>1 &lt;= push_back,pop_front,max_valueçš„æ€»æ“ä½œæ•° &lt;= 10000</code></li><li><code>1 &lt;= value &lt;= 10^5</code></li></ul><p>Related Topics</p><p>è®¾è®¡</p><p>é˜Ÿåˆ—</p><p>å•è°ƒé˜Ÿåˆ—</p><hr><p><strong>è§£é¢˜æ€è·¯ï¼š</strong></p><p>è€ƒè™‘åˆ©ç”¨ æ•°æ®ç»“æ„ æ¥å®ç°ï¼Œå³ç»å¸¸ä½¿ç”¨çš„ â€œç©ºé—´æ¢æ—¶é—´â€ ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œè€ƒè™‘æ„å»ºä¸€ä¸ªé€’å‡åˆ—è¡¨æ¥ä¿å­˜é˜Ÿåˆ— æ‰€æœ‰é€’å‡çš„å…ƒç´  ï¼Œé€’å‡é“¾è¡¨éšç€å…¥é˜Ÿå’Œå‡ºé˜Ÿæ“ä½œå®æ—¶æ›´æ–°ï¼Œè¿™æ ·é˜Ÿåˆ—æœ€å¤§å…ƒç´ å°±å§‹ç»ˆå¯¹åº”é€’å‡åˆ—è¡¨çš„é¦–å…ƒç´ ï¼Œå®ç°äº†è·å–æœ€å¤§å€¼O(1) æ—¶é—´å¤æ‚åº¦ã€‚</p><p><img src="https://pic.leetcode-cn.com/1609261470-gMTEAf-Picture2.png" alt="Picture2.png"></p><p>ä¸ºäº†å®ç°æ­¤é€’å‡åˆ—è¡¨ï¼Œéœ€è¦ä½¿ç”¨ <strong>åŒå‘é˜Ÿåˆ—</strong> ï¼Œå‡è®¾é˜Ÿåˆ—å·²ç»æœ‰è‹¥å¹²å…ƒç´ ï¼š</p><ol><li>å½“æ‰§è¡Œå…¥é˜Ÿ push_back() æ—¶ï¼š è‹¥å…¥é˜Ÿä¸€ä¸ªæ¯”é˜Ÿåˆ—æŸäº›å…ƒç´ æ›´å¤§çš„æ•°å­— x ï¼Œåˆ™ä¸ºäº†ä¿æŒæ­¤åˆ—è¡¨é€’å‡ï¼Œéœ€è¦å°†åŒå‘é˜Ÿåˆ— å°¾éƒ¨æ‰€æœ‰å°äº x çš„å…ƒç´  å¼¹å‡ºã€‚</li><li>å½“æ‰§è¡Œå‡ºé˜Ÿ pop_front() æ—¶ï¼š è‹¥å‡ºé˜Ÿçš„å…ƒç´ æ˜¯æœ€å¤§å…ƒç´ ï¼Œåˆ™ åŒå‘é˜Ÿåˆ— éœ€è¦åŒæ—¶ <strong>å°†é¦–å…ƒç´ å‡ºé˜Ÿ</strong> ï¼Œä»¥ä¿æŒé˜Ÿåˆ—å’ŒåŒå‘é˜Ÿåˆ—çš„å…ƒç´ ä¸€è‡´æ€§ã€‚</li></ol><blockquote><p>ä½¿ç”¨åŒå‘é˜Ÿåˆ—åŸå› ï¼šç»´æŠ¤é€’å‡åˆ—è¡¨éœ€è¦å…ƒç´ é˜Ÿé¦–å¼¹å‡ºã€é˜Ÿå°¾æ’å…¥ã€é˜Ÿå°¾å¼¹å‡ºæ“ä½œçš†ä¸ºO(1) æ—¶é—´å¤æ‚åº¦ã€‚</p></blockquote><p><strong>å‡½æ•°è®¾è®¡ï¼š</strong></p><p>åˆå§‹åŒ–é˜Ÿåˆ— queue ï¼ŒåŒå‘é˜Ÿåˆ— deque ï¼›</p><p><strong>æœ€å¤§å€¼ max_value() ï¼š</strong></p><ul><li>å½“åŒå‘é˜Ÿåˆ— deque ä¸ºç©ºï¼Œåˆ™è¿”å›âˆ’1 ï¼›</li><li>å¦åˆ™ï¼Œè¿”å› deque é¦–å…ƒç´ ï¼›</li></ul><p><strong>å…¥é˜Ÿ push_back() ï¼š</strong></p><ul><li>å°†å…ƒç´  value å…¥é˜Ÿ queue ï¼›</li><li>å°†åŒå‘é˜Ÿåˆ—ä¸­é˜Ÿå°¾ æ‰€æœ‰ å°äº value çš„å…ƒç´ å¼¹å‡ºï¼ˆä»¥ä¿æŒ deque éå•è°ƒé€’å‡ï¼‰ï¼Œå¹¶å°†å…ƒç´  value å…¥é˜Ÿ deque ï¼›</li></ul><p><strong>å‡ºé˜Ÿ pop_front() ï¼š</strong></p><ul><li>è‹¥é˜Ÿåˆ— queue ä¸ºç©ºï¼Œåˆ™ç›´æ¥è¿”å› -1âˆ’1 ï¼›</li><li>å¦åˆ™ï¼Œå°† queue é¦–å…ƒç´ å‡ºé˜Ÿï¼›</li><li>è‹¥ deque é¦–å…ƒç´ å’Œ queue é¦–å…ƒç´  ç›¸ç­‰ ï¼Œåˆ™å°† deque é¦–å…ƒç´ å‡ºé˜Ÿï¼ˆä»¥ä¿æŒä¸¤é˜Ÿåˆ— å…ƒç´ ä¸€è‡´ ï¼‰ ï¼›</li></ul><blockquote><p>è®¾è®¡åŒå‘é˜Ÿåˆ—ä¸º éå•è°ƒé€’å‡ çš„åŸå› ï¼šè‹¥é˜Ÿåˆ— queue ä¸­å­˜åœ¨ä¸¤ä¸ª å€¼ç›¸åŒçš„æœ€å¤§å…ƒç´  ï¼Œæ­¤æ—¶ queue å’Œ deque åŒæ—¶å¼¹å‡ºä¸€ä¸ªæœ€å¤§å…ƒç´ ï¼Œè€Œ queue ä¸­è¿˜æœ‰ä¸€ä¸ªæ­¤æœ€å¤§å…ƒç´ ï¼›å³é‡‡ç”¨å•è°ƒé€’å‡å°†å¯¼è‡´ä¸¤é˜Ÿåˆ—ä¸­çš„å…ƒç´ ä¸ä¸€è‡´ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MaxQueue</span> &#123;</span><br><span class="line">    Queue&lt;Integer&gt; queue;</span><br><span class="line">    Deque&lt;Integer&gt; deque;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MaxQueue</span><span class="params">()</span> &#123;</span><br><span class="line">        queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        deque = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">max_value</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (deque.isEmpty()) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> deque.peekFirst();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push_back</span><span class="params">(<span class="type">int</span> value)</span> &#123;</span><br><span class="line">        queue.add(value);</span><br><span class="line">        <span class="keyword">while</span>(!deque.isEmpty() &amp;&amp; deque.peekLast() &lt; value)</span><br><span class="line">            deque.pollLast();</span><br><span class="line">        deque.offerLast(value);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">pop_front</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (queue.isEmpty())</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (Objects.equals(queue.peek(), deque.peekFirst()))</span><br><span class="line">                deque.removeFirst();</span><br><span class="line">            <span class="keyword">return</span> queue.poll();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡-Offer-67-æŠŠå­—ç¬¦ä¸²è½¬æ¢æˆæ•´æ•°"><a href="#å‰‘æŒ‡-Offer-67-æŠŠå­—ç¬¦ä¸²è½¬æ¢æˆæ•´æ•°" class="headerlink" title="å‰‘æŒ‡ Offer 67. æŠŠå­—ç¬¦ä¸²è½¬æ¢æˆæ•´æ•°"></a>å‰‘æŒ‡ Offer 67. æŠŠå­—ç¬¦ä¸²è½¬æ¢æˆæ•´æ•°</h3><p>å†™ä¸€ä¸ªå‡½æ•° StrToIntï¼Œå®ç°æŠŠå­—ç¬¦ä¸²è½¬æ¢æˆæ•´æ•°è¿™ä¸ªåŠŸèƒ½ã€‚ä¸èƒ½ä½¿ç”¨ atoi æˆ–è€…å…¶ä»–ç±»ä¼¼çš„åº“å‡½æ•°ã€‚</p><p>é¦–å…ˆï¼Œè¯¥å‡½æ•°ä¼šæ ¹æ®éœ€è¦ä¸¢å¼ƒæ— ç”¨çš„å¼€å¤´ç©ºæ ¼å­—ç¬¦ï¼Œç›´åˆ°å¯»æ‰¾åˆ°ç¬¬ä¸€ä¸ªéç©ºæ ¼çš„å­—ç¬¦ä¸ºæ­¢ã€‚</p><p>å½“æˆ‘ä»¬å¯»æ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªéç©ºå­—ç¬¦ä¸ºæ­£æˆ–è€…è´Ÿå·æ—¶ï¼Œåˆ™å°†è¯¥ç¬¦å·ä¸ä¹‹åé¢å°½å¯èƒ½å¤šçš„è¿ç»­æ•°å­—ç»„åˆèµ·æ¥ï¼Œä½œä¸ºè¯¥æ•´æ•°çš„æ­£è´Ÿå·ï¼›å‡å¦‚ç¬¬ä¸€ä¸ªéç©ºå­—ç¬¦æ˜¯æ•°å­—ï¼Œåˆ™ç›´æ¥å°†å…¶ä¸ä¹‹åè¿ç»­çš„æ•°å­—å­—ç¬¦ç»„åˆèµ·æ¥ï¼Œå½¢æˆæ•´æ•°ã€‚</p><p>è¯¥å­—ç¬¦ä¸²é™¤äº†æœ‰æ•ˆçš„æ•´æ•°éƒ¨åˆ†ä¹‹åä¹Ÿå¯èƒ½ä¼šå­˜åœ¨å¤šä½™çš„å­—ç¬¦ï¼Œè¿™äº›å­—ç¬¦å¯ä»¥è¢«å¿½ç•¥ï¼Œå®ƒä»¬å¯¹äºå‡½æ•°ä¸åº”è¯¥é€ æˆå½±å“ã€‚</p><p>æ³¨æ„ï¼šå‡å¦‚è¯¥å­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€ä¸ªéç©ºæ ¼å­—ç¬¦ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆæ•´æ•°å­—ç¬¦ã€å­—ç¬¦ä¸²ä¸ºç©ºæˆ–å­—ç¬¦ä¸²ä»…åŒ…å«ç©ºç™½å­—ç¬¦æ—¶ï¼Œåˆ™ä½ çš„å‡½æ•°ä¸éœ€è¦è¿›è¡Œè½¬æ¢ã€‚</p><p>åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œè‹¥å‡½æ•°ä¸èƒ½è¿›è¡Œæœ‰æ•ˆçš„è½¬æ¢æ—¶ï¼Œè¯·è¿”å› 0ã€‚</p><p><strong>è¯´æ˜ï¼š</strong></p><p>å‡è®¾æˆ‘ä»¬çš„ç¯å¢ƒåªèƒ½å­˜å‚¨ 32 ä½å¤§å°çš„æœ‰ç¬¦å·æ•´æ•°ï¼Œé‚£ä¹ˆå…¶æ•°å€¼èŒƒå›´ä¸º [âˆ’231, 231 âˆ’ 1]ã€‚å¦‚æœæ•°å€¼è¶…è¿‡è¿™ä¸ªèŒƒå›´ï¼Œè¯·è¿”å› INT_MAX (231 âˆ’ 1) æˆ– INT_MIN (âˆ’231) ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: &quot;42&quot;</span><br><span class="line">è¾“å‡º: 42</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: &quot;   -42&quot;</span><br><span class="line">è¾“å‡º: -42</span><br><span class="line">è§£é‡Š: ç¬¬ä¸€ä¸ªéç©ºç™½å­—ç¬¦ä¸º &#x27;-&#x27;, å®ƒæ˜¯ä¸€ä¸ªè´Ÿå·ã€‚</span><br><span class="line">     æˆ‘ä»¬å°½å¯èƒ½å°†è´Ÿå·ä¸åé¢æ‰€æœ‰è¿ç»­å‡ºç°çš„æ•°å­—ç»„åˆèµ·æ¥ï¼Œæœ€åå¾—åˆ° -42 ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: &quot;4193 with words&quot;</span><br><span class="line">è¾“å‡º: 4193</span><br><span class="line">è§£é‡Š: è½¬æ¢æˆªæ­¢äºæ•°å­— &#x27;3&#x27; ï¼Œå› ä¸ºå®ƒçš„ä¸‹ä¸€ä¸ªå­—ç¬¦ä¸ä¸ºæ•°å­—ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 4:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: &quot;words and 987&quot;</span><br><span class="line">è¾“å‡º: 0</span><br><span class="line">è§£é‡Š: ç¬¬ä¸€ä¸ªéç©ºå­—ç¬¦æ˜¯ &#x27;w&#x27;, ä½†å®ƒä¸æ˜¯æ•°å­—æˆ–æ­£ã€è´Ÿå·ã€‚</span><br><span class="line">     å› æ­¤æ— æ³•æ‰§è¡Œæœ‰æ•ˆçš„è½¬æ¢ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 5:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: &quot;-91283472332&quot;</span><br><span class="line">è¾“å‡º: -2147483648</span><br><span class="line">è§£é‡Š: æ•°å­— &quot;-91283472332&quot; è¶…è¿‡ 32 ä½æœ‰ç¬¦å·æ•´æ•°èŒƒå›´ã€‚ </span><br><span class="line">     å› æ­¤è¿”å› INT_MIN (âˆ’231) ã€‚</span><br></pre></td></tr></table></figure><p>Related Topics</p><p>å­—ç¬¦ä¸²</p><hr><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>æ ¹æ®é¢˜æ„ï¼Œæœ‰ä»¥ä¸‹å››ç§å­—ç¬¦éœ€è¦è€ƒè™‘ï¼š</p><ol><li><p>é¦–éƒ¨ç©ºæ ¼ï¼š åˆ é™¤ä¹‹å³å¯ï¼›</p></li><li><p>ç¬¦å·ä½ï¼š ä¸‰ç§æƒ…å†µï¼Œå³ â€˜â€™++â€™â€™ , â€˜â€™-âˆ’â€™â€™ , â€˜â€™æ— ç¬¦å·â€ ï¼›æ–°å»ºä¸€ä¸ªå˜é‡ä¿å­˜ç¬¦å·ä½ï¼Œè¿”å›å‰åˆ¤æ–­æ­£è´Ÿå³å¯ï¼›</p></li><li><p>éæ•°å­—å­—ç¬¦ï¼š é‡åˆ°é¦–ä¸ªéæ•°å­—çš„å­—ç¬¦æ—¶ï¼Œåº”ç«‹å³è¿”å›ï¼›</p></li><li><p>æ•°å­—å­—ç¬¦ï¼š</p><ol><li><p>å­—ç¬¦è½¬æ•°å­—ï¼š â€œæ­¤æ•°å­—çš„ ASCII ç â€ ä¸ â€œ 00 çš„ ASCII ç â€ ç›¸å‡å³å¯ï¼›</p></li><li><p>æ•°å­—æ‹¼æ¥ï¼š è‹¥ä»å·¦å‘å³éå†æ•°å­—ï¼Œè®¾å½“å‰ä½å­—ç¬¦ä¸º cc ï¼Œå½“å‰ä½æ•°å­—ä¸º xx ï¼Œæ•°å­—ç»“æœä¸º resres ï¼Œåˆ™æ•°å­—æ‹¼æ¥å…¬å¼ä¸ºï¼š</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210291215534.png" alt="image-20221029121552410"></p><p><img src="https://pic.leetcode-cn.com/1600793383-jCgsGU-Picture1.png" alt="Picture1.png"></p></li></ol></li></ol><p><strong>æ•°å­—è¶Šç•Œå¤„ç†ï¼š</strong></p><blockquote><p>é¢˜ç›®è¦æ±‚è¿”å›çš„æ•°å€¼èŒƒå›´åº”åœ¨[âˆ’2^31 ,2^31 âˆ’1] ï¼Œå› æ­¤éœ€è¦è€ƒè™‘æ•°å­—è¶Šç•Œé—®é¢˜ã€‚è€Œç”±äºé¢˜ç›®æŒ‡å‡º ç¯å¢ƒåªèƒ½å­˜å‚¨ 32 ä½å¤§å°çš„æœ‰ç¬¦å·æ•´æ•° ï¼Œå› æ­¤åˆ¤æ–­æ•°å­—è¶Šç•Œæ—¶ï¼Œè¦å§‹ç»ˆä¿æŒ res åœ¨ int ç±»å‹çš„å–å€¼èŒƒå›´å†…ã€‚</p></blockquote><p>åœ¨æ¯è½®æ•°å­—æ‹¼æ¥å‰ï¼Œåˆ¤æ–­res åœ¨æ­¤è½®æ‹¼æ¥åæ˜¯å¦è¶…è¿‡ 2147483647ï¼Œè‹¥è¶…è¿‡åˆ™åŠ ä¸Šç¬¦å·ä½ç›´æ¥è¿”å›ã€‚<br>è®¾æ•°å­—æ‹¼æ¥è¾¹ç•Œ bndry &#x3D; 2147483647 &#x2F;&#x2F; 10 &#x3D; 214748364ï¼Œåˆ™ä»¥ä¸‹ä¸¤ç§æƒ…å†µè¶Šç•Œï¼š</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210291218048.png" alt="image-20221029121808981"></p><p><img src="https://pic.leetcode-cn.com/1600793383-JZRYip-Picture2.png" alt="Picture2.png"></p><p><strong>å¤æ‚åº¦åˆ†æï¼š</strong><br>æ—¶é—´å¤æ‚åº¦ O(N) ï¼š å…¶ä¸­ N ä¸ºå­—ç¬¦ä¸²é•¿åº¦ï¼Œçº¿æ€§éå†å­—ç¬¦ä¸²å ç”¨ O(N) æ—¶é—´ã€‚<br>ç©ºé—´å¤æ‚åº¦ O(N) ï¼š åˆ é™¤é¦–å°¾ç©ºæ ¼åéœ€å»ºç«‹æ–°å­—ç¬¦ä¸²ï¼Œæœ€å·®æƒ…å†µä¸‹å ç”¨ O(N) é¢å¤–ç©ºé—´ã€‚</p><p>è‹¥ä¸ä½¿ç”¨ <code>trim() / strip()</code> åˆ é™¤é¦–éƒ¨ç©ºæ ¼ï¼Œè€Œé‡‡å–éå†è·³è¿‡ç©ºæ ¼çš„æ–¹å¼ï¼Œåˆ™å¯ä»¥å°†ç©ºé—´å¤æ‚åº¦é™ä½è‡³ O(1) ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">strToInt</span><span class="params">(String str)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">0</span>, <span class="comment">// è¿”å›å€¼</span></span><br><span class="line">        bndry = Integer.MAX_VALUE / <span class="number">10</span>; <span class="comment">// è¶Šç•Œæ ‡å¿—</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>, <span class="comment">// éå†</span></span><br><span class="line">        sign = <span class="number">1</span>, <span class="comment">// æ­£è´Ÿæ ‡å¿—ä½</span></span><br><span class="line">        length = str.length();</span><br><span class="line">    <span class="keyword">if</span> (length == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (str.charAt(i) == <span class="string">&#x27; &#x27;</span>) &#123; <span class="comment">// è·³è¿‡ç©ºæ ¼</span></span><br><span class="line">        <span class="keyword">if</span> (++i == length) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (str.charAt(i) == <span class="string">&#x27;-&#x27;</span>) sign = -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (str.charAt(i) == <span class="string">&#x27;+&#x27;</span> || str.charAt(i) == <span class="string">&#x27;-&#x27;</span>) i++;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i; j &lt; length; j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (str.charAt(j) &lt; <span class="string">&#x27;0&#x27;</span> || str.charAt(j) &gt; <span class="string">&#x27;9&#x27;</span>) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> (res &gt; bndry || res == bndry &amp;&amp; str.charAt(j) &gt; <span class="string">&#x27;7&#x27;</span>) <span class="comment">// è¶Šç•Œ</span></span><br><span class="line">            <span class="keyword">return</span> sign == <span class="number">1</span> ? Integer.MAX_VALUE : Integer.MIN_VALUE;</span><br><span class="line">        res = res * <span class="number">10</span> + (str.charAt(j) - <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res * sign;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="LC2-ä¸¤æ•°ä¹‹å’Œ"><a href="#LC2-ä¸¤æ•°ä¹‹å’Œ" class="headerlink" title="LC2. ä¸¤æ•°ä¹‹å’Œ"></a>LC2. ä¸¤æ•°ä¹‹å’Œ</h3><p>ç»™ä½ ä¸¤ä¸ª <strong>éç©º</strong> çš„é“¾è¡¨ï¼Œè¡¨ç¤ºä¸¤ä¸ªéè´Ÿçš„æ•´æ•°ã€‚å®ƒä»¬æ¯ä½æ•°å­—éƒ½æ˜¯æŒ‰ç…§ <strong>é€†åº</strong> çš„æ–¹å¼å­˜å‚¨çš„ï¼Œå¹¶ä¸”æ¯ä¸ªèŠ‚ç‚¹åªèƒ½å­˜å‚¨ <strong>ä¸€ä½</strong> æ•°å­—ã€‚</p><p>è¯·ä½ å°†ä¸¤ä¸ªæ•°ç›¸åŠ ï¼Œå¹¶ä»¥ç›¸åŒå½¢å¼è¿”å›ä¸€ä¸ªè¡¨ç¤ºå’Œçš„é“¾è¡¨ã€‚</p><p>ä½ å¯ä»¥å‡è®¾é™¤äº†æ•°å­— 0 ä¹‹å¤–ï¼Œè¿™ä¸¤ä¸ªæ•°éƒ½ä¸ä¼šä»¥ 0 å¼€å¤´ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2021/01/02/addtwonumber1.jpg" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šl1 = [2,4,3], l2 = [5,6,4]</span><br><span class="line">è¾“å‡ºï¼š[7,0,8]</span><br><span class="line">è§£é‡Šï¼š342 + 465 = 807.</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šl1 = [0], l2 = [0]</span><br><span class="line">è¾“å‡ºï¼š[0]</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šl1 = [9,9,9,9,9,9,9], l2 = [9,9,9,9]</span><br><span class="line">è¾“å‡ºï¼š[8,9,9,9,0,0,0,1]</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li>æ¯ä¸ªé“¾è¡¨ä¸­çš„èŠ‚ç‚¹æ•°åœ¨èŒƒå›´ <code>[1, 100]</code> å†…</li><li><code>0 &lt;= Node.val &lt;= 9</code></li><li>é¢˜ç›®æ•°æ®ä¿è¯åˆ—è¡¨è¡¨ç¤ºçš„æ•°å­—ä¸å«å‰å¯¼é›¶</li></ul><p>Related Topics</p><p>é€’å½’</p><p>é“¾è¡¨</p><p>æ•°å­¦</p><h4 id="æ„é€ æ–°é“¾è¡¨"><a href="#æ„é€ æ–°é“¾è¡¨" class="headerlink" title="æ„é€ æ–°é“¾è¡¨"></a>æ„é€ æ–°é“¾è¡¨</h4><p>é€šè¿‡è®¡ç®—ä¸¤ä¸ªé“¾è¡¨çš„å’Œæ„é€ ä¸€ä¸ªæ–°é“¾è¡¨ã€‚</p><p>æ—¶é—´å¤æ‚åº¦O(N)</p><p>ç©ºé—´å¤æ‚åº¦O(N)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">     * æ„å»ºæ–°é“¾è¡¨</span></span><br><span class="line"><span class="comment">     * æ—¶é—´å¤æ‚åº¦O(n)</span></span><br><span class="line"><span class="comment">     * ç©ºé—´å¤æ‚åº¦O(1)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="keyword">public</span> ListNode <span class="title function_">addTwoNumbers1</span><span class="params">(ListNode l1, ListNode l2)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">out</span> <span class="operator">=</span> <span class="number">0</span>;<span class="comment">//è®°å½•è¿›ä½</span></span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">cur1</span> <span class="operator">=</span> l1;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">cur2</span> <span class="operator">=</span> l2;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">head</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">cur</span> <span class="operator">=</span> head;</span><br><span class="line">    <span class="keyword">while</span> (cur1 != <span class="literal">null</span> || cur2 != <span class="literal">null</span>) &#123;</span><br><span class="line">        cur.next = <span class="keyword">new</span> <span class="title class_">ListNode</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> (cur1 == <span class="literal">null</span>) &#123;</span><br><span class="line">            cur.next.val = cur2.val + out;</span><br><span class="line">            cur2 = cur2.next;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (cur2 == <span class="literal">null</span>) &#123;</span><br><span class="line">            cur.next.val = cur1.val + out;</span><br><span class="line">            cur1 = cur1.next;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            cur.next.val = cur1.val + cur2.val + out;</span><br><span class="line">            cur1 = cur1.next;</span><br><span class="line">            cur2 = cur2.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (cur.next.val &gt; <span class="number">9</span>) &#123; <span class="comment">// 2 ä½æ•°</span></span><br><span class="line">            cur.next.val = cur.next.val % <span class="number">10</span>;</span><br><span class="line">            out = <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            out = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cur = cur.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (out == <span class="number">1</span>) &#123; <span class="comment">//å¦‚æœæœ‰è¿›ä½ å¡«ä¸Šè¿›ä½</span></span><br><span class="line">        cur.next = <span class="keyword">new</span> <span class="title class_">ListNode</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head.next;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åœ¨åŸé“¾è¡¨ä¸Šæ“ä½œ"><a href="#åœ¨åŸé“¾è¡¨ä¸Šæ“ä½œ" class="headerlink" title="åœ¨åŸé“¾è¡¨ä¸Šæ“ä½œ"></a>åœ¨åŸé“¾è¡¨ä¸Šæ“ä½œ</h4><p>å¦‚æœé“¾è¡¨1æ²¡æœ‰é“¾è¡¨2é•¿çš„è¯ï¼Œå°±æŠŠé“¾è¡¨2çš„åç»­æ¥åœ¨é“¾è¡¨1ä¸Šã€‚å¤„ç†åç»­æœ‰ç‚¹éº»çƒ¦ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åœ¨åŸé“¾è¡¨ä¸Šæ”¹å€¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> ListNode <span class="title function_">addTwoNumbers</span><span class="params">(ListNode l1, ListNode l2)</span> &#123;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">cur1</span> <span class="operator">=</span> l1;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">cur2</span> <span class="operator">=</span> l2;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">pre</span> <span class="operator">=</span> l1;</span><br><span class="line">    <span class="type">int</span> <span class="variable">out</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (cur1 != <span class="literal">null</span> &amp;&amp; cur2 != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (cur1.next == <span class="literal">null</span>) &#123; <span class="comment">//cur1 å°æ‹¼æ¥</span></span><br><span class="line">            cur1.next = cur2.next;</span><br><span class="line">            cur2.next = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cur1.val = cur1.val + cur2.val + out;</span><br><span class="line">        out = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (cur1.val &gt; <span class="number">9</span>) &#123;</span><br><span class="line">            cur1.val = cur1.val % <span class="number">10</span>;</span><br><span class="line">            out = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        pre = cur1;</span><br><span class="line">        cur1 = cur1.next;</span><br><span class="line">        cur2 = cur2.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (cur1 == <span class="literal">null</span> &amp;&amp; out == <span class="number">1</span>) &#123; <span class="comment">//ä½æ•°ç›¸åŒ æœ‰ä¸€ä¸ªè¿›ä½</span></span><br><span class="line">        pre.next = <span class="keyword">new</span> <span class="title class_">ListNode</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (cur1 != <span class="literal">null</span>) &#123; <span class="comment">//å¦‚æœå­˜åœ¨æ‹¼æ¥çš„æƒ…å†µï¼Œåˆ™å¯èƒ½å­˜åœ¨è¿›ä½æœªåŠ çš„æƒ…å†µ</span></span><br><span class="line">        cur1.val += out;</span><br><span class="line">        out = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (cur1.val &gt; <span class="number">9</span>) &#123;</span><br><span class="line">            cur1.val = cur1.val % <span class="number">10</span>;</span><br><span class="line">            out = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (cur1.next == <span class="literal">null</span> &amp;&amp; out == <span class="number">1</span>) &#123;</span><br><span class="line">            cur1.next = <span class="keyword">new</span> <span class="title class_">ListNode</span>(<span class="number">1</span>);</span><br><span class="line">            out = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cur1 = cur1.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> l1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æœ‰é™çŠ¶æ€è‡ªåŠ¨æœºï¼ˆFSMï¼‰"><a href="#æœ‰é™çŠ¶æ€è‡ªåŠ¨æœºï¼ˆFSMï¼‰" class="headerlink" title="æœ‰é™çŠ¶æ€è‡ªåŠ¨æœºï¼ˆFSMï¼‰"></a>æœ‰é™çŠ¶æ€è‡ªåŠ¨æœºï¼ˆFSMï¼‰</h2><p>â€ƒæœ‰é™çŠ¶æ€æœºï¼ˆFinite State Machine, FSMï¼‰ï¼Œåˆç§°æœ‰é™çŠ¶æ€è‡ªåŠ¨æœºï¼Œç®€ç§°çŠ¶æ€æœºï¼Œæ˜¯æŒ‡åœ¨æœ‰é™ä¸ªçŠ¶æ€ä¹‹é—´æŒ‰ç…§ä¸€å®šè§„å¾‹è½¬æ¢çš„æ—¶åºç”µè·¯ã€‚</p><p>ä»€ä¹ˆæ˜¯æœ‰é™çŠ¶æ€è‡ªåŠ¨æœº<br>æ˜¯ä¸€ç§å…·æœ‰ç¦»æ•£è¾“å…¥&#x2F;è¾“å‡ºç³»ç»Ÿçš„æ•°å­¦æ¨¡å‹ï¼Œç®€ç§° æœ‰é™è‡ªåŠ¨æœºã€‚è¿™ä¸€ç³»ç»Ÿå…·æœ‰ä»»æ„æœ‰é™æ•°é‡çš„å†…éƒ¨â€œçŠ¶æ€â€ã€‚</p><p>çŠ¶æ€:ä¸€ä¸ªæ ‡è¯†ï¼Œèƒ½åŒºåˆ†è‡ªåŠ¨æœºåœ¨ä¸åŒæ—¶åˆ»çš„çŠ¶å†µã€‚æœ‰é™çŠ¶æ€ç³»ç»Ÿå…·æœ‰ä»»æ„æœ‰é™æ•°ç›®çš„å†…éƒ¨â€œçŠ¶æ€â€</p><p>è‡ªåŠ¨æœºæ¥å—ä¸€å®šçš„è¾“å…¥ï¼Œæ‰§è¡Œä¸€å®šçš„åŠ¨ä½œï¼Œäº§ç”Ÿä¸€å®šçš„ç»“æœã€‚</p><p>è‡ªåŠ¨æœºçš„æœ¬è´¨:æ ¹æ®çŠ¶æ€ã€è¾“å…¥å’Œè§„åˆ™å†³å®šä¸‹ä¸€ä¸ªçŠ¶æ€</p><p>çŠ¶æ€ +è¾“å…¥(æ¿€åŠ±)+è§„åˆ™ -&gt; çŠ¶æ€è¿ç§»</p><p>å¯èƒ½çš„çŠ¶æ€ã€è¿è¡Œçš„è§„åˆ™éƒ½æ˜¯äº‹å…ˆç¡®å®šçš„ã€‚ä¸€æ—¦å¼€å§‹è¿è¡Œï¼Œå°±æŒ‰ç…§å®ç°ç¡®å®šçš„è§„åˆ™å·¥ä½œï¼Œå› æ­¤å«â€è‡ªåŠ¨æœºâ€ã€‚ä½¿ç”¨çŠ¶æ€è¿ç§»æè¿°æ•´ä¸ªå·¥ä½œè¿‡ç¨‹</p><p>æœ‰é™è‡ªåŠ¨æœºç¤ºæ„å›¾:</p><p><img src="https://img-blog.csdnimg.cn/img_convert/10b29ca6d5e0a9923a58c59041235ab0.png" alt="image-20220409152351649"></p><h3 id="åº”ç”¨æœ‰é™è‡ªåŠ¨æœºè§£é¢˜æ­¥éª¤"><a href="#åº”ç”¨æœ‰é™è‡ªåŠ¨æœºè§£é¢˜æ­¥éª¤" class="headerlink" title="åº”ç”¨æœ‰é™è‡ªåŠ¨æœºè§£é¢˜æ­¥éª¤"></a>åº”ç”¨æœ‰é™è‡ªåŠ¨æœºè§£é¢˜æ­¥éª¤</h3><p><strong>1ã€ç¡®å®šè¾“å…¥é›†</strong></p><p><strong>2ã€ç»˜åˆ¶çŠ¶æ€è¿ç§»å›¾ï¼ˆç¡®å®šçŠ¶æ€ï¼Œåœ¨æ¯ä¸€ä¸ªçŠ¶æ€ä¸‹å¯¹è¾“å…¥è¿›è¡Œåˆ†ç±»ï¼Œé’ˆå¯¹æ¯ä¸€ç±»è¾“å…¥ï¼Œç¡®å®šä¸‹ä¸€ä¸ªçŠ¶æ€ï¼‰</strong></p><p><strong>3ã€ç¡®å®šçŠ¶æ€è½¬ç§»å‡½æ•°ï¼ˆåœ¨æŸçŠ¶æ€ä¸‹ï¼Œæ¥æ”¶åˆ°æŸä¸€å­—ç¬¦åï¼Œè‡ªåŠ¨æœºè¦æ‰§è¡Œçš„æ“ä½œï¼Œä»¥åŠè¿ç§»åˆ°çš„ä¸‹ä¸€çŠ¶æ€ï¼‰</strong></p><h3 id="å‰‘æŒ‡-Offer-20-è¡¨ç¤ºæ•°å€¼çš„å­—ç¬¦ä¸²"><a href="#å‰‘æŒ‡-Offer-20-è¡¨ç¤ºæ•°å€¼çš„å­—ç¬¦ä¸²" class="headerlink" title="å‰‘æŒ‡ Offer 20. è¡¨ç¤ºæ•°å€¼çš„å­—ç¬¦ä¸²"></a>å‰‘æŒ‡ Offer 20. è¡¨ç¤ºæ•°å€¼çš„å­—ç¬¦ä¸²</h3><p>è¯·å®ç°ä¸€ä¸ªå‡½æ•°ç”¨æ¥åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦è¡¨ç¤º<strong>æ•°å€¼</strong>ï¼ˆåŒ…æ‹¬æ•´æ•°å’Œå°æ•°ï¼‰ã€‚</p><p><strong>æ•°å€¼</strong>ï¼ˆæŒ‰é¡ºåºï¼‰å¯ä»¥åˆ†æˆä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p><ol><li>è‹¥å¹²ç©ºæ ¼</li><li>ä¸€ä¸ª <strong>å°æ•°</strong> æˆ–è€… <strong>æ•´æ•°</strong></li><li>ï¼ˆå¯é€‰ï¼‰ä¸€ä¸ª <code>&#39;e&#39;</code> æˆ– <code>&#39;E&#39;</code> ï¼Œåé¢è·Ÿç€ä¸€ä¸ª <strong>æ•´æ•°</strong></li><li>è‹¥å¹²ç©ºæ ¼</li></ol><p><strong>å°æ•°</strong>ï¼ˆæŒ‰é¡ºåºï¼‰å¯ä»¥åˆ†æˆä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p><ol><li>ï¼ˆå¯é€‰ï¼‰ä¸€ä¸ªç¬¦å·å­—ç¬¦ï¼ˆ<code>&#39;+&#39;</code> æˆ– <code>&#39;-&#39;</code>ï¼‰</li><li>ä¸‹è¿°æ ¼å¼ä¹‹ä¸€ï¼š<ol><li>è‡³å°‘ä¸€ä½æ•°å­—ï¼Œåé¢è·Ÿç€ä¸€ä¸ªç‚¹ <code>&#39;.&#39;</code></li><li>è‡³å°‘ä¸€ä½æ•°å­—ï¼Œåé¢è·Ÿç€ä¸€ä¸ªç‚¹ <code>&#39;.&#39;</code> ï¼Œåé¢å†è·Ÿç€è‡³å°‘ä¸€ä½æ•°å­—</li><li>ä¸€ä¸ªç‚¹ <code>&#39;.&#39;</code> ï¼Œåé¢è·Ÿç€è‡³å°‘ä¸€ä½æ•°å­—</li></ol></li></ol><p><strong>æ•´æ•°</strong>ï¼ˆæŒ‰é¡ºåºï¼‰å¯ä»¥åˆ†æˆä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š</p><ol><li>ï¼ˆå¯é€‰ï¼‰ä¸€ä¸ªç¬¦å·å­—ç¬¦ï¼ˆ<code>&#39;+&#39;</code> æˆ– <code>&#39;-&#39;</code>ï¼‰</li><li>è‡³å°‘ä¸€ä½æ•°å­—</li></ol><p>éƒ¨åˆ†<strong>æ•°å€¼</strong>åˆ—ä¸¾å¦‚ä¸‹ï¼š</p><ul><li><code>[&quot;+100&quot;, &quot;5e2&quot;, &quot;-123&quot;, &quot;3.1416&quot;, &quot;-1E-16&quot;, &quot;0123&quot;]</code></li></ul><p>éƒ¨åˆ†<strong>éæ•°å€¼</strong>åˆ—ä¸¾å¦‚ä¸‹ï¼š</p><ul><li><code>[&quot;12e&quot;, &quot;1a3.14&quot;, &quot;1.2.3&quot;, &quot;+-5&quot;, &quot;12e+5.4&quot;]</code></li></ul><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šs = &quot;0&quot;</span><br><span class="line">è¾“å‡ºï¼štrue</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šs = &quot;e&quot;</span><br><span class="line">è¾“å‡ºï¼šfalse</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šs = &quot;.&quot;</span><br><span class="line">è¾“å‡ºï¼šfalse</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 4ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šs = &quot;    .1  &quot;</span><br><span class="line">è¾“å‡ºï¼štrue</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= s.length &lt;= 20</code></li><li><code>s</code> ä»…å«è‹±æ–‡å­—æ¯ï¼ˆå¤§å†™å’Œå°å†™ï¼‰ï¼Œæ•°å­—ï¼ˆ<code>0-9</code>ï¼‰ï¼ŒåŠ å· <code>&#39;+&#39;</code> ï¼Œå‡å· <code>&#39;-&#39;</code> ï¼Œç©ºæ ¼ <code>&#39; &#39;</code> æˆ–è€…ç‚¹ <code>&#39;.&#39;</code> ã€‚</li></ul><p>Related Topics</p><p>å­—ç¬¦ä¸²</p><hr><p>è§£é¢˜æ€è·¯ï¼š<br>æœ¬é¢˜ä½¿ç”¨æœ‰é™çŠ¶æ€è‡ªåŠ¨æœºã€‚æ ¹æ®å­—ç¬¦ç±»å‹å’Œåˆæ³•æ•°å€¼çš„ç‰¹ç‚¹ï¼Œå…ˆå®šä¹‰çŠ¶æ€ï¼Œå†ç”»å‡ºçŠ¶æ€è½¬ç§»å›¾ï¼Œæœ€åç¼–å†™ä»£ç å³å¯ã€‚</p><p><strong>å­—ç¬¦ç±»å‹</strong>ï¼š</p><p>ç©ºæ ¼ ã€Œ ã€ã€æ•°å­—ã€Œ 0â€”9ã€ ã€æ­£è´Ÿå· ã€Œ +, -ã€ ã€å°æ•°ç‚¹ ã€Œ . ã€ ã€å¹‚ç¬¦å· ã€Œ e, E ã€ ã€‚</p><p><strong>çŠ¶æ€å®šä¹‰</strong>ï¼š</p><p>æŒ‰ç…§å­—ç¬¦ä¸²ä»å·¦åˆ°å³çš„é¡ºåºï¼Œå®šä¹‰ä»¥ä¸‹ 9 ç§çŠ¶æ€ã€‚</p><ol start="0"><li>å¼€å§‹çš„ç©ºæ ¼</li><li>å¹‚ç¬¦å·å‰çš„æ­£è´Ÿå·</li><li>å°æ•°ç‚¹å‰çš„æ•°å­—</li><li>å°æ•°ç‚¹ã€å°æ•°ç‚¹åçš„æ•°å­—</li><li>å½“å°æ•°ç‚¹å‰ä¸ºç©ºæ ¼æ—¶ï¼Œå°æ•°ç‚¹ã€å°æ•°ç‚¹åçš„æ•°å­—</li><li>å¹‚ç¬¦å·</li><li>å¹‚ç¬¦å·åçš„æ­£è´Ÿå·</li><li>å¹‚ç¬¦å·åçš„æ•°å­—</li><li>ç»“å°¾çš„ç©ºæ ¼</li></ol><p><strong>ç»“æŸçŠ¶æ€ï¼š</strong></p><p>åˆæ³•çš„ç»“æŸçŠ¶æ€æœ‰ 2, 3, 7, 8 ã€‚</p><p><img src="https://pic.leetcode-cn.com/1599283151-YmPMis-Picture1.png" alt="Picture1.png"></p><p><strong>ç®—æ³•æµç¨‹ï¼š</strong></p><ol><li><strong>åˆå§‹åŒ–ï¼š</strong><ol><li>çŠ¶æ€è½¬ç§»è¡¨ states ï¼š è®¾ states[i] ï¼Œå…¶ä¸­ i ä¸ºæ‰€å¤„çŠ¶æ€ï¼Œ states[i] ä½¿ç”¨å“ˆå¸Œè¡¨å­˜å‚¨å¯è½¬ç§»è‡³çš„çŠ¶æ€ã€‚é”®å€¼å¯¹ (key, value) å«ä¹‰ï¼šè¾“å…¥å­—ç¬¦ key ï¼Œåˆ™ä»çŠ¶æ€ i è½¬ç§»è‡³çŠ¶æ€ value ã€‚</li><li>å½“å‰çŠ¶æ€ p ï¼š èµ·å§‹çŠ¶æ€åˆå§‹åŒ–ä¸º p &#x3D; 0 ã€‚</li></ol></li><li>çŠ¶æ€è½¬ç§»å¾ªç¯ï¼š éå†å­—ç¬¦ä¸² s çš„æ¯ä¸ªå­—ç¬¦ c ã€‚<ol><li>è®°å½•å­—ç¬¦ç±»å‹ t ï¼š åˆ†ä¸ºå››ç§æƒ…å†µã€‚<ul><li>å½“ c ä¸ºæ­£è´Ÿå·æ—¶ï¼Œæ‰§è¡Œ t &#x3D; â€˜sâ€™ ;</li><li>å½“ c ä¸ºæ•°å­—æ—¶ï¼Œæ‰§è¡Œ t &#x3D; â€˜dâ€™ ;</li><li>å½“ c ä¸º e æˆ– E æ—¶ï¼Œæ‰§è¡Œ t &#x3D; â€˜eâ€™ ;</li><li>å½“ c ä¸º . æˆ– ç©ºæ ¼ æ—¶ï¼Œæ‰§è¡Œ t &#x3D; c ï¼ˆå³ç”¨å­—ç¬¦æœ¬èº«è¡¨ç¤ºå­—ç¬¦ç±»å‹ï¼‰;</li><li>å¦åˆ™ï¼Œæ‰§è¡Œ t &#x3D; â€˜?â€™ ï¼Œä»£è¡¨ä¸ºä¸å±äºåˆ¤æ–­èŒƒå›´çš„éæ³•å­—ç¬¦ï¼Œåç»­ç›´æ¥è¿”å› falsefalse ã€‚</li></ul></li><li>ç»ˆæ­¢æ¡ä»¶ï¼š è‹¥å­—ç¬¦ç±»å‹ t ä¸åœ¨å“ˆå¸Œè¡¨ states[p] ä¸­ï¼Œè¯´æ˜æ— æ³•è½¬ç§»è‡³ä¸‹ä¸€çŠ¶æ€ï¼Œå› æ­¤ç›´æ¥è¿”å› false ã€‚</li><li>çŠ¶æ€è½¬ç§»ï¼š çŠ¶æ€ p è½¬ç§»è‡³ states[p] [t] ã€‚</li></ol></li><li>è¿”å›å€¼ï¼š è·³å‡ºå¾ªç¯åï¼Œè‹¥çŠ¶æ€ p \in {2, 3, 7, 8}âˆˆ2,3,7,8 ï¼Œè¯´æ˜ç»“å°¾åˆæ³•ï¼Œè¿”å› truetrue ï¼Œå¦åˆ™è¿”å› false ã€‚</li></ol><p><strong>å¤æ‚åº¦åˆ†æï¼š</strong><br>æ—¶é—´å¤æ‚åº¦ O(N) ï¼š å…¶ä¸­ N ä¸ºå­—ç¬¦ä¸² s çš„é•¿åº¦ï¼Œåˆ¤æ–­éœ€éå†å­—ç¬¦ä¸²ï¼Œæ¯è½®çŠ¶æ€è½¬ç§»çš„ä½¿ç”¨O(1) æ—¶é—´ã€‚<br>ç©ºé—´å¤æ‚åº¦ O(1) ï¼š states å’Œ p ä½¿ç”¨å¸¸æ•°å¤§å°çš„é¢å¤–ç©ºé—´ã€‚</p><p><img src="https://pic.leetcode-cn.com/1599283163-NYRJuG-Picture2.png" alt="img"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isNumber</span><span class="params">(String s)</span> &#123;</span><br><span class="line">        Map[] states = &#123;</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;() &#123;&#123; put(<span class="string">&#x27; &#x27;</span>, <span class="number">0</span>); put(<span class="string">&#x27;s&#x27;</span>, <span class="number">1</span>); put(<span class="string">&#x27;d&#x27;</span>, <span class="number">2</span>); put(<span class="string">&#x27;.&#x27;</span>, <span class="number">4</span>); &#125;&#125;, <span class="comment">// 0.</span></span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;() &#123;&#123; put(<span class="string">&#x27;d&#x27;</span>, <span class="number">2</span>); put(<span class="string">&#x27;.&#x27;</span>, <span class="number">4</span>); &#125;&#125;,                           <span class="comment">// 1.</span></span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;() &#123;&#123; put(<span class="string">&#x27;d&#x27;</span>, <span class="number">2</span>); put(<span class="string">&#x27;.&#x27;</span>, <span class="number">3</span>); put(<span class="string">&#x27;e&#x27;</span>, <span class="number">5</span>); put(<span class="string">&#x27; &#x27;</span>, <span class="number">8</span>); &#125;&#125;, <span class="comment">// 2.</span></span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;() &#123;&#123; put(<span class="string">&#x27;d&#x27;</span>, <span class="number">3</span>); put(<span class="string">&#x27;e&#x27;</span>, <span class="number">5</span>); put(<span class="string">&#x27; &#x27;</span>, <span class="number">8</span>); &#125;&#125;,              <span class="comment">// 3.</span></span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;() &#123;&#123; put(<span class="string">&#x27;d&#x27;</span>, <span class="number">3</span>); &#125;&#125;,                                        <span class="comment">// 4.</span></span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;() &#123;&#123; put(<span class="string">&#x27;s&#x27;</span>, <span class="number">6</span>); put(<span class="string">&#x27;d&#x27;</span>, <span class="number">7</span>); &#125;&#125;,                           <span class="comment">// 5.</span></span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;() &#123;&#123; put(<span class="string">&#x27;d&#x27;</span>, <span class="number">7</span>); &#125;&#125;,                                        <span class="comment">// 6.</span></span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;() &#123;&#123; put(<span class="string">&#x27;d&#x27;</span>, <span class="number">7</span>); put(<span class="string">&#x27; &#x27;</span>, <span class="number">8</span>); &#125;&#125;,                           <span class="comment">// 7.</span></span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;() &#123;&#123; put(<span class="string">&#x27; &#x27;</span>, <span class="number">8</span>); &#125;&#125;                                         <span class="comment">// 8.</span></span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">int</span> <span class="variable">p</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">char</span> t;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">char</span> c : s.toCharArray()) &#123;</span><br><span class="line">            <span class="keyword">if</span>(c &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) t = <span class="string">&#x27;d&#x27;</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(c == <span class="string">&#x27;+&#x27;</span> || c == <span class="string">&#x27;-&#x27;</span>) t = <span class="string">&#x27;s&#x27;</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(c == <span class="string">&#x27;e&#x27;</span> || c == <span class="string">&#x27;E&#x27;</span>) t = <span class="string">&#x27;e&#x27;</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(c == <span class="string">&#x27;.&#x27;</span> || c == <span class="string">&#x27; &#x27;</span>) t = c;</span><br><span class="line">            <span class="keyword">else</span> t = <span class="string">&#x27;?&#x27;</span>;</span><br><span class="line">            <span class="keyword">if</span>(!states[p].containsKey(t)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            p = (<span class="type">int</span>)states[p].get(t);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> p == <span class="number">2</span> || p == <span class="number">3</span> || p == <span class="number">7</span> || p == <span class="number">8</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åŠ¨æ€è§„åˆ’"><a href="#åŠ¨æ€è§„åˆ’" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h2><h3 id="åŠ¨æ€è§„åˆ’ç†è®º"><a href="#åŠ¨æ€è§„åˆ’ç†è®º" class="headerlink" title="åŠ¨æ€è§„åˆ’ç†è®º"></a>åŠ¨æ€è§„åˆ’ç†è®º</h3><p><strong>å†…å®¹</strong></p><ol><li>åŠ¨æ€è§„åˆ’é—®é¢˜ç‰¹ç‚¹ï¼ŒåŠ¨æ€è§„åˆ’å’Œåˆ†æ²»ç®—æ³•çš„è”ç³»ä¸åŒºåˆ«ï¼›</li><li>å€ŸåŠ©ä¾‹é¢˜ä»‹ç»é‡å å­é—®é¢˜å’Œæœ€ä¼˜å­ç»“æ„åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Œä»¥åŠåŠ¨æ€è§„åˆ’æ˜¯å¦‚ä½•è§£å†³å®ƒä»¬çš„ï¼›</li><li>åŠ¨æ€è§„åˆ’çš„è§£é¢˜æ¡†æ¶æ€»ç»“ï¼›</li><li>åŠ¨æ€è§„åˆ’çš„ç»ƒä¹ ä¾‹é¢˜ï¼Œä»æ˜“åˆ°éš¾æ’åºï¼›</li></ol><p><strong>åŠ¨æ€è§„åˆ’ç‰¹ç‚¹</strong></p><p><code>ã€Œåˆ†æ²»ã€</code>æ˜¯ç®—æ³•ä¸­çš„ä¸€ç§åŸºæœ¬æ€æƒ³ï¼Œå…¶é€šè¿‡å°†åŸé—®é¢˜åˆ†è§£ä¸ºå­é—®é¢˜ï¼Œä¸æ–­é€’å½’åœ°å°†å­é—®é¢˜åˆ†è§£ä¸ºæ›´å°çš„å­é—®é¢˜ï¼Œå¹¶é€šè¿‡<code>ç»„åˆå­é—®é¢˜çš„è§£</code>æ¥å¾—åˆ°åŸé—®é¢˜çš„è§£ã€‚</p><p>ç±»ä¼¼äºåˆ†æ²»ç®—æ³•ï¼Œ<code>ã€ŒåŠ¨æ€è§„åˆ’ã€</code>ä¹Ÿé€šè¿‡ç»„åˆå­é—®é¢˜çš„è§£å¾—åˆ°åŸé—®é¢˜çš„è§£ã€‚ä¸åŒçš„æ˜¯ï¼Œé€‚åˆç”¨åŠ¨æ€è§„åˆ’è§£å†³çš„é—®é¢˜å…·æœ‰<code>ã€Œé‡å å­é—®é¢˜ã€</code>å’Œ<code>ã€Œæœ€ä¼˜å­ç»“æ„ã€</code>ä¸¤å¤§ç‰¹æ€§ã€‚</p><p><strong>é‡å å­é—®é¢˜</strong><br>åŠ¨æ€è§„åˆ’çš„å­é—®é¢˜æ˜¯æœ‰é‡å çš„ï¼Œå³<code>å„ä¸ªå­é—®é¢˜ä¸­åŒ…å«é‡å¤çš„æ›´å°å­é—®é¢˜</code>ã€‚è‹¥ä½¿ç”¨æš´åŠ›æ³•ç©·ä¸¾ï¼Œæ±‚è§£è¿™äº›ç›¸åŒå­é—®é¢˜ä¼šäº§ç”Ÿå¤§é‡çš„é‡å¤è®¡ç®—ï¼Œæ•ˆç‡ä½ä¸‹ã€‚</p><p>åŠ¨æ€è§„åˆ’åœ¨ç¬¬ä¸€æ¬¡æ±‚è§£æŸå­é—®é¢˜æ—¶ï¼Œä¼š<code>å°†å­é—®é¢˜çš„è§£ä¿å­˜</code>ï¼›åç»­é‡åˆ°é‡å å­é—®é¢˜æ—¶ï¼Œåˆ™ç›´æ¥é€šè¿‡<code>æŸ¥è¡¨è·å–</code>è§£ï¼Œä¿è¯<code>æ¯ä¸ªç‹¬ç«‹å­é—®é¢˜åªè¢«è®¡ç®—ä¸€æ¬¡</code>ï¼Œä»è€Œé™ä½ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ã€‚</p><p><strong>æœ€ä¼˜å­ç»“æ„</strong><br>å¦‚æœä¸€ä¸ªé—®é¢˜çš„<code>æœ€ä¼˜è§£å¯ä»¥ç”±å…¶å­é—®é¢˜çš„æœ€ä¼˜è§£ç»„åˆ</code>æ„æˆï¼Œå¹¶ä¸”è¿™äº›å­é—®é¢˜å¯ä»¥ç‹¬ç«‹æ±‚è§£ï¼Œé‚£ä¹ˆç§°æ­¤é—®é¢˜å…·æœ‰æœ€ä¼˜å­ç»“æ„ã€‚</p><p>åŠ¨æ€è§„åˆ’ä»åŸºç¡€é—®é¢˜çš„è§£å¼€å§‹ï¼Œä¸æ–­è¿­ä»£<code>ç»„åˆã€é€‰æ‹©å­é—®é¢˜çš„æœ€ä¼˜è§£</code>ï¼Œæœ€ç»ˆå¾—åˆ°åŸé—®é¢˜æœ€ä¼˜è§£ã€‚</p><h3 id="é‡å å­é—®é¢˜ä¾‹é¢˜ï¼šæ–æ³¢é‚£å¥‘æ•°åˆ—"><a href="#é‡å å­é—®é¢˜ä¾‹é¢˜ï¼šæ–æ³¢é‚£å¥‘æ•°åˆ—" class="headerlink" title="é‡å å­é—®é¢˜ä¾‹é¢˜ï¼šæ–æ³¢é‚£å¥‘æ•°åˆ—"></a>é‡å å­é—®é¢˜ä¾‹é¢˜ï¼šæ–æ³¢é‚£å¥‘æ•°åˆ—</h3><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210311145007.png" alt="image-20221031114521821"></p><h4 id="æš´åŠ›é€’å½’"><a href="#æš´åŠ›é€’å½’" class="headerlink" title="æš´åŠ›é€’å½’"></a>æš´åŠ›é€’å½’</h4><p>è®¾æ–æ³¢é‚£å¥‘æ•°åˆ—ç¬¬ nn ä¸ªæ•°å­—ä¸º f(n)f(n) ã€‚æ ¹æ®æ•°åˆ—å®šä¹‰ï¼Œå¯å¾— f(n)&#x3D;f(nâˆ’1)+f(nâˆ’2) ï¼Œä¸”ç¬¬ 0 , 1 ä¸ªæ–æ³¢é‚£å¥‘æ•°åˆ†åˆ«ä¸º f(0)&#x3D;0 , f(1) &#x3D; 1ã€‚</p><p>æˆ‘ä»¬å¾ˆå®¹æ˜“è”æƒ³åˆ°ä½¿ç”¨åˆ†æ²»æ€æƒ³æ¥æ±‚å– f(n)ï¼Œå³å°†æ±‚åŸé—®é¢˜f(n) åˆ†è§£ä¸ºæ±‚å­é—®é¢˜f(nâˆ’1) å’Œf(nâˆ’2) ï¼Œå‘ä¸‹é€’å½’ç›´è‡³å·²çŸ¥çš„ f(0) å’Œ f(1) ï¼Œæœ€ç»ˆç»„åˆè¿™äº›å­é—®é¢˜æ±‚å–åŸé—®é¢˜ f(n) ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ±‚ç¬¬ n ä¸ªæ–æ³¢é‚£å¥‘æ•°</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">fibonacci</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// è¿”å› f(0)</span></span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>; <span class="comment">// è¿”å› f(1)</span></span><br><span class="line">    <span class="keyword">return</span> fibonacci(n - <span class="number">1</span>) + fibonacci(n - <span class="number">2</span>); <span class="comment">// åˆ†è§£ä¸ºä¸¤ä¸ªå­é—®é¢˜æ±‚è§£</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://pic.leetcode-cn.com/1635075778-GADtbi-Picture1.png" alt="Picture1.png"></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä¸ºæš´åŠ›é€’å½’æ±‚æ–æ³¢é‚£å¥‘æ•° f(5)å½¢æˆçš„äºŒå‰æ ‘ï¼Œæ ‘ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨ç€æ‰§è¡Œäº†ä¸€æ¬¡ fibonacci() å‡½æ•°ï¼Œä¸”æœ‰ï¼š</p><ul><li>æ‰§è¡Œä¸€æ¬¡ fibonacci() å‡½æ•°çš„æ—¶é—´å¤æ‚åº¦ä¸º O(1) ï¼›</li><li>äºŒå‰æ ‘èŠ‚ç‚¹æ•°ä¸ºæŒ‡æ•°çº§ O(2^n)</li></ul><p>å› æ­¤ï¼Œæš´åŠ›é€’å½’çš„æ€»ä½“æ—¶é—´å¤æ‚åº¦ä¸º O(2^n)æ­¤æ–¹æ³•æ•ˆç‡ä½ä¸‹ï¼Œéšç€ n çš„å¢é•¿äº§ç”ŸæŒ‡æ•°çº§çˆ†ç‚¸ã€‚</p><h4 id="è®°å¿†åŒ–é€’å½’"><a href="#è®°å¿†åŒ–é€’å½’" class="headerlink" title="è®°å¿†åŒ–é€’å½’"></a>è®°å¿†åŒ–é€’å½’</h4><p>è§‚å¯Ÿå‘ç°ï¼Œæš´åŠ›é€’å½’ä¸­çš„å­é—®é¢˜å¤šæ•°éƒ½æ˜¯<strong>é‡å å­é—®é¢˜</strong>ï¼Œå³ï¼š</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210311150060.png" alt="image-20221031115046286"></p><p>è¿™äº›é‡å å­é—®é¢˜äº§ç”Ÿäº†å¤§é‡çš„é€’å½’æ ‘èŠ‚ç‚¹ï¼Œå…¶<code>ä¸åº”è¢«é‡å¤è®¡ç®—</code>ã€‚å®é™…ä¸Šï¼Œå¯ä»¥åœ¨é€’å½’ä¸­ç¬¬ä¸€æ¬¡æ±‚è§£å­é—®é¢˜æ—¶ï¼Œå°±å°†å®ƒä»¬<code>ä¿å­˜</code>ï¼›åç»­é€’å½’ä¸­å†æ¬¡é‡åˆ°ç›¸åŒå­é—®é¢˜æ—¶ï¼Œç›´æ¥è®¿é—®å†…å­˜èµ‹å€¼å³å¯ã€‚è®°å¿†åŒ–é€’å½’çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fibonacci</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span>[] dp)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;           <span class="comment">// è¿”å› f(0)</span></span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>;           <span class="comment">// è¿”å› f(1)</span></span><br><span class="line">    <span class="keyword">if</span> (dp[n] != <span class="number">0</span>) <span class="keyword">return</span> dp[n];   <span class="comment">// è‹¥ f(n) ä»¥å‰å·²ç»è®¡ç®—è¿‡ï¼Œåˆ™ç›´æ¥è¿”å›è®°å½•çš„è§£</span></span><br><span class="line">    dp[n] = fibonacci(n - <span class="number">1</span>, dp) + fibonacci(n - <span class="number">2</span>, dp); <span class="comment">// å°† f(n) åˆ™è®°å½•è‡³ dp</span></span><br><span class="line">    <span class="keyword">return</span> dp[n];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ±‚ç¬¬ n ä¸ªæ–æ³¢é‚£å¥‘æ•°</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">fibonacciMemorized</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="type">int</span>[] dp = <span class="keyword">new</span> <span class="title class_">int</span>[n + <span class="number">1</span>]; <span class="comment">// ç”¨äºä¿å­˜ f(0) è‡³ f(n) é—®é¢˜çš„è§£</span></span><br><span class="line">    <span class="keyword">return</span> fibonacci(n, dp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåº”ç”¨è®°å¿†åŒ–é€’å½’æ–¹æ³•åï¼Œé€’å½’æ ‘ä¸­ç»å¤§éƒ¨åˆ†èŠ‚ç‚¹è¢«å‰ªæã€‚æ­¤æ—¶ï¼Œfibonacci() å‡½æ•°çš„è°ƒç”¨æ¬¡æ•°ä» O(2^n)æŒ‡æ•°çº§åˆ«é™ä½è‡³ O(n)çº¿æ€§çº§åˆ«ï¼Œæ—¶é—´å¤æ‚åº¦å¤§å¤§é™ä½ã€‚</p><p><img src="https://pic.leetcode-cn.com/1635075778-pJXkPc-Picture2.png" alt="Picture2.png"></p><h4 id="åŠ¨æ€è§„åˆ’-1"><a href="#åŠ¨æ€è§„åˆ’-1" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h4><p>é€’å½’æœ¬è´¨ä¸Šæ˜¯åŸºäºåˆ†æ²»æ€æƒ³çš„ä»é¡¶è‡³åº•çš„è§£æ³•ã€‚å€ŸåŠ©è®°å¿†åŒ–é€’å½’æ€æƒ³ï¼Œå¯åº”ç”¨åŠ¨æ€è§„åˆ’ä»åº•è‡³é¡¶æ±‚å– f(n) ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ±‚ç¬¬ n ä¸ªæ–æ³¢é‚£å¥‘æ•°</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">fibonacci</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;          <span class="comment">// è‹¥æ±‚ f(0) åˆ™ç›´æ¥è¿”å› 0</span></span><br><span class="line">    <span class="type">int</span>[] dp = <span class="keyword">new</span> <span class="title class_">int</span>[n + <span class="number">1</span>];     <span class="comment">// åˆå§‹åŒ– dp åˆ—è¡¨</span></span><br><span class="line">    dp[<span class="number">1</span>] = <span class="number">1</span>;                     <span class="comment">// åˆå§‹åŒ– f(0), f(1)</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">2</span>; i &lt;= n; i++) &#123; <span class="comment">// çŠ¶æ€è½¬ç§»æ±‚å– f(2), f(3), ..., f(n) </span></span><br><span class="line">        dp[i] = dp[i - <span class="number">1</span>] + dp[i - <span class="number">2</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[n];                  <span class="comment">// è¿”å› f(n)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸ºåŠ¨æ€è§„åˆ’æ±‚è§£ f(5)çš„è¿­ä»£æµç¨‹ï¼Œå…¶æ˜¯è½¬ç§»æ–¹ç¨‹ <code>f(n) = f(n - 1) + f(n - 2)</code>çš„ä½“ç°ã€‚</p><p><img src="https://pic.leetcode-cn.com/1635075778-EeBEoS-Picture3.png" alt="Picture3.png"></p><p>ä¸Šè¿°åŠ¨æ€è§„åˆ’è§£æ³•å€ŸåŠ©äº†ä¸€ä¸ª dp æ•°ç»„ä¿å­˜å­é—®é¢˜çš„è§£ï¼Œå…¶ç©ºé—´å¤æ‚åº¦ä¸ºO(N) ã€‚è€Œç”±äºf(n) åªä¸f(nâˆ’1) å’Œ f(nâˆ’2) æœ‰å…³ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä»…ä½¿ç”¨ä¸¤ä¸ªå˜é‡ a , b äº¤æ›¿å‰è¿›è®¡ç®—å³å¯ã€‚æ­¤æ—¶åŠ¨æ€è§„åˆ’çš„ç©ºé—´å¤æ‚åº¦é™ä½è‡³ O(1)ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ±‚ç¬¬ n ä¸ªæ–æ³¢é‚£å¥‘æ•°</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">fibonacci</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;           <span class="comment">// è‹¥æ±‚ f(0) åˆ™ç›´æ¥è¿”å› 0</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">0</span>, b = <span class="number">1</span>;               <span class="comment">// åˆå§‹åŒ– f(0), f(1)</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">2</span>; i &lt;= n; i++) &#123;  <span class="comment">// çŠ¶æ€è½¬ç§»æ±‚å– f(2), f(3), ..., f(n) </span></span><br><span class="line">        <span class="type">int</span> <span class="variable">tmp</span> <span class="operator">=</span> a;</span><br><span class="line">        a = b;</span><br><span class="line">        b = tmp + b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> b;                       <span class="comment">// è¿”å› f(n)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç¤ºä¾‹å°ç»“"><a href="#ç¤ºä¾‹å°ç»“" class="headerlink" title="ç¤ºä¾‹å°ç»“"></a>ç¤ºä¾‹å°ç»“</h4><p>è®°å¿†åŒ–é€’å½’å’ŒåŠ¨æ€è§„åˆ’çš„æœ¬è´¨æ€æƒ³æ˜¯ä¸€è‡´çš„ï¼Œæ˜¯å¯¹æ–æ³¢é‚£å¥‘æ•°åˆ—å®šä¹‰çš„ä¸åŒè¡¨ç°å½¢å¼ï¼š</p><ul><li>è®°å¿†åŒ–é€’å½’ â€” ä»é¡¶è‡³ä½ï¼š æ±‚ f(n)éœ€è¦ f(n - 1)å’Œ f(n - 2);â‹¯ ï¼›æ±‚ f(2) éœ€è¦ f(1) å’Œ f(0) ï¼›è€Œ f(1) å’Œ f(0) å·²çŸ¥ï¼›</li><li>åŠ¨æ€è§„åˆ’ â€” ä»åº•è‡³é¡¶ï¼š å°†å·²çŸ¥ f(0) å’Œf(1) ç»„åˆå¾—åˆ°f(2) ï¼›â‹¯ ï¼›å°† f(nâˆ’2) å’Œ f(nâˆ’1) ç»„åˆå¾—åˆ° (n) ï¼›</li></ul><p>æ–æ³¢é‚£å¥‘æ•°åˆ—é—®é¢˜ä¸åŒ…å«ã€Œæœ€ä¼˜å­ç»“æ„ã€ï¼Œåªéœ€è®¡ç®—æ¯ä¸ªå­é—®é¢˜çš„è§£ï¼Œé¿å…é‡å¤è®¡ç®—å³å¯ï¼Œå¹¶ä¸éœ€è¦ä»å­é—®é¢˜ç»„åˆä¸­é€‰æ‹©æœ€ä¼˜ç»„åˆã€‚æ¥ä¸‹æ¥ï¼Œæœ¬æ–‡å€ŸåŠ©ã€Œæœ€é«˜è›‹ç³•å”®ä»·æ–¹æ¡ˆã€ï¼Œä»‹ç»åŠ¨æ€è§„åˆ’çš„æœ€ä¼˜å­ç»“æ„æ¦‚å¿µã€‚</p><h3 id="æœ€ä¼˜å­ç»“æ„ä¾‹é¢˜ï¼šè›‹ç³•å”®ä»·"><a href="#æœ€ä¼˜å­ç»“æ„ä¾‹é¢˜ï¼šè›‹ç³•å”®ä»·" class="headerlink" title="æœ€ä¼˜å­ç»“æ„ä¾‹é¢˜ï¼šè›‹ç³•å”®ä»·"></a>æœ€ä¼˜å­ç»“æ„ä¾‹é¢˜ï¼šè›‹ç³•å”®ä»·</h3><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210311159196.png" alt="image-20221031115902124"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210311159705.png" alt="image-20221031115959610"></p><h4 id="æš´åŠ›é€’å½’-1"><a href="#æš´åŠ›é€’å½’-1" class="headerlink" title="æš´åŠ›é€’å½’"></a>æš´åŠ›é€’å½’</h4><p>æš´åŠ›é€’å½’è§£æ³•çš„ä»£ç å¦‚ä¸‹ï¼Œå…¶æ—¶é—´å¤æ‚åº¦ä¸ºæŒ‡æ•°çº§ O(2^nï¼‰ ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¾“å…¥è›‹ç³•ä»·æ ¼åˆ—è¡¨ priceList ï¼Œæ±‚é‡é‡ä¸º n è›‹ç³•çš„æœ€é«˜å”®ä»·</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">maxCakePrice</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span>[] priceList)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">1</span>) <span class="keyword">return</span> priceList[n]; <span class="comment">// è›‹ç³•é‡é‡ &lt;= 1 æ—¶ç›´æ¥è¿”å›</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">f_n</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++)      <span class="comment">// ä» n ç§ç»„åˆç§é€‰æ‹©æœ€é«˜å”®ä»·çš„ç»„åˆä½œä¸º f(n)</span></span><br><span class="line">        f_n = Math.max(f_n, maxCakePrice(i, priceList) + priceList[n - i]);</span><br><span class="line">    <span class="keyword">return</span> f_n;                      <span class="comment">// è¿”å› f(n)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://pic.leetcode-cn.com/1635075778-AljQEJ-Picture4.png" alt="Picture4.png"></p><h4 id="è®°å¿†åŒ–é€’å½’-1"><a href="#è®°å¿†åŒ–é€’å½’-1" class="headerlink" title="è®°å¿†åŒ–é€’å½’"></a>è®°å¿†åŒ–é€’å½’</h4><p>è§‚å¯Ÿå‘ç°ï¼Œé€’å½’æ ‘ä¸­å­˜åœ¨å¤§é‡<strong>é‡å å­é—®é¢˜</strong>ï¼Œå¯é€šè¿‡è®°å¿†åŒ–å¤„ç†é¿å…é‡å¤è®¡ç®—ã€‚è®°å¿†åŒ–é€’å½’çš„ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º O(n^2)ï¼ŒåŒ…æ‹¬ï¼š</p><ul><li>f(2) è‡³f(n) å…± nâˆ’1 ä¸ªå¾…è®¡ç®—å­é—®é¢˜ï¼Œä½¿ç”¨O(n) æ—¶é—´ï¼›</li><li>è®¡ç®—æŸf(i) éœ€éå† iâˆ’1 ç§å­é—®é¢˜ç»„åˆï¼Œä½¿ç”¨ O(n) æ—¶é—´ï¼›</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¾“å…¥è›‹ç³•ä»·æ ¼åˆ—è¡¨ priceList ï¼Œæ±‚é‡é‡ä¸º n è›‹ç³•çš„æœ€é«˜å”®ä»·</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">maxCakePrice</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span>[] priceList, <span class="type">int</span>[] dp)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">1</span>) <span class="keyword">return</span> priceList[n]; <span class="comment">// è›‹ç³•é‡é‡ &lt;= 1 æ—¶ç›´æ¥è¿”å›</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">f_n</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;    <span class="comment">// ä» n ç§ç»„åˆç§é€‰æ‹©æœ€é«˜å”®ä»·çš„ç»„åˆä½œä¸º f(n)</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">f_i</span> <span class="operator">=</span> dp[i] != <span class="number">0</span> ? dp[i] : maxCakePrice(i, priceList, dp);</span><br><span class="line">        f_n = Math.max(f_n, f_i + priceList[n - i]);</span><br><span class="line">    &#125;</span><br><span class="line">    dp[n] = f_n;                     <span class="comment">// è®°å½• f(n) è‡³ dp æ•°ç»„</span></span><br><span class="line">    <span class="keyword">return</span> f_n;                      <span class="comment">// è¿”å› f(n)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">maxCakePriceMemorized</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span>[] priceList)</span> &#123;</span><br><span class="line">    <span class="type">int</span>[] dp = <span class="keyword">new</span> <span class="title class_">int</span>[n + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span> maxCakePrice(n, priceList, dp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://pic.leetcode-cn.com/1635075778-tsDBrs-Picture5.png" alt="Picture5.png"></p><h4 id="åŠ¨æ€è§„åˆ’-2"><a href="#åŠ¨æ€è§„åˆ’-2" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h4><p>ç›¸è¾ƒäºè®°å¿†åŒ–é€’å½’çš„ä»é¡¶è‡³åº•æ–¹æ³•ï¼Œæ˜“å¾—åŠ¨æ€è§„åˆ’çš„ä»åº•è‡³é¡¶æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¾“å…¥è›‹ç³•ä»·æ ¼åˆ—è¡¨ priceList ï¼Œæ±‚é‡é‡ä¸º n è›‹ç³•çš„æœ€é«˜å”®ä»·</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">maxCakePrice</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span>[] priceList)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">1</span>) <span class="keyword">return</span> priceList[n];  <span class="comment">// è›‹ç³•é‡é‡ &lt;= 1 æ—¶ç›´æ¥è¿”å›</span></span><br><span class="line">    <span class="type">int</span>[] dp = <span class="keyword">new</span> <span class="title class_">int</span>[n + <span class="number">1</span>];        <span class="comment">// åˆå§‹åŒ– dp åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt;= n; j++) &#123;    <span class="comment">// æŒ‰é¡ºåºè®¡ç®— f(1), f(2), ..., f(n)</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; j; i++)   <span class="comment">// ä» j ç§ç»„åˆç§é€‰æ‹©æœ€é«˜å”®ä»·çš„ç»„åˆä½œä¸º f(j)</span></span><br><span class="line">            dp[j] = Math.max(dp[j], dp[i] + priceList[j - i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[n];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://pic.leetcode-cn.com/1635075778-PBtyyB-Picture6.png" alt="Picture6.png"></p><h3 id="åŠ¨æ€è§„åˆ’è§£é¢˜æ¡†æ¶"><a href="#åŠ¨æ€è§„åˆ’è§£é¢˜æ¡†æ¶" class="headerlink" title="åŠ¨æ€è§„åˆ’è§£é¢˜æ¡†æ¶"></a>åŠ¨æ€è§„åˆ’è§£é¢˜æ¡†æ¶</h3><p>è‹¥ç¡®å®šç»™å®šé—®é¢˜å…·æœ‰é‡å å­é—®é¢˜å’Œæœ€ä¼˜å­ç»“æ„ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨åŠ¨æ€è§„åˆ’æ±‚è§£ã€‚æ€»ä½“ä¸Šçœ‹ï¼Œæ±‚è§£å¯åˆ†ä¸ºå››æ­¥ï¼š</p><ol><li>çŠ¶æ€å®šä¹‰ï¼š æ„å»ºé—®é¢˜æœ€ä¼˜è§£æ¨¡å‹ï¼ŒåŒ…æ‹¬é—®é¢˜æœ€ä¼˜è§£çš„å®šä¹‰ã€æœ‰å“ªäº›è®¡ç®—è§£çš„è‡ªå˜é‡ï¼›</li><li>åˆå§‹çŠ¶æ€ï¼š ç¡®å®šåŸºç¡€å­é—®é¢˜çš„è§£ï¼ˆå³å·²çŸ¥è§£ï¼‰ï¼ŒåŸé—®é¢˜å’Œå­é—®é¢˜çš„è§£éƒ½æ˜¯ä»¥åŸºç¡€å­é—®é¢˜çš„è§£ä¸ºèµ·å§‹ç‚¹ï¼Œåœ¨è¿­ä»£è®¡ç®—ä¸­å¾—åˆ°çš„ï¼›</li><li>è½¬ç§»æ–¹ç¨‹ï¼š ç¡®å®šåŸé—®é¢˜çš„è§£ä¸å­é—®é¢˜çš„è§£ä¹‹é—´çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Œä»¥åŠä½¿ç”¨ä½•ç§é€‰æ‹©è§„åˆ™ä»å­é—®é¢˜æœ€ä¼˜è§£ç»„åˆä¸­é€‰å‡ºåŸé—®é¢˜æœ€ä¼˜è§£ï¼›</li><li>è¿”å›å€¼ï¼š ç¡®å®šåº”è¿”å›çš„é—®é¢˜çš„è§£æ˜¯ä»€ä¹ˆï¼Œå³åŠ¨æ€è§„åˆ’åœ¨ä½•å¤„åœæ­¢è¿­ä»£ï¼›</li></ol><p>å®Œæˆä»¥ä¸Šæ­¥éª¤åï¼Œä¾¿å®¹æ˜“å†™å‡ºå¯¹åº”çš„è§£é¢˜ä»£ç ã€‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202210311209375.png" alt="image-20221031120901274"></p><h3 id="å‰‘æŒ‡-Offer-10-I-æ–æ³¢é‚£å¥‘æ•°åˆ—"><a href="#å‰‘æŒ‡-Offer-10-I-æ–æ³¢é‚£å¥‘æ•°åˆ—" class="headerlink" title="å‰‘æŒ‡ Offer 10- I. æ–æ³¢é‚£å¥‘æ•°åˆ—"></a>å‰‘æŒ‡ Offer 10- I. æ–æ³¢é‚£å¥‘æ•°åˆ—</h3><p>å†™ä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥ <code>n</code> ï¼Œæ±‚æ–æ³¢é‚£å¥‘ï¼ˆFibonacciï¼‰æ•°åˆ—çš„ç¬¬ <code>n</code> é¡¹ï¼ˆå³ <code>F(N)</code>ï¼‰ã€‚æ–æ³¢é‚£å¥‘æ•°åˆ—çš„å®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">F(0) = 0,   F(1) = 1</span><br><span class="line">F(N) = F(N - 1) + F(N - 2), å…¶ä¸­ N &gt; 1.</span><br></pre></td></tr></table></figure><p>æ–æ³¢é‚£å¥‘æ•°åˆ—ç”± 0 å’Œ 1 å¼€å§‹ï¼Œä¹‹åçš„æ–æ³¢é‚£å¥‘æ•°å°±æ˜¯ç”±ä¹‹å‰çš„ä¸¤æ•°ç›¸åŠ è€Œå¾—å‡ºã€‚</p><p>ç­”æ¡ˆéœ€è¦å–æ¨¡ 1e9+7ï¼ˆ1000000007ï¼‰ï¼Œå¦‚è®¡ç®—åˆå§‹ç»“æœä¸ºï¼š1000000008ï¼Œè¯·è¿”å› 1ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šn = 2</span><br><span class="line">è¾“å‡ºï¼š1</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šn = 5</span><br><span class="line">è¾“å‡ºï¼š5</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li><code>0 &lt;= n &lt;= 100</code></li></ul><p>Related Topics</p><p>è®°å¿†åŒ–æœç´¢</p><p>æ•°å­¦</p><p>åŠ¨æ€è§„åˆ’</p><blockquote><p>ç›¸æ¯”äºä¸€èˆ¬çš„fibåŠ äº†å–ä½™æ•°çš„è¿‡ç¨‹</p></blockquote><h4 id="è®°å¿†åŒ–æœç´¢"><a href="#è®°å¿†åŒ–æœç´¢" class="headerlink" title="è®°å¿†åŒ–æœç´¢"></a>è®°å¿†åŒ–æœç´¢</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è®°å¿†åŒ–æœç´¢</span></span><br><span class="line"><span class="comment">     * */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">fib</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] dp = <span class="keyword">new</span> <span class="title class_">int</span>[n + <span class="number">1</span>];<span class="comment">//è®°å½•ä¹‹å‰æœç´¢çš„æ•°æ®</span></span><br><span class="line">        <span class="keyword">return</span> fibonacci(n, dp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">fibonacci</span><span class="params">(<span class="type">int</span> n, <span class="type">int</span>[] dp)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (dp[n] != <span class="number">0</span>) <span class="keyword">return</span> dp[n];<span class="comment">//å¦‚æœä¹‹å‰æœ‰è®°å½• ç›´æ¥è¿”å›</span></span><br><span class="line">        <span class="keyword">else</span> dp[n] = (fibonacci(n - <span class="number">1</span>, dp) + fibonacci(n - <span class="number">2</span>, dp)) % <span class="number">1000000007</span>;</span><br><span class="line">        <span class="keyword">return</span> dp[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åŠ¨æ€è§„åˆ’-3"><a href="#åŠ¨æ€è§„åˆ’-3" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h4><h3 id="å‰‘æŒ‡-Offer-19-æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…"><a href="#å‰‘æŒ‡-Offer-19-æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…" class="headerlink" title="å‰‘æŒ‡ Offer 19. æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…"></a>å‰‘æŒ‡ Offer 19. æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…</h3><p>è¯·å®ç°ä¸€ä¸ªå‡½æ•°ç”¨æ¥åŒ¹é…åŒ…å«<code>&#39;. &#39;</code>å’Œ<code>&#39;*&#39;</code>çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚æ¨¡å¼ä¸­çš„å­—ç¬¦<code>&#39;.&#39;</code>è¡¨ç¤ºä»»æ„ä¸€ä¸ªå­—ç¬¦ï¼Œè€Œ<code>&#39;*&#39;</code>è¡¨ç¤ºå®ƒå‰é¢çš„å­—ç¬¦å¯ä»¥å‡ºç°ä»»æ„æ¬¡ï¼ˆå«0æ¬¡ï¼‰ã€‚åœ¨æœ¬é¢˜ä¸­ï¼ŒåŒ¹é…æ˜¯æŒ‡å­—ç¬¦ä¸²çš„æ‰€æœ‰å­—ç¬¦åŒ¹é…æ•´ä¸ªæ¨¡å¼ã€‚ä¾‹å¦‚ï¼Œå­—ç¬¦ä¸²<code>&quot;aaa&quot;</code>ä¸æ¨¡å¼<code>&quot;a.a&quot;</code>å’Œ<code>&quot;ab*ac*a&quot;</code>åŒ¹é…ï¼Œä½†ä¸<code>&quot;aa.a&quot;</code>å’Œ<code>&quot;ab*a&quot;</code>å‡ä¸åŒ¹é…ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥:</span><br><span class="line">s = &quot;aa&quot;</span><br><span class="line">p = &quot;a&quot;</span><br><span class="line">è¾“å‡º: false</span><br><span class="line">è§£é‡Š: &quot;a&quot; æ— æ³•åŒ¹é… &quot;aa&quot; æ•´ä¸ªå­—ç¬¦ä¸²ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥:</span><br><span class="line">s = &quot;aa&quot;</span><br><span class="line">p = &quot;a*&quot;</span><br><span class="line">è¾“å‡º: true</span><br><span class="line">è§£é‡Š: å› ä¸º &#x27;*&#x27; ä»£è¡¨å¯ä»¥åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå‰é¢çš„é‚£ä¸€ä¸ªå…ƒç´ , åœ¨è¿™é‡Œå‰é¢çš„å…ƒç´ å°±æ˜¯ &#x27;a&#x27;ã€‚å› æ­¤ï¼Œå­—ç¬¦ä¸² &quot;aa&quot; å¯è¢«è§†ä¸º &#x27;a&#x27; é‡å¤äº†ä¸€æ¬¡ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥:</span><br><span class="line">s = &quot;ab&quot;</span><br><span class="line">p = &quot;.*&quot;</span><br><span class="line">è¾“å‡º: true</span><br><span class="line">è§£é‡Š: &quot;.*&quot; è¡¨ç¤ºå¯åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªï¼ˆ&#x27;*&#x27;ï¼‰ä»»æ„å­—ç¬¦ï¼ˆ&#x27;.&#x27;ï¼‰ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 4:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥:</span><br><span class="line">s = &quot;aab&quot;</span><br><span class="line">p = &quot;c*a*b&quot;</span><br><span class="line">è¾“å‡º: true</span><br><span class="line">è§£é‡Š: å› ä¸º &#x27;*&#x27; è¡¨ç¤ºé›¶ä¸ªæˆ–å¤šä¸ªï¼Œè¿™é‡Œ &#x27;c&#x27; ä¸º 0 ä¸ª, &#x27;a&#x27; è¢«é‡å¤ä¸€æ¬¡ã€‚å› æ­¤å¯ä»¥åŒ¹é…å­—ç¬¦ä¸² &quot;aab&quot;ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 5:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥:</span><br><span class="line">s = &quot;mississippi&quot;</span><br><span class="line">p = &quot;mis*is*p*.&quot;</span><br><span class="line">è¾“å‡º: false</span><br></pre></td></tr></table></figure><ul><li><code>s</code> å¯èƒ½ä¸ºç©ºï¼Œä¸”åªåŒ…å«ä» <code>a-z</code> çš„å°å†™å­—æ¯ã€‚</li><li><code>p</code> å¯èƒ½ä¸ºç©ºï¼Œä¸”åªåŒ…å«ä» <code>a-z</code> çš„å°å†™å­—æ¯ä»¥åŠå­—ç¬¦ <code>.</code> å’Œ <code>*</code>ï¼Œæ— è¿ç»­çš„ <code>&#39;*&#39;</code>ã€‚</li></ul><hr><p><strong>è§£é¢˜æ€è·¯</strong></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211011104013.png" alt="image-20221101110409896"></p><p><img src="https://pic.leetcode-cn.com/1614516402-HyzAil-Picture1.png" alt="Picture1.png"></p><p>å› æ­¤ï¼Œæœ¬é¢˜çš„çŠ¶æ€å…±æœ‰ mÃ—n ç§ï¼Œåº”å®šä¹‰çŠ¶æ€çŸ©é˜µ dp ï¼Œdp[i] [j]ä»£è¡¨ s[:i] ä¸ p[:j] æ˜¯å¦å¯ä»¥åŒ¹é…ã€‚</p><p>åšå¥½çŠ¶æ€å®šä¹‰ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ ¹æ® ã€Œæ™®é€šå­—ç¬¦ã€ , ã€Œ.ã€ , ã€Œ*ã€ä¸‰ç§å­—ç¬¦çš„åŠŸèƒ½å®šä¹‰ï¼Œåˆ†æå‡ºåŠ¨æ€è§„åˆ’çš„è½¬ç§»æ–¹ç¨‹ã€‚</p><p><strong>åŠ¨æ€è§„åˆ’è§£æï¼š</strong></p><ul><li><p><strong>çŠ¶æ€å®šä¹‰ï¼š</strong> è®¾åŠ¨æ€è§„åˆ’çŸ©é˜µ dp ï¼Œ dp[i] [j] ä»£è¡¨å­—ç¬¦ä¸² s çš„å‰ i ä¸ªå­—ç¬¦å’Œ p çš„å‰ j ä¸ªå­—ç¬¦èƒ½å¦åŒ¹é…ã€‚</p></li><li><p><strong>è½¬ç§»æ–¹ç¨‹ï¼š</strong> éœ€è¦æ³¨æ„ï¼Œç”±äº dp[0] [0] ä»£è¡¨çš„æ˜¯ç©ºå­—ç¬¦çš„çŠ¶æ€ï¼Œ å› æ­¤ dp[i] [j] å¯¹åº”çš„æ·»åŠ å­—ç¬¦æ˜¯ s[i - 1] å’Œ p[j - 1] ã€‚</p><ul><li>å½“ p[j - 1] &#x3D; â€˜*â€™ æ—¶ï¼Œ dp[i] [j] åœ¨å½“ä»¥ä¸‹ä»»ä¸€æƒ…å†µä¸º true æ—¶ç­‰äº true ï¼š<ul><li>dp[i] [j - 2]ï¼š å³å°†å­—ç¬¦ç»„åˆ p[j - 2] * çœ‹ä½œå‡ºç° 0 æ¬¡æ—¶ï¼Œèƒ½å¦åŒ¹é…ï¼›</li><li>dp[i - 1] [j] ä¸” s[i - 1] &#x3D; p[j - 2] : å³è®©å­—ç¬¦ p[j - 2] å¤šå‡ºç° 1 æ¬¡æ—¶ï¼Œèƒ½å¦åŒ¹é…ï¼›</li><li>dp[i - 1] [j] ä¸” p[j - 2] &#x3D; â€˜.â€™ : å³è®©å­—ç¬¦ â€˜.â€™ å¤šå‡ºç° 1 æ¬¡æ—¶ï¼Œèƒ½å¦åŒ¹é…ï¼›</li></ul></li><li>å½“ p[j - 1] !&#x3D; â€˜*â€™ æ—¶ï¼Œ dp[i] [j] åœ¨å½“ä»¥ä¸‹ä»»ä¸€æƒ…å†µä¸º true æ—¶ç­‰äº true ï¼š<ul><li>dp[i - 1] [j - 1] ä¸” s[i - 1] &#x3D; p[j - 1]ï¼š å³è®©å­—ç¬¦ p[j - 1] å¤šå‡ºç°ä¸€æ¬¡æ—¶ï¼Œèƒ½å¦åŒ¹é…ï¼›</li><li>dp[i - 1] [j - 1] ä¸” p[j - 1] &#x3D; â€˜.â€™ï¼š å³å°†å­—ç¬¦ . çœ‹ä½œå­—ç¬¦ s[i - 1] æ—¶ï¼Œèƒ½å¦åŒ¹é…ï¼›</li></ul></li></ul></li><li><p><strong>åˆå§‹åŒ–ï¼š</strong> éœ€è¦å…ˆåˆå§‹åŒ– dp çŸ©é˜µé¦–è¡Œï¼Œä»¥é¿å…çŠ¶æ€è½¬ç§»æ—¶ç´¢å¼•è¶Šç•Œã€‚</p><ul><li>dp[0] [0] &#x3D; trueï¼š ä»£è¡¨ä¸¤ä¸ªç©ºå­—ç¬¦ä¸²èƒ½å¤ŸåŒ¹é…ã€‚<br>dp[0] [j] &#x3D; dp[0] [j - 2] ä¸” p[j - 1] &#x3D; â€˜*â€™ï¼š é¦–è¡Œ s ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œå› æ­¤å½“ p çš„å¶æ•°ä½ä¸º * æ—¶æ‰èƒ½å¤ŸåŒ¹é…ï¼ˆå³è®© p çš„å¥‡æ•°ä½å‡ºç° 0 æ¬¡ï¼Œä¿æŒ p æ˜¯ç©ºå­—ç¬¦ä¸²ï¼‰ã€‚å› æ­¤ï¼Œå¾ªç¯éå†å­—ç¬¦ä¸² p ï¼Œæ­¥é•¿ä¸º 2ï¼ˆå³åªçœ‹å¶æ•°ä½ï¼‰ã€‚<br>è¿”å›å€¼ï¼š dp çŸ©é˜µå³ä¸‹è§’å­—ç¬¦ï¼Œä»£è¡¨å­—ç¬¦ä¸² s å’Œ p èƒ½å¦åŒ¹é…ã€‚</li></ul></li><li><p><strong>è¿”å›å€¼ï¼š</strong> <code>dp</code> çŸ©é˜µå³ä¸‹è§’å­—ç¬¦ï¼Œä»£è¡¨å­—ç¬¦ä¸² <code>s</code> å’Œ <code>p</code> èƒ½å¦åŒ¹é…ã€‚</p></li></ul><p><img src="https://pic.leetcode-cn.com/1614516402-MacqQq-Picture4.png" alt="img"></p><p><img src="https://pic.leetcode-cn.com/1614516402-ATFWBt-Picture6.png" alt="img"></p><p><img src="https://pic.leetcode-cn.com/1614516402-HHmdNJ-Picture12.png" alt="img"></p><p><img src="https://pic.leetcode-cn.com/1614516402-bBdFaG-Picture13.png" alt="img"></p><p><img src="https://pic.leetcode-cn.com/1614516402-ibjjpB-Picture18.png" alt="img"></p><p><strong>å¤æ‚åº¦åˆ†æï¼š</strong><br>æ—¶é—´å¤æ‚åº¦ O(MN)ï¼š å…¶ä¸­ M, Nåˆ†åˆ«ä¸º s å’Œ p çš„é•¿åº¦ï¼ŒçŠ¶æ€è½¬ç§»éœ€éå†æ•´ä¸ª dp çŸ©é˜µã€‚<br>ç©ºé—´å¤æ‚åº¦ O(MN)ï¼š çŠ¶æ€çŸ©é˜µ dp ä½¿ç”¨ O(MN)çš„é¢å¤–ç©ºé—´ã€‚</p><h3 id="å‰‘æŒ‡-Offer-46-æŠŠæ•°å­—ç¿»è¯‘æˆå­—ç¬¦ä¸²"><a href="#å‰‘æŒ‡-Offer-46-æŠŠæ•°å­—ç¿»è¯‘æˆå­—ç¬¦ä¸²" class="headerlink" title="å‰‘æŒ‡ Offer 46. æŠŠæ•°å­—ç¿»è¯‘æˆå­—ç¬¦ä¸²"></a>å‰‘æŒ‡ Offer 46. æŠŠæ•°å­—ç¿»è¯‘æˆå­—ç¬¦ä¸²</h3><p>ç»™å®šä¸€ä¸ªæ•°å­—ï¼Œæˆ‘ä»¬æŒ‰ç…§å¦‚ä¸‹è§„åˆ™æŠŠå®ƒç¿»è¯‘ä¸ºå­—ç¬¦ä¸²ï¼š0 ç¿»è¯‘æˆ â€œaâ€ ï¼Œ1 ç¿»è¯‘æˆ â€œbâ€ï¼Œâ€¦â€¦ï¼Œ11 ç¿»è¯‘æˆ â€œlâ€ï¼Œâ€¦â€¦ï¼Œ25 ç¿»è¯‘æˆ â€œzâ€ã€‚ä¸€ä¸ªæ•°å­—å¯èƒ½æœ‰å¤šä¸ªç¿»è¯‘ã€‚è¯·ç¼–ç¨‹å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥è®¡ç®—ä¸€ä¸ªæ•°å­—æœ‰å¤šå°‘ç§ä¸åŒçš„ç¿»è¯‘æ–¹æ³•ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: 12258</span><br><span class="line">è¾“å‡º: 5</span><br><span class="line">è§£é‡Š: 12258æœ‰5ç§ä¸åŒçš„ç¿»è¯‘ï¼Œåˆ†åˆ«æ˜¯&quot;bccfi&quot;, &quot;bwfi&quot;, &quot;bczi&quot;, &quot;mcfi&quot;å’Œ&quot;mzi&quot;</span><br></pre></td></tr></table></figure><ul><li>dp[0] [i] iä¸ªæ•°å­—å¯¹åº”æœ€å¤šçš„ç¿»è¯‘(iä¸å‚åŠ ç¿»è¯‘ï¼‰</li><li>dp[1] [i] iä¸ªæ•°å­—å¯¹åº”æœ€å¤šçš„ç¿»è¯‘(iå‚åŠ ç¿»è¯‘ï¼‰</li></ul><p><strong>æç¤ºï¼š</strong></p><ul><li><code>0 &lt;= num &lt; 231</code></li></ul><p>Related Topics</p><p>å­—ç¬¦ä¸²</p><p>åŠ¨æ€è§„åˆ’0</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211161709589.png" alt="Picture1.png"></p><ul><li>ç¡®å®šdp[i]çš„å«ä¹‰ï¼šdp[i] ä»£è¡¨ä»¥ xi ä¸ºç»“å°¾çš„æ•°å­—çš„ç¿»è¯‘æ–¹æ¡ˆæ•°é‡ã€‚</li><li>ç¡®å®šçŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸º</li></ul><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211161716249.png" alt="image-20221116171600192"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">å½“xi-1å’Œxièƒ½ä¸€èµ·ç¿»è¯‘æ—¶ï¼Œdp[i] = dp[i - 1] + dp[i - 2]ï¼›</span><br><span class="line">å› ä¸ºå¯ä»¥é€‰æ‹©xiå’Œxi-1æŒ‰é¡ºåºç¿»è¯‘dp[i-1]ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©xiå’Œxi-1ä¸€èµ·ç¿»è¯‘dp[i-2].</span><br><span class="line">å½“xi-1å’Œxiä¸èƒ½ä¸€èµ·ç¿»è¯‘æ—¶ï¼Œdp[i] = dp[i - 1]ï¼›</span><br><span class="line">å› ä¸ºåªèƒ½æŒ‰é¡ºåºç¿»è¯‘ï¼Œdp[i-1]</span><br></pre></td></tr></table></figure><ul><li>åˆå§‹åŒ–dp[0]&#x3D;1(ä¸ºäº†ç¬¬äºŒä¸ªä½ç½®å‡†å¤‡),dp[1]&#x3D;1</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">translateNum</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> num + <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> s.length();</span><br><span class="line">        <span class="comment">// dp[0] [i] ç¬¬iä¸ªæ•°å­—å¯¹åº”æœ€å¤šçš„ç¿»è¯‘</span></span><br><span class="line">        <span class="type">int</span>[] dp = <span class="keyword">new</span> <span class="title class_">int</span>[n + <span class="number">1</span>];</span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        dp[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ ¹æ®çŠ¶æ€è½¬ç§»æ–¹ç¨‹éå†</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">2</span>; i &lt; n + <span class="number">1</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s.charAt(i - <span class="number">2</span>) &lt; <span class="string">&#x27;2&#x27;</span> &amp;&amp; s.charAt(i - <span class="number">2</span>) &gt; <span class="string">&#x27;0&#x27;</span> || (s.charAt(i - <span class="number">2</span>) == <span class="string">&#x27;2&#x27;</span> &amp;&amp; s.charAt(i - <span class="number">1</span>) &lt;= <span class="string">&#x27;5&#x27;</span>)) &#123;</span><br><span class="line">                dp[i] = dp[i - <span class="number">1</span>] + dp[i - <span class="number">2</span>];</span><br><span class="line">            &#125; <span class="keyword">else</span></span><br><span class="line">                dp[i] = dp[i - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦O(N)</p><p>ç©ºé—´å¤æ‚åº¦O(N)</p><ul><li>å¯ä»¥ç”¨å¾ªç¯ä¸å˜é‡è®©æ—¶é—´å¤æ‚åº¦é™ä¸ºO(1)</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">translateNum</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">       <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> num + <span class="string">&quot;&quot;</span>;</span><br><span class="line">       <span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line">       <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">1</span>;<span class="comment">//dp[i-2]</span></span><br><span class="line">       <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">1</span>;<span class="comment">//dp[i-1]</span></span><br><span class="line"></span><br><span class="line">       <span class="comment">//æ ¹æ®çŠ¶æ€è½¬ç§»æ–¹ç¨‹éå†</span></span><br><span class="line">       <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">2</span>; i &lt; s.length() + <span class="number">1</span>; i++) &#123;</span><br><span class="line">           <span class="keyword">if</span> (s.charAt(i - <span class="number">2</span>) &lt; <span class="string">&#x27;2&#x27;</span> &amp;&amp; s.charAt(i - <span class="number">2</span>) &gt; <span class="string">&#x27;0&#x27;</span> || (s.charAt(i - <span class="number">2</span>) == <span class="string">&#x27;2&#x27;</span> &amp;&amp; s.charAt(i - <span class="number">1</span>) &lt;= <span class="string">&#x27;5&#x27;</span>)) &#123;</span><br><span class="line">               <span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> a + b;</span><br><span class="line">               a = b;</span><br><span class="line">               b = c;</span><br><span class="line">           &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">           a = b;</span><br><span class="line">           &#125; </span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> b;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><ul><li>ä¸æ˜¯ç”¨å­—ç¬¦ä¸²ï¼Œç›´æ¥ä½¿ç”¨æ•°å­—æ¥å–ä½™ï¼Œçœå»å­—ç¬¦ä¸²çš„O(N)</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">translateNum</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">1</span>;<span class="comment">//dp[i - 2]</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> <span class="number">1</span>;<span class="comment">//dp[i - 1]</span></span><br><span class="line">        <span class="type">int</span> x;<span class="comment">//</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">y</span> <span class="operator">=</span> num % <span class="number">10</span>;<span class="comment">//æœ€åä¸€ä½</span></span><br><span class="line">        <span class="keyword">while</span>(num &gt; <span class="number">9</span>) &#123;</span><br><span class="line">            num /= <span class="number">10</span>;</span><br><span class="line">            x = num % <span class="number">10</span>;<span class="comment">//å€’æ•°ç¬¬äºŒä½</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">tmp</span> <span class="operator">=</span> <span class="number">10</span> * x + y;<span class="comment">//ç®—å€¼</span></span><br><span class="line">            <span class="keyword">if</span> (tmp &gt;= <span class="number">10</span> &amp;&amp; tmp &lt;= <span class="number">25</span>) &#123;<span class="comment">//å¯ä»¥ä¸¤ä½ä¸€èµ·ç®—</span></span><br><span class="line">                <span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> a + b;</span><br><span class="line">                a = b;</span><br><span class="line">                b = c;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            a = b;</span><br><span class="line">            &#125; </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡-Offer-47-ç¤¼ç‰©çš„æœ€å¤§ä»·å€¼"><a href="#å‰‘æŒ‡-Offer-47-ç¤¼ç‰©çš„æœ€å¤§ä»·å€¼" class="headerlink" title="å‰‘æŒ‡ Offer 47. ç¤¼ç‰©çš„æœ€å¤§ä»·å€¼"></a>å‰‘æŒ‡ Offer 47. ç¤¼ç‰©çš„æœ€å¤§ä»·å€¼</h3><p>åœ¨ä¸€ä¸ª m*n çš„æ£‹ç›˜çš„æ¯ä¸€æ ¼éƒ½æ”¾æœ‰ä¸€ä¸ªç¤¼ç‰©ï¼Œæ¯ä¸ªç¤¼ç‰©éƒ½æœ‰ä¸€å®šçš„ä»·å€¼ï¼ˆä»·å€¼å¤§äº 0ï¼‰ã€‚ä½ å¯ä»¥ä»æ£‹ç›˜çš„å·¦ä¸Šè§’å¼€å§‹æ‹¿æ ¼å­é‡Œçš„ç¤¼ç‰©ï¼Œå¹¶æ¯æ¬¡å‘å³æˆ–è€…å‘ä¸‹ç§»åŠ¨ä¸€æ ¼ã€ç›´åˆ°åˆ°è¾¾æ£‹ç›˜çš„å³ä¸‹è§’ã€‚ç»™å®šä¸€ä¸ªæ£‹ç›˜åŠå…¶ä¸Šé¢çš„ç¤¼ç‰©çš„ä»·å€¼ï¼Œè¯·è®¡ç®—ä½ æœ€å¤šèƒ½æ‹¿åˆ°å¤šå°‘ä»·å€¼çš„ç¤¼ç‰©ï¼Ÿ</p><p><strong>ç¤ºä¾‹ 1:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: </span><br><span class="line">[</span><br><span class="line">  [1,3,1],</span><br><span class="line">  [1,5,1],</span><br><span class="line">  [4,2,1]</span><br><span class="line">]</span><br><span class="line">è¾“å‡º: 12</span><br><span class="line">è§£é‡Š: è·¯å¾„ 1â†’3â†’5â†’2â†’1 å¯ä»¥æ‹¿åˆ°æœ€å¤šä»·å€¼çš„ç¤¼ç‰©</span><br></pre></td></tr></table></figure><p>æç¤ºï¼š</p><ul><li><code>0 &lt; grid.length &lt;= 200</code></li><li><code>0 &lt; grid[0].length &lt;= 200</code></li></ul><p>Related Topics</p><p>æ•°ç»„</p><p>åŠ¨æ€è§„åˆ’</p><p>çŸ©é˜µ</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211161855965.png" alt="Picture1.png"></p><ul><li><p>dpæ•°ç»„çš„å«ä¹‰ï¼šç›´æ¥åœ¨åŸgrid[] []ä¸Šè¿›è¡Œä¿®æ”¹ï¼Œè¡¨ç¤ºä»èµ·åˆ°åˆ°grid[i] [j]çš„æœ€å¤§ä»·å€¼</p></li><li><p>ç¡®å®šçŠ¶æ€è½¬ç§»å…¬å¼</p><p>å¯¹äºä¸¤ä¸ªè¾¹grid[0] [j]æ˜¯ä»èµ·ç‚¹æ¥è¿›è¡Œç´¯åŠ <code>grid[0] [j] = grid[0] [j - 1] + grid[0] [j]</code>ï¼›</p><p>å’Œgrid[i] [0]æ˜¯ä»èµ·ç‚¹æ¥è¿›è¡Œç´¯åŠ <code>grid[i] [0] = grid[i - 1] [0] + grid[i] [0]</code>;</p><p>å¯¹äºå…¶ä»–çš„ä½ç½®<code>grid[i] [j] = max(grid[i - 1] [j], grid[i] [j - 1]) + grid[i] [j];</code></p></li><li><p>åˆå§‹åŒ–ï¼šä¸ç”¨åˆå§‹åŒ–</p></li><li><p>ç¡®å®šéå†é¡ºåºï¼šä¸€è¡Œä¸€è¡Œéå†å°±è¡Œï¼Œä¾èµ–çš„ä½ç½®æ˜¯ä¸Šæ–¹å’Œå·¦è¾¹ã€‚</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">maxValue</span><span class="params">(<span class="type">int</span>[][] grid)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt; grid[<span class="number">0</span>].length; j++) &#123;</span><br><span class="line">            grid[<span class="number">0</span>][j] += grid[<span class="number">0</span>][j - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; grid.length; i++) &#123;</span><br><span class="line">            grid[i][<span class="number">0</span>] += grid[i - <span class="number">1</span>][<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; grid.length; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt; grid[<span class="number">0</span>].length; j++) &#123;</span><br><span class="line">                grid[i][j] += Math.max(grid[i - <span class="number">1</span>][j], grid[i][j - <span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> grid[grid.length - <span class="number">1</span>][grid[<span class="number">0</span>].length - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦O(M*N)</p><p>ç©ºé—´å¤æ‚åº¦O(1)</p><h3 id="å‰‘æŒ‡-Offer-48-æœ€é•¿ä¸å«é‡å¤å­—ç¬¦çš„å­å­—ç¬¦ä¸²"><a href="#å‰‘æŒ‡-Offer-48-æœ€é•¿ä¸å«é‡å¤å­—ç¬¦çš„å­å­—ç¬¦ä¸²" class="headerlink" title="å‰‘æŒ‡ Offer 48. æœ€é•¿ä¸å«é‡å¤å­—ç¬¦çš„å­å­—ç¬¦ä¸²"></a>å‰‘æŒ‡ Offer 48. æœ€é•¿ä¸å«é‡å¤å­—ç¬¦çš„å­å­—ç¬¦ä¸²</h3><p>è¯·ä»å­—ç¬¦ä¸²ä¸­æ‰¾å‡ºä¸€ä¸ªæœ€é•¿çš„ä¸åŒ…å«é‡å¤å­—ç¬¦çš„å­å­—ç¬¦ä¸²ï¼Œè®¡ç®—è¯¥æœ€é•¿å­å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: &quot;abcabcbb&quot;</span><br><span class="line">è¾“å‡º: 3 </span><br><span class="line">è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ &quot;abc&quot;ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 3ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: &quot;bbbbb&quot;</span><br><span class="line">è¾“å‡º: 1</span><br><span class="line">è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ &quot;b&quot;ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 1ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: &quot;pwwkew&quot;</span><br><span class="line">è¾“å‡º: 3</span><br><span class="line">è§£é‡Š: å› ä¸ºæ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²æ˜¯ &quot;wke&quot;ï¼Œæ‰€ä»¥å…¶é•¿åº¦ä¸º 3ã€‚</span><br><span class="line">     è¯·æ³¨æ„ï¼Œä½ çš„ç­”æ¡ˆå¿…é¡»æ˜¯ å­ä¸² çš„é•¿åº¦ï¼Œ&quot;pwke&quot; æ˜¯ä¸€ä¸ªå­åºåˆ—ï¼Œä¸æ˜¯å­ä¸²ã€‚</span><br></pre></td></tr></table></figure><p>æç¤ºï¼š</p><ul><li><code>s.length &lt;= 40000</code></li></ul><p>Related Topics</p><p>å“ˆå¸Œè¡¨</p><p>å­—ç¬¦ä¸²</p><p>æ»‘åŠ¨çª—å£</p><p><strong>è§£é¢˜æ€è·¯</strong>ï¼š</p><hr><p><strong>ç¡®å®šdpæ•°ç»„çš„å«ä¹‰</strong>ï¼šdp[i]è¡¨ç¤ºä»¥s[i]ç»“å°¾çš„æœ€é•¿ä¸é‡å¤å­—ç¬¦çš„å­—ç¬¦ä¸²é•¿åº¦ã€‚</p><p><strong>ç¡®å®šé€’æ¨å…¬å¼</strong>ï¼š</p><p>ç”¨ä¸€ä¸ªå“ˆå¸Œè¡¨è®°å½•ä¸Šä¸€ä¸ªå­—ç¬¦å¯¹åº”çš„ä¸‹æ ‡ä½ç½®ï¼Œä¹‹åå¦‚æœå†é‡åˆ°è¯¥å­—ç¬¦å°±æ›´æ–°ä¸‹æ ‡ã€‚</p><p>å½“mapæ²¡æœ‰è¯¥å­—ç¬¦çš„è®°å½•æ—¶ï¼ˆè¯¥å­—ç¬¦ç¬¬ä¸€æ¬¡å‡ºç°ï¼‰<code>dp[i] = dp[i - 1] + 1;</code></p><p>å½“mapä¸­æœ‰è¯¥è®°å½•ï¼Œé‚£ä¹ˆæœ‰ä¸¤ç§å¯èƒ½:</p><ul><li>ä¸¤ä¸ªå­—ç¬¦é—´çš„å­—ç¬¦ä¸²æ²¡æœ‰å‡ºç°é‡å¤<code>dp[i] = i - index;</code></li><li>å­—ç¬¦é—´çš„å­—ç¬¦å­˜åœ¨é‡å¤<code>dp[i] = dp[i - 1] + 1;</code></li></ul><p>ä¸¤è€…å–æœ€å°å€¼ï¼Œæ•…<code>dp[i] = Math.min(i - index, dp[i - 1] + 1);</code></p><hr><p>çŠ¶æ€è½¬ç§»çš„ä¼˜åŒ–ï¼Œåˆ©ç”¨i - indexæ¥å’Œdp[j-i]åˆ¤æ–­ï¼Œmapè®°å½•å­—ç¬¦çš„å‰ä¸€ä¸ªä¸‹æ ‡ä½ç½®ã€‚è¿™æ ·å¯ä»¥åˆå¹¶çŠ¶æ€è½¬ç§»æ–¹ç¨‹ã€‚ã€</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211170935479.png" alt="image-20221117093534354"></p><p><strong>åˆå§‹åŒ–</strong>ï¼š</p><p>å› ä¸ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹ç”¨åˆ°äº†dp[i - 1]æ‰€ä»¥å¯¹dp[0]è¿›è¡Œåˆå§‹åŒ–ï¼Œdp[0]è¡¨ç¤ºç¬¬ä¸€ä¸ªå­—ç¬¦çš„æœ€é•¿ä¸å«é‡å¤å­—ç¬¦çš„é•¿åº¦ï¼Œæ•…ä¸º1ã€‚å¹¶æŠŠä¸‹æ ‡åŠ å…¥mapä¸­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">lengthOfLongestSubstring</span><span class="params">(String s)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (Objects.equals(s, <span class="string">&quot;&quot;</span>) || s == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//dp[i]è¡¨ç¤ºä»¥s[i]ç»“å°¾çš„æœ€é•¿ä¸é‡å¤å­—ç¬¦çš„å­—ç¬¦ä¸²é•¿åº¦</span></span><br><span class="line">    <span class="type">int</span>[] dp = <span class="keyword">new</span> <span class="title class_">int</span>[s.length()];</span><br><span class="line">    HashMap&lt;Character, Integer&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    dp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    map.put(s.charAt(<span class="number">0</span>), <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; s.length(); i++) &#123;</span><br><span class="line">        <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> s.charAt(i);</span><br><span class="line">        <span class="keyword">if</span> (map.getOrDefault(c, -<span class="number">1</span>) == -<span class="number">1</span>) &#123; <span class="comment">//è¡¨ä¸­æ²¡å­˜è®°å½•</span></span><br><span class="line">            dp[i] = dp[i - <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// åœ¨è¡¨ä¸­æœ‰è®°å½•</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> map.get(c);<span class="comment">//æ‹¿åˆ°ä»–çš„ä½ç½®</span></span><br><span class="line">            dp[i] = Math.min(i - index, dp[i - <span class="number">1</span>] + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        map.put(c, i);<span class="comment">// å­˜å…¥map or ç†è§£ä¸ºæ›´æ–°mapçš„å€¼</span></span><br><span class="line">        res = Math.max(dp[i], res);<span class="comment">// reså–æœ€å¤§å€¼</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ—¶é—´å¤æ‚åº¦ï¼šO(N)</p><p>ç©ºé—´å¤æ‚åº¦ï¼šO(N)</p><p>ç©ºé—´ä¸Šçš„ä¼˜åŒ–ï¼Œåˆ©ç”¨ä¸´æ—¶å˜é‡tmpè®°å½•ï¼Œæ¯ä¸ªè¿‡ç¨‹åªæ›´æ–°æœ€å¤§çš„å€¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">lengthOfLongestSubstring</span><span class="params">(String s)</span> &#123;</span><br><span class="line">        Map&lt;Character, Integer&gt; dic = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">0</span>, tmp = <span class="number">0</span>, len = s.length();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; len; j++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> dic.getOrDefault(s.charAt(j), -<span class="number">1</span>); <span class="comment">// è·å–ç´¢å¼• i</span></span><br><span class="line">            dic.put(s.charAt(j), j); <span class="comment">// æ›´æ–°å“ˆå¸Œè¡¨</span></span><br><span class="line">            tmp = tmp &lt; j - i ? tmp + <span class="number">1</span> : j - i; <span class="comment">// dp[j - 1] -&gt; dp[j]</span></span><br><span class="line">            res = Math.max(res, tmp); <span class="comment">// max(dp[j - 1], dp[j])</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡-Offer-49-ä¸‘æ•°"><a href="#å‰‘æŒ‡-Offer-49-ä¸‘æ•°" class="headerlink" title="å‰‘æŒ‡ Offer 49. ä¸‘æ•°"></a>å‰‘æŒ‡ Offer 49. ä¸‘æ•°</h3><p>æˆ‘ä»¬æŠŠåªåŒ…å«è´¨å› å­ 2ã€3 å’Œ 5 çš„æ•°ç§°ä½œä¸‘æ•°ï¼ˆUgly Numberï¼‰ã€‚æ±‚æŒ‰ä»å°åˆ°å¤§çš„é¡ºåºçš„ç¬¬ n ä¸ªä¸‘æ•°ã€‚</p><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: n = 10</span><br><span class="line">è¾“å‡º: 12</span><br><span class="line">è§£é‡Š: 1, 2, 3, 4, 5, 6, 8, 9, 10, 12 æ˜¯å‰ 10 ä¸ªä¸‘æ•°ã€‚</span><br></pre></td></tr></table></figure><p><strong>è¯´æ˜:</strong></p><ol><li><code>1</code> æ˜¯ä¸‘æ•°ã€‚</li><li><code>n</code> <strong>ä¸è¶…è¿‡</strong>1690ã€‚</li></ol><p>æ³¨æ„ï¼šæœ¬é¢˜ä¸ä¸»ç«™ 264 é¢˜ç›¸åŒï¼š<a href="https://leetcode-cn.com/problems/ugly-number-ii/">https://leetcode-cn.com/problems/ugly-number-ii/</a></p><p>Related Topics</p><p>å“ˆå¸Œè¡¨</p><p>æ•°å­¦</p><p>åŠ¨æ€è§„åˆ’</p><p>å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong></p><blockquote><p>ä¸‘æ•°çš„é€’æ¨æ€§è´¨ï¼š ä¸‘æ•°åªåŒ…å«å› å­ 2, 3, 5 ï¼Œå› æ­¤æœ‰ â€œä¸‘æ•° &#x3D;&#x3D; æŸè¾ƒå°ä¸‘æ•° \timesÃ— æŸå› å­â€ ï¼ˆä¾‹å¦‚10&#x3D;5Ã—2ï¼‰ã€‚</p></blockquote><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211170958398.png" alt="image-20221117095848322"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211170959923.png" alt="Picture1.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xaæ˜¯ç¬¬ä¸€ä¸ªÃ—2å¤§äºxnçš„ä¸‘æ•°</span><br><span class="line">xbæ˜¯ç¬¬ä¸€ä¸ªÃ—3å¤§äºxnçš„ä¸‘æ•°</span><br><span class="line">xcæ˜¯ç¬¬ä¸€ä¸ªÃ—5å¤§äºxnçš„ä¸‘æ•°</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211171001480.png" alt="image-20221117100102405"></p><p><strong>å¤æ‚åº¦åˆ†æï¼š</strong></p><ul><li>æ—¶é—´å¤æ‚åº¦ O(N)O(N) ï¼š å…¶ä¸­N&#x3D;n ï¼ŒåŠ¨æ€è§„åˆ’éœ€éå†è®¡ç®— dp åˆ—è¡¨ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ O(N)O(N) ï¼š é•¿åº¦ä¸ºN çš„dp åˆ—è¡¨ä½¿ç”¨ O(N) çš„é¢å¤–ç©ºé—´ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">nthUglyNumber</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">0</span>, b = <span class="number">0</span>, c = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span>[] dp = <span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line">    dp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n2</span> <span class="operator">=</span> dp[a] * <span class="number">2</span>, n3 = dp[b] * <span class="number">3</span>, n5 = dp[c] * <span class="number">5</span>;</span><br><span class="line">        dp[i] = Math.min(Math.min(n2, n3), n5);</span><br><span class="line">        <span class="keyword">if</span> (dp[i] == n2) a++;</span><br><span class="line">        <span class="keyword">if</span> (dp[i] == n3) b++;</span><br><span class="line">        <span class="keyword">if</span> (dp[i] == n5) c++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[n - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡-Offer-60-n-ä¸ªéª°å­çš„ç‚¹æ•°"><a href="#å‰‘æŒ‡-Offer-60-n-ä¸ªéª°å­çš„ç‚¹æ•°" class="headerlink" title="å‰‘æŒ‡ Offer 60. n ä¸ªéª°å­çš„ç‚¹æ•°"></a>å‰‘æŒ‡ Offer 60. n ä¸ªéª°å­çš„ç‚¹æ•°</h3><p>æŠŠnä¸ªéª°å­æ‰”åœ¨åœ°ä¸Šï¼Œæ‰€æœ‰éª°å­æœä¸Šä¸€é¢çš„ç‚¹æ•°ä¹‹å’Œä¸ºsã€‚è¾“å…¥nï¼Œæ‰“å°å‡ºsçš„æ‰€æœ‰å¯èƒ½çš„å€¼å‡ºç°çš„æ¦‚ç‡ã€‚</p><p>ä½ éœ€è¦ç”¨ä¸€ä¸ªæµ®ç‚¹æ•°æ•°ç»„è¿”å›ç­”æ¡ˆï¼Œå…¶ä¸­ç¬¬ i ä¸ªå…ƒç´ ä»£è¡¨è¿™ n ä¸ªéª°å­æ‰€èƒ½æ·å‡ºçš„ç‚¹æ•°é›†åˆä¸­ç¬¬ i å°çš„é‚£ä¸ªçš„æ¦‚ç‡ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: 1</span><br><span class="line">è¾“å‡º: [0.16667,0.16667,0.16667,0.16667,0.16667,0.16667]</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: 2</span><br><span class="line">è¾“å‡º: [0.02778,0.05556,0.08333,0.11111,0.13889,0.16667,0.13889,0.11111,0.08333,0.05556,0.02778]</span><br></pre></td></tr></table></figure><p><strong>é™åˆ¶ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 &lt;= n &lt;= 11</span><br></pre></td></tr></table></figure><p>Related Topics</p><p>æ•°å­¦</p><p>åŠ¨æ€è§„åˆ’</p><p>æ¦‚ç‡ä¸ç»Ÿè®¡</p><p>ğŸ‘ 496</p><p>ğŸ‘ 0</p><h4 id="æš´åŠ›æ³•"><a href="#æš´åŠ›æ³•" class="headerlink" title="æš´åŠ›æ³•"></a>æš´åŠ›æ³•</h4><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211181001768.png" alt="image-20221118100112673"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211181001882.png" alt="Picture1.png"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211181001271.png" alt="image-20221118100149197"></p><h4 id="åŠ¨æ€è§„åˆ’-4"><a href="#åŠ¨æ€è§„åˆ’-4" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h4><blockquote><p>è®¾è¾“å…¥ n ä¸ªéª°å­çš„è§£ï¼ˆå³æ¦‚ç‡åˆ—è¡¨ï¼‰ä¸º f(n) ï¼Œå…¶ä¸­ã€Œç‚¹æ•°å’Œã€ xçš„æ¦‚ç‡ä¸º f(n, x) ã€‚</p></blockquote><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211181004718.png" alt="image-20221118100410639"></p><blockquote><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸º n &#x3D; 2, x &#x3D; 7çš„é€’æ¨è®¡ç®—ç¤ºä¾‹ã€‚</p></blockquote><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211181018233.png" alt="Picture2.png"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211181023640.png" alt="image-20221118102304571"></p><blockquote><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä»¥ä¸Šé€’æ¨å…¬å¼æ˜¯ â€œé€†å‘â€ çš„ï¼Œå³ä¸ºäº†è®¡ç®—f(n,x) ï¼Œå°†æ‰€æœ‰ä¸ä¹‹æœ‰å…³çš„æƒ…å†µæ±‚å’Œï¼›è€Œå€˜è‹¥æ”¹æ¢ä¸º â€œæ­£å‘â€ çš„é€’æ¨å…¬å¼ï¼Œä¾¿å¯è§£å†³è¶Šç•Œé—®é¢˜ã€‚</p></blockquote><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211181025269.png" alt="Picture3.png"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211181027924.png" alt="image-20221118102715860"></p><blockquote><p>å°† f(i) è®°ä¸ºåŠ¨æ€è§„åˆ’åˆ—è¡¨å½¢å¼ dp[i]ï¼Œåˆ™ i &#x3D; 1, 2, â€¦, n çš„çŠ¶æ€è½¬ç§»è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p></blockquote><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211181028153.png" alt="img"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211181029199.png" alt="image-20221118102956132"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">double</span>[] dicesProbability(<span class="type">int</span> n) &#123;</span><br><span class="line">    <span class="type">double</span>[] dp = <span class="keyword">new</span> <span class="title class_">double</span>[<span class="number">6</span>];</span><br><span class="line">    Arrays.fill(dp, <span class="number">1.0</span> / <span class="number">6.0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">2</span>; i &lt;= n; i++) &#123; <span class="comment">//éå†æ¬¡æ•°</span></span><br><span class="line">        <span class="type">double</span>[] tmp = <span class="keyword">new</span> <span class="title class_">double</span>[<span class="number">5</span> * i + <span class="number">1</span>];<span class="comment">// 6 * n - n + 1</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; dp.length; j++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">0</span>; k &lt; <span class="number">6</span>; k++) &#123;</span><br><span class="line">                tmp[j + k] += dp[j] / <span class="number">6.0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        dp = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡-Offer-63-è‚¡ç¥¨çš„æœ€å¤§åˆ©æ¶¦"><a href="#å‰‘æŒ‡-Offer-63-è‚¡ç¥¨çš„æœ€å¤§åˆ©æ¶¦" class="headerlink" title="å‰‘æŒ‡ Offer 63. è‚¡ç¥¨çš„æœ€å¤§åˆ©æ¶¦"></a>å‰‘æŒ‡ Offer 63. è‚¡ç¥¨çš„æœ€å¤§åˆ©æ¶¦</h3><p>å‡è®¾æŠŠæŸè‚¡ç¥¨çš„ä»·æ ¼æŒ‰ç…§æ—¶é—´å…ˆåé¡ºåºå­˜å‚¨åœ¨æ•°ç»„ä¸­ï¼Œè¯·é—®ä¹°å–è¯¥è‚¡ç¥¨ä¸€æ¬¡å¯èƒ½è·å¾—çš„æœ€å¤§åˆ©æ¶¦æ˜¯å¤šå°‘ï¼Ÿ</p><p><strong>ç¤ºä¾‹ 1:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: [7,1,5,3,6,4]</span><br><span class="line">è¾“å‡º: 5</span><br><span class="line">è§£é‡Š: åœ¨ç¬¬ 2 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 1ï¼‰çš„æ—¶å€™ä¹°å…¥ï¼Œåœ¨ç¬¬ 5 å¤©ï¼ˆè‚¡ç¥¨ä»·æ ¼ = 6ï¼‰çš„æ—¶å€™å–å‡ºï¼Œæœ€å¤§åˆ©æ¶¦ = 6-1 = 5 ã€‚</span><br><span class="line">     æ³¨æ„åˆ©æ¶¦ä¸èƒ½æ˜¯ 7-1 = 6, å› ä¸ºå–å‡ºä»·æ ¼éœ€è¦å¤§äºä¹°å…¥ä»·æ ¼ã€‚</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: [7,6,4,3,1]</span><br><span class="line">è¾“å‡º: 0</span><br><span class="line">è§£é‡Š: åœ¨è¿™ç§æƒ…å†µä¸‹, æ²¡æœ‰äº¤æ˜“å®Œæˆ, æ‰€ä»¥æœ€å¤§åˆ©æ¶¦ä¸º 0ã€‚</span><br></pre></td></tr></table></figure><p><strong>é™åˆ¶ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 &lt;= æ•°ç»„é•¿åº¦ &lt;= 10^5</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong>æœ¬é¢˜ä¸ä¸»ç«™ 121 é¢˜ç›¸åŒï¼š<a href="https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock/">https://leetcode-cn.com/problems/best-time-to-buy-and-sell-stock/</a></p><p>Related Topics</p><p>æ•°ç»„</p><p>åŠ¨æ€è§„åˆ’</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong></p><ol><li><p>ç¡®å®šdpæ•°ç»„</p><p>dp[i] [0]:è¡¨ç¤ºç¬¬iå¤©ä¸æŒæœ‰è‚¡ç¥¨çš„æœ€å¤§æ”¶ç›Š</p><p>dp[i] [1]:è¡¨ç¤ºç¬¬iå¤©æŒæœ‰è‚¡ç¥¨çš„æœ€å¤§æ”¶ç›Š</p></li><li><p>ç¡®å®šçŠ¶æ€è½¬ç§»æ–¹ç¨‹</p><p>ç¬¬iå¤©ä¸æŒæœ‰è‚¡ç¥¨ï¼Œè¯´æ˜ä»–åœ¨ç¬¬iå¤©ä¹°äº†ï¼Œæˆ–è€…åœ¨ä¹‹å‰çš„å¤©ä¹°è¿‡ã€‚å¦‚æœä¹‹å‰çš„å¤©æ•°ä¹°è¿‡ï¼Œé‚£ä¹ˆ<code>dp[i] [0] = dp[i - 1] [0]</code>ã€‚å¦‚æœç¬¬iå¤©æ‰ä¹°è‚¡ç¥¨ï¼Œ<code>dp[i] [0] = dp[i - 1] [1] + prices[i]</code>ã€‚</p><p>æ•…çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸º<code>dp[i] [0] = max(dp[i - 1] [0], dp[i - 1] [1] + prices[i])</code></p><p>ç¬¬iå¤©æŒæœ‰è‚¡ç¥¨çš„è¯ï¼Œè¯´æ˜ä»–åœ¨ä¹‹å‰ä¹°äº†è‚¡ç¥¨æ²¡å–ï¼Œæˆ–è€…ä»Šå¤©æ‰ä¹°è‚¡ç¥¨ã€‚<code>dp[i] [1] = dp[i - 1] [1];</code></p></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">maxProfit</span><span class="params">(<span class="type">int</span>[] prices)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (prices.length == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//dp[i] [0]:è¡¨ç¤ºç¬¬iå¤©ä¸æŒæœ‰è‚¡ç¥¨çš„æœ€å¤§æ”¶ç›Š</span></span><br><span class="line">    <span class="comment">//dp[i] [1]:è¡¨ç¤ºç¬¬iå¤©æŒæœ‰è‚¡ç¥¨çš„æœ€å¤§æ”¶ç›Š</span></span><br><span class="line">    <span class="type">int</span>[][] dp = <span class="keyword">new</span> <span class="title class_">int</span>[prices.length][<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–</span></span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">1</span>] = -prices[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; prices.length; i++) &#123;</span><br><span class="line">        dp[i] [<span class="number">0</span>] = Math.max(dp[i - <span class="number">1</span>] [<span class="number">0</span>], dp[i - <span class="number">1</span>] [<span class="number">1</span>] + prices[i]);</span><br><span class="line">        dp[i] [<span class="number">1</span>] = Math.max(dp[i - <span class="number">1</span>][<span class="number">1</span>], -prices[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> dp[prices.length - <span class="number">1</span>][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¦ä¸€ç§è§£æ³•ï¼š</strong></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211181056360.png" alt="image-20221118105652244"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211181057095.png" alt="Picture1.png"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211181100550.png" alt="image-20221118110003462"></p><p><strong>ä¼˜åŒ–ç©ºé—´ä¸ºO(1)</strong></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211181100800.png" alt="img"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">maxProfit</span><span class="params">(<span class="type">int</span>[] prices)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">cost</span> <span class="operator">=</span> Integer.MAX_VALUE, profit = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> price : prices) &#123;</span><br><span class="line">            cost = Math.min(cost, price);</span><br><span class="line">            profit = Math.max(profit, price - cost);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> profit;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æœç´¢ä¸å›æº¯ç®—æ³•"><a href="#æœç´¢ä¸å›æº¯ç®—æ³•" class="headerlink" title="æœç´¢ä¸å›æº¯ç®—æ³•"></a>æœç´¢ä¸å›æº¯ç®—æ³•</h2><h3 id="å‰‘æŒ‡-Offer-12-çŸ©é˜µä¸­çš„è·¯å¾„"><a href="#å‰‘æŒ‡-Offer-12-çŸ©é˜µä¸­çš„è·¯å¾„" class="headerlink" title="å‰‘æŒ‡ Offer 12. çŸ©é˜µä¸­çš„è·¯å¾„"></a>å‰‘æŒ‡ Offer 12. çŸ©é˜µä¸­çš„è·¯å¾„</h3><p>ç»™å®šä¸€ä¸ª <code>m x n</code> äºŒç»´å­—ç¬¦ç½‘æ ¼ <code>board</code> å’Œä¸€ä¸ªå­—ç¬¦ä¸²å•è¯ <code>word</code> ã€‚å¦‚æœ <code>word</code> å­˜åœ¨äºç½‘æ ¼ä¸­ï¼Œè¿”å› <code>true</code> ï¼›å¦åˆ™ï¼Œè¿”å› <code>false</code> ã€‚</p><p>å•è¯å¿…é¡»æŒ‰ç…§å­—æ¯é¡ºåºï¼Œé€šè¿‡ç›¸é‚»çš„å•å…ƒæ ¼å†…çš„å­—æ¯æ„æˆï¼Œå…¶ä¸­â€œç›¸é‚»â€å•å…ƒæ ¼æ˜¯é‚£äº›æ°´å¹³ç›¸é‚»æˆ–å‚ç›´ç›¸é‚»çš„å•å…ƒæ ¼ã€‚åŒä¸€ä¸ªå•å…ƒæ ¼å†…çš„å­—æ¯ä¸å…è®¸è¢«é‡å¤ä½¿ç”¨ã€‚</p><p>ä¾‹å¦‚ï¼Œåœ¨ä¸‹é¢çš„ 3Ã—4 çš„çŸ©é˜µä¸­åŒ…å«å•è¯ â€œABCCEDâ€ï¼ˆå•è¯ä¸­çš„å­—æ¯å·²æ ‡å‡ºï¼‰ã€‚</p><p><img src="https://assets.leetcode.com/uploads/2020/11/04/word2.jpg" alt="img"></p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šboard = [[&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;E&quot;],[&quot;S&quot;,&quot;F&quot;,&quot;C&quot;,&quot;S&quot;],[&quot;A&quot;,&quot;D&quot;,&quot;E&quot;,&quot;E&quot;]], word = &quot;ABCCED&quot;</span><br><span class="line">è¾“å‡ºï¼štrue</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šboard = [[&quot;a&quot;,&quot;b&quot;],[&quot;c&quot;,&quot;d&quot;]], word = &quot;abcd&quot;</span><br><span class="line">è¾“å‡ºï¼šfalse</span><br></pre></td></tr></table></figure><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>æœ¬é—®é¢˜æ˜¯å…¸å‹çš„çŸ©é˜µæœç´¢é—®é¢˜ï¼Œå¯ä½¿ç”¨ æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰+ å‰ªæ è§£å†³ã€‚</p><ul><li><strong>æ·±åº¦ä¼˜å…ˆæœç´¢ï¼š</strong> å¯ä»¥ç†è§£ä¸ºæš´åŠ›æ³•éå†çŸ©é˜µä¸­æ‰€æœ‰å­—ç¬¦ä¸²å¯èƒ½æ€§ã€‚DFS é€šè¿‡é€’å½’ï¼Œå…ˆæœä¸€ä¸ªæ–¹å‘æœåˆ°åº•ï¼Œå†å›æº¯è‡³ä¸Šä¸ªèŠ‚ç‚¹ï¼Œæ²¿å¦ä¸€ä¸ªæ–¹å‘æœç´¢ï¼Œä»¥æ­¤ç±»æ¨ã€‚</li><li><strong>å‰ªæï¼š</strong> åœ¨æœç´¢ä¸­ï¼Œé‡åˆ° è¿™æ¡è·¯ä¸å¯èƒ½å’Œç›®æ ‡å­—ç¬¦ä¸²åŒ¹é…æˆåŠŸ çš„æƒ…å†µï¼ˆä¾‹å¦‚ï¼šæ­¤çŸ©é˜µå…ƒç´ å’Œç›®æ ‡å­—ç¬¦ä¸åŒã€æ­¤å…ƒç´ å·²è¢«è®¿é—®ï¼‰ï¼Œåˆ™åº”ç«‹å³è¿”å›ï¼Œç§°ä¹‹ä¸º å¯è¡Œæ€§å‰ªæ ã€‚</li></ul><p><strong>DFS è§£æï¼š</strong></p><ul><li>é€’å½’å‚æ•°ï¼š å½“å‰å…ƒç´ åœ¨çŸ©é˜µ board ä¸­çš„è¡Œåˆ—ç´¢å¼• i å’Œ j ï¼Œå½“å‰ç›®æ ‡å­—ç¬¦åœ¨ word ä¸­çš„ç´¢å¼• k ã€‚</li><li>ç»ˆæ­¢æ¡ä»¶ï¼š<ol><li>è¿”å› falseï¼š (1) è¡Œæˆ–åˆ—ç´¢å¼•è¶Šç•Œ æˆ– (2) å½“å‰çŸ©é˜µå…ƒç´ ä¸ç›®æ ‡å­—ç¬¦ä¸åŒ æˆ– (3) å½“å‰çŸ©é˜µå…ƒç´ å·²è®¿é—®è¿‡ ï¼ˆ (3) å¯åˆå¹¶è‡³ (2) ï¼‰ ã€‚</li><li>è¿”å› true ï¼š k &#x3D; len(word) - 1 ï¼Œå³å­—ç¬¦ä¸² word å·²å…¨éƒ¨åŒ¹é…ã€‚</li></ol></li><li>é€’æ¨å·¥ä½œï¼š<ol><li>æ ‡è®°å½“å‰çŸ©é˜µå…ƒç´ ï¼š å°† board[i] [j] ä¿®æ”¹ä¸º ç©ºå­—ç¬¦ â€˜ â€˜ï¼Œä»£è¡¨æ­¤å…ƒç´ å·²è®¿é—®è¿‡ï¼Œé˜²æ­¢ä¹‹åæœç´¢æ—¶é‡å¤è®¿é—®ã€‚</li><li>æœç´¢ä¸‹ä¸€å•å…ƒæ ¼ï¼š æœå½“å‰å…ƒç´ çš„ ä¸Šã€ä¸‹ã€å·¦ã€å³ å››ä¸ªæ–¹å‘å¼€å¯ä¸‹å±‚é€’å½’ï¼Œä½¿ç”¨ æˆ– è¿æ¥ ï¼ˆä»£è¡¨åªéœ€æ‰¾åˆ°ä¸€æ¡å¯è¡Œè·¯å¾„å°±ç›´æ¥è¿”å›ï¼Œä¸å†åšåç»­ DFS ï¼‰ï¼Œå¹¶è®°å½•ç»“æœè‡³ res ã€‚</li><li>è¿˜åŸå½“å‰çŸ©é˜µå…ƒç´ ï¼š å°† board[i] [j] å…ƒç´ è¿˜åŸè‡³åˆå§‹å€¼ï¼Œå³ word[k] ã€‚</li></ol></li><li>è¿”å›å€¼ï¼š è¿”å›å¸ƒå°”é‡ res ï¼Œä»£è¡¨æ˜¯å¦æœç´¢åˆ°ç›®æ ‡å­—ç¬¦ä¸²ã€‚</li></ul><p><strong>å¤æ‚åº¦åˆ†æï¼š</strong><br>M,N åˆ†åˆ«ä¸ºçŸ©é˜µè¡Œåˆ—å¤§å°ï¼Œ K ä¸ºå­—ç¬¦ä¸² word é•¿åº¦ã€‚</p><ul><li>æ—¶é—´å¤æ‚åº¦ O(3^KMN)ï¼š æœ€å·®æƒ…å†µä¸‹ï¼Œéœ€è¦éå†çŸ©é˜µä¸­é•¿åº¦ä¸º K å­—ç¬¦ä¸²çš„æ‰€æœ‰æ–¹æ¡ˆï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(3^K)ï¼›çŸ©é˜µä¸­å…±æœ‰ MNä¸ªèµ·ç‚¹ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(MN) ã€‚<ul><li>æ–¹æ¡ˆæ•°è®¡ç®—ï¼š è®¾å­—ç¬¦ä¸²é•¿åº¦ä¸º K ï¼Œæœç´¢ä¸­æ¯ä¸ªå­—ç¬¦æœ‰ä¸Šã€ä¸‹ã€å·¦ã€å³å››ä¸ªæ–¹å‘å¯ä»¥é€‰æ‹©ï¼Œèˆå¼ƒå›å¤´ï¼ˆä¸Šä¸ªå­—ç¬¦ï¼‰çš„æ–¹å‘ï¼Œå‰©ä¸‹ 3 ç§é€‰æ‹©ï¼Œå› æ­¤æ–¹æ¡ˆæ•°çš„å¤æ‚åº¦ä¸º O(3^K)</li></ul></li><li>ç©ºé—´å¤æ‚åº¦ O(K) ï¼š æœç´¢è¿‡ç¨‹ä¸­çš„é€’å½’æ·±åº¦ä¸è¶…è¿‡ K ï¼Œå› æ­¤ç³»ç»Ÿå› å‡½æ•°è°ƒç”¨ç´¯è®¡ä½¿ç”¨çš„æ ˆç©ºé—´å ç”¨ O(K) ï¼ˆå› ä¸ºå‡½æ•°è¿”å›åï¼Œç³»ç»Ÿè°ƒç”¨çš„æ ˆç©ºé—´ä¼šé‡Šæ”¾ï¼‰ã€‚æœ€åæƒ…å†µä¸‹ K &#x3D; MNï¼Œé€’å½’æ·±åº¦ä¸º MNï¼Œæ­¤æ—¶ç³»ç»Ÿæ ˆä½¿ç”¨ O(MN) çš„é¢å¤–ç©ºé—´ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">exist</span><span class="params">(<span class="type">char</span>[][] board, String word)</span> &#123;</span><br><span class="line">        <span class="type">char</span>[] words = word.toCharArray();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; board.length; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; board[<span class="number">0</span>].length; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(dfs(board, words, i, j, <span class="number">0</span>)) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">dfs</span><span class="params">(<span class="type">char</span>[][] board, <span class="type">char</span>[] word, <span class="type">int</span> i, <span class="type">int</span> j, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(i &gt;= board.length || i &lt; <span class="number">0</span> || j &gt;= board[<span class="number">0</span>].length || j &lt; <span class="number">0</span> || board[i][j] != word[k]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span>(k == word.length - <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        board[i][j] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">res</span> <span class="operator">=</span> dfs(board, word, i + <span class="number">1</span>, j, k + <span class="number">1</span>) || dfs(board, word, i - <span class="number">1</span>, j, k + <span class="number">1</span>) || </span><br><span class="line">                      dfs(board, word, i, j + <span class="number">1</span>, k + <span class="number">1</span>) || dfs(board, word, i , j - <span class="number">1</span>, k + <span class="number">1</span>);</span><br><span class="line">        board[i][j] = word[k];</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡-Offer-13-æœºå™¨äººçš„è¿åŠ¨èŒƒå›´"><a href="#å‰‘æŒ‡-Offer-13-æœºå™¨äººçš„è¿åŠ¨èŒƒå›´" class="headerlink" title="å‰‘æŒ‡ Offer 13. æœºå™¨äººçš„è¿åŠ¨èŒƒå›´"></a>å‰‘æŒ‡ Offer 13. æœºå™¨äººçš„è¿åŠ¨èŒƒå›´</h3><p>åœ°ä¸Šæœ‰ä¸€ä¸ªmè¡Œnåˆ—çš„æ–¹æ ¼ï¼Œä»åæ ‡ <code>[0,0]</code> åˆ°åæ ‡ <code>[m-1,n-1]</code> ã€‚ä¸€ä¸ªæœºå™¨äººä»åæ ‡ <code>[0, 0] </code>çš„æ ¼å­å¼€å§‹ç§»åŠ¨ï¼Œå®ƒæ¯æ¬¡å¯ä»¥å‘å·¦ã€å³ã€ä¸Šã€ä¸‹ç§»åŠ¨ä¸€æ ¼ï¼ˆä¸èƒ½ç§»åŠ¨åˆ°æ–¹æ ¼å¤–ï¼‰ï¼Œä¹Ÿä¸èƒ½è¿›å…¥è¡Œåæ ‡å’Œåˆ—åæ ‡çš„æ•°ä½ä¹‹å’Œå¤§äºkçš„æ ¼å­ã€‚ä¾‹å¦‚ï¼Œå½“kä¸º18æ—¶ï¼Œæœºå™¨äººèƒ½å¤Ÿè¿›å…¥æ–¹æ ¼ [35, 37] ï¼Œå› ä¸º3+5+3+7&#x3D;18ã€‚ä½†å®ƒä¸èƒ½è¿›å…¥æ–¹æ ¼ [35, 38]ï¼Œå› ä¸º3+5+3+8&#x3D;19ã€‚è¯·é—®è¯¥æœºå™¨äººèƒ½å¤Ÿåˆ°è¾¾å¤šå°‘ä¸ªæ ¼å­ï¼Ÿ</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šm = 2, n = 3, k = 1</span><br><span class="line">è¾“å‡ºï¼š3</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šm = 3, n = 1, k = 0</span><br><span class="line">è¾“å‡ºï¼š1</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li><code>1 &lt;= n,m &lt;= 100</code></li><li><code>0 &lt;= k &lt;= 20</code></li></ul><p>Related Topics</p><p>æ·±åº¦ä¼˜å…ˆæœç´¢</p><p>å¹¿åº¦ä¼˜å…ˆæœç´¢</p><p>åŠ¨æ€è§„åˆ’</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong></p><ol><li>ç¡®å®šDFSæ·±åº¦ä¼˜å…ˆæœç´¢ã€‚</li><li>ç”¨vistæ•°ç»„è®°å½•ï¼Œç”¨æ¥å‰ªæã€‚</li><li>å‘ä¸Šä¸‹å·¦å³å››ä¸ªæ–¹å‘æœç´¢ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">movingCount</span><span class="params">(<span class="type">int</span> m, <span class="type">int</span> n, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * è®°å½•[i,j]ä½ç½®æœ‰æ²¡æœ‰è®¿é—®è¿‡ï¼Œtrueè®¿é—®è¿‡ï¼Œfalseæ²¡è®¿é—®è¿‡</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="type">boolean</span>[][] visit = <span class="keyword">new</span> <span class="title class_">boolean</span>[m][n];</span><br><span class="line">    <span class="keyword">return</span> backtarcking(visit, <span class="number">0</span>, <span class="number">0</span>, k);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="title function_">backtarcking</span><span class="params">(<span class="type">boolean</span>[][] visit, <span class="type">int</span> row, <span class="type">int</span> col, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (row &lt; <span class="number">0</span> || col &lt; <span class="number">0</span> || row &gt; visit.length || col &gt; visit[<span class="number">0</span>].length || (row % <span class="number">10</span> + row / <span class="number">10</span> + col % <span class="number">10</span> + col / <span class="number">10</span>) &gt; k || visit[row][col]) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    visit[row][col] = <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">//å‘å››ä¸ªæ–¹å‘æœç´¢</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> backtarcking(visit, row - <span class="number">1</span>, col, k);<span class="comment">//ä¸Š</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> backtarcking(visit, row + <span class="number">1</span>, col, k);<span class="comment">//ä¸‹</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> backtarcking(visit, row, col - <span class="number">1</span>, k);<span class="comment">//å·¦</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">d</span> <span class="operator">=</span> backtarcking(visit, row, col + <span class="number">1</span>, k);<span class="comment">//å³</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> + a + b + c + d;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211191155225.png" alt="image-20221119115452914"></p><p>å¤æ‚åº¦åˆ†æï¼š<br>è®¾çŸ©é˜µè¡Œåˆ—æ•°åˆ†åˆ«ä¸º M, Nã€‚</p><p>æ—¶é—´å¤æ‚åº¦ O(MN)ï¼š æœ€å·®æƒ…å†µä¸‹ï¼Œæœºå™¨äººéå†çŸ©é˜µæ‰€æœ‰å•å…ƒæ ¼ï¼Œæ­¤æ—¶æ—¶é—´å¤æ‚åº¦ä¸º O(MN)ã€‚<br>ç©ºé—´å¤æ‚åº¦ O(MN) ï¼š æœ€å·®æƒ…å†µä¸‹ï¼ŒSet visited å†…å­˜å‚¨çŸ©é˜µæ‰€æœ‰å•å…ƒæ ¼çš„ç´¢å¼•ï¼Œä½¿ç”¨ O(MN)çš„é¢å¤–ç©ºé—´ã€‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211191157599.png" alt="image-20221119115705308"></p><p>å¤æ‚åº¦åˆ†æï¼š<br>è®¾çŸ©é˜µè¡Œåˆ—æ•°åˆ†åˆ«ä¸º M, Nã€‚</p><p>æ—¶é—´å¤æ‚åº¦ O(MN)ï¼š æœ€å·®æƒ…å†µä¸‹ï¼Œæœºå™¨äººéå†çŸ©é˜µæ‰€æœ‰å•å…ƒæ ¼ï¼Œæ­¤æ—¶æ—¶é—´å¤æ‚åº¦ä¸º O(MN)ã€‚<br>ç©ºé—´å¤æ‚åº¦ O(MN) ï¼š æœ€å·®æƒ…å†µä¸‹ï¼ŒSet visited å†…å­˜å‚¨çŸ©é˜µæ‰€æœ‰å•å…ƒæ ¼çš„ç´¢å¼•ï¼Œä½¿ç”¨ O(MN)çš„é¢å¤–ç©ºé—´ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">movingCount</span><span class="params">(<span class="type">int</span> m, <span class="type">int</span> n, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">        <span class="type">boolean</span>[][] visited = <span class="keyword">new</span> <span class="title class_">boolean</span>[m][n];</span><br><span class="line">        <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        Queue&lt;<span class="type">int</span>[]&gt; queue= <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;<span class="type">int</span>[]&gt;();</span><br><span class="line">        queue.add(<span class="keyword">new</span> <span class="title class_">int</span>[] &#123; <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span> &#125;);</span><br><span class="line">        <span class="keyword">while</span>(queue.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="type">int</span>[] x = queue.poll();</span><br><span class="line">            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> x[<span class="number">0</span>], j = x[<span class="number">1</span>], si = x[<span class="number">2</span>], sj = x[<span class="number">3</span>];</span><br><span class="line">            <span class="keyword">if</span>(i &gt;= m || j &gt;= n || k &lt; si + sj || visited[i][j]) <span class="keyword">continue</span>;</span><br><span class="line">            visited[i][j] = <span class="literal">true</span>;</span><br><span class="line">            res ++;</span><br><span class="line">            queue.add(<span class="keyword">new</span> <span class="title class_">int</span>[] &#123; i + <span class="number">1</span>, j, (i + <span class="number">1</span>) % <span class="number">10</span> != <span class="number">0</span> ? si + <span class="number">1</span> : si - <span class="number">8</span>, sj &#125;);</span><br><span class="line">            queue.add(<span class="keyword">new</span> <span class="title class_">int</span>[] &#123; i, j + <span class="number">1</span>, si, (j + <span class="number">1</span>) % <span class="number">10</span> != <span class="number">0</span> ? sj + <span class="number">1</span> : sj - <span class="number">8</span> &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡-Offer-26-æ ‘çš„å­ç»“æ„"><a href="#å‰‘æŒ‡-Offer-26-æ ‘çš„å­ç»“æ„" class="headerlink" title="å‰‘æŒ‡ Offer 26. æ ‘çš„å­ç»“æ„"></a>å‰‘æŒ‡ Offer 26. æ ‘çš„å­ç»“æ„</h3><p>è¾“å…¥ä¸¤æ£µäºŒå‰æ ‘Aå’ŒBï¼Œåˆ¤æ–­Bæ˜¯ä¸æ˜¯Açš„å­ç»“æ„ã€‚(çº¦å®šç©ºæ ‘ä¸æ˜¯ä»»æ„ä¸€ä¸ªæ ‘çš„å­ç»“æ„)</p><p>Bæ˜¯Açš„å­ç»“æ„ï¼Œ å³ Aä¸­æœ‰å‡ºç°å’ŒBç›¸åŒçš„ç»“æ„å’ŒèŠ‚ç‚¹å€¼ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šA = [1,2,3], B = [3,1]</span><br><span class="line">è¾“å‡ºï¼šfalse</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šA = [3,4,5,1,2], B = [4,1]</span><br><span class="line">è¾“å‡ºï¼štrue</span><br></pre></td></tr></table></figure><p><strong>é™åˆ¶ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 &lt;= èŠ‚ç‚¹ä¸ªæ•° &lt;= 10000</span><br></pre></td></tr></table></figure><p>Related Topics</p><p>æ ‘</p><p>æ·±åº¦ä¼˜å…ˆæœç´¢</p><p>äºŒå‰æ ‘</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong><br>è‹¥æ ‘ B æ˜¯æ ‘ A çš„å­ç»“æ„ï¼Œåˆ™å­ç»“æ„çš„æ ¹èŠ‚ç‚¹å¯èƒ½ä¸ºæ ‘ A çš„ä»»æ„ä¸€ä¸ªèŠ‚ç‚¹ã€‚å› æ­¤ï¼Œåˆ¤æ–­æ ‘ B æ˜¯å¦æ˜¯æ ‘ A çš„å­ç»“æ„ï¼Œéœ€å®Œæˆä»¥ä¸‹ä¸¤æ­¥å·¥ä½œï¼š</p><ol><li>å…ˆåºéå†æ ‘ A ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹ nAï¼ˆå¯¹åº”å‡½æ•° isSubStructure(A, B)ï¼‰</li><li>åˆ¤æ–­æ ‘ A ä¸­ ä»¥ nA ä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘ æ˜¯å¦åŒ…å«æ ‘ B ã€‚ï¼ˆå¯¹åº”å‡½æ•° recur(A, B)ï¼‰</li></ol><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211191500296.png" alt="Picture1.png"></p><p><strong>ç®—æ³•æµç¨‹ï¼š</strong></p><blockquote><p>æœ¬æ–‡åè¯è§„å®šï¼šæ ‘ A çš„æ ¹èŠ‚ç‚¹è®°ä½œ èŠ‚ç‚¹ A ï¼Œæ ‘ B çš„æ ¹èŠ‚ç‚¹ç§°ä¸º èŠ‚ç‚¹ B ã€‚</p></blockquote><p><code>recur(A, B)</code> å‡½æ•°ï¼š</p><ol><li>ç»ˆæ­¢æ¡ä»¶ï¼š<ol><li>å½“èŠ‚ç‚¹ B ä¸ºç©ºï¼šè¯´æ˜æ ‘ B å·²åŒ¹é…å®Œæˆï¼ˆè¶Šè¿‡å¶å­èŠ‚ç‚¹ï¼‰ï¼Œå› æ­¤è¿”å› true ï¼›</li><li>å½“èŠ‚ç‚¹ A ä¸ºç©ºï¼šè¯´æ˜å·²ç»è¶Šè¿‡æ ‘ A çš„å¶èŠ‚ç‚¹ï¼Œå³åŒ¹é…å¤±è´¥ï¼Œè¿”å› false ï¼›</li><li>å½“èŠ‚ç‚¹ A å’Œ B çš„å€¼ä¸åŒï¼šè¯´æ˜åŒ¹é…å¤±è´¥ï¼Œè¿”å› false ï¼›</li></ol></li><li>è¿”å›å€¼ï¼š<ol><li>åˆ¤æ–­ A å’Œ B çš„ å·¦å­èŠ‚ç‚¹ æ˜¯å¦ç›¸ç­‰ï¼Œå³ recur(A.left, B.left) ï¼›</li><li>åˆ¤æ–­ A å’Œ B çš„ å³å­èŠ‚ç‚¹ æ˜¯å¦ç›¸ç­‰ï¼Œå³ recur(A.right, B.right) ï¼›</li></ol></li></ol><p><code>isSubStructure(A, B)</code> å‡½æ•°ï¼š</p><ol><li>ç‰¹ä¾‹å¤„ç†ï¼š å½“ æ ‘ A ä¸ºç©º æˆ– æ ‘ B ä¸ºç©º æ—¶ï¼Œç›´æ¥è¿”å› false ï¼›</li><li>è¿”å›å€¼ï¼š è‹¥æ ‘ B æ˜¯æ ‘ A çš„å­ç»“æ„ï¼Œåˆ™å¿…æ»¡è¶³ä»¥ä¸‹ä¸‰ç§æƒ…å†µä¹‹ä¸€ï¼Œå› æ­¤ç”¨æˆ– || è¿æ¥ï¼›<ol><li>ä»¥ èŠ‚ç‚¹ A ä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘ åŒ…å«æ ‘ B ï¼Œå¯¹åº” recur(A, B)ï¼›</li><li>æ ‘ B æ˜¯ æ ‘ A å·¦å­æ ‘ çš„å­ç»“æ„ï¼Œå¯¹åº” isSubStructure(A.left, B)ï¼›</li><li>æ ‘ B æ˜¯ æ ‘ A å³å­æ ‘ çš„å­ç»“æ„ï¼Œå¯¹åº” isSubStructure(A.right, B)ï¼›</li></ol></li></ol><blockquote><p>ä»¥ä¸Š 2. 3. å®è´¨ä¸Šæ˜¯åœ¨å¯¹æ ‘ A åš å…ˆåºéå† ã€‚</p></blockquote><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211191503691.png" alt="img"></p><p><strong>å¤æ‚åº¦åˆ†æï¼š</strong></p><ul><li>æ—¶é—´å¤æ‚åº¦ O(MN) ï¼š å…¶ä¸­ M, Nåˆ†åˆ«ä¸ºæ ‘ A å’Œ æ ‘ B çš„èŠ‚ç‚¹æ•°é‡ï¼›å…ˆåºéå†æ ‘ A å ç”¨ O(M) ï¼Œæ¯æ¬¡è°ƒç”¨ recur(A, B) åˆ¤æ–­å ç”¨ O(N)ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ O(M) ï¼š å½“æ ‘ A å’Œæ ‘ B éƒ½é€€åŒ–ä¸ºé“¾è¡¨æ—¶ï¼Œé€’å½’è°ƒç”¨æ·±åº¦æœ€å¤§ã€‚å½“ Mâ‰¤N æ—¶ï¼Œéå†æ ‘ A ä¸é€’å½’åˆ¤æ–­çš„æ€»é€’å½’æ·±åº¦ä¸º M ï¼›å½“ M&gt;N æ—¶ï¼Œæœ€å·®æƒ…å†µä¸ºéå†è‡³æ ‘ A çš„å¶èŠ‚ç‚¹ï¼Œæ­¤æ—¶æ€»é€’å½’æ·±åº¦ä¸º Mã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isSubStructure</span><span class="params">(TreeNode A, TreeNode B)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (A != <span class="literal">null</span> &amp;&amp; B != <span class="literal">null</span>) &amp;&amp; (recur(A, B) || isSubStructure(A.left, B) || isSubStructure(A.right, B));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">recur</span><span class="params">(TreeNode A, TreeNode B)</span> &#123;</span><br><span class="line">    <span class="comment">// ç»ˆæ­¢æ¡ä»¶</span></span><br><span class="line">    <span class="keyword">if</span> (B == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span> (A == <span class="literal">null</span> || A.val != B.val) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> recur(A.left, B.left) &amp;&amp; recur(A.right, B.right);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡-Offer-27-äºŒå‰æ ‘çš„é•œåƒ"><a href="#å‰‘æŒ‡-Offer-27-äºŒå‰æ ‘çš„é•œåƒ" class="headerlink" title="å‰‘æŒ‡ Offer 27. äºŒå‰æ ‘çš„é•œåƒ"></a>å‰‘æŒ‡ Offer 27. äºŒå‰æ ‘çš„é•œåƒ</h3><p>è¯·å®Œæˆä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥ä¸€ä¸ªäºŒå‰æ ‘ï¼Œè¯¥å‡½æ•°è¾“å‡ºå®ƒçš„é•œåƒã€‚</p><p>ä¾‹å¦‚è¾“å…¥ï¼š</p><p><code>     4    /   \   2     7  / \   / \ 1   3 6   9</code><br>é•œåƒè¾“å‡ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4    /   \   7     2  / \   / \ 9   6 3   1</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šroot = [4,2,7,1,3,6,9]</span><br><span class="line">è¾“å‡ºï¼š[4,7,2,9,6,3,1]</span><br></pre></td></tr></table></figure><p><strong>é™åˆ¶ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 &lt;= èŠ‚ç‚¹ä¸ªæ•° &lt;= 1000</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šæœ¬é¢˜ä¸ä¸»ç«™ 226 é¢˜ç›¸åŒï¼š<a href="https://leetcode-cn.com/problems/invert-binary-tree/">https://leetcode-cn.com/problems/invert-binary-tree/</a></p><p>Related Topics</p><p>æ ‘</p><p>æ·±åº¦ä¼˜å…ˆæœç´¢</p><p>å¹¿åº¦ä¼˜å…ˆæœç´¢</p><p>äºŒå‰æ ‘</p><p>ğŸ‘ 320</p><p>ğŸ‘ 0</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong></p><p><img src="https://tva1.sinaimg.cn/large/008eGmZEly1gnakm26jtog30e409s4qp.gif" alt="ç¿»è½¬äºŒå‰æ ‘"></p><p>é€’å½’ä¸‰éƒ¨æ›²ï¼š</p><ol><li>ç¡®å®šé€’å½’å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼</li></ol><p>å‚æ•°å°±æ˜¯è¦ä¼ å…¥èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œä¸éœ€è¦å…¶ä»–å‚æ•°äº†ï¼Œé€šå¸¸æ­¤æ—¶å®šä¸‹æ¥ä¸»è¦å‚æ•°ï¼Œå¦‚æœåœ¨å†™é€’å½’çš„é€»è¾‘ä¸­å‘ç°è¿˜éœ€è¦å…¶ä»–å‚æ•°çš„æ—¶å€™ï¼Œéšæ—¶è¡¥å……ã€‚</p><p>è¿”å›å€¼çš„è¯å…¶å®ä¹Ÿä¸éœ€è¦ï¼Œä½†æ˜¯é¢˜ç›®ä¸­ç»™å‡ºçš„è¦è¿”å›rootèŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨é¢˜ç›®å®šä¹‰å¥½çš„å‡½æ•°ï¼Œæ‰€ä»¥å°±å‡½æ•°çš„è¿”å›ç±»å‹ä¸º<code>TreeNode*</code>ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">TreeNode* <span class="title">invertTree</span><span class="params">(TreeNode* root)</span></span></span><br></pre></td></tr></table></figure><ol start="2"><li>ç¡®å®šç»ˆæ­¢æ¡ä»¶</li></ol><p>å½“å‰èŠ‚ç‚¹ä¸ºç©ºçš„æ—¶å€™ï¼Œå°±è¿”å›</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (root == <span class="literal">NULL</span>) <span class="keyword">return</span> root;</span><br></pre></td></tr></table></figure><ol start="3"><li>ç¡®å®šå•å±‚é€’å½’çš„é€»è¾‘</li></ol><p>å› ä¸ºæ˜¯å…ˆå‰åºéå†ï¼Œæ‰€ä»¥å…ˆè¿›è¡Œäº¤æ¢å·¦å³å­©å­èŠ‚ç‚¹ï¼Œç„¶ååè½¬å·¦å­æ ‘ï¼Œåè½¬å³å­æ ‘ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">swap</span>(root-&gt;left, root-&gt;right);</span><br><span class="line"><span class="built_in">invertTree</span>(root-&gt;left);</span><br><span class="line"><span class="built_in">invertTree</span>(root-&gt;right);</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> TreeNode <span class="title function_">mirrorTree</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> recur(root);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> TreeNode <span class="title function_">recur</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="type">TreeNode</span> <span class="variable">tmp</span> <span class="operator">=</span> root.left;</span><br><span class="line">        root.left = root.right;</span><br><span class="line">        root.right = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    recur(root.left);</span><br><span class="line">    recur(root.right);</span><br><span class="line">    <span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡-Offer-28-å¯¹ç§°çš„äºŒå‰æ ‘"><a href="#å‰‘æŒ‡-Offer-28-å¯¹ç§°çš„äºŒå‰æ ‘" class="headerlink" title="å‰‘æŒ‡ Offer 28. å¯¹ç§°çš„äºŒå‰æ ‘"></a>å‰‘æŒ‡ Offer 28. å¯¹ç§°çš„äºŒå‰æ ‘</h3><p>è¯·å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥åˆ¤æ–­ä¸€æ£µäºŒå‰æ ‘æ˜¯ä¸æ˜¯å¯¹ç§°çš„ã€‚å¦‚æœä¸€æ£µäºŒå‰æ ‘å’Œå®ƒçš„é•œåƒä¸€æ ·ï¼Œé‚£ä¹ˆå®ƒæ˜¯å¯¹ç§°çš„ã€‚</p><p>ä¾‹å¦‚ï¼ŒäºŒå‰æ ‘ [1,2,2,3,4,4,3] æ˜¯å¯¹ç§°çš„ã€‚</p><p><code>    1    / \   2   2  / \ / \ 3  4 4  3</code><br>ä½†æ˜¯ä¸‹é¢è¿™ä¸ª [1,2,2,null,3,null,3] åˆ™ä¸æ˜¯é•œåƒå¯¹ç§°çš„:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1    / \   2   2    \   \    3    3</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šroot = [1,2,2,3,4,4,3]</span><br><span class="line">è¾“å‡ºï¼štrue</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šroot = [1,2,2,null,3,null,3]</span><br><span class="line">è¾“å‡ºï¼šfalse</span><br></pre></td></tr></table></figure><p><strong>é™åˆ¶ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 &lt;= èŠ‚ç‚¹ä¸ªæ•° &lt;= 1000</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šæœ¬é¢˜ä¸ä¸»ç«™ 101 é¢˜ç›¸åŒï¼š<a href="https://leetcode-cn.com/problems/symmetric-tree/">https://leetcode-cn.com/problems/symmetric-tree/</a></p><p>Related Topics</p><p>æ ‘</p><p>æ·±åº¦ä¼˜å…ˆæœç´¢</p><p>å¹¿åº¦ä¼˜å…ˆæœç´¢</p><p>äºŒå‰æ ‘</p><p>ğŸ‘ 397</p><p>ğŸ‘ 0</p><p>é¦–å…ˆæƒ³æ¸…æ¥šï¼Œè¦æ¯”è¾ƒçš„å¯ä¸æ˜¯å·¦å³èŠ‚ç‚¹ï¼å¯¹äºäºŒå‰æ ‘æ˜¯å¦å¯¹ç§°ï¼Œè¦æ¯”è¾ƒçš„æ˜¯æ ¹èŠ‚ç‚¹çš„å·¦å­æ ‘ä¸å³å­æ ‘æ˜¯ä¸æ˜¯ç›¸äº’ç¿»è½¬çš„,å…¶å®æˆ‘ä»¬è¦æ¯”è¾ƒçš„æ˜¯ä¸¤ä¸ªæ ‘ï¼ˆè¿™ä¸¤ä¸ªæ ‘æ˜¯æ ¹èŠ‚ç‚¹çš„å·¦å³å­æ ‘ï¼‰ï¼Œæ‰€ä»¥åœ¨é€’å½’éå†çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿæ˜¯è¦åŒæ—¶éå†ä¸¤æ£µæ ‘ã€‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211201040962.png" alt="101. å¯¹ç§°äºŒå‰æ ‘1"></p><p>é‚£ä¹ˆéå†çš„é¡ºåºåº”è¯¥æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿ</p><p>æœ¬é¢˜éå†åªèƒ½æ˜¯â€œååºéå†â€ï¼Œå› ä¸ºæˆ‘ä»¬è¦é€šè¿‡é€’å½’å‡½æ•°çš„è¿”å›å€¼æ¥åˆ¤æ–­ä¸¤ä¸ªå­æ ‘çš„å†…ä¾§èŠ‚ç‚¹å’Œå¤–ä¾§èŠ‚ç‚¹æ˜¯å¦ç›¸ç­‰ã€‚</p><p><strong>æ­£æ˜¯å› ä¸ºè¦éå†ä¸¤æ£µæ ‘è€Œä¸”è¦æ¯”è¾ƒå†…ä¾§å’Œå¤–ä¾§èŠ‚ç‚¹ï¼Œæ‰€ä»¥å‡†ç¡®çš„æ¥è¯´æ˜¯ä¸€ä¸ªæ ‘çš„éå†é¡ºåºæ˜¯å·¦å³ä¸­ï¼Œä¸€ä¸ªæ ‘çš„éå†é¡ºåºæ˜¯å³å·¦ä¸­ã€‚</strong></p><p>ä½†éƒ½å¯ä»¥ç†è§£ç®—æ˜¯ååºéå†ï¼Œå°½ç®¡å·²ç»ä¸æ˜¯ä¸¥æ ¼ä¸Šåœ¨ä¸€ä¸ªæ ‘ä¸Šè¿›è¡Œéå†çš„ååºéå†äº†ã€‚</p><hr><p><strong>é€’å½’ä¸‰éƒ¨æ›²</strong></p><ol><li>ç¡®å®šé€’å½’å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼</li></ol><p>å› ä¸ºæˆ‘ä»¬è¦æ¯”è¾ƒçš„æ˜¯æ ¹èŠ‚ç‚¹çš„ä¸¤ä¸ªå­æ ‘æ˜¯å¦æ˜¯ç›¸äº’ç¿»è½¬çš„ï¼Œè¿›è€Œåˆ¤æ–­è¿™ä¸ªæ ‘æ˜¯ä¸æ˜¯å¯¹ç§°æ ‘ï¼Œæ‰€ä»¥è¦æ¯”è¾ƒçš„æ˜¯ä¸¤ä¸ªæ ‘ï¼Œå‚æ•°è‡ªç„¶ä¹Ÿæ˜¯å·¦å­æ ‘èŠ‚ç‚¹å’Œå³å­æ ‘èŠ‚ç‚¹ã€‚</p><p>è¿”å›å€¼è‡ªç„¶æ˜¯boolç±»å‹ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bool compare(TreeNode* left, TreeNode* right)</span><br></pre></td></tr></table></figure><ol start="2"><li>ç¡®å®šç»ˆæ­¢æ¡ä»¶</li></ol><p>è¦æ¯”è¾ƒä¸¤ä¸ªèŠ‚ç‚¹æ•°å€¼ç›¸ä¸ç›¸åŒï¼Œé¦–å…ˆè¦æŠŠä¸¤ä¸ªèŠ‚ç‚¹ä¸ºç©ºçš„æƒ…å†µå¼„æ¸…æ¥šï¼å¦åˆ™åé¢æ¯”è¾ƒæ•°å€¼çš„æ—¶å€™å°±ä¼šæ“ä½œç©ºæŒ‡é’ˆäº†ã€‚</p><p>èŠ‚ç‚¹ä¸ºç©ºçš„æƒ…å†µæœ‰ï¼šï¼ˆ<strong>æ³¨æ„æˆ‘ä»¬æ¯”è¾ƒçš„å…¶å®ä¸æ˜¯å·¦å­©å­å’Œå³å­©å­ï¼Œæ‰€ä»¥å¦‚ä¸‹æˆ‘ç§°ä¹‹ä¸ºå·¦èŠ‚ç‚¹å³èŠ‚ç‚¹</strong>ï¼‰</p><ul><li>å·¦èŠ‚ç‚¹ä¸ºç©ºï¼Œå³èŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œä¸å¯¹ç§°ï¼Œreturn false</li><li>å·¦ä¸ä¸ºç©ºï¼Œå³ä¸ºç©ºï¼Œä¸å¯¹ç§° return false</li><li>å·¦å³éƒ½ä¸ºç©ºï¼Œå¯¹ç§°ï¼Œè¿”å›true</li></ul><p>æ­¤æ—¶å·²ç»æ’é™¤æ‰äº†èŠ‚ç‚¹ä¸ºç©ºçš„æƒ…å†µï¼Œé‚£ä¹ˆå‰©ä¸‹çš„å°±æ˜¯å·¦å³èŠ‚ç‚¹ä¸ä¸ºç©ºï¼š</p><ul><li>å·¦å³éƒ½ä¸ä¸ºç©ºï¼Œæ¯”è¾ƒèŠ‚ç‚¹æ•°å€¼ï¼Œä¸ç›¸åŒå°±return false</li></ul><p>æ­¤æ—¶å·¦å³èŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œä¸”æ•°å€¼ä¹Ÿä¸ç›¸åŒçš„æƒ…å†µæˆ‘ä»¬ä¹Ÿå¤„ç†äº†ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (left == <span class="literal">NULL</span> &amp;&amp; right != <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (left != <span class="literal">NULL</span> &amp;&amp; right == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (left == <span class="literal">NULL</span> &amp;&amp; right == <span class="literal">NULL</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (left-&gt;val != right-&gt;val) <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// æ³¨æ„è¿™é‡Œæˆ‘æ²¡æœ‰ä½¿ç”¨else</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„ä¸Šé¢æœ€åä¸€ç§æƒ…å†µï¼Œæˆ‘æ²¡æœ‰ä½¿ç”¨elseï¼Œè€Œæ˜¯else ifï¼Œ å› ä¸ºæˆ‘ä»¬æŠŠä»¥ä¸Šæƒ…å†µéƒ½æ’é™¤ä¹‹åï¼Œå‰©ä¸‹çš„å°±æ˜¯ å·¦å³èŠ‚ç‚¹éƒ½ä¸ä¸ºç©ºï¼Œä¸”æ•°å€¼ç›¸åŒçš„æƒ…å†µã€‚</p><ol start="3"><li>ç¡®å®šå•å±‚é€’å½’çš„é€»è¾‘</li></ol><p>æ­¤æ—¶æ‰è¿›å…¥å•å±‚é€’å½’çš„é€»è¾‘ï¼Œå•å±‚é€’å½’çš„é€»è¾‘å°±æ˜¯å¤„ç† å·¦å³èŠ‚ç‚¹éƒ½ä¸ä¸ºç©ºï¼Œä¸”æ•°å€¼ç›¸åŒçš„æƒ…å†µã€‚</p><ul><li>æ¯”è¾ƒäºŒå‰æ ‘å¤–ä¾§æ˜¯å¦å¯¹ç§°ï¼šä¼ å…¥çš„æ˜¯å·¦èŠ‚ç‚¹çš„å·¦å­©å­ï¼Œå³èŠ‚ç‚¹çš„å³å­©å­ã€‚</li><li>æ¯”è¾ƒå†…æµ‹æ˜¯å¦å¯¹ç§°ï¼Œä¼ å…¥å·¦èŠ‚ç‚¹çš„å³å­©å­ï¼Œå³èŠ‚ç‚¹çš„å·¦å­©å­ã€‚</li><li>å¦‚æœå·¦å³éƒ½å¯¹ç§°å°±è¿”å›true ï¼Œæœ‰ä¸€ä¾§ä¸å¯¹ç§°å°±è¿”å›false ã€‚</li></ul><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> outside = <span class="built_in">compare</span>(left-&gt;left, right-&gt;right);   <span class="comment">// å·¦å­æ ‘ï¼šå·¦ã€ å³å­æ ‘ï¼šå³</span></span><br><span class="line"><span class="type">bool</span> inside = <span class="built_in">compare</span>(left-&gt;right, right-&gt;left);    <span class="comment">// å·¦å­æ ‘ï¼šå³ã€ å³å­æ ‘ï¼šå·¦</span></span><br><span class="line"><span class="type">bool</span> isSame = outside &amp;&amp; inside;                    <span class="comment">// å·¦å­æ ‘ï¼šä¸­ã€ å³å­æ ‘ï¼šä¸­ï¼ˆé€»è¾‘å¤„ç†ï¼‰</span></span><br><span class="line"><span class="keyword">return</span> isSame;</span><br></pre></td></tr></table></figure><p>ä¸Šä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºä½¿ç”¨çš„éå†æ–¹å¼ï¼Œå·¦å­æ ‘å·¦å³ä¸­ï¼Œå³å­æ ‘å³å·¦ä¸­ï¼Œæ‰€ä»¥æˆ‘æŠŠè¿™ä¸ªéå†é¡ºåºä¹Ÿç§°ä¹‹ä¸ºâ€œååºéå†â€ï¼ˆå°½ç®¡ä¸æ˜¯ä¸¥æ ¼çš„ååºéå†ï¼‰ã€‚</p><p><strong>é€’å½’ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isSymmetric</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> compare(root.left, root.right);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">compare</span><span class="params">(TreeNode left, TreeNode right)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ((left != <span class="literal">null</span> &amp;&amp; right == <span class="literal">null</span>) || (left == <span class="literal">null</span> &amp;&amp; right != <span class="literal">null</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (left == <span class="literal">null</span> &amp;&amp; right == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (left.val != right.val) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> compare(left.left , right.right) &amp;&amp; compare(left.right , right.left);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¿­ä»£ï¼š</strong></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211201106248.gif" alt="101.å¯¹ç§°äºŒå‰æ ‘"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isSymmetric</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//å·¦å³å­©å­å…¥é˜Ÿ</span></span><br><span class="line">        queue.offer(root.left);</span><br><span class="line">        queue.offer(root.right);</span><br><span class="line">        <span class="keyword">while</span> (!queue.isEmpty()) &#123;</span><br><span class="line">            <span class="type">TreeNode</span> <span class="variable">left</span> <span class="operator">=</span> queue.poll();</span><br><span class="line">            <span class="type">TreeNode</span> <span class="variable">right</span> <span class="operator">=</span> queue.poll();</span><br><span class="line">            <span class="comment">//å·¦å³å­©å­ä¸ºç©º</span></span><br><span class="line">            <span class="keyword">if</span> (left == <span class="literal">null</span> &amp;&amp; right == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å·¦å³å­©å­ä¸€ä¸ªä¸ä¸ºç©º æˆ–è€…éƒ½ä¸ä¸ºç©º ä½†å€¼ä¸ä¸€æ ·</span></span><br><span class="line">            <span class="keyword">if</span> ((left != <span class="literal">null</span> &amp;&amp; right == <span class="literal">null</span>) || (left == <span class="literal">null</span> &amp;&amp; right != <span class="literal">null</span>) || (left.val != right.val)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å­èŠ‚ç‚¹æ¯”è¾ƒ</span></span><br><span class="line">            queue.offer(left.left);<span class="comment">//å·¦å·¦</span></span><br><span class="line">            queue.offer(right.right);<span class="comment">//å³å³</span></span><br><span class="line">            queue.offer(left.right);<span class="comment">//å·¦å³</span></span><br><span class="line">            queue.offer(right.left);<span class="comment">//å³å·¦</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡-Offer-32-I-ä»ä¸Šåˆ°ä¸‹æ‰“å°äºŒå‰æ ‘"><a href="#å‰‘æŒ‡-Offer-32-I-ä»ä¸Šåˆ°ä¸‹æ‰“å°äºŒå‰æ ‘" class="headerlink" title="å‰‘æŒ‡ Offer 32 - I. ä»ä¸Šåˆ°ä¸‹æ‰“å°äºŒå‰æ ‘"></a>å‰‘æŒ‡ Offer 32 - I. ä»ä¸Šåˆ°ä¸‹æ‰“å°äºŒå‰æ ‘</h3><p>ä»ä¸Šåˆ°ä¸‹æ‰“å°å‡ºäºŒå‰æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹ï¼ŒåŒä¸€å±‚çš„èŠ‚ç‚¹æŒ‰ç…§ä»å·¦åˆ°å³çš„é¡ºåºæ‰“å°ã€‚</p><p>ä¾‹å¦‚:<br>ç»™å®šäºŒå‰æ ‘: <code>[3,9,20,null,null,15,7]</code>,</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  3</span><br><span class="line"> / \</span><br><span class="line">9  20</span><br><span class="line">  /  \</span><br><span class="line"> 15   7</span><br></pre></td></tr></table></figure><p>è¿”å›ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[3,9,20,15,7]</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ol><li><code>èŠ‚ç‚¹æ€»æ•° &lt;= 1000</code></li></ol><p>Related Topics</p><p>æ ‘</p><p>å¹¿åº¦ä¼˜å…ˆæœç´¢</p><p>äºŒå‰æ ‘</p><p>ğŸ‘ 236</p><p>ğŸ‘ 0</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong></p><p>é¢˜ç›®è¦æ±‚çš„äºŒå‰æ ‘çš„ ä»ä¸Šè‡³ä¸‹ æ‰“å°ï¼ˆå³æŒ‰å±‚æ‰“å°ï¼‰ï¼Œåˆç§°ä¸ºäºŒå‰æ ‘çš„ å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰ã€‚<br>BFS é€šå¸¸å€ŸåŠ© é˜Ÿåˆ— çš„å…ˆå…¥å…ˆå‡ºç‰¹æ€§æ¥å®ç°ã€‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211201153247.png" alt="Picture1.png"></p><p>ç®—æ³•æµç¨‹ï¼š</p><ol><li>ç‰¹ä¾‹å¤„ç†ï¼š å½“æ ‘çš„æ ¹èŠ‚ç‚¹ä¸ºç©ºï¼Œåˆ™ç›´æ¥è¿”å›ç©ºåˆ—è¡¨ [] ï¼›</li><li>åˆå§‹åŒ–ï¼š æ‰“å°ç»“æœåˆ—è¡¨ res &#x3D; [] ï¼ŒåŒ…å«æ ¹èŠ‚ç‚¹çš„é˜Ÿåˆ— queue &#x3D; [root] ï¼›</li><li>BFS å¾ªç¯ï¼š å½“é˜Ÿåˆ— queue ä¸ºç©ºæ—¶è·³å‡ºï¼›</li><li>å‡ºé˜Ÿï¼š é˜Ÿé¦–å…ƒç´ å‡ºé˜Ÿï¼Œè®°ä¸º nodeï¼›</li><li>æ‰“å°ï¼š å°† node.val æ·»åŠ è‡³åˆ—è¡¨ tmp å°¾éƒ¨ï¼›</li><li>æ·»åŠ å­èŠ‚ç‚¹ï¼š è‹¥ node çš„å·¦ï¼ˆå³ï¼‰å­èŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œåˆ™å°†å·¦ï¼ˆå³ï¼‰å­èŠ‚ç‚¹åŠ å…¥é˜Ÿåˆ— queue ï¼›</li><li>è¿”å›å€¼ï¼š è¿”å›æ‰“å°ç»“æœåˆ—è¡¨ res å³å¯ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span>[] levelOrder(TreeNode root) &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;&#125;;</span><br><span class="line">    Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    List&lt;Integer&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    queue.add(root);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (!queue.isEmpty()) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> queue.size();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">            <span class="type">TreeNode</span> <span class="variable">tmp</span> <span class="operator">=</span>  queue.poll();</span><br><span class="line">            res.add(tmp.val);</span><br><span class="line">            <span class="keyword">if</span> (tmp.left != <span class="literal">null</span>) queue.add(tmp.left);</span><br><span class="line">            <span class="keyword">if</span> (tmp.right != <span class="literal">null</span>) queue.add(tmp.right);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res.stream().mapToInt(Integer::intValue).toArray();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡-Offer-32-II-ä»ä¸Šåˆ°ä¸‹æ‰“å°äºŒå‰æ ‘-II"><a href="#å‰‘æŒ‡-Offer-32-II-ä»ä¸Šåˆ°ä¸‹æ‰“å°äºŒå‰æ ‘-II" class="headerlink" title="å‰‘æŒ‡ Offer 32 - II. ä»ä¸Šåˆ°ä¸‹æ‰“å°äºŒå‰æ ‘ II"></a>å‰‘æŒ‡ Offer 32 - II. ä»ä¸Šåˆ°ä¸‹æ‰“å°äºŒå‰æ ‘ II</h3><p>ä»ä¸Šåˆ°ä¸‹æŒ‰å±‚æ‰“å°äºŒå‰æ ‘ï¼ŒåŒä¸€å±‚çš„èŠ‚ç‚¹æŒ‰ä»å·¦åˆ°å³çš„é¡ºåºæ‰“å°ï¼Œæ¯ä¸€å±‚æ‰“å°åˆ°ä¸€è¡Œã€‚</p><p>ä¾‹å¦‚:<br>ç»™å®šäºŒå‰æ ‘: <code>[3,9,20,null,null,15,7]</code>,</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  3</span><br><span class="line"> / \</span><br><span class="line">9  20</span><br><span class="line">  /  \</span><br><span class="line"> 15   7</span><br></pre></td></tr></table></figure><p>è¿”å›å…¶å±‚æ¬¡éå†ç»“æœï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  [3],</span><br><span class="line">  [9,20],</span><br><span class="line">  [15,7]</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ol><li><code>èŠ‚ç‚¹æ€»æ•° &lt;= 1000</code></li></ol><p>æ³¨æ„ï¼šæœ¬é¢˜ä¸ä¸»ç«™ 102 é¢˜ç›¸åŒï¼š<a href="https://leetcode-cn.com/problems/binary-tree-level-order-traversal/">https://leetcode-cn.com/problems/binary-tree-level-order-traversal/</a></p><p>Related Topics</p><p>æ ‘</p><p>å¹¿åº¦ä¼˜å…ˆæœç´¢</p><p>äºŒå‰æ ‘</p><p>ğŸ‘ 256</p><p>ğŸ‘ 0</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">levelOrder</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line"></span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    queue.add(root);</span><br><span class="line">    <span class="keyword">while</span> (!queue.isEmpty()) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> queue.size();<span class="comment">//size :ç›®çš„å°±æ˜¯ä¸ºäº†éå†æ¯ä¸€å±‚</span></span><br><span class="line">        List&lt;Integer&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">            <span class="type">TreeNode</span> <span class="variable">tmp</span> <span class="operator">=</span> queue.poll();</span><br><span class="line">            list.add(tmp.val);</span><br><span class="line">            <span class="keyword">if</span> (tmp.left != <span class="literal">null</span>) queue.add(tmp.left);</span><br><span class="line">            <span class="keyword">if</span> (tmp.right != <span class="literal">null</span>) queue.add(tmp.right);</span><br><span class="line">        &#125;</span><br><span class="line">        res.add(list);<span class="comment">//åŠ å…¥è¯¥å±‚éå†çš„æ•°æ®</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡-Offer-32-III-ä»ä¸Šåˆ°ä¸‹æ‰“å°äºŒå‰æ ‘-III"><a href="#å‰‘æŒ‡-Offer-32-III-ä»ä¸Šåˆ°ä¸‹æ‰“å°äºŒå‰æ ‘-III" class="headerlink" title="å‰‘æŒ‡ Offer 32 - III. ä»ä¸Šåˆ°ä¸‹æ‰“å°äºŒå‰æ ‘ III"></a>å‰‘æŒ‡ Offer 32 - III. ä»ä¸Šåˆ°ä¸‹æ‰“å°äºŒå‰æ ‘ III</h3><p>è¯·å®ç°ä¸€ä¸ªå‡½æ•°æŒ‰ç…§ä¹‹å­—å½¢é¡ºåºæ‰“å°äºŒå‰æ ‘ï¼Œå³ç¬¬ä¸€è¡ŒæŒ‰ç…§ä»å·¦åˆ°å³çš„é¡ºåºæ‰“å°ï¼Œç¬¬äºŒå±‚æŒ‰ç…§ä»å³åˆ°å·¦çš„é¡ºåºæ‰“å°ï¼Œç¬¬ä¸‰è¡Œå†æŒ‰ç…§ä»å·¦åˆ°å³çš„é¡ºåºæ‰“å°ï¼Œå…¶ä»–è¡Œä»¥æ­¤ç±»æ¨ã€‚</p><p>ä¾‹å¦‚:<br>ç»™å®šäºŒå‰æ ‘: <code>[3,9,20,null,null,15,7]</code>,</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  3</span><br><span class="line"> / \</span><br><span class="line">9  20</span><br><span class="line">  /  \</span><br><span class="line"> 15   7</span><br></pre></td></tr></table></figure><p>è¿”å›å…¶å±‚æ¬¡éå†ç»“æœï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  [3],</span><br><span class="line">  [20,9],</span><br><span class="line">  [15,7]</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ol><li><code>èŠ‚ç‚¹æ€»æ•° &lt;= 1000</code></li></ol><p>Related Topics</p><p>æ ‘</p><p>å¹¿åº¦ä¼˜å…ˆæœç´¢</p><p>äºŒå‰æ ‘</p><p>ğŸ‘ 259</p><p>ğŸ‘ 0</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong></p><p><strong>æ–¹æ³•ä¸€ï¼šå±‚åºéå† + é“¾è¡¨ï¼ˆåŒç«¯é˜Ÿåˆ—ï¼‰</strong></p><p>åˆ©ç”¨åŒç«¯é˜Ÿåˆ—çš„ä¸¤ç«¯çš†å¯æ·»åŠ å…ƒç´ çš„ç‰¹æ€§ï¼Œè®¾æ‰“å°åˆ—è¡¨ï¼ˆåŒç«¯é˜Ÿåˆ—ï¼‰ tmp ï¼Œå¹¶è§„å®šï¼š</p><ul><li>å¥‡æ•°å±‚ åˆ™æ·»åŠ è‡³ tmp å°¾éƒ¨ ï¼Œ</li><li>å¶æ•°å±‚ åˆ™æ·»åŠ è‡³ tmp å¤´éƒ¨ ã€‚</li></ul><p><strong>ç®—æ³•æµç¨‹</strong>ï¼š</p><ol><li>ç‰¹ä¾‹å¤„ç†ï¼š å½“æ ‘çš„æ ¹èŠ‚ç‚¹ä¸ºç©ºï¼Œåˆ™ç›´æ¥è¿”å›ç©ºåˆ—è¡¨ [] ï¼›</li><li>åˆå§‹åŒ–ï¼š æ‰“å°ç»“æœç©ºåˆ—è¡¨ res ï¼ŒåŒ…å«æ ¹èŠ‚ç‚¹çš„åŒç«¯é˜Ÿåˆ— deque ï¼›</li><li>BFS å¾ªç¯ï¼š å½“ deque ä¸ºç©ºæ—¶è·³å‡ºï¼›<ol><li>æ–°å»ºåˆ—è¡¨ tmp ï¼Œç”¨äºä¸´æ—¶å­˜å‚¨å½“å‰å±‚æ‰“å°ç»“æœï¼›</li><li>å½“å‰å±‚æ‰“å°å¾ªç¯ï¼š å¾ªç¯æ¬¡æ•°ä¸ºå½“å‰å±‚èŠ‚ç‚¹æ•°ï¼ˆå³ deque é•¿åº¦ï¼‰ï¼›<ol><li>å‡ºé˜Ÿï¼š é˜Ÿé¦–å…ƒç´ å‡ºé˜Ÿï¼Œè®°ä¸º nodeï¼›</li><li>æ‰“å°ï¼š è‹¥ä¸ºå¥‡æ•°å±‚ï¼Œå°† node.val æ·»åŠ è‡³ tmp å°¾éƒ¨ï¼›å¦åˆ™ï¼Œæ·»åŠ è‡³ tmp å¤´éƒ¨ï¼›</li><li>æ·»åŠ å­èŠ‚ç‚¹ï¼š è‹¥ node çš„å·¦ï¼ˆå³ï¼‰å­èŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œåˆ™åŠ å…¥ deque ï¼›</li></ol></li><li>å°†å½“å‰å±‚ç»“æœ tmp è½¬åŒ–ä¸º list å¹¶æ·»åŠ å…¥ res ï¼›</li></ol></li><li>è¿”å›å€¼ï¼š è¿”å›æ‰“å°ç»“æœåˆ—è¡¨ res å³å¯ï¼›</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">levelOrder</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    queue.add(root);</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;<span class="comment">//è®°å½•å½“å‰æ˜¯å¦åè½¬</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (!queue.isEmpty()) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> queue.size();</span><br><span class="line">        LinkedList&lt;Integer&gt; list = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">            <span class="type">TreeNode</span> <span class="variable">tmp</span> <span class="operator">=</span> queue.poll();</span><br><span class="line">            <span class="keyword">if</span>(res.size() % <span class="number">2</span> == <span class="number">0</span>) list.addLast(tmp.val);<span class="comment">//æ­£åº</span></span><br><span class="line">            <span class="keyword">else</span> list.addFirst(tmp.val);<span class="comment">//é€†åº</span></span><br><span class="line">            <span class="keyword">if</span> (tmp.left != <span class="literal">null</span>) queue.add(tmp.left);</span><br><span class="line">            <span class="keyword">if</span> (tmp.right != <span class="literal">null</span>) queue.add(tmp.right);</span><br><span class="line">        &#125;</span><br><span class="line">        res.add(list);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¤æ‚åº¦åˆ†æ</strong>ï¼š<br>æ—¶é—´å¤æ‚åº¦ O(N) ï¼š NN ä¸ºäºŒå‰æ ‘çš„èŠ‚ç‚¹æ•°é‡ï¼Œå³ BFS éœ€å¾ªç¯ N æ¬¡ï¼Œå ç”¨ O(N) ï¼›åŒç«¯é˜Ÿåˆ—çš„é˜Ÿé¦–å’Œé˜Ÿå°¾çš„æ·»åŠ å’Œåˆ é™¤æ“ä½œçš„æ—¶é—´å¤æ‚åº¦å‡ä¸º O(1) ã€‚<br>ç©ºé—´å¤æ‚åº¦ O(N) ï¼š æœ€å·®æƒ…å†µä¸‹ï¼Œå³å½“æ ‘ä¸ºæ»¡äºŒå‰æ ‘æ—¶ï¼Œæœ€å¤šæœ‰ N&#x2F;2 ä¸ªæ ‘èŠ‚ç‚¹ åŒæ—¶ åœ¨ deque ä¸­ï¼Œä½¿ç”¨ O(N) å¤§å°çš„é¢å¤–ç©ºé—´ã€‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211201233874.png" alt="image-20221120123322773"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">levelOrder</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">        Deque&lt;TreeNode&gt; deque = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">if</span>(root != <span class="literal">null</span>) deque.add(root);</span><br><span class="line">        <span class="keyword">while</span>(!deque.isEmpty()) &#123;</span><br><span class="line">            <span class="comment">// æ‰“å°å¥‡æ•°å±‚</span></span><br><span class="line">            List&lt;Integer&gt; tmp = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> deque.size(); i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">                <span class="comment">// ä»å·¦å‘å³æ‰“å°</span></span><br><span class="line">                <span class="type">TreeNode</span> <span class="variable">node</span> <span class="operator">=</span> deque.removeFirst();</span><br><span class="line">                tmp.add(node.val);</span><br><span class="line">                <span class="comment">// å…ˆå·¦åå³åŠ å…¥ä¸‹å±‚èŠ‚ç‚¹</span></span><br><span class="line">                <span class="keyword">if</span>(node.left != <span class="literal">null</span>) deque.addLast(node.left);</span><br><span class="line">                <span class="keyword">if</span>(node.right != <span class="literal">null</span>) deque.addLast(node.right);</span><br><span class="line">            &#125;</span><br><span class="line">            res.add(tmp);</span><br><span class="line">            <span class="keyword">if</span>(deque.isEmpty()) <span class="keyword">break</span>; <span class="comment">// è‹¥ä¸ºç©ºåˆ™æå‰è·³å‡º</span></span><br><span class="line">            <span class="comment">// æ‰“å°å¶æ•°å±‚</span></span><br><span class="line">            tmp = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> deque.size(); i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">                <span class="comment">// ä»å³å‘å·¦æ‰“å°</span></span><br><span class="line">                <span class="type">TreeNode</span> <span class="variable">node</span> <span class="operator">=</span> deque.removeLast();</span><br><span class="line">                tmp.add(node.val);</span><br><span class="line">                <span class="comment">// å…ˆå³åå·¦åŠ å…¥ä¸‹å±‚èŠ‚ç‚¹</span></span><br><span class="line">                <span class="keyword">if</span>(node.right != <span class="literal">null</span>) deque.addFirst(node.right);</span><br><span class="line">                <span class="keyword">if</span>(node.left != <span class="literal">null</span>) deque.addFirst(node.left);</span><br><span class="line">            &#125;</span><br><span class="line">            res.add(tmp);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211201235563.png" alt="image-20221120123516475"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">levelOrder</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">        Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">if</span>(root != <span class="literal">null</span>) queue.add(root);</span><br><span class="line">        <span class="keyword">while</span>(!queue.isEmpty()) &#123;</span><br><span class="line">            List&lt;Integer&gt; tmp = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> queue.size(); i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">                <span class="type">TreeNode</span> <span class="variable">node</span> <span class="operator">=</span> queue.poll();</span><br><span class="line">                tmp.add(node.val);</span><br><span class="line">                <span class="keyword">if</span>(node.left != <span class="literal">null</span>) queue.add(node.left);</span><br><span class="line">                <span class="keyword">if</span>(node.right != <span class="literal">null</span>) queue.add(node.right);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(res.size() % <span class="number">2</span> == <span class="number">1</span>) Collections.reverse(tmp);</span><br><span class="line">            res.add(tmp);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡-Offer-34-äºŒå‰æ ‘ä¸­å’Œä¸ºæŸä¸€å€¼çš„è·¯å¾„"><a href="#å‰‘æŒ‡-Offer-34-äºŒå‰æ ‘ä¸­å’Œä¸ºæŸä¸€å€¼çš„è·¯å¾„" class="headerlink" title="å‰‘æŒ‡ Offer 34. äºŒå‰æ ‘ä¸­å’Œä¸ºæŸä¸€å€¼çš„è·¯å¾„"></a>å‰‘æŒ‡ Offer 34. äºŒå‰æ ‘ä¸­å’Œä¸ºæŸä¸€å€¼çš„è·¯å¾„</h3><p>ç»™ä½ äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ <code>root</code> å’Œä¸€ä¸ªæ•´æ•°ç›®æ ‡å’Œ <code>targetSum</code> ï¼Œæ‰¾å‡ºæ‰€æœ‰ <strong>ä»æ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹</strong> è·¯å¾„æ€»å’Œç­‰äºç»™å®šç›®æ ‡å’Œçš„è·¯å¾„ã€‚</p><p><strong>å¶å­èŠ‚ç‚¹</strong> æ˜¯æŒ‡æ²¡æœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ã€‚</p><p><strong>ç¤ºä¾‹ 1ï¼š</strong></p><p><img src="https://assets.leetcode.com/uploads/2021/01/18/pathsumii1.jpg" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šroot = [5,4,8,11,null,13,4,7,2,null,null,5,1], targetSum = 22</span><br><span class="line">è¾“å‡ºï¼š[[5,4,11,2],[5,8,4,5]]</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2ï¼š</strong></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211211507250.jpeg" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šroot = [1,2,3], targetSum = 5</span><br><span class="line">è¾“å‡ºï¼š[]</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 3ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šroot = [1,2], targetSum = 0</span><br><span class="line">è¾“å‡ºï¼š[]</span><br></pre></td></tr></table></figure><p><strong>æç¤ºï¼š</strong></p><ul><li>æ ‘ä¸­èŠ‚ç‚¹æ€»æ•°åœ¨èŒƒå›´ <code>[0, 5000]</code> å†…</li><li><code>-1000 &lt;= Node.val &lt;= 1000</code></li><li><code>-1000 &lt;= targetSum &lt;= 1000</code></li></ul><p>æ³¨æ„ï¼šæœ¬é¢˜ä¸ä¸»ç«™ 113 é¢˜ç›¸åŒï¼š<a href="https://leetcode-cn.com/problems/path-sum-ii/">https://leetcode-cn.com/problems/path-sum-ii/</a></p><p>Related Topics</p><p>æ ‘</p><p>æ·±åº¦ä¼˜å…ˆæœç´¢</p><p>å›æº¯</p><p>äºŒå‰æ ‘</p><p>ğŸ‘ 381</p><p>ğŸ‘ 0</p><p><strong>è§£é¢˜æ€è·¯</strong>ï¼š</p><ol><li>ç¡®å®šé€’å½’å‡½æ•°çš„å‚æ•°å’Œè¿”å›ç±»å‹</li></ol><p>å‚æ•°ï¼šéœ€è¦äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œè¿˜éœ€è¦ä¸€ä¸ªè®¡æ•°å™¨ï¼Œè¿™ä¸ªè®¡æ•°å™¨ç”¨æ¥è®¡ç®—äºŒå‰æ ‘çš„ä¸€æ¡è¾¹ä¹‹å’Œæ˜¯å¦æ­£å¥½æ˜¯ç›®æ ‡å’Œï¼Œè®¡æ•°å™¨ä¸ºintå‹ã€‚</p><p>å†æ¥çœ‹è¿”å›å€¼ï¼Œé€’å½’å‡½æ•°ä»€ä¹ˆæ—¶å€™éœ€è¦è¿”å›å€¼ï¼Ÿä»€ä¹ˆæ—¶å€™ä¸éœ€è¦è¿”å›å€¼ï¼Ÿè¿™é‡Œæ€»ç»“å¦‚ä¸‹ä¸‰ç‚¹ï¼š</p><ul><li>å¦‚æœéœ€è¦æœç´¢æ•´æ£µäºŒå‰æ ‘ä¸”ä¸ç”¨å¤„ç†é€’å½’è¿”å›å€¼ï¼Œé€’å½’å‡½æ•°å°±ä¸è¦è¿”å›å€¼ã€‚ï¼ˆè¿™ç§æƒ…å†µå°±æ˜¯æœ¬æ–‡ä¸‹åŠéƒ¨åˆ†ä»‹ç»çš„113.è·¯å¾„æ€»å’Œiiï¼‰</li><li>å¦‚æœéœ€è¦æœç´¢æ•´æ£µäºŒå‰æ ‘ä¸”éœ€è¦å¤„ç†é€’å½’è¿”å›å€¼ï¼Œé€’å½’å‡½æ•°å°±éœ€è¦è¿”å›å€¼ã€‚ ï¼ˆè¿™ç§æƒ…å†µæˆ‘ä»¬åœ¨<a href="https://programmercarl.com/0236.%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88.html">236. äºŒå‰æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ (opens new window)</a>ä¸­ä»‹ç»ï¼‰</li><li>å¦‚æœè¦æœç´¢å…¶ä¸­ä¸€æ¡ç¬¦åˆæ¡ä»¶çš„è·¯å¾„ï¼Œé‚£ä¹ˆé€’å½’ä¸€å®šéœ€è¦è¿”å›å€¼ï¼Œå› ä¸ºé‡åˆ°ç¬¦åˆæ¡ä»¶çš„è·¯å¾„äº†å°±è¦åŠæ—¶è¿”å›ã€‚ï¼ˆæœ¬é¢˜çš„æƒ…å†µï¼‰</li></ul><p>è€Œæœ¬é¢˜æˆ‘ä»¬è¦æ‰¾ä¸€æ¡ç¬¦åˆæ¡ä»¶çš„è·¯å¾„ï¼Œæ‰€ä»¥é€’å½’å‡½æ•°éœ€è¦è¿”å›å€¼ï¼ŒåŠæ—¶è¿”å›ï¼Œé‚£ä¹ˆè¿”å›ç±»å‹æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>å¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202211211524855.png" alt="113.è·¯å¾„æ€»å’Œii"></p><p>å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œéå†çš„è·¯çº¿ï¼Œå¹¶ä¸è¦éå†æ•´æ£µæ ‘ï¼Œæ‰€ä»¥é€’å½’å‡½æ•°éœ€è¦è¿”å›å€¼ï¼Œå¯ä»¥ç”¨boolç±»å‹è¡¨ç¤ºã€‚</p><p>æ‰€ä»¥ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">traversal</span><span class="params">(TreeNode root, <span class="type">int</span> count)</span>   <span class="comment">// æ³¨æ„å‡½æ•°çš„è¿”å›ç±»å‹</span></span></span><br></pre></td></tr></table></figure><ol start="2"><li>ç¡®å®šç»ˆæ­¢æ¡ä»¶</li></ol><p>é¦–å…ˆè®¡æ•°å™¨å¦‚ä½•ç»Ÿè®¡è¿™ä¸€æ¡è·¯å¾„çš„å’Œå‘¢ï¼Ÿ</p><p>ä¸è¦å»ç´¯åŠ ç„¶ååˆ¤æ–­æ˜¯å¦ç­‰äºç›®æ ‡å’Œï¼Œé‚£ä¹ˆä»£ç æ¯”è¾ƒéº»çƒ¦ï¼Œå¯ä»¥ç”¨é€’å‡ï¼Œè®©è®¡æ•°å™¨countåˆå§‹ä¸ºç›®æ ‡å’Œï¼Œç„¶åæ¯æ¬¡å‡å»éå†è·¯å¾„èŠ‚ç‚¹ä¸Šçš„æ•°å€¼ã€‚</p><p>å¦‚æœæœ€åcount &#x3D;&#x3D; 0ï¼ŒåŒæ—¶åˆ°äº†å¶å­èŠ‚ç‚¹çš„è¯ï¼Œè¯´æ˜æ‰¾åˆ°äº†ç›®æ ‡å’Œã€‚</p><p>å¦‚æœéå†åˆ°äº†å¶å­èŠ‚ç‚¹ï¼Œcountä¸ä¸º0ï¼Œå°±æ˜¯æ²¡æ‰¾åˆ°ã€‚</p><p>é€’å½’ç»ˆæ­¢æ¡ä»¶ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (root.left == null &amp;&amp; root.right == null &amp;&amp; count == <span class="number">0</span>) &#123; <span class="comment">//åˆ°å¶å­èŠ‚ç‚¹ï¼Œå¹¶ä¸”æ‰¾åˆ°äº†åˆé€‚çš„è·¯å¾„</span></span><br><span class="line">    res.<span class="built_in">add</span>(<span class="keyword">new</span> ArrayList&lt;&gt;(path));</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (root.left == null &amp;&amp; root.right == null) &#123; <span class="comment">//åˆ°å¶å­èŠ‚ç‚¹ï¼Œæ²¡æœ‰åˆé€‚è·¯å¾„</span></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>ç¡®å®šå•å±‚é€’å½’çš„é€»è¾‘</li></ol><p>å› ä¸ºç»ˆæ­¢æ¡ä»¶æ˜¯åˆ¤æ–­å¶å­èŠ‚ç‚¹ï¼Œæ‰€ä»¥é€’å½’çš„è¿‡ç¨‹ä¸­å°±ä¸è¦è®©ç©ºèŠ‚ç‚¹è¿›å…¥é€’å½’äº†ã€‚</p><p>é€’å½’å‡½æ•°æ˜¯æœ‰è¿”å›å€¼çš„ï¼Œå¦‚æœé€’å½’å‡½æ•°è¿”å›trueï¼Œè¯´æ˜æ‰¾åˆ°äº†åˆé€‚çš„è·¯å¾„ï¼Œåº”è¯¥ç«‹åˆ»è¿”å›ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (root.left != null) &#123; <span class="comment">//å·¦å­©å­ä¸ä¸ºç©º æœç´¢å·¦å­æ ‘</span></span><br><span class="line">    path.<span class="built_in">add</span>(root.left.val);</span><br><span class="line">    <span class="built_in">traversal</span>(root.left, <span class="built_in">traversal</span>(root.right, count - root.right.val););</span><br><span class="line">    path.<span class="built_in">removeLast</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (root.right != null) &#123; <span class="comment">//å³å­©å­ä¸ä¸ºç©º æœç´¢å³å­æ ‘</span></span><br><span class="line">    path.<span class="built_in">add</span>(root.right.val);</span><br><span class="line">    <span class="built_in">traversal</span>(root.right, count - root.right.val);</span><br><span class="line">    path.<span class="built_in">removeLast</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šä»£ç ä¸­æ˜¯åŒ…å«ç€å›æº¯çš„ï¼Œæ²¡æœ‰å›æº¯ï¼Œå¦‚ä½•åæ’¤é‡æ–°æ‰¾å¦ä¸€æ¡è·¯å¾„å‘¢ã€‚</p><p>å›æº¯éšè—åœ¨<code>traversal(root.right, count - root.right.val);</code>è¿™é‡Œï¼Œ å› ä¸ºæŠŠ<code>root.right.val</code> ç›´æ¥ä½œä¸ºå‚æ•°ä¼ è¿›å»ï¼Œå‡½æ•°ç»“æŸï¼Œcountçš„æ•°å€¼æ²¡æœ‰æ”¹å˜ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">List&lt;List&lt;Integer&gt;&gt; res;</span><br><span class="line">LinkedList&lt;Integer&gt; path;</span><br><span class="line"><span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">pathSum</span><span class="params">(TreeNode root, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">    res = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    path = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) <span class="keyword">return</span> res;</span><br><span class="line">    path.add(root.val);</span><br><span class="line">    traversal(root, target - root.val);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">traversal</span><span class="params">(TreeNode root, <span class="type">int</span> count)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root.left == <span class="literal">null</span> &amp;&amp; root.right == <span class="literal">null</span> &amp;&amp; count == <span class="number">0</span>) &#123; <span class="comment">//åˆ°å¶å­èŠ‚ç‚¹ï¼Œå¹¶ä¸”æ‰¾åˆ°äº†åˆé€‚çš„è·¯å¾„</span></span><br><span class="line">        res.add(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(path));</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (root.left == <span class="literal">null</span> &amp;&amp; root.right == <span class="literal">null</span>) &#123; <span class="comment">//åˆ°å¶å­èŠ‚ç‚¹ï¼Œæ²¡æœ‰åˆé€‚è·¯å¾„</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (root.left != <span class="literal">null</span>) &#123; <span class="comment">//å·¦å­©å­ä¸ä¸ºç©º æœç´¢å·¦å­æ ‘</span></span><br><span class="line">        path.add(root.left.val);</span><br><span class="line">        traversal(root.left, count - root.left.val);</span><br><span class="line">        path.removeLast();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (root.right != <span class="literal">null</span>) &#123; <span class="comment">//å³å­©å­ä¸ä¸ºç©º æœç´¢å³å­æ ‘</span></span><br><span class="line">        path.add(root.right.val);</span><br><span class="line">        traversal(root.right, count - root.right.val);</span><br><span class="line">        path.removeLast();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡-Offer-36-äºŒå‰æœç´¢æ ‘ä¸åŒå‘é“¾è¡¨"><a href="#å‰‘æŒ‡-Offer-36-äºŒå‰æœç´¢æ ‘ä¸åŒå‘é“¾è¡¨" class="headerlink" title="å‰‘æŒ‡ Offer 36. äºŒå‰æœç´¢æ ‘ä¸åŒå‘é“¾è¡¨"></a>å‰‘æŒ‡ Offer 36. äºŒå‰æœç´¢æ ‘ä¸åŒå‘é“¾è¡¨</h3><p>è¾“å…¥ä¸€æ£µäºŒå‰æœç´¢æ ‘ï¼Œå°†è¯¥äºŒå‰æœç´¢æ ‘è½¬æ¢æˆä¸€ä¸ªæ’åºçš„å¾ªç¯åŒå‘é“¾è¡¨ã€‚è¦æ±‚ä¸èƒ½åˆ›å»ºä»»ä½•æ–°çš„èŠ‚ç‚¹ï¼Œåªèƒ½è°ƒæ•´æ ‘ä¸­èŠ‚ç‚¹æŒ‡é’ˆçš„æŒ‡å‘ã€‚</p><p>ä¸ºäº†è®©æ‚¨æ›´å¥½åœ°ç†è§£é—®é¢˜ï¼Œä»¥ä¸‹é¢çš„äºŒå‰æœç´¢æ ‘ä¸ºä¾‹ï¼š</p><p><img src="/%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/bstdlloriginalbst.png" alt="img"></p><p>æˆ‘ä»¬å¸Œæœ›å°†è¿™ä¸ªäºŒå‰æœç´¢æ ‘è½¬åŒ–ä¸ºåŒå‘å¾ªç¯é“¾è¡¨ã€‚é“¾è¡¨ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªå‰é©±å’Œåç»§æŒ‡é’ˆã€‚å¯¹äºåŒå‘å¾ªç¯é“¾è¡¨ï¼Œç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„å‰é©±æ˜¯æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œæœ€åä¸€ä¸ªèŠ‚ç‚¹çš„åç»§æ˜¯ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚</p><p>ä¸‹å›¾å±•ç¤ºäº†ä¸Šé¢çš„äºŒå‰æœç´¢æ ‘è½¬åŒ–æˆçš„é“¾è¡¨ã€‚â€œheadâ€ è¡¨ç¤ºæŒ‡å‘é“¾è¡¨ä¸­æœ‰æœ€å°å…ƒç´ çš„èŠ‚ç‚¹ã€‚</p><p><img src="/%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/bstdllreturndll.png" alt="img"></p><p>ç‰¹åˆ«åœ°ï¼Œæˆ‘ä»¬å¸Œæœ›å¯ä»¥å°±åœ°å®Œæˆè½¬æ¢æ“ä½œã€‚å½“è½¬åŒ–å®Œæˆä»¥åï¼Œæ ‘ä¸­èŠ‚ç‚¹çš„å·¦æŒ‡é’ˆéœ€è¦æŒ‡å‘å‰é©±ï¼Œæ ‘ä¸­èŠ‚ç‚¹çš„å³æŒ‡é’ˆéœ€è¦æŒ‡å‘åç»§ã€‚è¿˜éœ€è¦è¿”å›é“¾è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆã€‚</p><p><strong>æ³¨æ„ï¼š</strong>æœ¬é¢˜ä¸ä¸»ç«™ 426 é¢˜ç›¸åŒï¼š<a href="https://leetcode-cn.com/problems/convert-binary-search-tree-to-sorted-doubly-linked-list/">https://leetcode-cn.com/problems/convert-binary-search-tree-to-sorted-doubly-linked-list/</a></p><p><strong>æ³¨æ„ï¼š</strong>æ­¤é¢˜å¯¹æ¯”åŸé¢˜æœ‰æ”¹åŠ¨ã€‚</p><p>Related Topics</p><p>æ ˆ</p><p>æ ‘</p><p>æ·±åº¦ä¼˜å…ˆæœç´¢</p><p>äºŒå‰æœç´¢æ ‘</p><p>é“¾è¡¨</p><p>äºŒå‰æ ‘</p><p>åŒå‘é“¾è¡¨</p><p>ğŸ‘ 604</p><p>ğŸ‘ 0</p><p><strong>è§£é¢˜æ€è·¯ï¼š</strong></p><blockquote><p>äºŒå‰æœç´¢æ ‘çš„ä¸­åºéå†å¯ä»¥è½¬åŒ–ä¸ºé€’å¢åºåˆ—ã€‚</p></blockquote><p>ä¸‰ä¸ªæ­¥éª¤ï¼š</p><ol><li>æ’åºé“¾è¡¨ï¼š èŠ‚ç‚¹åº”ä»å°åˆ°å¤§æ’åºï¼Œå› æ­¤åº”ä½¿ç”¨ ä¸­åºéå† â€œä»å°åˆ°å¤§â€è®¿é—®æ ‘çš„èŠ‚ç‚¹ã€‚</li><li>åŒå‘é“¾è¡¨ï¼š åœ¨æ„å»ºç›¸é‚»èŠ‚ç‚¹çš„å¼•ç”¨å…³ç³»æ—¶ï¼Œè®¾å‰é©±èŠ‚ç‚¹ pre å’Œå½“å‰èŠ‚ç‚¹ cur ï¼Œä¸ä»…åº”æ„å»º pre.right &#x3D; cur ï¼Œä¹Ÿåº”æ„å»º cur.left &#x3D; pre ã€‚</li><li>å¾ªç¯é“¾è¡¨ï¼š è®¾é“¾è¡¨å¤´èŠ‚ç‚¹ head å’Œå°¾èŠ‚ç‚¹ tail ï¼Œåˆ™åº”æ„å»º head.left &#x3D; tail å’Œ tail.right &#x3D; head</li></ol><p><img src="/%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/1599401091-PKIjds-Picture1.png" alt="Picture1.png"></p><p>javaä¸­åºéå†ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ‰“å°ä¸­åºéå†</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">dfs</span><span class="params">(Node root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(root == <span class="literal">null</span>) <span class="keyword">return</span>;</span><br><span class="line">    dfs(root.left); <span class="comment">// å·¦</span></span><br><span class="line">    System.out.println(root.val); <span class="comment">// æ ¹</span></span><br><span class="line">    dfs(root.right); <span class="comment">// å³</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†éå†åˆ°ä¸­é—´èŠ‚ç‚¹ï¼ŒåŠ ä¸Šå¤„ç†èŠ‚ç‚¹é—´çš„æŒ‡å‘å…³ç³»ï¼Œå³æ„å»ºå½“å‰èŠ‚ç‚¹curå’Œå‰é©±èŠ‚ç‚¹preçš„å¼•ç”¨ï¼Œåœ¨ä¸­åºéå†å®Œæˆæ—¶ï¼Œæ„å»ºå¤´èŠ‚ç‚¹headå’Œå°¾èŠ‚ç‚¹tailçš„å…³ç³»ã€‚ä¸­åºéå†å®Œå,preå°±æ˜¯å°¾èŠ‚ç‚¹ã€‚</p><p><strong>ç®—æ³•æµç¨‹ï¼š</strong><br><code>dfs(cur):</code> é€’å½’æ³•ä¸­åºéå†ï¼›</p><ol><li>ç»ˆæ­¢æ¡ä»¶ï¼š å½“èŠ‚ç‚¹ cur ä¸ºç©ºï¼Œä»£è¡¨è¶Šè¿‡å¶èŠ‚ç‚¹ï¼Œç›´æ¥è¿”å›ï¼›</li><li>é€’å½’å·¦å­æ ‘ï¼Œå³ dfs(cur.left) ï¼›</li><li>æ„å»ºé“¾è¡¨ï¼š<ul><li>å½“ pre ä¸ºç©ºæ—¶ï¼š ä»£è¡¨æ­£åœ¨è®¿é—®é“¾è¡¨å¤´èŠ‚ç‚¹ï¼Œè®°ä¸º head ï¼›</li><li>å½“ pre ä¸ä¸ºç©ºæ—¶ï¼š ä¿®æ”¹åŒå‘èŠ‚ç‚¹å¼•ç”¨ï¼Œå³ pre.right &#x3D; cur ï¼Œ cur.left &#x3D; pre ï¼›</li><li>ä¿å­˜ cur ï¼š æ›´æ–° pre &#x3D; cur ï¼Œå³èŠ‚ç‚¹ cur æ˜¯åç»§èŠ‚ç‚¹çš„ pre ï¼›</li></ul></li><li>é€’å½’å³å­æ ‘ï¼Œå³ dfs(cur.right) ï¼›</li></ol><p><code>treeToDoublyList(root)</code>ï¼š</p><ol><li>ç‰¹ä¾‹å¤„ç†ï¼š è‹¥èŠ‚ç‚¹ root ä¸ºç©ºï¼Œåˆ™ç›´æ¥è¿”å›ï¼›</li><li>åˆå§‹åŒ–ï¼š ç©ºèŠ‚ç‚¹ pre ï¼›</li><li>è½¬åŒ–ä¸ºåŒå‘é“¾è¡¨ï¼š è°ƒç”¨ dfs(root) ï¼›</li><li>æ„å»ºå¾ªç¯é“¾è¡¨ï¼š ä¸­åºéå†å®Œæˆåï¼Œhead æŒ‡å‘å¤´èŠ‚ç‚¹ï¼Œ pre æŒ‡å‘å°¾èŠ‚ç‚¹ï¼Œå› æ­¤ä¿®æ”¹ head å’Œ pre çš„åŒå‘èŠ‚ç‚¹å¼•ç”¨å³å¯ï¼›</li><li>è¿”å›å€¼ï¼š è¿”å›é“¾è¡¨çš„å¤´èŠ‚ç‚¹ head å³å¯ï¼›</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Node pre, head;</span><br><span class="line"><span class="keyword">public</span> Node <span class="title function_">treeToDoublyList</span><span class="params">(Node root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">null</span>;<span class="comment">//ç‰¹æ®Š è¿”å›</span></span><br><span class="line">    dfs(root);<span class="comment">//ä¸­åºéå† æ„å»ºé“¾è¡¨</span></span><br><span class="line">    <span class="comment">// ä¸­åºéå†å®Œåï¼Œå¤„ç†å¤´èŠ‚ç‚¹å’Œå°¾èŠ‚ç‚¹</span></span><br><span class="line">    head.left = pre;</span><br><span class="line">    pre.right = head;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">dfs</span><span class="params">(Node cur)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (cur == <span class="literal">null</span>) &#123; <span class="comment">//ç©ºèŠ‚ç‚¹ ä¸å¤„ç†</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(cur.left); <span class="comment">//å·¦å­æ ‘</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//ä¸­é—´å¤„ç†é€»è¾‘</span></span><br><span class="line">    <span class="keyword">if</span> (pre != <span class="literal">null</span>) &#123; <span class="comment">//å…¶ä»–èŠ‚ç‚¹</span></span><br><span class="line">        pre.right = cur;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; <span class="comment">// pre == null å¤´èŠ‚ç‚¹</span></span><br><span class="line">        head = cur;</span><br><span class="line">    &#125;</span><br><span class="line">    cur.left = pre;</span><br><span class="line">    pre = cur;</span><br><span class="line"></span><br><span class="line">    dfs(cur.right);<span class="comment">//å³å­æ ‘</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¤æ‚åº¦åˆ†æ</strong>ï¼š</p><ul><li>æ—¶é—´å¤æ‚åº¦ O(N) ï¼š N ä¸ºäºŒå‰æ ‘çš„èŠ‚ç‚¹æ•°ï¼Œä¸­åºéå†éœ€è¦è®¿é—®æ‰€æœ‰èŠ‚ç‚¹ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ O(N) ï¼š æœ€å·®æƒ…å†µä¸‹ï¼Œå³æ ‘é€€åŒ–ä¸ºé“¾è¡¨æ—¶ï¼Œé€’å½’æ·±åº¦è¾¾åˆ° Nï¼Œç³»ç»Ÿä½¿ç”¨O(N) æ ˆç©ºé—´ã€‚</li></ul><h3 id="å‰‘æŒ‡-Offer-37-åºåˆ—åŒ–äºŒå‰æ ‘"><a href="#å‰‘æŒ‡-Offer-37-åºåˆ—åŒ–äºŒå‰æ ‘" class="headerlink" title="å‰‘æŒ‡ Offer 37. åºåˆ—åŒ–äºŒå‰æ ‘"></a>å‰‘æŒ‡ Offer 37. åºåˆ—åŒ–äºŒå‰æ ‘</h3><p>è¯·å®ç°ä¸¤ä¸ªå‡½æ•°ï¼Œåˆ†åˆ«ç”¨æ¥åºåˆ—åŒ–å’Œååºåˆ—åŒ–äºŒå‰æ ‘ã€‚</p><p>ä½ éœ€è¦è®¾è®¡ä¸€ä¸ªç®—æ³•æ¥å®ç°äºŒå‰æ ‘çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ã€‚è¿™é‡Œä¸é™å®šä½ çš„åºåˆ— &#x2F; ååºåˆ—åŒ–ç®—æ³•æ‰§è¡Œé€»è¾‘ï¼Œä½ åªéœ€è¦ä¿è¯ä¸€ä¸ªäºŒå‰æ ‘å¯ä»¥è¢«åºåˆ—åŒ–ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²å¹¶ä¸”å°†è¿™ä¸ªå­—ç¬¦ä¸²ååºåˆ—åŒ–ä¸ºåŸå§‹çš„æ ‘ç»“æ„ã€‚</p><p><strong>æç¤ºï¼š</strong>è¾“å…¥è¾“å‡ºæ ¼å¼ä¸ LeetCode ç›®å‰ä½¿ç”¨çš„æ–¹å¼ä¸€è‡´ï¼Œè¯¦æƒ…è¯·å‚é˜… <a href="https://support.leetcode-cn.com/hc/kb/article/1567641/">LeetCode åºåˆ—åŒ–äºŒå‰æ ‘çš„æ ¼å¼</a>ã€‚ä½ å¹¶éå¿…é¡»é‡‡å–è¿™ç§æ–¹å¼ï¼Œä½ ä¹Ÿå¯ä»¥é‡‡ç”¨å…¶ä»–çš„æ–¹æ³•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p><strong>ç¤ºä¾‹ï¼š</strong></p><p><img src="/%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/serdeser.jpg" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šroot = [1,2,3,null,null,4,5]</span><br><span class="line">è¾“å‡ºï¼š[1,2,3,null,null,4,5]</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šæœ¬é¢˜ä¸ä¸»ç«™ 297 é¢˜ç›¸åŒï¼š<a href="https://leetcode-cn.com/problems/serialize-and-deserialize-binary-tree/">https://leetcode-cn.com/problems/serialize-and-deserialize-binary-tree/</a></p><p>Related Topics</p><p>æ ‘</p><p>æ·±åº¦ä¼˜å…ˆæœç´¢</p><p>å¹¿åº¦ä¼˜å…ˆæœç´¢</p><p>è®¾è®¡</p><p>å­—ç¬¦ä¸²</p><p>äºŒå‰æ ‘</p><p>ğŸ‘ 360</p><p>ğŸ‘ 0</p><p><strong>å¯¹åºåˆ—åŒ–çš„ç†è§£</strong>ï¼š</p><p>é€šå¸¸ä½¿ç”¨çš„å‰åºã€ä¸­åºã€ååºã€å±‚åºéå†è®°å½•çš„äºŒå‰æ ‘çš„ä¿¡æ¯ä¸å®Œæ•´ï¼Œä¸€ç§è¾“å‡ºåºåˆ—å¯èƒ½å¯¹åº”ç€å¤šç§äºŒå‰æ ‘å¯èƒ½æ€§ã€‚é¢˜ç›®è¦æ±‚çš„ åºåˆ—åŒ– å’Œ ååºåˆ—åŒ– æ˜¯ å¯é€†æ“ä½œ ã€‚å› æ­¤ï¼Œåºåˆ—åŒ–çš„å­—ç¬¦ä¸²åº”æºå¸¦ å®Œæ•´çš„äºŒå‰æ ‘ä¿¡æ¯ ã€‚</p><p><strong>è§£é¢˜æ€è·¯</strong>ï¼š</p><p>è§‚å¯Ÿé¢˜ç›®ç¤ºä¾‹ï¼Œåºåˆ—åŒ–çš„å­—ç¬¦ä¸²å®é™…ä¸Šæ˜¯äºŒå‰æ ‘çš„ â€œå±‚åºéå†â€ï¼ˆBFSï¼‰ç»“æœï¼Œåªä¸è¿‡æŠŠnullå€¼ä¹Ÿè¾“å‡ºäº†ã€‚</p><p>ä¸ºå®Œæ•´è¡¨ç¤ºäºŒå‰æ ‘ï¼Œè€ƒè™‘å°†å¶èŠ‚ç‚¹ä¸‹çš„ null ä¹Ÿè®°å½•ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œå¯¹äºåˆ—è¡¨ä¸­ä»»æ„æŸèŠ‚ç‚¹ node ï¼Œå…¶å·¦å­èŠ‚ç‚¹ node.left å’Œå³å­èŠ‚ç‚¹ node.right åœ¨åºåˆ—ä¸­çš„ä½ç½®éƒ½æ˜¯ å”¯ä¸€ç¡®å®š çš„ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/1603117385-ehAGsP-Picture1.png" alt="Picture1.png"></p><p>è§„å¾‹å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><p><img src="/%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/image-20221122100451955-16690827032166.png" alt="image-20221122100451955"></p><p><strong>åŒºåˆ«äºå®Œå…¨äºŒå‰æ ‘çš„ç´¢å¼•è§„åˆ™ï¼ŒnullèŠ‚ç‚¹ä¸åœ¨å‘ä¸‹è®°å½•ç´¢å¼•ï¼Œæ‰€ä»¥ç´¢å¼•çš„è§„å¾‹å¦‚ä¸‹æ‰€ç¤º</strong>ï¼š</p><p>è®¾ mä¸ºåˆ—è¡¨åŒºé—´ [0, n]ä¸­çš„ <code>null</code> èŠ‚ç‚¹ä¸ªæ•°ï¼Œåˆ™å¯æ€»ç»“å‡ºæ ¹èŠ‚ç‚¹ã€å·¦å­èŠ‚ç‚¹ã€å³å­èŠ‚ç‚¹çš„åˆ—è¡¨ç´¢å¼•çš„é€’æ¨å…¬å¼ï¼š</p><p><img src="/%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/image-20221122100713320.png" alt="image-20221122100713320"></p><p>åºåˆ—åŒ– ä½¿ç”¨å±‚åºéå†å®ç°ã€‚ååºåˆ—åŒ– é€šè¿‡ä»¥ä¸Šé€’æ¨å…¬å¼åæ¨å„èŠ‚ç‚¹åœ¨åºåˆ—ä¸­çš„ç´¢å¼•ï¼Œè¿›è€Œå®ç°ã€‚</p><p><code>åºåˆ—åŒ– Serialize </code>ï¼š<br>å€ŸåŠ©é˜Ÿåˆ—ï¼Œå¯¹äºŒå‰æ ‘åšå±‚åºéå†ï¼Œå¹¶å°†è¶Šè¿‡å¶èŠ‚ç‚¹çš„ null ä¹Ÿæ‰“å°å‡ºæ¥ã€‚</p><p><strong>ç®—æ³•æµç¨‹</strong>ï¼š</p><ol><li>ç‰¹ä¾‹å¤„ç†ï¼š è‹¥ root ä¸ºç©ºï¼Œåˆ™ç›´æ¥è¿”å›ç©ºåˆ—è¡¨ â€œ[]â€ ï¼›</li><li>åˆå§‹åŒ–ï¼š é˜Ÿåˆ— queue ï¼ˆåŒ…å«æ ¹èŠ‚ç‚¹ root ï¼‰ï¼›åºåˆ—åŒ–åˆ—è¡¨ res ï¼›</li><li>å±‚åºéå†ï¼š å½“ queue ä¸ºç©ºæ—¶è·³å‡ºï¼›<ol><li>èŠ‚ç‚¹å‡ºé˜Ÿï¼Œè®°ä¸º node ï¼›</li><li>è‹¥ node ä¸ä¸ºç©ºï¼šâ‘  æ‰“å°å­—ç¬¦ä¸² node.val ï¼Œâ‘¡ å°†å·¦ã€å³å­èŠ‚ç‚¹åŠ å…¥ queue ï¼›</li><li>å¦åˆ™ï¼ˆè‹¥ node ä¸ºç©ºï¼‰ï¼šæ‰“å°å­—ç¬¦ä¸² â€œnullâ€ ï¼›</li></ol></li><li>è¿”å›å€¼ï¼š æ‹¼æ¥åˆ—è¡¨ï¼Œç”¨ â€˜,â€™ éš”å¼€ï¼Œé¦–å°¾æ·»åŠ ä¸­æ‹¬å·ï¼›</li></ol><p><strong>å¤æ‚åº¦åˆ†æ</strong>ï¼š</p><ul><li>æ—¶é—´å¤æ‚åº¦ O(N)ï¼š N ä¸ºäºŒå‰æ ‘çš„èŠ‚ç‚¹æ•°ï¼Œå±‚åºéå†éœ€è¦è®¿é—®æ‰€æœ‰èŠ‚ç‚¹ï¼Œæœ€å·®æƒ…å†µä¸‹éœ€è¦è®¿é—® N + 1 ä¸ª null ï¼Œæ€»ä½“å¤æ‚åº¦ä¸º O(2N + 1) &#x3D; O(N)</li><li>ç©ºé—´å¤æ‚åº¦ O(N)ï¼š æœ€å·®æƒ…å†µä¸‹ï¼Œé˜Ÿåˆ— queue åŒæ—¶å­˜å‚¨ N+1&#x2F;2ä¸ªèŠ‚ç‚¹ï¼ˆæˆ– N+1ä¸ª null ï¼‰ï¼Œä½¿ç”¨ O(N)ï¼›åˆ—è¡¨ res ä½¿ç”¨ O(N)</li></ul><p><img src="/%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/1603117385-ZrhoFK-Picture5.png" alt="img"></p><p><code>ååºåˆ—åŒ– Deserialize</code> ï¼š<br>åŸºäºæœ¬æ–‡å¼€å§‹æ¨å‡ºçš„ node , node.left , node.right åœ¨åºåˆ—åŒ–åˆ—è¡¨ä¸­çš„ä½ç½®å…³ç³»ï¼Œå¯å®ç°ååºåˆ—åŒ–ã€‚</p><p>åˆ©ç”¨é˜Ÿåˆ—æŒ‰å±‚æ„å»ºäºŒå‰æ ‘ï¼Œå€ŸåŠ©ä¸€ä¸ªæŒ‡é’ˆ i æŒ‡å‘èŠ‚ç‚¹ node çš„å·¦ã€å³å­èŠ‚ç‚¹ï¼Œæ¯æ„å»ºä¸€ä¸ª node çš„å·¦ã€å³å­èŠ‚ç‚¹ï¼ŒæŒ‡é’ˆ i å°±å‘å³ç§»åŠ¨ 1 ä½ã€‚</p><p><strong>ç®—æ³•æµç¨‹ï¼š</strong></p><ol><li>ç‰¹ä¾‹å¤„ç†ï¼š è‹¥ data ä¸ºç©ºï¼Œç›´æ¥è¿”å› null ï¼›</li><li>åˆå§‹åŒ–ï¼š åºåˆ—åŒ–åˆ—è¡¨ vals ï¼ˆå…ˆå»æ‰é¦–å°¾ä¸­æ‹¬å·ï¼Œå†ç”¨é€—å·éš”å¼€ï¼‰ï¼ŒæŒ‡é’ˆ i &#x3D; 1 ï¼Œæ ¹èŠ‚ç‚¹ root ï¼ˆå€¼ä¸º vals[0] ï¼‰ï¼Œé˜Ÿåˆ— queueï¼ˆåŒ…å« root ï¼‰ï¼›</li><li>æŒ‰å±‚æ„å»ºï¼š å½“ queue ä¸ºç©ºæ—¶è·³å‡ºï¼›<ol><li>èŠ‚ç‚¹å‡ºé˜Ÿï¼Œè®°ä¸º node ï¼›</li><li>æ„å»º node çš„å·¦å­èŠ‚ç‚¹ï¼šnode.left çš„å€¼ä¸º vals[i] ï¼Œå¹¶å°† node.left å…¥é˜Ÿï¼›</li><li>æ‰§è¡Œ i +&#x3D; 1 ï¼›</li><li>æ„å»º node çš„å³å­èŠ‚ç‚¹ï¼šnode.right çš„å€¼ä¸º vals[i] ï¼Œå¹¶å°† node.right å…¥é˜Ÿï¼›</li><li>æ‰§è¡Œ i +&#x3D; 1 ï¼›</li></ol></li><li>è¿”å›å€¼ï¼š è¿”å›æ ¹èŠ‚ç‚¹ root å³å¯ï¼›</li></ol><p><strong>å¤æ‚åº¦åˆ†æ</strong>ï¼š</p><ul><li>æ—¶é—´å¤æ‚åº¦ O(N) ï¼š N ä¸ºäºŒå‰æ ‘çš„èŠ‚ç‚¹æ•°ï¼ŒæŒ‰å±‚æ„å»ºäºŒå‰æ ‘éœ€è¦éå†æ•´ä¸ªvals ï¼Œå…¶é•¿åº¦æœ€å¤§ä¸º 2N+1 ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ O(N) ï¼š æœ€å·®æƒ…å†µä¸‹ï¼Œé˜Ÿåˆ— queue åŒæ—¶å­˜å‚¨ n+1&#x2F;2ä¸ªèŠ‚ç‚¹ï¼Œå› æ­¤ä½¿ç”¨ O(N) é¢å¤–ç©ºé—´ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Encodes a tree to a single string.</span></span><br><span class="line"><span class="comment">// åºåˆ—åŒ–äºŒå‰æ ‘</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">serialize</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) <span class="keyword">return</span> <span class="string">&quot;[]&quot;</span>;</span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">res</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(<span class="string">&quot;[&quot;</span>);</span><br><span class="line">    Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    queue.add(root);<span class="comment">// åŠ å…¥å¤´èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">while</span> (!queue.isEmpty()) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> queue.size();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">            <span class="type">TreeNode</span> <span class="variable">tmp</span> <span class="operator">=</span> queue.poll();</span><br><span class="line">            <span class="keyword">if</span> (tmp != <span class="literal">null</span>) &#123;</span><br><span class="line">                res.append(tmp.val).append(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">                <span class="comment">// ä¹‹å‰BFSæ˜¯è·³è¿‡ç©ºèŠ‚ç‚¹çš„</span></span><br><span class="line">                queue.add(tmp.left);</span><br><span class="line">                queue.add(tmp.right);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                res.append(<span class="string">&quot;null,&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    res.deleteCharAt(res.length() - <span class="number">1</span>);<span class="comment">// åˆ é™¤æœ€åä¸€ä¸ª&quot;,&quot;</span></span><br><span class="line">    res.append(<span class="string">&quot;]&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> res.toString();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Decodes your encoded data to tree.</span></span><br><span class="line"><span class="comment">// ååºåˆ—åŒ–</span></span><br><span class="line"><span class="keyword">public</span> TreeNode <span class="title function_">deserialize</span><span class="params">(String data)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (data.equals(<span class="string">&quot;[]&quot;</span>)) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    String[] vals = data.substring(<span class="number">1</span>, data.length() - <span class="number">1</span>).split(<span class="string">&quot;,&quot;</span>); <span class="comment">// åˆ‡æ‰[] å’Œ,</span></span><br><span class="line">    Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    <span class="type">TreeNode</span> <span class="variable">root</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeNode</span>(Integer.parseInt(vals[<span class="number">0</span>]));</span><br><span class="line">    queue.add(root);</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (!queue.isEmpty()) &#123;</span><br><span class="line">        <span class="comment">// ä¸å¼ºè°ƒåˆ†å±‚çš„è¯ å¯ä»¥ä¸ç”¨sizeéå†</span></span><br><span class="line">        <span class="type">TreeNode</span> <span class="variable">tmp</span> <span class="operator">=</span> queue.poll();</span><br><span class="line">        <span class="keyword">if</span> (!vals[i].equals(<span class="string">&quot;null&quot;</span>)) &#123; <span class="comment">// å¤„ç†å·¦èŠ‚ç‚¹</span></span><br><span class="line">            tmp.left = <span class="keyword">new</span> <span class="title class_">TreeNode</span>(Integer.parseInt(vals[i]));</span><br><span class="line">            queue.add(tmp.left);</span><br><span class="line">        &#125;</span><br><span class="line">        i++;</span><br><span class="line">        <span class="keyword">if</span> (!vals[i].equals(<span class="string">&quot;null&quot;</span>)) &#123; <span class="comment">// å¤„ç†å³èŠ‚ç‚¹</span></span><br><span class="line">            tmp.right = <span class="keyword">new</span> <span class="title class_">TreeNode</span>(Integer.parseInt(vals[i]));</span><br><span class="line">            queue.add(tmp.right);</span><br><span class="line">        &#125;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡-Offer-38-å­—ç¬¦ä¸²çš„æ’åˆ—"><a href="#å‰‘æŒ‡-Offer-38-å­—ç¬¦ä¸²çš„æ’åˆ—" class="headerlink" title="å‰‘æŒ‡ Offer 38. å­—ç¬¦ä¸²çš„æ’åˆ—"></a>å‰‘æŒ‡ Offer 38. å­—ç¬¦ä¸²çš„æ’åˆ—</h3><p>è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ‰“å°å‡ºè¯¥å­—ç¬¦ä¸²ä¸­å­—ç¬¦çš„æ‰€æœ‰æ’åˆ—ã€‚</p><p>ä½ å¯ä»¥ä»¥ä»»æ„é¡ºåºè¿”å›è¿™ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œä½†é‡Œé¢ä¸èƒ½æœ‰é‡å¤å…ƒç´ ã€‚</p><p><strong>ç¤ºä¾‹:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šs = &quot;abc&quot;</span><br><span class="line">è¾“å‡ºï¼š[&quot;abc&quot;,&quot;acb&quot;,&quot;bac&quot;,&quot;bca&quot;,&quot;cab&quot;,&quot;cba&quot;]</span><br></pre></td></tr></table></figure><p><strong>é™åˆ¶ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1 &lt;= s çš„é•¿åº¦ &lt;= 8</span><br></pre></td></tr></table></figure><p>Related Topics</p><p>å­—ç¬¦ä¸²</p><p>å›æº¯</p><p>ğŸ‘ 617</p><p>ğŸ‘ 0</p><p>è§£é¢˜æ€è·¯ï¼š</p><p><img src="/images/%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/image-20221123155128395.png" alt="image-20221123155128395"></p><p>æ•´ä½“ä¸Šæ˜¯æŠŠå®ƒçœ‹æˆä¸€ä¸ªå®Œå…¨äºŒå‰æ ‘æ¥è§„å®šè¯¥å­—ç¬¦é€‰è¿˜æ˜¯ä¸é€‰ã€‚æ•´ä½“çš„ç»“æ„æ˜¯ä¸€ä¸ªæ’åˆ—æ ‘ï¼ˆç»“æœä¸é¡ºåºæœ‰å…³ï¼‰ï¼Œæ‰€ä»¥éå†æ—¶è¦ä»å¤´éå†ï¼Œéå†è¿‡ç¨‹ä¸­ç”¨usedæ•°ç»„è¿›è¡Œè®°å½•ã€‚å› ä¸ºæœ‰å¯èƒ½ä¼šæœ‰é‡å¤ç»“æœï¼Œè¿™é‡Œç”¨HashSetè¿›è¡Œå»é‡ã€‚</p><ol><li>å½“æœç´¢åˆ°å¶å­èŠ‚ç‚¹å°±è¿›è¡Œè®°å½•ã€‚æ‰¾åˆ°äº†ä¸€ä¸ªç»“æœï¼ŒåŠ å…¥åˆ°setä¸­ã€‚</li><li>éå†æ—¶ï¼Œé€šè¿‡usedæ•°ç»„è¿›è¡Œå‰ªæã€‚</li></ol><p>code:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Set&lt;String&gt; res; <span class="comment">// è®°å½•ç»“æœé›† é¡ºä¾¿ç”¨HashSetå»é‡</span></span><br><span class="line">StringBuilder path; <span class="comment">// è·¯å¾„ ç”¨StringBuilder</span></span><br><span class="line"><span class="keyword">public</span> String[] permutation(String s) &#123;</span><br><span class="line">    <span class="type">char</span>[] chars = s.toCharArray();</span><br><span class="line">    res = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">    path = <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    <span class="type">boolean</span>[] used = <span class="keyword">new</span> <span class="title class_">boolean</span>[s.length()];<span class="comment">// è®°å½•æœ‰æ²¡æœ‰éå†è¿‡</span></span><br><span class="line">    backtracking(chars, used);</span><br><span class="line">    <span class="keyword">return</span> res.toArray(<span class="keyword">new</span> <span class="title class_">String</span>[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">backtracking</span><span class="params">(<span class="type">char</span>[] chars, <span class="type">boolean</span>[] used)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (path.length() == chars.length) &#123; <span class="comment">// å·²ç»æœç´¢åˆ°æ ¹äº†ï¼Œè®°å½•</span></span><br><span class="line">        res.add(path.toString());</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; chars.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!used[i]) &#123;</span><br><span class="line">            path.append(chars[i]);</span><br><span class="line">            used[i] = <span class="literal">true</span>;</span><br><span class="line">            backtracking(chars, used);</span><br><span class="line">            used[i] = <span class="literal">false</span>;</span><br><span class="line">            path.deleteCharAt(path.length() - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡-Offer-54-äºŒå‰æœç´¢æ ‘çš„ç¬¬-k-å¤§èŠ‚ç‚¹"><a href="#å‰‘æŒ‡-Offer-54-äºŒå‰æœç´¢æ ‘çš„ç¬¬-k-å¤§èŠ‚ç‚¹" class="headerlink" title="å‰‘æŒ‡ Offer 54. äºŒå‰æœç´¢æ ‘çš„ç¬¬ k å¤§èŠ‚ç‚¹"></a>å‰‘æŒ‡ Offer 54. äºŒå‰æœç´¢æ ‘çš„ç¬¬ k å¤§èŠ‚ç‚¹</h3><p>ç»™å®šä¸€æ£µäºŒå‰æœç´¢æ ‘ï¼Œè¯·æ‰¾å‡ºå…¶ä¸­ç¬¬ <code>k</code> å¤§çš„èŠ‚ç‚¹çš„å€¼ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: root = [3,1,4,null,2], k = 1</span><br><span class="line">   3</span><br><span class="line">  / \</span><br><span class="line"> 1   4</span><br><span class="line">  \</span><br><span class="line">   2</span><br><span class="line">è¾“å‡º: 4</span><br></pre></td></tr></table></figure><p><strong>ç¤ºä¾‹ 2:</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: root = [5,3,6,2,4,null,null,1], k = 3</span><br><span class="line">       5</span><br><span class="line">      / \</span><br><span class="line">     3   6</span><br><span class="line">    / \</span><br><span class="line">   2   4</span><br><span class="line">  /</span><br><span class="line"> 1</span><br><span class="line">è¾“å‡º: 4</span><br></pre></td></tr></table></figure><p><strong>é™åˆ¶ï¼š</strong></p><ul><li>1 â‰¤ k â‰¤ äºŒå‰æœç´¢æ ‘å…ƒç´ ä¸ªæ•°</li></ul><p>Related Topics</p><p>æ ‘</p><p>æ·±åº¦ä¼˜å…ˆæœç´¢</p><p>äºŒå‰æœç´¢æ ‘</p><p>äºŒå‰æ ‘</p><p>ğŸ‘ 344</p><p>ğŸ‘ 0</p><p><strong>è§£é¢˜æ€è·¯</strong>ï¼š</p><p>è¦çŸ¥é“äºŒå‰æœç´¢æ ‘çš„æ€§è´¨ï¼Œå³ä¸­åºéå†æ˜¯ä¸€ä¸ªæœ‰åºçš„é›†åˆ,é¡ºåºæ˜¯å‡åºçš„ï¼Œé™åºçš„è¯å°±æ˜¯é€†å‘çš„ä¸­åºéå†ã€‚</p><ol><li>éå†é¡ºåºï¼šé‡‡ç”¨é€†å‘ä¸­åºéå†ã€‚åœ¨ä¸­é—´èŠ‚ç‚¹è®©è®°å½•å½“å‰çš„éå†æ¬¡æ•°countâ€“</li><li>ç»ˆæ­¢æ¡ä»¶ï¼šcount&#x3D;0ï¼Œå³æ‰¾åˆ°äº†å½“å‰ç¬¬kå¤§çš„æ•°ï¼Œè¿”å›</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> res;</span><br><span class="line"><span class="type">int</span> count;</span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">kthLargest</span><span class="params">(TreeNode root, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">    count = k;</span><br><span class="line">    recur(root);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">recur</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) <span class="keyword">return</span>;</span><br><span class="line">    recur(root.right); <span class="comment">// å³</span></span><br><span class="line">    <span class="keyword">if</span> (--count == <span class="number">0</span>) &#123;</span><br><span class="line">        res = root.val;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125; <span class="comment">// ä¸­</span></span><br><span class="line">    recur(root.left); <span class="comment">// å·¦</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å‰‘æŒ‡-Offer-55-I-äºŒå‰æ ‘çš„æ·±åº¦"><a href="#å‰‘æŒ‡-Offer-55-I-äºŒå‰æ ‘çš„æ·±åº¦" class="headerlink" title="å‰‘æŒ‡ Offer 55 - I. äºŒå‰æ ‘çš„æ·±åº¦"></a>å‰‘æŒ‡ Offer 55 - I. äºŒå‰æ ‘çš„æ·±åº¦</h3><p>è¾“å…¥ä¸€æ£µäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œæ±‚è¯¥æ ‘çš„æ·±åº¦ã€‚ä»æ ¹èŠ‚ç‚¹åˆ°å¶èŠ‚ç‚¹ä¾æ¬¡ç»è¿‡çš„èŠ‚ç‚¹ï¼ˆå«æ ¹ã€å¶èŠ‚ç‚¹ï¼‰å½¢æˆæ ‘çš„ä¸€æ¡è·¯å¾„ï¼Œæœ€é•¿è·¯å¾„çš„é•¿åº¦ä¸ºæ ‘çš„æ·±åº¦ã€‚</p><p>ä¾‹å¦‚ï¼š</p><p>ç»™å®šäºŒå‰æ ‘ <code>[3,9,20,null,null,15,7]</code>ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  3</span><br><span class="line"> / \</span><br><span class="line">9  20</span><br><span class="line">  /  \</span><br><span class="line"> 15   7</span><br></pre></td></tr></table></figure><p>è¿”å›å®ƒçš„æœ€å¤§æ·±åº¦ 3 ã€‚</p><p><strong>æç¤ºï¼š</strong></p><ol><li><code>èŠ‚ç‚¹æ€»æ•° &lt;= 10000</code></li></ol><p>æ³¨æ„ï¼šæœ¬é¢˜ä¸ä¸»ç«™ 104 é¢˜ç›¸åŒï¼š<a href="https://leetcode-cn.com/problems/maximum-depth-of-binary-tree/">https://leetcode-cn.com/problems/maximum-depth-of-binary-tree/</a></p><p>Related Topics</p><p>æ ‘</p><p>æ·±åº¦ä¼˜å…ˆæœç´¢</p><p>å¹¿åº¦ä¼˜å…ˆæœç´¢</p><p>äºŒå‰æ ‘</p><p>ğŸ‘ 218</p><p>ğŸ‘ 0</p><p><strong>è§£é¢˜æ€è·¯</strong>ï¼š</p><ol><li><p>ç¡®å®šéå†é¡ºåºã€‚</p><p>è¿™é“é¢˜ä½¿ç”¨DFSå’ŒBFSéƒ½æ˜¯å¯ä»¥è§£å†³çš„ã€‚</p></li><li><p>DFSæ—¶ï¼Œä»ä¸‹å¾€ä¸Šå›æº¯ï¼Œååºéå†ã€‚</p></li><li><p>BFSæ—¶ï¼Œæ­£å¥½èƒ½é€šè¿‡sizeæ¥è®°å½•æ¯ä¸€æ’çš„ä¸ªæ•°ã€‚</p></li></ol><p>æ·±åº¦ä¼˜å…ˆéå†ï¼ˆååºï¼‰ï¼š</p><p><img src="/images/%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/1603024336-lXVRDd-Picture1.png" alt="Picture1.png"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">maxDepth</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123; <span class="comment">// é€’å½’ç»ˆæ­¢æ¡ä»¶</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">leftH</span> <span class="operator">=</span> maxDepth(root.left);<span class="comment">// å·¦æ ‘é«˜åº¦</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">rightH</span> <span class="operator">=</span> maxDepth(root.right);<span class="comment">// å³æ ‘é«˜åº¦</span></span><br><span class="line">    <span class="keyword">return</span> Math.max(leftH, rightH) + <span class="number">1</span>;<span class="comment">//ä¸¤æ£µæ ‘çš„æœ€å¤§é«˜åº¦ + å½“å‰èŠ‚ç‚¹</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¤æ‚åº¦åˆ†æ</strong>ï¼š</p><p>æ—¶é—´å¤æ‚åº¦ O(N) ï¼š N ä¸ºæ ‘çš„èŠ‚ç‚¹æ•°é‡ï¼Œè®¡ç®—æ ‘çš„æ·±åº¦éœ€è¦éå†æ‰€æœ‰èŠ‚ç‚¹ã€‚<br>ç©ºé—´å¤æ‚åº¦ O(N) ï¼š æœ€å·®æƒ…å†µä¸‹ï¼ˆå½“æ ‘é€€åŒ–ä¸ºé“¾è¡¨æ—¶ï¼‰ï¼Œé€’å½’æ·±åº¦å¯è¾¾åˆ° N ã€‚</p><hr><p>å±‚åºéå†ï¼š</p><p><img src="/images/%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/1603024336-EXcbJg-Picture15.png" alt="img"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">maxDepth2</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(root == <span class="literal">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    Queue&lt;TreeNode&gt; queue = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    queue.add(root);</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!queue.isEmpty()) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> queue.size();</span><br><span class="line">        count++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">            <span class="type">TreeNode</span> <span class="variable">tmp</span> <span class="operator">=</span> queue.poll();</span><br><span class="line">            <span class="keyword">if</span> (tmp.left != <span class="literal">null</span>) &#123;</span><br><span class="line">                queue.add(tmp.left);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (tmp.right != <span class="literal">null</span>) &#123;</span><br><span class="line">                queue.add(tmp.right);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¤æ‚åº¦åˆ†æ</strong>ï¼š<br>æ—¶é—´å¤æ‚åº¦ O(N) ï¼š N ä¸ºæ ‘çš„èŠ‚ç‚¹æ•°é‡ï¼Œè®¡ç®—æ ‘çš„æ·±åº¦éœ€è¦éå†æ‰€æœ‰èŠ‚ç‚¹ã€‚<br>ç©ºé—´å¤æ‚åº¦ O(N) ï¼š æœ€å·®æƒ…å†µä¸‹ï¼ˆå½“æ ‘å¹³è¡¡æ—¶ï¼‰ï¼Œé˜Ÿåˆ— queue åŒæ—¶å­˜å‚¨ N&#x2F;2 ä¸ªèŠ‚ç‚¹ã€‚</p><h3 id="å‰‘æŒ‡-Offer-55-II-å¹³è¡¡äºŒå‰æ ‘"><a href="#å‰‘æŒ‡-Offer-55-II-å¹³è¡¡äºŒå‰æ ‘" class="headerlink" title="å‰‘æŒ‡ Offer 55 - II. å¹³è¡¡äºŒå‰æ ‘"></a>å‰‘æŒ‡ Offer 55 - II. å¹³è¡¡äºŒå‰æ ‘</h3><p>è¾“å…¥ä¸€æ£µäºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œåˆ¤æ–­è¯¥æ ‘æ˜¯ä¸æ˜¯å¹³è¡¡äºŒå‰æ ‘ã€‚å¦‚æœæŸäºŒå‰æ ‘ä¸­ä»»æ„èŠ‚ç‚¹çš„å·¦å³å­æ ‘çš„æ·±åº¦ç›¸å·®ä¸è¶…è¿‡1ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸€æ£µå¹³è¡¡äºŒå‰æ ‘ã€‚</p><p><strong>ç¤ºä¾‹ 1:</strong></p><p>ç»™å®šäºŒå‰æ ‘ <code>[3,9,20,null,null,15,7]</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  3</span><br><span class="line"> / \</span><br><span class="line">9  20</span><br><span class="line">  /  \</span><br><span class="line"> 15   7</span><br></pre></td></tr></table></figure><p>è¿”å› <code>true</code> ã€‚</p><p><strong>ç¤ºä¾‹ 2:</strong></p><p>ç»™å®šäºŒå‰æ ‘ <code>[1,2,2,3,3,null,null,4,4]</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">      1</span><br><span class="line">     / \</span><br><span class="line">    2   2</span><br><span class="line">   / \</span><br><span class="line">  3   3</span><br><span class="line"> / \</span><br><span class="line">4   4</span><br></pre></td></tr></table></figure><p>è¿”å› <code>false</code> ã€‚</p><p><strong>é™åˆ¶ï¼š</strong></p><ul><li><code>0 &lt;= æ ‘çš„ç»“ç‚¹ä¸ªæ•° &lt;= 10000</code></li></ul><p>æ³¨æ„ï¼šæœ¬é¢˜ä¸ä¸»ç«™ 110 é¢˜ç›¸åŒï¼š<a href="https://leetcode-cn.com/problems/balanced-binary-tree/">https://leetcode-cn.com/problems/balanced-binary-tree/</a></p><p>Related Topics</p><p>æ ‘</p><p>æ·±åº¦ä¼˜å…ˆæœç´¢</p><p>äºŒå‰æ ‘</p><p>ğŸ‘ 322</p><p>ğŸ‘ 0</p><p><strong>è§£é¢˜æ€è·¯</strong>ï¼š</p><p>å¹³è¡¡äºŒå‰æ ‘çš„æ€§è´¨ï¼šå¦‚æœæŸäºŒå‰æ ‘ä¸­ä»»æ„èŠ‚ç‚¹çš„å·¦å³å­æ ‘çš„æ·±åº¦ç›¸å·®ä¸è¶…è¿‡1ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸€æ£µå¹³è¡¡äºŒå‰æ ‘ã€‚</p><hr><p>å…ˆåºéå† + åˆ¤æ–­æ·±åº¦ ï¼ˆä»é¡¶è‡³åº•):</p><p>å¯ä»¥å¯¹æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½ç”¨è®¡ç®—äºŒå‰æ ‘é«˜åº¦ï¼Œå¦‚æœå·¦å³å­æ ‘æ·±åº¦å·®è¶…è¿‡1ï¼Œå°±è¿”å›false.</p><ol><li>ç¡®å®šéå†é¡ºåºï¼šå…ˆåºéå†</li><li>å¯¹ä¸­çš„èŠ‚ç‚¹çš„å·¦å³å­©å­æ±‚æ·±åº¦ï¼Œåˆ¤æ–­æ·±åº¦å·®æ˜¯å¦æ»¡è¶³è¦æ±‚ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isBalanced</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">leftH</span> <span class="operator">=</span> maxDepth(root.left);<span class="comment">// å·¦å­æ ‘é«˜åº¦</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">rightH</span> <span class="operator">=</span> maxDepth(root.right);<span class="comment">// å³å­æ ‘é«˜åº¦</span></span><br><span class="line">    <span class="keyword">if</span> (Math.abs(leftH - rightH) &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag1</span> <span class="operator">=</span> isBalanced(root.left);</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag2</span> <span class="operator">=</span> isBalanced(root.right);</span><br><span class="line">        <span class="keyword">return</span> flag1 &amp;&amp; flag2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="title function_">maxDepth</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (root == <span class="literal">null</span>) &#123; <span class="comment">// é€’å½’ç»ˆæ­¢æ¡ä»¶</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">leftH</span> <span class="operator">=</span> maxDepth(root.left);<span class="comment">// å·¦æ ‘é«˜åº¦</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">rightH</span> <span class="operator">=</span> maxDepth(root.right);<span class="comment">// å³æ ‘é«˜åº¦</span></span><br><span class="line">    <span class="keyword">return</span> Math.max(leftH, rightH) + <span class="number">1</span>;<span class="comment">//ä¸¤æ£µæ ‘çš„æœ€å¤§é«˜åº¦ + å½“å‰èŠ‚ç‚¹</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/images/%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/1603024695-uuegMD-Picture17.png" alt="img"></p><p>ååºéå† + å‰ªæ ï¼ˆä»åº•è‡³é¡¶ï¼‰:</p><blockquote><p>æ­¤æ–¹æ³•ä¸ºæœ¬é¢˜çš„æœ€ä¼˜è§£æ³•ï¼Œä½†å‰ªæçš„æ–¹æ³•ä¸æ˜“ç¬¬ä¸€æ—¶é—´æƒ³åˆ°ã€‚</p></blockquote><p>æ€è·¯æ˜¯å¯¹äºŒå‰æ ‘åšååºéå†ï¼Œä»åº•è‡³é¡¶è¿”å›å­æ ‘æ·±åº¦ï¼Œè‹¥åˆ¤å®šæŸå­æ ‘ä¸æ˜¯å¹³è¡¡æ ‘åˆ™ â€œå‰ªæâ€ ï¼Œç›´æ¥å‘ä¸Šè¿”å›ã€‚</p><p>recur(root) å‡½æ•°ï¼š</p><ol><li>è¿”å›å€¼ï¼š<ol><li>å½“èŠ‚ç‚¹root å·¦ &#x2F; å³å­æ ‘çš„æ·±åº¦å·®â‰¤1 ï¼šåˆ™è¿”å›å½“å‰å­æ ‘çš„æ·±åº¦ï¼Œå³èŠ‚ç‚¹ root çš„å·¦ &#x2F; å³å­æ ‘çš„æ·±åº¦æœ€å¤§å€¼ +1ï¼ˆ max(left, right) + 1 ï¼‰ï¼›</li><li>å½“èŠ‚ç‚¹root å·¦ &#x2F; å³å­æ ‘çš„æ·±åº¦å·® &gt;1 ï¼šåˆ™è¿”å› âˆ’1 ï¼Œä»£è¡¨ æ­¤å­æ ‘ä¸æ˜¯å¹³è¡¡æ ‘ ã€‚</li></ol></li><li>ç»ˆæ­¢æ¡ä»¶ï¼š<ol><li>å½“ root ä¸ºç©ºï¼šè¯´æ˜è¶Šè¿‡å¶èŠ‚ç‚¹ï¼Œå› æ­¤è¿”å›é«˜åº¦ 0 ï¼›</li><li>å½“å·¦ï¼ˆå³ï¼‰å­æ ‘æ·±åº¦ä¸º âˆ’1 ï¼šä»£è¡¨æ­¤æ ‘çš„ å·¦ï¼ˆå³ï¼‰å­æ ‘ ä¸æ˜¯å¹³è¡¡æ ‘ï¼Œå› æ­¤å‰ªæï¼Œç›´æ¥è¿”å› âˆ’1 ï¼›</li></ol></li></ol><p>isBalanced(root) å‡½æ•°ï¼š</p><ol><li>è¿”å›å€¼ï¼š è‹¥ recur(root) !&#x3D; -1 ï¼Œåˆ™è¯´æ˜æ­¤æ ‘å¹³è¡¡ï¼Œè¿”å› truetrue ï¼› å¦åˆ™è¿”å› falsefalse ã€‚</li></ol><p>å¤æ‚åº¦åˆ†æï¼š<br>æ—¶é—´å¤æ‚åº¦ O(N)ï¼š N ä¸ºæ ‘çš„èŠ‚ç‚¹æ•°ï¼›æœ€å·®æƒ…å†µä¸‹ï¼Œéœ€è¦é€’å½’éå†æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹ã€‚<br>ç©ºé—´å¤æ‚åº¦ O(N)ï¼š æœ€å·®æƒ…å†µä¸‹ï¼ˆæ ‘é€€åŒ–ä¸ºé“¾è¡¨æ—¶ï¼‰ï¼Œç³»ç»Ÿé€’å½’éœ€è¦ä½¿ç”¨ O(N) çš„æ ˆç©ºé—´ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isBalanced</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> recur(root) != -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="title function_">recur</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">null</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> recur(root.left);</span><br><span class="line">        <span class="keyword">if</span>(left == -<span class="number">1</span>) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> recur(root.right);</span><br><span class="line">        <span class="keyword">if</span>(right == -<span class="number">1</span>) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> Math.abs(left - right) &lt; <span class="number">2</span> ? Math.max(left, right) + <span class="number">1</span> : -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/images/%E7%AE%97%E6%B3%95%E6%80%BB%E7%BB%93/1603024695-Jqbiev-Picture12.png" alt="img"></p>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¡ç®—æœºç½‘ç»œ</title>
      <link href="/2022/11/20/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"/>
      <url>/2022/11/20/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/</url>
      
        <content type="html"><![CDATA[<h1 id="è®¡ç®—æœºç½‘ç»œ"><a href="#è®¡ç®—æœºç½‘ç»œ" class="headerlink" title="è®¡ç®—æœºç½‘ç»œ"></a>è®¡ç®—æœºç½‘ç»œ</h1><h2 id="ä¸€ã€ç»ªè®º"><a href="#ä¸€ã€ç»ªè®º" class="headerlink" title="ä¸€ã€ç»ªè®º"></a>ä¸€ã€ç»ªè®º</h2><h3 id="1-1ã€å› ç‰¹ç½‘çš„æ¦‚è¿°"><a href="#1-1ã€å› ç‰¹ç½‘çš„æ¦‚è¿°" class="headerlink" title="1.1ã€å› ç‰¹ç½‘çš„æ¦‚è¿°"></a>1.1ã€å› ç‰¹ç½‘çš„æ¦‚è¿°</h3><blockquote><p>1ã€4ç†è§£</p><p>2ã€3äº†è§£</p></blockquote><h4 id="1ã€ç½‘ç»œã€äº’è”ç½‘ï¼ˆäº’è¿ç½‘ï¼‰å’Œå› ç‰¹ç½‘"><a href="#1ã€ç½‘ç»œã€äº’è”ç½‘ï¼ˆäº’è¿ç½‘ï¼‰å’Œå› ç‰¹ç½‘" class="headerlink" title="1ã€ç½‘ç»œã€äº’è”ç½‘ï¼ˆäº’è¿ç½‘ï¼‰å’Œå› ç‰¹ç½‘"></a>1ã€ç½‘ç»œã€äº’è”ç½‘ï¼ˆäº’è¿ç½‘ï¼‰å’Œå› ç‰¹ç½‘</h4><p>ç½‘ç»œï¼šç½‘ç»œï¼ˆNetworkï¼‰ç”±è‹¥å¹²<strong>ç»“ç‚¹ï¼ˆNodeï¼‰</strong>å’Œè¿æ¥è¿™äº›ç»“ç‚¹çš„<strong>é“¾è·¯ï¼ˆLinkï¼‰</strong>ç»„æˆã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-4fcd41d225b201be.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/505/format/webp" alt="img"></p><p>äº’è¿ç½‘ï¼ˆäº’è”ç½‘ï¼‰ï¼šå¤šä¸ªç½‘ç»œé€šè¿‡è·¯ç”±å™¨äº’è¿èµ·æ¥ï¼Œè¿™æ ·å°±æ„æˆäº†ä¸€ä¸ªè¦†ç›–èŒƒå›´æ›´å¤§çš„ç½‘ç»œï¼Œå³äº’è¿ç½‘ï¼ˆäº’è”ç½‘ï¼‰ã€‚å› æ­¤ï¼Œäº’è”ç½‘åˆç§°ä¸ºâ€œç½‘ç»œçš„ç½‘ç»œï¼ˆNetwork of Networksï¼‰â€ã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-ff49fa2ef0245745.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/899/format/webp" alt="img"></p><p>å› ç‰¹ç½‘ï¼šå› ç‰¹ç½‘ï¼ˆInternetï¼‰æ˜¯ä¸–ç•Œä¸Šæœ€å¤§çš„äº’è¿ç½‘ç»œï¼ˆç”¨æˆ·æ•°ä»¥äº¿è®¡ï¼Œäº’è¿çš„ç½‘ç»œæ•°ä»¥ç™¾ä¸‡è®¡ï¼‰ã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-ee181b01ca4c6f8e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/922/format/webp" alt="img"></p><blockquote><p><strong>internetä¸Internetçš„åŒºåˆ«</strong></p><ul><li><p><strong>internet(äº’è”ç½‘æˆ–äº’è¿ç½‘)<strong>æ˜¯ä¸€ä¸ªé€šç”¨åè¯ï¼Œå®ƒæ³›æŒ‡</strong>å¤šä¸ªè®¡ç®—æœºç½‘ç»œäº’è¿è€Œæˆçš„ç½‘ç»œ</strong>ã€‚åœ¨è¿™äº›ç½‘ç»œä¹‹é—´çš„é€šä¿¡åè®®å¯ä»¥æ˜¯ä»»æ„çš„ã€‚</p></li><li><p><strong>Internetï¼ˆå› ç‰¹ç½‘ï¼‰åˆ™æ˜¯ä¸€ä¸ªä¸“ç”¨åè¯</strong>ï¼Œå®ƒæŒ‡<strong>å½“å‰å…¨çƒæœ€å¤§çš„ã€å¼€æ”¾çš„ã€ç”±ä¼—å¤šç½‘ç»œäº’è¿è€Œæˆçš„ç‰¹å®šè®¡ç®—æœºç½‘ç»œ</strong>ï¼Œå®ƒé‡‡ç”¨TCP&#x2F;IPåè®®æ—ä½œä¸ºé€šä¿¡çš„è§„åˆ™ï¼Œå…¶å‰èº«æ˜¯ç¾å›½çš„ARPANETã€‚</p></li></ul><p>ä»»æ„æŠŠå‡ ä¸ªè®¡ç®—æœºç½‘ç»œäº’è¿èµ·æ¥ï¼ˆä¸ç®¡é‡‡ç”¨ä»€ä¹ˆåè®®ï¼‰ï¼Œå¹¶èƒ½å¤Ÿç›¸äº’é€šä¿¡ï¼Œè¿™æ ·æ„æˆçš„æ˜¯ä¸€ä¸ªäº’è¿ç½‘(internet) ï¼Œè€Œä¸æ˜¯äº’è”ç½‘(Internet)ã€‚</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-cb6c0dd7a1f70e3e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="2ã€å› ç‰¹ç½‘å‘å±•çš„ä¸‰ä¸ªé˜¶æ®µ"><a href="#2ã€å› ç‰¹ç½‘å‘å±•çš„ä¸‰ä¸ªé˜¶æ®µ" class="headerlink" title="2ã€å› ç‰¹ç½‘å‘å±•çš„ä¸‰ä¸ªé˜¶æ®µ"></a>2ã€å› ç‰¹ç½‘å‘å±•çš„ä¸‰ä¸ªé˜¶æ®µ</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-0ee6522bfae940b5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>å› ç‰¹ç½‘æœåŠ¡æä¾›è€…<code>ISP</code>(<code>I</code>nternet <code>S</code>ervice <code>P</code>rovider)</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-332e68bc46bc59ab.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>æ™®é€šç”¨æˆ·æ˜¯å¦‚ä½•æ¥å…¥åˆ°å› ç‰¹ç½‘çš„å‘¢ï¼Ÿ</p><p>ç­”ï¼š<strong>é€šè¿‡ISPæ¥å…¥å› ç‰¹ç½‘</strong></p><p>ISPå¯ä»¥ä»å› ç‰¹ç½‘ç®¡ç†æœºæ„ç”³è¯·åˆ°æˆå—çš„IPåœ°å€ï¼ŒåŒæ—¶æ‹¥æœ‰é€šä¿¡çº¿è·¯ä»¥åŠè·¯ç”±å™¨ç­‰è”ç½‘è®¾å¤‡ã€‚ä»»ä½•æœºæ„å’Œä¸ªäººåªéœ€ç¼´çº³è´¹ç”¨ï¼Œå°±å¯ä»<strong>ISPçš„å¾—åˆ°æ‰€éœ€è¦çš„IPåœ°å€</strong>ã€‚</p><p><strong>å› ä¸ºå› ç‰¹ç½‘ä¸Šçš„ä¸»æœºéƒ½å¿…é¡»æœ‰IPåœ°å€æ‰èƒ½è¿›è¡Œé€šä¿¡ï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡è¯¥ISPæ¥å…¥åˆ°å› ç‰¹ç½‘</strong></p></blockquote><p>ä¸­å›½çš„ä¸‰å¤§<code>ISP</code>ï¼šä¸­å›½ç”µä¿¡ï¼Œä¸­å›½è”é€šå’Œä¸­å›½ç§»åŠ¨</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-ce38a42cfcab9872.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/965/format/webp" alt="img"></p><p><strong>åŸºäºISPçš„ä¸‰å±‚ç»“æ„çš„å› ç‰¹ç½‘</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-1ccdf3defcff4ef1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä¸€æ—¦æŸä¸ªç”¨æˆ·èƒ½å¤Ÿæ¥å…¥åˆ°å› ç‰¹ç½‘ï¼Œé‚£ä¹ˆä»–ä¹Ÿå¯ä»¥æˆä¸ºä¸€ä¸ªISPï¼Œæ‰€éœ€è¦åšçš„å°±æ˜¯è´­ä¹°ä¸€äº›å¦‚è°ƒåˆ¶è§£è°ƒå™¨æˆ–è·¯ç”±å™¨è¿™æ ·çš„è®¾å¤‡ï¼Œè®©å…¶ä»–ç”¨æˆ·å¯ä»¥å’Œä»–ç›¸è¿ã€‚</p></blockquote><h4 id="3ã€å› ç‰¹ç½‘çš„æ ‡å‡†åŒ–å·¥ä½œ"><a href="#3ã€å› ç‰¹ç½‘çš„æ ‡å‡†åŒ–å·¥ä½œ" class="headerlink" title="3ã€å› ç‰¹ç½‘çš„æ ‡å‡†åŒ–å·¥ä½œ"></a>3ã€å› ç‰¹ç½‘çš„æ ‡å‡†åŒ–å·¥ä½œ</h4><ol><li><p>å› ç‰¹ç½‘çš„æ ‡å‡†åŒ–å·¥ä½œå¯¹å› ç‰¹ç½‘çš„å‘å±•èµ·åˆ°äº†éå¸¸é‡è¦çš„ä½œç”¨ã€‚</p></li><li><p>å› ç‰¹ç½‘åœ¨æŒ‡å®šå…¶æ ‡å‡†ä¸Šçš„ä¸€ä¸ªå¾ˆå¤§çš„ç‰¹ç‚¹æ˜¯<strong>é¢å‘å…¬ä¼—ã€‚</strong></p><ul><li><p>å› ç‰¹ç½‘æ‰€æœ‰çš„<strong>RFC</strong>(Request For Comments)æŠ€æœ¯æ–‡æ¡£éƒ½å¯ä»å› ç‰¹ç½‘ä¸Šå…è´¹ä¸‹è½½ï¼›</p></li><li><p>ä»»ä½•äººéƒ½å¯ä»¥éšæ—¶ç”¨ç”µå­é‚®ä»¶å‘è¡¨å¯¹æŸä¸ªæ–‡æ¡£çš„æ„è§æˆ–å»ºè®®ã€‚</p></li></ul></li><li><p><strong>å› ç‰¹ç½‘åä¼šISOC</strong>æ˜¯ä¸€ä¸ªå›½é™…æ€§ç»„ç»‡ï¼Œå®ƒè´Ÿè´£å¯¹å› ç‰¹ç½‘è¿›è¡Œå…¨é¢ç®¡ç†ï¼Œä»¥åŠåœ¨ä¸–ç•ŒèŒƒå›´å†…ä¿ƒè¿›å…¶å‘å±•å’Œä½¿ç”¨ã€‚</p><ul><li><p>å› ç‰¹ç½‘ä½“ç³»ç»“æ„å§”å‘˜ä¼šIABï¼Œè´Ÿè´£ç®¡ç†å› ç‰¹ç½‘æœ‰å…³åè®®çš„å¼€å‘ï¼›</p></li><li><p>å› ç‰¹ç½‘å·¥ç¨‹éƒ¨IETFï¼Œè´Ÿè´£ç ”ç©¶ä¸­çŸ­æœŸå·¥ç¨‹é—®é¢˜ï¼Œä¸»è¦é’ˆå¯¹åè®®çš„å¼€å‘å’Œæ ‡å‡†åŒ–ï¼›</p></li><li><p>å› ç‰¹ç½‘ç ”ç©¶éƒ¨IRTFï¼Œä»äº‹ç†è®ºæ–¹é¢çš„ç ”ç©¶å’Œå¼€å‘ä¸€äº›éœ€è¦é•¿æœŸè€ƒè™‘çš„é—®é¢˜ã€‚</p></li></ul></li></ol><p><img src="https://upload-images.jianshu.io/upload_images/24878825-92960e033eb18c8d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/546/format/webp" alt="img"></p><ul><li><p>åˆ¶è®¢å› ç‰¹ç½‘çš„æ­£å¼æ ‡å‡†è¦ç»è¿‡ä¸€ä¸‹<strong>4ä¸ªé˜¶æ®µ</strong>ï¼š</p><p>1ã€å› ç‰¹ç½‘è‰æ¡ˆï¼ˆåœ¨è¿™ä¸ªé˜¶æ®µè¿˜ä¸æ˜¯RFCæ–‡æ¡£ï¼‰</p><p>2ã€å»ºè®®æ ‡å‡†ï¼ˆä»è¿™ä¸ªé˜¶æ®µå¼€å§‹å°±æˆä¸ºRFCæ–‡æ¡£ï¼‰</p><p>3ã€è‰æ¡ˆæ ‡å‡†</p><p>4ã€å› ç‰¹ç½‘æ ‡å‡†</p></li></ul><h4 id="4ã€å› ç‰¹ç½‘çš„ç»„æˆ"><a href="#4ã€å› ç‰¹ç½‘çš„ç»„æˆ" class="headerlink" title="4ã€å› ç‰¹ç½‘çš„ç»„æˆ"></a>4ã€å› ç‰¹ç½‘çš„ç»„æˆ</h4><ol><li>è¾¹ç¼˜éƒ¨åˆ†</li></ol><p>ç”±æ‰€æœ‰è¿æ¥åœ¨å› ç‰¹ç½‘ä¸Šçš„<strong>ä¸»æœº</strong>ç»„æˆï¼ˆå°å¼ç”µè„‘ï¼Œå¤§å‹æœåŠ¡å™¨ï¼Œç¬”è®°æœ¬ç”µè„‘ï¼Œå¹³æ¿ï¼Œæ™ºèƒ½æ‰‹æœºç­‰ï¼‰ã€‚è¿™éƒ¨åˆ†æ˜¯<strong>ç”¨æˆ·ç›´æ¥ä½¿ç”¨</strong>çš„ï¼Œç”¨æ¥è¿›è¡Œ<strong>é€šä¿¡</strong>ï¼ˆä¼ é€æ•°æ®ã€éŸ³é¢‘æˆ–è§†é¢‘ï¼‰å’Œ<strong>èµ„æºå…±äº«</strong>ã€‚</p><ol start="2"><li>æ ¸å¿ƒéƒ¨åˆ†</li></ol><p>ç”±<strong>å¤§é‡ç½‘ç»œ</strong>å’Œè¿æ¥è¿™äº›ç½‘ç»œçš„<strong>è·¯ç”±å™¨</strong>ç»„æˆã€‚è¿™éƒ¨åˆ†æ˜¯<strong>ä¸ºè¾¹ç¼˜éƒ¨åˆ†æä¾›æœåŠ¡</strong>çš„ï¼ˆæä¾›è¿é€šæ€§å’Œäº¤æ¢ï¼‰ã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-3065474a4377aff0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>è·¯ç”±å™¨æ˜¯ä¸€ç§ä¸“ç”¨è®¡ç®—æœºï¼Œä½†æˆ‘ä»¬ä¸ç§°å®ƒä¸ºä¸»æœºï¼Œè·¯ç”±å™¨æ˜¯å®ç°<strong>åˆ†ç»„äº¤æ¢</strong>çš„å…³é”®æ„å»ºï¼Œå…¶ä»»åŠ¡æ˜¯è½¬å‘æ”¶åˆ°çš„åˆ†ç»„ï¼Œè¿™æ˜¯ç½‘ç»œæ ¸å¿ƒæœ€é‡è¦çš„éƒ¨åˆ†ã€‚</p><p>å¤„åœ¨äº’è”ç½‘è¾¹ç¼˜çš„éƒ¨åˆ†å°±æ˜¯è¿æ¥åœ¨äº’è”ç½‘ä¸Šçš„æ‰€æœ‰çš„ä¸»æœºã€‚è¿™äº›ä¸»æœºåˆç§°ä¸º**ç«¯ç³»ç»Ÿ (end system)**ã€‚</p><p><strong>ç«¯ç³»ç»Ÿåœ¨åŠŸèƒ½ä¸Šå¯èƒ½æœ‰å¾ˆå¤§çš„å·®åˆ«ï¼š</strong></p><ol><li><p>å°çš„ç«¯ç³»ç»Ÿå¯ä»¥æ˜¯ä¸€å°æ™®é€šä¸ªäººç”µè„‘ï¼Œå…·æœ‰ä¸Šç½‘åŠŸèƒ½çš„æ™ºèƒ½æ‰‹æœºï¼Œç”šè‡³æ˜¯ä¸€ä¸ªå¾ˆå°çš„ç½‘ç»œæ‘„åƒå¤´ã€‚</p></li><li><p>å¤§çš„ç«¯ç³»ç»Ÿåˆ™å¯ä»¥æ˜¯ä¸€å°éå¸¸æ˜‚è´µçš„å¤§å‹è®¡ç®—æœºã€‚</p></li><li><p>ç«¯ç³»ç»Ÿçš„æ‹¥æœ‰è€…å¯ä»¥æ˜¯ä¸ªäººï¼Œä¹Ÿå¯ä»¥æ˜¯å•ä½ï¼ˆå¦‚å­¦æ ¡ã€ä¼ä¸šã€æ”¿åºœæœºå…³ç­‰ï¼‰ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ˜¯æŸä¸ªISPã€‚</p></li></ol></blockquote><h4 id="è¡¥å……ï¼š"><a href="#è¡¥å……ï¼š" class="headerlink" title="è¡¥å……ï¼š"></a>è¡¥å……ï¼š</h4><h5 id="ç«¯ç³»ç»Ÿä¹‹é—´é€šä¿¡çš„å«ä¹‰"><a href="#ç«¯ç³»ç»Ÿä¹‹é—´é€šä¿¡çš„å«ä¹‰" class="headerlink" title="ç«¯ç³»ç»Ÿä¹‹é—´é€šä¿¡çš„å«ä¹‰"></a><strong>ç«¯ç³»ç»Ÿä¹‹é—´é€šä¿¡çš„å«ä¹‰</strong></h5><p>â€œä¸»æœº A å’Œä¸»æœº B è¿›è¡Œé€šä¿¡â€å®é™…ä¸Šæ˜¯æŒ‡ï¼šâ€œè¿è¡Œåœ¨ä¸»æœº A ä¸Šçš„æŸä¸ªç¨‹åºå’Œè¿è¡Œåœ¨ä¸»æœº B ä¸Šçš„å¦ä¸€ä¸ªç¨‹åºè¿›è¡Œé€šä¿¡â€ã€‚<strong>å³â€œä¸»æœº</strong>  <strong>A</strong>  <strong>çš„æŸä¸ªè¿›ç¨‹å’Œä¸»æœº</strong>  <strong>B</strong>  <strong>ä¸Šçš„å¦ä¸€ä¸ªè¿›ç¨‹è¿›è¡Œé€šä¿¡â€ã€‚ç®€ç§°ä¸ºâ€œè®¡ç®—æœºä¹‹é—´é€šä¿¡â€ã€‚</strong></p><blockquote><p>è®¡ç®—æœºä¹‹é—´çš„é€šä¿¡ï¼Œå…¶å®æ˜¯ä¸¤ä¸ªè®¡ç®—æœºä¸­è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚</p></blockquote><p>ç«¯ç³»ç»Ÿä¹‹é—´çš„é€šä¿¡æ–¹å¼é€šå¸¸å¯åˆ’åˆ†ä¸ºä¸¤å¤§ç±»ï¼š</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-4ee005d739f54581.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>å®¢æˆ·-æœåŠ¡å™¨æ–¹å¼ï¼š</strong></p><ul><li>å®¢æˆ· (client) å’ŒæœåŠ¡å™¨ (server) éƒ½æ˜¯æŒ‡é€šä¿¡ä¸­æ‰€æ¶‰åŠçš„ä¸¤ä¸ªåº”ç”¨è¿›ç¨‹ã€‚</li><li>å®¢æˆ· - æœåŠ¡å™¨æ–¹å¼æ‰€æè¿°çš„æ˜¯è¿›ç¨‹ä¹‹é—´æœåŠ¡å’Œè¢«æœåŠ¡çš„å…³ç³»ã€‚</li><li>å®¢æˆ·æ˜¯æœåŠ¡çš„è¯·æ±‚æ–¹ï¼ŒæœåŠ¡å™¨æ˜¯æœåŠ¡çš„æä¾›æ–¹ã€‚</li></ul><blockquote><p><strong>æœåŠ¡è¯·æ±‚æ–¹å’ŒæœåŠ¡æä¾›æ–¹éƒ½è¦ä½¿ç”¨ç½‘ç»œæ ¸å¿ƒéƒ¨åˆ†æ‰€æä¾›çš„æœåŠ¡ã€‚</strong></p></blockquote><p><strong>å¯¹ç­‰è¿æ¥æ–¹å¼ï¼š</strong></p><ul><li><strong>å¯¹ç­‰è¿æ¥</strong> (peer-to-peerï¼Œç®€å†™ä¸º <strong>P2P</strong> ) æ˜¯æŒ‡ä¸¤ä¸ªä¸»æœºåœ¨é€šä¿¡æ—¶å¹¶ä¸åŒºåˆ†å“ªä¸€ä¸ªæ˜¯æœåŠ¡è¯·æ±‚æ–¹è¿˜æ˜¯æœåŠ¡æä¾›æ–¹ã€‚</li><li>åªè¦ä¸¤ä¸ªä¸»æœºéƒ½è¿è¡Œäº†å¯¹ç­‰è¿æ¥è½¯ä»¶ ( P2P è½¯ä»¶) ï¼Œå®ƒä»¬å°±å¯ä»¥è¿›è¡Œ<strong>å¹³ç­‰çš„ã€å¯¹ç­‰è¿æ¥é€šä¿¡</strong>ã€‚</li><li>åŒæ–¹éƒ½å¯ä»¥ä¸‹è½½å¯¹æ–¹å·²ç»å­˜å‚¨åœ¨ç¡¬ç›˜ä¸­çš„å…±äº«æ–‡æ¡£ã€‚</li></ul><h3 id="1-2ã€ä¸‰ç§äº¤æ¢æ–¹å¼"><a href="#1-2ã€ä¸‰ç§äº¤æ¢æ–¹å¼" class="headerlink" title="1.2ã€ä¸‰ç§äº¤æ¢æ–¹å¼"></a>1.2ã€ä¸‰ç§äº¤æ¢æ–¹å¼</h3><blockquote><p>é‡ç‚¹ï¼šåˆ†ç»„äº¤æ¢</p></blockquote><p>ç½‘ç»œæ ¸å¿ƒéƒ¨åˆ†æ˜¯äº’è”ç½‘ä¸­æœ€å¤æ‚çš„éƒ¨åˆ†ã€‚</p><p>ç½‘ç»œä¸­çš„æ ¸å¿ƒéƒ¨åˆ†è¦å‘ç½‘ç»œè¾¹ç¼˜ä¸­çš„å¤§é‡ä¸»æœºæä¾›è¿é€šæ€§ï¼Œä½¿è¾¹ç¼˜éƒ¨åˆ†ä¸­çš„ä»»ä½•ä¸€ä¸ªä¸»æœºéƒ½èƒ½å¤Ÿå‘å…¶ä»–ä¸»æœºé€šä¿¡ï¼ˆå³ä¼ é€æˆ–æ¥æ”¶å„ç§å½¢å¼çš„æ•°æ®ï¼‰ã€‚</p><p>åœ¨ç½‘ç»œæ ¸å¿ƒéƒ¨åˆ†èµ·ç‰¹æ®Šä½œç”¨çš„æ˜¯<strong>è·¯ç”±å™¨</strong>(router)ã€‚</p><p><strong>è·¯ç”±å™¨</strong>æ˜¯å®ç°<strong>åˆ†ç»„äº¤æ¢</strong> (packet switching) çš„å…³é”®æ„ä»¶ï¼Œå…¶ä»»åŠ¡æ˜¯<strong>è½¬å‘</strong>æ”¶åˆ°çš„åˆ†ç»„ï¼Œè¿™æ˜¯ç½‘ç»œæ ¸å¿ƒéƒ¨åˆ†æœ€é‡è¦çš„åŠŸèƒ½ã€‚</p><h4 id="1ã€ç”µè·¯äº¤æ¢ï¼ˆCircuit-Switchingï¼‰"><a href="#1ã€ç”µè·¯äº¤æ¢ï¼ˆCircuit-Switchingï¼‰" class="headerlink" title="1ã€ç”µè·¯äº¤æ¢ï¼ˆCircuit Switchingï¼‰"></a>1ã€ç”µè·¯äº¤æ¢ï¼ˆCircuit Switchingï¼‰</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-cbb94cf7d6bc6f8b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä¼ ç»Ÿä¸¤ä¸¤ç›¸è¿çš„æ–¹å¼ï¼Œå½“ç”µè¯æ•°é‡å¾ˆå¤šæ—¶ï¼Œç”µè¯çº¿ä¹Ÿå¾ˆå¤šï¼Œå°±å¾ˆä¸æ–¹ä¾¿</p><p>æ‰€ä»¥è¦ä½¿å¾—æ¯ä¸€éƒ¨ç”µè¯èƒ½å¤Ÿå¾ˆæ–¹ä¾¿åœ°å’Œå¦ä¸€éƒ¨ç”µè¯è¿›è¡Œé€šä¿¡ï¼Œå°±åº”è¯¥ä½¿ç”¨ä¸€ä¸ª<strong>ä¸­é—´è®¾å¤‡</strong>å°†è¿™äº›ç”µè¯è¿æ¥èµ·æ¥ï¼Œè¿™ä¸ªä¸­é—´è®¾å¤‡å°±æ˜¯<strong>ç”µè¯äº¤æ¢æœº</strong></p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-7ad293b2ca19158b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/672/format/webp" alt="img"></p><ul><li><p>ç”µè¯äº¤æ¢æœºæ¥é€šç”µè¯çº¿çš„æ–¹å¼ç§°ä¸ºç”µè·¯äº¤æ¢ï¼›</p></li><li><p>ä»é€šä¿¡èµ„æºçš„åˆ†é…è§’åº¦æ¥çœ‹ï¼Œäº¤æ¢ï¼ˆSwitchingï¼‰å°±æ˜¯æŒ‰ç…§æŸç§æ–¹å¼åŠ¨æ€åœ°åˆ†é…ä¼ è¾“çº¿è·¯çš„èµ„æºï¼›</p></li><li><p>ç”µè·¯äº¤æ¢çš„ä¸‰ä¸ªæ­¥éª¤ï¼š</p><p>1ã€å»ºç«‹è¿æ¥ï¼ˆåˆ†é…é€šä¿¡èµ„æºï¼‰</p><p>2ã€é€šè¯ï¼ˆä¸€ç›´å ç”¨é€šä¿¡èµ„æºï¼‰</p><p>3ã€é‡Šæ”¾è¿æ¥ï¼ˆå½’è¿˜é€šä¿¡èµ„æºï¼‰</p></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-acb87df045723236.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>å½“ä½¿ç”¨ç”µè·¯äº¤æ¢æ¥ä¼ é€è®¡ç®—æœºæ•°æ®æ—¶ï¼Œå…¶çº¿è·¯çš„ä¼ è¾“æ•ˆç‡å¾€å¾€å¾ˆä½ã€‚</p><p>è¿™æ˜¯å› ä¸ºè®¡ç®—æœºæ•°æ®æ˜¯çªå‘å¼åœ°å‡ºç°åœ¨ä¼ è¾“çº¿è·¯ä¸Šçš„ã€‚</p><p>æ‰€ä»¥è®¡ç®—æœºé€šå¸¸é‡‡ç”¨çš„æ˜¯<strong>åˆ†ç»„äº¤æ¢</strong>ï¼Œè€Œä¸æ˜¯çº¿è·¯äº¤æ¢</p></blockquote><h4 id="2ã€åˆ†ç»„äº¤æ¢ï¼ˆPacket-Switchingï¼‰"><a href="#2ã€åˆ†ç»„äº¤æ¢ï¼ˆPacket-Switchingï¼‰" class="headerlink" title="2ã€åˆ†ç»„äº¤æ¢ï¼ˆPacket Switchingï¼‰"></a>2ã€<strong>åˆ†ç»„äº¤æ¢ï¼ˆPacket Switchingï¼‰</strong></h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-c57bf61052cb33f0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>é€šå¸¸æˆ‘ä»¬æŠŠè¡¨ç¤º<strong>è¯¥æ¶ˆæ¯çš„æ•´å—æ•°æ®</strong>æˆä¸ºä¸€ä¸ª<strong>æŠ¥æ–‡</strong>ã€‚</p><p>åœ¨å‘é€æŠ¥æ–‡ä¹‹å‰ï¼Œå…ˆæŠŠè¾ƒé•¿çš„æŠ¥æ–‡åˆ’åˆ†æˆä¸€ä¸ªä¸ªæ›´å°çš„<strong>ç­‰é•¿æ•°æ®æ®µ</strong>ï¼Œåœ¨æ¯ä¸€ä¸ªæ•°æ®æ®µå‰é¢ã€‚åŠ ä¸Šä¸€äº›ç”±å¿…<strong>è¦çš„æ§åˆ¶ä¿¡æ¯ç»„æˆçš„é¦–éƒ¨</strong>åï¼Œå°±æ„æˆä¸€ä¸ªåˆ†ç»„ï¼Œä¹Ÿå¯ç®€ç§°ä¸ºâ€œåŒ…â€ï¼Œç›¸åº”åœ°ï¼Œé¦–éƒ¨ä¹Ÿå¯ç§°ä¸ºâ€œåŒ…å¤´â€ã€‚</p><p>é¦–éƒ¨åŒ…å«äº†<strong>åˆ†ç»„çš„ç›®çš„åœ°å€</strong></p><p>åˆ†ç»„ä»æºä¸»æœºåˆ°ç›®çš„ä¸»æœºï¼Œå¯èµ°ä¸åŒçš„è·¯å¾„ã€‚</p></blockquote><p>å‘é€æ–¹</p><ul><li>æ„é€ åˆ†ç»„</li><li>å‘é€åˆ†ç»„</li></ul><p>è·¯ç”±å™¨</p><ul><li>ç¼“å­˜åˆ†ç»„</li><li>è½¬å‘åˆ†ç»„</li><li>ç®€ç§°ä¸ºâ€œåˆ†ç»„è½¬å‘â€</li></ul><blockquote><p>åœ¨è·¯ç”±å™¨ä¸­çš„è¾“å…¥å’Œè¾“å‡ºç«¯å£ä¹‹é—´æ²¡æœ‰ç›´æ¥è¿çº¿ã€‚</p><p>è·¯ç”±å™¨å¤„ç†åˆ†ç»„çš„è¿‡ç¨‹æ˜¯ï¼š</p><ol><li><p>æŠŠæ”¶åˆ°çš„åˆ†ç»„å…ˆ<strong>æ”¾å…¥ç¼“å­˜ï¼ˆæš‚æ—¶å­˜å‚¨ï¼‰ï¼›</strong></p></li><li><p><strong>æŸ¥æ‰¾è½¬å‘è¡¨</strong>ï¼Œæ‰¾å‡ºåˆ°æŸä¸ªç›®çš„åœ°å€åº”ä»å“ªä¸ªç«¯å£è½¬å‘ï¼›</p></li><li><p>æŠŠåˆ†ç»„é€åˆ°é€‚å½“çš„ç«¯å£<strong>è½¬å‘</strong>å‡ºå»ã€‚</p></li></ol></blockquote><p>æ¥æ”¶æ–¹</p><ul><li>æ¥æ”¶åˆ†ç»„</li><li>è¿˜åŸæŠ¥æ–‡</li></ul><h4 id="3ã€æŠ¥æ–‡äº¤æ¢ï¼ˆMessage-Switchingï¼‰"><a href="#3ã€æŠ¥æ–‡äº¤æ¢ï¼ˆMessage-Switchingï¼‰" class="headerlink" title="3ã€æŠ¥æ–‡äº¤æ¢ï¼ˆMessage Switchingï¼‰"></a>3ã€æŠ¥æ–‡äº¤æ¢ï¼ˆMessage Switchingï¼‰</h4><p>æŠ¥æ–‡äº¤æ¢ä¸­çš„äº¤æ¢ç»“ç‚¹ä¹Ÿé‡‡ç”¨å­˜å‚¨è½¬å‘æ–¹å¼ï¼Œä½†æŠ¥æ–‡äº¤æ¢å¯¹æŠ¥æ–‡çš„å¤§å°æ²¡æœ‰é™åˆ¶ï¼Œè¿™å°±<strong>è¦æ±‚äº¤æ¢ç»“ç‚¹éœ€è¦è¾ƒå¤§çš„ç¼“å­˜ç©ºé—´</strong>ã€‚æŠ¥æ–‡äº¤æ¢ä¸»è¦ç”¨äºæ—©æœŸçš„ç”µæŠ¥é€šä¿¡ç½‘ï¼Œç°åœ¨è¾ƒå°‘ä½¿ç”¨ï¼Œ<strong>é€šå¸¸è¢«è¾ƒå…ˆè¿›çš„åˆ†ç»„äº¤æ¢æ–¹å¼æ‰€å–ä»£</strong>ã€‚</p><h4 id="ä¸‰ç§äº¤æ¢æ–¹å¼çš„å¯¹æ¯”"><a href="#ä¸‰ç§äº¤æ¢æ–¹å¼çš„å¯¹æ¯”" class="headerlink" title="ä¸‰ç§äº¤æ¢æ–¹å¼çš„å¯¹æ¯”"></a>ä¸‰ç§äº¤æ¢æ–¹å¼çš„å¯¹æ¯”</h4><blockquote><p>å‡è®¾Aï¼ŒBï¼ŒCï¼ŒDæ˜¯åˆ†ç»„ä¼ è¾“è·¯å¾„æ‰€è¦ç»è¿‡çš„4ä¸ªç»“ç‚¹äº¤æ¢æœºï¼Œçºµåæ ‡ä¸ºæ—¶é—´</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-e655a213714d1871.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>åˆ†æï¼š</p><p>ç”µè·¯äº¤æ¢ï¼š</p><ul><li>é€šä¿¡ä¹‹å‰é¦–å…ˆè¦å»ºç«‹è¿æ¥ï¼›è¿æ¥å»ºç«‹å¥½ä¹‹åï¼Œå°±å¯ä»¥ä½¿ç”¨å·²å»ºç«‹å¥½çš„è¿æ¥è¿›è¡Œæ•°æ®ä¼ é€ï¼›æ•°æ®ä¼ é€åï¼Œéœ€é‡Šæ”¾è¿æ¥ï¼Œä»¥å½’è¿˜ä¹‹å‰å»ºç«‹è¿æ¥æ‰€å ç”¨çš„é€šä¿¡çº¿è·¯èµ„æºã€‚</li><li>ä¸€æ—¦å»ºç«‹è¿æ¥ï¼Œä¸­é—´çš„å„ç»“ç‚¹äº¤æ¢æœºå°±æ˜¯ç›´é€šå½¢å¼çš„ï¼Œæ¯”ç‰¹æµå¯ä»¥ç›´è¾¾ç»ˆç‚¹ï¼›</li></ul><p>æŠ¥æ–‡äº¤æ¢ï¼š</p><ul><li>å¯ä»¥éšæ—¶å‘é€æŠ¥æ–‡ï¼Œè€Œä¸éœ€è¦äº‹å…ˆå»ºç«‹è¿æ¥ï¼›æ•´ä¸ªæŠ¥æ–‡å…ˆä¼ é€åˆ°ç›¸é‚»ç»“ç‚¹äº¤æ¢æœºï¼Œå…¨éƒ¨å­˜å‚¨ä¸‹æ¥åè¿›è¡ŒæŸ¥è¡¨è½¬å‘ï¼Œè½¬å‘åˆ°ä¸‹ä¸€ä¸ªç»“ç‚¹äº¤æ¢æœºã€‚</li><li>æ•´ä¸ªæŠ¥æ–‡éœ€è¦åœ¨å„ç»“ç‚¹äº¤æ¢æœºä¸Šè¿›è¡Œå­˜å‚¨è½¬å‘ï¼Œç”±äºä¸é™åˆ¶æŠ¥æ–‡å¤§å°ï¼Œå› æ­¤éœ€è¦å„ç»“ç‚¹äº¤æ¢æœºéƒ½å…·æœ‰è¾ƒå¤§çš„ç¼“å­˜ç©ºé—´ã€‚</li></ul><p>åˆ†ç»„äº¤æ¢ï¼š</p><ul><li>å¯ä»¥éšæ—¶å‘é€åˆ†ç»„ï¼Œè€Œä¸éœ€è¦äº‹å…ˆå»ºç«‹è¿æ¥ã€‚æ„æˆåŸå§‹æŠ¥æ–‡çš„ä¸€ä¸ªä¸ªåˆ†ç»„ï¼Œä¾æ¬¡åœ¨å„ç»“ç‚¹äº¤æ¢æœºä¸Šå­˜å‚¨è½¬å‘ã€‚å„ç»“ç‚¹äº¤æ¢æœºåœ¨å‘é€åˆ†ç»„çš„åŒæ—¶ï¼Œè¿˜ç¼“å­˜æ¥æ”¶åˆ°çš„åˆ†ç»„ã€‚</li><li>æ„æˆåŸå§‹æŠ¥æ–‡çš„ä¸€ä¸ªä¸ªåˆ†ç»„ï¼Œåœ¨å„ç»“ç‚¹äº¤æ¢æœºä¸Šè¿›è¡Œå­˜å‚¨è½¬å‘ï¼Œç›¸æ¯”æŠ¥æ–‡äº¤æ¢ï¼Œå‡å°‘äº†è½¬å‘æ—¶å»¶ï¼Œè¿˜å¯ä»¥é¿å…è¿‡é•¿çš„æŠ¥æ–‡é•¿æ—¶é—´å ç”¨é“¾è·¯ï¼ŒåŒæ—¶ä¹Ÿæœ‰åˆ©äºè¿›è¡Œå·®é”™æ§åˆ¶ã€‚</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-c56f91f290cbc92b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h3 id="1-3ã€è®¡ç®—æœºç½‘ç»œçš„å®šä¹‰å’Œåˆ†ç±»"><a href="#1-3ã€è®¡ç®—æœºç½‘ç»œçš„å®šä¹‰å’Œåˆ†ç±»" class="headerlink" title="1.3ã€è®¡ç®—æœºç½‘ç»œçš„å®šä¹‰å’Œåˆ†ç±»"></a>1.3ã€è®¡ç®—æœºç½‘ç»œçš„å®šä¹‰å’Œåˆ†ç±»</h3><h4 id="1ã€å®šä¹‰"><a href="#1ã€å®šä¹‰" class="headerlink" title="1ã€å®šä¹‰"></a>1ã€å®šä¹‰</h4><ul><li>è®¡ç®—æœºç½‘ç»œçš„ç²¾ç¡®å®šä¹‰å¹¶æœªç»Ÿä¸€</li><li>è®¡ç®—æœºç½‘ç»œçš„æœ€ç®€å•çš„å®šä¹‰æ˜¯ï¼šä¸€äº›<strong>äº’</strong>ç›¸<strong>è¿</strong>æ¥çš„ã€<strong>è‡ªæ²»</strong>çš„è®¡ç®—æœºçš„<strong>é›†åˆ</strong>ã€‚<ul><li>äº’è¿ï¼šæ˜¯æŒ‡è®¡ç®—æœºä¹‹é—´å¯ä»¥é€šè¿‡æœ‰çº¿æˆ–æ— çº¿çš„æ–¹å¼è¿›è¡Œæ•°æ®é€šä¿¡ï¼›</li><li>è‡ªæ²»ï¼šæ˜¯æŒ‡ç‹¬ç«‹çš„è®¡ç®—æœºï¼Œä»–æœ‰è‡ªå·±çš„ç¡¬ä»¶å’Œè½¯ä»¶ï¼Œå¯ä»¥å•ç‹¬è¿è¡Œä½¿ç”¨ï¼›</li><li>é›†åˆï¼šæ˜¯æŒ‡è‡³å°‘éœ€è¦ä¸¤å°è®¡ç®—æœºï¼›</li></ul></li><li>è®¡ç®—æœºç½‘ç»œçš„è¾ƒå¥½çš„å®šä¹‰æ˜¯ï¼šè®¡ç®—æœºç½‘ç»œä¸»è¦æ˜¯ç”±ä¸€äº›<strong>é€šç”¨çš„ï¼Œå¯ç¼–ç¨‹çš„ç¡¬ä»¶ï¼ˆä¸€å®šåŒ…å«æœ‰ä¸­å¤®å¤„ç†æœºCPUï¼‰äº’è¿</strong>è€Œæˆçš„ï¼Œè€Œè¿™äº›ç¡¬ä»¶å¹¶éä¸“é—¨ç”¨æ¥å®ç°æŸä¸€ç‰¹å®šç›®çš„ï¼ˆä¾‹å¦‚ï¼Œä¼ é€æ•°æ®æˆ–è§†é¢‘ä¿¡å·ï¼‰ã€‚è¿™äº›å¯ç¼–ç¨‹çš„ç¡¬ä»¶èƒ½å¤Ÿç”¨æ¥<strong>ä¼ é€å¤šç§ä¸åŒç±»å‹çš„æ•°æ®</strong>ï¼Œå¹¶èƒ½<strong>æ”¯æŒå¹¿æ³›çš„å’Œæ—¥ç›Šå¢é•¿çš„åº”ç”¨</strong>ã€‚<ul><li>è®¡ç®—æœºç½‘ç»œæ‰€è¿æ¥çš„ç¡¬ä»¶ï¼Œå¹¶ä¸é™äºä¸€èˆ¬çš„è®¡ç®—æœºï¼Œè€Œæ˜¯åŒ…æ‹¬äº†æ™ºèƒ½æ‰‹æœºç­‰æ™ºèƒ½ç¡¬ä»¶ã€‚</li><li>è®¡ç®—æœºç½‘ç»œå¹¶éä¸“é—¨ç”¨æ¥ä¼ é€æ•°æ®ï¼Œè€Œæ˜¯èƒ½å¤Ÿæ”¯æŒå¾ˆå¤šç§çš„åº”ç”¨ï¼ˆåŒ…æ‹¬ä»Šåå¯èƒ½å‡ºç°çš„å„ç§åº”ç”¨ï¼‰ã€‚</li></ul></li></ul><h4 id="2ã€åˆ†ç±»"><a href="#2ã€åˆ†ç±»" class="headerlink" title="2ã€åˆ†ç±»"></a>2ã€åˆ†ç±»</h4><p><strong>æŒ‰äº¤æ¢æŠ€æœ¯åˆ†ç±»ï¼š</strong></p><ul><li>ç”µè·¯äº¤æ¢ç½‘ç»œ</li><li>æŠ¥æ–‡äº¤æ¢ç½‘ç»œ</li><li>åˆ†ç»„äº¤æ¢ç½‘ç»œ</li></ul><p><strong>æŒ‰ä½¿ç”¨è€…åˆ†ç±»ï¼š</strong></p><ul><li>å…¬ç”¨ç½‘</li><li>ä¸“ç”¨ç½‘</li></ul><p><strong>æŒ‰ä¼ è¾“ä»‹è´¨åˆ†ç±»ï¼š</strong></p><ul><li>æœ‰çº¿ç½‘ç»œ</li><li>æ— çº¿ç½‘ç»œ</li></ul><p><strong>æŒ‰è¦†ç›–èŒƒå›´åˆ†ç±»ï¼š</strong></p><ul><li>å¹¿åŸŸç½‘WANï¼ˆWide Area Networkï¼‰</li></ul><p>ä½œç”¨èŒƒå›´é€šå¸¸ä¸ºå‡ ååˆ°å‡ åƒå…¬é‡Œï¼Œå› è€Œæœ‰æ—¶ä¹Ÿç§°ä¸ºè¿œç¨‹ç½‘ï¼ˆlong haul networkï¼‰ã€‚å¹¿åŸŸç½‘æ˜¯äº’è”ç½‘çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œå…¶ä»»åŠ¡æ˜¯é€šè¿‡é•¿è·ç¦»ï¼ˆä¾‹å¦‚ï¼Œè·¨è¶Šä¸åŒçš„å›½å®¶ï¼‰è¿é€ä¸»æœºæ‰€å‘é€çš„æ•°æ®ã€‚</p><ul><li>åŸåŸŸç½‘MAN</li></ul><p>ä½œç”¨èŒƒå›´ä¸€èˆ¬æ˜¯ä¸€ä¸ªåŸå¸‚ï¼Œå¯è·¨è¶Šå‡ ä¸ªè¡—åŒºç”šè‡³æ•´ä¸ªåŸå¸‚</p><ul><li>å±€åŸŸç½‘LAN</li></ul><p>ä¸€èˆ¬ç”¨å¾®å‹è®¡ç®—æœºæˆ–å·¥ä½œç«™é€šè¿‡é«˜é€Ÿé€šä¿¡çº¿è·¯ç›¸è¿ï¼ˆé€Ÿç‡é€šå¸¸åœ¨ 10 Mbit&#x2F;s ä»¥ä¸Šï¼‰ï¼Œä½†åœ°ç†ä¸ŠèŒƒå›´è¾ƒå°ï¼ˆ1 km å·¦å³ï¼‰</p><ul><li>ä¸ªåŸŸç½‘PAN</li></ul><p>å°±æ˜¯åœ¨ä¸ªäººå·¥ä½œçš„åœ°æ–¹æŠŠä¸ªäººä½¿ç”¨çš„ç”µå­è®¾å¤‡ç”¨æ— çº¿æŠ€æœ¯è¿æ¥èµ·æ¥çš„ç½‘ç»œã€‚</p><p><strong>æŒ‰æ‹“æ‰‘ç»“æ„åˆ†ç±»ï¼š</strong></p><ul><li>æ€»çº¿å‹ç½‘ç»œ</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-4ed63e74d9ced719.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/384/format/webp" alt="img"></p><ul><li>æ˜Ÿå‹ç½‘ç»œ</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f6a1849bcc443935.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/260/format/webp" alt="img"></p><ul><li>ç¯å½¢ç½‘ç»œ</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-ca133aaaf8fe8659.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/308/format/webp" alt="img"></p><ul><li>ç½‘çŠ¶å‹ç½‘ç»œ</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d0d30cddc7356396.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/557/format/webp" alt="img"></p><hr><h3 id="1-4ã€è®¡ç®—æœºç½‘ç»œçš„æ€§èƒ½æŒ‡æ ‡"><a href="#1-4ã€è®¡ç®—æœºç½‘ç»œçš„æ€§èƒ½æŒ‡æ ‡" class="headerlink" title="1.4ã€è®¡ç®—æœºç½‘ç»œçš„æ€§èƒ½æŒ‡æ ‡"></a>1.4ã€è®¡ç®—æœºç½‘ç»œçš„æ€§èƒ½æŒ‡æ ‡</h3><h4 id="1ã€é€Ÿç‡"><a href="#1ã€é€Ÿç‡" class="headerlink" title="1ã€é€Ÿç‡"></a>1ã€é€Ÿç‡</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-ba6c4e627a62c05e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-0c0d70a808407ca2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="2ã€å¸¦å®½"><a href="#2ã€å¸¦å®½" class="headerlink" title="2ã€å¸¦å®½"></a>2ã€å¸¦å®½</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f4b18e0039f4a6c6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="3ã€ååé‡"><a href="#3ã€ååé‡" class="headerlink" title="3ã€ååé‡"></a>3ã€ååé‡</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-0910421c209252b1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>å¸¦å®½1 Gb&#x2F;sçš„ä»¥å¤ªç½‘ï¼Œä»£è¡¨å…¶é¢å®šé€Ÿç‡æ˜¯1 Gb&#x2F;sï¼Œè¿™ä¸ªæ•°å€¼ä¹Ÿæ˜¯è¯¥ä»¥å¤ªç½‘çš„<strong>ååé‡çš„ç»å¯¹ä¸Šé™å€¼</strong>ã€‚å› æ­¤ï¼Œå¯¹äºå¸¦å®½1 Gb&#x2F;sçš„ä»¥å¤ªç½‘ï¼Œå¯èƒ½å®é™…ååé‡åªæœ‰ 700 Mb&#x2F;sï¼Œç”šè‡³æ›´ä½ã€‚</p><p>æ³¨æ„ï¼šååé‡è¿˜å¯ä»¥ç”¨æ¯ç§’ä¼ é€çš„å­—èŠ‚æ•°æˆ–å¸§æ•°è¡¨ç¤º</p></blockquote><h4 id="4ã€æ—¶å»¶"><a href="#4ã€æ—¶å»¶" class="headerlink" title="4ã€æ—¶å»¶"></a>4ã€æ—¶å»¶</h4><p>æ—¶å»¶æ—¶æŒ‡æ•°æ®ï¼ˆä¸€ä¸ªæŠ¥æ–‡æˆ–åˆ†ç»„ï¼Œç”šè‡³æ¯”ç‰¹ï¼‰ä»ç½‘ç»œï¼ˆæˆ–é“¾è·¯ï¼‰çš„ä¸€ç«¯ä¼ é€åˆ°å¦ä¸€ç«¯æ‰€éœ€çš„æ—¶é—´ã€‚</p><p>ç½‘ç»œæ—¶å»¶ç”±å‡ éƒ¨åˆ†ç»„æˆï¼š</p><ul><li>å‘é€æ—¶å»¶</li></ul><p><strong>ä¸»æœºæˆ–è·¯ç”±å™¨å‘é€æ•°æ®å¸§æ‰€éœ€è¦çš„æ—¶é—´</strong>ï¼Œä¹Ÿå°±æ˜¯ä»å‘é€æ•°æ®å¸§çš„ç¬¬ä¸€ä¸ªæ¯”ç‰¹ç®—èµ·ï¼Œåˆ°è¯¥å¸§çš„æœ€åä¸€ä¸ªæ¯”ç‰¹å‘é€å®Œæ¯•æ‰€éœ€çš„æ—¶é—´ã€‚</p><ul><li>ä¼ æ’­æ—¶å»¶</li></ul><p>ç”µç£æ³¢åœ¨ä¿¡é“ä¸­ä¼ æ’­ä¸€å®šçš„è·ç¦»éœ€è¦èŠ±è´¹çš„æ—¶é—´ã€‚</p><ul><li>å¤„ç†æ—¶å»¶</li></ul><p>ä¸»æœºæˆ–è·¯ç”±å™¨åœ¨æ”¶åˆ°åˆ†ç»„æ—¶è¦èŠ±è´¹ä¸€å®šæ—¶é—´è¿›è¡Œå¤„ç†</p><ul><li>æ’é˜Ÿæ—¶å»¶</li></ul><p>åˆ†ç»„åœ¨è¿›è¿‡ç½‘ç»œä¼ è¾“æ—¶ï¼Œè¦ç»è¿‡è®¸å¤šè·¯ç”±å™¨ã€‚ä½†åˆ†ç»„åœ¨è¿›å…¥è·¯ç”±å™¨åè¦å…ˆåœ¨è¾“å…¥é˜Ÿåˆ—ä¸­æ’é˜Ÿç­‰å¾…å¤„ç†ã€‚</p><blockquote><p>æœ‰æ—¶ä¼šæŠŠæ’é˜Ÿæ—¶å»¶çœ‹æˆ<strong>å¤„ç†æ—¶å»¶ ä¸€éƒ¨åˆ†</strong></p><p>æ€»æ—¶å»¶ &#x3D; å‘é€æ—¶å»¶ + ä¼ æ’­æ—¶å»¶ + å¤„ç†æ—¶å»¶ ï¼ˆå¤„ç†æ—¶å»¶ + æ’é˜Ÿæ—¶å»¶ï¼‰</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-5f9bf4982c20ad4f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-dd48cf5be5b2a7f7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>å½“å¤„ç†æ—¶å»¶å¿½ç•¥ä¸è®¡æ—¶ï¼Œå‘é€æ—¶å»¶ å’Œ ä¼ æ’­æ—¶å»¶è°å ä¸»å¯¼ï¼Œè¦å…·ä½“æƒ…å†µå…·ä½“åˆ†æ</p></blockquote><h4 id="5ã€æ—¶å»¶å¸¦å®½ç§¯"><a href="#5ã€æ—¶å»¶å¸¦å®½ç§¯" class="headerlink" title="5ã€æ—¶å»¶å¸¦å®½ç§¯"></a>5ã€æ—¶å»¶å¸¦å®½ç§¯</h4><p>æ—¶å»¶å¸¦å®½ç§¯ &#x3D; ä¼ æ’­æ—¶å»¶ * å¸¦å®½</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-bdca296e77c59e48.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="6ã€å¾€è¿”æ—¶é—´"><a href="#6ã€å¾€è¿”æ—¶é—´" class="headerlink" title="6ã€å¾€è¿”æ—¶é—´"></a>6ã€å¾€è¿”æ—¶é—´</h4><p>äº’è”ç½‘ä¸Šçš„ä¿¡æ¯ä¸ä»…ä»…å•æ–¹å‘ä¼ è¾“è€Œæ˜¯åŒå‘äº¤äº’çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æœ‰æ—¶å¾ˆéœ€è¦çŸ¥é“<strong>åŒå‘äº¤äº’ä¸€æ¬¡æ‰€éœ€çš„æ—¶é—´</strong>ã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-73f29eb38db9983c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="7ã€åˆ©ç”¨ç‡"><a href="#7ã€åˆ©ç”¨ç‡" class="headerlink" title="7ã€åˆ©ç”¨ç‡"></a>7ã€åˆ©ç”¨ç‡</h4><p>åˆ©ç”¨ç‡æœ‰<strong>ä¿¡é“åˆ©ç”¨ç‡</strong>å’Œ<strong>ç½‘ç»œåˆ©ç”¨ç‡</strong>ä¸¤ç§ã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-62d6da59682ef67f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="8ã€ä¸¢åŒ…ç‡"><a href="#8ã€ä¸¢åŒ…ç‡" class="headerlink" title="8ã€ä¸¢åŒ…ç‡"></a>8ã€ä¸¢åŒ…ç‡</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f8fc02096f0952b7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h3 id="1-5ã€è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„"><a href="#1-5ã€è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„" class="headerlink" title="1.5ã€è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„"></a>1.5ã€<strong>è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„</strong></h3><h4 id="1ã€å¸¸è§çš„è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„"><a href="#1ã€å¸¸è§çš„è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„" class="headerlink" title="1ã€å¸¸è§çš„è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„"></a>1ã€å¸¸è§çš„è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-b5174af1551d6cee.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>å¦‚ä»Šç”¨çš„æœ€å¤šçš„æ˜¯TCP&#x2F;IPä½“ç³»ç»“æ„ï¼Œç°ä»Šè§„æ¨¡æœ€å¤§çš„ã€è¦†ç›–å…¨çƒçš„ã€åŸºäºTCP&#x2F;IPçš„äº’è”ç½‘å¹¶æœªä½¿ç”¨OSIæ ‡å‡†ã€‚</p><p>TCP&#x2F;IPä½“ç³»ç»“æ„ç›¸å½“äºå°†OSIä½“ç³»ç»“æ„çš„<strong>ç‰©ç†å±‚</strong>å’Œ<strong>æ•°æ®é“¾è·¯å±‚</strong>åˆå¹¶ä¸ºäº†<strong>ç½‘ç»œæ¥å£å±‚</strong>ï¼Œå¹¶å»æ‰äº†<strong>ä¼šè¯å±‚</strong>å’Œ<strong>è¡¨ç¤ºå±‚</strong>ã€‚</p><p>TCP&#x2F;IPåœ¨ç½‘ç»œå±‚ä½¿ç”¨çš„åè®®æ˜¯IPåè®®ï¼ŒIPåè®®çš„æ„æ€æ˜¯ç½‘é™…åè®®ï¼Œå› æ­¤<strong>TCP&#x2F;IPä½“ç³»ç»“æ„çš„ç½‘ç»œå±‚ç§°ä¸ºç½‘é™…å±‚</strong></p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f647ab572971d89a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1126/format/webp" alt="img"></p><blockquote><p>åœ¨ç”¨æˆ·ä¸»æœºçš„æ“ä½œç³»ç»Ÿä¸­ï¼Œé€šå¸¸éƒ½å¸¦æœ‰ç¬¦åˆTCP&#x2F;IPä½“ç³»ç»“æ„æ ‡å‡†çš„TCP&#x2F;IPåè®®æ—ã€‚</p><p>è€Œç”¨äºç½‘ç»œäº’è¿çš„è·¯ç”±å™¨ä¸­ï¼Œä¹Ÿå¸¦æœ‰ç¬¦åˆTCP&#x2F;IPä½“ç³»ç»“æ„æ ‡å‡†çš„TCP&#x2F;IPåè®®æ—ã€‚</p><p>åªä¸è¿‡è·¯ç”±å™¨ä¸€èˆ¬åªåŒ…å«ç½‘ç»œæ¥å£å±‚å’Œç½‘é™…å±‚ã€‚</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6800e214b18c47c3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/931/format/webp" alt="img"></p><blockquote><p><strong>ç½‘ç»œæ¥å£å±‚</strong>ï¼šå¹¶æ²¡æœ‰è§„å®šå…·ä½“å†…å®¹ï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯å¯ä»¥äº’è¿å…¨ä¸–ç•Œå„ç§ä¸åŒçš„ç½‘ç»œæ¥å£ï¼Œä¾‹å¦‚ï¼šæœ‰çº¿çš„ä»¥å¤ªç½‘æ¥å£ï¼Œæ— çº¿å±€åŸŸç½‘çš„WIFIæ¥å£ç­‰ã€‚</p><p><strong>ç½‘é™…å±‚</strong>ï¼šå®ƒçš„æ ¸å¿ƒåè®®æ˜¯IPåè®®ã€‚</p><p><strong>è¿è¾“å±‚</strong>ï¼šTCPå’ŒUDPæ˜¯è¿™å±‚çš„ä¸¤ä¸ªé‡è¦åè®®ã€‚</p><p><strong>åº”ç”¨å±‚</strong>ï¼šè¿™å±‚åŒ…å«äº†å¤§é‡çš„åº”ç”¨å±‚åè®®ï¼Œå¦‚ HTTP , DNS ç­‰ã€‚</p></blockquote><blockquote><p><strong>IPåè®®ï¼ˆç½‘é™…å±‚ï¼‰</strong>å¯ä»¥å°†ä¸åŒçš„<strong>ç½‘ç»œæ¥å£ï¼ˆç½‘ç»œæ¥å£å±‚ï¼‰</strong>è¿›è¡Œäº’è¿ï¼Œå¹¶å‘å…¶ä¸Šçš„<strong>TCPåè®®å’ŒUDPåè®®ï¼ˆè¿è¾“å±‚ï¼‰</strong>æä¾›ç½‘ç»œäº’è¿æœåŠ¡</p><p>è€Œ<strong>TCPåè®®</strong>åœ¨äº«å—IPåè®®æä¾›çš„ç½‘ç»œäº’è¿æœåŠ¡çš„åŸºç¡€ä¸Šï¼Œå¯å‘<strong>åº”ç”¨å±‚çš„ç›¸åº”åè®®</strong>æä¾›<strong>å¯é </strong>çš„ä¼ è¾“æœåŠ¡ã€‚</p><p><strong>UDPåè®®</strong>åœ¨äº«å—IPåè®®æä¾›çš„ç½‘ç»œäº’è¿æœåŠ¡çš„åŸºç¡€ä¸Šï¼Œå¯å‘<strong>åº”ç”¨å±‚çš„ç›¸åº”åè®®</strong>æä¾›<strong>ä¸å¯é </strong>çš„ä¼ è¾“æœåŠ¡ã€‚</p></blockquote><blockquote><p>TCP&#x2F;IPä½“ç³»ç»“æ„ä¸­æœ€é‡è¦çš„æ˜¯<strong>IPåè®®</strong>å’Œ<strong>TCPåè®®</strong>ï¼Œå› æ­¤ç”¨TCPå’ŒIPæ¥è¡¨ç¤ºæ•´ä¸ªåè®®å¤§å®¶æ—ã€‚</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-82255e6c6d5f29bf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>æ•™å­¦æ—¶æŠŠTCP&#x2F;IPä½“ç³»ç»“æ„çš„<strong>ç½‘ç»œæ¥å£å±‚</strong>åˆ†æˆäº†<strong>ç‰©ç†å±‚</strong>å’Œ<strong>æ•°æ®é“¾è·¯å±‚</strong></p></blockquote><h4 id="2ã€è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„åˆ†å±‚çš„å¿…è¦æ€§"><a href="#2ã€è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„åˆ†å±‚çš„å¿…è¦æ€§" class="headerlink" title="2ã€è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„åˆ†å±‚çš„å¿…è¦æ€§"></a>2ã€è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„åˆ†å±‚çš„å¿…è¦æ€§</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-466a303e1e5cc42a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>ç‰©ç†å±‚é—®é¢˜</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-0274083e0bf0da85.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>è¿™å›¾è¯´æ˜</p><ul><li><p>ç¬¬ä¸€ï¼Œä¸¥æ ¼æ¥è¯´ï¼Œä¼ è¾“åª’ä½“å¹¶ä¸å±äºç‰©ç†å±‚</p></li><li><p>è®¡ç®—æœºä¼ è¾“çš„ä¿¡å·ï¼Œå¹¶ä¸æ˜¯å›¾ç¤ºçš„æ–¹æ³¢ä¿¡å·</p></li></ul><p>è¿™æ ·ä¸¾ä¾‹åªæ˜¯è®©åˆå­¦è€…å®¹æ˜“ç†è§£</p></blockquote><p><strong>æ•°æ®é“¾è·¯å±‚é—®é¢˜</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f0d9f2816d7bab9d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>ç½‘ç»œå±‚é—®é¢˜</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f55f86e0a78ffe23.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>è¿è¾“å±‚é—®é¢˜</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-20174ff3821a739b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>å¦‚ä½•æ ‡è¯†ä¸ç½‘ç»œé€šä¿¡ç›¸å…³çš„åº”ç”¨è¿›ç¨‹ï¼šä¸€ä¸ªåˆ†ç»„åˆ°æ¥ï¼Œæˆ‘ä»¬åº”è¯¥äº¤ç»™å“ªä¸ªè¿›ç¨‹å¤„ç†å‘¢ï¼Ÿæµè§ˆå™¨è¿›ç¨‹è¿˜æ˜¯QQè¿›ç¨‹</p></blockquote><p><strong>åº”ç”¨å±‚é—®é¢˜</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-edab6d1f00b0ab15.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>åº”ç”¨å±‚è¯¥ç”¨ä»€ä¹ˆæ–¹æ³•ï¼ˆåº”ç”¨å±‚åè®®ï¼‰å»è§£ææ•°æ®</p></blockquote><p><strong>æ€»ç»“</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-96bdae8525215011.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d29fee34f68a16b9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-1cf0ec9780d80019.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="3ã€è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„åˆ†å±‚æ€æƒ³ä¸¾ä¾‹"><a href="#3ã€è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„åˆ†å±‚æ€æƒ³ä¸¾ä¾‹" class="headerlink" title="3ã€è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„åˆ†å±‚æ€æƒ³ä¸¾ä¾‹"></a>3ã€è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„åˆ†å±‚æ€æƒ³ä¸¾ä¾‹</h4><p>ä¾‹å­ï¼šä¸»æœºçš„æµè§ˆå™¨å¦‚ä½•ä¸WebæœåŠ¡å™¨è¿›è¡Œé€šä¿¡</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-33e3c614a6ac37d0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>è§£æï¼š</strong></p><p>ä¸»æœºå’ŒWebæœåŠ¡å™¨ä¹‹é—´åŸºäºç½‘ç»œçš„é€šä¿¡ï¼Œå®é™…ä¸Šæ˜¯ä¸»æœºä¸­çš„<strong>æµè§ˆå™¨åº”ç”¨è¿›ç¨‹</strong>ä¸WebæœåŠ¡å™¨ä¸­çš„<strong>WebæœåŠ¡å™¨åº”ç”¨è¿›ç¨‹</strong>ä¹‹é—´åŸºäº<strong>ç½‘ç»œçš„é€šä¿¡</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-8c5d1b3fdc1b7111.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>ä½“ç³»ç»“æ„çš„å„å±‚åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­èµ·åˆ°æ€æ ·çš„ä½œç”¨ï¼Ÿ</strong></p><p><strong>1ã€å‘é€æ–¹å‘é€</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-ac36f7a9544dde9f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ç¬¬ä¸€æ­¥ï¼š</p><ul><li><p><strong>åº”ç”¨å±‚</strong>æŒ‰ç…§HTTPåè®®çš„è§„å®šæ„å»ºä¸€ä¸ª<strong>HTTPè¯·æ±‚æŠ¥æ–‡</strong></p></li><li><p>åº”ç”¨å±‚å°†<strong>HTTPè¯·æ±‚æŠ¥æ–‡</strong>äº¤ä»˜ç»™<strong>è¿è¾“å±‚</strong>å¤„ç†</p></li></ul></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-cc2b73b1736d5809.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ç¬¬äºŒæ­¥ï¼š</p><ul><li><p><strong>è¿è¾“å±‚</strong>ç»™<strong>HTTPè¯·æ±‚æŠ¥æ–‡</strong>æ·»åŠ ä¸€ä¸ª<strong>TCPé¦–éƒ¨</strong>ï¼Œä½¿ä¹‹æˆä¸º<strong>TCPæŠ¥æ–‡æ®µ</strong></p></li><li><p><strong>TCPæŠ¥æ–‡æ®µçš„é¦–éƒ¨æ ¼å¼</strong>ä½œç”¨æ˜¯åŒºåˆ†åº”ç”¨è¿›ç¨‹ï¼ˆå«æœ‰ç«¯å£ä¿¡æ¯ï¼‰ä»¥åŠå®ç°å¯é ä¼ è¾“</p></li><li><p><strong>è¿è¾“å±‚</strong>å°†<strong>TCPæŠ¥æ–‡æ®µ</strong>äº¤ä»˜ç»™<strong>ç½‘ç»œå±‚</strong>å¤„ç†</p></li></ul></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-dc02183dcf759d9e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ç¬¬ä¸‰æ­¥ï¼š</p><ul><li><p><strong>ç½‘ç»œå±‚</strong>ç»™<strong>TCPæŠ¥æ–‡æ®µ</strong>æ·»åŠ ä¸€ä¸ª<strong>IPé¦–éƒ¨</strong>ï¼Œä½¿ä¹‹æˆä¸º<strong>IPæ•°æ®æŠ¥</strong></p></li><li><p><strong>IPæ•°æ®æŠ¥çš„é¦–éƒ¨æ ¼å¼</strong>ä½œç”¨æ˜¯ä½¿<strong>IPæ•°æ®æŠ¥</strong>å¯ä»¥åœ¨äº’è”ç½‘ä¼ è¾“ï¼Œä¹Ÿå°±æ˜¯è¢«è·¯ç”±å™¨è½¬å‘</p></li><li><p><strong>ç½‘ç»œå±‚</strong>å°†<strong>IPæ•°æ®æŠ¥</strong>äº¤ä»˜ç»™<strong>æ•°æ®é“¾è·¯å±‚</strong>å¤„ç†</p></li></ul></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f8cf8ce4a6bfdb54.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ç¬¬å››æ­¥ï¼š</p><ul><li><p><strong>æ•°æ®é“¾è·¯å±‚</strong>ç»™<strong>IPæ•°æ®æŠ¥</strong>æ·»åŠ ä¸€ä¸ª<strong>é¦–éƒ¨</strong>å’Œä¸€ä¸ª<strong>å°¾éƒ¨</strong>ï¼Œä½¿ä¹‹æˆä¸º<strong>å¸§</strong> ï¼ˆå›¾ç¤ºå³è¾¹ä¸ºé¦–éƒ¨ï¼Œå·¦è¾¹ä¸ºå°¾éƒ¨ï¼‰</p></li><li><p>è¯¥<strong>é¦–éƒ¨</strong>çš„ä½œç”¨ä¸»è¦æ˜¯ä¸ºäº†è®©<strong>å¸§</strong>èƒ½å¤Ÿåœ¨ä¸€æ®µé“¾è·¯ä¸Šæˆ–ä¸€ä¸ªç½‘ç»œä¸Šä¼ è¾“ï¼Œèƒ½å¤Ÿè¢«ç›¸åº”çš„ç›®çš„ä¸»æœºæ¥æ”¶</p></li><li><p>è¯¥<strong>å°¾éƒ¨</strong>çš„ä½œç”¨æ˜¯è®©ç›®çš„ä¸»æœºæ£€æŸ¥æ‰€æ¥æ”¶åˆ°çš„<strong>å¸§</strong>æ˜¯å¦æœ‰è¯¯ç </p></li><li><p><strong>æ•°æ®é“¾è·¯å±‚</strong>å°†<strong>å¸§</strong>äº¤ä»˜ç»™<strong>ç‰©ç†å±‚</strong></p></li></ul></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-e7285afa504bce0d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ç¬¬äº”æ­¥ï¼š</p><ul><li><p><strong>ç‰©ç†å±‚</strong>å…ˆå°†<strong>å¸§</strong>çœ‹åšæ˜¯<strong>æ¯”ç‰¹æµ</strong>ï¼Œè¿™é‡Œçš„ç½‘ç»œN1å‡è®¾æ˜¯ä»¥å¤ªç½‘ï¼Œæ‰€ä»¥<strong>ç‰©ç†å±‚</strong>è¿˜ä¼šç»™è¯¥<strong>æ¯”ç‰¹æµ</strong>å‰é¢æ·»åŠ <strong>å‰å¯¼ç </strong></p></li><li><p><strong>å‰å¯¼ç </strong>çš„ä½œç”¨æ˜¯ä¸ºäº†è®©ç›®çš„ä¸»æœºåšå¥½æ¥æ”¶å¸§çš„å‡†å¤‡</p></li><li><p><strong>ç‰©ç†å±‚</strong>å°†è£…æœ‰<strong>å‰å¯¼ç </strong>çš„<strong>æ¯”ç‰¹æµ</strong>å˜æ¢æˆç›¸åº”çš„<strong>ä¿¡å·</strong>å‘é€ç»™ä¼ è¾“åª’ä½“</p></li></ul></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-8ffee68ffe58b8a1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ç¬¬å…­æ­¥ï¼š</p><ul><li><strong>ä¿¡å·</strong>é€šè¿‡<strong>ä¼ è¾“åª’ä½“</strong>åˆ°è¾¾<strong>è·¯ç”±å™¨</strong></li></ul></blockquote><p><strong>2ã€è·¯ç”±å™¨è½¬å‘</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-b9824f4625354b9b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/945/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-09a0b27933c9895e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/832/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6eace5a882cca26d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/697/format/webp" alt="img"></p><blockquote><p>åœ¨è·¯ç”±å™¨ä¸­</p><ul><li><p><strong>ç‰©ç†å±‚</strong>å°†<strong>ä¿¡å·</strong>å˜ä¸º<strong>æ¯”ç‰¹æµ</strong>ï¼Œç„¶åå»æ‰<strong>å‰å¯¼ç </strong>åï¼Œå°†å…¶äº¤ä»˜ç»™<strong>æ•°æ®é“¾è·¯å±‚</strong></p></li><li><p><strong>æ•°æ®é“¾è·¯å±‚</strong>å°†<strong>å¸§</strong>çš„<strong>é¦–éƒ¨</strong>å’Œ<strong>å°¾éƒ¨</strong>å»æ‰åï¼Œå°†å…¶äº¤ä»˜ç»™<strong>ç½‘ç»œå±‚</strong>ï¼Œè¿™å®é™…äº¤ä»˜çš„æ˜¯<strong>IPæ•°æ®æŠ¥</strong></p></li><li><p><strong>ç½‘ç»œå±‚</strong>è§£æ<strong>IPæ•°æ®æŠ¥</strong>çš„<strong>é¦–éƒ¨</strong>ï¼Œä»ä¸­æå–<strong>ç›®çš„ç½‘ç»œåœ°å€</strong>ï¼Œ<strong>æŸ¥æ‰¾</strong>è‡ªèº«çš„<strong>è·¯ç”±è¡¨</strong>ï¼Œ<strong>ç¡®å®šè½¬å‘ç«¯å£</strong>ï¼Œä»¥ä¾¿è¿›è¡Œè½¬å‘ã€‚</p></li></ul></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-bc79de20a0c4b57c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/638/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-33d09406bfc433e0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/674/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-28228b60dd019bb5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/740/format/webp" alt="img"></p><blockquote><p>åœ¨è·¯ç”±å™¨ä¸­</p><ul><li>æå–<strong>ç›®çš„ç½‘ç»œåœ°å€</strong>åæŸ¥æ‰¾<strong>è‡ªèº«è·¯ç”±è¡¨</strong>ã€‚ç¡®å®š<strong>è½¬å‘ç«¯å£</strong>ï¼Œ ä»¥ä¾¿è¿›è¡Œè½¬å‘</li></ul><p><strong>ç½‘ç»œå±‚</strong>å°†<strong>IPæ•°æ®æŠ¥</strong>äº¤ä»˜ç»™<strong>æ•°æ®é“¾è·¯å±‚</strong></p><ul><li><strong>æ•°æ®é“¾è·¯å±‚</strong>ç»™<strong>IPæ•°æ®æŠ¥</strong>æ·»åŠ ä¸€ä¸ª<strong>é¦–éƒ¨</strong>å’Œä¸€ä¸ª<strong>å°¾éƒ¨</strong>ï¼Œä½¿ä¹‹æˆä¸º<strong>å¸§</strong></li></ul><p><strong>æ•°æ®é“¾è·¯å±‚</strong>å°†å¸§äº¤ä»˜ç»™<strong>ç‰©ç†å±‚</strong></p><ul><li><strong>ç‰©ç†å±‚</strong>å…ˆå°†<strong>å¸§</strong>çœ‹æˆ<strong>æ¯”ç‰¹æµ</strong>ï¼Œè¿™é‡Œçš„ç½‘ç»œN2å‡è®¾æ˜¯ä»¥å¤ªç½‘ï¼Œæ‰€ä»¥<strong>ç‰©ç†å±‚</strong>è¿˜ä¼šç»™è¯¥<strong>æ¯”ç‰¹æµ</strong>å‰é¢æ·»åŠ <strong>å‰å¯¼ç </strong></li></ul><p>ç‰©ç†å±‚å°†è£…æœ‰<strong>å‰å¯¼ç </strong>çš„<strong>æ¯”ç‰¹æµ</strong>å˜æ¢æˆç›¸åº”çš„<strong>ä¿¡å·</strong>å‘é€ç»™ä¼ è¾“åª’ä½“ï¼Œä¿¡å·é€šè¿‡ä¼ è¾“åª’ä½“åˆ°è¾¾<strong>WebæœåŠ¡å™¨</strong></p></blockquote><p><strong>3ã€æ¥æ”¶æ–¹æ¥æ”¶</strong></p><blockquote><p>å’Œå‘é€æ–¹ï¼ˆä¸»æœºï¼‰å‘é€è¿‡ç¨‹çš„å°è£…æ­£å¥½æ˜¯åç€æ¥</p><p>åœ¨Web æœåŠ¡å™¨ä¸Š</p><ul><li><p><strong>ç‰©ç†å±‚</strong>å°†<strong>ä¿¡å·</strong>å˜æ¢ä¸º<strong>æ¯”ç‰¹æµ</strong>ï¼Œç„¶åå»æ‰<strong>å‰å¯¼ç </strong>åæˆä¸º<strong>å¸§</strong>ï¼Œäº¤ä»˜ç»™<strong>æ•°æ®é“¾è·¯å±‚</strong></p></li><li><p><strong>æ•°æ®é“¾è·¯å±‚</strong>å°†<strong>å¸§</strong>çš„<strong>é¦–éƒ¨</strong>å’Œ<strong>å°¾éƒ¨</strong>å»æ‰åæˆä¸º<strong>IPæ•°æ®æŠ¥</strong>ï¼Œå°†å…¶äº¤ä»˜ç»™<strong>ç½‘ç»œå±‚</strong></p></li><li><p><strong>ç½‘ç»œå±‚</strong>å°†<strong>IPæ•°æ®æŠ¥</strong>çš„<strong>é¦–éƒ¨</strong>å»æ‰åæˆä¸º<strong>TCPæŠ¥æ–‡æ®µ</strong>ï¼Œå°†å…¶äº¤ä»˜ç»™<strong>è¿è¾“å±‚</strong></p></li><li><p><strong>è¿è¾“å±‚</strong>å°†<strong>TCPæŠ¥æ–‡æ®µ</strong>çš„<strong>é¦–éƒ¨</strong>å»æ‰åæˆä¸º<strong>HTTPè¯·æ±‚æŠ¥æ–‡</strong>ï¼Œå°†å…¶äº¤ä»˜ç»™<strong>åº”ç”¨å±‚</strong></p></li><li><p><strong>åº”ç”¨å±‚</strong>å¯¹<strong>HTTPè¯·æ±‚æŠ¥æ–‡</strong>è¿›è¡Œ<strong>è§£æ</strong>ï¼Œç„¶åç»™ä¸»æœºå‘å›<strong>å“åº”æŠ¥æ–‡</strong></p></li></ul><p><strong>å‘å›å“åº”æŠ¥æ–‡çš„æ­¥éª¤å’Œä¹‹å‰è¿‡ç¨‹ç±»ä¼¼</strong></p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d9f5b6ce408c252b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="4ã€è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„ä¸­çš„ä¸“ç”¨æœ¯è¯­"><a href="#4ã€è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„ä¸­çš„ä¸“ç”¨æœ¯è¯­" class="headerlink" title="4ã€è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„ä¸­çš„ä¸“ç”¨æœ¯è¯­"></a>4ã€è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„ä¸­çš„ä¸“ç”¨æœ¯è¯­</h4><p>ä»¥ä¸‹ä»‹ç»çš„ä¸“ç”¨æœ¯è¯­æ¥æºäºOSIçš„ä¸ƒå±‚åè®®ä½“ç³»ç»“æ„ï¼Œä½†ä¹Ÿé€‚ç”¨äºTCP&#x2F;IPçš„å››å±‚ä½“ç³»ç»“æ„å’Œäº”å±‚åè®®ä½“ç³»ç»“æ„</p><p><strong>å®ä½“</strong>entity</p><blockquote><p>è¡¨ç¤ºä»»ä½•å‘é€æˆ–æ¥å—ä¿¡æ¯çš„ç¡¬ä»¶æˆ–è½¯ä»¶è¿›ç¨‹</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-b4c748c8f731e416.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>åè®®</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-01d621fd0afde0a2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>åè®®ï¼šæ§åˆ¶ä¸¤ä¸ªå¯¹ç­‰å®ä½“è¿›è¡Œé€»è¾‘é€šä¿¡çš„è§„åˆ™çš„é›†åˆ</p><p>åè®®ä¸‰è¦ç´ ï¼š</p><ul><li><p>è¯­æ³•ï¼šå®šä¹‰æ‰€äº¤æ¢ä¿¡æ¯çš„æ ¼å¼</p></li><li><p>è¯­ä¹‰ï¼šå®šä¹‰æ”¶å‘åŒæ–¹æ‰€è¦å®Œæˆçš„æ“ä½œ</p></li><li><p>åŒæ­¥ï¼šå®šä¹‰æ”¶å‘åŒå‘çš„æ—¶åºå…³ç³»</p></li></ul></blockquote><p><strong>æœåŠ¡</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-b3d7eb63257d9914.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>é€æ˜ï¼šå®é™…ä¸Šå­˜åœ¨ï¼Œä½†çœ‹èµ·æ¥ä¸å­˜åœ¨ã€‚(é€æ˜ç»ç’ƒé—¨)</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f24a75796ed2c7f6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f9bd7898a7f2dadd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h3 id="1-6ã€æ–°å…´æŠ€æœ¯"><a href="#1-6ã€æ–°å…´æŠ€æœ¯" class="headerlink" title="1.6ã€æ–°å…´æŠ€æœ¯"></a>1.6ã€æ–°å…´æŠ€æœ¯</h3><h4 id="1ã€äº‘è®¡ç®—"><a href="#1ã€äº‘è®¡ç®—" class="headerlink" title="1ã€äº‘è®¡ç®—"></a>1ã€äº‘è®¡ç®—</h4><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202209050856805.png" alt="image-20220905085606669"></p><p>äº‘è®¡ç®—æœåŠ¡ç±»å‹ï¼š</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202209050858193.png" alt="image-20220905085800118"></p><blockquote><p>PaaSåœ¨Iaasä¸Šå¼€å‘ï¼Œç»™ç”¨æˆ·æä¾›åº”ç”¨ç¨‹åºçš„å¼€å‘ç¯å¢ƒã€‚</p><p>SaaSå°†æŸäº›ç‰¹å®šçš„è½¯ä»¶åŠŸèƒ½å°è£…æˆæœåŠ¡ï¼Œç»™ç”¨æˆ·ç§Ÿèµä½¿ç”¨ã€‚</p></blockquote><p><img src="https://img-blog.csdnimg.cn/20190904220012497.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2N4dTEyMzMyMQ==,size_16,color_FFFFFF,t_70" alt="img"></p><p>IaaSï¼šInfrastructure-as-a-Service(åŸºç¡€è®¾æ–½å³æœåŠ¡)<br><strong>ç¬¬ä¸€å±‚å«åšIaaS</strong><br>ä¸¾ä¾‹ï¼šå‡ å¹´å‰å¦‚æœä½ æƒ³åœ¨åŠå…¬å®¤æˆ–è€…å…¬å¸çš„ç½‘ç«™ä¸Šè¿è¡Œä¸€äº›ä¼ä¸šåº”ç”¨ï¼Œä½ éœ€è¦å»ä¹°æœåŠ¡å™¨ï¼Œæˆ–è€…åˆ«çš„é«˜æ˜‚çš„ç¡¬ä»¶æ¥æ§åˆ¶æœ¬åœ°åº”ç”¨ï¼Œæ‰èƒ½è®©ä½ çš„ä¸šåŠ¡æ­£å¸¸è¿è¡Œã€‚<br>ä½†ç°åœ¨å¯ä»¥ç§Ÿç”¨IaaSå…¬å¸æä¾›çš„åœºå¤–æœåŠ¡å™¨ï¼Œå­˜å‚¨å’Œç½‘ç»œç¡¬ä»¶ã€‚è¿™æ ·ä¸€æ¥ï¼Œä¾¿å¤§å¤§çš„èŠ‚çœäº†ç»´æŠ¤æˆæœ¬å’ŒåŠå…¬åœºåœ°ã€‚<br>PaaSï¼šPlatform-as-a-Service(å¹³å°å³æœåŠ¡)<br><strong>ç¬¬äºŒå±‚å°±æ˜¯æ‰€è°“çš„PaaS</strong><br>ä¸¾ä¾‹ï¼š PaaSå…¬å¸åœ¨ç½‘ä¸Šæä¾›å„ç§å¼€å‘å’Œåˆ†å‘åº”ç”¨çš„è§£å†³æ–¹æ¡ˆï¼Œæ¯”å¦‚è™šæ‹ŸæœåŠ¡å™¨å’Œæ“ä½œç³»ç»Ÿã€‚è¿™èŠ‚çœäº†ä½ åœ¨ç¡¬ä»¶ä¸Šçš„è´¹ç”¨ï¼Œä¹Ÿè®©åˆ†æ•£çš„å·¥ä½œå®¤ä¹‹é—´çš„åˆä½œå˜å¾—æ›´åŠ å®¹æ˜“ã€‚ç½‘é¡µåº”ç”¨ç®¡ç†ï¼Œåº”ç”¨è®¾è®¡ï¼Œåº”ç”¨è™šæ‹Ÿä¸»æœºï¼Œå­˜å‚¨ï¼Œå®‰å…¨ä»¥åŠåº”ç”¨å¼€å‘åä½œå·¥å…·ç­‰ã€‚<br>SaaSï¼šSoftware-as-a-Service(è½¯ä»¶å³æœåŠ¡)<br><strong>ç¬¬ä¸‰å±‚ä¹Ÿå°±æ˜¯æ‰€è°“SaaS</strong><br>ä¸¾ä¾‹ï¼šç”Ÿæ´»ä¸­ï¼Œå‡ ä¹æˆ‘ä»¬æ¯ä¸€å¤©éƒ½åœ¨æ¥è§¦SaaSäº‘æœåŠ¡ï¼Œæ¯”å¦‚ï¼šæˆ‘ä»¬å¹³æ—¶ä½¿ç”¨çš„è‹¹æœæ‰‹æœºäº‘æœåŠ¡ï¼Œç½‘é¡µä¸­çš„ä¸€äº›äº‘æœåŠ¡ç­‰ã€‚</p><h4 id="2ã€ç‰©è”ç½‘"><a href="#2ã€ç‰©è”ç½‘" class="headerlink" title="2ã€ç‰©è”ç½‘"></a>2ã€ç‰©è”ç½‘</h4><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202209050905576.png" alt="image-20220905090555499"></p><p>ç‰©è”ç½‘ä¸‰ç§åŸºæœ¬çš„åº”ç”¨æ¨¡å¼</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202209050911211.png" alt="image-20220905091139119"></p><h2 id="äºŒã€ç‰©ç†å±‚"><a href="#äºŒã€ç‰©ç†å±‚" class="headerlink" title="äºŒã€ç‰©ç†å±‚"></a>äºŒã€ç‰©ç†å±‚</h2><h3 id="2-1ã€ç‰©ç†å±‚çš„åŸºæœ¬æ¦‚å¿µ"><a href="#2-1ã€ç‰©ç†å±‚çš„åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="2.1ã€ç‰©ç†å±‚çš„åŸºæœ¬æ¦‚å¿µ"></a>2.1ã€ç‰©ç†å±‚çš„åŸºæœ¬æ¦‚å¿µ</h3><p><img src="https://upload-images.jianshu.io/upload_images/24878825-9b987d868b26c714.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><hr><h3 id="2-2ã€ç‰©ç†å±‚ä¸‹é¢çš„ä¼ è¾“åª’ä½“"><a href="#2-2ã€ç‰©ç†å±‚ä¸‹é¢çš„ä¼ è¾“åª’ä½“" class="headerlink" title="2.2ã€ç‰©ç†å±‚ä¸‹é¢çš„ä¼ è¾“åª’ä½“"></a>2.2ã€ç‰©ç†å±‚ä¸‹é¢çš„ä¼ è¾“åª’ä½“</h3><p><strong>ä¼ è¾“åª’ä½“</strong>ä¹Ÿç§°ä¸ºä¼ è¾“ä»‹è´¨æˆ–ä¼ è¾“åª’ä»‹ï¼Œä»–å°±æ˜¯æ•°æ®ä¼ è¾“ç³»ç»Ÿä¸­åœ¨å‘é€å™¨å’Œæ¥æ”¶å™¨ä¹‹é—´çš„ç‰©ç†é€šè·¯ã€‚<strong>ä¼ è¾“åª’ä½“</strong>è¯¾åˆ†ä¸ºä¸¤å¤§ç±»ï¼Œå³<strong>å¯¼å¼•å‹ä¼ è¾“åª’ä½“</strong>å’Œ<strong>éå¯¼å¼•å‹ä¼ è¾“åª’ä½“</strong></p><p>ä¼ è¾“åª’ä½“ä¸å±äºè®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„çš„ä»»ä½•ä¸€å±‚ã€‚å¦‚æœéè¦å°†å®ƒæ·»åŠ åˆ°ä½“ç³»ç»“æ„ä¸­ï¼Œé‚£åªèƒ½å°†å…¶æ”¾ç½®åˆ°ç‰©ç†å±‚ä¹‹ä¸‹ã€‚</p><h4 id="1ã€å¯¼å¼•å‹ä¼ è¾“åª’ä½“"><a href="#1ã€å¯¼å¼•å‹ä¼ è¾“åª’ä½“" class="headerlink" title="1ã€å¯¼å¼•å‹ä¼ è¾“åª’ä½“"></a>1ã€å¯¼å¼•å‹ä¼ è¾“åª’ä½“</h4><p>åœ¨å¯¼å¼•å‹ä¼ è¾“åª’ä½“ä¸­ï¼Œç”µç£æ³¢è¢«å¯¼å¼•æ²¿ç€å›ºä½“åª’ä½“ä¼ æ’­ã€‚</p><p><strong>åŒè½´ç”µç¼†</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-50d3acc8eff03935.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>åŒç»çº¿</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-692dde0bbbc49a1d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>çº¿çš„é¡ºåº</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">568B ç™½æ©™ æ©™ ç™½ç»¿ è“ ç™½è“ ç»¿ ç™½æ£• æ£•</span><br><span class="line">568A 13æ¢ 26æ¢</span><br></pre></td></tr></table></figure><p><strong>å…‰çº¤</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-fc85597b91c2cd7a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-060d940d8451692e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p><strong>å¤šæ¨¡å…‰çº¤</strong></p><ul><li>å¯ä»¥å­˜åœ¨å¤šæ¡ä¸åŒè§’åº¦å…¥å°„çš„å…‰çº¿åœ¨ä¸€æ¡å…‰çº¤ä¸­ä¼ è¾“ã€‚è¿™ç§å…‰çº¤å°±ç§°ä¸º<strong>å¤šæ¨¡å…‰çº¤</strong>ã€‚</li><li>ç›´å¾„50-60å¾®ç±³</li><li>å¤´å‘ä¸60-90å¾®ç±³</li></ul><p><strong>å•æ¨¡å…‰çº¤</strong></p><ul><li>è‹¥å…‰çº¤çš„ç›´å¾„å‡å°åˆ°åªæœ‰ä¸€ä¸ªå…‰çš„æ³¢é•¿ï¼Œåˆ™å…‰çº¤å°±åƒä¸€æ ¹æ³¢å¯¼é‚£æ ·ï¼Œå®ƒå¯ä½¿å…‰çº¿ä¸€ç›´å‘å‰ä¼ æ’­ï¼Œè€Œä¸ä¼šäº§ç”Ÿå¤šæ¬¡åå°„ã€‚è¿™æ ·çš„å…‰çº¤ç§°ä¸º<strong>å•æ¨¡å…‰çº¤</strong>ã€‚</li><li>ç›´å¾„8-10å¾®ç±³</li></ul></blockquote><p><strong>ç”µåŠ›çº¿</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-2c23cb1d18aa345c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1175/format/webp" alt="img"></p><h4 id="2ã€éå¯¼å¼•å‹ä¼ è¾“åª’ä½“"><a href="#2ã€éå¯¼å¼•å‹ä¼ è¾“åª’ä½“" class="headerlink" title="2ã€éå¯¼å¼•å‹ä¼ è¾“åª’ä½“"></a>2ã€éå¯¼å¼•å‹ä¼ è¾“åª’ä½“</h4><p>ä¼˜ç‚¹ï¼š</p><ul><li>ä½¿ç”¨é¢‘æ®µå¹¿ã€‚</li><li>ä½¿ç”¨æ–¹ä¾¿ã€‚</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>ä¿å¯†æ€§ä¸å¥½ã€‚</li><li>æ˜“å—å¤–ç•Œå¹²æ‰°ã€‚</li></ul><p>éå¯¼å¼•å‹ä¼ è¾“åª’ä½“æ˜¯æŒ‡è‡ªç”±ç©ºé—´ã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-8432039f51003722.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d2a8692970355b05.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>æ— çº¿ç”µæ³¢</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-357bc29ed7591006.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>å¾®æ³¢</strong></p><p>å¾®æ³¢ä¸»è¦æ˜¯ç›´çº¿ä¼ æ’­</p><p>å¢å¤§ä¼ æ’­è·ç¦»çš„è¯ï¼š</p><ul><li>åœ°é¢å¾®æ³¢æ¥åŠ›é€šä¿¡</li><li>å«æ˜Ÿé€šä¿¡(è¾ƒå¤§çš„ä¼ æ’­æ—¶å»¶)</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f042b478ef808a1a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>çº¢å¤–çº¿</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-95eac658ca822ab2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>å¯è§å…‰</strong></p><p><a href="https://links.jianshu.com/go?to=https://baike.baidu.com/item/%E5%8F%AF%E8%A7%81%E5%85%89%E6%97%A0%E7%BA%BF%E9%80%9A%E4%BF%A1/16268518?fromtitle=LiFi&fromid=5675729&fr=aladdin">LIFI</a></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-e1bc3e93ff50114b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><hr><h3 id="2-3ã€ä¼ è¾“æ–¹å¼"><a href="#2-3ã€ä¼ è¾“æ–¹å¼" class="headerlink" title="2.3ã€ä¼ è¾“æ–¹å¼"></a>2.3ã€ä¼ è¾“æ–¹å¼</h3><h4 id="1ã€ä¸²è¡Œä¼ è¾“å’Œå¹¶è¡Œä¼ è¾“"><a href="#1ã€ä¸²è¡Œä¼ è¾“å’Œå¹¶è¡Œä¼ è¾“" class="headerlink" title="1ã€ä¸²è¡Œä¼ è¾“å’Œå¹¶è¡Œä¼ è¾“"></a>1ã€ä¸²è¡Œä¼ è¾“å’Œå¹¶è¡Œä¼ è¾“</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-54b03a1b4fd3cdd8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/787/format/webp" alt="img"></p><blockquote><p><strong>ä¸²è¡Œä¼ è¾“</strong>ï¼š</p><ul><li>æ•°æ®æ˜¯<code>ä¸€ä¸ªæ¯”ç‰¹ä¸€ä¸ªæ¯”ç‰¹ä¾æ¬¡å‘é€</code>çš„ï¼Œå› æ­¤åœ¨å‘é€ç«¯ä¸æ¥æ”¶ç«¯ä¹‹é—´ï¼Œåªéœ€è¦ä¸€æ¡æ•°æ®ä¼ è¾“çº¿è·¯å³å¯</li></ul><p><strong>å¹¶è¡Œä¼ è¾“</strong>ï¼š</p><ul><li><p><code>ä¸€æ¬¡å‘é€nä¸ªæ¯”ç‰¹</code>ï¼Œå› æ­¤ï¼Œåœ¨å‘é€ç«¯å’Œæ¥æ”¶ç«¯ä¹‹é—´éœ€è¦æœ‰næ¡ä¼ è¾“çº¿è·¯</p></li><li><p>å¹¶è¡Œä¼ è¾“çš„ä¼˜ç‚¹æ˜¯æ¯”ä¸²è¡Œä¼ è¾“çš„é€Ÿåº¦nå€ï¼Œä½†æˆæœ¬é«˜</p></li></ul><p>æ•°æ®åœ¨ä¼ è¾“çº¿è·¯ä¸Šçš„ä¼ è¾“é‡‡ç”¨æ˜¯<strong>ä¸²è¡Œä¼ è¾“</strong>ï¼Œè®¡ç®—æœºå†…éƒ¨çš„æ•°æ®ä¼ è¾“å¸¸ç”¨<strong>å¹¶è¡Œä¼ è¾“</strong></p></blockquote><h4 id="2ã€åŒæ­¥ä¼ è¾“å’Œå¼‚æ­¥ä¼ è¾“"><a href="#2ã€åŒæ­¥ä¼ è¾“å’Œå¼‚æ­¥ä¼ è¾“" class="headerlink" title="2ã€åŒæ­¥ä¼ è¾“å’Œå¼‚æ­¥ä¼ è¾“"></a>2ã€åŒæ­¥ä¼ è¾“å’Œå¼‚æ­¥ä¼ è¾“</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-15060e3d8de110ba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p><strong>åŒæ­¥ä¼ è¾“</strong>ï¼š</p><ul><li><p>æ•°æ®å—ä»¥ç¨³å®šçš„æ¯”ç‰¹æµçš„å½¢å¼ä¼ è¾“ã€‚å­—èŠ‚ä¹‹é—´æ²¡æœ‰é—´éš”</p></li><li><p>æ¥æ”¶ç«¯åœ¨æ¯ä¸ªæ¯”ç‰¹ä¿¡å·çš„ä¸­é—´æ—¶åˆ»è¿›è¡Œæ£€æµ‹ï¼Œä»¥åˆ¤åˆ«æ¥æ”¶åˆ°çš„æ˜¯æ¯”ç‰¹0è¿˜æ˜¯æ¯”ç‰¹1</p></li><li><p>ç”±äºä¸åŒè®¾å¤‡çš„æ—¶é’Ÿé¢‘ç‡å­˜åœ¨ä¸€å®šå·®å¼‚ï¼Œä¸å¯èƒ½åšåˆ°å®Œå…¨ç›¸åŒï¼Œåœ¨ä¼ è¾“å¤§é‡æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œæ‰€äº§ç”Ÿçš„åˆ¤åˆ«æ—¶åˆ»çš„ç´¯è®¡è¯¯å·®ï¼Œä¼šå¯¼è‡´æ¥æ”¶ç«¯å¯¹æ¯”ç‰¹ä¿¡å·çš„åˆ¤åˆ«é”™ä½</p></li></ul><p>æ‰€ä»¥è¦ä½¿æ”¶å‘åŒå‘æ—¶é’Ÿä¿æŒåŒæ­¥</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-19cfd094ecef0538.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p><strong>å¼‚æ­¥ä¼ è¾“</strong>ï¼š</p><ul><li><p>ä»¥å­—èŠ‚ä¸ºç‹¬ç«‹çš„ä¼ è¾“å•ä½ï¼Œå­—èŠ‚ä¹‹é—´çš„æ—¶é—´é—´éš”ä¸æ˜¯å›ºå®š</p></li><li><p>æ¥æ”¶ç«¯ä»…åœ¨æ¯ä¸ªå­—èŠ‚çš„èµ·å§‹å¤„å¯¹å­—èŠ‚å†…çš„æ¯”ç‰¹å®ç°åŒæ­¥</p></li><li><p>é€šå¸¸åœ¨æ¯ä¸ªå­—èŠ‚å‰ååˆ†åˆ«åŠ ä¸Šèµ·å§‹ä½å’Œç»“æŸä½</p></li></ul></blockquote><h4 id="3ã€å•å‘é€šä¿¡ï¼ˆå•å·¥ï¼‰ã€åŒå‘äº¤æ›¿é€šä¿¡ï¼ˆåŠåŒå·¥ï¼‰å’ŒåŒå‘åŒæ—¶é€šä¿¡ï¼ˆå…¨åŒå·¥ï¼‰"><a href="#3ã€å•å‘é€šä¿¡ï¼ˆå•å·¥ï¼‰ã€åŒå‘äº¤æ›¿é€šä¿¡ï¼ˆåŠåŒå·¥ï¼‰å’ŒåŒå‘åŒæ—¶é€šä¿¡ï¼ˆå…¨åŒå·¥ï¼‰" class="headerlink" title="3ã€å•å‘é€šä¿¡ï¼ˆå•å·¥ï¼‰ã€åŒå‘äº¤æ›¿é€šä¿¡ï¼ˆåŠåŒå·¥ï¼‰å’ŒåŒå‘åŒæ—¶é€šä¿¡ï¼ˆå…¨åŒå·¥ï¼‰"></a>3ã€å•å‘é€šä¿¡ï¼ˆå•å·¥ï¼‰ã€åŒå‘äº¤æ›¿é€šä¿¡ï¼ˆåŠåŒå·¥ï¼‰å’ŒåŒå‘åŒæ—¶é€šä¿¡ï¼ˆå…¨åŒå·¥ï¼‰</h4><p>åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨â€œ<strong>ä¿¡é“ï¼ˆchannelï¼‰</strong>â€è¿™ä¸€åè¯ã€‚ä¿¡é“å’Œç”µè·¯å¹¶ä¸ç­‰åŒã€‚ä¿¡é“ä¸€èˆ¬éƒ½æ˜¯ç”¨æ¥è¡¨ç¤ºå‘æŸä¸€ä¸ªæ–¹å‘ä¼ é€ä¿¡æ¯çš„åª’ä½“ã€‚å› æ­¤ï¼Œä¸€æ¡é€šä¿¡ç”µè·¯å¾€å¾€åŒ…å«ä¸€æ¡å‘é€ä¿¡é“å’Œä¸€æ¡æ¥æ”¶ä¿¡é“ã€‚</p><p>ä»é€šä¿¡çš„åŒæ–¹ä¿¡æ¯äº¤äº’çš„æ–¹å¼æ¥çœ‹ï¼Œå¯ä»¥æœ‰ä»¥ä¸‹ä¸‰ç§åŸºæœ¬æ–¹å¼ï¼š</p><p><strong>å•å‘é€šä¿¡</strong>ï¼š</p><p>åˆç§°ä¸º<strong>å•å·¥é€šä¿¡</strong>ï¼Œå³åªèƒ½æœ‰ä¸€ä¸ªæ–¹å‘çš„é€šä¿¡è€Œæ²¡æœ‰åæ–¹å‘çš„äº¤äº’ã€‚æ— çº¿ç”µå¹¿æ’­æˆ–æœ‰çº¿ç”µä»¥åŠç”µè§†å¹¿æ’­å°±å±äºè¿™ç§ç±»å‹</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-5b07729ff4cd3411.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>åŒå‘äº¤æ›¿é€šä¿¡</strong>ï¼š</p><p>åˆç§°ä¸º<strong>åŠåŒå·¥é€šä¿¡</strong>ï¼Œå³é€šä¿¡çš„åŒæ–¹å¯ä»¥å‘é€ä¿¡æ¯ï¼Œä½†ä¸èƒ½åŒæ–¹åŒæ—¶å‘é€ï¼ˆå½“ç„¶ä¹Ÿå°±ä¸èƒ½åŒæ—¶æ¥æ”¶ï¼‰ã€‚è¿™ç§é€šä¿¡æ–¹å¼ä½¿ä¸€æ–¹å‘é€å¦ä¸€æ–¹æ¥æ”¶ï¼Œè¿‡ä¸€æ®µæ—¶é—´åå¯ä»¥å†åè¿‡æ¥</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-e0f90a502a95d1b4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>åŒå‘åŒæ—¶é€šä¿¡</strong>ï¼š</p><p>åˆç§°ä¸º<strong>å…¨åŒå·¥é€šä¿¡</strong>ï¼Œå³é€šä¿¡çš„åŒå‘å¯ä»¥åŒæ—¶å‘é€å’Œæ¥æ”¶ä¿¡æ¯ã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-68977b7eeac3b7f2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p><strong>å•å‘é€šä¿¡</strong>åªéœ€è¦ä¸€æ¡ä¿¡é“ï¼Œè€Œ<strong>åŒå‘äº¤æ›¿é€šä¿¡</strong>æˆ–<strong>åŒå‘åŒæ—¶é€šä¿¡</strong>åˆ™éœ€è¦ä¸¤æ¡ä¿¡é“ï¼ˆæ¯ä¸ªæ–¹å‘å„ä¸€æ¡ï¼‰</p><p><strong>åŒå‘åŒæ—¶é€šä¿¡</strong>çš„ä¼ è¾“æ•ˆç‡æœ€é«˜</p></blockquote><h3 id="2-4ã€ç¼–ç ä¸è°ƒåˆ¶"><a href="#2-4ã€ç¼–ç ä¸è°ƒåˆ¶" class="headerlink" title="2.4ã€ç¼–ç ä¸è°ƒåˆ¶"></a>2.4ã€ç¼–ç ä¸è°ƒåˆ¶</h3><p><img src="https://upload-images.jianshu.io/upload_images/24878825-acc59055804f0890.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p><strong>å¸¸ç”¨æœ¯è¯­</strong></p><ul><li><p>æ¶ˆæ¯(message)â€”-æ–‡å­—ï¼Œå›¾ç‰‡ï¼ŒéŸ³é¢‘ï¼Œè§†é¢‘</p></li><li><p><strong>æ•°æ® (data)</strong> â€”â€” è¿é€æ¶ˆæ¯çš„å®ä½“ã€‚</p></li><li><p><strong>ä¿¡å· (signal)</strong> â€”â€” æ•°æ®çš„ç”µæ°”çš„æˆ–ç”µç£çš„è¡¨ç°ã€‚</p></li><li><p><strong>æ¨¡æ‹Ÿä¿¡å· (analogous signal)</strong> â€”â€” ä»£è¡¨æ¶ˆæ¯çš„å‚æ•°çš„å–å€¼æ˜¯è¿ç»­çš„ã€‚</p></li><li><p><strong>æ•°å­—ä¿¡å· (digital signal)</strong> â€”â€” ä»£è¡¨æ¶ˆæ¯çš„å‚æ•°çš„å–å€¼æ˜¯ç¦»æ•£çš„ã€‚</p></li><li><p><strong>ç å…ƒ (code)</strong> â€”â€” åœ¨ä½¿ç”¨æ—¶é—´åŸŸï¼ˆæˆ–ç®€ç§°ä¸ºæ—¶åŸŸï¼‰çš„æ³¢å½¢è¡¨ç¤ºæ•°å­—ä¿¡å·æ—¶ï¼Œä»£è¡¨ä¸åŒç¦»æ•£æ•°å€¼çš„åŸºæœ¬æ³¢å½¢ã€‚</p></li><li><p><strong>åŸºå¸¦ä¿¡å·</strong>ï¼ˆå³åŸºæœ¬é¢‘å¸¦ä¿¡å·ï¼‰â€”â€” æ¥è‡ªä¿¡æºçš„ä¿¡å·ã€‚åƒè®¡ç®—æœºè¾“å‡ºçš„ä»£è¡¨å„ç§æ–‡å­—æˆ–å›¾åƒæ–‡ä»¶çš„æ•°æ®ä¿¡å·éƒ½å±äºåŸºå¸¦ä¿¡å·ã€‚</p></li><li><p>åŸºå¸¦ä¿¡å·å¾€å¾€åŒ…å«æœ‰è¾ƒå¤šçš„ä½é¢‘æˆåˆ†ï¼Œç”šè‡³æœ‰ç›´æµæˆåˆ†ï¼Œè€Œè®¸å¤šä¿¡é“å¹¶ä¸èƒ½ä¼ è¾“è¿™ç§ä½é¢‘åˆ†é‡æˆ–ç›´æµåˆ†é‡ã€‚å› æ­¤å¿…é¡»å¯¹åŸºå¸¦ä¿¡å·è¿›è¡Œ<strong>è°ƒåˆ¶</strong> (modulation)ã€‚</p></li></ul></blockquote><p>åœ¨è®¡ç®—æœºç½‘ç»œä¸­ï¼Œå¸¸è§çš„æ˜¯å°†æ•°å­—åŸºå¸¦ä¿¡å·é€šè¿‡ç¼–ç æˆ–è°ƒåˆ¶çš„æ–¹æ³•åœ¨ç›¸åº”ä¿¡é“è¿›è¡Œä¼ è¾“</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-ded8a3e566f7687b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/715/format/webp" alt="img"></p><h4 id="1ã€ä¼ è¾“åª’ä½“ä¸ä¿¡é“çš„å…³ç³»"><a href="#1ã€ä¼ è¾“åª’ä½“ä¸ä¿¡é“çš„å…³ç³»" class="headerlink" title="1ã€ä¼ è¾“åª’ä½“ä¸ä¿¡é“çš„å…³ç³»"></a>1ã€<strong>ä¼ è¾“åª’ä½“ä¸ä¿¡é“çš„å…³ç³»</strong></h4><blockquote><p><strong>ä¿¡é“çš„å‡ ä¸ªåŸºæœ¬æ¦‚å¿µ</strong></p><ul><li><p><strong>ä¿¡é“</strong> â€”â€” ä¸€èˆ¬ç”¨æ¥è¡¨ç¤ºå‘æŸä¸€ä¸ªæ–¹å‘ä¼ é€ä¿¡æ¯çš„åª’ä½“ã€‚</p></li><li><p><strong>å•å‘é€šä¿¡ï¼ˆå•å·¥é€šä¿¡ï¼‰</strong>â€”â€”åªèƒ½æœ‰ä¸€ä¸ªæ–¹å‘çš„é€šä¿¡è€Œæ²¡æœ‰åæ–¹å‘çš„äº¤äº’ã€‚</p></li><li><p><strong>åŒå‘äº¤æ›¿é€šä¿¡ï¼ˆåŠåŒå·¥é€šä¿¡ï¼‰</strong>â€”â€”é€šä¿¡çš„åŒæ–¹éƒ½å¯ä»¥å‘é€ä¿¡æ¯ï¼Œä½†ä¸èƒ½åŒæ–¹åŒæ—¶å‘é€(å½“ç„¶ä¹Ÿå°±ä¸èƒ½åŒæ—¶æ¥æ”¶)ã€‚</p></li><li><p><strong>åŒå‘åŒæ—¶é€šä¿¡ï¼ˆå…¨åŒå·¥é€šä¿¡ï¼‰</strong>â€”â€”é€šä¿¡çš„åŒæ–¹å¯ä»¥åŒæ—¶å‘é€å’Œæ¥æ”¶ä¿¡æ¯ã€‚</p></li></ul></blockquote><p>ä¸¥æ ¼æ¥è¯´ï¼Œä¼ è¾“åª’ä½“ä¸èƒ½å’Œä¿¡é“åˆ’ç­‰å·</p><p>å¯¹äºå•å·¥ä¼ è¾“ï¼Œä¼ è¾“åª’ä½“åªåŒ…å«ä¸€ä¸ªä¿¡é“ï¼Œè¦ä¹ˆæ˜¯å‘é€ä¿¡é“ï¼Œè¦ä¹ˆæ˜¯æ¥æ”¶ä¿¡é“</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-414f829a7df390e6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/893/format/webp" alt="img"></p><p>å¯¹äºåŠåŒå·¥å’Œå…¨åŒå·¥ï¼Œä¼ è¾“åª’ä½“ä¸­è¦åŒ…å«ä¸¤ä¸ªä¿¡é“ï¼Œä¸€ä¸ªå‘é€ä¿¡é“ï¼Œå¦ä¸€ä¸ªæ˜¯æ¥æ”¶ä¿¡é“</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d3b3583526407c45.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/827/format/webp" alt="img"></p><blockquote><p>å¦‚æœä½¿ç”¨ä¿¡é“å¤ç”¨æŠ€æœ¯ï¼Œä¸€æ¡ä¼ è¾“åª’ä½“è¿˜å¯ä»¥åŒ…å«å¤šä¸ªä¿¡é“</p></blockquote><h4 id="2ã€å¸¸ç”¨ç¼–ç "><a href="#2ã€å¸¸ç”¨ç¼–ç " class="headerlink" title="2ã€å¸¸ç”¨ç¼–ç "></a>2ã€å¸¸ç”¨ç¼–ç </h4><p><strong>ä¸å½’é›¶ç¼–ç </strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-2f6b70fef84339ec.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><ul><li><p>æ­£ç”µå¹³è¡¨ç¤ºæ¯”ç‰¹1&#x2F;0</p></li><li><p>è´Ÿç”µå¹³è¡¨ç¤ºæ¯”ç‰¹0&#x2F;1</p></li></ul><p>ä¸­é—´çš„è™šçº¿æ˜¯é›¶ç”µå¹³ï¼Œæ‰€è°“ä¸å½’é›¶ç¼–ç ï¼Œå°±æ˜¯æŒ‡åœ¨æ•´ä¸ªç å…ƒæ—¶é—´å†…ï¼Œç”µå¹³ä¸ä¼šå‡ºç°é›¶ç”µå¹³</p><p><strong>å®é™…æ¯”ç‰¹1å’Œæ¯”ç‰¹0çš„è¡¨ç¤ºè¦çœ‹ç°å®æ€ä¹ˆè§„å®š</strong></p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-0732d0edc74846b5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>è¿™éœ€è¦å‘é€æ–¹çš„å‘é€ä¸æ¥æ”¶æ–¹çš„æ¥æ”¶åšåˆ°ä¸¥æ ¼çš„åŒæ­¥</p><ul><li><p>éœ€è¦<strong>é¢å¤–ä¸€æ ¹ä¼ è¾“çº¿æ¥ä¼ è¾“æ—¶é’Ÿä¿¡å·</strong>ï¼Œä½¿å‘é€æ–¹å’Œæ¥æ”¶æ–¹åŒæ­¥ï¼Œæ¥æ”¶æ–¹æŒ‰æ—¶é’Ÿä¿¡å·çš„èŠ‚æ‹æ¥é€ä¸ªæ¥æ”¶ç å…ƒ</p></li><li><p><strong>ä½†æ˜¯</strong>å¯¹äºè®¡ç®—æœºç½‘ç»œï¼Œ<strong>å®æ„¿åˆ©ç”¨è¿™æ ¹ä¼ è¾“çº¿ä¼ è¾“æ•°æ®ä¿¡å·</strong>ï¼Œè€Œä¸æ˜¯ä¼ è¾“æ—¶é’Ÿä¿¡å·</p></li></ul><p>ç”±äº<strong>ä¸å½’é›¶ç¼–ç </strong>å­˜åœ¨<strong>åŒæ­¥é—®é¢˜</strong>ï¼Œå› æ­¤è®¡ç®—æœºç½‘ç»œä¸­çš„æ•°æ®ä¼ è¾“ä¸é‡‡ç”¨è¿™ç±»ç¼–ç ï¼</p></blockquote><p><strong>å½’é›¶ç¼–ç </strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-8aa838a116fdafb4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-2fa351ff35477f1a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/723/format/webp" alt="img"></p><blockquote><p><strong>å½’é›¶ç¼–ç </strong>è™½ç„¶<strong>è‡ªåŒæ­¥</strong>ï¼Œä½†<strong>ç¼–ç æ•ˆç‡ä½</strong></p></blockquote><p><strong>æ›¼å½»æ–¯ç‰¹ç¼–ç </strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-a34a686a9d052e9c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>åœ¨æ¯ä¸ªç å…ƒæ—¶é—´çš„ä¸­é—´æ—¶åˆ»ï¼Œä¿¡å·éƒ½ä¼šå‘ç”Ÿè·³å˜</p><ul><li><p>è´Ÿè·³å˜è¡¨ç¤ºæ¯”ç‰¹1&#x2F;0</p></li><li><p>æ­£è·³å˜è¡¨ç¤ºæ¯”ç‰¹0&#x2F;1</p></li><li><p>ç å…ƒä¸­é—´æ—¶åˆ»çš„è·³å˜å³è¡¨ç¤ºæ—¶é’Ÿï¼Œåˆè¡¨ç¤ºæ•°æ®</p></li></ul><p><strong>å®é™…æ¯”ç‰¹1å’Œæ¯”ç‰¹0çš„è¡¨ç¤ºè¦çœ‹ç°å®æ€ä¹ˆè§„å®š</strong></p><p>ä¼ ç»Ÿä»¥å¤ªç½‘ä½¿ç”¨çš„å°±æ˜¯æ›¼åˆ‡æ–¯ç‰¹ç¼–ç </p></blockquote><p><strong>å·®åˆ†æ›¼å½»æ–¯ç‰¹ç¼–ç </strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-9a758474e374329a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>åœ¨æ¯ä¸ªç å…ƒæ—¶é—´çš„ä¸­é—´æ—¶åˆ»ï¼Œä¿¡å·éƒ½ä¼šå‘é€è·³å˜ï¼Œä½†ä¸<strong>æ›¼å½»æ–¯ç‰¹ä¸åŒ</strong></p><ul><li><p><strong>è·³å˜ä»…è¡¨ç¤ºæ—¶é’Ÿ</strong></p></li><li><p><strong>ç å…ƒå¼€å§‹å¤„ç”µå¹³æ˜¯å¦å˜æ¢è¡¨ç¤ºæ•°æ®</strong></p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*   å˜åŒ–è¡¨ç¤ºæ¯”ç‰¹1/0</span><br><span class="line">*   ä¸å˜åŒ–è¡¨ç¤ºæ¯”ç‰¹0/1</span><br></pre></td></tr></table></figure><p><strong>å®é™…æ¯”ç‰¹1å’Œæ¯”ç‰¹0çš„è¡¨ç¤ºè¦çœ‹ç°å®æ€ä¹ˆè§„å®š</strong></p><p>æ¯”æ›¼å½»æ–¯ç‰¹ç¼–ç å˜åŒ–å°‘ï¼Œæ›´é€‚åˆè¾ƒé«˜çš„ä¼ è¾“é€Ÿç‡</p></blockquote><p><strong>æ€»ç»“</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-de92dd43d328b4f7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="3ã€è°ƒåˆ¶"><a href="#3ã€è°ƒåˆ¶" class="headerlink" title="3ã€è°ƒåˆ¶"></a>3ã€è°ƒåˆ¶</h4><p>æ•°å­—ä¿¡å·è½¬æ¢ä¸ºæ¨¡æ‹Ÿä¿¡å·ï¼Œåœ¨æ¨¡æ‹Ÿä¿¡é“ä¸­ä¼ è¾“ï¼Œä¾‹å¦‚WiFiï¼Œé‡‡ç”¨è¡¥ç é”®æ§CCK&#x2F;ç›´æ¥åºåˆ—æ‰©é¢‘DSSS&#x2F;æ­£äº¤é¢‘åˆ†å¤ç”¨OFDMç­‰<strong>è°ƒåˆ¶</strong>æ–¹å¼ã€‚</p><p>æ¨¡æ‹Ÿä¿¡å·è½¬æ¢ä¸ºå¦ä¸€ç§æ¨¡æ‹Ÿä¿¡å·ï¼Œåœ¨æ¨¡æ‹Ÿä¿¡é“ä¸­ä¼ è¾“ï¼Œä¾‹å¦‚ï¼Œè¯­éŸ³æ•°æ®åŠ è½½åˆ°æ¨¡æ‹Ÿçš„è½½æ³¢ä¿¡å·ä¸­ä¼ è¾“ã€‚é¢‘åˆ†å¤ç”¨FDMæŠ€æœ¯ï¼Œå……åˆ†åˆ©ç”¨å¸¦å®½èµ„æºã€‚</p><p><strong>åŸºæœ¬è°ƒåˆ¶æ–¹æ³•</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-7ce461637de91b6e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><ul><li><p><strong>è°ƒå¹…AM</strong>ï¼šæ‰€è°ƒåˆ¶çš„ä¿¡å·ç”±ä¸¤ç§ä¸åŒæŒ¯å¹…çš„åŸºæœ¬æ³¢å½¢æ„æˆã€‚æ¯ä¸ªåŸºæœ¬æ³¢å½¢åªèƒ½è¡¨ç¤º1æ¯”ç‰¹ä¿¡æ¯é‡ã€‚</p></li><li><p><strong>è°ƒé¢‘FM</strong>ï¼šæ‰€è°ƒåˆ¶çš„ä¿¡å·ç”±ä¸¤ç§ä¸åŒé¢‘ç‡çš„åŸºæœ¬æ³¢å½¢æ„æˆã€‚æ¯ä¸ªåŸºæœ¬æ³¢å½¢åªèƒ½è¡¨ç¤º1æ¯”ç‰¹ä¿¡æ¯é‡ã€‚</p></li><li><p><strong>è°ƒç›¸PM</strong>ï¼šæ‰€è°ƒåˆ¶çš„ä¿¡å·ç”±ä¸¤ç§ä¸åŒåˆç›¸ä½çš„åŸºæœ¬æ³¢å½¢æ„æˆã€‚æ¯ä¸ªåŸºæœ¬æ³¢å½¢åªèƒ½è¡¨ç¤º1æ¯”ç‰¹ä¿¡æ¯é‡ã€‚</p></li></ul><p>ä½†æ˜¯ä½¿ç”¨åŸºæœ¬è°ƒåˆ¶æ–¹æ³•ï¼Œ1ä¸ªç å…ƒåªèƒ½åŒ…å«1ä¸ªæ¯”ç‰¹ä¿¡æ¯</p></blockquote><p><strong>æ··åˆè°ƒåˆ¶</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-8fec8ccb7ff3ea77.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/680/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-30e70220d4127135.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/642/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-1cb6de826ba63b70.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-600f7802e1eaa18a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä¸Šå›¾ç å…ƒæ‰€å¯¹åº”çš„4ä¸ªæ¯”ç‰¹æ˜¯é”™è¯¯çš„ï¼Œç å…ƒä¸èƒ½éšä¾¿å¯¹åº”4ä¸ªæ¯”ç‰¹</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-1e2617434d904ce4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="4ã€ç å…ƒ"><a href="#4ã€ç å…ƒ" class="headerlink" title="4ã€ç å…ƒ"></a>4ã€ç å…ƒ</h4><p>åœ¨ä½¿ç”¨æ—¶é—´åŸŸçš„æ³¢å½¢è¡¨ç¤ºæ•°å­—ä¿¡å·æ—¶ï¼Œä»£è¡¨ä¸åŒç¦»æ•£æ•°å€¼çš„åŸºæœ¬æ³¢å½¢ã€‚</p><h3 id="2-5ã€ä¿¡é“çš„æé™å®¹é‡"><a href="#2-5ã€ä¿¡é“çš„æé™å®¹é‡" class="headerlink" title="2.5ã€ä¿¡é“çš„æé™å®¹é‡"></a>2.5ã€ä¿¡é“çš„æé™å®¹é‡</h3><ul><li>ä»»ä½•å®é™…çš„ä¿¡é“éƒ½ä¸æ˜¯ç†æƒ³çš„ï¼Œåœ¨ä¼ è¾“ä¿¡å·æ—¶ä¼šäº§ç”Ÿå„ç§å¤±çœŸä»¥åŠå¸¦æ¥å¤šç§å¹²æ‰°ã€‚</li><li>ç å…ƒä¼ è¾“çš„é€Ÿç‡è¶Šé«˜ï¼Œæˆ–ä¿¡å·ä¼ è¾“çš„è·ç¦»è¶Šè¿œï¼Œæˆ–ä¼ è¾“åª’ä½“è´¨é‡è¶Šå·®ï¼Œåœ¨ä¿¡é“çš„è¾“å‡ºç«¯çš„æ³¢å½¢çš„å¤±çœŸå°±è¶Šä¸¥é‡ã€‚</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-0a9bbf5bcd5e8226.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>å¤±çœŸçš„åŸå› ï¼š</p><ul><li>ç å…ƒä¼ è¾“çš„é€Ÿç‡è¶Šé«˜</li><li>ä¿¡å·ä¼ è¾“çš„è·ç¦»è¶Šè¿œ</li><li>å™ªå£°å¹²æ‰°è¶Šå¤§</li><li>ä¼ è¾“åª’ä½“è´¨é‡è¶Šå·®</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-b90918937a54faa6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-57e105e5df793b93.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>å¥ˆæ°å‡†åˆ™å’Œé¦™å†œå…¬å¼å¯¹æ¯”ï¼š</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-5ce50e745950c8eb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">c=lamda/f</span><br><span class="line">få¤§ lamda(æ³¢é•¿)å°  æŠ˜å…‰ç‡å°  ä¼ è¾“é€Ÿç‡é«˜</span><br></pre></td></tr></table></figure><h3 id="2-6ã€è¡¥å……ï¼šä¿¡é“å¤ç”¨æŠ€æœ¯"><a href="#2-6ã€è¡¥å……ï¼šä¿¡é“å¤ç”¨æŠ€æœ¯" class="headerlink" title="2.6ã€è¡¥å……ï¼šä¿¡é“å¤ç”¨æŠ€æœ¯"></a>2.6ã€è¡¥å……ï¼šä¿¡é“å¤ç”¨æŠ€æœ¯</h3><p>æœ¬èŠ‚å†…å®¹è§†é¢‘æœªè®²åˆ°ï¼Œæ˜¯ã€Šè®¡ç®—æœºç½‘ç»œï¼ˆç¬¬7ç‰ˆï¼‰è°¢å¸Œä»ã€‹ç‰©ç†å±‚çš„å†…å®¹</p><h4 id="1ã€é¢‘åˆ†å¤ç”¨ã€æ—¶åˆ†å¤ç”¨å’Œç»Ÿè®¡æ—¶åˆ†å¤ç”¨"><a href="#1ã€é¢‘åˆ†å¤ç”¨ã€æ—¶åˆ†å¤ç”¨å’Œç»Ÿè®¡æ—¶åˆ†å¤ç”¨" class="headerlink" title="1ã€é¢‘åˆ†å¤ç”¨ã€æ—¶åˆ†å¤ç”¨å’Œç»Ÿè®¡æ—¶åˆ†å¤ç”¨"></a>1ã€é¢‘åˆ†å¤ç”¨ã€æ—¶åˆ†å¤ç”¨å’Œç»Ÿè®¡æ—¶åˆ†å¤ç”¨</h4><p><code>å¤ç”¨</code> (multiplexing) æ˜¯é€šä¿¡æŠ€æœ¯ä¸­çš„åŸºæœ¬æ¦‚å¿µã€‚</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202209070948991.png" alt="image-20220907094842852"></p><p>å®ƒå…è®¸ç”¨æˆ·ä½¿ç”¨ä¸€ä¸ªå…±äº«ä¿¡é“è¿›è¡Œé€šä¿¡ï¼Œé™ä½æˆæœ¬ï¼Œæé«˜åˆ©ç”¨ç‡ã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-8503f147c44d220f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>é¢‘åˆ†å¤ç”¨ FDM (Frequency Division Multiplexing)</strong></p><ul><li><p>å°†æ•´ä¸ªå¸¦å®½åˆ†ä¸ºå¤šä»½ï¼Œç”¨æˆ·åœ¨åˆ†é…åˆ°ä¸€å®šçš„é¢‘å¸¦åï¼Œåœ¨é€šä¿¡è¿‡ç¨‹ä¸­è‡ªå§‹è‡³ç»ˆéƒ½å ç”¨è¿™ä¸ªé¢‘å¸¦ã€‚</p></li><li><p><strong>é¢‘åˆ†å¤ç”¨</strong>: æ‰€æœ‰ç”¨æˆ·åœ¨åŒæ ·çš„æ—¶é—´<strong>å ç”¨ä¸åŒçš„å¸¦å®½èµ„æº</strong>ã€‚</p><p>ï¼ˆè¯·æ³¨æ„ï¼Œè¿™é‡Œçš„â€œå¸¦å®½â€æ˜¯é¢‘ç‡å¸¦å®½è€Œä¸æ˜¯æ•°æ®çš„å‘é€é€Ÿç‡ï¼‰ã€‚</p></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-bcb9321a6a8a3d7a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/425/format/webp" alt="img"></p><p><strong>æ—¶åˆ†å¤ç”¨TDM (Time Division Multiplexing)</strong></p><ul><li><strong>æ—¶åˆ†å¤ç”¨</strong>åˆ™æ˜¯å°†æ—¶é—´åˆ’åˆ†ä¸ºä¸€æ®µæ®µç­‰é•¿çš„<strong>æ—¶åˆ†å¤ç”¨å¸§ï¼ˆTDMå¸§ï¼‰</strong>ã€‚æ¯ä¸€ä¸ªæ—¶åˆ†å¤ç”¨çš„ç”¨æˆ·åœ¨æ¯ä¸€ä¸ª TDM å¸§ä¸­å ç”¨å›ºå®šåºå·çš„æ—¶éš™ã€‚</li><li>æ¯ä¸€ä¸ªç”¨æˆ·æ‰€å ç”¨çš„æ—¶éš™æ˜¯<strong>å‘¨æœŸæ€§åœ°å‡ºç°</strong>ï¼ˆå…¶å‘¨æœŸå°±æ˜¯TDMå¸§çš„é•¿åº¦ï¼‰çš„ã€‚</li><li>TDM ä¿¡å·ä¹Ÿç§°ä¸º<strong>ç­‰æ—¶</strong> (isochronous) ä¿¡å·ã€‚</li><li><strong>æ—¶åˆ†å¤ç”¨çš„æ‰€æœ‰ç”¨æˆ·åœ¨ä¸åŒçš„æ—¶é—´å ç”¨åŒæ ·çš„é¢‘å¸¦å®½åº¦ã€‚</strong></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-cb9a20b7ce00d497.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><ul><li><strong>æ—¶åˆ†å¤ç”¨å¯èƒ½ä¼šé€ æˆçº¿è·¯èµ„æºçš„æµªè´¹</strong><ul><li>ä½¿ç”¨æ—¶åˆ†å¤ç”¨ç³»ç»Ÿä¼ é€è®¡ç®—æœºæ•°æ®æ—¶ï¼Œç”±äºè®¡ç®—æœºæ•°æ®çš„çªå‘æ€§è´¨ï¼Œç”¨æˆ·å¯¹åˆ†é…åˆ°çš„å­ä¿¡é“çš„åˆ©ç”¨ç‡ä¸€èˆ¬æ˜¯ä¸é«˜çš„ã€‚</li></ul></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-c1ef02caf1f2cfda.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>ç»Ÿè®¡æ—¶åˆ†å¤ç”¨ STDM (Statistic TDM)</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-7f0b54d1c14702ca.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="2ã€æ³¢åˆ†å¤ç”¨"><a href="#2ã€æ³¢åˆ†å¤ç”¨" class="headerlink" title="2ã€æ³¢åˆ†å¤ç”¨"></a>2ã€æ³¢åˆ†å¤ç”¨</h4><p>æ³¢åˆ†å¤ç”¨ WDM(Wavelength Division Multiplexing)</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-039cdf67599ebe3b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="3ã€ç åˆ†å¤ç”¨"><a href="#3ã€ç åˆ†å¤ç”¨" class="headerlink" title="3ã€ç åˆ†å¤ç”¨"></a>3ã€ç åˆ†å¤ç”¨</h4><p>ç åˆ†å¤ç”¨ CDM (Code Division Multiplexing)</p><ul><li><p>å¸¸ç”¨çš„åè¯æ˜¯<strong>ç åˆ†å¤šå€</strong> CDMA (Code Division Multiple Access)ã€‚</p></li><li><p>å„ç”¨æˆ·ä½¿ç”¨ç»è¿‡ç‰¹æ®ŠæŒ‘é€‰çš„ä¸åŒç å‹ï¼Œå› æ­¤å½¼æ­¤ä¸ä¼šé€ æˆå¹²æ‰°ã€‚</p></li><li><p>è¿™ç§ç³»ç»Ÿå‘é€çš„ä¿¡å·æœ‰å¾ˆå¼ºçš„æŠ—å¹²æ‰°èƒ½åŠ›ï¼Œå…¶é¢‘è°±ç±»ä¼¼äºç™½å™ªå£°ï¼Œä¸æ˜“è¢«æ•Œäººå‘ç°</p></li><li><p>æ¯ä¸ªç«™è¢«æŒ‡æ´¾ä¸€ä¸ªå”¯ä¸€çš„m bitç ç‰‡åºåˆ—ã€‚<img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202209070959799.png" alt="image-20220907095947736"><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202209071000511.png" alt="image-20220907100030447"></p></li><li><p>æ¯ä¸ªç«™åˆ†é…çš„ç ç‰‡åºåˆ—ä¸ä»…å¿…é¡»å„ä¸ç›¸åŒï¼Œå¹¶ä¸”è¿˜å¿…é¡»äº’ç›¸æ­£äº¤</p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202209071001180.png" alt="image-20220907100157104"></p></li></ul><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202209071003875.png" alt="image-20220907100341773"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202209071004544.png" alt="image-20220907100459454"></p><h3 id="2-7ã€æ•°æ®é€šä¿¡åŸºç¡€çŸ¥è¯†"><a href="#2-7ã€æ•°æ®é€šä¿¡åŸºç¡€çŸ¥è¯†" class="headerlink" title="2.7ã€æ•°æ®é€šä¿¡åŸºç¡€çŸ¥è¯†"></a>2.7ã€æ•°æ®é€šä¿¡åŸºç¡€çŸ¥è¯†</h3><h4 id="1ã€æ•°æ®é€šä¿¡ç³»ç»Ÿçš„æ¨¡å‹"><a href="#1ã€æ•°æ®é€šä¿¡ç³»ç»Ÿçš„æ¨¡å‹" class="headerlink" title="1ã€æ•°æ®é€šä¿¡ç³»ç»Ÿçš„æ¨¡å‹"></a>1ã€æ•°æ®é€šä¿¡ç³»ç»Ÿçš„æ¨¡å‹</h4><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202209050939203.png" alt="image-20220905093934114"></p><h4 id="2ã€å‡ ä¸ªæœ¯è¯­"><a href="#2ã€å‡ ä¸ªæœ¯è¯­" class="headerlink" title="2ã€å‡ ä¸ªæœ¯è¯­"></a>2ã€å‡ ä¸ªæœ¯è¯­</h4><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202209050941323.png" alt="image-20220905094143239"></p><h4 id="3ã€ç¼–ç ä¸è°ƒåˆ¶"><a href="#3ã€ç¼–ç ä¸è°ƒåˆ¶" class="headerlink" title="3ã€ç¼–ç ä¸è°ƒåˆ¶"></a>3ã€ç¼–ç ä¸è°ƒåˆ¶</h4><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202209050945884.png" alt="image-20220905094514786"></p><ul><li><p>æ•°å­—æ•°æ®è½¬æ¢æˆæ•°å­—ä¿¡å·ç§°ä¸º<code>ç¼–ç </code></p></li><li><p>æ•°å­—æ•°æ®è½¬åŒ–ä¸ºæ¨¡æ‹Ÿä¿¡å·ç§°ä¸º<code>è°ƒåˆ¶</code></p></li></ul><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202209050956678.png" alt="image-20220905095624573"></p><h3 id="2-8ã€æœ€åä¸€å…¬é‡Œ"><a href="#2-8ã€æœ€åä¸€å…¬é‡Œ" class="headerlink" title="2.8ã€æœ€åä¸€å…¬é‡Œ"></a>2.8ã€æœ€åä¸€å…¬é‡Œ</h3><blockquote><ol><li>ç”µè¯ç½‘æ¥å…¥</li><li>ADSLæ¥å…¥</li><li>å…‰çº¤åŒè½´æ··åˆç½‘HFC</li><li>ç”¨æˆ·æœºé¡¶ç›’</li><li>æ— çº¿æ¥å…¥</li></ol></blockquote><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202209140858701.png" alt="image-20220914085850551"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202209140900494.png" alt="image-20220914090004395"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202209140906825.png" alt="image-20220914090615720"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202209140909715.png" alt="image-20220914090924625"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202209140911514.png" alt="image-20220914091156413"></p><p><img src="C:/Users/huangruidong/AppData/Roaming/Typora/typora-user-images/image-20220914093143805.png" alt="image-20220914093143805"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202209140938392.png" alt="image-20220914093809273"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202209140949987.png" alt="image-20220914094946888"></p><h2 id="ä¸‰ã€æ•°æ®é“¾è·¯å±‚"><a href="#ä¸‰ã€æ•°æ®é“¾è·¯å±‚" class="headerlink" title="ä¸‰ã€æ•°æ®é“¾è·¯å±‚"></a>ä¸‰ã€æ•°æ®é“¾è·¯å±‚</h2><h3 id="3-1ã€æ•°æ®é“¾è·¯å±‚æ¦‚è¿°"><a href="#3-1ã€æ•°æ®é“¾è·¯å±‚æ¦‚è¿°" class="headerlink" title="3.1ã€æ•°æ®é“¾è·¯å±‚æ¦‚è¿°"></a>3.1ã€æ•°æ®é“¾è·¯å±‚æ¦‚è¿°</h3><h4 id="1ã€æ¦‚è¿°"><a href="#1ã€æ¦‚è¿°" class="headerlink" title="1ã€æ¦‚è¿°"></a>1ã€æ¦‚è¿°</h4><p><strong>é“¾è·¯</strong>æ˜¯ä»ä¸€ä¸ªç»“ç‚¹åˆ°ç›¸é‚»ç»“ç‚¹çš„ä¸€æ®µç‰©ç†çº¿è·¯ï¼Œ<strong>æ•°æ®é“¾è·¯</strong>åˆ™æ˜¯åœ¨é“¾è·¯çš„åŸºç¡€ä¸Šå¢åŠ äº†ä¸€äº›å¿…è¦çš„ç¡¬ä»¶ï¼ˆå¦‚ç½‘ç»œé€‚é…å™¨ï¼‰å’Œè½¯ä»¶ï¼ˆå¦‚åè®®çš„å®ç°ï¼‰</p><p><strong>ç½‘ç»œä¸­çš„ä¸»æœºã€è·¯ç”±å™¨ç­‰éƒ½å¿…é¡»å®ç°æ•°æ®é“¾è·¯å±‚</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-72eec9c2f5da1885.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>å±€åŸŸç½‘ä¸­çš„ä¸»æœºã€äº¤æ¢æœºç­‰éƒ½å¿…é¡»å®ç°æ•°æ®é“¾è·¯å±‚</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-4f088da1859e7e90.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/785/format/webp" alt="img"></p><p><strong>ä»å±‚æ¬¡ä¸Šæ¥çœ‹æ•°æ®çš„æµåŠ¨</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-11c77ea98c206763.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>ä»…ä»æ•°æ®é“¾è·¯å±‚è§‚å¯Ÿå¸§çš„æµåŠ¨</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6a1acd1ad2a6c1eb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-1dacf9fe20464222.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202209190841810.png" alt="image-20220919084056636"></p><blockquote><p>ä¸»æœºH1 åˆ°ä¸»æœºH2 æ‰€ç»è¿‡çš„ç½‘ç»œå¯ä»¥æ˜¯å¤šç§ä¸åŒç±»å‹çš„</p><p><strong>æ³¨æ„ï¼šä¸åŒçš„é“¾è·¯å±‚å¯èƒ½é‡‡ç”¨ä¸åŒçš„æ•°æ®é“¾è·¯å±‚åè®®</strong></p><p>ä¸€æ¡é“¾è·¯åªæ˜¯ä¸€æ¡é€šè·¯çš„ä¸€ä¸ªç»„æˆéƒ¨åˆ†ã€‚</p></blockquote><p><strong>æ•°æ®é“¾è·¯å±‚ä½¿ç”¨çš„ä¿¡é“</strong></p><p>æ•°æ®é“¾è·¯å±‚å±äºè®¡ç®—æœºç½‘è·¯çš„ä½å±‚ã€‚<strong>æ•°æ®é“¾è·¯å±‚ä½¿ç”¨çš„ä¿¡é“ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç§ç±»å‹ï¼š</strong></p><ul><li>ç‚¹å¯¹ç‚¹ä¿¡é“</li><li>å¹¿æ’­ä¿¡é“</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-0f0962eb5fccf66f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/923/format/webp" alt="img"></p><blockquote><p><strong>å±€åŸŸç½‘å±äºæ•°æ®é“¾è·¯å±‚</strong></p><p>å±€åŸŸç½‘è™½ç„¶æ˜¯ä¸ªç½‘ç»œã€‚ä½†æˆ‘ä»¬å¹¶ä¸æŠŠå±€åŸŸç½‘æ”¾åœ¨ç½‘ç»œå±‚ä¸­è®¨è®ºã€‚è¿™æ˜¯å› ä¸ºåœ¨ç½‘ç»œå±‚è¦è®¨è®ºçš„æ˜¯å¤šä¸ªç½‘ç»œäº’è¿çš„é—®é¢˜ï¼Œæ˜¯è®¨è®ºåˆ†ç»„æ€ä¹ˆä»ä¸€ä¸ªç½‘ç»œï¼Œé€šè¿‡è·¯ç”±å™¨ï¼Œè½¬å‘åˆ°å¦ä¸€ä¸ªç½‘ç»œã€‚</p><p>è€Œåœ¨åŒä¸€ä¸ªå±€åŸŸç½‘ä¸­ï¼Œåˆ†ç»„æ€ä¹ˆä»ä¸€å°ä¸»æœºä¼ é€åˆ°å¦ä¸€å°ä¸»æœºï¼Œä½†å¹¶ä¸ç»è¿‡è·¯ç”±å™¨è½¬å‘ã€‚ä»æ•´ä¸ªäº’è”ç½‘æ¥çœ‹ï¼Œ<strong>å±€åŸŸç½‘ä»å±äºæ•°æ®é“¾è·¯å±‚</strong>çš„èŒƒå›´</p></blockquote><h4 id="2ã€ä¸‰ä¸ªé‡è¦é—®é¢˜"><a href="#2ã€ä¸‰ä¸ªé‡è¦é—®é¢˜" class="headerlink" title="2ã€ä¸‰ä¸ªé‡è¦é—®é¢˜"></a>2ã€ä¸‰ä¸ªé‡è¦é—®é¢˜</h4><p>æ•°æ®é“¾è·¯å±‚ä¼ é€çš„åè®®æ•°æ®å•å…ƒæ˜¯<strong>å¸§</strong></p><p><strong>å°è£…æˆå¸§</strong></p><ul><li><strong>å°è£…æˆå¸§</strong> (framing) å°±æ˜¯åœ¨ä¸€æ®µæ•°æ®çš„å‰ååˆ†åˆ«æ·»åŠ é¦–éƒ¨å’Œå°¾éƒ¨ï¼Œç„¶åå°±æ„æˆäº†ä¸€ä¸ªå¸§ã€‚</li><li>é¦–éƒ¨å’Œå°¾éƒ¨çš„ä¸€ä¸ªé‡è¦ä½œç”¨å°±æ˜¯è¿›è¡Œ<strong>å¸§å®šç•Œ</strong>ã€‚</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-1ad51faea9b7b205.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>å·®é”™æ£€æµ‹</strong></p><p>åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å¯èƒ½ä¼šäº§ç”Ÿ<strong>æ¯”ç‰¹å·®é”™</strong>ï¼š1 å¯èƒ½ä¼šå˜æˆ 0ï¼Œ è€Œ 0 ä¹Ÿå¯èƒ½å˜æˆ 1ã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-82811736b014aa98.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>å¯é ä¼ è¾“</strong></p><p>æ¥æ”¶æ–¹ä¸»æœºæ”¶åˆ°æœ‰è¯¯ç çš„å¸§åï¼Œæ˜¯ä¸ä¼šæ¥å—è¯¥å¸§çš„ï¼Œä¼šå°†å®ƒä¸¢å¼ƒ</p><p>å¦‚æœæ•°æ®é“¾è·¯å±‚å‘å…¶ä¸Šå±‚æä¾›çš„æ˜¯ä¸å¯é æœåŠ¡ï¼Œé‚£ä¹ˆä¸¢å¼ƒå°±ä¸¢å¼ƒäº†ï¼Œä¸ä¼šå†æœ‰æ›´å¤šæªæ–½</p><p><strong>å¦‚æœæ•°æ®é“¾è·¯å±‚å‘å…¶ä¸Šå±‚æä¾›çš„æ˜¯å¯é æœåŠ¡ï¼Œé‚£å°±è¿˜éœ€è¦å…¶ä»–æªæ–½ï¼Œæ¥ç¡®ä¿æ¥æ”¶æ–¹ä¸»æœºè¿˜å¯ä»¥é‡æ–°æ”¶åˆ°è¢«ä¸¢å¼ƒçš„è¿™ä¸ªå¸§çš„æ­£ç¡®å‰¯æœ¬</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-0d2fd9bb2602bf28.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä»¥ä¸Šä¸‰ä¸ªé—®é¢˜éƒ½æ˜¯ä½¿ç”¨<strong>ç‚¹å¯¹ç‚¹ä¿¡é“çš„æ•°æ®é“¾è·¯å±‚</strong>æ¥ä¸¾ä¾‹çš„</p></blockquote><p><strong>å¦‚æœä½¿ç”¨å¹¿æ’­ä¿¡é“çš„æ•°æ®é“¾è·¯å±‚é™¤äº†åŒ…å«ä¸Šé¢ä¸‰ä¸ªé—®é¢˜å¤–ï¼Œè¿˜æœ‰ä¸€äº›é—®é¢˜è¦è§£å†³</strong></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œä¸»æœºAï¼ŒBï¼ŒCï¼ŒDï¼ŒEé€šè¿‡ä¸€æ ¹æ€»çº¿è¿›è¡Œäº’è¿ï¼Œä¸»æœºAè¦ç»™ä¸»æœºCå‘é€æ•°æ®ï¼Œä»£è¡¨å¸§çš„ä¿¡å·ä¼šé€šè¿‡æ€»çº¿ä¼ è¾“åˆ°æ€»çº¿ä¸Šçš„å…¶ä»–å„ä¸»æœºï¼Œé‚£ä¹ˆä¸»æœºBï¼ŒDï¼ŒEå¦‚ä½•çŸ¥é“æ‰€æ”¶åˆ°çš„å¸§ä¸æ˜¯å‘é€ç»™å¥¹ä»¬çš„ï¼Œä¸»æœºCå¦‚ä½•çŸ¥é“å‘é€çš„å¸§æ˜¯å‘é€ç»™è‡ªå·±çš„</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-34c5f707bef17f14.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>å¯ä»¥ç”¨ç¼–å€ï¼ˆåœ°å€ï¼‰çš„æ¥è§£å†³</p><p>å°†å¸§çš„ç›®çš„åœ°å€æ·»åŠ åœ¨å¸§ä¸­ä¸€èµ·ä¼ è¾“</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-abbf8309faf2ebf1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>è¿˜æœ‰æ•°æ®ç¢°æ’é—®é¢˜</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-92422213075fe0e3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>éšç€æŠ€æœ¯çš„å‘å±•ï¼Œäº¤æ¢æŠ€æœ¯çš„æˆç†Ÿï¼Œ</p><p>åœ¨ æœ‰çº¿ï¼ˆå±€åŸŸç½‘ï¼‰é¢†åŸŸ ä½¿ç”¨<strong>ç‚¹å¯¹ç‚¹é“¾è·¯</strong>å’Œ<strong>é“¾è·¯å±‚äº¤æ¢æœº</strong>çš„<strong>äº¤æ¢å¼å±€åŸŸç½‘</strong>å–ä»£äº†<del>å…±äº«å¼å±€åŸŸç½‘</del></p><p>åœ¨æ— çº¿å±€åŸŸç½‘ä¸­ä»ç„¶ä½¿ç”¨çš„æ˜¯å…±äº«ä¿¡é“æŠ€æœ¯</p></blockquote><hr><h3 id="3-2ã€å°è£…æˆå¸§"><a href="#3-2ã€å°è£…æˆå¸§" class="headerlink" title="3.2ã€å°è£…æˆå¸§"></a>3.2ã€å°è£…æˆå¸§</h3><h4 id="1ã€ä»‹ç»"><a href="#1ã€ä»‹ç»" class="headerlink" title="1ã€ä»‹ç»"></a>1ã€ä»‹ç»</h4><p>å°è£…æˆå¸§æ˜¯æŒ‡æ•°æ®é“¾è·¯å±‚ç»™ä¸Šå±‚äº¤ä»˜çš„åè®®æ•°æ®å•å…ƒæ·»åŠ å¸§å¤´å’Œå¸§å°¾ä½¿ä¹‹æˆä¸ºå¸§</p><ul><li><strong>å¸§å¤´å’Œå¸§å°¾ä¸­åŒ…å«æœ‰é‡è¦çš„æ§åˆ¶ä¿¡æ¯</strong></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-bf6fe42eeea3f376.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>å‘é€æ–¹çš„æ•°æ®é“¾è·¯å±‚å°†ä¸Šå±‚äº¤ä»˜ä¸‹æ¥çš„åè®®æ•°æ®å•å…ƒå°è£…æˆå¸§åï¼Œè¿˜è¦é€šè¿‡ç‰©ç†å±‚ï¼Œå°†æ„æˆå¸§çš„å„æ¯”ç‰¹ï¼Œè½¬æ¢æˆç”µä¿¡å·äº¤ç»™ä¼ è¾“åª’ä½“ï¼Œé‚£ä¹ˆæ¥æ”¶æ–¹çš„æ•°æ®é“¾è·¯å±‚å¦‚ä½•ä»ç‰©ç†å±‚äº¤ä»˜çš„æ¯”ç‰¹æµä¸­æå–å‡ºä¸€ä¸ªä¸ªçš„å¸§ï¼Ÿ</p><p>ç­”ï¼šéœ€è¦å¸§å¤´å’Œå¸§å°¾æ¥åš<strong>å¸§å®šç•Œ</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-3a36c2a60343962c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>ä½†æ¯”ä¸æ˜¯æ¯ä¸€ç§æ•°æ®é“¾è·¯å±‚åè®®çš„å¸§éƒ½åŒ…å«æœ‰å¸§å®šç•Œæ ‡å¿—ï¼Œä¾‹å¦‚ä¸‹é¢ä¾‹å­</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f1441c531b4d740e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>å‰å¯¼ç </p><ul><li><p>å‰åŒæ­¥ç ï¼šä½œç”¨æ˜¯ä½¿æ¥æ”¶æ–¹çš„æ—¶é’ŸåŒæ­¥</p></li><li><p>å¸§å¼€å§‹å®šç•Œç¬¦ï¼šè¡¨æ˜å…¶åé¢ç´§è·Ÿç€çš„å°±æ˜¯MACå¸§</p></li></ul></blockquote><p>å¦å¤–ä»¥å¤ªç½‘è¿˜è§„å®šäº†å¸§é—´é—´éš”ä¸º96æ¯”ç‰¹æ—¶é—´ï¼Œå› æ­¤ï¼ŒMACå¸§ä¸éœ€è¦å¸§ç»“æŸå®šç•Œç¬¦</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-eee524ce4e17f0e8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="2ã€é€æ˜ä¼ è¾“"><a href="#2ã€é€æ˜ä¼ è¾“" class="headerlink" title="2ã€é€æ˜ä¼ è¾“"></a>2ã€é€æ˜ä¼ è¾“</h4><blockquote><p><strong>é€æ˜</strong></p><p>æŒ‡æŸä¸€ä¸ªå®é™…å­˜åœ¨çš„äº‹ç‰©çœ‹èµ·æ¥å´å¥½åƒä¸å­˜åœ¨ä¸€æ ·ã€‚</p></blockquote><p>é€æ˜ä¼ è¾“æ˜¯æŒ‡<strong>æ•°æ®é“¾è·¯å±‚å¯¹ä¸Šå±‚äº¤ä»˜çš„ä¼ è¾“æ•°æ®æ²¡æœ‰ä»»ä½•é™åˆ¶</strong>ï¼Œå¥½åƒæ•°æ®é“¾è·¯å±‚ä¸å­˜åœ¨ä¸€æ ·</p><p>å¸§ç•Œå®šæ ‡å¿—ä¹Ÿå°±æ˜¯ä¸ªç‰¹å®šæ•°æ®å€¼ï¼Œå¦‚æœåœ¨ä¸Šå±‚äº¤ä»˜çš„åè®®æ•°æ®å•å…ƒä¸­ï¼Œ æ°å¥½ä¹ŸåŒ…å«è¿™ä¸ªç‰¹å®šæ•°å€¼ï¼Œæ¥æ”¶æ–¹å°±ä¸èƒ½æ­£ç¡®æ¥æ”¶</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-12fe81306aedad15.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>æ‰€ä»¥æ•°æ®é“¾è·¯å±‚åº”è¯¥å¯¹ä¸Šå±‚äº¤ä»˜çš„æ•°æ®æœ‰é™åˆ¶ï¼Œå…¶å†…å®¹ä¸èƒ½åŒ…å«å¸§å®šç•Œç¬¦çš„å€¼</p></blockquote><p><strong>è§£å†³é€æ˜ä¼ è¾“é—®é¢˜</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-645dde5eed8eceb2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><ul><li><strong>è§£å†³æ–¹æ³•</strong>ï¼šé¢å‘å­—èŠ‚çš„ç‰©ç†é“¾è·¯ä½¿ç”¨<strong>å­—èŠ‚å¡«å……</strong> (byte stuffing) æˆ–<strong>å­—ç¬¦å¡«å……</strong> (character stuffing)ï¼Œé¢å‘æ¯”ç‰¹çš„ç‰©ç†é“¾è·¯ä½¿ç”¨æ¯”ç‰¹å¡«å……çš„æ–¹æ³•å®ç°é€æ˜ä¼ è¾“</li><li>å‘é€ç«¯çš„æ•°æ®é“¾è·¯å±‚åœ¨æ•°æ®ä¸­å‡ºç°æ§åˆ¶å­—ç¬¦â€œSOHâ€æˆ–â€œEOTâ€çš„å‰é¢<strong>æ’å…¥ä¸€ä¸ªè½¬ä¹‰å­—ç¬¦â€œESCâ€</strong>(å…¶åå…­è¿›åˆ¶ç¼–ç æ˜¯1B)ã€‚</li><li>æ¥æ”¶ç«¯çš„æ•°æ®é“¾è·¯å±‚åœ¨å°†æ•°æ®é€å¾€ç½‘ç»œå±‚ä¹‹å‰åˆ é™¤æ’å…¥çš„è½¬ä¹‰å­—ç¬¦ã€‚</li><li>å¦‚æœè½¬ä¹‰å­—ç¬¦ä¹Ÿå‡ºç°åœ¨æ•°æ®å½“ä¸­ï¼Œé‚£ä¹ˆåº”åœ¨è½¬ä¹‰å­—ç¬¦å‰é¢æ’å…¥ä¸€ä¸ªè½¬ä¹‰å­—ç¬¦ ESCã€‚å½“æ¥æ”¶ç«¯æ”¶åˆ°è¿ç»­çš„ä¸¤ä¸ªè½¬ä¹‰å­—ç¬¦æ—¶ï¼Œå°±åˆ é™¤å…¶ä¸­å‰é¢çš„ä¸€ä¸ªã€‚</li></ul><p><strong>å¸§çš„æ•°æ®éƒ¨åˆ†é•¿åº¦</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-9d3f61fdd96b7dee.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="3ã€æ€»ç»“"><a href="#3ã€æ€»ç»“" class="headerlink" title="3ã€æ€»ç»“"></a>3ã€æ€»ç»“</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6d39c2f162ddcae5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><hr><h3 id="3-3ã€å·®é”™æ£€æµ‹"><a href="#3-3ã€å·®é”™æ£€æµ‹" class="headerlink" title="3.3ã€å·®é”™æ£€æµ‹"></a>3.3ã€å·®é”™æ£€æµ‹</h3><h4 id="1ã€ä»‹ç»-1"><a href="#1ã€ä»‹ç»-1" class="headerlink" title="1ã€ä»‹ç»"></a>1ã€ä»‹ç»</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-fa8e42040c9adf41.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>è¯¯ç ç‡å’Œä¿¡å™ªæ¯”æœ‰å¾ˆå¤§å…³ç³»ï¼Œä¿¡å™ªæ¯”è¶Šå¤§ï¼Œè¯¯ç ç‡è¶Šå¤§ã€‚</p></blockquote><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202209190909572.png" alt="image-20220919090845767"></p><h4 id="2ã€å¥‡å¶æ ¡éªŒ"><a href="#2ã€å¥‡å¶æ ¡éªŒ" class="headerlink" title="2ã€å¥‡å¶æ ¡éªŒ"></a>2ã€å¥‡å¶æ ¡éªŒ</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-8a049d137b19e372.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="3ã€å¾ªç¯å†—ä½™æ ¡éªŒCRC-Cyclic-Redundancy-Check"><a href="#3ã€å¾ªç¯å†—ä½™æ ¡éªŒCRC-Cyclic-Redundancy-Check" class="headerlink" title="3ã€å¾ªç¯å†—ä½™æ ¡éªŒCRC(Cyclic Redundancy Check)"></a>3ã€å¾ªç¯å†—ä½™æ ¡éªŒCRC(Cyclic Redundancy Check)</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-190a469aba121c1f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-e3a6540cad78b41e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>ä¾‹é¢˜</strong></p><p><code>æŒ‰ä½å¼‚æˆ–</code></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-52140f44375b471a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-01ea200a849a5e31.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>æ€»ç»“</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-5b743916f5355e14.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>å¾ªç¯å†—ä½™æ ¡éªŒ CRC æ˜¯ä¸€ç§æ£€é”™æ–¹æ³•ï¼Œè€Œå¸§æ ¡éªŒåºåˆ— FCS æ˜¯æ·»åŠ åœ¨æ•°æ®åé¢çš„å†—ä½™ç </p></blockquote><hr><h3 id="3-4ã€å¯é ä¼ è¾“"><a href="#3-4ã€å¯é ä¼ è¾“" class="headerlink" title="3.4ã€å¯é ä¼ è¾“"></a>3.4ã€å¯é ä¼ è¾“</h3><h4 id="1ã€åŸºæœ¬æ¦‚å¿µ"><a href="#1ã€åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="1ã€åŸºæœ¬æ¦‚å¿µ"></a>1ã€åŸºæœ¬æ¦‚å¿µ</h4><p><strong>ä¸‹é¢æ˜¯æ¯”ç‰¹å·®é”™</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-570f7783660d9c10.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>å…¶ä»–ä¼ è¾“å·®é”™</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-1a955429af0480a5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><ul><li>åˆ†ç»„ä¸¢å¤±</li></ul><p>è·¯ç”±å™¨è¾“å…¥é˜Ÿåˆ—å¿«æ»¡äº†ï¼Œä¸»åŠ¨ä¸¢å¼ƒæ”¶åˆ°çš„åˆ†ç»„</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f805603357f3a3a3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><ul><li>åˆ†ç»„å¤±åº</li></ul><p>æ•°æ®å¹¶æœªæŒ‰ç…§å‘é€é¡ºåºä¾æ¬¡åˆ°è¾¾æ¥æ”¶ç«¯</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6fdae389d4679bf3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><ul><li>åˆ†ç»„é‡å¤</li></ul><p>ç”±äºæŸäº›åŸå› ï¼Œæœ‰äº›åˆ†ç»„åœ¨ç½‘ç»œä¸­æ»ç•™äº†ï¼Œæ²¡æœ‰åŠæ—¶åˆ°è¾¾æ¥æ”¶ç«¯ï¼Œè¿™å¯èƒ½ä¼šé€ æˆå‘é€ç«¯å¯¹è¯¥åˆ†ç»„çš„é‡å‘ï¼Œé‡å‘çš„åˆ†ç»„åˆ°è¾¾æ¥æ”¶ç«¯ï¼Œä½†ä¸€æ®µæ—¶é—´åï¼Œæ»ç•™åœ¨ç½‘ç»œçš„åˆ†ç»„ä¹Ÿåˆ°è¾¾äº†æ¥æ”¶ç«¯ï¼Œè¿™å°±é€ æˆ<strong>åˆ†ç»„é‡å¤</strong>çš„ä¼ è¾“å·®é”™</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-88599fefa01ee548.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="2ã€ä¸‰ç§å¯é åè®®"><a href="#2ã€ä¸‰ç§å¯é åè®®" class="headerlink" title="2ã€ä¸‰ç§å¯é åè®®"></a>2ã€ä¸‰ç§å¯é åè®®</h4><ul><li>åœæ­¢-ç­‰å¾…åè®®SW</li><li>å›é€€Nå¸§åè®®GBN</li><li>é€‰æ‹©é‡ä¼ åè®®SR</li></ul><blockquote><p>è¿™ä¸‰ç§å¯é ä¼ è¾“å®ç°æœºåˆ¶çš„åŸºæœ¬åŸç†å¹¶ä¸ä»…é™äºæ•°æ®é“¾è·¯å±‚ï¼Œå¯ä»¥åº”ç”¨åˆ°è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„çš„å„å±‚åè®®ä¸­</p></blockquote><h5 id="2-1ã€åœæ­¢-ç­‰å¾…åè®®"><a href="#2-1ã€åœæ­¢-ç­‰å¾…åè®®" class="headerlink" title="2.1ã€åœæ­¢-ç­‰å¾…åè®®"></a>2.1ã€åœæ­¢-ç­‰å¾…åè®®</h5><blockquote><p>åœæ­¢-ç­‰å¾…åè®®å¯èƒ½é‡åˆ°çš„å››ä¸ªé—®é¢˜</p></blockquote><p><strong>ç¡®è®¤ä¸å¦è®¤</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-68772b26b0ef0d3a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/518/format/webp" alt="img"></p><p><strong>è¶…æ—¶é‡ä¼ </strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-af381efb26eee719.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>ç¡®è®¤ä¸¢å¤±</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-e30648ec8764ab02.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/958/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-34bf2b8a370feab8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/462/format/webp" alt="img"></p><blockquote><p>æ—¢ç„¶æ•°æ®åˆ†ç»„éœ€è¦ç¼–å·ï¼Œç¡®è®¤åˆ†ç»„æ˜¯å¦éœ€è¦ç¼–å·ï¼Ÿ</p><p>è¦ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º</p></blockquote><p><strong>ç¡®è®¤è¿Ÿåˆ°</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-da5036b780359576.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/486/format/webp" alt="img"></p><blockquote><p>æ³¨æ„ï¼Œå›¾ä¸­æœ€ä¸‹é¢é‚£ä¸ªæ•°æ®åˆ†ç»„ä¸ä¹‹å‰åºå·ä¸º0çš„é‚£ä¸ªæ•°æ®åˆ†ç»„ä¸æ˜¯åŒä¸€ä¸ªæ•°æ®åˆ†ç»„</p></blockquote><p><strong>æ³¨æ„äº‹é¡¹</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-8dbdfdbac8087fd2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h5 id="2-2ã€åœæ­¢-ç­‰å¾…åè®®çš„ä¿¡é“åˆ©ç”¨ç‡"><a href="#2-2ã€åœæ­¢-ç­‰å¾…åè®®çš„ä¿¡é“åˆ©ç”¨ç‡" class="headerlink" title="2.2ã€åœæ­¢-ç­‰å¾…åè®®çš„ä¿¡é“åˆ©ç”¨ç‡"></a>2.2ã€åœæ­¢-ç­‰å¾…åè®®çš„ä¿¡é“åˆ©ç”¨ç‡</h5><p>å‡è®¾æ”¶å‘åŒæ–¹ä¹‹é—´æ˜¯ä¸€æ¡ç›´é€šçš„ä¿¡é“</p><ul><li><strong>TD</strong>ï¼šæ˜¯å‘é€æ–¹å‘é€æ•°æ®åˆ†ç»„æ‰€è€—è´¹çš„å‘é€æ—¶å»¶</li><li><strong>RTT</strong>ï¼šæ˜¯æ”¶å‘åŒæ–¹ä¹‹é—´çš„å¾€è¿”æ—¶é—´</li><li><strong>TA</strong>ï¼šæ˜¯æ¥æ”¶æ–¹å‘é€ç¡®è®¤åˆ†ç»„æ‰€è€—è´¹çš„å‘é€æ—¶å»¶</li></ul><p>TAä¸€èˆ¬éƒ½è¿œå°äºTDï¼Œå¯ä»¥å¿½ç•¥ï¼Œå½“RTTè¿œå¤§äºTDæ—¶ï¼Œä¿¡é“åˆ©ç”¨ç‡ä¼šéå¸¸ä½</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-3b4b0d81e5dd78eb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-4015447553ed26b5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/888/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-372ef347c338b585.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>åƒåœæ­¢-ç­‰å¾…åè®®è¿™æ ·é€šè¿‡ç¡®è®¤å’Œé‡ä¼ æœºåˆ¶å®ç°çš„å¯é ä¼ è¾“åè®®ï¼Œå¸¸ç§°ä¸ºè‡ªåŠ¨è¯·æ±‚é‡ä¼ åè®®ARQ(<strong>A</strong>utomatic <strong>R</strong>epeat re<strong>Q</strong>uest)ï¼Œæ„æ€æ˜¯é‡ä¼ çš„è¯·æ±‚æ˜¯è‡ªåŠ¨è¿›è¡Œï¼Œå› ä¸ºä¸éœ€è¦æ¥æ”¶æ–¹æ˜¾å¼åœ°è¯·æ±‚ï¼Œå‘é€æ–¹é‡ä¼ æŸä¸ªå‘é€çš„åˆ†ç»„</p></blockquote><p><img src="https://gitee.com/messi-study-java/pic_go/raw/master/img/202209190948239.png" alt="image-20220919094803119"></p><h5 id="2-3ã€å›é€€Nå¸§åè®®GBN-Go-Back-N"><a href="#2-3ã€å›é€€Nå¸§åè®®GBN-Go-Back-N" class="headerlink" title="2.3ã€å›é€€Nå¸§åè®®GBN(Go Back N)"></a>2.3ã€å›é€€Nå¸§åè®®GBN(Go Back N)</h5><blockquote><p>ä¸ºä»€ä¹ˆç”¨å›é€€Nå¸§åè®®ï¼Ÿ</p></blockquote><p>åœ¨ç›¸åŒçš„æ—¶é—´å†…ï¼Œä½¿ç”¨åœæ­¢-ç­‰å¾…åè®®çš„å‘é€æ–¹åªèƒ½å‘é€ä¸€ä¸ªæ•°æ®åˆ†ç»„ï¼Œè€Œé‡‡ç”¨æµæ°´çº¿ä¼ è¾“çš„å‘é€æ–¹ï¼Œå¯ä»¥å‘é€å¤šä¸ªæ•°æ®åˆ†ç»„</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-cc9d42f63bd259cc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>å›é€€Nå¸§åè®®åœ¨æµæ°´çº¿ä¼ è¾“çš„åŸºç¡€ä¸Šï¼Œåˆ©ç”¨å‘é€çª—å£æ¥é™åˆ¶å‘é€æ–¹å¯è¿ç»­å‘é€æ•°æ®åˆ†ç»„çš„ä¸ªæ•°</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-2a7141766ab1aa80.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>æ— å·®é”™æƒ…å†µæµç¨‹</p></blockquote><p>å‘é€æ–¹å°†åºå·è½åœ¨å‘é€çª—å£å†…çš„0~4å·æ•°æ®åˆ†ç»„ï¼Œä¾æ¬¡è¿ç»­å‘é€å‡ºå»</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-eee45713110af40a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>ä»–ä»¬ç»è¿‡äº’è”ç½‘ä¼ è¾“æ­£ç¡®åˆ°è¾¾æ¥æ”¶æ–¹ï¼Œå°±æ˜¯æ²¡æœ‰ä¹±åºå’Œè¯¯ç ï¼Œæ¥æ”¶æ–¹æŒ‰åºæ¥æ”¶å®ƒä»¬ï¼Œæ¯æ¥æ”¶ä¸€ä¸ªï¼Œæ¥æ”¶çª—å£å°±å‘å‰æ»‘åŠ¨ä¸€ä¸ªä½ç½®ï¼Œå¹¶ç»™å‘é€æ–¹å‘é€é’ˆå¯¹æ‰€æ¥æ”¶åˆ†ç»„çš„ç¡®è®¤åˆ†ç»„ï¼Œåœ¨é€šè¿‡äº’è”ç½‘çš„ä¼ è¾“æ­£ç¡®åˆ°è¾¾äº†å‘é€æ–¹</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-13f6dabf165db4e5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>å‘é€æ–¹æ¯æ¥æ”¶ä¸€ä¸ªã€å‘é€çª—å£å°±å‘å‰æ»‘åŠ¨ä¸€ä¸ªä½ç½®ï¼Œè¿™æ ·å°±æœ‰æ–°çš„åºå·è½å…¥å‘é€çª—å£ï¼Œå‘é€æ–¹å¯ä»¥å°†æ”¶åˆ°ç¡®è®¤çš„æ•°æ®åˆ†ç»„ä»ç¼“å­˜ä¸­åˆ é™¤äº†ï¼Œè€Œæ¥æ”¶æ–¹å¯ä»¥æ‹©æœºå°†å·²æ¥æ”¶çš„æ•°æ®åˆ†ç»„äº¤ä»˜ä¸Šå±‚å¤„ç†</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-0dfe16aee5eb8d75.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p><strong>ç´¯è®¡ç¡®è®¤</strong></p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-1414be9bd8307609.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ç´¯è®¡ç¡®è®¤</p><p>ä¼˜ç‚¹:</p><ul><li><p>å³ä½¿ç¡®è®¤åˆ†ç»„ä¸¢å¤±ï¼Œå‘é€æ–¹ä¹Ÿå¯èƒ½ä¸å¿…é‡ä¼ </p></li><li><p>å‡å°æ¥æ”¶æ–¹çš„å¼€é”€</p></li><li><p>å‡å°å¯¹ç½‘ç»œèµ„æºçš„å ç”¨</p></li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>ä¸èƒ½å‘å‘é€æ–¹åŠæ—¶åæ˜ å‡ºæ¥æ”¶æ–¹å·²ç»æ­£ç¡®æ¥æ”¶çš„æ•°æ®åˆ†ç»„ä¿¡æ¯</li></ul></blockquote><blockquote><p><strong>æœ‰å·®é”™æƒ…å†µ</strong></p></blockquote><p>ä¾‹å¦‚</p><p>åœ¨ä¼ è¾“æ•°æ®åˆ†ç»„æ—¶ï¼Œ5å·æ•°æ®åˆ†ç»„å‡ºç°è¯¯ç ï¼Œæ¥æ”¶æ–¹é€šè¿‡æ•°æ®åˆ†ç»„ä¸­çš„æ£€é”™ç å‘ç°äº†é”™è¯¯</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-7a8c7e3ec6ebaca6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>äºæ˜¯ä¸¢å¼ƒè¯¥åˆ†ç»„ï¼Œè€Œåç»­åˆ°è¾¾çš„è¿™å‰©ä¸‹å››ä¸ªåˆ†ç»„ä¸æ¥æ”¶çª—å£çš„åºå·ä¸åŒ¹é…</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-7621ee1bc4ab1619.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>æ¥æ”¶æ–¹åŒæ ·ä¹Ÿä¸èƒ½æ¥æ”¶å®ƒä»¬ï¼Œå°†å®ƒä»¬ä¸¢å¼ƒï¼Œï¼ˆå› ä¸ºä»–ä»¬<code>å¤±åº</code>äº†ï¼‰å¹¶å¯¹ä¹‹å‰æŒ‰åºæ¥æ”¶çš„æœ€åä¸€ä¸ªæ•°æ®åˆ†ç»„è¿›è¡Œç¡®è®¤ï¼Œå‘é€ACK4ï¼Œ<strong>æ¯ä¸¢å¼ƒä¸€ä¸ªæ•°æ®åˆ†ç»„ï¼Œå°±å‘é€ä¸€ä¸ªACK4</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-c3f86dad2611e347.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>å½“æ”¶åˆ°é‡å¤çš„ACK4æ—¶ï¼Œå°±çŸ¥é“ä¹‹å‰æ‰€å‘é€çš„æ•°æ®åˆ†ç»„å‡ºç°äº†å·®é”™ï¼Œäºæ˜¯å¯ä»¥ä¸ç­‰è¶…æ—¶è®¡æ—¶å™¨è¶…æ—¶å°±ç«‹åˆ»å¼€å§‹é‡ä¼ ï¼Œå…·ä½“æ”¶åˆ°å‡ ä¸ªé‡å¤ç¡®è®¤å°±ç«‹åˆ»é‡ä¼ ï¼Œæ ¹æ®å…·ä½“å®ç°å†³å®š</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-215e8704b22ef7f2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>å¦‚æœæ”¶åˆ°è¿™4ä¸ªé‡å¤çš„ç¡®è®¤å¹¶ä¸ä¼šè§¦å‘å‘é€ç«‹åˆ»é‡ä¼ ï¼Œä¸€æ®µæ—¶é—´åã€‚è¶…æ—¶è®¡æ—¶å™¨è¶…æ—¶ï¼Œä¹Ÿä¼šå°†å‘é€çª—å£å†…ä»¥å‘é€è¿‡çš„è¿™äº›æ•°æ®åˆ†ç»„å…¨éƒ¨é‡ä¼ </p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-1df324a9b09dffb4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>è‹¥WTè¶…è¿‡å–å€¼èŒƒå›´ï¼Œä¾‹å¦‚WT&#x3D;8ï¼Œä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µï¼Ÿ</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d2789fe0732f13ba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>ä¹ é¢˜</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-23afd873fb1ef8d0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>æ€»ç»“</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-0d5f64664d096287.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><ul><li>å›é€€Nå¸§åè®®åœ¨æµæ°´çº¿ä¼ è¾“çš„åŸºç¡€ä¸Šåˆ©ç”¨å‘é€çª—å£æ¥é™åˆ¶å‘é€æ–¹è¿ç»­å‘é€æ•°æ®åˆ†ç»„çš„æ•°é‡ï¼Œæ˜¯ä¸€ç§è¿ç»­ARQåè®®</li><li>åœ¨åè®®çš„å·¥ä½œè¿‡ç¨‹ä¸­å‘é€çª—å£å’Œæ¥æ”¶çª—å£ä¸æ–­å‘å‰æ»‘åŠ¨ï¼Œå› æ­¤è¿™ç±»åè®®åˆç§°ä¸ºæ»‘åŠ¨çª—å£åè®®</li><li>ç”±äºå›é€€Nå¸§åè®®çš„ç‰¹æ€§ï¼Œå½“é€šä¿¡çº¿è·¯è´¨é‡ä¸å¥½æ—¶ï¼Œå…¶ä¿¡é“åˆ©ç”¨ç‡å¹¶ä¸æ¯”åœæ­¢-ç­‰å¾…åè®®é«˜</li></ul><h5 id="2-4ã€é€‰æ‹©é‡ä¼ åè®®SR"><a href="#2-4ã€é€‰æ‹©é‡ä¼ åè®®SR" class="headerlink" title="2.4ã€é€‰æ‹©é‡ä¼ åè®®SR"></a>2.4ã€é€‰æ‹©é‡ä¼ åè®®SR</h5><blockquote><p>è§£å†³å›é€€Nå¸§åè®®ï¼Œä¸€ä¸ªå¸§ä¸¢å¤±ï¼Œå…¨éƒ¨é‡ä¼ ã€‚</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-2ab9c838fac0cb24.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><a href="https://links.jianshu.com/go?to=https://www.bilibili.com/video/BV1c4411d7jb?p=27">å…·ä½“æµç¨‹è¯·çœ‹è§†é¢‘</a></p><p>å¢å¤§æ¥æ”¶çª—å£çš„å¤§å°ï¼ŒæŠŠå‘é€çš„æ•°æ®å­˜å‚¨åœ¨ç¼“å­˜ä¸­ï¼Œæ”¶åˆ°ACKç¡®è®¤ï¼Œåˆ é™¤ç¼“å­˜ï¼Œæ”¶åˆ°é”™è¯¯ä¿¡æ¯ï¼Œé‡ä¼ ã€‚</p><p><strong>ä¹ é¢˜</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-dfeaa84ab40845d4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>æ€»ç»“</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-bcb835b2adac5b3a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-dab51e8895eb9313.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><hr><h3 id="3-5ã€ç‚¹å¯¹ç‚¹åè®®PPP"><a href="#3-5ã€ç‚¹å¯¹ç‚¹åè®®PPP" class="headerlink" title="3.5ã€ç‚¹å¯¹ç‚¹åè®®PPP"></a>3.5ã€ç‚¹å¯¹ç‚¹åè®®PPP</h3><ul><li>ç‚¹å¯¹ç‚¹åè®®PPPï¼ˆPoint-to-Point Protocolï¼‰æ˜¯ç›®å‰ä½¿ç”¨æœ€å¹¿æ³›çš„ç‚¹å¯¹ç‚¹æ•°æ®é“¾è·¯å±‚åè®®</li><li>PPPåè®®æ˜¯å› ç‰¹ç½‘å·¥ç¨‹ä»»åŠ¡ç»„IEIFåœ¨1992å¹´åˆ¶å®šçš„ã€‚ç»è¿‡1993å¹´å’Œ1994å¹´çš„ä¿®è®¢ï¼Œç°åœ¨çš„PPPåè®®å·²æˆä¸ºå› ç‰¹ç½‘çš„æ­£å¼æ ‡å‡†[RFC1661ï¼ŒRFC1662]</li><li>æ•°æ®é“¾è·¯å±‚ä½¿ç”¨çš„ä¸€ç§åè®®ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯ï¼šç®€å•ï¼›åªæ£€æµ‹å·®é”™ï¼Œè€Œä¸æ˜¯çº æ­£å·®é”™ï¼›ä¸ä½¿ç”¨åºå·ï¼Œä¹Ÿä¸è¿›è¡Œæµé‡æ§åˆ¶ï¼›å¯åŒæ—¶æ”¯æŒå¤šç§ç½‘ç»œå±‚åè®®</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-fd145efb1acc73fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><ul><li>PPPoE æ˜¯ä¸ºå®½å¸¦ä¸Šç½‘çš„ä¸»æœºä½¿ç”¨çš„é“¾è·¯å±‚åè®®</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-bbc4187b9e27ef4c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="1ã€å¸§æ ¼å¼"><a href="#1ã€å¸§æ ¼å¼" class="headerlink" title="1ã€å¸§æ ¼å¼"></a>1ã€å¸§æ ¼å¼</h4><p>å¿…é¡»è§„å®šç‰¹æ®Šçš„å­—ç¬¦ä½œä¸ºå¸§å®šç•Œç¬¦</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-b384615e861000f3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>0x0021 ipæ•°æ®æŠ¥</p><p>0xc021 pppé“¾è·¯æ§åˆ¶æ•°æ®</p><p>0x8021 ç½‘ç»œæ§åˆ¶æ•°æ®</p></blockquote><h4 id="2ã€é€æ˜ä¼ è¾“-1"><a href="#2ã€é€æ˜ä¼ è¾“-1" class="headerlink" title="2ã€é€æ˜ä¼ è¾“"></a>2ã€é€æ˜ä¼ è¾“</h4><p>å¿…é¡»ä¿è¯æ•°æ®ä¼ è¾“çš„é€æ˜æ€§</p><p>å®ç°é€æ˜ä¼ è¾“çš„æ–¹æ³•</p><ul><li>é¢å‘å­—èŠ‚çš„å¼‚æ­¥é“¾è·¯ï¼šå­—èŠ‚å¡«å……æ³•ï¼ˆæ’å…¥â€œè½¬ä¹‰å­—ç¬¦â€ï¼‰</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d40da4575c590f5c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><ul><li>é¢å‘æ¯”ç‰¹çš„åŒæ­¥é“¾è·¯ï¼šæ¯”ç‰¹å¡«å……æ³•ï¼ˆæ’å…¥â€œæ¯”ç‰¹0â€ï¼‰</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6290c73d8957ee8d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="3ã€å·®é”™æ£€æµ‹"><a href="#3ã€å·®é”™æ£€æµ‹" class="headerlink" title="3ã€å·®é”™æ£€æµ‹"></a>3ã€å·®é”™æ£€æµ‹</h4><p>èƒ½å¤Ÿå¯¹æ¥æ”¶ç«¯æ”¶åˆ°çš„å¸§è¿›è¡Œæ£€æµ‹ï¼Œå¹¶ç«‹å³ä¸¢å¼ƒæœ‰å·®é”™çš„å¸§ã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-501e6b9dd2afcee3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="4ã€å·¥ä½œçŠ¶æ€"><a href="#4ã€å·¥ä½œçŠ¶æ€" class="headerlink" title="4ã€å·¥ä½œçŠ¶æ€"></a>4ã€å·¥ä½œçŠ¶æ€</h4><ul><li>å½“ç”¨æˆ·æ‹¨å·æ¥å…¥ ISP æ—¶ï¼Œè·¯ç”±å™¨çš„è°ƒåˆ¶è§£è°ƒå™¨å¯¹æ‹¨å·åšå‡ºç¡®è®¤ï¼Œå¹¶å»ºç«‹ä¸€æ¡ç‰©ç†è¿æ¥ã€‚</li><li>PC æœºå‘è·¯ç”±å™¨å‘é€ä¸€ç³»åˆ—çš„ LCP åˆ†ç»„ï¼ˆå°è£…æˆå¤šä¸ª PPP å¸§ï¼‰ã€‚</li><li>è¿™äº›åˆ†ç»„åŠå…¶å“åº”é€‰æ‹©ä¸€äº› PPP å‚æ•°ï¼Œå¹¶è¿›è¡Œç½‘ç»œå±‚é…ç½®ï¼ŒNCP ç»™æ–°æ¥å…¥çš„ PC æœº</li><li>åˆ†é…ä¸€ä¸ªä¸´æ—¶çš„ IP åœ°å€ï¼Œä½¿ PC æœºæˆä¸ºå› ç‰¹ç½‘ä¸Šçš„ä¸€ä¸ªä¸»æœºã€‚</li><li>é€šä¿¡å®Œæ¯•æ—¶ï¼ŒNCP é‡Šæ”¾ç½‘ç»œå±‚è¿æ¥ï¼Œæ”¶å›åŸæ¥åˆ†é…å‡ºå»çš„ IP åœ°å€ã€‚æ¥ç€ï¼ŒLCP é‡Šæ”¾æ•°æ®é“¾è·¯å±‚è¿æ¥ã€‚æœ€åé‡Šæ”¾çš„æ˜¯ç‰©ç†å±‚çš„è¿æ¥ã€‚</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-96bbde153c114cf8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>å¯è§ï¼ŒPPP åè®®å·²ä¸æ˜¯çº¯ç²¹çš„æ•°æ®é“¾è·¯å±‚çš„åè®®ï¼Œå®ƒè¿˜åŒ…å«äº†ç‰©ç†å±‚å’Œç½‘ç»œå±‚çš„å†…å®¹ã€‚</p></blockquote><hr><h3 id="3-6ã€åª’ä½“æ¥å…¥æ§åˆ¶ï¼ˆä»‹è´¨è®¿é—®æ§åˆ¶ï¼‰â€”â€”å¹¿æ’­ä¿¡é“"><a href="#3-6ã€åª’ä½“æ¥å…¥æ§åˆ¶ï¼ˆä»‹è´¨è®¿é—®æ§åˆ¶ï¼‰â€”â€”å¹¿æ’­ä¿¡é“" class="headerlink" title="3.6ã€åª’ä½“æ¥å…¥æ§åˆ¶ï¼ˆä»‹è´¨è®¿é—®æ§åˆ¶ï¼‰â€”â€”å¹¿æ’­ä¿¡é“"></a>3.6ã€åª’ä½“æ¥å…¥æ§åˆ¶ï¼ˆä»‹è´¨è®¿é—®æ§åˆ¶ï¼‰â€”â€”å¹¿æ’­ä¿¡é“</h3><p><strong>åª’ä½“æ¥å…¥æ§åˆ¶ï¼ˆä»‹è´¨è®¿é—®æ§åˆ¶ï¼‰ä½¿ç”¨ä¸€å¯¹å¤šçš„å¹¿æ’­é€šä¿¡æ–¹å¼</strong></p><blockquote><p><strong>Medium Access Control</strong>ç¿»è¯‘æˆåª’ä½“æ¥å…¥æ§åˆ¶ï¼Œæœ‰äº›ç¿»è¯‘æˆä»‹è´¨è®¿é—®æ§åˆ¶</p></blockquote><p><strong>å±€åŸŸç½‘çš„æ•°æ®é“¾è·¯å±‚</strong></p><ul><li>å±€åŸŸç½‘æœ€ä¸»è¦çš„<strong>ç‰¹ç‚¹</strong>æ˜¯ï¼š<ul><li>ç½‘ç»œä¸ºä¸€ä¸ªå•ä½æ‰€æ‹¥æœ‰ï¼›</li><li>åœ°ç†èŒƒå›´å’Œç«™ç‚¹æ•°ç›®å‡æœ‰é™ã€‚</li></ul></li><li>å±€åŸŸç½‘å…·æœ‰å¦‚ä¸‹<strong>ä¸»è¦ä¼˜ç‚¹</strong>ï¼š<ul><li>å…·æœ‰å¹¿æ’­åŠŸèƒ½ï¼Œä»ä¸€ä¸ªç«™ç‚¹å¯å¾ˆæ–¹ä¾¿åœ°è®¿é—®å…¨ç½‘ã€‚å±€åŸŸç½‘ä¸Šçš„ä¸»æœºå¯å…±äº«è¿æ¥åœ¨å±€åŸŸç½‘ä¸Šçš„å„ç§ç¡¬ä»¶å’Œè½¯ä»¶èµ„æºã€‚</li><li>ä¾¿äºç³»ç»Ÿçš„æ‰©å±•å’Œé€æ¸åœ°æ¼”å˜ï¼Œå„è®¾å¤‡çš„ä½ç½®å¯çµæ´»è°ƒæ•´å’Œæ”¹å˜ã€‚</li><li>æé«˜äº†ç³»ç»Ÿçš„å¯é æ€§ã€å¯ç”¨æ€§å’Œæ®‹å­˜æ€§ã€‚</li></ul></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-4acef21a5275fab6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/849/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6a109c1bb8576571.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/847/format/webp" alt="img"></p><p><strong>æ•°æ®é“¾è·¯å±‚çš„ä¸¤ä¸ªå­å±‚</strong></p><p>ä¸ºäº†ä½¿æ•°æ®é“¾è·¯å±‚èƒ½æ›´å¥½åœ°é€‚åº”å¤šç§å±€åŸŸç½‘æ ‡å‡†ï¼ŒIEEE 802 å§”å‘˜ä¼šå°±å°†å±€åŸŸç½‘çš„æ•°æ®é“¾è·¯å±‚æ‹†æˆ<strong>ä¸¤ä¸ªå­å±‚</strong>ï¼š</p><ol><li><strong>é€»è¾‘é“¾è·¯æ§åˆ¶</strong> LLC (Logical Link Control)å­å±‚ï¼›</li><li><strong>åª’ä½“æ¥å…¥æ§åˆ¶</strong> MAC (Medium Access Control)å­å±‚ã€‚</li></ol><p>ä¸æ¥å…¥åˆ°ä¼ è¾“åª’ä½“æœ‰å…³çš„å†…å®¹éƒ½æ”¾åœ¨ MACå­å±‚ï¼Œè€Œ LLC å­å±‚åˆ™ä¸ä¼ è¾“åª’ä½“æ— å…³ã€‚  <strong>ä¸ç®¡é‡‡ç”¨ä½•ç§åè®®çš„å±€åŸŸç½‘ï¼Œå¯¹ LLC å­å±‚æ¥è¯´éƒ½æ˜¯é€æ˜çš„ã€‚</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-faea2c7d90c97f4d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/831/format/webp" alt="img"></p><h4 id="1ã€åŸºæœ¬æ¦‚å¿µ-1"><a href="#1ã€åŸºæœ¬æ¦‚å¿µ-1" class="headerlink" title="1ã€åŸºæœ¬æ¦‚å¿µ"></a>1ã€åŸºæœ¬æ¦‚å¿µ</h4><p>ä¸ºä»€ä¹ˆè¦åª’ä½“æ¥å…¥æ§åˆ¶ï¼ˆä»‹è´¨è®¿é—®æ§åˆ¶ï¼‰ï¼Ÿ</p><p><strong>å…±äº«ä¿¡é“å¸¦æ¥çš„é—®é¢˜</strong></p><p>è‹¥å¤šä¸ªè®¾å¤‡åœ¨å…±äº«ä¿¡é“ä¸ŠåŒæ—¶å‘é€æ•°æ®ï¼Œåˆ™ä¼šé€ æˆå½¼æ­¤å¹²æ‰°ï¼Œå¯¼è‡´å‘é€å¤±è´¥ã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-e8558245e4dd7086.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-3d6792f6b442b459.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>éšç€æŠ€æœ¯çš„å‘å±•ï¼Œäº¤æ¢æŠ€æœ¯çš„æˆç†Ÿå’Œæˆæœ¬çš„é™ä½ï¼Œå…·æœ‰æ›´é«˜æ€§èƒ½çš„ä½¿ç”¨ç‚¹å¯¹ç‚¹é“¾è·¯å’Œé“¾è·¯å±‚äº¤æ¢æœºçš„äº¤æ¢å¼å±€åŸŸç½‘åœ¨æœ‰çº¿é¢†åŸŸå·²å®Œå…¨å–ä»£äº†å…±äº«å¼å±€åŸŸç½‘ï¼Œä½†ç”±äºæ— çº¿ä¿¡é“çš„å¹¿æ’­å¤©æ€§ï¼Œæ— çº¿å±€åŸŸç½‘ä»ç„¶ä½¿ç”¨çš„æ˜¯å…±äº«åª’ä½“æŠ€æœ¯</p></blockquote><h4 id="2ã€é™æ€åˆ’åˆ†ä¿¡é“"><a href="#2ã€é™æ€åˆ’åˆ†ä¿¡é“" class="headerlink" title="2ã€é™æ€åˆ’åˆ†ä¿¡é“"></a>2ã€é™æ€åˆ’åˆ†ä¿¡é“</h4><p><strong>ä¿¡é“å¤ç”¨</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f42ef63e4cf0d34b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>é¢‘åˆ†å¤ç”¨FDM (Frequency Division Multiplexing)</strong></p><ul><li>å°†æ•´ä¸ªå¸¦å®½åˆ†ä¸ºå¤šä»½ï¼Œç”¨æˆ·åœ¨åˆ†é…åˆ°ä¸€å®šçš„é¢‘å¸¦åï¼Œåœ¨é€šä¿¡è¿‡ç¨‹ä¸­è‡ªå§‹è‡³ç»ˆéƒ½å ç”¨è¿™ä¸ªé¢‘å¸¦ã€‚</li><li><strong>é¢‘åˆ†å¤ç”¨</strong>çš„æ‰€æœ‰ç”¨æˆ·åœ¨åŒæ ·çš„æ—¶é—´<strong>å ç”¨ä¸åŒçš„å¸¦å®½èµ„æº</strong>ï¼ˆè¯·æ³¨æ„ï¼Œè¿™é‡Œçš„â€œå¸¦å®½â€æ˜¯é¢‘ç‡å¸¦å®½è€Œä¸æ˜¯æ•°æ®çš„å‘é€é€Ÿç‡ï¼‰ã€‚</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-7b3574f649543f8e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>æ—¶åˆ†å¤ç”¨TDM (Time Division Multiplexing)</strong></p><ul><li><strong>æ—¶åˆ†å¤ç”¨</strong>åˆ™æ˜¯å°†æ—¶é—´åˆ’åˆ†ä¸ºä¸€æ®µæ®µç­‰é•¿çš„<strong>æ—¶åˆ†å¤ç”¨å¸§ï¼ˆTDMå¸§ï¼‰</strong>ã€‚æ¯ä¸€ä¸ªæ—¶åˆ†å¤ç”¨çš„ç”¨æˆ·åœ¨æ¯ä¸€ä¸ª TDM å¸§ä¸­å ç”¨å›ºå®šåºå·çš„æ—¶éš™ã€‚</li><li>æ¯ä¸€ä¸ªç”¨æˆ·æ‰€å ç”¨çš„æ—¶éš™æ˜¯<strong>å‘¨æœŸæ€§åœ°å‡ºç°</strong>ï¼ˆå…¶å‘¨æœŸå°±æ˜¯TDMå¸§çš„é•¿åº¦ï¼‰çš„ã€‚</li><li>TDM ä¿¡å·ä¹Ÿç§°ä¸º<strong>ç­‰æ—¶</strong> (isochronous) ä¿¡å·ã€‚</li><li><strong>æ—¶åˆ†å¤ç”¨çš„æ‰€æœ‰ç”¨æˆ·åœ¨ä¸åŒçš„æ—¶é—´å ç”¨åŒæ ·çš„é¢‘å¸¦å®½åº¦ã€‚</strong></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-85128fb198aad76c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>æ³¢åˆ†å¤ç”¨ WDM(Wavelength Division Multiplexing)</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-9f1dfdd7ce2cb611.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>æ³¢åˆ†å¤ç”¨å°±æ˜¯å…‰çš„é¢‘åˆ†å¤ç”¨ï¼Œä½¿ç”¨ä¸€æ ¹å…‰çº¤æ¥åŒæ—¶ä¼ è¾“å¤šä¸ªå…‰è½½æ³¢ä¿¡å·</p><p>å…‰ä¿¡å·ä¼ è¾“ä¸€æ®µè·ç¦»åæ‚”è¡°å‡ï¼Œæ‰€ä»¥è¦ç”¨ æºé“’å…‰çº¤æ”¾å¤§å™¨ æ”¾å¤§å…‰ä¿¡å·</p></blockquote><p><strong>ç åˆ†å¤ç”¨ CDM (Code Division Multiplexing)</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-753efa9c750d4ef1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-91ed6f416ae8fad6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-91b959793d2ac0de.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-8d81f17d93395b48.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="3ã€åŠ¨æ€æ¥å…¥æ§åˆ¶"><a href="#3ã€åŠ¨æ€æ¥å…¥æ§åˆ¶" class="headerlink" title="3ã€åŠ¨æ€æ¥å…¥æ§åˆ¶"></a>3ã€åŠ¨æ€æ¥å…¥æ§åˆ¶</h4><p>å—æ§æ¥å…¥</p><p><strong>å—æ§æ¥å…¥åœ¨å±€åŸŸç½‘ä¸­ä½¿ç”¨å¾—è¾ƒå°‘ï¼Œæœ¬ä¹¦ä¸å†è®¨è®º</strong></p><p><strong>éšæœºæ¥å…¥</strong></p><p><strong>é‡ç‚¹</strong></p><h4 id="4ã€éšæœºæ¥å…¥ï¼ˆCSMA-x2F-CDåè®®ï¼‰"><a href="#4ã€éšæœºæ¥å…¥ï¼ˆCSMA-x2F-CDåè®®ï¼‰" class="headerlink" title="4ã€éšæœºæ¥å…¥ï¼ˆCSMA&#x2F;CDåè®®ï¼‰"></a>4ã€éšæœºæ¥å…¥ï¼ˆCSMA&#x2F;CDåè®®ï¼‰</h4><p><strong>æ€»çº¿å±€åŸŸç½‘ä½¿ç”¨åè®®ï¼šCSMA&#x2F;CD</strong></p><h5 id="4-1ã€åŸºæœ¬æ¦‚å¿µ"><a href="#4-1ã€åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="4.1ã€åŸºæœ¬æ¦‚å¿µ"></a>4.1ã€åŸºæœ¬æ¦‚å¿µ</h5><p><strong>æœ€åˆ</strong>çš„<strong>ä»¥å¤ªç½‘</strong>æ˜¯å°†è®¸å¤šè®¡ç®—æœºéƒ½è¿æ¥åˆ°ä¸€æ ¹æ€»çº¿ä¸Šã€‚æ˜“äºå®ç°å¹¿æ’­é€šä¿¡ã€‚å½“åˆè®¤ä¸ºè¿™æ ·çš„è¿æ¥æ–¹æ³•æ—¢ç®€å•åˆå¯é ï¼Œå› ä¸ºæ€»çº¿ä¸Šæ²¡æœ‰æœ‰æºå™¨ä»¶ã€‚</p><blockquote><p><strong>ä»¥å¤ªç½‘ï¼ˆEthernetï¼‰</strong>æ˜¯ä¸€ç§è®¡ç®—æœº<strong>å±€åŸŸç½‘æŠ€æœ¯</strong>ã€‚IEEEç»„ç»‡çš„IEEE 802.3æ ‡å‡†åˆ¶å®šäº†<strong>ä»¥å¤ªç½‘ï¼ˆEthernetï¼‰</strong>çš„æŠ€æœ¯æ ‡å‡†</p><p>ä»¥å¤ªç½‘é‡‡ç”¨æ— è¿æ¥çš„å·¥ä½œæ–¹å¼ï¼Œå¯¹å‘é€çš„æ•°æ®å¸§ä¸è¿›è¡Œç¼–å·ï¼Œä¹Ÿä¸è¦æ±‚å¯¹æ–¹å‘å›ç¡®è®¤ã€‚ç›®çš„ç«™æ”¶åˆ°æœ‰å·®é”™å¸§å°±æŠŠå®ƒä¸¢å¼ƒï¼Œå…¶ä»–ä»€ä¹ˆä¹Ÿä¸åšã€‚ï¼ˆä¸å¯é æœåŠ¡ï¼‰</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-daba961daee80d20.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-00eb7fba113030d2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><code>å¤šå€æ¥å…¥MA</code></p><p>è¡¨ç¤ºè®¸å¤šä¸»æœºä»¥å¤šç‚¹æ¥å…¥çš„æ–¹å¼è¿æ¥åœ¨ä¸€æ ¹æ€»çº¿ä¸Šã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-a26a912dcecd040a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><code>è½½æ³¢ç›‘å¬CS</code></p><p>æ˜¯æŒ‡æ¯ä¸€ä¸ªç«™åœ¨å‘é€æ•°æ®ä¹‹å‰å…ˆè¦æ£€æµ‹ä¸€ä¸‹æ€»çº¿ä¸Šæ˜¯å¦æœ‰å…¶ä»–è®¡ç®—æœºåœ¨å‘é€æ•°æ®ï¼Œå¦‚æœæœ‰ï¼Œåˆ™æš‚æ—¶ä¸è¦å‘é€æ•°æ®ï¼Œä»¥å…å‘ç”Ÿç¢°æ’ã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-9dc7a68973377382.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>æ€»çº¿ä¸Šå¹¶æ²¡æœ‰ä»€ä¹ˆâ€œè½½æ³¢â€ã€‚å› æ­¤ï¼Œ <strong>â€œè½½æ³¢ç›‘å¬â€å°±æ˜¯ç”¨ç”µå­æŠ€æœ¯æ£€æµ‹æ€»çº¿ä¸Šæœ‰æ²¡æœ‰å…¶ä»–è®¡ç®—æœºå‘é€çš„æ•°æ®ä¿¡å·ã€‚</strong></p><p><code>ç¢°æ’æ£€æµ‹CD</code></p><ul><li><strong>â€œç¢°æ’æ£€æµ‹â€</strong>å°±æ˜¯è®¡ç®—æœº<strong>è¾¹å‘é€æ•°æ®è¾¹æ£€æµ‹</strong>ä¿¡é“ä¸Šçš„ä¿¡å·ç”µå‹å¤§å°ã€‚</li><li>å½“å‡ ä¸ªç«™åŒæ—¶åœ¨æ€»çº¿ä¸Šå‘é€æ•°æ®æ—¶ï¼Œæ€»çº¿ä¸Šçš„ä¿¡å·ç”µå‹æ‘†åŠ¨å€¼å°†ä¼šå¢å¤§ï¼ˆäº’ç›¸å åŠ ï¼‰ã€‚</li><li>å½“ä¸€ä¸ªç«™æ£€æµ‹åˆ°çš„ä¿¡å·ç”µå‹æ‘†åŠ¨å€¼è¶…è¿‡ä¸€å®šçš„é—¨é™å€¼æ—¶ï¼Œå°±è®¤ä¸ºæ€»çº¿ä¸Šè‡³å°‘æœ‰ä¸¤ä¸ªç«™åŒæ—¶åœ¨å‘é€æ•°æ®ï¼Œè¡¨æ˜äº§ç”Ÿäº†ç¢°æ’ã€‚</li><li><strong>æ‰€è°“â€œç¢°æ’â€å°±æ˜¯å‘ç”Ÿäº†å†²çªã€‚å› æ­¤â€œç¢°æ’æ£€æµ‹â€ä¹Ÿç§°ä¸ºâ€œå†²çªæ£€æµ‹â€ã€‚</strong></li><li>åœ¨å‘ç”Ÿç¢°æ’æ—¶ï¼Œæ€»çº¿ä¸Šä¼ è¾“çš„ä¿¡å·äº§ç”Ÿäº†ä¸¥é‡çš„å¤±çœŸï¼Œæ— æ³•ä»ä¸­æ¢å¤å‡ºæœ‰ç”¨çš„ä¿¡æ¯æ¥ã€‚</li><li><strong>æ¯ä¸€ä¸ªæ­£åœ¨å‘é€æ•°æ®çš„ç«™ï¼Œä¸€æ—¦å‘ç°æ€»çº¿ä¸Šå‡ºç°äº†ç¢°æ’ï¼Œå°±è¦ç«‹å³åœæ­¢å‘é€ï¼Œå…å¾—ç»§ç»­æµªè´¹ç½‘ç»œèµ„æºï¼Œç„¶åç­‰å¾…ä¸€æ®µéšæœºæ—¶é—´åå†æ¬¡å‘é€ã€‚</strong></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-574d77a51611a634.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä¸ºä»€ä¹ˆè¦è¿›è¡Œç¢°æ’æ£€æµ‹ï¼Ÿ å› ä¸ºä¿¡å·ä¼ æ’­æ—¶å»¶å¯¹è½½æ³¢ç›‘å¬äº§ç”Ÿäº†å½±å“</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-a03963c28232dfb8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/940/format/webp" alt="img"></p><p>A éœ€è¦å•ç¨‹ä¼ æ’­æ—¶å»¶çš„ 2 å€çš„æ—¶é—´ï¼Œæ‰èƒ½æ£€æµ‹åˆ°ä¸ B çš„å‘é€äº§ç”Ÿäº†å†²çª</p></blockquote><h5 id="4-2-ã€CSMA-x2F-CD-åè®®å·¥ä½œæµç¨‹"><a href="#4-2-ã€CSMA-x2F-CD-åè®®å·¥ä½œæµç¨‹" class="headerlink" title="4.2 ã€CSMA&#x2F;CD åè®®å·¥ä½œæµç¨‹"></a>4.2 ã€CSMA&#x2F;CD åè®®å·¥ä½œæµç¨‹</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-5621a9827bd41bf5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/669/format/webp" alt="img"></p><h6 id="CSMA-x2F-CD-åè®®å·¥ä½œâ€”â€”äº‰ç”¨æœŸï¼ˆç¢°æ’çª—å£ï¼‰"><a href="#CSMA-x2F-CD-åè®®å·¥ä½œâ€”â€”äº‰ç”¨æœŸï¼ˆç¢°æ’çª—å£ï¼‰" class="headerlink" title="CSMA&#x2F;CD åè®®å·¥ä½œâ€”â€”äº‰ç”¨æœŸï¼ˆç¢°æ’çª—å£ï¼‰"></a>CSMA&#x2F;CD åè®®å·¥ä½œâ€”â€”äº‰ç”¨æœŸï¼ˆç¢°æ’çª—å£ï¼‰</h6><p><img src="https://upload-images.jianshu.io/upload_images/24878825-a77d88a950995527.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h6 id="CSMA-x2F-CD-åè®®å·¥ä½œâ€”â€”æœ€å°å¸§é•¿"><a href="#CSMA-x2F-CD-åè®®å·¥ä½œâ€”â€”æœ€å°å¸§é•¿" class="headerlink" title="CSMA&#x2F;CD åè®®å·¥ä½œâ€”â€”æœ€å°å¸§é•¿"></a>CSMA&#x2F;CD åè®®å·¥ä½œâ€”â€”æœ€å°å¸§é•¿</h6><p><img src="https://upload-images.jianshu.io/upload_images/24878825-423fe21ffdbacb81.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h6 id="CSMA-x2F-CD-åè®®å·¥ä½œâ€”â€”æœ€å¤§å¸§é•¿"><a href="#CSMA-x2F-CD-åè®®å·¥ä½œâ€”â€”æœ€å¤§å¸§é•¿" class="headerlink" title="CSMA&#x2F;CD åè®®å·¥ä½œâ€”â€”æœ€å¤§å¸§é•¿"></a>CSMA&#x2F;CD åè®®å·¥ä½œâ€”â€”æœ€å¤§å¸§é•¿</h6><p><img src="https://upload-images.jianshu.io/upload_images/24878825-fa63a8f164fb9191.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h6 id="CSMA-x2F-CD-åè®®å·¥ä½œâ€”â€”æˆªæ–­äºŒè¿›åˆ¶æŒ‡æ•°é€€é¿ç®—æ³•"><a href="#CSMA-x2F-CD-åè®®å·¥ä½œâ€”â€”æˆªæ–­äºŒè¿›åˆ¶æŒ‡æ•°é€€é¿ç®—æ³•" class="headerlink" title="CSMA&#x2F;CD åè®®å·¥ä½œâ€”â€”æˆªæ–­äºŒè¿›åˆ¶æŒ‡æ•°é€€é¿ç®—æ³•"></a>CSMA&#x2F;CD åè®®å·¥ä½œâ€”â€”æˆªæ–­äºŒè¿›åˆ¶æŒ‡æ•°é€€é¿ç®—æ³•</h6><p><img src="https://upload-images.jianshu.io/upload_images/24878825-93f832e4b0a569ae.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h6 id="CSMA-x2F-CD-åè®®å·¥ä½œâ€”â€”ä¿¡é“åˆ©ç”¨ç‡"><a href="#CSMA-x2F-CD-åè®®å·¥ä½œâ€”â€”ä¿¡é“åˆ©ç”¨ç‡" class="headerlink" title="CSMA&#x2F;CD åè®®å·¥ä½œâ€”â€”ä¿¡é“åˆ©ç”¨ç‡"></a>CSMA&#x2F;CD åè®®å·¥ä½œâ€”â€”ä¿¡é“åˆ©ç”¨ç‡</h6><p><img src="https://upload-images.jianshu.io/upload_images/24878825-dc35877bb4bead1a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h6 id="CSMA-x2F-CD-åè®®å·¥ä½œâ€”â€”å¸§æ¥æ”¶æµç¨‹"><a href="#CSMA-x2F-CD-åè®®å·¥ä½œâ€”â€”å¸§æ¥æ”¶æµç¨‹" class="headerlink" title="CSMA&#x2F;CD åè®®å·¥ä½œâ€”â€”å¸§æ¥æ”¶æµç¨‹"></a>CSMA&#x2F;CD åè®®å·¥ä½œâ€”â€”å¸§æ¥æ”¶æµç¨‹</h6><p><img src="https://upload-images.jianshu.io/upload_images/24878825-cf2d95546ecf2664.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h6 id="CSMA-x2F-CD-åè®®çš„é‡è¦ç‰¹æ€§"><a href="#CSMA-x2F-CD-åè®®çš„é‡è¦ç‰¹æ€§" class="headerlink" title="CSMA&#x2F;CD åè®®çš„é‡è¦ç‰¹æ€§"></a>CSMA&#x2F;CD åè®®çš„é‡è¦ç‰¹æ€§</h6><ul><li>ä½¿ç”¨ CSMA&#x2F;CD åè®®çš„ä»¥å¤ªç½‘ä¸èƒ½è¿›è¡Œå…¨åŒå·¥é€šä¿¡è€Œ<strong>åªèƒ½è¿›è¡ŒåŒå‘äº¤æ›¿é€šä¿¡ï¼ˆåŠåŒå·¥é€šä¿¡ï¼‰ã€‚</strong></li><li>æ¯ä¸ªç«™åœ¨å‘é€æ•°æ®ä¹‹åçš„ä¸€å°æ®µæ—¶é—´å†…ï¼Œå­˜åœ¨ç€é­é‡ç¢°æ’çš„å¯èƒ½æ€§ã€‚</li><li>è¿™ç§<strong>å‘é€çš„ä¸ç¡®å®šæ€§</strong>ä½¿æ•´ä¸ªä»¥å¤ªç½‘çš„å¹³å‡é€šä¿¡é‡è¿œå°äºä»¥å¤ªç½‘çš„æœ€é«˜æ•°æ®ç‡ã€‚</li></ul><blockquote><p>CSMA&#x2F;CDåè®®æ›¾ç»ç”¨äºå„ç§æ€»çº¿ç»“æ„ä»¥å¤ªç½‘å’ŒåŒç»çº¿ä»¥å¤ªç½‘çš„æ—©èµ·ç‰ˆæœ¬ä¸­ã€‚</p><p><strong>ç°åœ¨çš„ä»¥å¤ªç½‘åŸºäºäº¤æ¢æœºå’Œå…¨åŒå·¥è¿æ¥ï¼Œä¸ä¼šæœ‰ç¢°æ’ï¼Œå› æ­¤æ²¡æœ‰å¿…è¦ä½¿ç”¨CSMA&#x2F;CSåè®®</strong></p></blockquote><h4 id="5ã€éšæœºæ¥å…¥ï¼ˆCSMA-x2F-CAåè®®ï¼‰"><a href="#5ã€éšæœºæ¥å…¥ï¼ˆCSMA-x2F-CAåè®®ï¼‰" class="headerlink" title="5ã€éšæœºæ¥å…¥ï¼ˆCSMA&#x2F;CAåè®®ï¼‰"></a>5ã€éšæœºæ¥å…¥ï¼ˆCSMA&#x2F;CAåè®®ï¼‰</h4><p><strong>æ— çº¿å±€åŸŸç½‘ä½¿ç”¨çš„åè®®ï¼šCSMA&#x2F;CA</strong></p><h5 id="5-1ã€ä¸ºä»€ä¹ˆæ— çº¿å±€åŸŸç½‘è¦ä½¿ç”¨CSMA-x2F-CAåè®®"><a href="#5-1ã€ä¸ºä»€ä¹ˆæ— çº¿å±€åŸŸç½‘è¦ä½¿ç”¨CSMA-x2F-CAåè®®" class="headerlink" title="5.1ã€ä¸ºä»€ä¹ˆæ— çº¿å±€åŸŸç½‘è¦ä½¿ç”¨CSMA&#x2F;CAåè®®"></a>5.1ã€ä¸ºä»€ä¹ˆæ— çº¿å±€åŸŸç½‘è¦ä½¿ç”¨CSMA&#x2F;CAåè®®</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-dd01f296832d017a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h5 id="5-2ã€å¸§é—´é—´éš”IFSï¼ˆInterFrame-Spaceï¼‰"><a href="#5-2ã€å¸§é—´é—´éš”IFSï¼ˆInterFrame-Spaceï¼‰" class="headerlink" title="5.2ã€å¸§é—´é—´éš”IFSï¼ˆInterFrame Spaceï¼‰"></a>5.2ã€å¸§é—´é—´éš”IFSï¼ˆInterFrame Spaceï¼‰</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6c9fe4ae6927eb02.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h5 id="5-3ã€CSMA-x2F-CAåè®®çš„å·¥ä½œåŸç†"><a href="#5-3ã€CSMA-x2F-CAåè®®çš„å·¥ä½œåŸç†" class="headerlink" title="5.3ã€CSMA&#x2F;CAåè®®çš„å·¥ä½œåŸç†"></a>5.3ã€CSMA&#x2F;CAåè®®çš„å·¥ä½œåŸç†</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-c0ce898b417b3228.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p><strong>æºç«™ä¸ºä»€ä¹ˆåœ¨æ£€æµ‹åˆ°ä¿¡é“ç©ºé—²åè¿˜è¦å†ç­‰å¾…ä¸€æ®µæ—¶é—´DIFSï¼Ÿ</strong></p><ul><li>è€ƒè™‘åˆ°å¯èƒ½æœ‰å…¶ä»–çš„ç«™æœ‰é«˜ä¼˜å…ˆçº§çš„å¸§è¦å‘é€ã€‚è‹¥æœ‰ï¼Œå°±è¦è®©é«˜ä¼˜å…ˆçº§å¸§å…ˆå‘é€</li></ul><p><strong>ç›®çš„ç«™ä¸ºä»€ä¹ˆæ­£ç¡®æ¥æ”¶æ•°æ®å¸§åè¿˜è¦ç­‰å¾…ä¸€æ®µæ—¶é—´SIFSæ‰èƒ½å‘é€ACKå¸§ï¼Ÿ</strong></p><ul><li>SIFSæ˜¯æœ€çŸ­çš„å¸§é—´é—´éš”ï¼Œç”¨æ¥åˆ†éš”å¼€å±äºä¸€æ¬¡å¯¹è¯çš„å„å¸§ï¼Œåœ¨è¿™æ®µæ—¶é—´å†…ï¼Œä¸€ä¸ªç«™ç‚¹åº”å½“èƒ½å¤Ÿä»å‘é€æ–¹å¼åˆ‡æ¢åˆ°æ¥æ”¶æ–¹å¼</li></ul></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-a756ebbd569e600a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p><strong>ä¿¡é“ç”±å¿™è½¬ä¸ºç©ºé—²ä¸”ç»è¿‡DIFSæ—¶é—´åï¼Œè¿˜è¦é€€é¿ä¸€æ®µéšæœºæ—¶é—´æ‰èƒ½ä½¿ç”¨ä¿¡é“ï¼Ÿ</strong></p><p>é˜²æ­¢å¤šä¸ªç«™ç‚¹åŒæ—¶å‘é€æ•°æ®è€Œäº§ç”Ÿç¢°æ’</p></blockquote><p><strong>ä½¿ç”¨é€€é¿ç®—æ³•çš„æ—¶æœº</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f0d70f0b26645fb4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h5 id="5-4ã€CSMA-x2F-CAåè®®çš„é€€é¿ç®—æ³•"><a href="#5-4ã€CSMA-x2F-CAåè®®çš„é€€é¿ç®—æ³•" class="headerlink" title="5.4ã€CSMA&#x2F;CAåè®®çš„é€€é¿ç®—æ³•"></a>5.4ã€CSMA&#x2F;CAåè®®çš„é€€é¿ç®—æ³•</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-1de197cb6f859f3c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>é€€é¿ç®—æ³•çš„ç¤ºä¾‹</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-12262e66fc986d52.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h5 id="5-5ã€CSMA-x2F-CAåè®®çš„ä¿¡é“é¢„çº¦å’Œè™šæ‹Ÿè½½æ³¢ç›‘å¬"><a href="#5-5ã€CSMA-x2F-CAåè®®çš„ä¿¡é“é¢„çº¦å’Œè™šæ‹Ÿè½½æ³¢ç›‘å¬" class="headerlink" title="5.5ã€CSMA&#x2F;CAåè®®çš„ä¿¡é“é¢„çº¦å’Œè™šæ‹Ÿè½½æ³¢ç›‘å¬"></a>5.5ã€CSMA&#x2F;CAåè®®çš„ä¿¡é“é¢„çº¦å’Œè™šæ‹Ÿè½½æ³¢ç›‘å¬</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-98353d62c0ef033f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-ac35b15f5f22bf7d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>è™šæ‹Ÿè½½æ³¢ç›‘å¬æœºåˆ¶èƒ½å‡å°‘éšè”½ç«™å¸¦æ¥çš„ç¢°æ’é—®é¢˜çš„ç¤ºä¾‹</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-c8d7aca5f6faec4a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><hr><h3 id="3-7ã€MACåœ°å€ã€IPåœ°å€ä»¥åŠARPåè®®"><a href="#3-7ã€MACåœ°å€ã€IPåœ°å€ä»¥åŠARPåè®®" class="headerlink" title="3.7ã€MACåœ°å€ã€IPåœ°å€ä»¥åŠARPåè®®"></a>3.7ã€MACåœ°å€ã€IPåœ°å€ä»¥åŠARPåè®®</h3><p><img src="https://upload-images.jianshu.io/upload_images/24878825-ede2c92a0c809e6c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="1ã€MACåœ°å€"><a href="#1ã€MACåœ°å€" class="headerlink" title="1ã€MACåœ°å€"></a>1ã€MACåœ°å€</h4><blockquote><ul><li><p>ä½¿ç”¨ç‚¹å¯¹ç‚¹ä¿¡é“çš„æ•°æ®é“¾è·¯å±‚ä¸éœ€è¦ä½¿ç”¨åœ°å€</p></li><li><p>ä½¿ç”¨å¹¿æ’­ä¿¡é“çš„æ•°æ®é“¾è·¯å±‚å¿…é¡»ä½¿ç”¨åœ°å€æ¥åŒºåˆ†å„ä¸»æœº</p></li></ul></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-b498a111836f82c0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h5 id="1-1ã€å¹¿æ’­ä¿¡é“çš„æ•°æ®é“¾è·¯å±‚å¿…é¡»ä½¿ç”¨åœ°å€ï¼ˆMACï¼‰"><a href="#1-1ã€å¹¿æ’­ä¿¡é“çš„æ•°æ®é“¾è·¯å±‚å¿…é¡»ä½¿ç”¨åœ°å€ï¼ˆMACï¼‰" class="headerlink" title="1.1ã€å¹¿æ’­ä¿¡é“çš„æ•°æ®é“¾è·¯å±‚å¿…é¡»ä½¿ç”¨åœ°å€ï¼ˆMACï¼‰"></a>1.1ã€å¹¿æ’­ä¿¡é“çš„æ•°æ®é“¾è·¯å±‚å¿…é¡»ä½¿ç”¨åœ°å€ï¼ˆMACï¼‰</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-eabec58905a9aad1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1199/format/webp" alt="img"></p><blockquote><p><strong>MACåœ°å€åˆç§°ä¸ºç¡¬ä»¶åœ°å€æˆ–ç‰©ç†åœ°å€</strong>ã€‚è¯·æ³¨æ„ï¼šä¸è¦è¢« â€œç‰©ç†â€ äºŒå­—è¯¯å¯¼è®¤ä¸ºç‰©ç†åœ°å€å±äºç‰©ç†å±‚èŒƒç•´ï¼Œç‰©ç†åœ°å€å±äºæ•°æ®é“¾è·¯å±‚èŒƒç•´</p></blockquote><h5 id="1-2ã€IEEE-802å±€åŸŸç½‘çš„MACåœ°å€æ ¼å¼"><a href="#1-2ã€IEEE-802å±€åŸŸç½‘çš„MACåœ°å€æ ¼å¼" class="headerlink" title="1.2ã€IEEE 802å±€åŸŸç½‘çš„MACåœ°å€æ ¼å¼"></a>1.2ã€IEEE 802å±€åŸŸç½‘çš„MACåœ°å€æ ¼å¼</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-5a66994327412b90.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p><strong>ç»„ç»‡å”¯ä¸€æ ‡è¯†ç¬¦OUI</strong></p><ul><li>ç”Ÿäº§ç½‘ç»œè®¾å¤‡çš„å‚å•†ï¼Œéœ€è¦å‘IEEEçš„æ³¨å†Œç®¡ç†æœºæ„ç”³è¯·ä¸€ä¸ªæˆ–å¤šä¸ªOUI</li></ul><p><strong>ç½‘ç»œæ¥å£æ ‡è¯†ç¬¦</strong></p><ul><li>ç”±è·å¾—OUIçš„å‚å•†è‡ªè¡Œéšæ„åˆ†é…</li></ul><p><strong>EUI-48</strong></p><ul><li>48æ˜¯è¿™ä¸ªMACåœ°å€çš„ä½æ•°</li></ul></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-70ee74506eca1df4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>å¯¹äºä½¿ç”¨EUI-48ç©ºé—´çš„åº”ç”¨ç¨‹åºï¼ŒIEEEçš„ç›®æ ‡å¯¿å‘½ä¸º100å¹´ï¼ˆç›´åˆ°2080å¹´ï¼‰ï¼Œä½†æ˜¯é¼“åŠ±é‡‡ç”¨EUI-64ä½œä¸ºæ›¿ä»£</p></blockquote><p><strong>å…³äºæ— æ•ˆçš„ MAC å¸§</strong></p><ul><li>æ•°æ®å­—æ®µçš„é•¿åº¦ä¸é•¿åº¦å­—æ®µçš„å€¼ä¸ä¸€è‡´ï¼›</li><li>å¸§çš„é•¿åº¦ä¸æ˜¯æ•´æ•°ä¸ªå­—èŠ‚ï¼›</li><li>ç”¨æ”¶åˆ°çš„å¸§æ£€éªŒåºåˆ— FCS æŸ¥å‡ºæœ‰å·®é”™ï¼›</li><li>æ•°æ®å­—æ®µçš„é•¿åº¦ä¸åœ¨ 46 ~ 1500 å­—èŠ‚ä¹‹é—´ã€‚</li><li>æœ‰æ•ˆçš„ MAC å¸§é•¿åº¦ä¸º 64 ~ 1518 å­—èŠ‚ä¹‹é—´ã€‚</li></ul><blockquote><p><strong>å¯¹äºæ£€æŸ¥å‡ºçš„æ— æ•ˆ</strong>  <strong>MAC</strong>  <strong>å¸§å°±ç®€å•åœ°ä¸¢å¼ƒã€‚ä»¥å¤ªç½‘ä¸è´Ÿè´£é‡ä¼ ä¸¢å¼ƒçš„å¸§ã€‚</strong></p></blockquote><h5 id="1-3ã€IEEE-802å±€åŸŸç½‘çš„MACåœ°å€å‘é€é¡ºåº"><a href="#1-3ã€IEEE-802å±€åŸŸç½‘çš„MACåœ°å€å‘é€é¡ºåº" class="headerlink" title="1.3ã€IEEE 802å±€åŸŸç½‘çš„MACåœ°å€å‘é€é¡ºåº"></a>1.3ã€IEEE 802å±€åŸŸç½‘çš„MACåœ°å€å‘é€é¡ºåº</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d0cf5b54089e4b40.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h5 id="1-4ã€å•æ’­MACåœ°å€ä¸¾ä¾‹"><a href="#1-4ã€å•æ’­MACåœ°å€ä¸¾ä¾‹" class="headerlink" title="1.4ã€å•æ’­MACåœ°å€ä¸¾ä¾‹"></a>1.4ã€å•æ’­MACåœ°å€ä¸¾ä¾‹</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-db7d480bafececad.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä¸»æœºBç»™ä¸»æœºCå‘é€<strong>å•æ’­å¸§</strong>ï¼Œä¸»æœºBé¦–å…ˆè¦æ„å»ºè¯¥<strong>å•æ’­å¸§</strong>ï¼Œ<strong>åœ¨å¸§é¦–éƒ¨ä¸­çš„ç›®çš„åœ°å€å­—æ®µå¡«å…¥ä¸»æœºCçš„MACåœ°å€</strong>ï¼Œæºåœ°å€å­—æ®µå¡«å…¥è‡ªå·±çš„MACåœ°å€ï¼Œå†åŠ ä¸Šå¸§é¦–éƒ¨çš„å…¶ä»–å­—æ®µã€æ•°æ®è½½è·ä»¥åŠå¸§å°¾éƒ¨ï¼Œå°±æ„æˆäº†è¯¥<strong>å•æ’­å¸§</strong></p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-a69b9384665e17aa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä¸»æœºBå°†è¯¥<strong>å•æ’­å¸§</strong>å‘é€å‡ºå»ï¼Œä¸»æœºAå’ŒCéƒ½ä¼šæ”¶åˆ°è¯¥<strong>å•æ’­å¸§</strong></p><p>ä¸»æœºAçš„ç½‘å¡å‘ç°è¯¥<strong>å•æ’­å¸§</strong>çš„ç›®çš„MACåœ°å€ä¸è‡ªå·±çš„MACåœ°å€ä¸åŒ¹é…ï¼Œä¸¢å¼ƒè¯¥å¸§</p><p>ä¸»æœºCçš„ç½‘å¡å‘ç°è¯¥<strong>å•æ’­å¸§</strong>çš„ç›®çš„MACåœ°å€ä¸è‡ªå·±çš„MACåœ°å€åŒ¹é…ï¼Œæ¥å—è¯¥å¸§</p><p>å¹¶å°†è¯¥å¸§äº¤ç»™å…¶ä¸Šå±‚å¤„ç†</p></blockquote><h5 id="1-5ã€å¹¿æ’­MACåœ°å€ä¸¾ä¾‹"><a href="#1-5ã€å¹¿æ’­MACåœ°å€ä¸¾ä¾‹" class="headerlink" title="1.5ã€å¹¿æ’­MACåœ°å€ä¸¾ä¾‹"></a>1.5ã€å¹¿æ’­MACåœ°å€ä¸¾ä¾‹</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-7a825d6f30766d99.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>å‡è®¾ä¸»æœºBè¦å‘é€ä¸€ä¸ª<strong>å¹¿æ’­å¸§</strong>ï¼Œä¸»æœºBé¦–å…ˆè¦æ„å»ºè¯¥<strong>å¹¿æ’­å¸§</strong>ï¼Œ<strong>åœ¨å¸§é¦–éƒ¨ä¸­çš„ç›®çš„åœ°å€å­—æ®µå¡«å…¥å¹¿æ’­åœ°å€</strong>ï¼Œä¹Ÿå°±æ˜¯åå…­è¿›åˆ¶çš„å…¨Fï¼Œæºåœ°å€å­—æ®µå¡«å…¥è‡ªå·±çš„MACåœ°å€ï¼Œå†åŠ ä¸Šå¸§é¦–éƒ¨ä¸­çš„å…¶ä»–å­—æ®µã€æ•°æ®è½½è·ä»¥åŠå¸§å°¾éƒ¨ï¼Œå°±æ„æˆäº†è¯¥<strong>å¹¿æ’­å¸§</strong></p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-04fe098832094ecb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä¸»æœºBè®²è¯¥<strong>å¹¿æ’­å¸§</strong>å‘é€å‡ºå»ï¼Œä¸»æœºAå’ŒCéƒ½ä¼šæ”¶åˆ°è¯¥<strong>å¹¿æ’­å¸§</strong>ï¼Œ<strong>å‘ç°è¯¥å¸§é¦–éƒ¨ä¸­çš„ç›®çš„åœ°å€å­—æ®µçš„å†…å®¹æ˜¯å¹¿æ’­åœ°å€</strong>ï¼Œå°±çŸ¥é“è¯¥å¸§æ˜¯<strong>å¹¿æ’­å¸§</strong>ï¼Œä¸»æœºAå’Œä¸»æœºCéƒ½æ¥å—è¯¥å¸§ï¼Œå¹¶å°†è¯¥å¸§äº¤ç»™ä¸Šå±‚å¤„ç†</p></blockquote><h5 id="1-6ã€å¤šæ’­MACåœ°å€ä¸¾ä¾‹"><a href="#1-6ã€å¤šæ’­MACåœ°å€ä¸¾ä¾‹" class="headerlink" title="1.6ã€å¤šæ’­MACåœ°å€ä¸¾ä¾‹"></a>1.6ã€å¤šæ’­MACåœ°å€ä¸¾ä¾‹</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-3f3a22fe2fbfa3ee.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>å‡è®¾ä¸»æœºAè¦å‘é€<strong>å¤šæ’­å¸§</strong>ç»™è¯¥<strong>å¤šæ’­åœ°å€</strong>ã€‚å°†è¯¥<strong>å¤šæ’­åœ°å€</strong>çš„å·¦èµ·ç¬¬ä¸€ä¸ªå­—èŠ‚å†™æˆ8ä¸ªæ¯”ç‰¹ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚çš„æœ€ä½æ¯”ç‰¹ä½æ˜¯1ï¼Œè¿™å°±è¡¨æ˜è¯¥åœ°å€æ˜¯<strong>å¤šæ’­åœ°å€</strong>ã€‚</p><p>å¿«é€Ÿåˆ¤æ–­åœ°å€æ˜¯ä¸æ˜¯<strong>å¤šæ’­åœ°å€</strong>ï¼Œå°±æ˜¯ä¸Šå›¾æ‰€ç¤ºç®­å¤´æ‰€æŒ‡çš„ç¬¬åå…­è¿›åˆ¶æ•°ä¸èƒ½æ•´é™¤2ï¼ˆ1,3,5,7,9,B,D,Fï¼‰ï¼Œåˆ™è¯¥åœ°å€æ˜¯<strong>å¤šæ’­åœ°å€</strong></p><p>å‡è®¾ä¸»æœºBï¼ŒCå’ŒDæ”¯æŒå¤šæ’­ï¼Œå„ç”¨æˆ·ç»™è‡ªå·±çš„ä¸»æœºé…ç½®å¤šæ’­ç»„åˆ—è¡¨<strong>å¦‚ä¸‹æ‰€ç¤º</strong></p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f274d401c24ad4d4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä¸»æœºBå±äºä¸¤ä¸ªå¤šæ’­ç»„ï¼Œä¸»æœºCä¹Ÿå±äºä¸¤ä¸ªå¤šæ’­ç»„ï¼Œè€Œä¸»æœºDä¸å±äºä»»ä½•å¤šæ’­ç»„</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-1d6c26260c21ba6a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä¸»æœºAé¦–å…ˆè¦æ„å»ºè¯¥<strong>å¤šæ’­å¸§</strong>ï¼Œ<strong>åœ¨å¸§é¦–éƒ¨ä¸­çš„ç›®çš„åœ°å€å­—æ®µå¡«å…¥è¯¥å¤šæ’­åœ°å€</strong>ï¼Œæºåœ°å€ç‚¹å¡«å…¥è‡ªå·±çš„MACåœ°å€ï¼Œå†åŠ ä¸Šå¸§é¦–éƒ¨ä¸­çš„å…¶ä»–å­—æ®µã€æ•°æ®è½½è·ä»¥åŠå¸§å°¾éƒ¨ï¼Œå°±æ„æˆäº†è¯¥<strong>å¤šæ’­å¸§</strong></p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-70e6e705d20e5c20.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä¸»æœºAå°†è¯¥<strong>å¤šæ’­å¸§</strong>å‘é€å‡ºå»ï¼Œä¸»æœºBã€Cã€Déƒ½ä¼šæ”¶åˆ°è¯¥<strong>å¤šæ’­å¸§</strong></p><p><strong>ä¸»æœºBå’ŒCå‘ç°è¯¥å¤šæ’­å¸§çš„ç›®çš„MACåœ°å€åœ¨è‡ªå·±çš„å¤šæ’­ç»„åˆ—è¡¨ä¸­</strong>ï¼Œä¸»æœºBå’ŒCéƒ½ä¼šæ¥å—è¯¥å¸§</p><p>ä¸»æœºDå‘ç°è¯¥<strong>å¤šæ’­å¸§</strong>çš„ç›®çš„MACåœ°å€ä¸åœ¨è‡ªå·±å¾—å¤šæ’­ç»„åˆ—è¡¨ä¸­ï¼Œåˆ™ä¸¢å¼ƒè¯¥<strong>å¤šæ’­å¸§</strong></p></blockquote><blockquote><p>ç»™ä¸»æœºé…ç½®å¤šæ’­ç»„åˆ—è¡¨è¿›è¡Œç§æœ‰åº”ç”¨æ—¶ï¼Œä¸å¾—ä½¿ç”¨å…¬æœ‰çš„æ ‡å‡†å¤šæ’­åœ°å€</p></blockquote><h4 id="2ã€IPåœ°å€"><a href="#2ã€IPåœ°å€" class="headerlink" title="2ã€IPåœ°å€"></a>2ã€IPåœ°å€</h4><p>IPåœ°å€å±äºç½‘ç»œå±‚çš„èŒƒç•´ï¼Œä¸å±äºæ•°æ®é“¾è·¯å±‚çš„èŒƒç•´</p><p>ä¸‹é¢å†…å®¹è®²çš„æ˜¯IPåœ°å€çš„ä½¿ç”¨ï¼Œè¯¦ç»†çš„IPåœ°å€å†…å®¹åœ¨ç½‘ç»œå±‚ä¸­ä»‹ç»</p><h5 id="2-1ã€åŸºæœ¬æ¦‚å¿µ"><a href="#2-1ã€åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="2.1ã€åŸºæœ¬æ¦‚å¿µ"></a>2.1ã€åŸºæœ¬æ¦‚å¿µ</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-597f8c69867e595b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h5 id="2-2ã€ä»ç½‘ç»œä½“ç³»ç»“æ„çœ‹IPåœ°å€ä¸MACåœ°å€"><a href="#2-2ã€ä»ç½‘ç»œä½“ç³»ç»“æ„çœ‹IPåœ°å€ä¸MACåœ°å€" class="headerlink" title="2.2ã€ä»ç½‘ç»œä½“ç³»ç»“æ„çœ‹IPåœ°å€ä¸MACåœ°å€"></a>2.2ã€ä»ç½‘ç»œä½“ç³»ç»“æ„çœ‹IPåœ°å€ä¸MACåœ°å€</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-407cbc74e63b0e50.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h5 id="2-3ã€æ•°æ®åŒ…è½¬å‘è¿‡ç¨‹ä¸­IPåœ°å€ä¸MACåœ°å€çš„å˜åŒ–æƒ…å†µ"><a href="#2-3ã€æ•°æ®åŒ…è½¬å‘è¿‡ç¨‹ä¸­IPåœ°å€ä¸MACåœ°å€çš„å˜åŒ–æƒ…å†µ" class="headerlink" title="2.3ã€æ•°æ®åŒ…è½¬å‘è¿‡ç¨‹ä¸­IPåœ°å€ä¸MACåœ°å€çš„å˜åŒ–æƒ…å†µ"></a>2.3ã€æ•°æ®åŒ…è½¬å‘è¿‡ç¨‹ä¸­IPåœ°å€ä¸MACåœ°å€çš„å˜åŒ–æƒ…å†µ</h5><p>å›¾ä¸Šå„ä¸»æœºå’Œè·¯ç”±å™¨å„æ¥å£çš„IPåœ°å€å’ŒMACåœ°å€ç”¨ç®€å•çš„æ ‡è¯†ç¬¦æ¥è¡¨ç¤º</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-77c204bc8181b3ed.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f12548de1d3cebe1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>å¦‚ä½•ä»IPåœ°å€æ‰¾å‡ºå…¶å¯¹åº”çš„MACåœ°å€ï¼Ÿ</p><p>ARPåè®®</p></blockquote><h4 id="3ã€ARPåè®®"><a href="#3ã€ARPåè®®" class="headerlink" title="3ã€ARPåè®®"></a>3ã€ARPåè®®</h4><p>å¦‚ä½•ä»IPåœ°å€æ‰¾å‡ºå…¶å¯¹åº”çš„MACåœ°å€ï¼Ÿ</p><p>ARPï¼ˆåœ°å€è§£æåè®®ï¼‰</p><h5 id="3-1ã€æµç¨‹"><a href="#3-1ã€æµç¨‹" class="headerlink" title="3.1ã€æµç¨‹"></a>3.1ã€æµç¨‹</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-5e1fd5537944a420.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>ARPé«˜é€Ÿç¼“å­˜è¡¨</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-13b5ca5d08126cde.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>å½“ä¸»æœºBè¦ç»™ä¸»æœºCå‘é€æ•°æ®åŒ…æ—¶ï¼Œä¼šé¦–å…ˆåœ¨è‡ªå·±çš„ARPé«˜é€Ÿç¼“å­˜è¡¨ä¸­æŸ¥æ‰¾ä¸»æœºCçš„IPåœ°å€æ‰€å¯¹åº”çš„MACåœ°å€ï¼Œä½†æœªæ‰¾åˆ°ï¼Œå› æ­¤ï¼Œä¸»æœºBéœ€è¦å‘é€ARPè¯·æ±‚æŠ¥æ–‡ï¼Œæ¥è·å–ä¸»æœºCçš„MACåœ°å€</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-9de96c1c37c62e26.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ARPè¯·æ±‚æŠ¥æ–‡æœ‰å…·ä½“çš„æ ¼å¼ï¼Œä¸Šå›¾çš„åªæ˜¯ç®€å•æè¿°</p><p>ARPè¯·æ±‚æŠ¥æ–‡è¢«å°è£…åœ¨MACå¸§ä¸­å‘é€ï¼Œç›®çš„åœ°å€ä¸ºå¹¿æ’­åœ°å€</p><p>ä¸»æœºBå‘é€å°è£…æœ‰ARPè¯·æ±‚æŠ¥æ–‡çš„å¹¿æ’­å¸§ï¼Œæ€»çº¿ä¸Šçš„å…¶ä»–ä¸»æœºéƒ½èƒ½æ”¶åˆ°è¯¥å¹¿æ’­å¸§</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-97a253fd9b87b3be.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>æ”¶åˆ°ARPè¯·æ±‚æŠ¥æ–‡çš„ä¸»æœºAå’Œä¸»æœºCä¼šæŠŠARPè¯·æ±‚æŠ¥æ–‡äº¤ç»™ä¸Šå±‚çš„ARPè¿›ç¨‹</p><p>ä¸»æœºAå‘ç°æ‰€è¯¢é—®çš„IPåœ°å€ä¸æ˜¯è‡ªå·±çš„IPåœ°å€ï¼Œå› æ­¤ä¸ç”¨ç†ä¼š</p><p>ä¸»æœºCçš„å‘ç°æ‰€è¯¢é—®çš„IPåœ°å€æ˜¯è‡ªå·±çš„IPåœ°å€ï¼Œéœ€è¦è¿›è¡Œå“åº”</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d852b42ef4dbea32.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-87f01b333e4599d7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-a3f00154df65aac0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>åŠ¨æ€ä¸é™æ€çš„åŒºåˆ«</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-a013636443263063.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>ARPåè®®åªèƒ½åœ¨ä¸€æ®µé“¾è·¯æˆ–ä¸€ä¸ªç½‘ç»œä¸Šä½¿ç”¨ï¼Œè€Œä¸èƒ½è·¨ç½‘ç»œä½¿ç”¨</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d5847fbcc133c6b8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ARPåè®®çš„ä½¿ç”¨æ˜¯é€æ®µé“¾è·¯è¿›è¡Œçš„</p></blockquote><h5 id="3-2ã€æ€»ç»“"><a href="#3-2ã€æ€»ç»“" class="headerlink" title="3.2ã€æ€»ç»“"></a>3.2ã€æ€»ç»“</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-11cd254f6251a6ad.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/624/format/webp" alt="img"></p><blockquote><p>ARPè¡¨ä¸­çš„IPåœ°å€ä¸MACåœ°å€çš„å¯¹åº”å…³ç³»è®°å½•ï¼Œæ˜¯<strong>ä¼šå®šæœŸè‡ªåŠ¨åˆ é™¤çš„</strong>ï¼Œ<strong>å› ä¸ºIPåœ°å€ä¸MACåœ°å€çš„å¯¹åº”å…³ç³»ä¸æ˜¯æ°¸ä¹…æ€§çš„</strong></p></blockquote><hr><h3 id="3-8ã€é›†çº¿å™¨ä¸äº¤æ¢æœºçš„åŒºåˆ«"><a href="#3-8ã€é›†çº¿å™¨ä¸äº¤æ¢æœºçš„åŒºåˆ«" class="headerlink" title="3.8ã€é›†çº¿å™¨ä¸äº¤æ¢æœºçš„åŒºåˆ«"></a>3.8ã€é›†çº¿å™¨ä¸äº¤æ¢æœºçš„åŒºåˆ«</h3><h4 id="1ã€é›†çº¿å™¨-åœ¨ç‰©ç†å±‚æ‰©å±•ä»¥å¤ªç½‘"><a href="#1ã€é›†çº¿å™¨-åœ¨ç‰©ç†å±‚æ‰©å±•ä»¥å¤ªç½‘" class="headerlink" title="1ã€é›†çº¿å™¨-åœ¨ç‰©ç†å±‚æ‰©å±•ä»¥å¤ªç½‘"></a>1ã€é›†çº¿å™¨-åœ¨ç‰©ç†å±‚æ‰©å±•ä»¥å¤ªç½‘</h4><h5 id="1-1ã€æ¦‚å¿µ"><a href="#1-1ã€æ¦‚å¿µ" class="headerlink" title="1.1ã€æ¦‚å¿µ"></a>1.1ã€æ¦‚å¿µ</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-dc092bbcb4344cf5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><ul><li><p>ä¼ ç»Ÿä»¥å¤ªç½‘æœ€åˆæ˜¯ä½¿ç”¨ç²—åŒè½´ç”µç¼†ï¼Œåæ¥æ¼”è¿›åˆ°ä½¿ç”¨æ¯”è¾ƒä¾¿å®œçš„ç»†åŒè½´ç”µç¼†ï¼Œæœ€åå‘å±•ä¸ºä½¿ç”¨æ›´ä¾¿å®œå’Œæ›´çµæ´»çš„åŒç»çº¿ã€‚</p></li><li><p>é‡‡ç”¨åŒç»çº¿çš„ä»¥å¤ªç½‘é‡‡ç”¨æ˜Ÿå½¢æ‹“æ‰‘ï¼Œåœ¨æ˜Ÿå½¢çš„ä¸­å¿ƒåˆ™å¢åŠ äº†ä¸€ç§å¯é æ€§éå¸¸é«˜çš„è®¾å¤‡ï¼Œå«åš<strong>é›†çº¿å™¨</strong> (hub)ã€‚</p></li><li><p><strong>é›†çº¿å™¨</strong>æ˜¯ä¹Ÿå¯ä»¥çœ‹åšå¤šå£ä¸­ç»§å™¨ï¼Œæ¯ä¸ªç«¯å£éƒ½å¯ä»¥æˆä¸ºä¸€ä¸ªä¸­ç»§å™¨ï¼Œä¸­ç»§å™¨æ˜¯å¯¹å‡å¼±çš„ä¿¡å·è¿›è¡Œæ”¾å¤§å’Œå‘é€çš„è®¾å¤‡</p></li><li><p><strong>é›†çº¿å™¨</strong>çš„ä»¥å¤ªç½‘åœ¨é€»è¾‘ä¸Šä»æ˜¯ä¸ªæ€»çº¿ç½‘ï¼Œéœ€è¦ä½¿ç”¨CSMA&#x2F;CDåè®®æ¥åè°ƒå„ä¸»æœºäº‰ç”¨æ€»çº¿ï¼Œåªèƒ½å·¥ä½œåœ¨åŠåŒå·¥æ¨¡å¼ï¼Œæ”¶å‘å¸§ä¸èƒ½åŒæ—¶è¿›è¡Œ</p></li></ul></blockquote><h5 id="1-2ã€é›†çº¿å™¨HUBåœ¨ç‰©ç†å±‚æ‰©å±•ä»¥å¤ªç½‘"><a href="#1-2ã€é›†çº¿å™¨HUBåœ¨ç‰©ç†å±‚æ‰©å±•ä»¥å¤ªç½‘" class="headerlink" title="1.2ã€é›†çº¿å™¨HUBåœ¨ç‰©ç†å±‚æ‰©å±•ä»¥å¤ªç½‘"></a>1.2ã€é›†çº¿å™¨HUBåœ¨ç‰©ç†å±‚æ‰©å±•ä»¥å¤ªç½‘</h5><p><strong>ä½¿ç”¨é›†çº¿å™¨æ‰©å±•</strong>ï¼šå°†å¤šä¸ªä»¥å¤ªç½‘æ®µè¿æˆæ›´å¤§çš„ã€å¤šçº§æ˜Ÿå½¢ç»“æ„çš„ä»¥å¤ªç½‘</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-0f8d87b7f79e94c8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><ul><li><p><strong>ä¼˜ç‚¹</strong></p><ol><li><p>ä½¿åŸæ¥å±äºä¸åŒç¢°æ’åŸŸçš„ä»¥å¤ªç½‘ä¸Šçš„è®¡ç®—æœºèƒ½å¤Ÿè¿›è¡Œè·¨ç¢°æ’åŸŸçš„é€šä¿¡ã€‚</p></li><li><p>æ‰©å¤§äº†ä»¥å¤ªç½‘è¦†ç›–çš„åœ°ç†èŒƒå›´ã€‚</p></li></ol></li><li><p><strong>ç¼ºç‚¹</strong></p><ol><li><p>ç¢°æ’åŸŸå¢å¤§äº†ï¼Œä½†æ€»çš„ååé‡å¹¶æœªæé«˜ã€‚</p></li><li><p>å¦‚æœä¸åŒçš„ç¢°æ’åŸŸä½¿ç”¨ä¸åŒçš„æ•°æ®ç‡ï¼Œé‚£ä¹ˆå°±ä¸èƒ½ç”¨é›†çº¿å™¨å°†å®ƒä»¬äº’è¿èµ·æ¥ã€‚</p></li></ol></li></ul></blockquote><p><strong>ç¢°æ’åŸŸ</strong></p><ul><li><strong>ç¢°æ’åŸŸï¼ˆcollision domainï¼‰</strong>åˆç§°ä¸º<strong>å†²çªåŸŸ</strong>ï¼Œæ˜¯æŒ‡ç½‘ç»œä¸­ä¸€ä¸ªç«™ç‚¹å‘å‡ºçš„å¸§ä¼šä¸å…¶ä»–ç«™ç‚¹å‘å‡ºçš„å¸§äº§ç”Ÿç¢°æ’æˆ–å†²çªçš„é‚£éƒ¨åˆ†ç½‘ç»œã€‚</li><li>ç¢°æ’åŸŸè¶Šå¤§ï¼Œå‘ç”Ÿç¢°æ’çš„æ¦‚ç‡è¶Šé«˜ã€‚</li></ul><h4 id="2ã€ä»¥å¤ªç½‘äº¤æ¢æœº-åœ¨æ•°æ®é“¾è·¯å±‚æ‰©å±•ä»¥å¤ªç½‘"><a href="#2ã€ä»¥å¤ªç½‘äº¤æ¢æœº-åœ¨æ•°æ®é“¾è·¯å±‚æ‰©å±•ä»¥å¤ªç½‘" class="headerlink" title="2ã€ä»¥å¤ªç½‘äº¤æ¢æœº-åœ¨æ•°æ®é“¾è·¯å±‚æ‰©å±•ä»¥å¤ªç½‘"></a>2ã€ä»¥å¤ªç½‘äº¤æ¢æœº-åœ¨æ•°æ®é“¾è·¯å±‚æ‰©å±•ä»¥å¤ªç½‘</h4><h5 id="2-1ã€æ¦‚å¿µ"><a href="#2-1ã€æ¦‚å¿µ" class="headerlink" title="2.1ã€æ¦‚å¿µ"></a>2.1ã€æ¦‚å¿µ</h5><ul><li>æ‰©å±•ä»¥å¤ªç½‘æ›´å¸¸ç”¨çš„æ–¹æ³•æ˜¯åœ¨æ•°æ®é“¾è·¯å±‚è¿›è¡Œã€‚</li><li>æ—©æœŸä½¿ç”¨<strong>ç½‘æ¡¥</strong>ï¼Œç°åœ¨ä½¿ç”¨<strong>ä»¥å¤ªç½‘äº¤æ¢æœº</strong>ã€‚</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-001d34e299bee061.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/876/format/webp" alt="img"></p><blockquote><p><strong>ç½‘æ¡¥</strong></p><ul><li><p>ç½‘æ¡¥å·¥ä½œåœ¨æ•°æ®é“¾è·¯å±‚ã€‚</p></li><li><p>å®ƒæ ¹æ® MAC å¸§çš„ç›®çš„åœ°å€å¯¹æ”¶åˆ°çš„å¸§è¿›è¡Œè½¬å‘å’Œè¿‡æ»¤ã€‚</p></li><li><p>å½“ç½‘æ¡¥æ”¶åˆ°ä¸€ä¸ªå¸§æ—¶ï¼Œå¹¶ä¸æ˜¯å‘æ‰€æœ‰çš„æ¥å£è½¬å‘æ­¤å¸§ï¼Œè€Œæ˜¯å…ˆæ£€æŸ¥æ­¤å¸§çš„ç›®çš„MAC åœ°å€ï¼Œç„¶åå†ç¡®å®šå°†è¯¥å¸§è½¬å‘åˆ°å“ªä¸€ä¸ªæ¥å£ï¼Œæˆ–æŠŠå®ƒä¸¢å¼ƒã€‚</p></li></ul><p><strong>äº¤æ¢æœº</strong></p><ul><li><p>1990 å¹´é—®ä¸–çš„äº¤æ¢å¼é›†çº¿å™¨ (switching hub) å¯æ˜æ˜¾åœ°æé«˜ä»¥å¤ªç½‘çš„æ€§èƒ½ã€‚</p></li><li><p>äº¤æ¢å¼é›†çº¿å™¨å¸¸ç§°ä¸º<strong>ä»¥å¤ªç½‘äº¤æ¢æœº</strong> (switch) æˆ–<strong>ç¬¬äºŒå±‚äº¤æ¢æœº</strong> (L2 switch)ï¼Œå¼ºè°ƒè¿™ç§äº¤æ¢æœºå·¥ä½œåœ¨æ•°æ®é“¾è·¯å±‚ã€‚</p></li><li><p>ä»¥å¤ªç½‘äº¤æ¢æœºå®è´¨ä¸Šå°±æ˜¯ä¸€ä¸ª<strong>å¤šæ¥å£çš„ç½‘æ¡¥</strong></p></li></ul></blockquote><h5 id="2-2ã€é›†çº¿å™¨HUBä¸äº¤æ¢æœºSWITCHåŒºåˆ«"><a href="#2-2ã€é›†çº¿å™¨HUBä¸äº¤æ¢æœºSWITCHåŒºåˆ«" class="headerlink" title="2.2ã€é›†çº¿å™¨HUBä¸äº¤æ¢æœºSWITCHåŒºåˆ«"></a>2.2ã€<strong>é›†çº¿å™¨HUBä¸äº¤æ¢æœºSWITCHåŒºåˆ«</strong></h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-a8f68b1ee60923c3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä½¿ç”¨<strong>é›†çº¿å™¨</strong>äº’è¿è€Œæˆçš„å…±äº«æ€»çº¿å¼ä»¥å¤ªç½‘ä¸Šçš„æŸä¸ªä¸»æœºï¼Œè¦ç»™å¦ä¸€ä¸ªä¸»æœºå‘é€å•æ’­å¸§ï¼Œè¯¥å•æ’­å¸§ä¼šé€šè¿‡å…±äº«æ€»çº¿ä¼ è¾“åˆ°<strong>æ€»çº¿ä¸Šçš„å…¶ä»–å„ä¸ªä¸»æœº</strong></p><p>ä½¿ç”¨äº¤æ¢æœºäº’è¿è€Œæˆçš„äº¤æ¢å¼ä»¥å¤ªç½‘ä¸Šçš„æŸä¸ªä¸»æœºï¼Œè¦ç»™å¦ä¸€ä¸ªä¸»æœºå‘é€å•æ’­å¸§ï¼Œè¯¥å•æ’­å¸§è¿›å…¥äº¤æ¢æœºåï¼Œäº¤æ¢æœºä¼šå°†è¯¥å•æ’­å¸§è½¬å‘ç»™ç›®çš„ä¸»æœºï¼Œ<strong>è€Œä¸æ˜¯ç½‘ç»œä¸­çš„å…¶ä»–å„ä¸ªä¸»æœº</strong></p><p><strong>è¿™ä¸ªä¾‹å­çš„å‰ææ¡ä»¶æ˜¯å¿½ç•¥ARPè¿‡ç¨‹ï¼Œå¹¶å‡è®¾äº¤æ¢æœºçš„å¸§äº¤æ¢è¡¨å·²ç»å­¦ä¹ æˆ–é…ç½®å¥½äº†</strong></p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-bd7d832dc7f8ffbe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p><strong>ä»¥å¤ªç½‘äº¤æ¢æœºçš„äº¤æ¢æ–¹å¼</strong></p><ul><li><p>å­˜å‚¨è½¬å‘æ–¹å¼</p><ul><li>æŠŠæ•´ä¸ªæ•°æ®å¸§<strong>å…ˆç¼“å­˜</strong>åå†è¿›è¡Œå¤„ç†ã€‚</li></ul></li><li><p>ç›´é€š (cut-through) æ–¹å¼</p><ul><li><p>æ¥æ”¶æ•°æ®å¸§çš„åŒæ—¶å°±<strong>ç«‹å³æŒ‰æ•°æ®å¸§çš„ç›®çš„ MAC åœ°å€å†³å®šè¯¥å¸§çš„è½¬å‘æ¥å£</strong>ï¼Œå› è€Œæé«˜äº†å¸§çš„è½¬å‘é€Ÿåº¦ã€‚</p></li><li><p><strong>ç¼ºç‚¹</strong>æ˜¯å®ƒä¸æ£€æŸ¥å·®é”™å°±ç›´æ¥å°†å¸§è½¬å‘å‡ºå»ï¼Œå› æ­¤æœ‰å¯èƒ½ä¹Ÿå°†ä¸€äº›æ— æ•ˆå¸§è½¬å‘ç»™å…¶ä»–çš„ç«™ã€‚</p></li></ul></li></ul><p><strong>è¿™ä¸ªä¾‹å­çš„å‰ææ¡ä»¶æ˜¯å¿½ç•¥ARPè¿‡ç¨‹ï¼Œå¹¶å‡è®¾äº¤æ¢æœºçš„å¸§äº¤æ¢è¡¨å·²ç»å­¦ä¹ æˆ–é…ç½®å¥½äº†</strong></p></blockquote><p><strong>å¯¹æ¯”é›†çº¿å™¨å’Œäº¤æ¢æœº</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-2e2faba35d2d7852.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/741/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-4638409baba882e8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>å¤šå°ä¸»æœºåŒæ—¶ç»™å¦ä¸€å°ä¸»æœºå‘é€å•æ’­å¸§</p><p>é›†çº¿å™¨ä»¥å¤ªç½‘ï¼šä¼šäº§ç”Ÿç¢°æ’ï¼Œé­é‡ç¢°æ’çš„å¸§ä¼šä¼ æ’­åˆ°æ€»çº¿ä¸Šçš„å„ä¸»æœº</p><p>äº¤æ¢æœºä»¥å¤ªç½‘ï¼šä¼šå°†å®ƒä»¬ç¼“å­˜èµ·æ¥ï¼Œç„¶åé€ä¸ªè½¬å‘ç»™ç›®çš„ä¸»æœºï¼Œä¸ä¼šäº§ç”Ÿç¢°æ’</p><p><strong>è¿™ä¸ªä¾‹å­çš„å‰ææ¡ä»¶æ˜¯å¿½ç•¥ARPè¿‡ç¨‹ï¼Œå¹¶å‡è®¾äº¤æ¢æœºçš„å¸§äº¤æ¢è¡¨å·²ç»å­¦ä¹ æˆ–é…ç½®å¥½äº†</strong></p></blockquote><p><strong>é›†çº¿å™¨æ‰©å±•ä»¥å¤ªç½‘å’Œäº¤æ¢æœºæ‰©å±•ä»¥å¤ªç½‘åŒºåˆ«</strong></p><p><strong>å•æ’­</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-34c587f82d3a1286.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>å¹¿æ’­</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-134f67554e64e22b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>å¤šä¸ªå•æ’­</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d80949431bd76379.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d5c429a2f92149ff.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>å¹¿æ’­åŸŸï¼ˆbroadcast domainï¼‰ï¼šæŒ‡è¿™æ ·ä¸€éƒ¨åˆ†ç½‘ç»œï¼Œå…¶ä¸­ä»»ä½•ä¸€å°è®¾å¤‡å‘å‡ºçš„å¹¿æ’­é€šä¿¡éƒ½èƒ½è¢«è¯¥éƒ¨åˆ†ç½‘ç»œä¸­çš„æ‰€æœ‰å…¶ä»–è®¾å¤‡æ‰€æ¥æ”¶ã€‚</p><h4 id="3ã€æ€»ç»“-1"><a href="#3ã€æ€»ç»“-1" class="headerlink" title="3ã€æ€»ç»“"></a>3ã€æ€»ç»“</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-25db1be3ca96bc2f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-df6859d2396549cf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/925/format/webp" alt="img"></p><blockquote><p>å·¥ä½œåœ¨æ•°æ®é“¾è·¯å±‚çš„ä»¥å¤ªç½‘äº¤æ¢æœºï¼Œå…¶æ€§èƒ½è¿œè¿œè¶…è¿‡å·¥ä½œåœ¨ç‰©ç†å±‚çš„é›†çº¿å™¨ï¼Œè€Œä¸”ä»·æ ¼å¹¶ä¸è´µï¼Œè¿™å°±ä½¿å¾—é›†çº¿å™¨é€æ¸è¢«å¸‚åœºæ·˜æ±°</p></blockquote><hr><h3 id="3-9ã€ä»¥å¤ªç½‘äº¤æ¢æœºè‡ªå­¦ä¹ å’Œè½¬å‘å¸§çš„æµç¨‹"><a href="#3-9ã€ä»¥å¤ªç½‘äº¤æ¢æœºè‡ªå­¦ä¹ å’Œè½¬å‘å¸§çš„æµç¨‹" class="headerlink" title="3.9ã€ä»¥å¤ªç½‘äº¤æ¢æœºè‡ªå­¦ä¹ å’Œè½¬å‘å¸§çš„æµç¨‹"></a>3.9ã€ä»¥å¤ªç½‘äº¤æ¢æœºè‡ªå­¦ä¹ å’Œè½¬å‘å¸§çš„æµç¨‹</h3><h4 id="1ã€æ¦‚å¿µ"><a href="#1ã€æ¦‚å¿µ" class="headerlink" title="1ã€æ¦‚å¿µ"></a>1ã€æ¦‚å¿µ</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-5f9db8088bf224f9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="2ã€è‡ªå­¦ä¹ å’Œè½¬å‘å¸§çš„ä¾‹å­"><a href="#2ã€è‡ªå­¦ä¹ å’Œè½¬å‘å¸§çš„ä¾‹å­" class="headerlink" title="2ã€è‡ªå­¦ä¹ å’Œè½¬å‘å¸§çš„ä¾‹å­"></a>2ã€è‡ªå­¦ä¹ å’Œè½¬å‘å¸§çš„ä¾‹å­</h4><p>ä»¥ä¸‹ä¾‹å­å‡è®¾å„ä¸»æœºçŸ¥é“ç½‘ç»œä¸­å…¶ä»–å„ä¸»æœºçš„MACåœ°å€ï¼ˆæ— éœ€è¿›è¡ŒARPï¼‰</p><p><strong>A -&gt; B</strong>(ç›²ç›®è½¬å‘ æ³›æ´ª)</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-1ef3dc4a6841b1ce.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><ol><li>A å…ˆå‘ B å‘é€ä¸€å¸§ã€‚è¯¥å¸§ä»æ¥å£ 1 è¿›å…¥åˆ°äº¤æ¢æœº</li><li>äº¤æ¢æœºæ”¶åˆ°å¸§åï¼Œå…ˆæŸ¥æ‰¾ï¼ˆå›¾ä¸­å·¦è¾¹ï¼‰äº¤æ¢è¡¨ã€‚æ²¡æœ‰æŸ¥åˆ°åº”ä»å“ªä¸ªæ¥å£è½¬å‘è¿™ä¸ªå¸§ç»™ B</li><li>äº¤æ¢æœºæŠŠè¿™ä¸ªå¸§çš„æºåœ°å€ A å’Œæ¥å£ 1 å†™å…¥ï¼ˆå›¾ä¸­å·¦è¾¹ï¼‰äº¤æ¢è¡¨ä¸­</li><li>äº¤æ¢æœºå‘é™¤æ¥å£ 1 ä»¥å¤–çš„æ‰€æœ‰çš„æ¥å£å¹¿æ’­è¿™ä¸ªå¸§</li><li>æ¥å£ 4åˆ°æ¥å£ 2ï¼Œå…ˆæŸ¥æ‰¾ï¼ˆå›¾ä¸­å³è¾¹ï¼‰äº¤æ¢è¡¨ã€‚æ²¡æœ‰æŸ¥åˆ°åº”ä»å“ªä¸ªæ¥å£è½¬å‘è¿™ä¸ªå¸§ç»™ B</li><li>äº¤æ¢æœºæŠŠè¿™ä¸ªå¸§çš„æºåœ°å€ A å’Œæ¥å£ 2 å†™å…¥ï¼ˆå›¾ä¸­å³è¾¹ï¼‰äº¤æ¢è¡¨ä¸­</li><li>é™¤Bä¸»æœºä¹‹å¤–ä¸è¯¥å¸§çš„ç›®çš„åœ°å€ä¸ç›¸ç¬¦ï¼Œå°†ä¸¢å¼ƒè¯¥å¸§</li><li>ä¸»æœºBå‘ç°æ˜¯ç»™è‡ªå·±çš„å¸§ï¼Œæ¥å—è¯¥å¸§</li></ol></blockquote><p><strong>B -&gt; A</strong>(æ˜ç¡®è½¬å‘)<img src="https://upload-images.jianshu.io/upload_images/24878825-dbe273924b7c8eea.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><ol><li>B å‘ A å‘é€ä¸€å¸§ã€‚è¯¥å¸§ä»æ¥å£ 3 è¿›å…¥åˆ°äº¤æ¢æœº</li><li>äº¤æ¢æœºæ”¶åˆ°å¸§åï¼Œå…ˆæŸ¥æ‰¾ï¼ˆå›¾ä¸­å·¦è¾¹ï¼‰äº¤æ¢è¡¨ã€‚å‘ç°ï¼ˆå›¾ä¸­å·¦è¾¹ï¼‰äº¤æ¢è¡¨ä¸­çš„ MAC åœ°å€æœ‰ Aï¼Œè¡¨æ˜è¦å‘é€ç»™Açš„å¸§åº”ä»æ¥å£1è½¬å‘å‡ºå»ã€‚äºæ˜¯å°±æŠŠè¿™ä¸ªå¸§ä¼ é€åˆ°æ¥å£ 1 è½¬å‘ç»™ Aã€‚</li><li>ä¸»æœº A å‘ç°ç›®çš„åœ°å€æ˜¯å®ƒï¼Œå°±æ¥å—è¯¥å¸§</li><li>äº¤æ¢æœºæŠŠè¿™ä¸ªå¸§çš„æºåœ°å€ B å’Œæ¥å£ 3 å†™å…¥ï¼ˆå›¾ä¸­å·¦è¾¹ï¼‰äº¤æ¢è¡¨ä¸­</li></ol></blockquote><p><strong>E -&gt; A</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-cf46c0c890cfa2a4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><ol><li>E å‘ Aå‘é€ä¸€å¸§</li><li>äº¤æ¢æœºæ”¶åˆ°å¸§åï¼Œå…ˆæŸ¥æ‰¾ï¼ˆå›¾ä¸­å³è¾¹ï¼‰äº¤æ¢è¡¨ã€‚å‘ç°ï¼ˆå›¾ä¸­å³è¾¹ï¼‰äº¤æ¢è¡¨ä¸­çš„ MAC åœ°å€æœ‰ Aï¼Œè¡¨æ˜è¦å‘é€ç»™Açš„å¸§åº”ä»æ¥å£2è½¬å‘å‡ºå»ã€‚äºæ˜¯å°±æŠŠè¿™ä¸ªå¸§ä¼ é€åˆ°æ¥å£ 2 è½¬å‘ç»™ æ¥å£ 4ã€‚</li><li>äº¤æ¢æœºæŠŠè¿™ä¸ªå¸§çš„æºåœ°å€ E å’Œæ¥å£ 3 å†™å…¥ï¼ˆå›¾ä¸­å³è¾¹ï¼‰äº¤æ¢è¡¨ä¸­</li><li>æ¥å£ 4 åˆ° å·¦è¾¹çš„äº¤æ¢æœºï¼Œå…ˆæŸ¥æ‰¾ï¼ˆå›¾ä¸­å·¦è¾¹ï¼‰äº¤æ¢è¡¨ã€‚å‘ç°ï¼ˆå›¾ä¸­å·¦è¾¹ï¼‰äº¤æ¢è¡¨ä¸­çš„ MAC åœ°å€æœ‰ Aï¼Œè¡¨æ˜è¦å‘é€ç»™Açš„å¸§åº”ä»æ¥å£1è½¬å‘å‡ºå»ã€‚äºæ˜¯å°±æŠŠè¿™ä¸ªå¸§ä¼ é€åˆ°æ¥å£ 1 è½¬å‘ç»™ Aã€‚</li><li>äº¤æ¢æœºæŠŠè¿™ä¸ªå¸§çš„æºåœ°å€ E å’Œæ¥å£ 4 å†™å…¥ï¼ˆå›¾ä¸­å·¦è¾¹ï¼‰äº¤æ¢è¡¨ä¸­</li><li>ä¸»æœº A å‘ç°ç›®çš„åœ°å€æ˜¯å®ƒï¼Œå°±æ¥å—è¯¥å¸§</li></ol></blockquote><p><strong>G -&gt; A</strong>(æ˜ç¡®ä¸¢å¼ƒ)</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-4ee1af4bc8187125.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä¸»æœº Aã€ä¸»æœº Gã€äº¤æ¢æœº 1çš„æ¥å£ 1å°±å…±äº«åŒä¸€æ¡æ€»çº¿ï¼ˆç›¸å½“äºæ€»çº¿å¼ç½‘ç»œï¼Œå¯ä»¥æƒ³è±¡æˆç”¨é›†çº¿å™¨è¿æ¥äº†ï¼‰</p><ol><li>ä¸»æœº G å‘é€ç»™ ä¸»æœº A ä¸€ä¸ªå¸§</li><li>ä¸»æœº A å’Œ äº¤æ¢æœºæ¥å£ 1éƒ½èƒ½æ¥æ”¶åˆ°</li><li>ä¸»æœº A çš„ç½‘å¡æ”¶åˆ°åï¼Œæ ¹æ®å¸§çš„ç›®çš„MACåœ°å€Aï¼Œå°±çŸ¥é“æ˜¯å‘é€ç»™è‡ªå·±çš„å¸§ï¼Œå°±æ¥å—è¯¥å¸§</li><li>äº¤æ¢æœº 1æ”¶åˆ°è¯¥å¸§åï¼Œé¦–å…ˆè¿›è¡Œç™»è®°å·¥ä½œ</li><li>ç„¶åäº¤æ¢æœº 1å¯¹è¯¥å¸§è¿›è¡Œè½¬å‘ï¼Œè¯¥å¸§çš„MACåœ°å€æ˜¯Aï¼Œåœ¨ï¼ˆå›¾ä¸­å·¦è¾¹ï¼‰äº¤æ¢è¡¨æŸ¥æ‰¾MAC åœ°å€æœ‰ A</li><li>MAC åœ°å€ä¸º Açš„æ¥å£å·æ˜¯1ï¼Œä½†æ˜¯è¯¥å¸§æ­£æ˜¯ä»æ¥å£ 1 è¿›å…¥äº¤æ¢æœºçš„ï¼Œäº¤æ¢æœºä¸ä¼šå†ä»è¯¥æ¥å£ 1 è®²å¸§è½¬å‘å‡ºå»ï¼Œå› ä¸ºè¿™æ˜¯æ²¡æœ‰å¿…è¦ï¼Œäºæ˜¯ä¸¢å¼ƒè¯¥å¸§</li></ol></blockquote><p>éšç€ç½‘ç»œä¸­å„ä¸»æœºéƒ½å‘é€äº†å¸§åï¼Œç½‘ç»œä¸­çš„å„äº¤æ¢æœºå°±å¯ä»¥å­¦ä¹ åˆ°å„ä¸»æœºçš„MACåœ°å€ï¼Œä»¥åŠå®ƒä»¬ä¸è‡ªå·±å„æ¥å£çš„å¯¹åº”å…³ç³»</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-071ec78303db43c3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>è€ƒè™‘åˆ°å¯èƒ½æœ‰æ—¶è¦åœ¨äº¤æ¢æœºçš„æ¥å£æ›´æ¢ä¸»æœºï¼Œæˆ–è€…ä¸»æœºè¦æ›´æ¢å…¶ç½‘ç»œé€‚é…å™¨ï¼Œè¿™å°±éœ€è¦æ›´æ”¹äº¤æ¢è¡¨ä¸­çš„é¡¹ç›®ã€‚ä¸ºæ­¤ï¼Œåœ¨äº¤æ¢è¡¨ä¸­æ¯ä¸ªé¡¹ç›®éƒ½è®¾æœ‰ä¸€å®šçš„<strong>æœ‰æ•ˆæ—¶é—´</strong>ã€‚<strong>è¿‡æœŸçš„é¡¹ç›®å°±è‡ªåŠ¨è¢«åˆ é™¤</strong>ã€‚</p><p><strong>ä»¥å¤ªç½‘äº¤æ¢æœºçš„è¿™ç§è‡ªå­¦ä¹ æ–¹æ³•ä½¿å¾—ä»¥å¤ªç½‘äº¤æ¢æœºèƒ½å¤Ÿå³æ’å³ç”¨ï¼Œä¸å¿…äººå·¥è¿›è¡Œé…ç½®ï¼Œå› æ­¤éå¸¸æ–¹ä¾¿ã€‚</strong></p></blockquote><h4 id="3ã€æ€»ç»“-2"><a href="#3ã€æ€»ç»“-2" class="headerlink" title="3ã€æ€»ç»“"></a>3ã€æ€»ç»“</h4><p><strong>äº¤æ¢æœºè‡ªå­¦ä¹ å’Œè½¬å‘å¸§çš„æ­¥éª¤å½’çº³</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-b39e4a9145068aca.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/983/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-3fc4ca18dcbaef03.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><hr><h3 id="3-10ã€ä»¥å¤ªç½‘äº¤æ¢æœºçš„ç”Ÿæˆæ ‘åè®®STP"><a href="#3-10ã€ä»¥å¤ªç½‘äº¤æ¢æœºçš„ç”Ÿæˆæ ‘åè®®STP" class="headerlink" title="3.10ã€ä»¥å¤ªç½‘äº¤æ¢æœºçš„ç”Ÿæˆæ ‘åè®®STP"></a>3.10ã€ä»¥å¤ªç½‘äº¤æ¢æœºçš„ç”Ÿæˆæ ‘åè®®STP</h3><h4 id="1ã€å¦‚ä½•æé«˜ä»¥å¤ªç½‘çš„å¯é æ€§"><a href="#1ã€å¦‚ä½•æé«˜ä»¥å¤ªç½‘çš„å¯é æ€§" class="headerlink" title="1ã€å¦‚ä½•æé«˜ä»¥å¤ªç½‘çš„å¯é æ€§"></a>1ã€å¦‚ä½•æé«˜ä»¥å¤ªç½‘çš„å¯é æ€§</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-04211a392a1b4b1c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/983/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-5033bf0f4c26a32b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/850/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-a65d811129786ec6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="2ã€ç”Ÿæˆæ ‘åè®®STP"><a href="#2ã€ç”Ÿæˆæ ‘åè®®STP" class="headerlink" title="2ã€ç”Ÿæˆæ ‘åè®®STP"></a>2ã€ç”Ÿæˆæ ‘åè®®STP</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d43f5c0c9ddbaf93.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1133/format/webp" alt="img"></p><blockquote><ul><li><p>IEEE 802.1D æ ‡å‡†åˆ¶å®šäº†ä¸€ä¸ª<strong>ç”Ÿæˆæ ‘åè®® STP</strong> (Spanning Tree Protocol)ã€‚</p></li><li><p>å…¶<strong>è¦ç‚¹</strong>æ˜¯ï¼š<strong>ä¸æ”¹å˜</strong>ç½‘ç»œçš„å®é™…æ‹“æ‰‘ï¼Œä½†åœ¨é€»è¾‘ä¸Šåˆ™åˆ‡æ–­æŸäº›é“¾è·¯ï¼Œä½¿å¾—ä»ä¸€å°ä¸»æœºåˆ°æ‰€æœ‰å…¶ä»–ä¸»æœºçš„è·¯å¾„æ˜¯<strong>æ— ç¯è·¯çš„æ ‘çŠ¶ç»“æ„</strong>ï¼Œä»è€Œæ¶ˆé™¤äº†å…œåœˆå­ç°è±¡ã€‚</p></li></ul></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-36746a91a09f583c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/895/format/webp" alt="img"></p><hr><h3 id="3-11ã€è™šæ‹Ÿå±€åŸŸç½‘VLAN"><a href="#3-11ã€è™šæ‹Ÿå±€åŸŸç½‘VLAN" class="headerlink" title="3.11ã€è™šæ‹Ÿå±€åŸŸç½‘VLAN"></a>3.11ã€è™šæ‹Ÿå±€åŸŸç½‘VLAN</h3><h4 id="1ã€ä¸ºä»€ä¹ˆè¦è™šæ‹Ÿå±€åŸŸç½‘VLAN"><a href="#1ã€ä¸ºä»€ä¹ˆè¦è™šæ‹Ÿå±€åŸŸç½‘VLAN" class="headerlink" title="1ã€ä¸ºä»€ä¹ˆè¦è™šæ‹Ÿå±€åŸŸç½‘VLAN"></a>1ã€ä¸ºä»€ä¹ˆè¦è™šæ‹Ÿå±€åŸŸç½‘VLAN</h4><p><strong>å¹¿æ’­é£æš´</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-a2a78b40ae5307db.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>åˆ†å‰²å¹¿æ’­åŸŸçš„æ–¹æ³•</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-89e9ef3fdfcc530c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä¸ºäº†åˆ†å‰²å¹¿æ’­åŸŸï¼Œæ‰€ä»¥è™šæ‹Ÿå±€åŸŸç½‘VLANæŠ€æœ¯åº”è¿è€Œç”Ÿ</p></blockquote><h4 id="2ã€æ¦‚å¿µ"><a href="#2ã€æ¦‚å¿µ" class="headerlink" title="2ã€æ¦‚å¿µ"></a>2ã€æ¦‚å¿µ</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-3f98534c040b90f4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><ul><li><p>åˆ©ç”¨ä»¥å¤ªç½‘äº¤æ¢æœºå¯ä»¥å¾ˆæ–¹ä¾¿åœ°å®ç°è™šæ‹Ÿå±€åŸŸç½‘ VLAN (Virtual LAN)ã€‚</p></li><li><p>IEEE 802.1Q å¯¹è™šæ‹Ÿå±€åŸŸç½‘ VLAN çš„<strong>å®šä¹‰</strong>ï¼š  <strong>è™šæ‹Ÿå±€åŸŸç½‘ VLAN</strong> æ˜¯ç”±ä¸€äº›å±€åŸŸç½‘ç½‘æ®µæ„æˆçš„<strong>ä¸ç‰©ç†ä½ç½®æ— å…³çš„é€»è¾‘ç»„</strong>ï¼Œè€Œè¿™äº›ç½‘æ®µå…·æœ‰æŸäº›å…±åŒçš„éœ€æ±‚ã€‚æ¯ä¸€ä¸ª VLAN çš„å¸§éƒ½æœ‰ä¸€ä¸ªæ˜ç¡®çš„æ ‡è¯†ç¬¦ï¼ŒæŒ‡æ˜å‘é€è¿™ä¸ªå¸§çš„è®¡ç®—æœºæ˜¯å±äºå“ªä¸€ä¸ª VLANã€‚</p></li><li><p>åŒä¸€ä¸ªVLANå†…éƒ¨å¯ä»¥å¹¿æ’­é€šä¿¡ï¼Œä¸åŒVLANä¸å¯ä»¥å¹¿æ’­é€šä¿¡</p></li><li><p><strong>è™šæ‹Ÿå±€åŸŸç½‘å…¶å®åªæ˜¯å±€åŸŸç½‘ç»™ç”¨æˆ·æä¾›çš„ä¸€ç§æœåŠ¡ï¼Œè€Œå¹¶ä¸æ˜¯ä¸€ç§æ–°å‹å±€åŸŸç½‘ã€‚</strong></p></li><li><p>ç”±äºè™šæ‹Ÿå±€åŸŸç½‘æ˜¯ç”¨æˆ·å’Œç½‘ç»œèµ„æºçš„é€»è¾‘ç»„åˆï¼Œå› æ­¤å¯æŒ‰ç…§éœ€è¦å°†æœ‰å…³è®¾å¤‡å’Œèµ„æºéå¸¸æ–¹ä¾¿åœ°é‡æ–°ç»„åˆï¼Œä½¿ç”¨æˆ·ä»ä¸åŒçš„æœåŠ¡å™¨æˆ–æ•°æ®åº“ä¸­å­˜å–æ‰€éœ€çš„èµ„æºã€‚</p></li></ul></blockquote><h4 id="3ã€è™šæ‹Ÿå±€åŸŸç½‘VLANçš„å®ç°æœºåˆ¶"><a href="#3ã€è™šæ‹Ÿå±€åŸŸç½‘VLANçš„å®ç°æœºåˆ¶" class="headerlink" title="3ã€è™šæ‹Ÿå±€åŸŸç½‘VLANçš„å®ç°æœºåˆ¶"></a>3ã€è™šæ‹Ÿå±€åŸŸç½‘VLANçš„å®ç°æœºåˆ¶</h4><p>è™šæ‹Ÿå±€åŸŸç½‘VLANæŠ€æœ¯æ˜¯åœ¨äº¤æ¢æœºä¸Šå®ç°çš„ï¼Œéœ€è¦äº¤æ¢æœºèƒ½å¤Ÿå®ç°ä»¥ä¸‹åŠŸèƒ½</p><ul><li>èƒ½å¤Ÿå¤„ç†å¸¦æœ‰VLANæ ‡è®°çš„å¸§â€”â€”IEEE 802.1 Qå¸§</li><li>äº¤æ¢æœºçš„å„ç«¯å£å¯ä»¥æ”¯æŒä¸åŒçš„ç«¯å£ç±»å‹ï¼Œä¸åŒç«¯å£ç±»å‹çš„ç«¯å£å¯¹å¸§çš„å¤„ç†æ–¹å¼æœ‰æ‰€ä¸åŒ</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-5d3549cc02f9a3b4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6af352f81b800a98.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>Accessç«¯å£</strong></p><p>äº¤æ¢æœºä¸ç”¨æˆ·è®¡ç®—æœºä¹‹é—´çš„äº’è¿</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-44a2e259c33ecfd3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/938/format/webp" alt="img"></p><blockquote><p>åŒä¸€ä¸ªVLANå†…éƒ¨å¯ä»¥å¹¿æ’­é€šä¿¡ï¼Œä¸åŒVLANä¸å¯ä»¥å¹¿æ’­é€šä¿¡</p></blockquote><p><strong>Truckç«¯å£</strong></p><p>äº¤æ¢æœºä¹‹é—´æˆ–äº¤æ¢æœºä¸è·¯ç”±å™¨ä¹‹é—´çš„äº’è¿</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-a93996aae716c6aa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1184/format/webp" alt="img"></p><p><strong>å°ä¾‹é¢˜</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-dbf84ad8998fae58.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>åä¸ºäº¤æ¢æœºç§æœ‰çš„Hybridç«¯å£ç±»å‹</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-653b80a66c3cc5bb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/908/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-239ec8f47d072a9b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1069/format/webp" alt="img"></p><h4 id="4ã€æ€»ç»“"><a href="#4ã€æ€»ç»“" class="headerlink" title="4ã€æ€»ç»“"></a>4ã€æ€»ç»“</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-dd58aec183276962.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p><strong>è™šæ‹Ÿå±€åŸŸç½‘ä¼˜ç‚¹</strong></p><p>è™šæ‹Ÿå±€åŸŸç½‘ï¼ˆVLANï¼‰æŠ€æœ¯å…·æœ‰ä»¥ä¸‹ä¸»è¦ä¼˜ç‚¹ï¼š</p><ol><li>æ”¹å–„äº†æ€§èƒ½</li><li>ç®€åŒ–äº†ç®¡ç†</li><li>é™ä½äº†æˆæœ¬</li><li>æ”¹å–„äº†å®‰å…¨æ€§</li></ol></blockquote><h2 id="å››ã€ç½‘ç»œå±‚"><a href="#å››ã€ç½‘ç»œå±‚" class="headerlink" title="å››ã€ç½‘ç»œå±‚"></a>å››ã€ç½‘ç»œå±‚</h2><h3 id="4-1ã€ç½‘ç»œå±‚æ¦‚è¿°"><a href="#4-1ã€ç½‘ç»œå±‚æ¦‚è¿°" class="headerlink" title="4.1ã€ç½‘ç»œå±‚æ¦‚è¿°"></a>4.1ã€ç½‘ç»œå±‚æ¦‚è¿°</h3><h4 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><ul><li>ç½‘ç»œå±‚çš„ä¸»è¦ä»»åŠ¡æ˜¯<strong>å®ç°ç½‘ç»œäº’è¿</strong>ï¼Œè¿›è€Œ<strong>å®ç°æ•°æ®åŒ…åœ¨å„ç½‘ç»œä¹‹é—´çš„ä¼ è¾“</strong></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-afcf88ff0d16dc80.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1190/format/webp" alt="img"></p><blockquote><p>è¿™äº›å¼‚æ„å‹ç½‘ç»œN1~N7å¦‚æœåªæ˜¯éœ€è¦å„è‡ªå†…éƒ¨é€šä¿¡ï¼Œä»–ä»¬åªè¦å®ç°å„è‡ªçš„ç‰©ç†å±‚å’Œæ•°æ®é“¾è·¯å±‚å³å¯</p><p>ä½†æ˜¯å¦‚æœè¦å°†è¿™äº›å¼‚æ„å‹ç½‘ç»œäº’è¿èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªæ›´å¤§çš„äº’è”ç½‘ï¼Œå°±éœ€è¦å®ç°ç½‘ç»œå±‚è®¾å¤‡è·¯ç”±å™¨</p><p>æœ‰æ—¶ä¸ºäº†ç®€å•èµ·è§ï¼Œå¯ä»¥ä¸ç”¨ç”»å‡ºè¿™äº›ç½‘ç»œï¼Œå›¾ä¸­N1~N7ï¼Œè€Œå°†ä»–ä»¬çœ‹åšæ˜¯ä¸€æ¡é“¾è·¯å³å¯</p></blockquote><ul><li><p>è¦å®ç°ç½‘ç»œå±‚ä»»åŠ¡ï¼Œéœ€è¦è§£å†³ä¸€ä¸‹ä¸»è¦é—®é¢˜ï¼š</p><ul><li>ç½‘ç»œå±‚å‘è¿è¾“å±‚æä¾›æ€æ ·çš„æœåŠ¡ï¼ˆâ€œå¯é ä¼ è¾“â€è¿˜æ˜¯â€œä¸å¯é ä¼ è¾“â€ï¼‰</li></ul><p>åœ¨æ•°æ®é“¾è·¯å±‚é‚£è¯¾è®²è¿‡çš„å¯é ä¼ è¾“ï¼Œè¯¦æƒ…å¯ä»¥çœ‹é‚£è¾¹çš„ç¬”è®°ï¼šç½‘ç»œå±‚å¯¹ä»¥ä¸‹çš„<strong>åˆ†ç»„ä¸¢å¤±</strong>ã€<strong>åˆ†ç»„å¤±åº</strong>ã€<strong>åˆ†ç»„é‡å¤</strong>çš„ä¼ è¾“é”™è¯¯é‡‡å–æªæ–½ï¼Œä½¿å¾—æ¥æ”¶æ–¹èƒ½æ­£ç¡®æ¥å—å‘é€æ–¹å‘é€çš„æ•°æ®ï¼Œå°±æ˜¯<strong>å¯é ä¼ è¾“</strong>ï¼Œåä¹‹ï¼Œå¦‚æœä»€ä¹ˆæªæ–½ä¹Ÿä¸é‡‡å–ï¼Œåˆ™æ˜¯<strong>ä¸å¯é ä¼ è¾“</strong></p><ul><li>ç½‘ç»œå±‚å¯»å€é—®é¢˜</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-5993e7f74bf3a7ff.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä¸€ä¸ªè·¯ç”±å™¨å¦‚æœè¿æ¥å¤šä¸ªç½‘ç»œï¼Œå°±æœ‰å¤šä¸ªç½‘ç»œç»™ä»–åˆ†é…çš„ipåœ°å€ã€‚</p></blockquote><ul><li>è·¯ç”±é€‰æ‹©é—®é¢˜</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-8db9ef0ef83c53ba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>è·¯ç”±å™¨æ”¶åˆ°æ•°æ®åï¼Œæ˜¯ä¾æ®ä»€ä¹ˆæ¥å†³å®šå°†æ•°æ®åŒ…ä»è‡ªå·±çš„å“ªä¸ªæ¥å£è½¬å‘å‡ºå»ï¼Ÿ</p><p><strong>ä¾æ®æ•°æ®åŒ…çš„<code>ç›®çš„åœ°å€å’Œè·¯ç”±å™¨ä¸­çš„è·¯ç”±è¡¨</code></strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-14fffa90e5256d53.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/438/format/webp" alt="img"></p><p>ä½†åœ¨å®é™…å½“ä¸­ï¼Œè·¯ç”±å™¨æ˜¯æ€æ ·çŸ¥é“è¿™äº›è·¯ç”±è®°å½•ï¼Ÿ</p><ul><li><p>ç”±ç”¨æˆ·æˆ–ç½‘ç»œç®¡ç†å‘˜è¿›è¡Œäººå·¥é…ç½®ï¼Œè¿™ç§æ–¹æ³•åªé€‚ç”¨äºè§„æ¨¡è¾ƒå°ä¸”ç½‘ç»œæ‹“æ‰‘ä¸æ”¹å˜çš„å°å‹äº’è”ç½‘</p></li><li><p><strong>å¦ä¸€ç§æ˜¯å®ç°å„ç§è·¯ç”±é€‰æ‹©åè®®ï¼Œç”±è·¯ç”±å™¨æ‰§è¡Œè·¯ç”±é€‰æ‹©åè®®ä¸­æ‰€è§„å®šçš„è·¯ç”±é€‰æ‹©ç®—æ³•ï¼Œè€Œè‡ªåŠ¨å¾—å‡ºè·¯ç”±è¡¨ä¸­çš„è·¯æœ‰è®°å½•ï¼Œè¿™ç§æ–¹æ³•æ›´é€‚åˆè§„æ¨¡è¾ƒå¤§ä¸”ç½‘ç»œæ‹“æ‰‘ç»å¸¸æ”¹å˜çš„å¤§å‹äº’è”ç½‘</strong></p></li></ul></blockquote></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-87fc7ad0cc9ba272.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>è¡¥å…… <strong>ç½‘ç»œå±‚ï¼ˆç½‘é™…å±‚ï¼‰</strong>é™¤äº† <strong>IPåè®®</strong>å¤–ï¼Œè¿˜æœ‰ä¹‹å‰ä»‹ç»è¿‡çš„<strong>åœ°å€è§£æåè®®ARP</strong>ï¼Œè¿˜æœ‰<strong>ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ICMP</strong>ï¼Œ<strong>ç½‘é™…ç»„ç®¡ç†åè®®IGMP</strong></p></blockquote><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-a692d0cb739f39ea.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><hr><h3 id="4-2ã€ç½‘ç»œå±‚æä¾›çš„ä¸¤ç§æœåŠ¡"><a href="#4-2ã€ç½‘ç»œå±‚æä¾›çš„ä¸¤ç§æœåŠ¡" class="headerlink" title="4.2ã€ç½‘ç»œå±‚æä¾›çš„ä¸¤ç§æœåŠ¡"></a>4.2ã€ç½‘ç»œå±‚æä¾›çš„ä¸¤ç§æœåŠ¡</h3><ul><li>åœ¨è®¡ç®—æœºç½‘ç»œé¢†åŸŸï¼Œç½‘ç»œå±‚åº”è¯¥å‘è¿è¾“å±‚æä¾›æ€æ ·çš„æœåŠ¡ï¼ˆâ€œ<strong>é¢å‘è¿æ¥</strong>â€è¿˜æ˜¯â€œ<strong>æ— è¿æ¥</strong>â€ï¼‰æ›¾å¼•èµ·äº†é•¿æœŸçš„äº‰è®ºã€‚</li><li>äº‰è®ºç„¦ç‚¹çš„å®è´¨å°±æ˜¯ï¼š<strong>åœ¨è®¡ç®—æœºé€šä¿¡ä¸­ï¼Œå¯é äº¤ä»˜åº”å½“ç”±è°æ¥è´Ÿè´£</strong>ï¼Ÿæ˜¯<strong>ç½‘ç»œ</strong>è¿˜æ˜¯<strong>ç«¯ç³»ç»Ÿ</strong>ï¼Ÿ</li></ul><h4 id="é¢å‘è¿æ¥çš„è™šç”µè·¯æœåŠ¡"><a href="#é¢å‘è¿æ¥çš„è™šç”µè·¯æœåŠ¡" class="headerlink" title="é¢å‘è¿æ¥çš„è™šç”µè·¯æœåŠ¡"></a>é¢å‘è¿æ¥çš„è™šç”µè·¯æœåŠ¡</h4><p><strong>ä¸€ç§è§‚ç‚¹ï¼šè®©ç½‘ç»œè´Ÿè´£å¯é äº¤ä»˜</strong></p><ul><li>è¿™ç§è§‚ç‚¹è®¤ä¸ºï¼Œåº”å€ŸåŠ©äºç”µä¿¡ç½‘çš„æˆåŠŸç»éªŒï¼Œè®©ç½‘ç»œè´Ÿè´£å¯é äº¤ä»˜ï¼Œè®¡ç®—æœºç½‘ç»œåº”æ¨¡ä»¿ç”µä¿¡ç½‘ç»œï¼Œä½¿ç”¨<strong>é¢å‘è¿æ¥</strong>çš„é€šä¿¡æ–¹å¼ã€‚</li><li>é€šä¿¡ä¹‹å‰å…ˆå»ºç«‹<strong>è™šç”µè·¯</strong> (Virtual Circuit)ï¼Œä»¥ä¿è¯åŒæ–¹é€šä¿¡æ‰€éœ€çš„ä¸€åˆ‡ç½‘ç»œèµ„æºã€‚</li><li>å¦‚æœå†ä½¿ç”¨å¯é ä¼ è¾“çš„ç½‘ç»œåè®®ï¼Œå°±å¯ä½¿æ‰€å‘é€çš„åˆ†ç»„æ— å·®é”™æŒ‰åºåˆ°è¾¾ç»ˆç‚¹ï¼Œä¸ä¸¢å¤±ã€ä¸é‡å¤ã€‚</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-3e9eab4cca1d0298.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>å‘é€æ–¹</strong> å‘é€ç»™ <strong>æ¥æ”¶æ–¹</strong> çš„æ‰€æœ‰åˆ†ç»„éƒ½æ²¿ç€åŒä¸€æ¡è™šç”µè·¯ä¼ é€</p><blockquote><ul><li><p>è™šç”µè·¯è¡¨ç¤ºè¿™åªæ˜¯ä¸€æ¡é€»è¾‘ä¸Šçš„è¿æ¥ï¼Œåˆ†ç»„éƒ½æ²¿ç€è¿™æ¡é€»è¾‘è¿æ¥æŒ‰ç…§å­˜å‚¨è½¬å‘æ–¹å¼ä¼ é€ï¼Œè€Œå¹¶ä¸æ˜¯çœŸæ­£å»ºç«‹äº†ä¸€æ¡ç‰©ç†è¿æ¥ã€‚</p></li><li><p>è¯·æ³¨æ„ï¼Œç”µè·¯äº¤æ¢çš„ç”µè¯é€šä¿¡æ˜¯å…ˆå»ºç«‹äº†ä¸€æ¡çœŸæ­£çš„è¿æ¥ã€‚</p></li><li><p>å› æ­¤åˆ†ç»„äº¤æ¢çš„è™šè¿æ¥å’Œç”µè·¯äº¤æ¢çš„è¿æ¥åªæ˜¯ç±»ä¼¼ï¼Œä½†å¹¶ä¸å®Œå…¨ä¸€æ ·</p></li></ul></blockquote><h4 id="æ— è¿æ¥çš„æ•°æ®æŠ¥æœåŠ¡"><a href="#æ— è¿æ¥çš„æ•°æ®æŠ¥æœåŠ¡" class="headerlink" title="æ— è¿æ¥çš„æ•°æ®æŠ¥æœåŠ¡"></a>æ— è¿æ¥çš„æ•°æ®æŠ¥æœåŠ¡</h4><p><strong>å¦ä¸€ç§è§‚ç‚¹ï¼šç½‘ç»œæä¾›æ•°æ®æŠ¥æœåŠ¡</strong></p><ul><li>äº’è”ç½‘çš„å…ˆé©±è€…æå‡ºäº†ä¸€ç§å´­æ–°çš„ç½‘ç»œè®¾è®¡æ€è·¯ã€‚</li><li>ç½‘ç»œå±‚å‘ä¸Šåªæä¾›ç®€å•çµæ´»çš„ã€<strong>æ— è¿æ¥çš„</strong>ã€<strong>å°½æœ€å¤§åŠªåŠ›äº¤ä»˜</strong>çš„<strong>æ•°æ®æŠ¥æœåŠ¡</strong>ã€‚</li><li>ç½‘ç»œåœ¨å‘é€åˆ†ç»„æ—¶ä¸éœ€è¦å…ˆå»ºç«‹è¿æ¥ã€‚æ¯ä¸€ä¸ªåˆ†ç»„ï¼ˆå³ IP æ•°æ®æŠ¥ï¼‰ç‹¬ç«‹å‘é€ï¼Œä¸å…¶å‰åçš„åˆ†ç»„æ— å…³ï¼ˆä¸è¿›è¡Œç¼–å·ï¼‰ã€‚</li><li><strong>ç½‘ç»œå±‚ä¸æä¾›æœåŠ¡è´¨é‡çš„æ‰¿è¯º</strong>ã€‚å³æ‰€ä¼ é€çš„åˆ†ç»„å¯èƒ½å‡ºé”™ã€ä¸¢å¤±ã€é‡å¤å’Œå¤±åºï¼ˆä¸æŒ‰åºåˆ°è¾¾ç»ˆç‚¹ï¼‰ï¼Œå½“ç„¶ä¹Ÿä¸ä¿è¯åˆ†ç»„ä¼ é€çš„æ—¶é™ã€‚</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-0a52c46cee7f1ffd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>å‘é€æ–¹</strong> å‘é€ç»™ <strong>æ¥æ”¶æ–¹</strong> çš„åˆ†ç»„å¯èƒ½æ²¿ç€ä¸åŒè·¯å¾„ä¼ é€</p><blockquote><p><strong>å°½æœ€å¤§åŠªåŠ›äº¤ä»˜</strong></p><ul><li><p>å¦‚æœä¸»æœºï¼ˆå³ç«¯ç³»ç»Ÿï¼‰ä¸­çš„è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡éœ€è¦æ˜¯å¯é çš„ï¼Œé‚£ä¹ˆå°±ç”±ç½‘ç»œçš„<strong>ä¸»æœºä¸­çš„è¿è¾“å±‚è´Ÿè´£å¯é äº¤ä»˜ï¼ˆåŒ…æ‹¬å·®é”™å¤„ç†ã€æµé‡æ§åˆ¶ç­‰ï¼‰</strong> ã€‚</p></li><li><p><strong>é‡‡ç”¨è¿™ç§è®¾è®¡æ€è·¯çš„å¥½å¤„æ˜¯</strong>ï¼šç½‘ç»œçš„é€ ä»·å¤§å¤§é™ä½ï¼Œè¿è¡Œæ–¹å¼çµæ´»ï¼Œèƒ½å¤Ÿé€‚åº”å¤šç§åº”ç”¨ã€‚</p></li><li><p>äº’è¿ç½‘èƒ½å¤Ÿå‘å±•åˆ°ä»Šæ—¥çš„è§„æ¨¡ï¼Œå……åˆ†è¯æ˜äº†å½“åˆé‡‡ç”¨è¿™ç§è®¾è®¡æ€è·¯çš„æ­£ç¡®æ€§ã€‚</p></li></ul></blockquote><h4 id="è™šç”µè·¯æœåŠ¡ä¸æ•°æ®æŠ¥æœåŠ¡çš„å¯¹æ¯”"><a href="#è™šç”µè·¯æœåŠ¡ä¸æ•°æ®æŠ¥æœåŠ¡çš„å¯¹æ¯”" class="headerlink" title="è™šç”µè·¯æœåŠ¡ä¸æ•°æ®æŠ¥æœåŠ¡çš„å¯¹æ¯”"></a>è™šç”µè·¯æœåŠ¡ä¸æ•°æ®æŠ¥æœåŠ¡çš„å¯¹æ¯”</h4><table><thead><tr><th><strong>å¯¹æ¯”çš„æ–¹é¢</strong></th><th><strong>è™šç”µè·¯æœåŠ¡</strong></th><th><strong>æ•°æ®æŠ¥æœåŠ¡</strong></th></tr></thead><tbody><tr><td><strong>æ€è·¯</strong></td><td><strong>å¯é é€šä¿¡åº”å½“ç”±ç½‘ç»œæ¥ä¿è¯</strong></td><td><strong>å¯é é€šä¿¡åº”å½“ç”±ç”¨æˆ·ä¸»æœºæ¥ä¿è¯</strong></td></tr><tr><td><strong>è¿æ¥çš„å»ºç«‹</strong></td><td><strong>å¿…é¡»æœ‰</strong></td><td><strong>ä¸éœ€è¦</strong></td></tr><tr><td><strong>ç»ˆç‚¹åœ°å€</strong></td><td><strong>ä»…åœ¨è¿æ¥å»ºç«‹é˜¶æ®µä½¿ç”¨ï¼Œæ¯ä¸ªåˆ†ç»„ä½¿ç”¨çŸ­çš„è™šç”µè·¯å·</strong></td><td><strong>æ¯ä¸ªåˆ†ç»„éƒ½æœ‰ç»ˆç‚¹çš„å®Œæ•´åœ°å€</strong></td></tr><tr><td><strong>åˆ†ç»„çš„è½¬å‘</strong></td><td><strong>å±äºåŒä¸€æ¡è™šç”µè·¯çš„åˆ†ç»„å‡æŒ‰ç…§åŒä¸€è·¯ç”±è¿›è¡Œè½¬å‘</strong></td><td><strong>æ¯ä¸ªåˆ†ç»„ç‹¬ç«‹é€‰æ‹©è·¯ç”±è¿›è¡Œè½¬å‘</strong></td></tr><tr><td><strong>å½“ç»“ç‚¹å‡ºæ•…éšœæ—¶</strong></td><td><strong>æ‰€æœ‰é€šè¿‡å‡ºæ•…éšœçš„ç»“ç‚¹çš„è™šç”µè·¯å‡ä¸èƒ½å·¥ä½œ</strong></td><td><strong>å‡ºæ•…éšœçš„ç»“ç‚¹å¯èƒ½ä¼šä¸¢å¤±åˆ†ç»„ï¼Œä¸€äº›è·¯ç”±å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–</strong></td></tr><tr><td><strong>åˆ†ç»„çš„é¡ºåº</strong></td><td><strong>æ€»æ˜¯æŒ‰å‘é€é¡ºåºåˆ°è¾¾ç»ˆç‚¹</strong></td><td><strong>åˆ°è¾¾ç»ˆç‚¹æ—¶ä¸ä¸€å®šæŒ‰å‘é€é¡ºåº</strong></td></tr><tr><td><strong>ç«¯åˆ°ç«¯çš„å·®é”™å¤„ç†å’Œæµé‡æ§åˆ¶</strong></td><td><strong>å¯ä»¥ç”±ç½‘ç»œè´Ÿè´£ï¼Œä¹Ÿå¯ä»¥ç”±ç”¨æˆ·ä¸»æœºè´Ÿè´£</strong></td><td><strong>ç”±ç”¨æˆ·ä¸»æœºè´Ÿè´£</strong></td></tr></tbody></table><hr><h3 id="4-3ã€IPv4"><a href="#4-3ã€IPv4" class="headerlink" title="4.3ã€IPv4"></a>4.3ã€IPv4</h3><h4 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-90e2d995adf53e57.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1199/format/webp" alt="img"></p><h4 id="åˆ†ç±»ç¼–åˆ¶çš„IPv4åœ°å€"><a href="#åˆ†ç±»ç¼–åˆ¶çš„IPv4åœ°å€" class="headerlink" title="åˆ†ç±»ç¼–åˆ¶çš„IPv4åœ°å€"></a>åˆ†ç±»ç¼–åˆ¶çš„IPv4åœ°å€</h4><h5 id="ç®€ä»‹-1"><a href="#ç®€ä»‹-1" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-617a75508f564e07.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><ul><li>æ¯ä¸€ç±»åœ°å€éƒ½ç”±ä¸¤ä¸ªå›ºå®šé•¿åº¦çš„å­—æ®µç»„æˆï¼Œå…¶ä¸­ä¸€ä¸ªå­—æ®µæ˜¯<strong>ç½‘ç»œå· net-id</strong>ï¼Œå®ƒæ ‡å¿—ä¸»æœºï¼ˆæˆ–è·¯ç”±å™¨ï¼‰æ‰€è¿æ¥åˆ°çš„ç½‘ç»œï¼Œè€Œå¦ä¸€ä¸ªå­—æ®µåˆ™æ˜¯<strong>ä¸»æœºå· host-id</strong>ï¼Œå®ƒæ ‡å¿—è¯¥ä¸»æœºï¼ˆæˆ–è·¯ç”±å™¨ï¼‰ã€‚</li><li>ä¸»æœºå·åœ¨å®ƒå‰é¢çš„ç½‘ç»œå·æ‰€æŒ‡æ˜çš„ç½‘ç»œèŒƒå›´å†…å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚</li><li>ç”±æ­¤å¯è§ï¼Œ<strong>ä¸€ä¸ª IP åœ°å€åœ¨æ•´ä¸ªäº’è”ç½‘èŒƒå›´å†…æ˜¯å”¯ä¸€çš„</strong>ã€‚</li></ul><p><strong>Aç±»åœ°å€</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-eacc61b12148d0fe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>Bç±»åœ°å€</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-3e51c8657163a587.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>Cç±»åœ°å€</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-82018abf428effc4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>ç»ƒä¹ </strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-c1a55b79b312df0a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h5 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h5><p><strong>IP åœ°å€çš„æŒ‡æ´¾èŒƒå›´</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-0fd510a88683ce19.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/881/format/webp" alt="img"></p><p><strong>ä¸€èˆ¬ä¸ä½¿ç”¨çš„ç‰¹æ®Šçš„ IP åœ°å€</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6ac646caef2b89d6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/882/format/webp" alt="img"></p><p><strong>IP åœ°å€çš„ä¸€äº›é‡è¦ç‰¹ç‚¹</strong></p><p>(1) <strong>IP åœ°å€æ˜¯ä¸€ç§åˆ†ç­‰çº§çš„åœ°å€ç»“æ„</strong>ã€‚åˆ†ä¸¤ä¸ªç­‰çº§çš„å¥½å¤„æ˜¯ï¼š</p><ul><li><strong>ç¬¬ä¸€</strong>ï¼ŒIP åœ°å€ç®¡ç†æœºæ„åœ¨åˆ†é… IP åœ°å€æ—¶åªåˆ†é…ç½‘ç»œå·ï¼Œè€Œå‰©ä¸‹çš„ä¸»æœºå·åˆ™ç”±å¾—åˆ°è¯¥ç½‘ç»œå·çš„å•ä½è‡ªè¡Œåˆ†é…ã€‚è¿™æ ·å°±æ–¹ä¾¿äº† IP åœ°å€çš„ç®¡ç†ã€‚</li><li><strong>ç¬¬äºŒ</strong>ï¼Œè·¯ç”±å™¨ä»…æ ¹æ®ç›®çš„ä¸»æœºæ‰€è¿æ¥çš„ç½‘ç»œå·æ¥è½¬å‘åˆ†ç»„ï¼ˆè€Œä¸è€ƒè™‘ç›®çš„ä¸»æœºå·ï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿è·¯ç”±è¡¨ä¸­çš„é¡¹ç›®æ•°å¤§å¹…åº¦å‡å°‘ï¼Œä»è€Œå‡å°äº†è·¯ç”±è¡¨æ‰€å çš„å­˜å‚¨ç©ºé—´ã€‚</li></ul><p>(2) <strong>å®é™…ä¸Š IP åœ°å€æ˜¯æ ‡å¿—ä¸€ä¸ªä¸»æœºï¼ˆæˆ–è·¯ç”±å™¨ï¼‰å’Œä¸€æ¡é“¾è·¯çš„æ¥å£</strong>ã€‚</p><ul><li>å½“ä¸€ä¸ªä¸»æœºåŒæ—¶è¿æ¥åˆ°ä¸¤ä¸ªç½‘ç»œä¸Šæ—¶ï¼Œè¯¥ä¸»æœºå°±å¿…é¡»åŒæ—¶å…·æœ‰ä¸¤ä¸ªç›¸åº”çš„ IP åœ°å€ï¼Œå…¶ç½‘ç»œå· net-id å¿…é¡»æ˜¯ä¸åŒçš„ã€‚è¿™ç§ä¸»æœºç§°ä¸º<strong>å¤šå½’å±ä¸»æœº</strong> (multihomed host)ã€‚</li><li>ç”±äºä¸€ä¸ªè·¯ç”±å™¨è‡³å°‘åº”å½“è¿æ¥åˆ°ä¸¤ä¸ªç½‘ç»œï¼ˆè¿™æ ·å®ƒæ‰èƒ½å°† IP æ•°æ®æŠ¥ä»ä¸€ä¸ªç½‘ç»œè½¬å‘åˆ°å¦ä¸€ä¸ªç½‘ç»œï¼‰ï¼Œå› æ­¤<strong>ä¸€ä¸ªè·¯ç”±å™¨è‡³å°‘åº”å½“æœ‰ä¸¤ä¸ªä¸åŒçš„ IP åœ°å€</strong>ã€‚</li></ul><p>(3) <strong>ç”¨è½¬å‘å™¨æˆ–ç½‘æ¡¥è¿æ¥èµ·æ¥çš„è‹¥å¹²ä¸ªå±€åŸŸç½‘ä»ä¸ºä¸€ä¸ªç½‘ç»œ</strong>ï¼Œå› æ­¤è¿™äº›å±€åŸŸç½‘éƒ½å…·æœ‰åŒæ ·çš„ç½‘ç»œå· net-idã€‚</p><p>(4) <strong>æ‰€æœ‰åˆ†é…åˆ°ç½‘ç»œå· net-id çš„ç½‘ç»œï¼Œæ— è®ºæ˜¯èŒƒå›´å¾ˆå°çš„å±€åŸŸç½‘ï¼Œè¿˜æ˜¯å¯èƒ½è¦†ç›–å¾ˆå¤§åœ°ç†èŒƒå›´çš„å¹¿åŸŸç½‘ï¼Œéƒ½æ˜¯å¹³ç­‰çš„ã€‚</strong></p><h4 id="åˆ’åˆ†å­ç½‘çš„IPv4åœ°å€"><a href="#åˆ’åˆ†å­ç½‘çš„IPv4åœ°å€" class="headerlink" title="åˆ’åˆ†å­ç½‘çš„IPv4åœ°å€"></a>åˆ’åˆ†å­ç½‘çš„IPv4åœ°å€</h4><h5 id="ä¸ºä»€ä¹ˆè¦åˆ’åˆ†å­ç½‘"><a href="#ä¸ºä»€ä¹ˆè¦åˆ’åˆ†å­ç½‘" class="headerlink" title="ä¸ºä»€ä¹ˆè¦åˆ’åˆ†å­ç½‘"></a>ä¸ºä»€ä¹ˆè¦åˆ’åˆ†å­ç½‘</h5><p>åœ¨ ARPANET çš„æ—©æœŸï¼ŒIP åœ°å€çš„è®¾è®¡ç¡®å®ä¸å¤Ÿåˆç†ï¼š</p><ul><li>IP åœ°å€ç©ºé—´çš„åˆ©ç”¨ç‡æœ‰æ—¶å¾ˆä½ã€‚</li><li>ç»™æ¯ä¸€ä¸ªç‰©ç†ç½‘ç»œåˆ†é…ä¸€ä¸ªç½‘ç»œå·ä¼šä½¿è·¯ç”±è¡¨å˜å¾—å¤ªå¤§å› è€Œä½¿ç½‘ç»œæ€§èƒ½å˜åã€‚</li><li>ä¸¤çº§çš„ IP åœ°å€ä¸å¤Ÿçµæ´»ã€‚</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-7e6aa3fe4c6184e4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>å¦‚æœæƒ³è¦å°†åŸæ¥çš„ç½‘ç»œåˆ’åˆ†æˆä¸‰ä¸ªç‹¬ç«‹çš„ç½‘è·¯</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-9c21430ca1484519.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>æ‰€ä»¥æ˜¯å¦å¯ä»¥ä»ä¸»æœºå·éƒ¨åˆ†å€Ÿç”¨ä¸€éƒ¨åˆ†ä½œä¸ºå­ç½‘å·</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-5925336afb4dfe54.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä½†æ˜¯å¦‚æœæœªåœ¨å›¾ä¸­æ ‡è®°å­ç½‘å·éƒ¨åˆ†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å’Œè®¡ç®—æœºåˆå¦‚ä½•çŸ¥é“åˆ†ç±»åœ°å€ä¸­ä¸»æœºå·æœ‰å¤šå°‘æ¯”ç‰¹è¢«ç”¨ä½œå­ç½‘å·äº†å‘¢ï¼Ÿ</p><p>æ‰€ä»¥å°±æœ‰äº†åˆ’åˆ†å­ç½‘çš„å·¥å…·ï¼š<strong>å­ç½‘æ©ç </strong></p><ul><li><p>ä» 1985 å¹´èµ·åœ¨ IP åœ°å€ä¸­åˆå¢åŠ äº†ä¸€ä¸ªâ€œ<strong>å­ç½‘å·å­—æ®µ</strong>â€ï¼Œä½¿ä¸¤çº§çš„ IP åœ°å€å˜æˆä¸º<strong>ä¸‰çº§çš„ IP åœ°å€</strong>ã€‚</p></li><li><p>è¿™ç§åšæ³•å«åš<strong>åˆ’åˆ†å­ç½‘</strong> (subnetting) ã€‚</p></li><li><p>åˆ’åˆ†å­ç½‘å·²æˆä¸ºäº’è”ç½‘çš„æ­£å¼æ ‡å‡†åè®®ã€‚</p></li></ul></blockquote><h5 id="å¦‚ä½•åˆ’åˆ†å­ç½‘"><a href="#å¦‚ä½•åˆ’åˆ†å­ç½‘" class="headerlink" title="å¦‚ä½•åˆ’åˆ†å­ç½‘"></a>å¦‚ä½•åˆ’åˆ†å­ç½‘</h5><p>åŸºæœ¬æ€è·¯</p><ul><li>åˆ’åˆ†å­ç½‘çº¯å±ä¸€ä¸ª<strong>å•ä½å†…éƒ¨çš„äº‹æƒ…</strong>ã€‚å•ä½å¯¹å¤–ä»ç„¶è¡¨ç°ä¸ºæ²¡æœ‰åˆ’åˆ†å­ç½‘çš„ç½‘ç»œã€‚</li><li>ä»ä¸»æœºå·<strong>å€Ÿç”¨</strong>è‹¥å¹²ä¸ªä½ä½œä¸º<strong>å­ç½‘å·</strong> subnet-idï¼Œè€Œä¸»æœºå· host-id ä¹Ÿå°±ç›¸åº”å‡å°‘äº†è‹¥å¹²ä¸ªä½ã€‚</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-5006c8be601f1a11.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/545/format/webp" alt="img"></p><ul><li>å‡¡æ˜¯ä»å…¶ä»–ç½‘ç»œå‘é€ç»™æœ¬å•ä½æŸä¸ªä¸»æœºçš„ IP æ•°æ®æŠ¥ï¼Œä»ç„¶æ˜¯æ ¹æ® IP æ•°æ®æŠ¥çš„<strong>ç›®çš„ç½‘ç»œå·</strong> net-idï¼Œå…ˆæ‰¾åˆ°è¿æ¥åœ¨æœ¬å•ä½ç½‘ç»œä¸Šçš„è·¯ç”±å™¨ã€‚</li><li>ç„¶å<strong>æ­¤è·¯ç”±å™¨</strong>åœ¨æ”¶åˆ° IP æ•°æ®æŠ¥åï¼Œå†æŒ‰<strong>ç›®çš„ç½‘ç»œå·</strong> net-id å’Œ<strong>å­ç½‘å·</strong> subnet-id æ‰¾åˆ°ç›®çš„å­ç½‘ã€‚</li><li>æœ€åå°±å°† IP æ•°æ®æŠ¥ç›´æ¥äº¤ä»˜ç›®çš„ä¸»æœºã€‚</li></ul><p>åˆ’åˆ†ä¸ºä¸‰ä¸ªå­ç½‘åå¯¹å¤–ä»æ˜¯ä¸€ä¸ªç½‘ç»œ</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-5eaab61ca2770932.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/773/format/webp" alt="img"></p><blockquote><ul><li><strong>ä¼˜ç‚¹</strong></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.  å‡å°‘äº† IP åœ°å€çš„æµªè´¹</span><br><span class="line">2.  ä½¿ç½‘ç»œçš„ç»„ç»‡æ›´åŠ çµæ´»</span><br><span class="line">3.  æ›´ä¾¿äºç»´æŠ¤å’Œç®¡ç†</span><br></pre></td></tr></table></figure><ul><li><strong>åˆ’åˆ†å­ç½‘çº¯å±ä¸€ä¸ªå•ä½å†…éƒ¨çš„äº‹æƒ…ï¼Œå¯¹å¤–éƒ¨ç½‘ç»œé€æ˜</strong>ï¼Œå¯¹å¤–ä»ç„¶è¡¨ç°ä¸ºæ²¡æœ‰åˆ’åˆ†å­ç½‘çš„ä¸€ä¸ªç½‘ç»œã€‚</li></ul></blockquote><h5 id="å­ç½‘æ©ç "><a href="#å­ç½‘æ©ç " class="headerlink" title="å­ç½‘æ©ç "></a>å­ç½‘æ©ç </h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-0050159cd99737aa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p><strong>(IP åœ°å€) AND (å­ç½‘æ©ç ) &#x3D; ç½‘ç»œåœ°å€</strong> é‡è¦ï¼Œä¸‹é¢å¾ˆå¤šç›¸å…³çŸ¥è¯†éƒ½ä¼šç”¨åˆ°</p></blockquote><p>ä¸¾ä¾‹</p><p>ä¾‹å­1</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-24fc0f5e02ad49ab.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/969/format/webp" alt="img"></p><p>ä¾‹å­2</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-4e988e8ed1e154e3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>é»˜è®¤å­ç½‘æ©ç </strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-5e9d1b71bd598e62.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h5 id="æ€»ç»“-2"><a href="#æ€»ç»“-2" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-143b8b8433293353.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><ul><li><p>å­ç½‘æ©ç æ˜¯ä¸€ä¸ªç½‘ç»œæˆ–ä¸€ä¸ªå­ç½‘çš„é‡è¦å±æ€§ã€‚</p></li><li><p>è·¯ç”±å™¨åœ¨å’Œç›¸é‚»è·¯ç”±å™¨äº¤æ¢è·¯ç”±ä¿¡æ¯æ—¶ï¼Œå¿…é¡»æŠŠè‡ªå·±æ‰€åœ¨ç½‘ç»œï¼ˆæˆ–å­ç½‘ï¼‰çš„å­ç½‘æ©ç å‘Šè¯‰ç›¸é‚»è·¯ç”±å™¨ã€‚</p></li><li><p>è·¯ç”±å™¨çš„è·¯ç”±è¡¨ä¸­çš„æ¯ä¸€ä¸ªé¡¹ç›®ï¼Œé™¤äº†è¦ç»™å‡ºç›®çš„ç½‘ç»œåœ°å€å¤–ï¼Œè¿˜å¿…é¡»åŒæ—¶ç»™å‡ºè¯¥ç½‘ç»œçš„å­ç½‘æ©ç ã€‚</p></li><li><p>è‹¥ä¸€ä¸ªè·¯ç”±å™¨è¿æ¥åœ¨ä¸¤ä¸ªå­ç½‘ä¸Šï¼Œå°±æ‹¥æœ‰ä¸¤ä¸ªç½‘ç»œåœ°å€å’Œä¸¤ä¸ªå­ç½‘æ©ç ã€‚</p></li></ul></blockquote><h4 id="æ— åˆ†ç±»ç¼–å€çš„IPv4åœ°å€"><a href="#æ— åˆ†ç±»ç¼–å€çš„IPv4åœ°å€" class="headerlink" title="æ— åˆ†ç±»ç¼–å€çš„IPv4åœ°å€"></a>æ— åˆ†ç±»ç¼–å€çš„IPv4åœ°å€</h4><h5 id="ä¸ºä»€ä¹ˆä½¿ç”¨æ— åˆ†ç±»ç¼–å€"><a href="#ä¸ºä»€ä¹ˆä½¿ç”¨æ— åˆ†ç±»ç¼–å€" class="headerlink" title="ä¸ºä»€ä¹ˆä½¿ç”¨æ— åˆ†ç±»ç¼–å€"></a>ä¸ºä»€ä¹ˆä½¿ç”¨æ— åˆ†ç±»ç¼–å€</h5><p><strong>æ— åˆ†ç±»åŸŸé—´è·¯ç”±é€‰æ‹© CIDR</strong> (Classless Inter-Domain Routing)ã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-dc335c4f88cede6c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p><strong>CIDR æœ€ä¸»è¦çš„ç‰¹ç‚¹</strong></p><ul><li><p>CIDRä½¿ç”¨å„ç§é•¿åº¦çš„â€œ<strong>ç½‘ç»œå‰ç¼€</strong>â€(network-prefix)æ¥ä»£æ›¿åˆ†ç±»åœ°å€ä¸­çš„ç½‘ç»œå·å’Œå­ç½‘å·ã€‚</p></li><li><p><strong>IP åœ°å€ä»ä¸‰çº§ç¼–å€ï¼ˆä½¿ç”¨å­ç½‘æ©ç ï¼‰åˆå›åˆ°äº†ä¸¤çº§ç¼–å€</strong>ã€‚</p></li></ul></blockquote><h5 id="å¦‚ä½•ä½¿ç”¨æ— åˆ†ç±»ç¼–å€"><a href="#å¦‚ä½•ä½¿ç”¨æ— åˆ†ç±»ç¼–å€" class="headerlink" title="å¦‚ä½•ä½¿ç”¨æ— åˆ†ç±»ç¼–å€"></a>å¦‚ä½•ä½¿ç”¨æ— åˆ†ç±»ç¼–å€</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-88843ec1d5739f3c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>ä¸¾ä¾‹</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-bdff407b4d15ec43.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h5 id="è·¯ç”±èšåˆï¼ˆæ„é€ è¶…ç½‘ï¼‰"><a href="#è·¯ç”±èšåˆï¼ˆæ„é€ è¶…ç½‘ï¼‰" class="headerlink" title="è·¯ç”±èšåˆï¼ˆæ„é€ è¶…ç½‘ï¼‰"></a>è·¯ç”±èšåˆï¼ˆæ„é€ è¶…ç½‘ï¼‰</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-a495310e8e5bc13a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h5 id="æ€»ç»“-3"><a href="#æ€»ç»“-3" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-38c44dc0521cfc1b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1181/format/webp" alt="img"></p><h4 id="IPv4åœ°å€çš„åº”ç”¨è§„åˆ’"><a href="#IPv4åœ°å€çš„åº”ç”¨è§„åˆ’" class="headerlink" title="IPv4åœ°å€çš„åº”ç”¨è§„åˆ’"></a>IPv4åœ°å€çš„åº”ç”¨è§„åˆ’</h4><p>ç»™å®šä¸€ä¸ªIPv4åœ°å€å—ï¼Œå¦‚ä½•å°†å…¶åˆ’åˆ†æˆå‡ ä¸ªæ›´å°çš„åœ°å€å—ï¼Œå¹¶å°†è¿™äº›åœ°å€å—åˆ†é…ç»™äº’è”ç½‘ä¸­ä¸åŒç½‘ç»œï¼Œè¿›è€Œå¯ä»¥ç»™å„ç½‘ç»œä¸­çš„ä¸»æœºå’Œè·¯ç”±å™¨æ¥å£åˆ†é…IPv4åœ°å€</p><h5 id="å®šé•¿çš„å­ç½‘æ©ç FLSMï¼ˆFixed-Length-Subnet-Maskï¼‰"><a href="#å®šé•¿çš„å­ç½‘æ©ç FLSMï¼ˆFixed-Length-Subnet-Maskï¼‰" class="headerlink" title="å®šé•¿çš„å­ç½‘æ©ç FLSMï¼ˆFixed Length Subnet Maskï¼‰"></a>å®šé•¿çš„å­ç½‘æ©ç FLSMï¼ˆFixed Length Subnet Maskï¼‰</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-097ed78c469f6c87.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/882/format/webp" alt="img"></p><p><strong>åˆ’åˆ†å­ç½‘çš„IPv4å°±æ˜¯å®šé•¿çš„å­ç½‘æ©ç </strong></p><p>ä¸¾ä¾‹</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-814f06bb5874b724.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-a90a636c0ff5f71c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1156/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-da16abd19e811578.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1146/format/webp" alt="img"></p><blockquote><p>é€šè¿‡ä¸Šé¢æ­¥éª¤åˆ†æï¼Œå°±å¯ä»¥ä»å­ç½‘1 ~ 8ä¸­ä»»é€‰5ä¸ªåˆ†é…ç»™å·¦å›¾ä¸­çš„N1 ~ N5</p><p><strong>é‡‡ç”¨å®šé•¿çš„å­ç½‘æ©ç åˆ’åˆ†ï¼Œåªèƒ½åˆ’åˆ†å‡º2^nä¸ªå­ç½‘ï¼Œå…¶ä¸­næ˜¯ä»ä¸»æœºå·éƒ¨åˆ†å€Ÿç”¨çš„ç”¨æ¥ä½œä¸ºå­ç½‘å·çš„æ¯”ç‰¹æ•°é‡ï¼Œæ¯ä¸ªå­ç½‘æ‰€åˆ†é…çš„IPåœ°å€æ•°é‡ç›¸åŒ</strong></p><p><strong>ä½†æ˜¯ä¹Ÿå› ä¸ºæ¯ä¸ªå­ç½‘æ‰€åˆ†é…çš„IPåœ°å€æ•°é‡ç›¸åŒï¼Œä¸å¤Ÿçµæ´»ï¼Œå®¹æ˜“é€ æˆIPåœ°å€çš„æµªè´¹</strong></p></blockquote><h5 id="å˜é•¿çš„å­ç½‘æ©ç VLSMï¼ˆVariable-Length-Subnet-Maskï¼‰"><a href="#å˜é•¿çš„å­ç½‘æ©ç VLSMï¼ˆVariable-Length-Subnet-Maskï¼‰" class="headerlink" title="å˜é•¿çš„å­ç½‘æ©ç VLSMï¼ˆVariable Length Subnet Maskï¼‰"></a>å˜é•¿çš„å­ç½‘æ©ç VLSMï¼ˆVariable Length Subnet Maskï¼‰</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-2c1bfb1250975630.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/874/format/webp" alt="img"></p><p><strong>æ— åˆ†ç±»ç¼–å€çš„IPv4å°±æ˜¯å˜é•¿çš„å­ç½‘æ©ç </strong></p><p>ä¸¾ä¾‹</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-e7a3b3efa0032ed5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-b855ffbf02fe4306.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><hr><h3 id="4-4ã€IPæ•°æ®æŠ¥çš„å‘é€å’Œè½¬å‘è¿‡ç¨‹"><a href="#4-4ã€IPæ•°æ®æŠ¥çš„å‘é€å’Œè½¬å‘è¿‡ç¨‹" class="headerlink" title="4.4ã€IPæ•°æ®æŠ¥çš„å‘é€å’Œè½¬å‘è¿‡ç¨‹"></a>4.4ã€IPæ•°æ®æŠ¥çš„å‘é€å’Œè½¬å‘è¿‡ç¨‹</h3><p><img src="https://upload-images.jianshu.io/upload_images/24878825-591d4b10e724a0c2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>ä¸¾ä¾‹</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-cb603ff4350d2927.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6017dc6fd05d7dc3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>æºä¸»æœºå¦‚ä½•çŸ¥é“ç›®çš„ä¸»æœºæ˜¯å¦ä¸è‡ªå·±åœ¨åŒä¸€ä¸ªç½‘ç»œä¸­ï¼Œæ˜¯ç›´æ¥äº¤ä»˜ï¼Œè¿˜æ˜¯é—´æ¥äº¤ä»˜ï¼Ÿ</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-1350e20953ab73c3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>å¯ä»¥é€šè¿‡**<code>ç›®çš„åœ°å€IP</code><strong>å’Œ</strong><code>æºåœ°å€çš„å­ç½‘æ©ç </code><strong>è¿›è¡Œ</strong>é€»è¾‘ä¸è¿ç®—<strong>å¾—åˆ°</strong>ç›®çš„ç½‘ç»œåœ°å€**</p><ul><li><p>å¦‚æœ<strong>ç›®çš„ç½‘ç»œåœ°å€</strong>å’Œ<strong>æºç½‘ç»œåœ°å€</strong>  <strong>ç›¸åŒ</strong>ï¼Œå°±æ˜¯**<code>åœ¨åŒä¸€ä¸ªç½‘ç»œ</code><strong>ä¸­ï¼Œå±äº</strong><code>ç›´æ¥äº¤ä»˜</code>**</p></li><li><p>å¦‚æœ<strong>ç›®çš„ç½‘ç»œåœ°å€</strong>å’Œ<strong>æºç½‘ç»œåœ°å€</strong>  <strong>ä¸ç›¸åŒ</strong>ï¼Œå°±**<code>ä¸åœ¨åŒä¸€ä¸ªç½‘ç»œ</code><strong>ä¸­ï¼Œå±äº</strong><code>é—´æ¥äº¤ä»˜</code><strong>ï¼Œä¼ è¾“ç»™ä¸»æœºæ‰€åœ¨ç½‘ç»œçš„</strong>é»˜è®¤ç½‘å…³**ï¼ˆè·¯ç”±å™¨â€”â€”ä¸‹å›¾ä¼šè®²è§£ï¼‰,ç”±é»˜è®¤ç½‘å…³å¸®å¿™è½¬å‘</p></li></ul></blockquote><p>ä¸»æœºCå¦‚ä½•çŸ¥é“è·¯ç”±å™¨Rçš„å­˜åœ¨ï¼Ÿ</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-5f7abd26ae50d253.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ç”¨æˆ·ä¸ºäº†è®©æœ¬ç½‘ç»œä¸­çš„ä¸»æœºèƒ½å’Œå…¶ä»–ç½‘ç»œä¸­çš„ä¸»æœºè¿›è¡Œé€šä¿¡ï¼Œå°±å¿…é¡»ç»™å…¶æŒ‡å®šæœ¬ç½‘ç»œçš„ä¸€ä¸ªè·¯ç”±å™¨çš„æ¥å£ï¼Œç”±è¯¥è·¯ç”±å™¨å¸®å¿™è¿›è¡Œè½¬å‘ï¼Œæ‰€æŒ‡å®šçš„è·¯ç”±å™¨ï¼Œä¹Ÿè¢«ç§°ä¸º<strong>é»˜è®¤ç½‘å…³</strong></p><p>ä¾‹å¦‚ã€‚è·¯ç”±å™¨çš„æ¥å£0çš„IPåœ°å€192.168.0.128åšä¸ºå·¦è¾¹ç½‘ç»œçš„é»˜è®¤ç½‘å…³</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-0351946f5505b37a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä¸»æœºAä¼šå°†è¯¥IPæ•°æ®æŠ¥ä¼ è¾“ç»™è‡ªå·±çš„é»˜è®¤ç½‘å…³ï¼Œä¹Ÿå°±æ˜¯å›¾ä¸­æ‰€ç¤ºçš„è·¯ç”±å™¨æ¥å£0</p></blockquote><p>è·¯ç”±å™¨æ”¶åˆ°IPæ•°æ®æŠ¥åå¦‚ä½•è½¬å‘ï¼Ÿ</p><ul><li>æ£€æŸ¥IPæ•°æ®æŠ¥é¦–éƒ¨æ˜¯å¦å‡ºé”™ï¼š<ul><li>è‹¥å‡ºé”™ï¼Œåˆ™ç›´æ¥ä¸¢å¼ƒè¯¥IPæ•°æ®æŠ¥å¹¶é€šå‘Šæºä¸»æœº</li><li>è‹¥æ²¡æœ‰å‡ºé”™ï¼Œåˆ™è¿›è¡Œè½¬å‘</li></ul></li><li>æ ¹æ®IPæ•°æ®æŠ¥çš„ç›®çš„åœ°å€åœ¨è·¯ç”±è¡¨ä¸­æŸ¥æ‰¾åŒ¹é…çš„æ¡ç›®ï¼š<ul><li>è‹¥æ‰¾åˆ°åŒ¹é…çš„æ¡ç›®ï¼Œåˆ™è½¬å‘ç»™æ¡ç›®ä¸­æŒ‡ç¤ºçš„å“ä¸€è·³</li><li>è‹¥æ‰¾ä¸åˆ°ï¼Œåˆ™ä¸¢å¼ƒè¯¥æ•°æ®æŠ¥å¹¶é€šå‘Šæºä¸»æœº</li></ul></li></ul><p>å‡è®¾IPæ•°æ®æŠ¥é¦–éƒ¨æ²¡æœ‰å‡ºé”™ï¼Œè·¯ç”±å™¨å–å‡ºIPæ•°æ®æŠ¥é¦–éƒ¨å„åœ°å€å­—æ®µçš„å€¼</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-09e48a4a2debf9dd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>æ¥ä¸‹æ¥è·¯ç”±å™¨å¯¹è¯¥IPæ•°æ®æŠ¥è¿›è¡ŒæŸ¥è¡¨è½¬å‘</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6ec850736125c7f6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>é€æ¡æ£€æŸ¥è·¯ç”±æ¡ç›®ï¼Œå°†<code>ç›®çš„åœ°å€</code>ä¸<code>è·¯ç”±æ¡ç›®ä¸­çš„åœ°å€æ©ç </code>è¿›è¡Œé€»è¾‘ä¸è¿ç®—å¾—åˆ°<code>ç›®çš„ç½‘ç»œåœ°å€</code>ï¼Œç„¶åä¸è·¯ç”±æ¡ç›®ä¸­çš„ç›®çš„ç½‘ç»œè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç›¸åŒï¼Œåˆ™è¿™æ¡è·¯ç”±æ¡ç›®å°±æ˜¯åŒ¹é…çš„è·¯ç”±æ¡ç›®ï¼ŒæŒ‰ç…§å®ƒçš„ä¸‹ä¸€æ¡æŒ‡ç¤ºï¼Œå›¾ä¸­æ‰€ç¤ºçš„ä¹Ÿå°±æ˜¯æ¥å£1è½¬å‘è¯¥IPæ•°æ®æŠ¥</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-4ff7f2294cf39cef.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>è·¯ç”±å™¨æ˜¯éš”ç¦»å¹¿æ’­åŸŸçš„</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f38fdc3eb91af37f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><hr><h3 id="4-5ã€é™æ€è·¯ç”±é…ç½®åŠå…¶å¯èƒ½äº§ç”Ÿçš„è·¯ç”±ç¯è·¯é—®é¢˜"><a href="#4-5ã€é™æ€è·¯ç”±é…ç½®åŠå…¶å¯èƒ½äº§ç”Ÿçš„è·¯ç”±ç¯è·¯é—®é¢˜" class="headerlink" title="4.5ã€é™æ€è·¯ç”±é…ç½®åŠå…¶å¯èƒ½äº§ç”Ÿçš„è·¯ç”±ç¯è·¯é—®é¢˜"></a>4.5ã€é™æ€è·¯ç”±é…ç½®åŠå…¶å¯èƒ½äº§ç”Ÿçš„è·¯ç”±ç¯è·¯é—®é¢˜</h3><h4 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-cf80167248b787a0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="å¤šç§æƒ…å†µä¸¾ä¾‹"><a href="#å¤šç§æƒ…å†µä¸¾ä¾‹" class="headerlink" title="å¤šç§æƒ…å†µä¸¾ä¾‹"></a>å¤šç§æƒ…å†µä¸¾ä¾‹</h4><p><strong>é™æ€è·¯ç”±é…ç½®</strong></p><p>ä¸¾ä¾‹</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-214e6a6830649edd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>é»˜è®¤è·¯ç”±</strong></p><p>ä¸¾ä¾‹</p><p>é»˜è®¤è·¯ç”±å¯ä»¥è¢«æ‰€æœ‰ç½‘ç»œåŒ¹é…ï¼Œä½†è·¯ç”±åŒ¹é…æœ‰ä¼˜å…ˆçº§ï¼Œé»˜è®¤è·¯ç”±æ˜¯ä¼˜å…ˆçº§æœ€ä½çš„</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-8887ba23edaae006.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>ç‰¹å®šä¸»æœºè·¯ç”±</strong></p><p>ä¸¾ä¾‹</p><p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ç»™è·¯ç”±å™¨æ·»åŠ é’ˆå¯¹æŸä¸ªä¸»æœºçš„ç‰¹å®šä¸»æœºè·¯ç”±æ¡ç›®</p><p>ä¸€èˆ¬ç”¨äºç½‘ç»œç®¡ç†äººå‘˜å¯¹ç½‘ç»œçš„ç®¡ç†å’Œæµ‹è¯•</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-434c1eec83abd86f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>å¤šæ¡è·¯ç”±å¯é€‰ï¼ŒåŒ¹é…è·¯ç”±æœ€å…·ä½“çš„</p></blockquote><p><strong>é™æ€è·¯ç”±é…ç½®é”™è¯¯å¯¼è‡´è·¯ç”±ç¯è·¯</strong></p><p>ä¸¾ä¾‹</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-8b1a3cadc08a931f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>å‡è®¾å°†R2çš„è·¯ç”±è¡¨ä¸­ç¬¬ä¸‰æ¡ç›®å½•é…ç½®é”™äº†ä¸‹ä¸€è·³</p><p>è¿™å¯¼è‡´R2å’ŒR3ä¹‹é—´äº§ç”Ÿäº†è·¯ç”±ç¯è·¯</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d30fc31c76fe75b2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>èšåˆäº†ä¸å­˜åœ¨çš„ç½‘ç»œè€Œå¯¼è‡´è·¯ç”±ç¯è·¯</strong></p><p>ä¸¾ä¾‹</p><p>æ­£å¸¸æƒ…å†µ</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-9e22a85322dfb654.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-56bce2f676ef8d09.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>é”™è¯¯æƒ…å†µ</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-030c93bce1443043.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>è§£å†³æ–¹æ³•</p><blockquote><p>æ·»åŠ é»‘æ´è·¯ç”±</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-caeddc52bde20f9c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d91cb3837cfc2b6f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>é»‘æ´è·¯ç”±çš„ä¸‹ä¸€è·³ä¸ºnull0ï¼Œè¿™æ˜¯è·¯ç”±å™¨å†…éƒ¨çš„è™šæ‹Ÿæ¥å£ï¼ŒIPæ•°æ®æŠ¥è¿›å…¥å®ƒåå°±è¢«ä¸¢å¼ƒ</p></blockquote><p><strong>ç½‘ç»œæ•…éšœè€Œå¯¼è‡´è·¯ç”±ç¯è·¯</strong></p><p>ä¸¾ä¾‹</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-e3848e2bfcfc2c62.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-99cc1b342b3f645f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>è§£å†³æ–¹æ³•</p><p>æ·»åŠ æ•…éšœçš„ç½‘ç»œä¸ºé»‘æ´è·¯ç”±</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-0c30655d3122a50d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d8107f8fc71dd1f4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>å‡è®¾ã€‚ä¸€æ®µæ—¶é—´åæ•…éšœç½‘ç»œæ¢å¤äº†</p><p>R1åˆè‡ªåŠ¨åœ°å¾—å‡ºäº†å…¶æ¥å£0çš„ç›´è¿ç½‘ç»œçš„è·¯ç”±æ¡ç›®</p><p>é’ˆå¯¹è¯¥ç½‘ç»œçš„é»‘æ´ç½‘ç»œä¼šè‡ªåŠ¨å¤±æ•ˆ</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-3f60a84d11d15f41.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>å¦‚æœåˆæ•…éšœ</p><p>åˆ™ç”Ÿæ•ˆè¯¥ç½‘ç»œçš„é»‘æ´ç½‘ç»œ</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-dfe2cfdcdd6af09e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="æ€»ç»“-4"><a href="#æ€»ç»“-4" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-3bc2906b99f6940d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><hr><h3 id="4-6ã€è·¯ç”±é€‰æ‹©åè®®"><a href="#4-6ã€è·¯ç”±é€‰æ‹©åè®®" class="headerlink" title="4.6ã€è·¯ç”±é€‰æ‹©åè®®"></a>4.6ã€è·¯ç”±é€‰æ‹©åè®®</h3><h4 id="æ¦‚è¿°-1"><a href="#æ¦‚è¿°-1" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-a6ddde977e3398ad.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>å› ç‰¹ç½‘æ‰€é‡‡ç”¨çš„è·¯ç”±é€‰æ‹©åè®®çš„ä¸»è¦ç‰¹ç‚¹</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-b3382290a3965ffc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>å› ç‰¹ç½‘é‡‡ç”¨åˆ†å±‚æ¬¡çš„è·¯ç”±é€‰æ‹©åè®®</strong></p><ul><li><strong>è‡ªæ²»ç³»ç»Ÿ AS</strong>ï¼šåœ¨å•ä¸€çš„æŠ€æœ¯ç®¡ç†ä¸‹çš„ä¸€ç»„è·¯ç”±å™¨ï¼Œè€Œè¿™äº›è·¯ç”±å™¨ä½¿ç”¨ä¸€ç§ AS å†…éƒ¨çš„è·¯ç”±é€‰æ‹©åè®®å’Œå…±åŒçš„åº¦é‡ä»¥ç¡®å®šåˆ†ç»„åœ¨è¯¥ AS å†…çš„è·¯ç”±ï¼ŒåŒæ—¶è¿˜ä½¿ç”¨ä¸€ç§ AS ä¹‹é—´çš„è·¯ç”±é€‰æ‹©åè®®ç”¨ä»¥ç¡®å®šåˆ†ç»„åœ¨ ASä¹‹é—´çš„è·¯ç”±ã€‚</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-9e37d1229ec7836e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>è‡ªæ²»ç³»ç»Ÿä¹‹é—´çš„è·¯ç”±é€‰æ‹©ç®€ç§°ä¸ºåŸŸé—´è·¯ç”±é€‰æ‹©ï¼Œè‡ªæ²»ç³»ç»Ÿå†…éƒ¨çš„è·¯ç”±é€‰æ‹©ç®€ç§°ä¸ºåŸŸå†…è·¯ç”±é€‰æ‹©</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-8729bdd2bd367edf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>åŸŸé—´è·¯ç”±é€‰æ‹©ä½¿ç”¨å¤–éƒ¨ç½‘å…³åè®®EGPè¿™ä¸ªç±»åˆ«çš„è·¯ç”±é€‰æ‹©åè®®</p><p>åŸŸå†…è·¯ç”±é€‰æ‹©ä½¿ç”¨å†…éƒ¨ç½‘å…³åè®®IGPè¿™ä¸ªç±»åˆ«çš„è·¯ç”±é€‰æ‹©åè®®</p><p><strong><code>ç½‘å…³åè®®</code><strong>çš„åç§°å¯ç§°ä¸º</strong><code>è·¯ç”±åè®®</code></strong></p></blockquote><p><strong>å¸¸è§çš„è·¯ç”±é€‰æ‹©åè®®</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6b1876963d6d9de0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>è·¯ç”±å™¨çš„åŸºæœ¬ç»“æ„</strong></p><p><strong>è·¯ç”±å™¨æ˜¯ä¸€ç§å…·æœ‰å¤šä¸ªè¾“å…¥ç«¯å£ï¼Œå’Œè¾“å‡ºç«¯å£çš„ä¸“ç”¨è®¡ç®—æœºï¼Œå…¶ä»»åŠ¡æ˜¯è½¬å‘åˆ†ç»„</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-e6b69c1f176e24c5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>è·¯ç”±å™¨ç»“æ„å¯åˆ’åˆ†ä¸ºä¸¤å¤§éƒ¨åˆ†ï¼š</p><p>1ã€<strong>åˆ†ç»„è½¬å‘éƒ¨åˆ†</strong></p><p>ç”±ä¸‰éƒ¨åˆ†æ„æˆ</p><ul><li><p>äº¤æ¢ç»“æ„</p></li><li><p>ä¸€ç»„è¾“å…¥ç«¯å£ï¼š</p><p>ä¿¡å·ä»æŸä¸ªè¾“å…¥ç«¯å£è¿›å…¥è·¯ç”±å™¨</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-2bd1e24a95010cc8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/742/format/webp" alt="img"></p><p>ç‰©ç†å±‚å°†ä¿¡å·è½¬æ¢æˆæ¯”ç‰¹æµï¼Œé€äº¤æ•°æ®é“¾è·¯å±‚å¤„ç†</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-93fa25cf949ddf32.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/627/format/webp" alt="img"></p><p>æ•°æ®é“¾è·¯å±‚è¯†åˆ«ä»æ¯”ç‰¹æµä¸­è¯†åˆ«å‡ºå¸§ï¼Œå»æ‰å¸§å¤´å’Œå¸§å°¾åï¼Œé€äº¤ç½‘ç»œå±‚å¤„ç†</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-be61420be381fce0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/632/format/webp" alt="img"></p><p>å¦‚æœé€äº¤ç½‘ç»œå±‚çš„åˆ†ç»„æ˜¯æ™®é€šå¾…è½¬å‘çš„æ•°æ®åˆ†ç»„</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-13bf3933ea84f8cf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/625/format/webp" alt="img"></p><p>åˆ™æ ¹æ®åˆ†ç»„é¦–éƒ¨ä¸­çš„ç›®çš„åœ°å€è¿›è¡ŒæŸ¥è¡¨è½¬å‘</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6e0cce7487b0555c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/452/format/webp" alt="img"></p><p>è‹¥æ‰¾ä¸åˆ°åŒ¹é…çš„è½¬å‘æ¡ç›®ï¼Œåˆ™ä¸¢å¼ƒè¯¥åˆ†ç»„ï¼Œå¦åˆ™ï¼ŒæŒ‰ç…§åŒ¹é…æ¡ç›®ä¸­æ‰€æŒ‡ç¤ºçš„ç«¯å£è¿›è¡Œè½¬å‘</p></li><li><p>ä¸€ç»„è¾“å‡ºç«¯å£</p><p>ç½‘ç»œå±‚æ›´æ–°æ•°æ®åˆ†ç»„é¦–éƒ¨ä¸­æŸäº›å­—æ®µçš„å€¼ï¼Œä¾‹å¦‚å°†æ•°æ®åˆ†ç»„çš„ç”Ÿå­˜æ—¶é—´å‡1ï¼Œç„¶åé€äº¤æ•°æ®é“¾è·¯å±‚è¿›è¡Œå°è£…</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-c20bbb057497a7dd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/661/format/webp" alt="img"></p><p>æ•°æ®é“¾è·¯å±‚å°†æ•°æ®åˆ†ç»„å°è£…æˆå¸§ï¼Œäº¤ç»™ç‰©ç†å±‚å¤„ç†</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-243c60046346ab42.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/566/format/webp" alt="img"></p><p>ç‰©ç†å±‚å°†å¸§çœ‹æˆæ¯”ç‰¹æµå°†å…¶å˜æ¢æˆç›¸åº”çš„ç”µä¿¡å·è¿›è¡Œå‘é€</p></li></ul><blockquote><p>è·¯ç”±å™¨çš„å„ç«¯å£è¿˜ä¼šæœ‰è¾“å…¥ç¼“å†²åŒºå’Œè¾“å‡ºç¼“å†²åŒº</p><ul><li><p>è¾“å…¥ç¼“å†²åŒºç”¨æ¥æš‚å­˜æ–°è¿›å…¥è·¯ç”±å™¨ä½†è¿˜æ¥ä¸åŠå¤„ç†çš„åˆ†ç»„</p></li><li><p>è¾“å‡ºç¼“å†²åŒºç”¨æ¥æš‚å­˜å·²ç»å¤„ç†å®Œæ¯•ä½†è¿˜æ¥ä¸åŠå‘é€çš„åˆ†ç»„</p></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-af72fd2149d2c01e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>è·¯ç”±å™¨çš„ç«¯å£ä¸€èˆ¬éƒ½å…·æœ‰è¾“å…¥å’Œè¾“å‡ºåŠŸèƒ½</strong>ï¼Œè¿™äº›å®ä¾‹åˆ†å‡ºäº†è¾“å…¥ç«¯å£å’Œè¾“å‡ºç«¯å£æ˜¯æ›´å¥½æ¼”ç¤ºè·¯ç”±åŸºæœ¬å·¥ä½œè¿‡ç¨‹</p></blockquote><p>2ã€<strong>è·¯ç”±é€‰æ‹©éƒ¨åˆ†</strong></p><ul><li><p>è·¯ç”±é€‰æ‹©éƒ¨åˆ†çš„æ ¸å¿ƒæ„ä»¶æ˜¯è·¯ç”±é€‰æ‹©å¤„ç†æœºï¼Œå®ƒçš„ä»»åŠ¡æ˜¯æ ¹æ®æ‰€ä½¿ç”¨çš„è·¯ç”±é€‰æ‹©åè®®ã€‚å‘¨æœŸæ€§åœ°ä¸å…¶ä»–è·¯ç”±å™¨è¿›è¡Œè·¯ç”±ä¿¡æ¯çš„äº¤äº’ï¼Œæ¥æ›´æ–°è·¯ç”±è¡¨</p><p><strong>å¦‚æœé€äº¤ç»™è¾“å…¥ç«¯å£çš„ç½‘ç»œå±‚çš„åˆ†ç»„æ˜¯è·¯ç”±å™¨ä¹‹é—´äº¤æ¢è·¯ç”±ä¿¡æ¯çš„è·¯ç”±æŠ¥æ–‡ï¼Œåˆ™æŠŠè¿™ç§åˆ†ç»„é€äº¤ç»™è·¯ç”±é€‰æ‹©å¤„ç†æœº</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-109a369b44639a9a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/419/format/webp" alt="img"></p><p>è·¯ç”±é€‰æ‹©å¤„ç†æœºæ ¹æ®åˆ†ç»„çš„å†…å®¹æ¥æ›´æ–°è‡ªå·±çš„<strong>è·¯ç”±è¡¨</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-af4af7e182ea3f97.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>è·¯ç”±é€‰æ‹©å¤„ç†æœºè¿˜ä¼šå‘¨æœŸæ€§åœ°ç»™å…¶ä»–è·¯ç”±å™¨å‘é€è‡ªå·±æ‰€çŸ¥é“çš„è·¯ç”±ä¿¡æ¯</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-9c1dca34462b76ab.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1106/format/webp" alt="img"></p></li></ul><h4 id="è·¯ç”±ä¿¡æ¯åè®®RIP"><a href="#è·¯ç”±ä¿¡æ¯åè®®RIP" class="headerlink" title="è·¯ç”±ä¿¡æ¯åè®®RIP"></a>è·¯ç”±ä¿¡æ¯åè®®RIP</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-850c29aaf1e744d6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-81a38e546cd55ec2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/913/format/webp" alt="img"></p><p><strong>RIPçš„åŸºæœ¬å·¥ä½œè¿‡ç¨‹</strong></p><p>ä¸¾ä¾‹</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6bf4e045a90846e0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>RIPçš„è·¯ç”±æ¡ç›®çš„æ›´æ–°è§„åˆ™</strong></p><p>ä¸¾ä¾‹1</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-671231845f242b38.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>è·¯ç”±å™¨Cçš„è¡¨åˆ°è¾¾å„ç›®çš„ç½‘ç»œçš„ä¸‹ä¸€æ¡éƒ½è®°ä¸ºé—®å·ï¼Œå¯ä»¥ç†è§£ä¸ºè·¯ç”±å™¨Då¹¶ä¸éœ€è¦å…³å¿ƒè·¯ç”±å™¨Cçš„è¿™äº›å†…å®¹</p><p>å‡è®¾è·¯ç”±å™¨Cçš„RIPæ›´æ–°æŠ¥æ–‡å‘é€å‘¨æœŸåˆ°äº†ï¼Œåˆ™è·¯ç”±å™¨Cå°†è‡ªå·±è·¯ç”±è¡¨ä¸­çš„ç›¸å…³è·¯ç”±ä¿¡æ¯å°è£…åˆ°RIPæ›´æ–°æŠ¥æ–‡ä¸­å‘é€ç»™è·¯ç”±å™¨D</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-bacf546778de9f8a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>è·¯ç”±å™¨Cèƒ½åˆ°è¾¾è¿™äº›ç½‘ç»œï¼Œè¯´æ˜è·¯ç”±å™¨Cçš„ç›¸é‚»è·¯ç”±å™¨ä¹Ÿèƒ½åˆ°è¾¾ï¼Œåªæ˜¯æ¯”è·¯ç”±å™¨Cçš„è·ç¦»å¤§1ï¼Œäºæ˜¯æ ¹æ®è·ç¦»çš„å¯¹æ¯”ï¼Œè·¯ç”±å™¨Dæ›´æ–°è‡ªå·±çš„è·¯ç”±è¡¨</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-79852776853b7463.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>ä¸¾ä¾‹2</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-7a0db5b1f8900318.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>RIPå­˜åœ¨â€œåæ¶ˆæ¯ä¼ æ’­å¾—æ…¢â€çš„é—®é¢˜</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-edc2c694de1a9ec9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-bedb4b539faf44dd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-4d1eda70d2f555bf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>è§£å†³æ–¹æ³•</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-3a055002b79a9cda.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä½†æ˜¯ï¼Œè¿™äº›æ–¹æ³•ä¹Ÿä¸èƒ½å®Œå…¨è§£å†³â€œåæ¶ˆæ¯ä¼ æ’­å¾—æ…¢â€çš„é—®é¢˜ï¼Œè¿™æ˜¯è·ç¦»å‘é‡çš„æœ¬è´¨å†³å®š</p></blockquote><p><strong>æ€»ç»“</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6bcb92e542416b41.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>RIP åè®®çš„ä¼˜ç¼ºç‚¹</p><p>ä¼˜ç‚¹ï¼š</p><ol><li>å®ç°ç®€å•ï¼Œå¼€é”€è¾ƒå°ã€‚</li></ol><p>ç¼ºç‚¹ï¼š</p><ol><li><p>RIP é™åˆ¶äº†ç½‘ç»œçš„è§„æ¨¡ï¼Œå®ƒèƒ½ä½¿ç”¨çš„æœ€å¤§è·ç¦»ä¸º 15ï¼ˆ16 è¡¨ç¤ºä¸å¯è¾¾ï¼‰ã€‚</p></li><li><p>è·¯ç”±å™¨ä¹‹é—´äº¤æ¢çš„è·¯ç”±ä¿¡æ¯æ˜¯è·¯ç”±å™¨ä¸­çš„å®Œæ•´è·¯ç”±è¡¨ï¼Œå› è€Œéšç€ç½‘ç»œè§„æ¨¡çš„æ‰©å¤§ï¼Œå¼€é”€ä¹Ÿå°±å¢åŠ ã€‚</p></li><li><p>â€œåæ¶ˆæ¯ä¼ æ’­å¾—æ…¢â€ï¼Œä½¿æ›´æ–°è¿‡ç¨‹çš„æ”¶æ•›æ—¶é—´è¿‡é•¿ã€‚</p></li></ol></blockquote><h4 id="å¼€æ”¾æœ€çŸ­è·¯å¾„ä¼˜å…ˆOSPF"><a href="#å¼€æ”¾æœ€çŸ­è·¯å¾„ä¼˜å…ˆOSPF" class="headerlink" title="å¼€æ”¾æœ€çŸ­è·¯å¾„ä¼˜å…ˆOSPF"></a>å¼€æ”¾æœ€çŸ­è·¯å¾„ä¼˜å…ˆOSPF</h4><p>å†…éƒ¨ç½‘å…³åè®®</p><p><strong>å¼€æ”¾æœ€çŸ­è·¯å¾„ä¼˜å…ˆ OSPF (Open Shortest Path First)</strong></p><p><strong>æ³¨æ„</strong>ï¼šOSPF åªæ˜¯ä¸€ä¸ªåè®®çš„åå­—ï¼Œå®ƒå¹¶ä¸è¡¨ç¤ºå…¶ä»–çš„è·¯ç”±é€‰æ‹©åè®®ä¸æ˜¯â€œæœ€çŸ­è·¯å¾„ä¼˜å…ˆâ€ã€‚</p><p><strong>æ¦‚å¿µ</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f5dc77f36b5b1047.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/940/format/webp" alt="img"></p><p><strong>é—®å€™ï¼ˆHelloï¼‰åˆ†ç»„</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f9c642e76e871651.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>IPæ•°æ®æŠ¥é¦–éƒ¨ä¸­åè®®å·å­—æ®µçš„å–å€¼åº”ä¸º89ï¼Œæ¥è¡¨æ˜IPæ•°æ®æŠ¥çš„æ•°æ®è½½è·ä¸ºOSPFåˆ†ç»„</p></blockquote><p><strong>å‘é€é“¾è·¯çŠ¶æ€é€šå‘ŠLSA</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-bbed8a0d31bf19c3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>æ´ªæ³›æ³•æœ‰ç‚¹ç±»ä¼¼äºå¹¿æ’­ï¼Œå°±æ˜¯ä»ä¸€ä¸ªæ¥å£è¿›æ¥ï¼Œä»å…¶ä»–å‰©ä½™æ‰€æœ‰æ¥å£å‡ºå»</p></blockquote><p><strong>é“¾è·¯çŠ¶æ€æ•°æ®åº“åŒæ­¥</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6b8e10e2d82cfa6f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>ä½¿ç”¨SPFç®—æ³•è®¡ç®—å‡ºå„è‡ªè·¯ç”±å™¨åˆ°è¾¾å…¶ä»–è·¯ç”±å™¨çš„æœ€çŸ­è·¯å¾„</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-4239eee0b6040f52.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>OSPFäº”ç§åˆ†ç»„ç±»å‹</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-a2a83ab2654e270f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>OSPFçš„åŸºæœ¬å·¥ä½œè¿‡ç¨‹</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-339786779f0e1a82.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>OSPFåœ¨å¤šç‚¹æ¥å…¥ç½‘ç»œä¸­è·¯ç”±å™¨é‚»å±…å…³ç³»å»ºç«‹</strong></p><p>å¦‚æœä¸é‡‡ç”¨å…¶ä»–æœºåˆ¶ï¼Œå°†ä¼šäº§ç”Ÿå¤§é‡çš„å¤šæ’­åˆ†ç»„</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6420e503df73b7ef.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>è‹¥DRå‡ºç°é—®é¢˜ï¼Œåˆ™ç”±BDRé¡¶æ›¿DR</p></blockquote><p><strong>ä¸ºäº†ä½¿OSPFèƒ½å¤Ÿç”¨äºè§„æ¨¡å¾ˆå¤§çš„ç½‘ç»œï¼ŒOSPFæŠŠä¸€ä¸ªè‡ªæ²»ç³»ç»Ÿå†åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªæ›´å°çš„èŒƒå›´ï¼Œå«åšåŒºåŸŸï¼ˆAreaï¼‰</strong></p><ul><li>åœ¨è¯¥è‡ªæ²»ç³»ç»Ÿå†…ï¼Œæ‰€æœ‰è·¯ç”±å™¨éƒ½ä½¿ç”¨OSPFåè®®ï¼ŒOSPFå°†è¯¥è‡ªæ²»ç³»ç»Ÿå†åˆ’åˆ†æˆ4ä¸ªæ›´å°çš„åŒºåŸŸ</li><li>æ¯ä¸ªåŒºåŸŸéƒ½æœ‰ä¸€ä¸ª32æ¯”ç‰¹çš„åŒºåŸŸæ ‡è¯†ç¬¦</li><li>ä¸»å¹²åŒºåŸŸçš„åŒºåŸŸæ ‡è¯†ç¬¦å¿…é¡»ä¸º0ï¼Œä¸»å¹²åŒºåŸŸç”¨äºè¿é€šå…¶ä»–åŒºåŸŸ</li><li>å…¶ä»–åŒºåŸŸçš„åŒºåŸŸæ ‡è¯†ç¬¦ä¸èƒ½ä¸º0ä¸”ä¸ç›¸åŒ</li><li>æ¯ä¸ªåŒºåŸŸä¸€èˆ¬ä¸åº”åŒ…å«è·¯ç”±å™¨è¶…è¿‡200ä¸ª</li><li>åˆ’åˆ†åŒºåŸŸçš„å¥½å¤„å°±æ˜¯ï¼Œåˆ©ç”¨æ´ªæ³›æ³•äº¤æ¢é“¾è·¯çŠ¶æ€ä¿¡æ¯å±€é™äºæ¯ä¸€ä¸ªåŒºåŸŸè€Œä¸æ˜¯è‡ªæ²»ç³»ç»Ÿï¼Œè¿™æ ·å‡å°‘æ•´ä¸ªç½‘ç»œä¸Šçš„é€šä¿¡é‡</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-725b3aab5aa350b1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>æ€»ç»“</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6382df507ddd76d6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="è¾¹ç•Œç½‘å…³åè®®BGP"><a href="#è¾¹ç•Œç½‘å…³åè®®BGP" class="headerlink" title="è¾¹ç•Œç½‘å…³åè®®BGP"></a>è¾¹ç•Œç½‘å…³åè®®BGP</h4><p>BGPï¼ˆBorder Gateway Protocolï¼‰ æ˜¯<strong>ä¸åŒè‡ªæ²»ç³»ç»Ÿçš„è·¯ç”±å™¨ä¹‹é—´</strong>äº¤æ¢è·¯ç”±ä¿¡æ¯çš„åè®®</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-5aae9c53795e17a7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/970/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-04fe6f98036db57c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-bc71c2ee5976ac53.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-b472dd1a51f30666.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>åœ¨BGPåˆšåˆšè¿è¡Œæ—¶ï¼ŒBGPå¯¹ç­‰æ–¹ä¹‹é—´è¦äº¤æ¢æ•´ä¸ªBGPè·¯ç”±è¡¨ï¼Œä¹‹ååªåœ¨å˜æ¢æ—¶ï¼Œæ›´æ–°æœ‰å˜åŒ–çš„éƒ¨åˆ†ã€‚</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-67b837e6c27d5e9c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>æ€»ç»“</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-ce7dcde013985e95.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="ç›´æ¥å°è£…RIPã€OSPFå’ŒBGPæŠ¥æ–‡çš„åè®®"><a href="#ç›´æ¥å°è£…RIPã€OSPFå’ŒBGPæŠ¥æ–‡çš„åè®®" class="headerlink" title="ç›´æ¥å°è£…RIPã€OSPFå’ŒBGPæŠ¥æ–‡çš„åè®®"></a>ç›´æ¥å°è£…RIPã€OSPFå’ŒBGPæŠ¥æ–‡çš„åè®®</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-40cf22cbd65e9ed8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><hr><h3 id="4-7ã€IPv4æ•°æ®æŠ¥çš„é¦–éƒ¨æ ¼å¼"><a href="#4-7ã€IPv4æ•°æ®æŠ¥çš„é¦–éƒ¨æ ¼å¼" class="headerlink" title="4.7ã€IPv4æ•°æ®æŠ¥çš„é¦–éƒ¨æ ¼å¼"></a>4.7ã€IPv4æ•°æ®æŠ¥çš„é¦–éƒ¨æ ¼å¼</h3><h4 id="å„å­—æ®µçš„ä½œç”¨"><a href="#å„å­—æ®µçš„ä½œç”¨" class="headerlink" title="å„å­—æ®µçš„ä½œç”¨"></a>å„å­—æ®µçš„ä½œç”¨</h4><ul><li>ä¸€ä¸ª IP æ•°æ®æŠ¥ç”±<strong>é¦–éƒ¨</strong>å’Œ<strong>æ•°æ®</strong>ä¸¤éƒ¨åˆ†ç»„æˆã€‚</li><li><strong>é¦–éƒ¨çš„å‰ä¸€éƒ¨åˆ†æ˜¯å›ºå®šé•¿åº¦ï¼Œå…± 20 å­—èŠ‚ï¼Œæ˜¯æ‰€æœ‰ IP æ•°æ®æŠ¥å¿…é¡»å…·æœ‰çš„ã€‚</strong></li><li>åœ¨é¦–éƒ¨çš„å›ºå®šéƒ¨åˆ†çš„åé¢æ˜¯ä¸€äº›å¯é€‰å­—æ®µï¼Œå…¶é•¿åº¦æ˜¯å¯å˜çš„ã€‚</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-73800cce52c3a91e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>å›¾ä¸­çš„æ¯ä¸€è¡Œéƒ½ç”±32ä¸ªæ¯”ç‰¹ï¼ˆä¹Ÿå°±æ˜¯4ä¸ªå­—èŠ‚ï¼‰æ„æˆï¼Œæ¯ä¸ªå°æ ¼å­ç§°ä¸ºå­—æ®µæˆ–è€…åŸŸï¼Œæ¯ä¸ªå­—æ®µæˆ–æŸäº›å­—æ®µçš„ç»„åˆç”¨æ¥è¡¨è¾¾IPåè®®çš„ç›¸å…³åŠŸèƒ½</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f1cf7dd2ea4eb52e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1196/format/webp" alt="img"></p><blockquote><p><strong>IPæ•°æ®æŠ¥çš„é¦–éƒ¨é•¿åº¦ä¸€å®šæ˜¯4å­—èŠ‚çš„æ•´æ•°å€</strong></p><p>å› ä¸ºé¦–éƒ¨ä¸­çš„å¯é€‰å­—æ®µçš„é•¿åº¦ä»1ä¸ªå­—èŠ‚åˆ°40ä¸ªå­—èŠ‚ä¸ç­‰ï¼Œé‚£ä¹ˆï¼Œå½“20å­—èŠ‚çš„å›ºå®šéƒ¨åˆ†åŠ ä¸Š1åˆ°40ä¸ªå­—èŠ‚é•¿åº¦ä¸ç­‰çš„å¯å˜éƒ¨åˆ†ï¼Œ<strong>ä¼šé€ æˆé¦–éƒ¨é•¿åº¦ä¸æ˜¯4å­—èŠ‚æ•´æ•°å€æ—¶ï¼Œå°±ç”¨å–å€¼ä¸ºå…¨0çš„å¡«å……å­—æ®µå¡«å……ç›¸åº”ä¸ªå­—èŠ‚</strong>ï¼Œä»¥ç¡®ä¿IPæ•°æ®æŠ¥çš„é¦–éƒ¨é•¿åº¦æ˜¯4å­—èŠ‚çš„æ•´æ•°å€</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f7bb4a2e440abdc6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"><img src="https://upload-images.jianshu.io/upload_images/24878825-a014cde6b0ff9691.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>å¯¹IPv4æ•°æ®æŠ¥è¿›è¡Œåˆ†ç‰‡</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d7b3a6145ac1dde9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>ç°åœ¨å‡å®šåˆ†ç‰‡2çš„IPæ•°æ®æŠ¥ç»è¿‡æŸä¸ªç½‘ç»œæ—¶è¿˜éœ€è¦è¿›è¡Œåˆ†ç‰‡</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-5d538557f988dc41.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-45ab400eac660e4a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-94a3b7c0b1f01488.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-b074f6fffe538c0e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-07ac459878b48666.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="æ€»ç»“-5"><a href="#æ€»ç»“-5" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-95863501601f7757.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><hr><h3 id="4-8ã€ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ICMP"><a href="#4-8ã€ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ICMP" class="headerlink" title="4.8ã€ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ICMP"></a>4.8ã€ç½‘é™…æ§åˆ¶æŠ¥æ–‡åè®®ICMP</h3><h4 id="æ¦‚å¿µ-1"><a href="#æ¦‚å¿µ-1" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><p>æ¶æ„IPç½‘ç»œæ—¶éœ€è¦ç‰¹åˆ«æ³¨æ„ä¸¤ç‚¹ï¼š</p><ul><li>ç¡®è®¤ç½‘ç»œæ˜¯å¦æ­£å¸¸å·¥ä½œ</li><li>é‡åˆ°å¼‚å¸¸æ—¶è¿›è¡Œé—®é¢˜è¯Šæ–­</li></ul><p><strong>è€ŒICMPå°±æ˜¯å®ç°è¿™äº›é—®é¢˜çš„åè®®</strong></p><p>ICMPçš„ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š</p><ul><li>ç¡®è®¤IPåŒ…æ˜¯å¦æˆåŠŸé€è¾¾ç›®æ ‡åœ°å€</li><li>é€šçŸ¥åœ¨å‘é€è¿‡ç¨‹å½“ä¸­IPåŒ…è¢«åºŸå¼ƒçš„å…·ä½“åŸå› </li><li>æ”¹å–„ç½‘ç»œè®¾ç½®ç­‰</li></ul><p><strong>æœ‰äº†è¿™äº›åŠŸèƒ½ä»¥åï¼Œå°±å¯ä»¥è·å¾—ç½‘ç»œæ˜¯å¦æ­£å¸¸ï¼Œè®¾ç½®æ˜¯å¦æœ‰è¯¯ä»¥åŠè®¾å¤‡æœ‰ä½•å¼‚å¸¸ç­‰ä¿¡æ¯ï¼Œä»è€Œä¾¿äºè¿›è¡Œç½‘ç»œä¸Šçš„é—®é¢˜è¯Šæ–­</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-8739d970a0300acc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>ICMP ä¸æ˜¯é«˜å±‚åè®®ï¼ˆçœ‹èµ·æ¥å¥½åƒæ˜¯é«˜å±‚åè®®ï¼Œå› ä¸º ICMP æŠ¥æ–‡æ˜¯è£…åœ¨ IP æ•°æ®æŠ¥ä¸­ï¼Œä½œä¸ºå…¶ä¸­çš„æ•°æ®éƒ¨åˆ†ï¼‰ï¼Œè€Œæ˜¯ IP å±‚çš„åè®®</strong></p><p>ICMP æŠ¥æ–‡çš„æ ¼å¼</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6a02675fccdc2958.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/813/format/webp" alt="img"></p><h4 id="ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡"><a href="#ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡" class="headerlink" title="ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡"></a>ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡</h4><h5 id="ç»ˆç‚¹ä¸å¯è¾¾"><a href="#ç»ˆç‚¹ä¸å¯è¾¾" class="headerlink" title="ç»ˆç‚¹ä¸å¯è¾¾"></a>ç»ˆç‚¹ä¸å¯è¾¾</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-855edabd9c1e6298.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h5 id="æºç‚¹æŠ‘åˆ¶"><a href="#æºç‚¹æŠ‘åˆ¶" class="headerlink" title="æºç‚¹æŠ‘åˆ¶"></a>æºç‚¹æŠ‘åˆ¶</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-e7f27ef6c93c9621.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h5 id="æ—¶é—´è¶…è¿‡"><a href="#æ—¶é—´è¶…è¿‡" class="headerlink" title="æ—¶é—´è¶…è¿‡"></a>æ—¶é—´è¶…è¿‡</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-49d82185c88813fe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1191/format/webp" alt="img"></p><h5 id="å‚æ•°é—®é¢˜"><a href="#å‚æ•°é—®é¢˜" class="headerlink" title="å‚æ•°é—®é¢˜"></a>å‚æ•°é—®é¢˜</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-e2457fe1291c9bca.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h5 id="æ”¹å˜è·¯ç”±ï¼ˆé‡å®šå‘ï¼‰"><a href="#æ”¹å˜è·¯ç”±ï¼ˆé‡å®šå‘ï¼‰" class="headerlink" title="æ”¹å˜è·¯ç”±ï¼ˆé‡å®šå‘ï¼‰"></a>æ”¹å˜è·¯ç”±ï¼ˆé‡å®šå‘ï¼‰</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-0ef50227f921ca79.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1186/format/webp" alt="img"></p><h5 id="ä¸åº”å‘é€ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡æƒ…å†µ"><a href="#ä¸åº”å‘é€ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡æƒ…å†µ" class="headerlink" title="ä¸åº”å‘é€ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡æƒ…å†µ"></a>ä¸åº”å‘é€ICMPå·®é”™æŠ¥å‘ŠæŠ¥æ–‡æƒ…å†µ</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-a0c3a21bb04ede42.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="ICMPåº”ç”¨ä¸¾ä¾‹"><a href="#ICMPåº”ç”¨ä¸¾ä¾‹" class="headerlink" title="ICMPåº”ç”¨ä¸¾ä¾‹"></a>ICMPåº”ç”¨ä¸¾ä¾‹</h4><h5 id="åˆ†ç»„ç½‘é—´æ¢æµ‹PINGï¼ˆPacket-InterNet-Groperï¼‰"><a href="#åˆ†ç»„ç½‘é—´æ¢æµ‹PINGï¼ˆPacket-InterNet-Groperï¼‰" class="headerlink" title="åˆ†ç»„ç½‘é—´æ¢æµ‹PINGï¼ˆPacket InterNet Groperï¼‰"></a>åˆ†ç»„ç½‘é—´æ¢æµ‹PINGï¼ˆPacket InterNet Groperï¼‰</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-75d7bc12ca942415.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h5 id="è·Ÿè¸ªè·¯ç”±ï¼ˆtracerouteï¼‰"><a href="#è·Ÿè¸ªè·¯ç”±ï¼ˆtracerouteï¼‰" class="headerlink" title="è·Ÿè¸ªè·¯ç”±ï¼ˆtracerouteï¼‰"></a>è·Ÿè¸ªè·¯ç”±ï¼ˆtracerouteï¼‰</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-185af899d5e5a922.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/964/format/webp" alt="img"></p><p><strong>tracertå‘½ä»¤çš„å®ç°åŸç†</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f59a9cacb015f074.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1191/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-982e09181a0bc4ab.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1191/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-aeefc9f3ac87d9d7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="æ€»ç»“-6"><a href="#æ€»ç»“-6" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-571c2187a7833f0d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><hr><h3 id="4-9ã€è™šæ‹Ÿä¸“ç”¨ç½‘VPNä¸ç½‘ç»œåœ°å€è½¬æ¢NAT"><a href="#4-9ã€è™šæ‹Ÿä¸“ç”¨ç½‘VPNä¸ç½‘ç»œåœ°å€è½¬æ¢NAT" class="headerlink" title="4.9ã€è™šæ‹Ÿä¸“ç”¨ç½‘VPNä¸ç½‘ç»œåœ°å€è½¬æ¢NAT"></a>4.9ã€è™šæ‹Ÿä¸“ç”¨ç½‘VPNä¸ç½‘ç»œåœ°å€è½¬æ¢NAT</h3><h4 id="è™šæ‹Ÿä¸“ç”¨ç½‘VPNï¼ˆVirtual-Private-Networkï¼‰"><a href="#è™šæ‹Ÿä¸“ç”¨ç½‘VPNï¼ˆVirtual-Private-Networkï¼‰" class="headerlink" title="è™šæ‹Ÿä¸“ç”¨ç½‘VPNï¼ˆVirtual Private Networkï¼‰"></a>è™šæ‹Ÿä¸“ç”¨ç½‘VPNï¼ˆVirtual Private Networkï¼‰</h4><ul><li>ç”±äº <strong>IP åœ°å€çš„ç´§ç¼º</strong>ï¼Œä¸€ä¸ªæœºæ„èƒ½å¤Ÿç”³è¯·åˆ°çš„IPåœ°å€æ•°å¾€å¾€è¿œå°äºæœ¬æœºæ„æ‰€æ‹¥æœ‰çš„ä¸»æœºæ•°ã€‚</li><li>è€ƒè™‘åˆ°<strong>äº’è”ç½‘å¹¶ä¸å¾ˆå®‰å…¨</strong>ï¼Œä¸€ä¸ªæœºæ„å†…ä¹Ÿå¹¶ä¸éœ€è¦æŠŠæ‰€æœ‰çš„ä¸»æœºæ¥å…¥åˆ°å¤–éƒ¨çš„äº’è”ç½‘ã€‚</li><li>å‡å®šåœ¨ä¸€ä¸ªæœºæ„å†…éƒ¨çš„è®¡ç®—æœºé€šä¿¡ä¹Ÿæ˜¯é‡‡ç”¨ TCP&#x2F;IP åè®®ï¼Œé‚£ä¹ˆä»åŸåˆ™ä¸Šè®²ï¼Œå¯¹äºè¿™äº›ä»…åœ¨<strong>æœºæ„å†…éƒ¨ä½¿ç”¨</strong>çš„è®¡ç®—æœºå°±å¯ä»¥ç”±æœ¬æœºæ„<strong>è‡ªè¡Œåˆ†é…å…¶ IP åœ°å€</strong>ã€‚</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f295c690e2c90d69.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-aee1ae10f8ccb65f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f983b11370b6f354.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä¸Šå›¾æ˜¯å› ç‰¹ç½‘æ•°å­—åˆ†é…æœºæ„IANAå®˜ç½‘æŸ¥çœ‹IPv4åœ°å€ç©ºé—´ä¸­ç‰¹æ®Šåœ°å€çš„åˆ†é…æ–¹æ¡ˆ</p><p>ç”¨ç²‰çº¢è‰²æ ‡å‡ºæ¥çš„åœ°å€å°±æ˜¯æ— éœ€ç”³è¯·çš„ã€å¯è‡ªç”±åˆ†é…çš„ä¸“ç”¨åœ°å€ï¼Œæˆ–ç§°ç§æœ‰åœ°å€</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-93cca695182bf40f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ç§æœ‰åœ°å€åªèƒ½ç”¨äºä¸€ä¸ªæœºæ„çš„å†…éƒ¨é€šä¿¡ï¼Œè€Œä¸èƒ½ç”¨äºå’Œå› ç‰¹ç½‘ä¸Šçš„ä¸»æœºé€šä¿¡</p><p>ç§æœ‰åœ°å€åªèƒ½ç”¨ä½œæœ¬åœ°åœ°å€è€Œä¸èƒ½ç”¨ä½œå…¨çƒåœ°å€</p><p>å› ç‰¹ç½‘ä¸­æ‰€æœ‰è·¯ç”±å™¨å¯¹ç›®çš„åœ°å€æ˜¯ç§æœ‰åœ°å€çš„IPæ•°æ®æŠ¥ä¸€å¾‹ä¸è¿›è¡Œè½¬å‘</p><p><strong>æœ¬åœ°åœ°å€ä¸å…¨çƒåœ°å€</strong></p><ul><li><p><strong>æœ¬åœ°åœ°å€</strong>â€”â€”ä»…åœ¨æœºæ„å†…éƒ¨ä½¿ç”¨çš„ IP åœ°å€ï¼Œå¯ä»¥ç”±æœ¬æœºæ„è‡ªè¡Œåˆ†é…ï¼Œè€Œä¸éœ€è¦å‘äº’è”ç½‘çš„ç®¡ç†æœºæ„ç”³è¯·ã€‚</p></li><li><p><strong>å…¨çƒåœ°å€</strong>â€”â€”å…¨çƒå”¯ä¸€çš„ IP åœ°å€ï¼Œå¿…é¡»å‘äº’è”ç½‘çš„ç®¡ç†æœºæ„ç”³è¯·ã€‚</p></li><li><p><strong>é—®é¢˜</strong>ï¼šåœ¨å†…éƒ¨ä½¿ç”¨çš„æœ¬åœ°åœ°å€å°±æœ‰å¯èƒ½å’Œäº’è”ç½‘ä¸­æŸä¸ª IP åœ°å€é‡åˆï¼Œè¿™æ ·å°±ä¼šå‡ºç°åœ°å€çš„äºŒä¹‰æ€§é—®é¢˜ã€‚</p></li></ul></blockquote><p>æ‰€ä»¥éƒ¨é—¨Aå’Œéƒ¨é—¨Bè‡³å°‘éœ€è¦ä¸€ä¸ª è·¯ç”±å™¨å…·æœ‰åˆæ³•çš„å…¨çƒIPåœ°å€ï¼Œè¿™æ ·å„è‡ªçš„ä¸“ç”¨ç½‘æ‰èƒ½åˆ©ç”¨å…¬ç”¨çš„å› ç‰¹ç½‘è¿›è¡Œé€šä¿¡</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-ab2d75fcfc34f709.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>éƒ¨é—¨Aå‘éƒ¨é—¨Bå‘é€æ•°æ®æµç¨‹</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-3a739ef0d60a031e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä¸¤ä¸ªä¸“ç”¨ç½‘å†…çš„ä¸»æœºé—´å‘é€çš„æ•°æ®æŠ¥æ˜¯é€šè¿‡äº†å…¬ç”¨çš„å› ç‰¹ç½‘ï¼Œä½†åœ¨æ•ˆæœä¸Šå°±å¥½åƒæ˜¯åœ¨æœ¬æœºæ„çš„ä¸“ç”¨ç½‘ä¸Šä¼ é€ä¸€æ ·</p><p>æ•°æ®æŠ¥åœ¨å› ç‰¹ç½‘ä¸­å¯èƒ½è¦ç»è¿‡å¤šä¸ªç½‘ç»œå’Œè·¯ç”±å™¨ï¼Œä½†ä»é€»è¾‘ä¸Šçœ‹ï¼ŒR1å’ŒR2ä¹‹é—´å¥½åƒæ˜¯ä¸€æ¡ç›´é€šçš„ç‚¹å¯¹ç‚¹é“¾è·¯</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-ad9e5dcca8c0a1c9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>å› æ­¤ä¹Ÿè¢«ç§°ä¸ºIPéš§é“æŠ€æœ¯</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6731dbc8b1ee1abc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="ç½‘ç»œåœ°å€è½¬æ¢NATï¼ˆNetwork-Address-Translationï¼‰"><a href="#ç½‘ç»œåœ°å€è½¬æ¢NATï¼ˆNetwork-Address-Translationï¼‰" class="headerlink" title="ç½‘ç»œåœ°å€è½¬æ¢NATï¼ˆNetwork Address Translationï¼‰"></a>ç½‘ç»œåœ°å€è½¬æ¢NATï¼ˆNetwork Address Translationï¼‰</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f9f42bd392a2375a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>ä¸¾ä¾‹</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-c489215f07bc88f6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä½¿ç”¨ç§æœ‰åœ°å€çš„ä¸»æœºï¼Œå¦‚ä½•æ‰èƒ½ä¸å› ç‰¹ç½‘ä¸Šä½¿ç”¨å…¨çƒIPåœ°å€çš„ä¸»æœºè¿›è¡Œé€šä¿¡ï¼Ÿ</p><p>è¿™éœ€è¦åœ¨ä¸“ç”¨ç½‘ç»œè¿æ¥åˆ°å› ç‰¹ç½‘çš„è·¯ç”±å™¨ä¸Šå®‰è£…NATè½¯ä»¶</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-41ae75149e86d0fc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä¸“æœ‰NATè½¯ä»¶çš„è·¯ç”±å™¨å«åšNATè·¯ç”±å™¨</p><p>å®ƒè‡³å°‘æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„å¤–éƒ¨å…¨çƒIPåœ°å€</p><p>è¿™æ ·ï¼Œæ‰€æœ‰ä½¿ç”¨ç§æœ‰åœ°å€çš„ä¸»æœºåœ¨å’Œå¤–ç•Œé€šä¿¡æ—¶ï¼Œéƒ½è¦åœ¨NATè·¯ç”±å™¨ä¸Šå°†å…¶ç§æœ‰åœ°å€è½¬æ¢ä¸ºå…¨çƒIPåœ°å€</p></blockquote><p>å‡è®¾ï¼Œä½¿ç”¨ç§æœ‰åœ°å€çš„ä¸»æœºè¦ç»™å› ç‰¹ç½‘ä¸Šä½¿ç”¨å…¨çƒIPåœ°å€çš„å¦ä¸€å°ä¸»æœºå‘é€IPæ•°æ®æŠ¥</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-a74e4efad5297fc9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>å› ç‰¹ç½‘ä¸Šçš„è¿™å°ä¸»æœºç»™æºä¸»æœºå‘å›æ•°æ®æŠ¥</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-c0463dd919523857.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>å½“ä¸“ç”¨ç½‘ä¸­çš„è¿™ä¸¤å°ä½¿ç”¨ç§æœ‰åœ°å€çš„ä¸»æœºéƒ½è¦ç»™å› ç‰¹ç½‘ä½¿ç”¨å…¨çƒåœ°å€çš„å¦ä¸€å°ä¸»æœºå‘é€æ•°æ®æŠ¥æ—¶ï¼Œåœ¨NATè·¯ç”±å™¨çš„NATè½¬æ¢è¡¨ä¸­å°±ä¼šäº§ç”Ÿä¸¤æ¡è®°å½•ï¼Œåˆ†åˆ«è®°å½•ä¸¤ä¸ªç§æœ‰åœ°å€ä¸å…¨çƒåœ°å€çš„å¯¹åº”å…³ç³»</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-3f71256d68f6a39a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>è¿™ç§åŸºæœ¬è½¬æ¢å­˜åœ¨ä¸€ä¸ªé—®é¢˜</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-ff2eca30cc7a7b41.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/953/format/webp" alt="img"></p><p>è§£å†³æ–¹æ³•</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-05d3e1e3fd4b1998.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>æˆ‘ä»¬ç°åœ¨ç”¨çš„å¾ˆå¤šå®¶ç”¨è·¯ç”±å™¨éƒ½æ˜¯è¿™ç§NARTè·¯ç”±å™¨</p></blockquote><p>å†…ç½‘ä¸»æœºä¸å¤–ç½‘ä¸»æœºçš„é€šä¿¡ï¼Œæ˜¯å¦èƒ½ç”±å¤–ç½‘ä¸»æœºé¦–å…ˆå‘èµ·ï¼Ÿ</p><p>å¦å®š</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d2fd109d060e4853.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-ff43ea52e61da271.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="æ€»ç»“-7"><a href="#æ€»ç»“-7" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-2a40d3a6e5d9e15a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h2 id="äº”ã€è¿è¾“å±‚"><a href="#äº”ã€è¿è¾“å±‚" class="headerlink" title="äº”ã€è¿è¾“å±‚"></a>äº”ã€è¿è¾“å±‚</h2><h3 id="è¿è¾“å±‚æ¦‚è¿°"><a href="#è¿è¾“å±‚æ¦‚è¿°" class="headerlink" title="è¿è¾“å±‚æ¦‚è¿°"></a>è¿è¾“å±‚æ¦‚è¿°</h3><h4 id="æ¦‚å¿µ-2"><a href="#æ¦‚å¿µ-2" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><p><strong>è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-86df51cb4523e3bf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/607/format/webp" alt="img"></p><ul><li>ä»é€šä¿¡å’Œä¿¡æ¯å¤„ç†çš„è§’åº¦çœ‹ï¼Œè¿è¾“å±‚å‘å®ƒä¸Šé¢çš„åº”ç”¨å±‚æä¾›é€šä¿¡æœåŠ¡ï¼Œ<strong>å®ƒå±äºé¢å‘é€šä¿¡éƒ¨åˆ†çš„æœ€é«˜å±‚ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ç”¨æˆ·åŠŸèƒ½ä¸­çš„æœ€ä½å±‚</strong>ã€‚</li><li>å½“ç½‘ç»œçš„è¾¹ç¼˜éƒ¨åˆ†ä¸­çš„ä¸¤ä¸ªä¸»æœºä½¿ç”¨ç½‘ç»œçš„æ ¸å¿ƒéƒ¨åˆ†çš„åŠŸèƒ½è¿›è¡Œç«¯åˆ°ç«¯çš„é€šä¿¡æ—¶ï¼Œ<strong>åªæœ‰ä½äºç½‘ç»œè¾¹ç¼˜éƒ¨åˆ†çš„ä¸»æœºçš„åè®®æ ˆæ‰æœ‰è¿è¾“å±‚</strong>ï¼Œè€Œç½‘ç»œæ ¸å¿ƒéƒ¨åˆ†ä¸­çš„è·¯ç”±å™¨åœ¨è½¬å‘åˆ†ç»„æ—¶éƒ½åªç”¨åˆ°ä¸‰å±‚ï¼ˆåˆ°ç½‘ç»œå±‚ï¼‰çš„åŠŸèƒ½ã€‚</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-09b69e8c98c856d9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>è¿›ç¨‹ä¹‹é—´é€šä¿¡æµç¨‹</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d9a70806edc95dc0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>â€œé€»è¾‘é€šä¿¡â€æ˜¯æŒ‡è¿è¾“å±‚ä¹‹é—´çš„é€šä¿¡å¥½åƒæ˜¯æ²¿æ°´å¹³æ–¹å‘ä¼ é€æ•°æ®ï¼Œä½†äº‹å®ä¸Šï¼Œè¿™ä¸¤æ¡æ•°æ®å¹¶æ²¡æœ‰ä¸€æ¡æ°´å¹³æ–¹å‘çš„ç‰©ç†è¿æ¥ï¼Œè¦ä¼ é€çš„æ•°æ®æ˜¯æ²¿ç€å›¾ä¸­ä¸Šä¸‹å¤šæ¬¡çš„è™šçº¿æ–¹å‘ä¼ é€çš„</p><blockquote><p>è¿›ç¨‹Ap1ä¸Ap4ä¹‹é—´è¿›è¡ŒåŸºäºç½‘ç»œçš„é€šä¿¡ï¼Œè¿›ç¨‹Ap2ä¸Ap3ä¹‹é—´è¿›è¡ŒåŸºäºç½‘ç»œçš„é€šä¿¡</p><p>åœ¨è¿è¾“å±‚ä½¿ç”¨ä¸åŒçš„ç«¯å£ï¼Œæ¥å¯¹åº”ä¸åŒçš„åº”ç”¨è¿›ç¨‹</p><p>ç„¶åé€šè¿‡ç½‘ç»œå±‚åŠå…¶ä¸‹å±‚æ¥ä¼ è¾“åº”ç”¨å±‚æŠ¥æ–‡</p><p>æ¥æ”¶æ–¹çš„è¿è¾“å±‚é€šè¿‡ä¸åŒçš„ç«¯å£ï¼Œå°†æ”¶åˆ°çš„åº”ç”¨å±‚æŠ¥æ–‡ï¼Œäº¤ä»˜ç»™åº”ç”¨å±‚ä¸­ç›¸åº”çš„åº”ç”¨è¿›ç¨‹</p><p><strong>è¿™é‡Œç«¯å£å¹¶ä¸æ˜¯æŒ‡çœ‹å¾—è§ã€æ‘¸å¾—ç€çš„ç‰©ç†ç«¯å£ï¼Œè€Œæ˜¯æŒ‡ç”¨æ¥åŒºåˆ†ä¸åŒåº”ç”¨è¿›ç¨‹çš„æ ‡è¯†ç¬¦</strong></p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-a6a6ccc0bbd7f56f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="æ€»ç»“-8"><a href="#æ€»ç»“-8" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-49194e15f1010ebe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-04161b0a03409d04.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/951/format/webp" alt="img"></p><hr><h3 id="è¿è¾“å±‚ç«¯å£å·ã€å¤ç”¨ä¸åˆ†ç”¨çš„æ¦‚å¿µ"><a href="#è¿è¾“å±‚ç«¯å£å·ã€å¤ç”¨ä¸åˆ†ç”¨çš„æ¦‚å¿µ" class="headerlink" title="è¿è¾“å±‚ç«¯å£å·ã€å¤ç”¨ä¸åˆ†ç”¨çš„æ¦‚å¿µ"></a>è¿è¾“å±‚ç«¯å£å·ã€å¤ç”¨ä¸åˆ†ç”¨çš„æ¦‚å¿µ</h3><h4 id="ä¸ºä»€ä¹ˆç”¨ç«¯å£å·"><a href="#ä¸ºä»€ä¹ˆç”¨ç«¯å£å·" class="headerlink" title="ä¸ºä»€ä¹ˆç”¨ç«¯å£å·"></a>ä¸ºä»€ä¹ˆç”¨ç«¯å£å·</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-de597eda77aa6acd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="å‘é€æ–¹çš„å¤ç”¨å’Œæ¥æ”¶æ–¹çš„åˆ†ç”¨"><a href="#å‘é€æ–¹çš„å¤ç”¨å’Œæ¥æ”¶æ–¹çš„åˆ†ç”¨" class="headerlink" title="å‘é€æ–¹çš„å¤ç”¨å’Œæ¥æ”¶æ–¹çš„åˆ†ç”¨"></a>å‘é€æ–¹çš„å¤ç”¨å’Œæ¥æ”¶æ–¹çš„åˆ†ç”¨</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-2a4ec3f5d5c11433.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p><strong>å¤šä¸ªè¿›ç¨‹ï¼ˆè¿™é‡Œä¸€ä¸ªç«¯å£è¡¨ç¤ºä¸€ä¸ªè¿›ç¨‹ï¼‰</strong> åˆ©ç”¨ä¸€ä¸ªè¿è¾“å±‚åè®®ï¼ˆæˆ–è€…ç§°ä¸ºè¿è¾“å±‚æ¥å£ï¼‰<strong>å‘é€</strong>æ•°æ®ç§°ä¸º <strong>å¤ç”¨</strong></p><p><strong>å¤šä¸ªè¿›ç¨‹ï¼ˆè¿™é‡Œä¸€ä¸ªç«¯å£è¡¨ç¤ºä¸€ä¸ªè¿›ç¨‹ï¼‰</strong> åˆ©ç”¨ä¸€ä¸ªè¿è¾“å±‚åè®®ï¼ˆæˆ–è€…ç§°ä¸ºè¿è¾“å±‚æ¥å£ï¼‰<strong>æ¥æ”¶</strong>æ—¶å«åš <strong>åˆ†ç”¨</strong>ã€‚</p></blockquote><h4 id="TCP-x2F-IPä½“ç³»çš„åº”ç”¨å±‚å¸¸ç”¨åè®®æ‰€ä½¿ç”¨çš„è¿è¾“å±‚ç†ŸçŸ¥ç«¯å£å·"><a href="#TCP-x2F-IPä½“ç³»çš„åº”ç”¨å±‚å¸¸ç”¨åè®®æ‰€ä½¿ç”¨çš„è¿è¾“å±‚ç†ŸçŸ¥ç«¯å£å·" class="headerlink" title="TCP&#x2F;IPä½“ç³»çš„åº”ç”¨å±‚å¸¸ç”¨åè®®æ‰€ä½¿ç”¨çš„è¿è¾“å±‚ç†ŸçŸ¥ç«¯å£å·"></a>TCP&#x2F;IPä½“ç³»çš„åº”ç”¨å±‚å¸¸ç”¨åè®®æ‰€ä½¿ç”¨çš„è¿è¾“å±‚ç†ŸçŸ¥ç«¯å£å·</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-2117fa99a7f2a89c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="è¿è¾“å±‚ä¼ è¾“æµç¨‹"><a href="#è¿è¾“å±‚ä¼ è¾“æµç¨‹" class="headerlink" title="è¿è¾“å±‚ä¼ è¾“æµç¨‹"></a>è¿è¾“å±‚ä¼ è¾“æµç¨‹</h4><p>ä¸¾ä¾‹</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-1a74e63c3af96dda.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>åœ¨æµè§ˆå™¨è¾“å…¥åŸŸåï¼Œå›è½¦æµè§ˆ</p><p>ç„¶åç”¨æˆ·PCä¸­çš„DNSå®¢æˆ·ç«¯è¿›ç¨‹ä¼šå‘é€ä¸€ä¸ªDNSæŸ¥è¯¢è¯·æ±‚æŠ¥æ–‡</p><p>DNSæŸ¥è¯¢è¯·æ±‚æŠ¥æ–‡éœ€è¦ä½¿ç”¨è¿è¾“å±‚çš„UDPåè®®</p><p>é¦–éƒ¨ä¸­çš„æºç«¯å£å­—æ®µçš„å€¼ï¼Œåœ¨çŸ­æš‚ç«¯å£å·49151~65535ä¸­æŒ‘é€‰ä¸€ä¸ªæœªè¢«å ç”¨çš„ï¼Œç”¨æ¥è¡¨ç¤ºDNSå®¢æˆ·ç«¯è¿›ç¨‹</p><p>é¦–éƒ¨ä¸­çš„ç›®çš„ç«¯å£å­—æ®µçš„å€¼ï¼š53ï¼Œæ˜¯DNSæœåŠ¡å™¨ç«¯è¿›ç¨‹æ‰€ä½¿ç”¨çš„ç†ŸçŸ¥ç«¯å£å·</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-30701c2470e290ca.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä¹‹åï¼Œå°†UDPç”¨æˆ·æ•°æ®æŠ¥å°è£…åœ¨IPæ•°æ®æŠ¥ä¸­ï¼Œé€šè¿‡ä»¥å¤ªç½‘å‘é€ç»™DNSæœåŠ¡å™¨</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-c4b699dfdd16826d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>DNSæœåŠ¡å™¨æ”¶åˆ°è¯¥IPæ•°æ®æŠ¥åï¼Œä»ä¸­è§£å°å‡ºUDPç”¨æˆ·æ•°æ®æŠ¥</p><p>UDPé¦–éƒ¨ä¸­çš„ç›®çš„ç«¯å£å·ä¸º53ï¼Œè¿™è¡¨æ˜åº”å°†è¯¥UDPç”¨æˆ·æ•°æ®æŠ¥çš„æ•°æ®è½½è·éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯DNSæŸ¥è¯¢è¯·æ±‚æŠ¥æ–‡ï¼Œäº¤ä»˜ç»™æœ¬æœåŠ¡å™¨ä¸­çš„DNSæœåŠ¡å™¨ç«¯è¿›ç¨‹</p><p>DNSæœåŠ¡å™¨ç«¯è¿›ç¨‹è§£æDNSæŸ¥è¯¢è¯·æ±‚æŠ¥æ–‡çš„å†…å®¹ï¼Œç„¶åæŒ‰å…¶è¦æ±‚æŸ¥æ‰¾å¯¹åº”çš„IPåœ°å€</p><p>ä¹‹åï¼Œä¼šç»™ç”¨æˆ·PCå‘é€DNSå“åº”æŠ¥æ–‡ï¼ŒDNSå“åº”æŠ¥æ–‡éœ€è¦ä½¿ç”¨è¿è¾“å±‚çš„UDPåè®®å°è£…æˆUDPç”¨æˆ·æ•°æ®æŠ¥</p><p>å…¶é¦–éƒ¨ä¸­çš„æºç«¯å£å­—æ®µçš„å€¼è®¾ç½®ä¸ºç†ŸçŸ¥ç«¯å£å·53ï¼Œè¡¨æ˜è¿™æ˜¯DNSæœåŠ¡å™¨ç«¯è¿›ç¨‹æ‰€å‘é€çš„UDPç”¨æˆ·æ•°æ®æŠ¥ï¼Œç›®çš„ç«¯å£çš„å€¼è®¾ç½®ä¸º49152ï¼Œè¿™æ˜¯ä¹‹å‰ç”¨æˆ·PCä¸­å‘é€DNSæŸ¥è¯¢è¯·æ±‚æŠ¥æ–‡çš„DNSå®¢æˆ·ç«¯è¿›ç¨‹æ‰€ä½¿ç”¨çš„çŸ­æš‚ç«¯å£å·</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6912810cd1134dc5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>å°†UDPç”¨æˆ·æ•°æ®æŠ¥å°è£…åœ¨IPæ•°æ®æŠ¥ä¸­ï¼Œé€šè¿‡ä»¥å¤ªç½‘å‘é€ç»™ç”¨æˆ·PC</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-eddf54c480b0a2b4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ç”¨æˆ·PCæ”¶åˆ°è¯¥æ•°æ®æŠ¥åï¼Œä»ä¸­è§£å°å‡ºUDPç”¨æˆ·æ•°æ®æŠ¥</p><p>UDPé¦–éƒ¨ä¸­çš„ç›®çš„ç«¯å£å·ä¸º49152ï¼Œè¿™è¡¨æ˜åº”å°†è¯¥UDPç”¨æˆ·æ•°æ®æŠ¥çš„æ•°æ®è½½è·éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯DNSå“åº”æŠ¥æ–‡ï¼Œäº¤ä»˜ç»™ç”¨æˆ·PCä¸­çš„DNSå®¢æˆ·ç«¯è¿›ç¨‹</p><p>DNSå®¢æˆ·ç«¯è¿›ç¨‹è§£æDNSå“åº”æŠ¥æ–‡çš„å†…å®¹ï¼Œå°±å¯çŸ¥é“è‡ªå·±ä¹‹å‰æ‰€è¯·æ±‚çš„WebæœåŠ¡å™¨çš„åŸŸåå¯¹åº”çš„IPåœ°å€</p></blockquote><p>ç°åœ¨ç”¨æˆ·PCä¸­çš„HTTPå®¢æˆ·ç«¯è¿›ç¨‹å¯ä»¥å‘WebæœåŠ¡å™¨å‘é€HTTPè¯·æ±‚æŠ¥æ–‡ï¼ˆå’ŒDNSå‘é€å’Œæ¥æ”¶æµç¨‹å·®ä¸å¤šï¼‰</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-e60fa3dedd69fae7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-1184eefc458e27b9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-5fd36c843b4e1bab.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-62b9ed69203838ad.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-4e8b2e2943e1ec81.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h3 id="UDPå’ŒTCPçš„å¯¹æ¯”"><a href="#UDPå’ŒTCPçš„å¯¹æ¯”" class="headerlink" title="UDPå’ŒTCPçš„å¯¹æ¯”"></a>UDPå’ŒTCPçš„å¯¹æ¯”</h3><h4 id="æ¦‚å¿µ-3"><a href="#æ¦‚å¿µ-3" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><ul><li><strong>UDP</strong> å’Œ <strong>TCP</strong> æ˜¯TCP&#x2F;IPä½“ç³»ç»“æ„<strong>è¿è¾“å±‚</strong>ä¸­çš„ä¸¤ä¸ªé‡è¦åè®®</li><li>å½“è¿è¾“å±‚é‡‡ç”¨é¢å‘è¿æ¥çš„ <strong>TCP</strong> åè®®æ—¶ï¼Œå°½ç®¡ä¸‹é¢çš„ç½‘ç»œæ˜¯ä¸å¯é çš„ï¼ˆåªæä¾›å°½æœ€å¤§åŠªåŠ›æœåŠ¡ï¼‰ï¼Œä½†è¿™ç§é€»è¾‘é€šä¿¡ä¿¡é“å°±ç›¸å½“äºä¸€æ¡<strong>å…¨åŒå·¥çš„å¯é ä¿¡é“</strong>ã€‚</li><li>å½“è¿è¾“å±‚é‡‡ç”¨æ— è¿æ¥çš„ <strong>UDP</strong> åè®®æ—¶ï¼Œè¿™ç§é€»è¾‘é€šä¿¡ä¿¡é“æ˜¯ä¸€æ¡<strong>ä¸å¯é ä¿¡é“</strong>ã€‚</li></ul><p>å¯é ä¿¡é“ä¸ä¸å¯é ä¿¡é“</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-fceecce4ac04df77.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/909/format/webp" alt="img"></p><ul><li>ä¸¤ä¸ªå¯¹ç­‰è¿è¾“å®ä½“åœ¨é€šä¿¡æ—¶ä¼ é€çš„æ•°æ®å•ä½å«ä½œ<strong>è¿è¾“åè®®æ•°æ®å•å…ƒ</strong> TPDU (Transport Protocol Data Unit)ã€‚</li><li>TCP ä¼ é€çš„æ•°æ®å•ä½åè®®æ˜¯ <strong>TCP æŠ¥æ–‡æ®µ</strong>(segment)ã€‚</li><li>UDP ä¼ é€çš„æ•°æ®å•ä½åè®®æ˜¯ <strong>UDP æŠ¥æ–‡</strong>æˆ–<strong>ç”¨æˆ·æ•°æ®æŠ¥</strong>ã€‚</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-58c94f043969af9a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>UDPçš„é€šä¿¡æ˜¯æ— è¿æ¥çš„ï¼Œä¸éœ€è¦å¥—æ¥å­—ï¼ˆSocketï¼‰</p><p>TCPæ˜¯é¢å‘è¿æ¥çš„ï¼ŒTCPä¹‹é—´çš„é€šä¿¡å¿…é¡»è¦åœ¨ä¸¤ä¸ªå¥—æ¥å­—ï¼ˆSocketï¼‰ä¹‹é—´å»ºç«‹è¿æ¥</p><blockquote><p>å¥—æ¥å­—(Socket)ï¼Œå°±æ˜¯å¯¹ç½‘ç»œä¸­ä¸åŒä¸»æœºä¸Šçš„åº”ç”¨è¿›ç¨‹ä¹‹é—´è¿›è¡ŒåŒå‘é€šä¿¡çš„ç«¯ç‚¹çš„æŠ½è±¡ã€‚ä¸€ä¸ªå¥—æ¥å­—å°±æ˜¯ç½‘ç»œä¸Šè¿›ç¨‹é€šä¿¡çš„ä¸€ç«¯ï¼Œæä¾›äº†åº”ç”¨å±‚è¿›ç¨‹åˆ©ç”¨ç½‘ç»œåè®®äº¤æ¢æ•°æ®çš„æœºåˆ¶ã€‚</p></blockquote><h4 id="ç”¨æˆ·æ•°æ®æŠ¥åè®®UDPï¼ˆUser-Datagram-Protocolï¼‰"><a href="#ç”¨æˆ·æ•°æ®æŠ¥åè®®UDPï¼ˆUser-Datagram-Protocolï¼‰" class="headerlink" title="ç”¨æˆ·æ•°æ®æŠ¥åè®®UDPï¼ˆUser Datagram Protocolï¼‰"></a>ç”¨æˆ·æ•°æ®æŠ¥åè®®UDPï¼ˆUser Datagram Protocolï¼‰</h4><p>å¯ä»¥å‘é€å¹¿æ’­</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6b064807ce85da9d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/937/format/webp" alt="img"></p><p>å¯ä»¥å‘æŸä¸ªå¤šæ’­ç»„å‘é€å¤šæ’­</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-ad578349b071fd1f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/983/format/webp" alt="img"></p><p>è¿˜å¯ä»¥å‘é€å•æ’­</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-4d5ff7d4922fd433.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/914/format/webp" alt="img"></p><blockquote><p>UDP æ”¯æŒå•æ’­ã€å¤šæ’­ä»¥åŠå¹¿æ’­</p><p>æ¢å¥è¯è¯´ï¼ŒUDPæ”¯æŒä¸€å¯¹ä¸€ï¼Œä¸€å¯¹å¤šï¼Œä»¥åŠä¸€å¯¹å…¨çš„é€šä¿¡</p></blockquote><p>è¿è¾“è¿‡ç¨‹</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-93e3dea8064d7a6c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/949/format/webp" alt="img"></p><blockquote><p>UDPå¯¹åº”ç”¨è¿›ç¨‹äº¤ä¸‹æ¥çš„æŠ¥æ–‡æ—¢ä¸åˆå¹¶ä¹Ÿä¸æ‹†åˆ†ï¼Œè€Œæ˜¯ä¿ç•™è¿™äº›æŠ¥æ–‡çš„è¾¹ç•Œ</p><p>æ¢å¥è¯è¯´ï¼ŒUDPæ˜¯é¢å‘åº”ç”¨æŠ¥æ–‡çš„</p></blockquote><p>UDPå‘ä¸Šå±‚æä¾›æ— è¿æ¥ä¸å¯é ä¼ è¾“æœåŠ¡</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-ce94f5cade6a0e97.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/970/format/webp" alt="img"></p><p>UDPç»“æ„</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-624005a24bc5bfcd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/871/format/webp" alt="img"></p><h4 id="ä¼ è¾“æ§åˆ¶åè®®TCPï¼ˆTransmission-Control-Protocolï¼‰"><a href="#ä¼ è¾“æ§åˆ¶åè®®TCPï¼ˆTransmission-Control-Protocolï¼‰" class="headerlink" title="ä¼ è¾“æ§åˆ¶åè®®TCPï¼ˆTransmission Control Protocolï¼‰"></a>ä¼ è¾“æ§åˆ¶åè®®TCPï¼ˆTransmission Control Protocolï¼‰</h4><p>ä½¿ç”¨TCPåè®®çš„é€šä¿¡åŒæ–¹ï¼Œåœ¨è¿›è¡Œæ•°æ®ä¼ è¾“ä¹‹å‰ï¼Œå¿…é¡»ä½¿ç”¨â€œä¸‰æŠ¥æ–‡æ¡æ‰‹â€å»ºç«‹TCPè¿æ¥</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-fe9d1bdd35dbd5d4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/920/format/webp" alt="img"></p><p>TCPè¿æ¥å»ºç«‹æˆåŠŸåï¼Œé€šä¿¡åŒæ–¹ä¹‹é—´å°±å¥½åƒæœ‰ä¸€æ¡å¯é çš„é€šä¿¡ä¿¡é“ï¼Œé€šä¿¡åŒæ–¹ä½¿ç”¨è¿™æ¡åŸºäºTCPè¿æ¥çš„å¯é ä¿¡é“è¿›è¡Œé€šä¿¡</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-e193eb63d50a9c79.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/932/format/webp" alt="img"></p><blockquote><p>å¾ˆæ˜¾ç„¶ï¼ŒTCPä»…æ”¯æŒå•æ’­ï¼Œä¹Ÿå°±æ˜¯ä¸€å¯¹ä¸€çš„é€šä¿¡</p></blockquote><p>è¿è¾“è¿‡ç¨‹</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-cd38698ad784fcea.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/951/format/webp" alt="img"></p><blockquote><p>å‘é€æ–¹</p><ul><li><p>TCPä¼šæŠŠåº”ç”¨è¿›ç¨‹äº¤ä»˜ä¸‹æ¥çš„æ•°æ®å—çœ‹ä½œæ˜¯ä¸€è¿ä¸²æ— ç»“æ„çš„å­—èŠ‚æµï¼ŒTCPå¹¶ä¸çŸ¥é“è¿™äº›å¾…ä¼ é€çš„å­—èŠ‚æµçš„å«ä¹‰</p></li><li><p>å¹¶å°†ä»–ä»¬ç¼–å·ï¼Œå¹¶å­˜å‚¨åœ¨è‡ªå·±å‘é€ç¼“å­˜ä¸­</p></li><li><p>TCPä¼šæ ¹æ®å‘é€ç­–ç•¥ï¼Œæå–ä¸€å®šé‡çš„å­—èŠ‚æ„å»ºTCPæŠ¥æ–‡å¹¶å‘é€</p></li></ul><p>æ¥æ”¶æ–¹</p><ul><li><p>ä¸€æ–¹é¢ä»æ‰€æ¥å—åˆ°çš„TCPæŠ¥æ–‡æ®µä¸­ï¼Œå–å‡ºæ•°æ®è½½è·éƒ¨åˆ†å¹¶å­˜å‚¨åœ¨æ¥æ”¶ç¼“å­˜ä¸­ï¼›ä¸€æ–¹é¢å°†æ¥æ”¶ç¼“å­˜ä¸­çš„ä¸€äº›å­—èŠ‚äº¤ä»˜ç»™åº”ç”¨è¿›ç¨‹</p></li><li><p>TCPä¸ä¿è¯æ¥æ”¶æ–¹åº”ç”¨è¿›ç¨‹æ‰€æ”¶åˆ°çš„æ•°æ®å—ä¸å‘é€æ–¹å‘é€çš„æ•°æ®å—ï¼Œå…·æœ‰å¯¹åº”å¤§å°çš„å…³ç³»ï¼ˆä¾‹å¦‚ï¼Œå‘é€æ–¹åº”ç”¨è¿›ç¨‹äº¤ç»™å‘é€æ–¹çš„TCPå…±10ä¸ªæ•°æ®å—ï¼Œä½†æ¥æ”¶æ–¹çš„TCPå¯èƒ½åªç”¨äº†4ä¸ªæ•°æ®å—ï¼Œå°±æŠŠæ”¶åˆ°çš„å­—èŠ‚æµäº¤ä»˜ç»™äº†ä¸Šå±‚çš„åº”ç”¨è¿›ç¨‹ï¼Œä½†æ¥æ”¶æ–¹æ”¶åˆ°çš„å­—èŠ‚æµå¿…é¡»å’Œå‘é€æ–¹åº”ç”¨è¿›ç¨‹å‘å‡ºçš„å­—èŠ‚æµå®Œå…¨ä¸€æ ·ï¼‰</p></li><li><p>æ¥æ”¶æ–¹çš„åº”ç”¨è¿›ç¨‹å¿…é¡»æœ‰èƒ½åŠ›è¯†åˆ«æ”¶åˆ°çš„å­—èŠ‚æµï¼ŒæŠŠå®ƒè¿˜åŸæˆæœ‰æ„ä¹‰çš„åº”ç”¨å±‚æ•°æ®</p></li></ul><p>TCPæ˜¯é¢å‘å­—èŠ‚æµçš„ï¼Œè¿™æ­£æ˜¯TCPå®ç°å¯é ä¼ è¾“ã€æµé‡æ§åˆ¶ã€ä»¥åŠæ‹¥å¡æ§åˆ¶çš„åŸºç¡€</p><p>æœ¬å›¾åªç”»äº†ä¸€ä¸ªæ–¹å‘çš„æ•°æ®æµï¼Œåœ¨å®é™…ç½‘ç»œä¸­ï¼ŒåŸºäºTCPè¿æ¥çš„ä¸¤ç«¯ï¼Œå¯ä»¥åŒæ—¶è¿›è¡ŒTCPæŠ¥æ–‡æ®µçš„å‘é€å’Œæ¥æ”¶</p></blockquote><p>TCPå‘ä¸Šå±‚æä¾›é¢å‘è¿æ¥çš„å¯é ä¼ è¾“æœåŠ¡</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-915eafb17567c438.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/932/format/webp" alt="img"></p><p>TCPç»“æ„</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-db48b70af7fb7884.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/897/format/webp" alt="img"></p><h4 id="æ€»ç»“-9"><a href="#æ€»ç»“-9" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-b0c1d4146735458a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><hr><h3 id="TCPçš„æµé‡æ§åˆ¶"><a href="#TCPçš„æµé‡æ§åˆ¶" class="headerlink" title="TCPçš„æµé‡æ§åˆ¶"></a>TCPçš„æµé‡æ§åˆ¶</h3><h4 id="æ¦‚å¿µ-4"><a href="#æ¦‚å¿µ-4" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-2265c15b05b648dd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>ä¸¾ä¾‹</p><p><a href="https://links.jianshu.com/go?to=https://www.bilibili.com/video/BV1c4411d7jb?p=60">å…·ä½“æµç¨‹çš„è§†é¢‘</a></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-b05bfb5781a99f95.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>ä¸Šå›¾ä¸»æœºAç°åœ¨å¯å°†å‘é€ç¼“å­˜ä¸­åºå·1~200çš„å­—èŠ‚æ•°æ®å…¨éƒ¨åˆ é™¤ï¼Œå› ä¸ºå·²ç»æ”¶åˆ°äº†ä¸»æœºBå¯¹å®ƒä»¬çš„ç´¯è®¡ç¡®è®¤</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-822d96dec58ce11f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>ä¸Šå›¾ä¸»æœºAç°åœ¨å¯å°†å‘é€ç¼“å­˜ä¸­åºå·201~500çš„å­—èŠ‚æ•°æ®å…¨éƒ¨åˆ é™¤ï¼Œå› ä¸ºå·²ç»æ”¶åˆ°äº†ä¸»æœºBå¯¹å®ƒä»¬çš„ç´¯è®¡ç¡®è®¤</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-43345f50233197a7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f73e94f75e94ea4c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>ä¸Šå›¾ä¸»æœºAç°åœ¨å¯å°†å‘é€ç¼“å­˜ä¸­åºå·501~600çš„å­—èŠ‚æ•°æ®å…¨éƒ¨åˆ é™¤ï¼Œå› ä¸ºå·²ç»æ”¶åˆ°äº†ä¸»æœºBå¯¹å®ƒä»¬çš„ç´¯è®¡ç¡®è®¤</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-5bd53b8a5a5ac400.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-ea9dc3589e6c6bd1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä¸Šå›¾å¦‚æœé›¶çª—å£æ¢æµ‹æŠ¥æ–‡åœ¨å‘é€è¿‡ç¨‹ä¸­å¦‚æœä¸¢å¤±ï¼Œè¿˜æ˜¯èƒ½æ‰“ç ´æ­»é”å±€é¢</p><p>å› ä¸ºé›¶çª—å£æ¢æµ‹æŠ¥æ–‡æ®µä¹Ÿæœ‰é‡ä¼ è®¡æ—¶å™¨ï¼Œé‡ä¼ è®¡æ—¶å™¨è¶…æ—¶åï¼Œé›¶çª—å£æ¢æµ‹æŠ¥æ–‡æ®µä¼šè¢«é‡ä¼ </p></blockquote><h4 id="æ€»ç»“-10"><a href="#æ€»ç»“-10" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d8221e9dda7919f9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><hr><h3 id="TCPçš„æ‹¥å¡æ§åˆ¶"><a href="#TCPçš„æ‹¥å¡æ§åˆ¶" class="headerlink" title="TCPçš„æ‹¥å¡æ§åˆ¶"></a>TCPçš„æ‹¥å¡æ§åˆ¶</h3><h4 id="æ¦‚å¿µ-5"><a href="#æ¦‚å¿µ-5" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-9d4b410b2a44c125.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>ç½‘ç»œæ‹¥å¡å¾€å¾€æ˜¯ç”±è®¸å¤šå› ç´ å¼•èµ·çš„ã€‚ä¾‹å¦‚ï¼š</strong></p><ol><li>ç‚¹ç¼“å­˜çš„å®¹é‡å¤ªå°ï¼›</li><li>é“¾è·¯çš„å®¹é‡ä¸è¶³ï¼›</li><li>å¤„ç†æœºå¤„ç†çš„é€Ÿç‡å¤ªæ…¢ï¼›</li><li>æ‹¥å¡æœ¬èº«ä¼šè¿›ä¸€æ­¥åŠ å‰§æ‹¥å¡ï¼›</li></ol><p><strong>æ‹¥å¡æ§åˆ¶çš„ä¸€èˆ¬åŸç†</strong></p><ul><li>æ‹¥å¡æ§åˆ¶çš„å‰æï¼šç½‘ç»œèƒ½å¤Ÿæ‰¿å—ç°æœ‰çš„ç½‘ç»œè´Ÿè·ã€‚</li><li>å®è·µè¯æ˜ï¼Œæ‹¥å¡æ§åˆ¶æ˜¯å¾ˆéš¾è®¾è®¡çš„ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ª<strong>åŠ¨æ€é—®é¢˜</strong>ã€‚</li><li>åˆ†ç»„çš„ä¸¢å¤±æ˜¯ç½‘ç»œå‘ç”Ÿæ‹¥å¡çš„<strong>å¾å…†</strong>è€Œä¸æ˜¯åŸå› ã€‚</li><li>åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œç”šè‡³æ­£æ˜¯<strong>æ‹¥å¡æ§åˆ¶æœ¬èº«</strong>æˆä¸ºå¼•èµ·ç½‘ç»œæ€§èƒ½æ¶åŒ–ã€ç”šè‡³å‘ç”Ÿæ­»é”çš„åŸå› ã€‚</li></ul><p><strong>å¼€ç¯æ§åˆ¶å’Œé—­ç¯æ§åˆ¶</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-2740d71c5e1d6aac.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/884/format/webp" alt="img"></p><p><strong>ç›‘æµ‹ç½‘ç»œçš„æ‹¥å¡</strong></p><p>ä¸»è¦æŒ‡æ ‡æœ‰ï¼š</p><ol><li>ç”±äºç¼ºå°‘ç¼“å­˜ç©ºé—´è€Œè¢«ä¸¢å¼ƒçš„åˆ†ç»„çš„ç™¾åˆ†æ•°ï¼›</li><li>å¹³å‡é˜Ÿåˆ—é•¿åº¦ï¼›</li><li>è¶…æ—¶é‡ä¼ çš„åˆ†ç»„æ•°ï¼›</li><li>å¹³å‡åˆ†ç»„æ—¶å»¶ï¼›</li><li>åˆ†ç»„æ—¶å»¶çš„æ ‡å‡†å·®ï¼Œç­‰ç­‰ã€‚</li></ol><p>ä¸Šè¿°è¿™äº›æŒ‡æ ‡çš„ä¸Šå‡éƒ½æ ‡å¿—ç€æ‹¥å¡çš„å¢é•¿ã€‚</p><h4 id="æ‹¥å¡æ§åˆ¶çš„ç®—æ³•"><a href="#æ‹¥å¡æ§åˆ¶çš„ç®—æ³•" class="headerlink" title="æ‹¥å¡æ§åˆ¶çš„ç®—æ³•"></a>æ‹¥å¡æ§åˆ¶çš„ç®—æ³•</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-67852fc13fc0e263.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-c7682fe29ebcb6fd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>çœŸæ­£çš„å‘é€çª—å£å€¼ &#x3D; Min (æ¥æ”¶æ–¹çª—å£å€¼ï¼Œæ‹¥å¡çª—å£å€¼)</p></blockquote><p>ä¸‹å›¾çš„å®ä¾‹æ¨ªçºµåæ ‡çš„æ„æ€</p><p>ä¼ è¾“è½®æ¬¡ï¼š</p><ul><li>å‘é€æ–¹ç»™æ¥æ”¶æ–¹å‘é€æ•°æ®æŠ¥æ–‡æ®µåï¼Œæ¥æ”¶æ–¹ç»™å‘é€æ–¹å‘å‘å›ç›¸åº”çš„ç¡®è®¤æŠ¥æ–‡æ®µ</li><li>ä¸€ä¸ªä¼ è¾“è½®æ¬¡æ‰€ç»å†çš„æ—¶é—´å…¶å®å°±æ˜¯å¾€è¿”æ—¶é—´ï¼Œå¾€è¿”æ—¶é—´å¹¶éæ˜¯æ’å®šçš„æ•°å€¼</li><li>ä½¿ç”¨ä¼ è¾“è½®æ¬¡æ˜¯ä¸ºäº†å¼ºè°ƒæŠŠæ‹¥å¡çª—å£æ‰€å…è®¸å‘é€çš„æŠ¥æ–‡æ®µéƒ½è¿ç»­å‘é€å‡ºå»ï¼Œå¹¶å—åˆ°äº†å¯¹å·²å‘é€çš„æœ€åä¸€ä¸ªæŠ¥æ–‡æ®µçš„ç¡®è®¤</li></ul><p>æ‹¥å¡çª—å£ï¼š</p><ul><li>å®ƒä¼šéšç½‘ç»œæ‹¥å¡ç¨‹åº¦ï¼Œä»¥åŠæ‰€ä½¿ç”¨çš„æ‹¥å¡æ§åˆ¶ç®—æ³•åŠ¨æ€å˜åŒ–</li></ul><h4 id="æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…"><a href="#æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…" class="headerlink" title="æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…"></a>æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…</h4><h5 id="æ…¢å¼€å§‹ï¼ˆslow-startï¼‰"><a href="#æ…¢å¼€å§‹ï¼ˆslow-startï¼‰" class="headerlink" title="æ…¢å¼€å§‹ï¼ˆslow-startï¼‰"></a>æ…¢å¼€å§‹ï¼ˆslow-startï¼‰</h5><ul><li>ç›®çš„ï¼šç”¨æ¥ç¡®å®šç½‘ç»œçš„è´Ÿè½½èƒ½åŠ›æˆ–æ‹¥å¡ç¨‹åº¦ã€‚</li><li>ç®—æ³•çš„æ€è·¯ï¼šç”±å°åˆ°å¤§é€æ¸å¢å¤§æ‹¥å¡çª—å£æ•°å€¼ã€‚</li><li>ä¸¤ä¸ªå˜é‡ï¼š<ul><li><strong>æ‹¥å¡çª—å£ï¼ˆcwndï¼‰</strong>ï¼šåˆå§‹æ‹¥å¡çª—å£å€¼ï¼š2 ç§è®¾ç½®æ–¹æ³•ã€‚çª—å£å€¼é€æ¸å¢å¤§ã€‚<ul><li>1 è‡³ 2 ä¸ªæœ€å¤§æŠ¥æ–‡æ®µ ï¼ˆæ—§æ ‡å‡†ï¼‰</li><li>2 è‡³ 4 ä¸ªæœ€å¤§æŠ¥æ–‡æ®µ ï¼ˆRFC 5681ï¼‰</li></ul></li><li><strong>æ…¢å¼€å§‹é—¨é™ï¼ˆssthreshï¼‰</strong>ï¼šé˜²æ­¢æ‹¥å¡çª—å£å¢é•¿è¿‡å¤§å¼•èµ·ç½‘ç»œæ‹¥å¡ã€‚</li></ul></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-47dba7f2068f35df.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-1bca665e8eaa965a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/713/format/webp" alt="img"></p><blockquote><p>å›¾ä¸­swndæ˜¯å‘é€çª—å£</p><p>æ¯ç»è¿‡ä¸€ä¸ªä¼ è¾“è½®æ¬¡ï¼Œæ‹¥å¡çª—å£å°±åŠ å€</p><p>çª—å£å¤§å°æŒ‰<strong>æŒ‡æ•°å¢åŠ </strong>ï¼Œ2çš„n-1æ¬¡æ–¹</p></blockquote><h5 id="æ‹¥å¡é¿å…ï¼ˆcongestion-avoidanceï¼‰"><a href="#æ‹¥å¡é¿å…ï¼ˆcongestion-avoidanceï¼‰" class="headerlink" title="æ‹¥å¡é¿å…ï¼ˆcongestion avoidanceï¼‰"></a>æ‹¥å¡é¿å…ï¼ˆcongestion avoidanceï¼‰</h5><ul><li>æ€è·¯ï¼šè®©æ‹¥å¡çª—å£ cwnd <strong>ç¼“æ…¢åœ°å¢å¤§</strong>ï¼Œé¿å…å‡ºç°æ‹¥å¡ã€‚</li><li>æ¯ç»è¿‡ä¸€ä¸ªä¼ è¾“è½®æ¬¡ï¼Œæ‹¥å¡çª—å£ <strong>cwnd &#x3D; cwnd + 1</strong>ã€‚</li><li>ä½¿æ‹¥å¡çª—å£ cwnd æŒ‰çº¿æ€§è§„å¾‹ç¼“æ…¢å¢é•¿ã€‚</li><li>åœ¨æ‹¥å¡é¿å…é˜¶æ®µï¼Œå…·æœ‰ â€œ<strong>åŠ æ³•å¢å¤§</strong>â€ (Additive Increase) çš„ç‰¹ç‚¹ã€‚</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-28dacc122d9ef398.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>å¦‚æœåœ¨å‘é€è¿‡ç¨‹ä¸­å‡ºç°éƒ¨åˆ†æŠ¥æ–‡æ®µä¸¢å¤±ï¼Œè¿™å¿…ç„¶ä¼šé€ æˆå‘é€æ–¹å¯¹è¿™äº›ä¸¢å¤±æŠ¥æ–‡æ®µçš„è¶…æ—¶é‡ä¼ </p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-c35271774108d273.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>è¿™ä¸ªæ—¶å€™åˆå›åˆ°äº†æ…¢å¼€å§‹</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-233c4e9e061dc1d1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-98094e880a6fad4e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h5 id="ä¸¤ä¸ªç®—æ³•å®Œæ•´ç¤ºæ„å›¾"><a href="#ä¸¤ä¸ªç®—æ³•å®Œæ•´ç¤ºæ„å›¾" class="headerlink" title="ä¸¤ä¸ªç®—æ³•å®Œæ•´ç¤ºæ„å›¾"></a>ä¸¤ä¸ªç®—æ³•å®Œæ•´ç¤ºæ„å›¾</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f5db7ea25d8aca73.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="å¿«é‡ä¼ å’Œå¿«æ¢å¤"><a href="#å¿«é‡ä¼ å’Œå¿«æ¢å¤" class="headerlink" title="å¿«é‡ä¼ å’Œå¿«æ¢å¤"></a>å¿«é‡ä¼ å’Œå¿«æ¢å¤</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-fee86fb3707a175c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h5 id="å¿«é‡ä¼ ï¼ˆfast-retrasmitï¼‰"><a href="#å¿«é‡ä¼ ï¼ˆfast-retrasmitï¼‰" class="headerlink" title="å¿«é‡ä¼ ï¼ˆfast retrasmitï¼‰"></a>å¿«é‡ä¼ ï¼ˆfast retrasmitï¼‰</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-a57c7cc819aa4bae.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h5 id="å¿«æ¢å¤ï¼ˆfast-recoveryï¼‰"><a href="#å¿«æ¢å¤ï¼ˆfast-recoveryï¼‰" class="headerlink" title="å¿«æ¢å¤ï¼ˆfast recoveryï¼‰"></a>å¿«æ¢å¤ï¼ˆfast recoveryï¼‰</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-ab5a63efbd586eb8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="æ”¹è¿›åçš„æ•´ä½“ç®—æ³•çš„ç¤ºæ„å›¾"><a href="#æ”¹è¿›åçš„æ•´ä½“ç®—æ³•çš„ç¤ºæ„å›¾" class="headerlink" title="æ”¹è¿›åçš„æ•´ä½“ç®—æ³•çš„ç¤ºæ„å›¾"></a>æ”¹è¿›åçš„æ•´ä½“ç®—æ³•çš„ç¤ºæ„å›¾</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-8f61b8eddb5b2624.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><hr><h3 id="TCPè¶…æ—¶é‡ä¼ æ—¶é—´çš„é€‰æ‹©"><a href="#TCPè¶…æ—¶é‡ä¼ æ—¶é—´çš„é€‰æ‹©" class="headerlink" title="TCPè¶…æ—¶é‡ä¼ æ—¶é—´çš„é€‰æ‹©"></a>TCPè¶…æ—¶é‡ä¼ æ—¶é—´çš„é€‰æ‹©</h3><p><img src="https://upload-images.jianshu.io/upload_images/24878825-855245410fc0ff17.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>å¦‚æœè¶…æ—¶é‡ä¼ æ—¶é—´RTOçš„å€¼è®¾ç½®å¾—æ¯”RTT0çš„å€¼å°å¾ˆå¤šï¼Œè¿™ä¼šå¼•èµ·æŠ¥æ–‡æ®µä¸å¿…è¦çš„é‡ä¼ ï¼Œä½¿ç½‘ç»œè´Ÿè·å¢å¤§</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-789e0116477a41df.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>å¦‚æœè¶…æ—¶é‡ä¼ æ—¶é—´RTOçš„å€¼è®¾ç½®å¾—è¿œå¤§äºRTT0çš„å€¼ï¼Œè¿™ä¼šä½¿é‡ä¼ æ—¶é—´æ¨è¿Ÿçš„å¤ªé•¿ï¼Œä½¿ç½‘ç»œçš„ç©ºé—²æ—¶é—´å¢å¤§ï¼Œé™ä½ä¼ è¾“æ•ˆç‡</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-994128acb2576516.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-20d1cf6bb211fe7e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>RFC6298å»ºè®®ä½¿ç”¨ä¸‹å¼è®¡ç®—è¶…æ—¶é‡ä¼ æ—¶é—´RTO</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-39ab62874e65b623.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>å¾€è¿”æ—¶é—´RTTçš„æµ‹é‡æ¯”è¾ƒå¤æ‚</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d454ebe83c1133ef.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-dbc63525eab966e1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>TCPè¶…æ—¶é‡ä¼ çš„è®¡ç®—</strong></p><p>ä¸¾ä¾‹</p><p>RTTdçš„RTTsæ˜¯ä¸Šä¸€ä¸ªçš„RTTs.</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-7d23bd8b0a165628.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>æ€»ç»“</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-c94fa8a3ad6b277f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><hr><h3 id="TCPå¯é ä¼ è¾“çš„å®ç°"><a href="#TCPå¯é ä¼ è¾“çš„å®ç°" class="headerlink" title="TCPå¯é ä¼ è¾“çš„å®ç°"></a>TCPå¯é ä¼ è¾“çš„å®ç°</h3><p><a href="https://links.jianshu.com/go?to=https://www.bilibili.com/video/BV1c4411d7jb?p=63">æœ¬é›†å…·ä½“è®²è§£</a></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6d10ea76a1ea032b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-92d975bc880db892.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-35bff0a8cc5b0d71.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><hr><h3 id="TCPçš„è¿è¾“è¿æ¥ç®¡ç†"><a href="#TCPçš„è¿è¾“è¿æ¥ç®¡ç†" class="headerlink" title="TCPçš„è¿è¾“è¿æ¥ç®¡ç†"></a>TCPçš„è¿è¾“è¿æ¥ç®¡ç†</h3><h4 id="æ¦‚å¿µ-6"><a href="#æ¦‚å¿µ-6" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-e7d2329746de8e6a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="TCPçš„è¿æ¥å»ºç«‹"><a href="#TCPçš„è¿æ¥å»ºç«‹" class="headerlink" title="TCPçš„è¿æ¥å»ºç«‹"></a>TCPçš„è¿æ¥å»ºç«‹</h4><ul><li>TCP å»ºç«‹è¿æ¥çš„è¿‡ç¨‹å«åš<strong>æ¡æ‰‹</strong>ã€‚</li><li>æ¡æ‰‹éœ€è¦åœ¨å®¢æˆ·å’ŒæœåŠ¡å™¨ä¹‹é—´äº¤æ¢ä¸‰ä¸ª TCP æŠ¥æ–‡æ®µã€‚ç§°ä¹‹ä¸º<strong>ä¸‰æŠ¥æ–‡æ¡æ‰‹</strong>ã€‚</li><li>é‡‡ç”¨<strong>ä¸‰æŠ¥æ–‡æ¡æ‰‹</strong>ä¸»è¦æ˜¯ä¸ºäº†é˜²æ­¢å·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µçªç„¶åˆä¼ é€åˆ°äº†ï¼Œå› è€Œäº§ç”Ÿé”™è¯¯ã€‚</li></ul><h5 id="TCPçš„è¿æ¥å»ºç«‹è¦è§£å†³ä»¥ä¸‹ä¸‰ä¸ªé—®é¢˜"><a href="#TCPçš„è¿æ¥å»ºç«‹è¦è§£å†³ä»¥ä¸‹ä¸‰ä¸ªé—®é¢˜" class="headerlink" title="TCPçš„è¿æ¥å»ºç«‹è¦è§£å†³ä»¥ä¸‹ä¸‰ä¸ªé—®é¢˜"></a>TCPçš„è¿æ¥å»ºç«‹è¦è§£å†³ä»¥ä¸‹ä¸‰ä¸ªé—®é¢˜</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-84c2b6dbb20379bd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h5 id="TCPä½¿ç”¨â€œä¸‰æŠ¥æ–‡æ¡æ‰‹â€å»ºç«‹è¿æ¥"><a href="#TCPä½¿ç”¨â€œä¸‰æŠ¥æ–‡æ¡æ‰‹â€å»ºç«‹è¿æ¥" class="headerlink" title="TCPä½¿ç”¨â€œä¸‰æŠ¥æ–‡æ¡æ‰‹â€å»ºç«‹è¿æ¥"></a>TCPä½¿ç”¨â€œä¸‰æŠ¥æ–‡æ¡æ‰‹â€å»ºç«‹è¿æ¥</h5><ul><li>TCP è¿æ¥çš„å»ºç«‹<strong>é‡‡ç”¨å®¢æˆ·æœåŠ¡å™¨æ–¹å¼</strong>ã€‚</li><li>ä¸»åŠ¨å‘èµ·è¿æ¥å»ºç«‹çš„åº”ç”¨è¿›ç¨‹å«åš<strong>TCPå®¢æˆ·</strong> (client)ã€‚</li><li>è¢«åŠ¨ç­‰å¾…è¿æ¥å»ºç«‹çš„åº”ç”¨è¿›ç¨‹å«åš<strong>TCPæœåŠ¡å™¨</strong> (server)ã€‚</li></ul><p>â€œæ¡æ‰‹â€éœ€è¦åœ¨TCPå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´äº¤æ¢ä¸‰ä¸ªTCPæŠ¥æ–‡æ®µ</p><p>è¿‡ç¨‹</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-9f509a892fb0f5c1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>æœ€åˆä¸¤ç«¯çš„TCPè¿›ç¨‹éƒ½å¤„äºå…³é—­çŠ¶æ€</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-e69d0e450b080e1f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä¸€å¼€å§‹ï¼ŒTCPæœåŠ¡å™¨è¿›ç¨‹é¦–å…ˆåˆ›å»ºä¼ è¾“æ§åˆ¶å—ï¼Œç”¨æ¥å­˜å‚¨TCPè¿æ¥ä¸­çš„ä¸€äº›é‡è¦ä¿¡æ¯ã€‚ä¾‹å¦‚TCPè¿æ¥è¡¨ã€æŒ‡å‘å‘é€å’Œæ¥æ”¶ç¼“å­˜çš„æŒ‡é’ˆã€æŒ‡å‘é‡ä¼ é˜Ÿåˆ—çš„æŒ‡é’ˆï¼Œå½“å‰çš„å‘é€å’Œæ¥æ”¶åºå·ç­‰</p><p>ä¹‹åï¼Œå°±å‡†å¤‡æ¥å—TCPå®¢æˆ·ç«¯è¿›ç¨‹çš„è¿æ¥è¯·æ±‚</p><p>æ­¤æ—¶ï¼ŒTCPæœåŠ¡å™¨è¿›ç¨‹å°±è¿›å…¥ç›‘å¬çŠ¶æ€ï¼Œç­‰å¾…TCPå®¢æˆ·ç«¯è¿›ç¨‹çš„è¿æ¥è¯·æ±‚</p></blockquote><p>TCPæœåŠ¡å™¨è¿›ç¨‹æ˜¯è¢«åŠ¨ç­‰å¾…æ¥è‡ªTCPå®¢æˆ·ç«¯è¿›ç¨‹çš„è¿æ¥è¯·æ±‚ï¼Œå› æ­¤æˆä¸º<strong>è¢«åŠ¨æ‰“å¼€</strong>è¿æ¥</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-9e597559ec8fcae8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>TCPå®¢æˆ·è¿›ç¨‹ä¹Ÿæ˜¯é¦–å…ˆåˆ›å»ºä¼ è¾“æ§åˆ¶å—</p></blockquote><p>ç”±äºTCPè¿æ¥å»ºç«‹æ˜¯ç”±TCPå®¢æˆ·ç«¯ä¸»åŠ¨å‘èµ·çš„ï¼Œå› æ­¤ç§°ä¸º<strong>ä¸»åŠ¨æ‰“å¼€</strong>è¿æ¥</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-46865d700124bfd1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ç„¶åï¼Œåœ¨æ‰“ç®—å»ºç«‹TCPè¿æ¥æ—¶ï¼Œå‘TCPæœåŠ¡å™¨è¿›ç¨‹å‘é€TCPè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µï¼Œå¹¶è¿›å…¥åŒæ­¥å·²å‘é€çŠ¶æ€</p><p>TCPè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µé¦–éƒ¨ä¸­</p><ul><li><p>åŒæ­¥ä½SYNè¢«è®¾ç½®ä¸º1ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªTCPè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µ</p></li><li><p>åºå·å­—æ®µseqè¢«è®¾ç½®äº†ä¸€ä¸ªåˆå§‹å€¼xï¼Œä½œä¸ºTCPå®¢æˆ·ç«¯è¿›ç¨‹æ‰€é€‰æ‹©çš„åˆå§‹åºå·</p></li></ul><p>è¯·æ³¨æ„ï¼šTCPè§„å®šSYNè¢«è®¾ç½®ä¸º1çš„æŠ¥æ–‡æ®µä¸èƒ½æºå¸¦æ•°æ®ï¼Œä½†è¦æ¶ˆè€—æ‰ä¸€ä¸ªåºå·</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f8dec0443dc56584.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>TCPæœåŠ¡å™¨è¿›ç¨‹æ”¶åˆ°TCPè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µåï¼Œå¦‚æœåŒæ„å»ºç«‹è¿æ¥ï¼Œåˆ™å‘TCPå®¢æˆ·è¿›ç¨‹å‘é€TCPè¿æ¥è¯·æ±‚ç¡®è®¤æŠ¥æ–‡æ®µï¼Œå¹¶è¿›å…¥åŒæ­¥å·²æ¥æ”¶çŠ¶æ€</p><p>TCPè¿æ¥è¯·æ±‚ç¡®è®¤æŠ¥æ–‡æ®µé¦–éƒ¨ä¸­</p><ul><li><p>åŒæ­¥ä½SYNå’Œç¡®è®¤ä¸ºACKéƒ½è®¾ç½®ä¸º1ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªTCPè¿æ¥è¯·æ±‚ç¡®è®¤æŠ¥æ–‡æ®µ</p></li><li><p>åºå·å­—æ®µseqè¢«è®¾ç½®äº†ä¸€ä¸ªåˆå§‹å€¼yï¼Œä½œä¸ºTCPæœåŠ¡å™¨è¿›ç¨‹æ‰€é€‰æ‹©çš„åˆå§‹åºå·ï¼Œ</p></li><li><p>ç¡®è®¤å·å­—æ®µackçš„å€¼è¢«è®¾ç½®æˆäº†x+1ï¼Œè¿™æ˜¯å¯¹TCPå®¢æˆ·è¿›ç¨‹æ‰€é€‰æ‹©çš„åˆå§‹åºå·ï¼ˆseqï¼‰çš„ç¡®è®¤</p></li></ul><p>è¯·æ³¨æ„ï¼šè¿™ä¸ªæŠ¥æ–‡æ®µä¹Ÿä¸èƒ½æºå¸¦æ•°æ®ï¼Œå› ä¸ºå®ƒæ˜¯SYNè¢«è®¾ç½®ä¸º1çš„æŠ¥æ–‡æ®µï¼Œä½†åŒæ ·è¦æ¶ˆè€—æ‰ä¸€ä¸ªåºå·</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-c6b6b91049a352db.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>TCPå®¢æˆ·è¿›ç¨‹æ”¶åˆ°TCPè¿æ¥è¯·æ±‚ç¡®è®¤æŠ¥æ–‡æ®µåï¼Œè¿˜è¦å‘TCPæœåŠ¡å™¨è¿›ç¨‹å‘é€ä¸€ä¸ªæ™®é€šçš„TCPç¡®è®¤æŠ¥æ–‡æ®µï¼Œå¹¶è¿›å…¥è¿æ¥å·²è¿æ¥çŠ¶æ€</p><p>æ™®é€šçš„TCPç¡®è®¤æŠ¥æ–‡æ®µé¦–éƒ¨ä¸­</p><ul><li><p>ç¡®è®¤ä½ACKè¢«è®¾ç½®ä¸º1ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªæ™®é€šçš„TCPç¡®è®¤æŠ¥æ–‡æ®µ</p></li><li><p>åºå·å­—æ®µseqè¢«è®¾ç½®ä¸ºx+1ï¼Œè¿™æ˜¯å› ä¸ºTCPå®¢æˆ·è¿›ç¨‹å‘é€çš„ç¬¬ä¸€ä¸ªTCPæŠ¥æ–‡æ®µçš„åºå·ä¸ºxï¼Œæ‰€ä»¥TCPå®¢æˆ·è¿›ç¨‹å‘é€çš„ç¬¬äºŒä¸ªæŠ¥æ–‡æ®µçš„åºå·ä¸ºx+1</p></li><li><p>ç¡®è®¤å·å­—æ®µackè¢«è®¾ç½®ä¸ºy+1ï¼Œè¿™æ˜¯å¯¹TCPæœåŠ¡å™¨è¿›ç¨‹æ‰€é€‰æ‹©çš„åˆå§‹åºå·çš„ç¡®è®¤</p></li></ul><p>è¯·æ³¨æ„ï¼šTCPè§„å®šæ™®é€šçš„TCPç¡®è®¤æŠ¥æ–‡æ®µå¯ä»¥æºå¸¦æ•°æ®ï¼Œä½†å¦‚æœä¸æºå¸¦æ•°æ®ï¼Œåˆ™ä¸æ¶ˆè€—åºå·</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-987d5c8512392422.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>TCPæœåŠ¡å™¨è¿›ç¨‹æ”¶åˆ°è¯¥ç¡®è®¤æŠ¥æ–‡æ®µåä¹Ÿè¿›å…¥è¿æ¥å·²å»ºç«‹çŠ¶æ€</p><p>ç°åœ¨ï¼ŒTCPåŒæ–¹éƒ½è¿›å…¥äº†è¿æ¥å·²å»ºç«‹çŠ¶æ€ï¼Œå®ƒä»¬å¯ä»¥åŸºäºå·²å»ºç«‹å¥½çš„TCPè¿æ¥ï¼Œè¿›è¡Œå¯é çš„æ•°æ®ä¼ è¾“</p></blockquote><p>ä¸ºä»€ä¹ˆTCPå®¢æˆ·è¿›ç¨‹æœ€åè¿˜è¦å‘é€ä¸€ä¸ªæ™®é€šçš„TCPç¡®è®¤æŠ¥æ–‡æ®µï¼Ÿèƒ½å¦ä½¿ç”¨â€œä¸¤æŠ¥æ–‡æ¡æ‰‹â€å»ºç«‹è¿æ¥ï¼Ÿ</p><p>ä¸‹å›¾å®ä¾‹æ˜¯â€œä¸¤æŠ¥æ–‡æ¡æ‰‹â€</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-0a5773a600817c41.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä¸ºäº†é˜²æ­¢å·²ç»å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µçªç„¶åˆä¼ åˆ°æœåŠ¡ç«¯ï¼Œå› è€Œäº§ç”Ÿé”™è¯¯â€ï¼Œè¿™ç§æƒ…å†µæ˜¯ï¼šä¸€ç«¯(client)Aå‘å‡ºå»çš„ç¬¬ä¸€ä¸ªè¿æ¥è¯·æ±‚æŠ¥æ–‡å¹¶æ²¡æœ‰ä¸¢å¤±ï¼Œè€Œæ˜¯å› ä¸ºæŸäº›æœªçŸ¥çš„åŸå› åœ¨æŸä¸ªç½‘ç»œèŠ‚ç‚¹ä¸Šå‘ç”Ÿæ»ç•™ï¼Œå¯¼è‡´å»¶è¿Ÿåˆ°è¿æ¥é‡Šæ”¾ä»¥åçš„æŸä¸ªæ—¶é—´æ‰åˆ°è¾¾å¦ä¸€ç«¯(server)Bã€‚æœ¬æ¥è¿™æ˜¯ä¸€ä¸ªæ—©å·²å¤±æ•ˆçš„æŠ¥æ–‡æ®µï¼Œä½†æ˜¯Bæ”¶åˆ°æ­¤å¤±æ•ˆçš„æŠ¥æ–‡ä¹‹åï¼Œä¼šè¯¯è®¤ä¸ºæ˜¯Aå†æ¬¡å‘å‡ºçš„ä¸€ä¸ªæ–°çš„è¿æ¥è¯·æ±‚ï¼Œäºæ˜¯Bç«¯å°±å‘Aåˆå‘å‡ºç¡®è®¤æŠ¥æ–‡ï¼Œè¡¨ç¤ºåŒæ„å»ºç«‹è¿æ¥ã€‚å¦‚æœä¸é‡‡ç”¨â€œä¸‰æ¬¡æ¡æ‰‹â€ï¼Œé‚£ä¹ˆåªè¦Bç«¯å‘å‡ºç¡®è®¤æŠ¥æ–‡å°±ä¼šè®¤ä¸ºæ–°çš„è¿æ¥å·²ç»å»ºç«‹äº†ï¼Œä½†æ˜¯Aç«¯å¹¶æ²¡æœ‰å‘å‡ºå»ºç«‹è¿æ¥çš„è¯·æ±‚ï¼Œå› æ­¤ä¸ä¼šå»å‘Bç«¯å‘é€æ•°æ®ï¼ŒBç«¯æ²¡æœ‰æ”¶åˆ°æ•°æ®å°±ä¼šä¸€ç›´ç­‰å¾…ï¼Œè¿™æ ·Bç«¯å°±ä¼šç™½ç™½æµªè´¹æ‰å¾ˆå¤šèµ„æºã€‚<br> æ‰€ä»¥å¹¶ä¸<strong>å¤šä½™</strong>ï¼Œè¿™æ˜¯ä¸ºäº†é˜²æ­¢å·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µçªç„¶åˆä¼ é€åˆ°äº†TCPæœåŠ¡å™¨ï¼Œå› è€Œå¯¼è‡´é”™è¯¯</p></blockquote><h5 id="æ€»ç»“-11"><a href="#æ€»ç»“-11" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-3205fd7d7d75b62e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="TCPçš„è¿æ¥é‡Šæ”¾"><a href="#TCPçš„è¿æ¥é‡Šæ”¾" class="headerlink" title="TCPçš„è¿æ¥é‡Šæ”¾"></a>TCPçš„è¿æ¥é‡Šæ”¾</h4><ul><li>TCP è¿æ¥é‡Šæ”¾è¿‡ç¨‹æ¯”è¾ƒå¤æ‚ã€‚</li><li>æ•°æ®ä¼ è¾“ç»“æŸåï¼Œé€šä¿¡çš„åŒæ–¹éƒ½å¯é‡Šæ”¾è¿æ¥ã€‚</li><li>TCP è¿æ¥é‡Šæ”¾è¿‡ç¨‹æ˜¯<strong>å››æŠ¥æ–‡æ¡æ‰‹</strong>ã€‚</li></ul><h4 id="TCPé€šè¿‡â€œå››æŠ¥æ–‡æŒ¥æ‰‹â€æ¥é‡Šæ”¾è¿æ¥"><a href="#TCPé€šè¿‡â€œå››æŠ¥æ–‡æŒ¥æ‰‹â€æ¥é‡Šæ”¾è¿æ¥" class="headerlink" title="TCPé€šè¿‡â€œå››æŠ¥æ–‡æŒ¥æ‰‹â€æ¥é‡Šæ”¾è¿æ¥"></a>TCPé€šè¿‡â€œå››æŠ¥æ–‡æŒ¥æ‰‹â€æ¥é‡Šæ”¾è¿æ¥</h4><ul><li>TCP è¿æ¥çš„å»ºç«‹<strong>é‡‡ç”¨å®¢æˆ·æœåŠ¡å™¨æ–¹å¼</strong>ã€‚</li><li>ä¸»åŠ¨å‘èµ·è¿æ¥å»ºç«‹çš„åº”ç”¨è¿›ç¨‹å«åš<strong>TCPå®¢æˆ·</strong> (client)ã€‚</li><li>è¢«åŠ¨ç­‰å¾…è¿æ¥å»ºç«‹çš„åº”ç”¨è¿›ç¨‹å«åš<strong>TCPæœåŠ¡å™¨</strong> (server)ã€‚</li><li><strong>ä»»ä½•ä¸€æ–¹éƒ½å¯ä»¥åœ¨æ•°æ®ä¼ é€ç»“æŸåå‘å‡ºè¿æ¥é‡Šæ”¾çš„é€šçŸ¥</strong></li></ul><p>è¿‡ç¨‹</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d56a05b1da63bf01.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ç°åœ¨TCPå®¢æˆ·è¿›ç¨‹å’ŒTCPæœåŠ¡å™¨è¿›ç¨‹éƒ½å¤„äºè¿æ¥å·²å»ºç«‹çŠ¶æ€</p><p>TCPå®¢æˆ·è¿›ç¨‹çš„åº”ç”¨è¿›ç¨‹é€šçŸ¥å…¶ä¸»åŠ¨å…³é—­TCPè¿æ¥</p><p>TCPå®¢æˆ·è¿›ç¨‹ä¼šå‘é€TCPè¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µï¼Œå¹¶è¿›å…¥ç»ˆæ­¢ç­‰å¾…1çŠ¶æ€</p><p>TCPè¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µé¦–éƒ¨ä¸­</p><ul><li><p>ç»ˆæ­¢ä½FINå’Œç¡®è®¤ä¸ºACKçš„å€¼éƒ½è¢«è®¾ç½®ä¸º1ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªTCPè¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µï¼ŒåŒæ—¶ä¹Ÿå¯¹ä¹‹å‰æ”¶åˆ°çš„æŠ¥æ–‡æ®µè¿›è¡Œç¡®è®¤</p></li><li><p>åºå·seqå­—æ®µçš„å€¼è®¾ç½®ä¸ºuï¼Œå®ƒç­‰äºTCPå®¢æˆ·è¿›ç¨‹ä¹‹å‰å·²ä¼ é€è¿‡çš„æ•°æ®çš„æœ€åä¸€ä¸ªå­—èŠ‚çš„åºå·åŠ 1</p></li><li><p>ç¡®è®¤å·ackå­—æ®µçš„å€¼è®¾ç½®ä¸ºvï¼Œå®ƒç­‰äºTCPå®¢æˆ·è¿›ç¨‹ä¹‹å‰å·²æ”¶åˆ°çš„ã€æ•°æ®çš„æœ€åä¸€ä¸ªå­—èŠ‚çš„åºå·åŠ 1</p></li></ul><p>è¯·æ³¨æ„ï¼šTCPè§„å®šç»ˆæ­¢ä½FINç­‰äº1çš„æŠ¥æ–‡æ®µå³ä½¿ä¸æºå¸¦æ•°æ®ï¼Œä¹Ÿè¦æ¶ˆè€—æ‰ä¸€ä¸ªåºå·</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d8be7c2c584d245a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>TCPæœåŠ¡å™¨è¿›ç¨‹æ”¶åˆ°TCPè¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µåï¼Œä¼šå‘é€ä¸€ä¸ªæ™®é€šçš„TCPç¡®è®¤æŠ¥æ–‡æ®µå¹¶è¿›å…¥å…³é—­ç­‰å¾…çŠ¶æ€</p><p>æ™®é€šçš„TCPç¡®è®¤æŠ¥æ–‡æ®µé¦–éƒ¨ä¸­</p><ul><li><p>ç¡®è®¤ä½ACKçš„å€¼è¢«è®¾ç½®ä¸º1ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªæ™®é€šçš„TCPç¡®è®¤æŠ¥æ–‡æ®µ</p></li><li><p>åºå·seqå­—æ®µçš„å€¼è®¾ç½®ä¸ºvï¼Œå®ƒç­‰äºTCPæœåŠ¡å™¨è¿›ç¨‹ä¹‹å‰å·²ä¼ é€è¿‡çš„æ•°æ®çš„æœ€åä¸€ä¸ªå­—èŠ‚çš„åºå·åŠ 1ï¼Œè¿™ä¹Ÿä¸ä¹‹å‰æ”¶åˆ°çš„TCPè¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µä¸­çš„ç¡®è®¤å·åŒ¹é…</p></li><li><p>ç¡®è®¤å·ackå­—æ®µçš„å€¼è®¾ç½®ä¸ºu+1ï¼Œè¿™æ˜¯å¯¹TCPè¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µçš„ç¡®è®¤</p></li></ul></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-733705e761921b6b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>TCPæœåŠ¡å™¨è¿›ç¨‹åº”è¯¥é€šçŸ¥é«˜å±‚åº”ç”¨è¿›ç¨‹ï¼ŒTCPå®¢æˆ·è¿›ç¨‹è¦æ–­å¼€ä¸è‡ªå·±çš„TCPè¿æ¥</p><p>æ­¤æ—¶ï¼Œä»TCPå®¢æˆ·è¿›ç¨‹åˆ°TCPæœåŠ¡å™¨è¿›ç¨‹è¿™ä¸ªæ–¹å‘çš„è¿æ¥å°±é‡Šæ”¾äº†</p><p>è¿™æ—¶çš„TCPè¿æ¥å±äºåŠå…³é—­çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯TCPå®¢æˆ·è¿›ç¨‹å·²ç»æ²¡æœ‰æ•°æ®è¦å‘é€äº†</p><p>ä½†å¦‚æœTCPæœåŠ¡å™¨è¿›ç¨‹è¿˜æœ‰æ•°æ®è¦å‘é€ï¼ŒTCPå®¢æˆ·è¿›ç¨‹ä»è¦æ¥æ”¶ï¼Œä¹Ÿå°±æ˜¯è¯´ä»TCPæœåŠ¡å™¨è¿›ç¨‹åˆ°TCPå®¢æˆ·è¿›ç¨‹è¿™ä¸ªæ–¹å‘çš„è¿æ¥å¹¶æœªå…³é—­</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-583da1984154448c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>TCPå®¢æˆ·è¿›ç¨‹æ”¶åˆ°TCPç¡®è®¤æŠ¥æ–‡æ®µåå°±è¿›å…¥ç»ˆæ­¢ç­‰å¾…2çŠ¶æ€ï¼Œç­‰å¾…TCPæœåŠ¡å™¨è¿›ç¨‹å‘å‡ºçš„TCPè¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µ</p><p>è‹¥ä½¿ç”¨TCPæœåŠ¡å™¨è¿›ç¨‹çš„åº”ç”¨è¿›ç¨‹å·²ç»æ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œåº”ç”¨è¿›ç¨‹å°±é€šçŸ¥å…¶TCPæœåŠ¡å™¨è¿›ç¨‹é‡Šæ”¾è¿æ¥</p><p>ç”±äºTCPè¿æ¥é‡Šæ”¾æ˜¯ç”±TCPå®¢æˆ·è¿›ç¨‹ä¸»åŠ¨å‘èµ·çš„ï¼Œå› æ­¤TCPæœåŠ¡å™¨è¿›ç¨‹å¯¹TCPè¿æ¥çš„é‡Šæ”¾ç§°ä¸ºè¢«åŠ¨å…³é—­è¿æ¥</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-60b55978f2d24a50.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>TCPæœåŠ¡å™¨è¿›ç¨‹å‘é€TCPè¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µå¹¶è¿›å…¥æœ€åç¡®è®¤çŠ¶æ€</p><p>è¯¥æŠ¥æ–‡æ®µé¦–éƒ¨ä¸­</p><ul><li><p>ç»ˆæ­¢ä½FINå’Œç¡®è®¤ä½ACKçš„å€¼éƒ½è¢«è®¾ç½®ä¸º1ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªTCPè¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µï¼ŒåŒæ—¶ä¹Ÿå¯¹ä¹‹å‰æ”¶åˆ°çš„æŠ¥æ–‡æ®µè¿›è¡Œç¡®è®¤</p></li><li><p>åºå·seqå­—æ®µçš„å€¼ä¸ºwï¼Œè¿™æ˜¯å› ä¸ºåœ¨åŠå…³é—­çŠ¶æ€ä¸‹ï¼ŒTCPæœåŠ¡å™¨è¿›ç¨‹å¯èƒ½åˆå‘é€</p></li><li><p>ç¡®è®¤å·ackå­—æ®µçš„å€¼ä¸ºu+1ï¼Œè¿™æ˜¯å¯¹ä¹‹å‰æ”¶åˆ°çš„TCPè¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µçš„é‡å¤ç¡®è®¤</p></li></ul></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-1c5e0c6357d039ed.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>TCPå®¢æˆ·è¿›ç¨‹æ”¶åˆ°TCPè¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µåï¼Œå¿…é¡»é’ˆå¯¹è¯¥æŠ¥æ–‡æ®µå‘é€æ™®é€šçš„TCPç¡®è®¤æŠ¥æ–‡æ®µï¼Œä¹‹åè¿›å…¥æ—¶é—´ç­‰å¾…çŠ¶æ€</p><p>è¯¥æŠ¥æ–‡æ®µé¦–éƒ¨ä¸­</p><ul><li><p>ç¡®è®¤ä¸ºACKçš„å€¼è¢«è®¾ç½®ä¸º1ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªæ™®é€šçš„TCPç¡®è®¤æŠ¥æ–‡æ®µ</p></li><li><p>åºå·seqå­—æ®µçš„å€¼è®¾ç½®ä¸ºu+1ï¼Œè¿™æ˜¯å› ä¸ºTCPå®¢æˆ·è¿›ç¨‹ä¹‹å‰å‘é€çš„TCPè¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µè™½ç„¶ä¸æºå¸¦æ•°æ®ï¼Œä½†è¦æ¶ˆè€—æ‰ä¸€ä¸ªåºå·</p></li><li><p>ç¡®è®¤å·ackå­—æ®µçš„å€¼è®¾ç½®ä¸ºw+1ï¼Œè¿™æ˜¯å¯¹æ‰€æ”¶åˆ°çš„TCPè¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µçš„ç¡®è®¤</p></li></ul><p>TCPæœåŠ¡å™¨è¿›ç¨‹æ”¶åˆ°è¯¥æŠ¥æ–‡æ®µåå°±è¿›å…¥å…³é—­çŠ¶æ€ï¼Œè€ŒTCPå®¢æˆ·è¿›ç¨‹è¿˜è¦è¿›è¿‡2MSLåæ‰èƒ½è¿›å…¥å…³é—­çŠ¶æ€</p></blockquote><p>TCPå®¢æˆ·è¿›ç¨‹åœ¨å‘é€å®Œæœ€åä¸€ä¸ªç¡®è®¤æŠ¥æ–‡åï¼Œä¸ºä»€ä¹ˆä¸ç›´æ¥è¿›å…¥å…³é—­çŠ¶æ€ï¼Ÿè€Œæ˜¯è¦è¿›å…¥æ—¶é—´ç­‰å¾…çŠ¶æ€ï¼Ÿ</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-ef85470fe120f146.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>å› ä¸ºæ—¶é—´ç­‰å¾…çŠ¶æ€ä»¥åŠå¤„äºè¯¥çŠ¶æ€2MSLæ—¶é•¿ï¼Œå¯ä»¥ç¡®ä¿TCPæœåŠ¡å™¨è¿›ç¨‹å¯ä»¥æ”¶åˆ°æœ€åä¸€ä¸ªTCPç¡®è®¤æŠ¥æ–‡æ®µè€Œè¿›å…¥å…³é—­çŠ¶æ€</p><p>å¦å¤–ï¼ŒTCPå®¢æˆ·è¿›ç¨‹åœ¨å‘é€å®Œæœ€åä¸€ä¸ªTCPç¡®è®¤æŠ¥æ–‡æ®µåï¼Œåœ¨ç»è¿‡2MSLæ—¶é•¿ï¼Œå°±å¯ä»¥ä½¿æœ¬æ¬¡è¿æ¥æŒç»­æ—¶é—´å†…æ‰€äº§ç”Ÿçš„æ‰€æœ‰æŠ¥æ–‡æ®µéƒ½ä»ç½‘ç»œä¸­æ¶ˆå¤±ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ä¸‹ä¸€ä¸ªæ–°çš„TCPè¿æ¥ä¸­ï¼Œä¸ä¼šå‡ºç°æ—§è¿æ¥ä¸­çš„æŠ¥æ–‡æ®µ</p></blockquote><h4 id="TCPä¿æ´»è®¡æ—¶å™¨çš„ä½œç”¨"><a href="#TCPä¿æ´»è®¡æ—¶å™¨çš„ä½œç”¨" class="headerlink" title="TCPä¿æ´»è®¡æ—¶å™¨çš„ä½œç”¨"></a>TCPä¿æ´»è®¡æ—¶å™¨çš„ä½œç”¨</h4><p>TCPåŒæ–¹å·²ç»å»ºç«‹äº†è¿æ¥ï¼Œåæ¥ï¼ŒTCPå®¢æˆ·è¿›ç¨‹æ‰€åœ¨çš„ä¸»æœºçªç„¶å‡ºç°äº†æ•…éšœ</p><p>TCPæœåŠ¡å™¨è¿›ç¨‹ä»¥åå°±ä¸èƒ½å†æ”¶åˆ°TCPå®¢æˆ·è¿›ç¨‹å‘æ¥çš„æ•°æ®</p><p>å› æ­¤ï¼Œåº”å½“æœ‰æªæ–½ä½¿TCPæœåŠ¡å™¨è¿›ç¨‹ä¸è¦å†ç™½ç™½ç­‰å¾…ä¸‹å»</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-2dc97e06fe1d82ed.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><hr><h3 id="TCPæŠ¥æ–‡æ®µçš„é¦–éƒ¨æ ¼å¼"><a href="#TCPæŠ¥æ–‡æ®µçš„é¦–éƒ¨æ ¼å¼" class="headerlink" title="TCPæŠ¥æ–‡æ®µçš„é¦–éƒ¨æ ¼å¼"></a>TCPæŠ¥æ–‡æ®µçš„é¦–éƒ¨æ ¼å¼</h3><p><img src="https://upload-images.jianshu.io/upload_images/24878825-df9263a14e1da2c1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="å„å­—æ®µçš„ä½œç”¨-1"><a href="#å„å­—æ®µçš„ä½œç”¨-1" class="headerlink" title="å„å­—æ®µçš„ä½œç”¨"></a>å„å­—æ®µçš„ä½œç”¨</h4><p>æºç«¯å£å’Œç›®çš„ç«¯å£</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-27e4bd51d5db2f8e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>åºå·ã€ç¡®è®¤å·å’Œç¡®è®¤æ ‡å¿—ä½</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-fd0e64d8be3f598b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>æ•°æ®åç§»ã€ä¿ç•™ã€çª—å£å’Œæ ¡éªŒå’Œ</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d3d4c61af68fdb6d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>åŒæ­¥æ ‡å¿—ä½ã€ç»ˆæ­¢æ ‡å¿—ä½ã€å¤ä½æ ‡å¿—ä½ã€æ¨é€æ ‡å¿—ä½ã€ç´§æ€¥æ ‡å¿—ä½å’Œç´§æ€¥æŒ‡é’ˆ</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-f09bdaba863c4ca3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>é€‰é¡¹å’Œå¡«å……</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d1a8d3ca5ac7f39d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1185/format/webp" alt="img"></p><h2 id="å…­ã€åº”ç”¨å±‚"><a href="#å…­ã€åº”ç”¨å±‚" class="headerlink" title="å…­ã€åº”ç”¨å±‚"></a>å…­ã€åº”ç”¨å±‚</h2><h3 id="åº”ç”¨å±‚æ¦‚è¿°"><a href="#åº”ç”¨å±‚æ¦‚è¿°" class="headerlink" title="åº”ç”¨å±‚æ¦‚è¿°"></a>åº”ç”¨å±‚æ¦‚è¿°</h3><p><img src="https://upload-images.jianshu.io/upload_images/24878825-968c1bcea54ea1f4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-3d48b52ccf2bda5f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>æˆ‘ä»¬åœ¨æµè§ˆå™¨çš„åœ°å€ä¸­è¾“å…¥æŸä¸ªç½‘ç«™çš„åŸŸååï¼Œå°±å¯ä»¥è®¿é—®è¯¥ç½‘ç«™çš„å†…å®¹ï¼Œè¿™ä¸ªå°±æ˜¯<strong>ä¸‡ç»´ç½‘WWWåº”ç”¨</strong>ï¼Œå…¶ç›¸å…³çš„åº”ç”¨å±‚åè®®ä¸º<strong>è¶…æ–‡æœ¬ä¼ é€åè®®HTTP</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-877daae73d0011c0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>ç”¨æˆ·åœ¨æµè§ˆå™¨åœ°å€æ ä¸­è¾“å…¥çš„æ˜¯â€œè§åçŸ¥æ„â€çš„<strong>åŸŸå</strong>ï¼Œè€ŒTCP&#x2F;IPçš„ç½‘é™…å±‚ä½¿ç”¨<strong>IPåœ°å€</strong>æ¥è¡¨ç¤ºç›®çš„ä¸»æœºï¼Œä»åŸŸååˆ°IPåœ°å€çš„è£…è½¬æ¢ï¼Œç”±å±äº<strong>åº”ç”¨å±‚èŒƒç•´çš„åŸŸåç³»ç»ŸDNS</strong>ï¼Œåœ¨åå°å¸®ç”¨æˆ·å®Œæˆ</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-295acc2503d1ac7d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>å¸¸è§çš„åº”ç”¨</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-4e9858624d4835ae.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>æ€»ç»“</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-c1c3868fb5e127b1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><hr><h3 id="å®¢æˆ·-x2F-æœåŠ¡å™¨æ–¹å¼ï¼ˆCSï¼‰å’Œå¯¹ç­‰æ–¹å¼ï¼ˆP2Pï¼‰"><a href="#å®¢æˆ·-x2F-æœåŠ¡å™¨æ–¹å¼ï¼ˆCSï¼‰å’Œå¯¹ç­‰æ–¹å¼ï¼ˆP2Pï¼‰" class="headerlink" title="å®¢æˆ·&#x2F;æœåŠ¡å™¨æ–¹å¼ï¼ˆCSï¼‰å’Œå¯¹ç­‰æ–¹å¼ï¼ˆP2Pï¼‰"></a>å®¢æˆ·&#x2F;æœåŠ¡å™¨æ–¹å¼ï¼ˆCSï¼‰å’Œå¯¹ç­‰æ–¹å¼ï¼ˆP2Pï¼‰</h3><h4 id="æ¦‚å¿µ-7"><a href="#æ¦‚å¿µ-7" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-983cfa1e406fd20c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="å®¢æˆ·-x2F-æœåŠ¡å™¨æ–¹å¼ï¼ˆC-x2F-Sæ–¹å¼ï¼‰"><a href="#å®¢æˆ·-x2F-æœåŠ¡å™¨æ–¹å¼ï¼ˆC-x2F-Sæ–¹å¼ï¼‰" class="headerlink" title="å®¢æˆ·&#x2F;æœåŠ¡å™¨æ–¹å¼ï¼ˆC&#x2F;Sæ–¹å¼ï¼‰"></a>å®¢æˆ·&#x2F;æœåŠ¡å™¨æ–¹å¼ï¼ˆC&#x2F;Sæ–¹å¼ï¼‰</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-bbfb139bb8ffd796.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1189/format/webp" alt="img"></p><h4 id="å¯¹ç­‰æ–¹å¼ï¼ˆP2Pæ–¹å¼ï¼‰"><a href="#å¯¹ç­‰æ–¹å¼ï¼ˆP2Pæ–¹å¼ï¼‰" class="headerlink" title="å¯¹ç­‰æ–¹å¼ï¼ˆP2Pæ–¹å¼ï¼‰"></a>å¯¹ç­‰æ–¹å¼ï¼ˆP2Pæ–¹å¼ï¼‰</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-598b1158f5c33a11.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1184/format/webp" alt="img"></p><h4 id="æ€»ç»“-12"><a href="#æ€»ç»“-12" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-7fce507085bc7053.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1178/format/webp" alt="img"></p><hr><h3 id="åŠ¨æ€ä¸»æœºé…ç½®åè®®DHCP"><a href="#åŠ¨æ€ä¸»æœºé…ç½®åè®®DHCP" class="headerlink" title="åŠ¨æ€ä¸»æœºé…ç½®åè®®DHCP"></a>åŠ¨æ€ä¸»æœºé…ç½®åè®®DHCP</h3><h4 id="æ¦‚å¿µ-8"><a href="#æ¦‚å¿µ-8" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><ul><li>äº’è”ç½‘å¹¿æ³›ä½¿ç”¨çš„<strong>åŠ¨æ€ä¸»æœºé…ç½®åè®® DHCP</strong> (Dynamic Host Configuration Protocol) æä¾›äº†<strong>å³æ’å³ç”¨è¿ç½‘</strong> (plug-and-play networking) çš„æœºåˆ¶ã€‚</li><li>è¿™ç§æœºåˆ¶å…è®¸ä¸€å°è®¡ç®—æœºåŠ å…¥æ–°çš„ç½‘ç»œå’Œè·å– IP åœ°å€ï¼Œè€Œä¸ç”¨æ‰‹å·¥é…ç½®ã€‚</li></ul><h4 id="DHCPçš„ä½œç”¨"><a href="#DHCPçš„ä½œç”¨" class="headerlink" title="DHCPçš„ä½œç”¨"></a>DHCPçš„ä½œç”¨</h4><p>åœ¨ä¹‹å‰ï¼Œå¦‚æœè¦æ­£å¸¸è®¿é—®WebæœåŠ¡å™¨ï¼Œéœ€è¦è¯¥ä¸»æœºæ‰‹åŠ¨é…ç½®ç½‘ç»œçš„ç›¸å…³é…ç½®ä¿¡æ¯</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-5b86de9e3dfe3c59.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>å¦‚æœä¸»æœºæ•°å¾ˆå¤šï¼Œå°±å·¥ä½œé‡å¤§ï¼Œå®¹æ˜“å‡ºé”™</p></blockquote><p>å¦‚æœæˆ‘ä»¬ç»™ç½‘ç»œä¸­æ·»åŠ ä¸€å°DHCPæœåŠ¡å™¨</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-4d701885461e9193.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="DHCPçš„å·¥ä½œè¿‡ç¨‹"><a href="#DHCPçš„å·¥ä½œè¿‡ç¨‹" class="headerlink" title="DHCPçš„å·¥ä½œè¿‡ç¨‹"></a>DHCPçš„å·¥ä½œè¿‡ç¨‹</h4><p><strong>DHCP ä½¿ç”¨å®¢æˆ· - æœåŠ¡å™¨æ–¹å¼</strong></p><ul><li>éœ€è¦ IP åœ°å€çš„ä¸»æœºåœ¨å¯åŠ¨æ—¶å°±å‘ DHCP æœåŠ¡å™¨å¹¿æ’­å‘é€å‘ç°æŠ¥æ–‡  ï¼ˆDHCP DISCOVERï¼‰ï¼Œè¿™æ—¶è¯¥ä¸»æœºå°±æˆä¸º DHCP å®¢æˆ·ã€‚</li><li>æœ¬åœ°ç½‘ç»œä¸Šæ‰€æœ‰ä¸»æœºéƒ½èƒ½æ”¶åˆ°æ­¤å¹¿æ’­æŠ¥æ–‡ï¼Œä½†åªæœ‰ DHCP æœåŠ¡å™¨æ‰å›ç­”æ­¤å¹¿æ’­æŠ¥æ–‡ã€‚</li><li>DHCP æœåŠ¡å™¨å…ˆåœ¨å…¶æ•°æ®åº“ä¸­æŸ¥æ‰¾è¯¥è®¡ç®—æœºçš„é…ç½®ä¿¡æ¯ã€‚è‹¥æ‰¾åˆ°ï¼Œåˆ™è¿”å›æ‰¾åˆ°çš„ä¿¡æ¯ã€‚è‹¥æ‰¾ä¸åˆ°ï¼Œåˆ™ä»æœåŠ¡å™¨çš„ IP åœ°å€æ±  (address pool) ä¸­å–ä¸€ä¸ªåœ°å€åˆ†é…ç»™è¯¥è®¡ç®—æœºã€‚DHCPæœåŠ¡å™¨çš„å›ç­”æŠ¥æ–‡å«åšæä¾›æŠ¥æ–‡ï¼ˆDHCP OFFERï¼‰ã€‚</li></ul><p><strong>DHCP å·¥ä½œæ–¹å¼</strong></p><ul><li>DHCP ä½¿ç”¨å®¢æˆ·-æœåŠ¡å™¨æ–¹å¼ï¼Œé‡‡ç”¨è¯·æ±‚&#x2F;åº”ç­”æ–¹å¼å·¥ä½œã€‚</li><li>DHCP åŸºäº UDP å·¥ä½œï¼ˆDHCPæŠ¥æ–‡åœ¨è¿è¾“å±‚ä¼šè¢«å°è£…æˆä¸ºUDPç”¨æˆ·æ•°æ®æŠ¥ï¼‰ï¼ŒDHCP æœåŠ¡å™¨è¿è¡Œåœ¨ 67 å·ç«¯å£ï¼Œ DHCPå®¢æˆ·è¿è¡Œåœ¨ 68 å·ç«¯å£ã€‚</li></ul><p><strong>DHCPäº¤äº’è¿‡ç¨‹</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-6f9a9715f8b1c74a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p><strong>DHCPå®¢æˆ·ç«¯å°†å¹¿æ’­å‘é€DHCPå‘ç°æŠ¥æ–‡ï¼ˆDHCP DISCOVERï¼‰</strong></p><ul><li><p>äº‹åŠ¡ID</p></li><li><p>DHCPå®¢æˆ·ç«¯çš„MACåœ°å€</p></li></ul><p><strong>å°è£…è¯¥æŠ¥æ–‡çš„IPæ•°æ®æŠ¥çš„æºIPåœ°å€ä¸º0.0.0.0ï¼Œè¿™æ˜¯å› ä¸ºä¸»æœºç›®å‰è¿˜æœªåˆ†é…åˆ°IPåœ°å€</strong>ï¼Œå› æ­¤ä½¿ç”¨è¯¥åœ°å€ä»£æ›¿</p><p><strong>ç›®çš„IPåœ°å€ä¸ºå¹¿æ’­åœ°å€255.255.255.255ï¼Œä¹‹æ‰€ä»¥å¹¿æ’­å‘é€ï¼Œæ˜¯å› ä¸ºä¸»æœºç°åœ¨å¹¶ä¸çŸ¥é“ç½‘ç»œä¸­æœ‰å“ªå‡ ä¸ªDHCPæœåŠ¡å™¨</strong>ã€‚å®ƒä»¬çš„IPåœ°å€å„æ˜¯ä»€ä¹ˆ</p><p><strong>DHCPæœåŠ¡å™¨æ”¶åˆ°DHCPå‘ç°æŠ¥æ–‡åï¼Œæ ¹æ®å…¶ä¸­å°è£…çš„DHCPå®¢æˆ·ç«¯çš„MACåœ°å€æ¥æŸ¥æ‰¾è‡ªå·±çš„æ•°æ®åº“</strong>ï¼Œå¦‚æœæŸ¥åˆ°åŒ¹é…ä¿¡æ¯ï¼Œåˆ™ä½¿ç”¨è¿™äº›é…ç½®ä¿¡æ¯æ¥æ„å»ºå¹¶å‘é€DHCPæä¾›æŠ¥æ–‡ï¼Œå¦‚æœæ²¡æœ‰åˆ™é‡‡ç”¨é»˜è®¤é…ç½®ä¿¡æ¯æ¥æ„å»ºæŠ¥æ–‡å¹¶å‘é€</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-03ecd6d2838d4274.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p><strong>DHCPæœåŠ¡ç«¯å°†å¹¿æ’­å‘é€DHCPæä¾›æŠ¥æ–‡ï¼ˆDHCP OFFERï¼‰</strong></p><ul><li><p>äº‹åŠ¡IDï¼šDHCPå®¢æˆ·ç«¯ä¼šä¸ä¹‹å‰DHCPå‘ç°æŠ¥æ–‡çš„äº‹åŠ¡IDåšå¯¹æ¯”ï¼Œæ¥åˆ¤æ–­è¯¥DHCPæä¾›æŠ¥æ–‡æ˜¯å¦æ˜¯è‡ªå·±çš„</p></li><li><p>é…ç½®ä¿¡æ¯ï¼š</p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">*   IPåœ°å€ï¼šDHCPæœåŠ¡å™¨ä»è‡ªå·±çš„IPåœ°å€æ± ä¸­æŒ‘é€‰å¾…ç§Ÿç”¨ç»™ä¸»æœºçš„IPåœ°å€ï¼ˆä½¿ç”¨ARPæ¥ç¡®ä¿æ‰€é€‰IPåœ°å€æœªè¢«ç½‘ç»œä¸­å…¶ä»–ä¸»æœºå ç”¨ï¼‰  </span><br><span class="line">*   å­ç½‘æ©ç </span><br><span class="line">*   åœ°å€ç§ŸæœŸ  </span><br><span class="line">*   é»˜è®¤ç½‘å…³  </span><br><span class="line">*   DNSæœåŠ¡å™¨</span><br></pre></td></tr></table></figure><p>æºIPåœ°å€ï¼šå‘é€DHCPæä¾›æŠ¥æ–‡çš„DHCPæœåŠ¡å™¨çš„IP</p><p>ç›®çš„åœ°å€ï¼šå› ä¸ºç›®çš„ä¸»æœºè¿˜æ²¡åˆ†é…åˆ°IPï¼Œæ‰€ä»¥ä½¿ç”¨å¹¿æ’­åœ°å€</p></blockquote><p>åœ¨æœ¬ä¾‹ä¸­ï¼ŒDHCPå®¢æˆ·ä¼šæ”¶åˆ°ä¸¤ä¸ªDHCPæœåŠ¡å™¨å‘æ¥çš„DHCPæä¾›æŠ¥æ–‡ï¼ŒDHCPå®¢æˆ·ä»ä¸­é€‰æ‹©ä¸€ä¸ªï¼Œä¸€èˆ¬é€‰æ‹©å…ˆåˆ°çš„ï¼Œå¹¶å‘æ‰€é€‰æ‹©çš„DHCPæœåŠ¡å™¨å‘é€DHCPè¯·æ±‚æŠ¥æ–‡</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-009b1e9a88976880.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p><strong>DHCPå®¢æˆ·ç«¯å°†å¹¿æ’­å‘é€DHCPè¯·æ±‚æŠ¥æ–‡ï¼ˆDHCP REQUESTï¼‰</strong></p><ul><li><p>äº‹åŠ¡ID</p></li><li><p>DHCPå®¢æˆ·ç«¯çš„MACåœ°å€</p></li><li><p>æ¥æ”¶çš„ç§Ÿçº¦ä¸­çš„IPåœ°å€</p></li><li><p>æä¾›æ­¤ç§Ÿçº¦çš„DHCPæœåŠ¡å™¨ç«¯çš„IPåœ°å€</p></li></ul><p>æºåœ°å€ï¼š0.0.0.0ï¼Œå› ä¸ºæ­¤æ—¶DHCPå®¢æˆ·æ‰ä»å¤šä¸ªDHCPæœåŠ¡å™¨ä¸­æŒ‘é€‰ä¸€ä¸ªä½œä¸ºè‡ªå·±çš„DHCPæœåŠ¡å™¨ã€‚å®ƒé¦–å…ˆè¦å¾å¾—è¯¥æœåŠ¡å™¨çš„åŒæ„ï¼Œä¹‹åæ‰èƒ½æ­£å¼ä½¿ç”¨å‘è¯¥DHCPæœåŠ¡å™¨ç§Ÿç”¨çš„IPåœ°å€</p><p>ç›®çš„åœ°å€ï¼šå¹¿æ’­åœ°å€ï¼Œè¿™æ ·å¯ä»¥ä¸€æ¬¡æ€§å‘æ‰€æœ‰DHCPæœåŠ¡å™¨å‘é€DHCPè¯·æ±‚æŠ¥æ–‡ï¼Œæ¥å‘ŠçŸ¥å®ƒä»¬æ˜¯å¦è¯·æ±‚å®ƒä»¬ä½œä¸ºè‡ªå·±çš„DHCPæœåŠ¡å™¨</p></blockquote><p>åœ¨æœ¬ä¾‹ä¸­ï¼Œå‡è®¾DHCPå®¢æˆ·ç«¯é€‰æ‹©DHCPæœåŠ¡å™¨1ä½œä¸ºè‡ªå·±çš„DHCPæœåŠ¡å™¨ï¼ŒDHCPæœåŠ¡å™¨1æ¥å—è¯¥è¯·æ±‚ï¼Œäºæ˜¯DHCPæœåŠ¡å™¨1ç»™DHCPå®¢æˆ·ç«¯å‘é€DHCPç¡®è®¤æŠ¥æ–‡</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-35c9002bba766476.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>æºåœ°å€ï¼šDHCPæœåŠ¡å™¨1çš„IPåœ°å€</p><p>ç›®çš„åœ°å€ï¼šå¹¿æ’­åœ°å€</p><p><strong>DHCPå®¢æˆ·æ”¶åˆ°è¯¥æŠ¥æ–‡åå°±å¯ä»¥ä½¿ç”¨ç§Ÿç”¨çš„IPåœ°å€</strong></p><p><strong>åœ¨ä½¿ç”¨å‰è¿˜ä¼šè¿›è¡ŒARPæ£€æµ‹</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-044fb99d76bd279c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/673/format/webp" alt="img"></p></blockquote><p>å‰©ä¸‹æµç¨‹å›¾ç¤º</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-a01eacfba40e9098.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="DHCPä¸­ç»§ä»£ç†"><a href="#DHCPä¸­ç»§ä»£ç†" class="headerlink" title="DHCPä¸­ç»§ä»£ç†"></a>DHCPä¸­ç»§ä»£ç†</h4><p>ä¸‹å›¾çš„ç½‘ç»œæ‹“æ‰‘ä¸­çš„å„ä¸»æœºæ˜¯å¦å¯ä»¥é€šè¿‡DHCPæ¥è‡ªåŠ¨è·å–åˆ°ç½‘ç»œé…ç½®ï¼Ÿ</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-33c64efac75f0ad2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä½¿ç”¨DHCPä¸­ç»§ä»£ç†æ˜¯å› ä¸ºæˆ‘ä»¬ä¸ç”¨ç»™æ¯ä¸€ä¸ªç½‘ç»œä¸Šéƒ½è®¾ç½®ä¸€ä¸ªDHCPæœåŠ¡å™¨ï¼Œè¿™æ ·ä¼šä½¿DHCPæœåŠ¡å™¨çš„æ•°é‡å¤ªå¤š</p></blockquote><h4 id="æ€»ç»“-13"><a href="#æ€»ç»“-13" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-37d8836f5ed85036.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><hr><h3 id="åŸŸåç³»ç»ŸDNS"><a href="#åŸŸåç³»ç»ŸDNS" class="headerlink" title="åŸŸåç³»ç»ŸDNS"></a>åŸŸåç³»ç»ŸDNS</h3><h4 id="æ¦‚è¿°-2"><a href="#æ¦‚è¿°-2" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h4><p>åŸŸåç›¸æ¯”IPåœ°å€æ›´å®¹æ˜“è®°å¿†</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-418d77c262da3948.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>å› ç‰¹ç½‘æ˜¯å¦å¯ä»¥åªä½¿ç”¨ä¸€å°DNSæœåŠ¡å™¨ï¼Ÿ</p><p>ä¸è¡Œ</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-423a48c721a4a5d0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-8dc45fb61122f775.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-31a3076fe8055379.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>åç§°ç›¸åŒçš„åŸŸåå…¶ç­‰çº§æœªå¿…ç›¸åŒ</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/24878825-4655232a57435f63.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-c2350ce866abf74e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="åŸŸåè§£æè¿‡ç¨‹"><a href="#åŸŸåè§£æè¿‡ç¨‹" class="headerlink" title="åŸŸåè§£æè¿‡ç¨‹"></a>åŸŸåè§£æè¿‡ç¨‹</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-aae45d426ec7fa49.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-d2652511b6f2280d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-0b01d9ca32d995f3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-2df66d338296916f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="æ€»ç»“-14"><a href="#æ€»ç»“-14" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-93d3fbaa54195112.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><hr><h3 id="æ–‡ä»¶ä¼ é€åè®®FTP"><a href="#æ–‡ä»¶ä¼ é€åè®®FTP" class="headerlink" title="æ–‡ä»¶ä¼ é€åè®®FTP"></a>æ–‡ä»¶ä¼ é€åè®®FTP</h3><h4 id="æ¦‚å¿µ-9"><a href="#æ¦‚å¿µ-9" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-df91fe396712c633.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="æ–‡ä»¶ä¼ é€åè®®FTPçš„åº”ç”¨"><a href="#æ–‡ä»¶ä¼ é€åè®®FTPçš„åº”ç”¨" class="headerlink" title="æ–‡ä»¶ä¼ é€åè®®FTPçš„åº”ç”¨"></a>æ–‡ä»¶ä¼ é€åè®®FTPçš„åº”ç”¨</h4><p>FTPé‡‡ç”¨C&#x2F;Sæ–¹å¼ï¼ˆå®¢æˆ·&#x2F;æœåŠ¡å™¨æ–¹å¼ï¼‰</p><p>FTPå®¢æˆ·è®¡ç®—æœºå¯å°†å„ç§ç±»å‹çš„æ–‡ä»¶ä¸Šä¼ åˆ°FTPæœåŠ¡å™¨è®¡ç®—æœº</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-523d37958c02b33c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1119/format/webp" alt="img"></p><p>FTPå®¢æˆ·è®¡ç®—æœºä¹Ÿå¯ä»¥ä»FTPæœåŠ¡å™¨è®¡ç®—æœºä¸‹è½½æ–‡ä»¶</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-510f63b63db4ba4f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1073/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-bd1aca704fbfff6d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/421/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-fc1bb372ad88d1f3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/677/format/webp" alt="img"></p><h4 id="FTPåŸºæœ¬å·¥ä½œåŸç†"><a href="#FTPåŸºæœ¬å·¥ä½œåŸç†" class="headerlink" title="FTPåŸºæœ¬å·¥ä½œåŸç†"></a>FTPåŸºæœ¬å·¥ä½œåŸç†</h4><p>FTPæœåŠ¡å™¨ç›‘å¬ç†ŸçŸ¥ç«¯å£ï¼ˆç«¯å£å·ä¸º 21ï¼‰ï¼Œä½¿å®¢æˆ·è¿›ç¨‹èƒ½å¤Ÿè¿æ¥ä¸Šã€‚</p><p>FTPå®¢æˆ·éšæœºé€‰æ‹©ä¸€ä¸ªä¸´æ—¶ç«¯å£å·ä¸å…¶å»ºç«‹TCPè¿æ¥ï¼Œè¿™æ¡TCPè¿æ¥ç”¨äºFTPå®¢æˆ·ä¸æœåŠ¡å™¨ä¹‹é—´ä¼ é€FTPçš„ç›¸å…³æ§åˆ¶å‘½ä»¤ï¼ˆè¿™æ¡è¿æ¥æ˜¯FTPå®¢æˆ·ä¸æœåŠ¡å™¨ä¹‹é—´çš„å‘½ä»¤é€šé“ï¼‰</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-fe8243f273df1c3b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1111/format/webp" alt="img"></p><p>ä¸‹å›¾ä¸ºå»ºç«‹æ•°æ®é€šé“çš„TCPè¿æ¥</p><p>FTPæœåŠ¡å™¨ä½¿ç”¨è‡ªå·±çš„ç†ŸçŸ¥ç«¯å£å·20ä¸å…¶å»ºç«‹TCPè¿æ¥ï¼Œè¿™æ¡TCPè¿æ¥ç”¨äºFTPå®¢æˆ·ä¸æœåŠ¡å™¨ä¹‹é—´ä¼ é€æ–‡ä»¶</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-37858686cb4a05aa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>ä¸Šé¢ä¾‹å­æ˜¯ä¸»åŠ¨æ¨¡å¼ï¼šå»ºç«‹æ•°æ®é€šé“æ—¶ï¼ŒFTPæœåŠ¡å™¨ä¸»åŠ¨è¿æ¥FTPå®¢æˆ·</p></blockquote><p>ä¸‹å›¾å®ä¾‹ä¸ºè¢«åŠ¨æ¨¡å¼</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-7125f10efdf012e1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1023/format/webp" alt="img"></p><p>ä¸¤ç§æ¨¡å¼å¯¹æ¯”</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-885981a43745ae55.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>æ³¨æ„ä¸¤ç§æ¨¡å¼éƒ½æ˜¯</p><p>æ§åˆ¶è¿æ¥åœ¨æ•´ä¸ªä¼šè¯æœŸé—´ä¿æŒæ‰“å¼€çŠ¶æ€</p><p>æ•°æ®è¿æ¥ä¼ è¾“å®Œæ¯•åå°±å…³é—­</p></blockquote><h4 id="æ€»ç»“-15"><a href="#æ€»ç»“-15" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-2b566956ff071b24.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><hr><h3 id="ç”µå­é‚®ä»¶"><a href="#ç”µå­é‚®ä»¶" class="headerlink" title="ç”µå­é‚®ä»¶"></a>ç”µå­é‚®ä»¶</h3><h4 id="æ¦‚å¿µ-10"><a href="#æ¦‚å¿µ-10" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-905f080fde0331a5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="é‚®ä»¶å‘é€å’Œæ¥æ”¶è¿‡ç¨‹"><a href="#é‚®ä»¶å‘é€å’Œæ¥æ”¶è¿‡ç¨‹" class="headerlink" title="é‚®ä»¶å‘é€å’Œæ¥æ”¶è¿‡ç¨‹"></a>é‚®ä»¶å‘é€å’Œæ¥æ”¶è¿‡ç¨‹</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-a55537e03d980133.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="ç®€å•é‚®ä»¶ä¼ é€åè®®SMTPï¼ˆSimple-Mail-Transfer-Protocolï¼‰çš„åŸºæœ¬å·¥ä½œåŸç†"><a href="#ç®€å•é‚®ä»¶ä¼ é€åè®®SMTPï¼ˆSimple-Mail-Transfer-Protocolï¼‰çš„åŸºæœ¬å·¥ä½œåŸç†" class="headerlink" title="ç®€å•é‚®ä»¶ä¼ é€åè®®SMTPï¼ˆSimple Mail Transfer Protocolï¼‰çš„åŸºæœ¬å·¥ä½œåŸç†"></a>ç®€å•é‚®ä»¶ä¼ é€åè®®SMTPï¼ˆSimple Mail Transfer Protocolï¼‰çš„åŸºæœ¬å·¥ä½œåŸç†</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-03f4877d2621c261.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="ç”µå­é‚®ä»¶çš„ä¿¡æ¯æ ¼å¼"><a href="#ç”µå­é‚®ä»¶çš„ä¿¡æ¯æ ¼å¼" class="headerlink" title="ç”µå­é‚®ä»¶çš„ä¿¡æ¯æ ¼å¼"></a>ç”µå­é‚®ä»¶çš„ä¿¡æ¯æ ¼å¼</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-fb16b5ace5466b25.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp" alt="img"></p><h4 id="é‚®ä»¶è¯»å–"><a href="#é‚®ä»¶è¯»å–" class="headerlink" title="é‚®ä»¶è¯»å–"></a>é‚®ä»¶è¯»å–</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-c825d1ad122bd41c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="åŸºäºä¸‡ç»´ç½‘çš„ç”µå­é‚®ä»¶"><a href="#åŸºäºä¸‡ç»´ç½‘çš„ç”µå­é‚®ä»¶" class="headerlink" title="åŸºäºä¸‡ç»´ç½‘çš„ç”µå­é‚®ä»¶"></a>åŸºäºä¸‡ç»´ç½‘çš„ç”µå­é‚®ä»¶</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-46b15b10a17604fa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="æ€»ç»“-16"><a href="#æ€»ç»“-16" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-b400e3f6c0a87238.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><hr><h3 id="ä¸‡ç»´ç½‘WWW"><a href="#ä¸‡ç»´ç½‘WWW" class="headerlink" title="ä¸‡ç»´ç½‘WWW"></a>ä¸‡ç»´ç½‘WWW</h3><h4 id="æ¦‚å¿µ-11"><a href="#æ¦‚å¿µ-11" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><p><strong>æ¦‚è¿°</strong></p><ul><li><strong>ä¸‡ç»´ç½‘</strong> WWW (World Wide Web) å¹¶éæŸç§ç‰¹æ®Šçš„è®¡ç®—æœºç½‘ç»œã€‚</li><li>ä¸‡ç»´ç½‘æ˜¯ä¸€ä¸ªå¤§è§„æ¨¡çš„ã€è”æœºå¼çš„<strong>ä¿¡æ¯å‚¨è—æ‰€</strong>ã€‚</li><li>ä¸‡ç»´ç½‘ç”¨é“¾æ¥çš„æ–¹æ³•èƒ½éå¸¸æ–¹ä¾¿åœ°ä»äº’è”ç½‘ä¸Šçš„ä¸€ä¸ªç«™ç‚¹è®¿é—®å¦ä¸€ä¸ªç«™ç‚¹ï¼Œä»è€Œä¸»åŠ¨åœ°æŒ‰éœ€è·å–ä¸°å¯Œçš„ä¿¡æ¯ã€‚</li><li>è¿™ç§è®¿é—®æ–¹å¼ç§°ä¸ºâ€œ<strong>é“¾æ¥</strong>â€ã€‚</li></ul><p><strong>ä¸‡ç»´ç½‘çš„å·¥ä½œæ–¹å¼</strong></p><ul><li>ä¸‡ç»´ç½‘ä»¥<strong>å®¢æˆ· - æœåŠ¡å™¨</strong>æ–¹å¼å·¥ä½œã€‚</li><li><strong>æµè§ˆå™¨</strong>å°±æ˜¯åœ¨ç”¨æˆ·è®¡ç®—æœºä¸Šçš„ä¸‡ç»´ç½‘<strong>å®¢æˆ·ç¨‹åº</strong>ã€‚ä¸‡ç»´ç½‘æ–‡æ¡£æ‰€é©»ç•™çš„è®¡ç®—æœºåˆ™è¿è¡Œ<strong>æœåŠ¡å™¨ç¨‹åº</strong>ï¼Œå› æ­¤è¿™ä¸ªè®¡ç®—æœºä¹Ÿç§°ä¸º<strong>ä¸‡ç»´ç½‘æœåŠ¡å™¨</strong>ã€‚</li><li>å®¢æˆ·ç¨‹åºå‘æœåŠ¡å™¨ç¨‹åºå‘å‡ºè¯·æ±‚ï¼ŒæœåŠ¡å™¨ç¨‹åºå‘å®¢æˆ·ç¨‹åºé€å›å®¢æˆ·æ‰€è¦çš„<strong>ä¸‡ç»´ç½‘æ–‡æ¡£</strong>ã€‚</li><li>åœ¨ä¸€ä¸ªå®¢æˆ·ç¨‹åºä¸»çª—å£ä¸Šæ˜¾ç¤ºå‡ºçš„ä¸‡ç»´ç½‘æ–‡æ¡£ç§°ä¸º<strong>é¡µé¢</strong> (page)ã€‚</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-68dbe2651f5e5a80.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-8646898df7461ca3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/907/format/webp" alt="img"></p><p><strong>ä¸‡ç»´ç½‘åº”ç”¨ä¸¾ä¾‹</strong></p><p>è®¿é—®ç½‘é¡µ</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-cd07ed4a1a595490.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>æ€æ ·æ ‡å¿—åˆ†å¸ƒåœ¨æ•´ä¸ªäº’è”ç½‘ä¸Šçš„ä¸‡ç»´ç½‘æ–‡æ¡£ï¼Ÿ</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-05ae15f55de2ba0a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>ä¸‡ç»´ç½‘çš„æ–‡æ¡£</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-5240e0cba8fd0a62.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="è¶…æ–‡æœ¬ä¼ è¾“åè®®HTTPï¼ˆHyper-Transfer-Protocolï¼‰"><a href="#è¶…æ–‡æœ¬ä¼ è¾“åè®®HTTPï¼ˆHyper-Transfer-Protocolï¼‰" class="headerlink" title="è¶…æ–‡æœ¬ä¼ è¾“åè®®HTTPï¼ˆHyper Transfer Protocolï¼‰"></a>è¶…æ–‡æœ¬ä¼ è¾“åè®®HTTPï¼ˆHyper Transfer Protocolï¼‰</h4><h5 id="æ¦‚å¿µå’Œä¼ è¾“è¿‡ç¨‹"><a href="#æ¦‚å¿µå’Œä¼ è¾“è¿‡ç¨‹" class="headerlink" title="æ¦‚å¿µå’Œä¼ è¾“è¿‡ç¨‹"></a>æ¦‚å¿µå’Œä¼ è¾“è¿‡ç¨‹</h5><ul><li>åœ¨ä¸‡ç»´ç½‘å®¢æˆ·ç¨‹åºä¸ä¸‡ç»´ç½‘æœåŠ¡å™¨ç¨‹åºä¹‹é—´è¿›è¡Œäº¤äº’æ‰€ä½¿ç”¨çš„åè®®ï¼Œæ˜¯<strong>è¶…æ–‡æœ¬ä¼ é€åè®®</strong> HTTP (HyperText Transfer Protocol)ã€‚</li><li>HTTP æ˜¯ä¸€ä¸ªåº”ç”¨å±‚åè®®ï¼Œå®ƒä½¿ç”¨ TCP è¿æ¥è¿›è¡Œå¯é çš„ä¼ é€ã€‚</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-41e8ed466986db36.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><ul><li>æ¯ä¸ªä¸‡ç»´ç½‘ç½‘ç‚¹éƒ½æœ‰ä¸€ä¸ªæœåŠ¡å™¨è¿›ç¨‹ï¼Œå®ƒä¸æ–­åœ°<strong>ç›‘å¬ TCP çš„ç«¯å£ 80</strong>ï¼Œä»¥ä¾¿å‘ç°æ˜¯å¦æœ‰æµè§ˆå™¨å‘å®ƒå‘å‡ºè¿æ¥å»ºç«‹è¯·æ±‚ã€‚</li><li>ä¸€æ—¦ç›‘å¬åˆ°è¿æ¥å»ºç«‹è¯·æ±‚å¹¶å»ºç«‹äº† TCP è¿æ¥ä¹‹åï¼Œæµè§ˆå™¨å°±å‘ä¸‡ç»´ç½‘æœåŠ¡å™¨å‘å‡ºæµè§ˆæŸä¸ªé¡µé¢çš„è¯·æ±‚ï¼ŒæœåŠ¡å™¨æ¥ç€å°±è¿”å›æ‰€è¯·æ±‚çš„é¡µé¢ä½œä¸ºå“åº”ã€‚</li><li>æœ€åï¼ŒTCP è¿æ¥å°±è¢«é‡Šæ”¾äº†ã€‚</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/24878825-614d1960b2b805d9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h5 id="HTTPæŠ¥æ–‡æ ¼å¼"><a href="#HTTPæŠ¥æ–‡æ ¼å¼" class="headerlink" title="HTTPæŠ¥æ–‡æ ¼å¼"></a>HTTPæŠ¥æ–‡æ ¼å¼</h5><p><strong>HTTPè¯·æ±‚æŠ¥æ–‡æ ¼å¼</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-22dfb8a34acf459c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p><strong>HTTPå“åº”æŠ¥æ–‡æ ¼å¼</strong></p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-0409ca153701fbb4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h5 id="ä½¿ç”¨Cookieåœ¨æœåŠ¡å™¨ä¸Šè®°å½•ç”¨æˆ·ä¿¡æ¯"><a href="#ä½¿ç”¨Cookieåœ¨æœåŠ¡å™¨ä¸Šè®°å½•ç”¨æˆ·ä¿¡æ¯" class="headerlink" title="ä½¿ç”¨Cookieåœ¨æœåŠ¡å™¨ä¸Šè®°å½•ç”¨æˆ·ä¿¡æ¯"></a>ä½¿ç”¨Cookieåœ¨æœåŠ¡å™¨ä¸Šè®°å½•ç”¨æˆ·ä¿¡æ¯</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-969dc15b42399e98.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h5 id="ä¸‡ç»´ç½‘ç¼“å­˜ä¸ä»£ç†æœåŠ¡å™¨"><a href="#ä¸‡ç»´ç½‘ç¼“å­˜ä¸ä»£ç†æœåŠ¡å™¨" class="headerlink" title="ä¸‡ç»´ç½‘ç¼“å­˜ä¸ä»£ç†æœåŠ¡å™¨"></a>ä¸‡ç»´ç½‘ç¼“å­˜ä¸ä»£ç†æœåŠ¡å™¨</h5><p><img src="https://upload-images.jianshu.io/upload_images/24878825-e7f4b696946ffafa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>å¦‚æœè¯¥è¯·æ±‚æœ‰ç¼“å­˜</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-b0ccf228d3132c12.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>å¦‚æœè¯¥è¯·æ±‚æ²¡æœ‰ç¼“å­˜</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-049121882eafde97.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><blockquote><p>è‹¥WEbç¼“å­˜çš„å‘½ä¸­ç‡æ¯”è¾ƒé«˜</p><p>åˆ™ä¼šå¤§å¤§å‡å°äº†è¯¥é“¾è·¯ä¸Šçš„é€šä¿¡é‡ï¼Œå› è€Œå‡å°‘äº†è®¿é—®å› ç‰¹ç½‘çš„æ—¶å»¶</p></blockquote><p>å‡è®¾åŸå§‹æœåŠ¡å™¨çš„æ–‡æ¡£è¢«æ›´æ”¹ï¼Œè¿™æ ·ä»£ç†æœåŠ¡å™¨çš„æ–‡æ¡£å°±ä¸æ˜¯æœ€æ–°çš„</p><p>æ‰€ä»¥åŸå§‹æœåŠ¡å™¨é€šå¸¸ä¼šä¸ºæ¯ä¸ªå“åº”çš„å¯¹è±¡è®¾å®šä¸€ä¸ª<strong>ä¿®æ”¹æ—¶é—´å­—æ®µ</strong>å’Œä¸€ä¸ª<strong>æœ‰æ•ˆæ—¥æœŸå­—æ®µ</strong></p><p>è‹¥æœªè¿‡æœŸ</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-a5de1829c0777328.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>è‹¥è¿‡æœŸå¹¶ä¸”ä»£ç†æœåŠ¡å™¨çš„æ–‡æ¡£å’ŒåŸå§‹æœåŠ¡å™¨çš„<strong>æ–‡æ¡£ä¸€è‡´</strong>ï¼ŒåŸå§‹æœåŠ¡å™¨åˆ™ç»™ä»£ç†æœåŠ¡å™¨å‘é€ä¸åŒ…å«å®ä½“ä¸»ä½“çš„å“åº”</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-abf0fcf785757c26.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><p>image-20201024225846863</p><p>è‹¥è¿‡æœŸå¹¶ä¸”ä»£ç†æœåŠ¡å™¨çš„æ–‡æ¡£å’ŒåŸå§‹æœåŠ¡å™¨çš„<strong>æ–‡æ¡£ä¸ä¸€è‡´</strong>ï¼ŒåŸå§‹æœåŠ¡å™¨åˆ™ç»™ä»£ç†æœåŠ¡å™¨å‘é€å°è£…æœ‰è¯¥æ–‡æ¡£çš„å“åº”æŠ¥æ–‡</p><p><img src="https://upload-images.jianshu.io/upload_images/24878825-14ec3f45c4af32f9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p><h4 id="æ€»ç»“-17"><a href="#æ€»ç»“-17" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p><img src="https://upload-images.jianshu.io/upload_images/24878825-dab94fae0e969502.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt="img"></p>]]></content>
      
      
      <categories>
          
          <category> è®¡ç®—æœºåŸºç¡€ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¡ç®—æœºç½‘ç»œ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
